/usr/local/lib/python3.8/dist-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
[I 2023-09-11 07:05:29,965] A new study created in memory with name: no-name-83cd982c-4247-4bef-aaa0-6001a53d9737
I am process 2431211, running on amorgenstern-titanx8-25nlt: starting (Mon Sep 11 07:05:25 2023)
balanced sampler is not used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process ours
use dataset mean -0.023 and std 0.413 to normalize the input.
number of classes is 4
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process ours
use dataset mean -0.023 and std 0.413 to normalize the input.
number of classes is 4
Now train with ours with 1921 training samples, evaluate with 211 samples
now load a SSL pretrained models from SSAST-Base-Patch-400.pth
pretraining patch split stride: frequency=16, time=16
pretraining patch shape: frequency=16, time=16
pretraining patch array dimension: frequency=8, time=64
pretraining number of patches=512
fine-tuning patch split stride: frequncey=16, time=16
fine-tuning number of patches=256

Creating experiment directory: initial_test_run
Now starting fine-tuning for 50 epochs
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f85da41f820>
The learning rate scheduler starts at 4 epoch with decay rate of 0.709 every 6 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 07:05:30.054716
current #epochs=1, #steps=0
[1694415944.968804] [amorgenstern-titanx8-25nlt:2431211:f]        vfs_fuse.c:281  UCX  ERROR inotify_add_watch(/tmp) failed: No space left on device
start validation
acc: 0.530806
AUC: 0.421996
Avg Precision: 0.251620
Avg Recall: 1.000000
d_prime: -0.278301
train_loss: 1.719255
valid_loss: 1.351370
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0023146009162446687
Epoch-1 lr: 0.004629201832489337
epoch 1 training time: 32.532
---------------
2023-09-11 07:06:02.587219
current #epochs=2, #steps=40
start validation
acc: 0.530806
AUC: 0.425399
Avg Precision: 0.256112
Avg Recall: 1.000000
d_prime: -0.266012
train_loss: 1.125407
valid_loss: 1.352728
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0023146009162446687
Epoch-2 lr: 0.004629201832489337
epoch 2 training time: 14.918
---------------
2023-09-11 07:06:17.505793
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00563	Train Loss 1.1687	
start validation
acc: 0.530806
AUC: 0.430749
Avg Precision: 0.255480
Avg Recall: 1.000000
d_prime: -0.246735
train_loss: 1.142979
valid_loss: 1.353597
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0023146009162446687
Epoch-3 lr: 0.004629201832489337
epoch 3 training time: 14.944
---------------
2023-09-11 07:06:32.449884
current #epochs=4, #steps=120
start validation
acc: 0.530806
AUC: 0.449625
Avg Precision: 0.255704
Avg Recall: 1.000000
d_prime: -0.179051
train_loss: 1.153580
valid_loss: 1.351209
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.001641427742012241
Epoch-4 lr: 0.003282855484024482
epoch 4 training time: 14.967
---------------
2023-09-11 07:06:47.416682
current #epochs=5, #steps=160
start validation
acc: 0.530806
AUC: 0.499734
Avg Precision: 0.266369
Avg Recall: 1.000000
d_prime: -0.000944
train_loss: 1.106665
valid_loss: 1.353317
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.001641427742012241
Epoch-5 lr: 0.003282855484024482
epoch 5 training time: 15.837
---------------
2023-09-11 07:07:03.253495
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03519	Per Sample Data Time 0.02783	Per Sample DNN Time 0.00736	Train Loss 1.1189	
start validation
acc: 0.317536
AUC: 0.506802
Avg Precision: 0.267028
Avg Recall: 1.000000
d_prime: 0.024113
train_loss: 1.135524
valid_loss: 1.362655
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.001641427742012241
Epoch-6 lr: 0.003282855484024482
epoch 6 training time: 14.864
---------------
2023-09-11 07:07:18.118196
current #epochs=7, #steps=240
start validation
acc: 0.530806
AUC: 0.523779
Avg Precision: 0.262730
Avg Recall: 1.000000
d_prime: 0.084343
train_loss: 1.117397
valid_loss: 1.357247
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.001641427742012241
Epoch-7 lr: 0.003282855484024482
epoch 7 training time: 14.900
---------------
2023-09-11 07:07:33.018377
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00143	Per Sample DNN Time 0.00563	Train Loss 1.1409	
start validation
acc: 0.530806
AUC: 0.527353
Avg Precision: 0.262481
Avg Recall: 1.000000
d_prime: 0.097041
train_loss: 1.146056
valid_loss: 1.355475
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001641427742012241
Epoch-8 lr: 0.003282855484024482
epoch 8 training time: 15.104
---------------
2023-09-11 07:07:48.121945
current #epochs=9, #steps=320
start validation
acc: 0.530806
AUC: 0.533320
Avg Precision: 0.262229
Avg Recall: 1.000000
d_prime: 0.118255
train_loss: 1.100637
valid_loss: 1.350160
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001641427742012241
Epoch-9 lr: 0.003282855484024482
epoch 9 training time: 14.715
---------------
2023-09-11 07:08:02.837736
current #epochs=10, #steps=360
start validation
acc: 0.530806
AUC: 0.535737
Avg Precision: 0.261408
Avg Recall: 1.000000
d_prime: 0.126854
train_loss: 1.121077
valid_loss: 1.348066
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001164038695974749
Epoch-10 lr: 0.002328077391949498
epoch 10 training time: 14.789
---------------
2023-09-11 07:08:17.626886
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03613	Per Sample Data Time 0.02719	Per Sample DNN Time 0.00894	Train Loss 1.3342	
start validation
acc: 0.530806
AUC: 0.531684
Avg Precision: 0.260751
Avg Recall: 1.000000
d_prime: 0.112434
train_loss: 1.109695
valid_loss: 1.358680
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001164038695974749
Epoch-11 lr: 0.002328077391949498
epoch 11 training time: 14.839
---------------
2023-09-11 07:08:32.465615
current #epochs=12, #steps=440
start validation
acc: 0.530806
AUC: 0.528256
Avg Precision: 0.262290
Avg Recall: 1.000000
d_prime: 0.100249
train_loss: 1.098920
valid_loss: 1.349810
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001164038695974749
Epoch-12 lr: 0.002328077391949498
epoch 12 training time: 14.936
---------------
2023-09-11 07:08:47.401689
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00557	Train Loss 1.1141	
start validation
acc: 0.530806
AUC: 0.520851
Avg Precision: 0.262165
Avg Recall: 1.000000
d_prime: 0.073949
train_loss: 1.111354
valid_loss: 1.353552
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.001164038695974749
Epoch-13 lr: 0.002328077391949498
epoch 13 training time: 14.867
---------------
2023-09-11 07:09:02.268454
current #epochs=14, #steps=520
start validation
acc: 0.530806
AUC: 0.506519
Avg Precision: 0.262758
Avg Recall: 1.000000
d_prime: 0.023112
train_loss: 1.120403
valid_loss: 1.350706
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.001164038695974749
Epoch-14 lr: 0.002328077391949498
epoch 14 training time: 14.952
---------------
2023-09-11 07:09:17.220346
current #epochs=15, #steps=560
start validation
acc: 0.530806
AUC: 0.494401
Avg Precision: 0.263788
Avg Recall: 1.000000
d_prime: -0.019849
train_loss: 1.106644
valid_loss: 1.355246
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.001164038695974749
Epoch-15 lr: 0.002328077391949498
epoch 15 training time: 14.894
---------------
2023-09-11 07:09:32.114538
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03476	Per Sample Data Time 0.02781	Per Sample DNN Time 0.00695	Train Loss 1.1324	
start validation
acc: 0.530806
AUC: 0.501141
Avg Precision: 0.264854
Avg Recall: 1.000000
d_prime: 0.004044
train_loss: 1.104143
valid_loss: 1.352217
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.000825492375354583
Epoch-16 lr: 0.001650984750709166
epoch 16 training time: 14.841
---------------
2023-09-11 07:09:46.954988
current #epochs=17, #steps=640
start validation
acc: 0.530806
AUC: 0.511576
Avg Precision: 0.264540
Avg Recall: 1.000000
d_prime: 0.041043
train_loss: 1.102725
valid_loss: 1.361559
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.000825492375354583
Epoch-17 lr: 0.001650984750709166
epoch 17 training time: 15.905
---------------
2023-09-11 07:10:02.860337
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00703	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00558	Train Loss 1.0770	
start validation
acc: 0.530806
AUC: 0.534076
Avg Precision: 0.264551
Avg Recall: 1.000000
d_prime: 0.120945
train_loss: 1.099640
valid_loss: 1.350883
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.000825492375354583
Epoch-18 lr: 0.001650984750709166
epoch 18 training time: 14.965
---------------
2023-09-11 07:10:17.825216
current #epochs=19, #steps=720
start validation
acc: 0.530806
AUC: 0.526185
Avg Precision: 0.266354
Avg Recall: 1.000000
d_prime: 0.092891
train_loss: 1.111361
valid_loss: 1.354442
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.000825492375354583
Epoch-19 lr: 0.001650984750709166
epoch 19 training time: 14.849
---------------
2023-09-11 07:10:32.673787
current #epochs=20, #steps=760
start validation
acc: 0.530806
AUC: 0.559287
Avg Precision: 0.267832
Avg Recall: 1.000000
d_prime: 0.210946
train_loss: 1.100671
valid_loss: 1.351584
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.000825492375354583
Epoch-20 lr: 0.001650984750709166
epoch 20 training time: 14.982
---------------
2023-09-11 07:10:47.655451
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03576	Per Sample Data Time 0.02867	Per Sample DNN Time 0.00709	Train Loss 1.2410	
start validation
acc: 0.530806
AUC: 0.563203
Avg Precision: 0.267675
Avg Recall: 1.000000
d_prime: 0.224993
train_loss: 1.099540
valid_loss: 1.349674
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.000825492375354583
Epoch-21 lr: 0.001650984750709166
epoch 21 training time: 14.989
---------------
2023-09-11 07:11:02.644686
current #epochs=22, #steps=840
start validation
acc: 0.530806
AUC: 0.577441
Avg Precision: 0.264992
Avg Recall: 1.000000
d_prime: 0.276268
train_loss: 1.109753
valid_loss: 1.349953
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0005854080831891295
Epoch-22 lr: 0.001170816166378259
epoch 22 training time: 14.888
---------------
2023-09-11 07:11:17.532846
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00562	Train Loss 1.0899	
start validation
acc: 0.530806
AUC: 0.564715
Avg Precision: 0.268423
Avg Recall: 1.000000
d_prime: 0.230425
train_loss: 1.098715
valid_loss: 1.350680
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0005854080831891295
Epoch-23 lr: 0.001170816166378259
epoch 23 training time: 15.626
---------------
2023-09-11 07:11:33.158582
current #epochs=24, #steps=920
start validation
acc: 0.530806
AUC: 0.569051
Avg Precision: 0.270123
Avg Recall: 1.000000
d_prime: 0.246016
train_loss: 1.095152
valid_loss: 1.352424
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0005854080831891295
Epoch-24 lr: 0.001170816166378259
epoch 24 training time: 14.954
---------------
2023-09-11 07:11:48.112973
current #epochs=25, #steps=960
start validation
acc: 0.530806
AUC: 0.568688
Avg Precision: 0.268254
Avg Recall: 1.000000
d_prime: 0.244707
train_loss: 1.098534
valid_loss: 1.355798
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0005854080831891295
Epoch-25 lr: 0.001170816166378259
epoch 25 training time: 14.960
---------------
2023-09-11 07:12:03.072627
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03834	Per Sample Data Time 0.02873	Per Sample DNN Time 0.00960	Train Loss 1.1434	
start validation
acc: 0.530806
AUC: 0.567358
Avg Precision: 0.264796
Avg Recall: 1.000000
d_prime: 0.239925
train_loss: 1.102327
valid_loss: 1.357446
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0005854080831891295
Epoch-26 lr: 0.001170816166378259
epoch 26 training time: 15.050
---------------
2023-09-11 07:12:18.122361
current #epochs=27, #steps=1040
start validation
acc: 0.530806
AUC: 0.579113
Avg Precision: 0.274018
Avg Recall: 1.000000
d_prime: 0.282313
train_loss: 1.103742
valid_loss: 1.351029
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0005854080831891295
Epoch-27 lr: 0.001170816166378259
epoch 27 training time: 16.069
---------------
2023-09-11 07:12:34.191084
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00559	Train Loss 1.1212	
start validation
acc: 0.530806
AUC: 0.600618
Avg Precision: 0.272113
Avg Recall: 1.000000
d_prime: 0.360549
train_loss: 1.100698
valid_loss: 1.349426
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0004151493509748843
Epoch-28 lr: 0.0008302987019497686
epoch 28 training time: 15.005
---------------
2023-09-11 07:12:49.196360
current #epochs=29, #steps=1120
start validation
acc: 0.530806
AUC: 0.572304
Avg Precision: 0.266809
Avg Recall: 1.000000
d_prime: 0.257729
train_loss: 1.095979
valid_loss: 1.351808
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0004151493509748843
Epoch-29 lr: 0.0008302987019497686
epoch 29 training time: 14.919
---------------
2023-09-11 07:13:04.114950
current #epochs=30, #steps=1160
start validation
acc: 0.530806
AUC: 0.570254
Avg Precision: 0.266026
Avg Recall: 1.000000
d_prime: 0.250344
train_loss: 1.094581
valid_loss: 1.356494
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0004151493509748843
Epoch-30 lr: 0.0008302987019497686
epoch 30 training time: 14.859
---------------
2023-09-11 07:13:18.974315
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03484	Per Sample Data Time 0.02792	Per Sample DNN Time 0.00693	Train Loss 1.2354	
start validation
acc: 0.530806
AUC: 0.568201
Avg Precision: 0.266154
Avg Recall: 1.000000
d_prime: 0.242956
train_loss: 1.095663
valid_loss: 1.356584
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0004151493509748843
Epoch-31 lr: 0.0008302987019497686
epoch 31 training time: 14.959
---------------
2023-09-11 07:13:33.933316
current #epochs=32, #steps=1240
start validation
acc: 0.530806
AUC: 0.576631
Avg Precision: 0.266809
Avg Recall: 1.000000
d_prime: 0.273344
train_loss: 1.100087
valid_loss: 1.350921
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0004151493509748843
Epoch-32 lr: 0.0008302987019497686
epoch 32 training time: 15.721
---------------
2023-09-11 07:13:49.654575
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00558	Train Loss 1.1029	
start validation
acc: 0.530806
AUC: 0.604667
Avg Precision: 0.273063
Avg Recall: 1.000000
d_prime: 0.375396
train_loss: 1.098901
valid_loss: 1.352066
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0004151493509748843
Epoch-33 lr: 0.0008302987019497686
epoch 33 training time: 16.859
---------------
2023-09-11 07:14:06.513243
current #epochs=34, #steps=1320
start validation
acc: 0.530806
AUC: 0.592804
Avg Precision: 0.270014
Avg Recall: 1.000000
d_prime: 0.332006
train_loss: 1.093434
valid_loss: 1.354754
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0002944082744398772
Epoch-34 lr: 0.0005888165488797544
epoch 34 training time: 14.816
---------------
2023-09-11 07:14:21.329520
current #epochs=35, #steps=1360
start validation
acc: 0.530806
AUC: 0.588590
Avg Precision: 0.267241
Avg Recall: 1.000000
d_prime: 0.316670
train_loss: 1.095207
valid_loss: 1.351764
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0002944082744398772
Epoch-35 lr: 0.0005888165488797544
epoch 35 training time: 15.015
---------------
2023-09-11 07:14:36.344584
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03485	Per Sample Data Time 0.02855	Per Sample DNN Time 0.00630	Train Loss 1.1306	
start validation
acc: 0.530806
AUC: 0.580688
Avg Precision: 0.267848
Avg Recall: 1.000000
d_prime: 0.288011
train_loss: 1.095382
valid_loss: 1.351033
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0002944082744398772
Epoch-36 lr: 0.0005888165488797544
epoch 36 training time: 14.858
---------------
2023-09-11 07:14:51.201984
current #epochs=37, #steps=1440
start validation
acc: 0.530806
AUC: 0.592002
Avg Precision: 0.269791
Avg Recall: 1.000000
d_prime: 0.329083
train_loss: 1.095166
valid_loss: 1.347864
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0002944082744398772
Epoch-37 lr: 0.0005888165488797544
epoch 37 training time: 14.933
---------------
2023-09-11 07:15:06.135408
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00555	Train Loss 1.0928	
start validation
acc: 0.530806
AUC: 0.594459
Avg Precision: 0.265748
Avg Recall: 1.000000
d_prime: 0.338040
train_loss: 1.097947
valid_loss: 1.351361
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0002944082744398772
Epoch-38 lr: 0.0005888165488797544
epoch 38 training time: 14.974
---------------
2023-09-11 07:15:21.109502
current #epochs=39, #steps=1520
start validation
acc: 0.530806
AUC: 0.586620
Avg Precision: 0.269200
Avg Recall: 1.000000
d_prime: 0.309515
train_loss: 1.095769
valid_loss: 1.351505
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0002944082744398772
Epoch-39 lr: 0.0005888165488797544
epoch 39 training time: 14.919
---------------
2023-09-11 07:15:36.028742
current #epochs=40, #steps=1560
start validation
acc: 0.530806
AUC: 0.595164
Avg Precision: 0.268233
Avg Recall: 1.000000
d_prime: 0.340613
train_loss: 1.093366
valid_loss: 1.351904
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.00020878325319581141
Epoch-40 lr: 0.00041756650639162283
epoch 40 training time: 15.072
---------------
2023-09-11 07:15:51.101353
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03652	Per Sample Data Time 0.02684	Per Sample DNN Time 0.00969	Train Loss 1.1384	
start validation
acc: 0.530806
AUC: 0.605550
Avg Precision: 0.269533
Avg Recall: 1.000000
d_prime: 0.378639
train_loss: 1.093169
valid_loss: 1.352505
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.00020878325319581141
Epoch-41 lr: 0.00041756650639162283
epoch 41 training time: 14.970
---------------
2023-09-11 07:16:06.071364
current #epochs=42, #steps=1640
start validation
acc: 0.530806
AUC: 0.595446
Avg Precision: 0.264114
Avg Recall: 1.000000
d_prime: 0.341642
train_loss: 1.092738
valid_loss: 1.352107
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.00020878325319581141
Epoch-42 lr: 0.00041756650639162283
epoch 42 training time: 15.681
---------------
2023-09-11 07:16:21.752950
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00556	Train Loss 1.0818	
start validation
acc: 0.530806
AUC: 0.615684
Avg Precision: 0.272533
Avg Recall: 1.000000
d_prime: 0.416010
train_loss: 1.092472
valid_loss: 1.351219
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.00020878325319581141
Epoch-43 lr: 0.00041756650639162283
epoch 43 training time: 14.951
---------------
2023-09-11 07:16:36.704401
current #epochs=44, #steps=1720
start validation
acc: 0.530806
AUC: 0.623580
Avg Precision: 0.269995
Avg Recall: 1.000000
d_prime: 0.445331
train_loss: 1.093633
valid_loss: 1.350157
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.00020878325319581141
Epoch-44 lr: 0.00041756650639162283
epoch 44 training time: 14.880
---------------
2023-09-11 07:16:51.584320
current #epochs=45, #steps=1760
start validation
acc: 0.530806
AUC: 0.626923
Avg Precision: 0.271129
Avg Recall: 1.000000
d_prime: 0.457802
train_loss: 1.093067
valid_loss: 1.350744
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.00020878325319581141
Epoch-45 lr: 0.00041756650639162283
epoch 45 training time: 16.266
---------------
2023-09-11 07:17:07.850391
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03553	Per Sample Data Time 0.02824	Per Sample DNN Time 0.00729	Train Loss 1.0181	
start validation
[I 2023-09-11 07:17:23,989] Trial 0 finished with value: 0.5308056872037915 and parameters: {'warmup': 'True', 'num_epochs': 46, 'batch_size': 17, 'lr-adaptschedule': 'False', 'lr': 0.0023146009162446687, 'head-lr': 2, 'lr-scheduler-start': 4, 'lr-scheduler-step': 6, 'lr-scheduler-decay': 0.7091623141130439}. Best is trial 0 with value: 0.5308056872037915.
acc: 0.530806
AUC: 0.609055
Avg Precision: 0.266192
Avg Recall: 1.000000
d_prime: 0.391533
train_loss: 1.091382
valid_loss: 1.352077
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.0001480612149843912
Epoch-46 lr: 0.0002961224299687824
epoch 46 training time: 16.135
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f85b40562e0>
The learning rate scheduler starts at 4 epoch with decay rate of 0.630 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 07:17:23.995217
current #epochs=1, #steps=0
start validation
acc: 0.530806
AUC: 0.498656
Avg Precision: 0.261994
Avg Recall: 1.000000
d_prime: -0.004765
train_loss: 1.116257
valid_loss: 1.354901
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0005935317116891605
Epoch-1 lr: 0.001187063423378321
epoch 1 training time: 17.204
---------------
2023-09-11 07:17:41.200069
current #epochs=2, #steps=40
start validation
acc: 0.530806
AUC: 0.570874
Avg Precision: 0.257354
Avg Recall: 1.000000
d_prime: 0.252580
train_loss: 1.104403
valid_loss: 1.352592
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0005935317116891605
Epoch-2 lr: 0.001187063423378321
epoch 2 training time: 15.125
---------------
2023-09-11 07:17:56.325055
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00695	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00551	Train Loss 1.1154	
start validation
acc: 0.530806
AUC: 0.573255
Avg Precision: 0.256750
Avg Recall: 1.000000
d_prime: 0.261160
train_loss: 1.097623
valid_loss: 1.353375
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0005935317116891605
Epoch-3 lr: 0.001187063423378321
epoch 3 training time: 14.928
---------------
2023-09-11 07:18:11.252611
current #epochs=4, #steps=120
start validation
acc: 0.549763
AUC: 0.594020
Avg Precision: 0.259675
Avg Recall: 1.000000
d_prime: 0.336440
train_loss: 1.069700
valid_loss: 1.336064
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0003737830286506768
Epoch-4 lr: 0.0007475660573013536
epoch 4 training time: 16.977
---------------
2023-09-11 07:18:28.229583
current #epochs=5, #steps=160
start validation
acc: 0.540284
AUC: 0.623577
Avg Precision: 0.264448
Avg Recall: 1.000000
d_prime: 0.445321
train_loss: 0.998508
valid_loss: 1.333882
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0003737830286506768
Epoch-5 lr: 0.0007475660573013536
epoch 5 training time: 15.133
---------------
2023-09-11 07:18:43.362225
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03424	Per Sample Data Time 0.02705	Per Sample DNN Time 0.00718	Train Loss 0.9636	
start validation
acc: 0.578199
AUC: 0.628554
Avg Precision: 0.263414
Avg Recall: 1.000000
d_prime: 0.463900
train_loss: 0.988340
valid_loss: 1.320577
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0003737830286506768
Epoch-6 lr: 0.0007475660573013536
epoch 6 training time: 16.914
---------------
2023-09-11 07:19:00.276848
current #epochs=7, #steps=240
start validation
acc: 0.540284
AUC: 0.625764
Avg Precision: 0.259979
Avg Recall: 1.000000
d_prime: 0.453474
train_loss: 0.972648
valid_loss: 1.308396
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00023539391367927853
Epoch-7 lr: 0.00047078782735855706
epoch 7 training time: 14.923
---------------
2023-09-11 07:19:15.199826
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00562	Train Loss 0.9512	
start validation
acc: 0.559242
AUC: 0.641330
Avg Precision: 0.263465
Avg Recall: 1.000000
d_prime: 0.511967
train_loss: 0.941089
valid_loss: 1.305992
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00023539391367927853
Epoch-8 lr: 0.00047078782735855706
epoch 8 training time: 14.991
---------------
2023-09-11 07:19:30.190805
current #epochs=9, #steps=320
start validation
acc: 0.573460
AUC: 0.644430
Avg Precision: 0.264172
Avg Recall: 1.000000
d_prime: 0.523719
train_loss: 0.936429
valid_loss: 1.295085
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00023539391367927853
Epoch-9 lr: 0.00047078782735855706
epoch 9 training time: 15.091
---------------
2023-09-11 07:19:45.281749
current #epochs=10, #steps=360
start validation
acc: 0.530806
AUC: 0.630530
Avg Precision: 0.261512
Avg Recall: 1.000000
d_prime: 0.471299
train_loss: 0.931521
valid_loss: 1.320428
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00014824186854409582
Epoch-10 lr: 0.00029648373708819164
epoch 10 training time: 15.145
---------------
2023-09-11 07:20:00.426551
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03517	Per Sample Data Time 0.02866	Per Sample DNN Time 0.00651	Train Loss 1.1390	
start validation
acc: 0.554502
AUC: 0.649694
Avg Precision: 0.263126
Avg Recall: 1.000000
d_prime: 0.543757
train_loss: 0.935883
valid_loss: 1.304246
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00014824186854409582
Epoch-11 lr: 0.00029648373708819164
epoch 11 training time: 17.136
---------------
2023-09-11 07:20:17.563047
current #epochs=12, #steps=440
start validation
acc: 0.545024
AUC: 0.656901
Avg Precision: 0.267797
Avg Recall: 1.000000
d_prime: 0.571371
train_loss: 0.914328
valid_loss: 1.285444
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00014824186854409582
Epoch-12 lr: 0.00029648373708819164
epoch 12 training time: 15.214
---------------
2023-09-11 07:20:32.776862
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00702	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00555	Train Loss 0.9391	
start validation
acc: 0.597156
AUC: 0.663531
Avg Precision: 0.269702
Avg Recall: 1.000000
d_prime: 0.596967
train_loss: 0.901337
valid_loss: 1.286218
validation finished
normal learning rate scheduler step
Epoch-13 lr: 9.335692349032675e-05
Epoch-13 lr: 0.0001867138469806535
epoch 13 training time: 17.346
---------------
2023-09-11 07:20:50.122804
current #epochs=14, #steps=520
start validation
acc: 0.611374
AUC: 0.666992
Avg Precision: 0.269051
Avg Recall: 1.000000
d_prime: 0.610408
train_loss: 0.883323
valid_loss: 1.278498
validation finished
normal learning rate scheduler step
Epoch-14 lr: 9.335692349032675e-05
Epoch-14 lr: 0.0001867138469806535
epoch 14 training time: 17.566
---------------
2023-09-11 07:21:07.688754
current #epochs=15, #steps=560
start validation
acc: 0.611374
AUC: 0.677351
Avg Precision: 0.267769
Avg Recall: 1.000000
d_prime: 0.650966
train_loss: 0.885960
valid_loss: 1.275848
validation finished
normal learning rate scheduler step
Epoch-15 lr: 9.335692349032675e-05
Epoch-15 lr: 0.0001867138469806535
epoch 15 training time: 16.722
---------------
2023-09-11 07:21:24.410709
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03852	Per Sample Data Time 0.02905	Per Sample DNN Time 0.00946	Train Loss 0.9230	
start validation
acc: 0.616114
AUC: 0.685774
Avg Precision: 0.267101
Avg Recall: 1.000000
d_prime: 0.684349
train_loss: 0.872272
valid_loss: 1.292861
validation finished
normal learning rate scheduler step
Epoch-16 lr: 5.879253445180514e-05
Epoch-16 lr: 0.00011758506890361028
epoch 16 training time: 16.989
---------------
2023-09-11 07:21:41.400094
current #epochs=17, #steps=640
start validation
acc: 0.620853
AUC: 0.683280
Avg Precision: 0.268527
Avg Recall: 1.000000
d_prime: 0.674427
train_loss: 0.874772
valid_loss: 1.275379
validation finished
normal learning rate scheduler step
Epoch-17 lr: 5.879253445180514e-05
Epoch-17 lr: 0.00011758506890361028
epoch 17 training time: 19.150
---------------
2023-09-11 07:22:00.549234
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00702	Per Sample Data Time 0.00143	Per Sample DNN Time 0.00559	Train Loss 0.8689	
start validation
acc: 0.606635
AUC: 0.692534
Avg Precision: 0.267835
Avg Recall: 1.000000
d_prime: 0.711415
train_loss: 0.872860
valid_loss: 1.274110
validation finished
normal learning rate scheduler step
Epoch-18 lr: 5.879253445180514e-05
Epoch-18 lr: 0.00011758506890361028
epoch 18 training time: 15.020
---------------
2023-09-11 07:22:15.568954
current #epochs=19, #steps=720
start validation
acc: 0.606635
AUC: 0.691212
Avg Precision: 0.264968
Avg Recall: 1.000000
d_prime: 0.706101
train_loss: 0.882400
valid_loss: 1.278656
validation finished
normal learning rate scheduler step
Epoch-19 lr: 3.70252358157973e-05
Epoch-19 lr: 7.40504716315946e-05
epoch 19 training time: 15.826
---------------
2023-09-11 07:22:31.395503
current #epochs=20, #steps=760
start validation
acc: 0.611374
AUC: 0.694067
Avg Precision: 0.265531
Avg Recall: 1.000000
d_prime: 0.717588
train_loss: 0.865986
valid_loss: 1.274445
validation finished
normal learning rate scheduler step
Epoch-20 lr: 3.70252358157973e-05
Epoch-20 lr: 7.40504716315946e-05
epoch 20 training time: 15.083
---------------
2023-09-11 07:22:46.478646
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03474	Per Sample Data Time 0.02758	Per Sample DNN Time 0.00716	Train Loss 0.6694	
start validation
acc: 0.611374
AUC: 0.697396
Avg Precision: 0.265753
Avg Recall: 1.000000
d_prime: 0.731044
train_loss: 0.867489
valid_loss: 1.277777
validation finished
normal learning rate scheduler step
Epoch-21 lr: 3.70252358157973e-05
Epoch-21 lr: 7.40504716315946e-05
epoch 21 training time: 14.829
---------------
2023-09-11 07:23:01.307202
current #epochs=22, #steps=840
start validation
acc: 0.611374
AUC: 0.699636
Avg Precision: 0.265531
Avg Recall: 1.000000
d_prime: 0.740135
train_loss: 0.871528
valid_loss: 1.275598
validation finished
normal learning rate scheduler step
Epoch-22 lr: 2.331704356680117e-05
Epoch-22 lr: 4.663408713360234e-05
epoch 22 training time: 15.570
---------------
2023-09-11 07:23:16.877188
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00566	Train Loss 0.8490	
start validation
acc: 0.606635
AUC: 0.699765
Avg Precision: 0.265382
Avg Recall: 1.000000
d_prime: 0.740657
train_loss: 0.863910
valid_loss: 1.272235
validation finished
normal learning rate scheduler step
Epoch-23 lr: 2.331704356680117e-05
Epoch-23 lr: 4.663408713360234e-05
epoch 23 training time: 14.952
---------------
2023-09-11 07:23:31.828852
current #epochs=24, #steps=920
start validation
acc: 0.611374
AUC: 0.698963
Avg Precision: 0.265777
Avg Recall: 1.000000
d_prime: 0.737398
train_loss: 0.863663
valid_loss: 1.275010
validation finished
normal learning rate scheduler step
Epoch-24 lr: 2.331704356680117e-05
Epoch-24 lr: 4.663408713360234e-05
epoch 24 training time: 16.288
---------------
2023-09-11 07:23:48.116526
current #epochs=25, #steps=960
start validation
acc: 0.616114
AUC: 0.700113
Avg Precision: 0.265629
Avg Recall: 1.000000
d_prime: 0.742074
train_loss: 0.863783
valid_loss: 1.276854
validation finished
normal learning rate scheduler step
Epoch-25 lr: 1.4684160916650632e-05
Epoch-25 lr: 2.9368321833301265e-05
epoch 25 training time: 14.907
---------------
2023-09-11 07:24:03.023341
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03703	Per Sample Data Time 0.02710	Per Sample DNN Time 0.00993	Train Loss 0.9085	
start validation
acc: 0.616114
AUC: 0.700228
Avg Precision: 0.266340
Avg Recall: 1.000000
d_prime: 0.742542
train_loss: 0.852362
valid_loss: 1.273372
validation finished
normal learning rate scheduler step
Epoch-26 lr: 1.4684160916650632e-05
Epoch-26 lr: 2.9368321833301265e-05
epoch 26 training time: 14.942
---------------
2023-09-11 07:24:17.965717
current #epochs=27, #steps=1040
start validation
acc: 0.616114
AUC: 0.702530
Avg Precision: 0.265304
Avg Recall: 1.000000
d_prime: 0.751926
train_loss: 0.859121
valid_loss: 1.272248
validation finished
normal learning rate scheduler step
Epoch-27 lr: 1.4684160916650632e-05
Epoch-27 lr: 2.9368321833301265e-05
epoch 27 training time: 15.649
---------------
2023-09-11 07:24:33.614369
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00704	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00559	Train Loss 0.8613	
start validation
acc: 0.611374
AUC: 0.702976
Avg Precision: 0.265159
Avg Recall: 1.000000
d_prime: 0.753745
train_loss: 0.849579
valid_loss: 1.273071
validation finished
normal learning rate scheduler step
Epoch-28 lr: 9.247509497005718e-06
Epoch-28 lr: 1.8495018994011437e-05
epoch 28 training time: 14.908
---------------
2023-09-11 07:24:48.521911
current #epochs=29, #steps=1120
start validation
acc: 0.616114
AUC: 0.697483
Avg Precision: 0.265070
Avg Recall: 1.000000
d_prime: 0.731396
train_loss: 0.854805
valid_loss: 1.272949
validation finished
normal learning rate scheduler step
Epoch-29 lr: 9.247509497005718e-06
Epoch-29 lr: 1.8495018994011437e-05
epoch 29 training time: 16.197
---------------
2023-09-11 07:25:04.718467
current #epochs=30, #steps=1160
start validation
acc: 0.620853
AUC: 0.702062
Avg Precision: 0.265070
Avg Recall: 1.000000
d_prime: 0.750014
train_loss: 0.849171
valid_loss: 1.273014
validation finished
normal learning rate scheduler step
Epoch-30 lr: 9.247509497005718e-06
Epoch-30 lr: 1.8495018994011437e-05
epoch 30 training time: 15.103
---------------
2023-09-11 07:25:19.821421
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03808	Per Sample Data Time 0.02709	Per Sample DNN Time 0.01100	Train Loss 0.7699	
start validation
[I 2023-09-11 07:25:34,894] Trial 1 finished with value: 0.6208530805687204 and parameters: {'warmup': 'True', 'num_epochs': 31, 'batch_size': 36, 'lr-adaptschedule': 'False', 'lr': 0.0005935317116891605, 'head-lr': 2, 'lr-scheduler-start': 4, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.6297608388722983}. Best is trial 1 with value: 0.6208530805687204.
acc: 0.616114
AUC: 0.705386
Avg Precision: 0.264640
Avg Recall: 1.000000
d_prime: 0.763613
train_loss: 0.858963
valid_loss: 1.272634
validation finished
normal learning rate scheduler step
Epoch-31 lr: 5.823719338313867e-06
Epoch-31 lr: 1.1647438676627733e-05
epoch 31 training time: 15.068
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f86448acdf0>
The learning rate scheduler starts at 7 epoch with decay rate of 0.705 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 07:25:34.899753
current #epochs=1, #steps=0
start validation
acc: 0.317536
AUC: 0.476906
Avg Precision: 0.251472
Avg Recall: 1.000000
d_prime: -0.081914
train_loss: 1.355380
valid_loss: 1.371666
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0044773452843226555
Epoch-1 lr: 0.013432035852967966
epoch 1 training time: 17.071
---------------
2023-09-11 07:25:51.971244
current #epochs=2, #steps=40
start validation
acc: 0.530806
AUC: 0.425672
Avg Precision: 0.251282
Avg Recall: 1.000000
d_prime: -0.265030
train_loss: 1.133934
valid_loss: 1.356098
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0044773452843226555
Epoch-2 lr: 0.013432035852967966
epoch 2 training time: 17.485
---------------
2023-09-11 07:26:09.456427
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00703	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00559	Train Loss 1.1059	
start validation
acc: 0.530806
AUC: 0.507323
Avg Precision: 0.262321
Avg Recall: 1.000000
d_prime: 0.025960
train_loss: 1.108807
valid_loss: 1.350912
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0044773452843226555
Epoch-3 lr: 0.013432035852967966
epoch 3 training time: 15.016
---------------
2023-09-11 07:26:24.472013
current #epochs=4, #steps=120
start validation
acc: 0.530806
AUC: 0.528106
Avg Precision: 0.252681
Avg Recall: 1.000000
d_prime: 0.099716
train_loss: 1.104097
valid_loss: 1.352979
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0044773452843226555
Epoch-4 lr: 0.013432035852967966
epoch 4 training time: 14.885
---------------
2023-09-11 07:26:39.356830
current #epochs=5, #steps=160
start validation
acc: 0.530806
AUC: 0.538156
Avg Precision: 0.252396
Avg Recall: 1.000000
d_prime: 0.135468
train_loss: 1.103723
valid_loss: 1.350759
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0044773452843226555
Epoch-5 lr: 0.013432035852967966
epoch 5 training time: 14.977
---------------
2023-09-11 07:26:54.333634
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03373	Per Sample Data Time 0.02730	Per Sample DNN Time 0.00643	Train Loss 0.9884	
start validation
acc: 0.530806
AUC: 0.607170
Avg Precision: 0.256664
Avg Recall: 1.000000
d_prime: 0.384598
train_loss: 1.096160
valid_loss: 1.352627
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0044773452843226555
Epoch-6 lr: 0.013432035852967966
epoch 6 training time: 16.478
---------------
2023-09-11 07:27:10.811268
current #epochs=7, #steps=240
start validation
acc: 0.530806
AUC: 0.498114
Avg Precision: 0.252387
Avg Recall: 1.000000
d_prime: -0.006686
train_loss: 1.098010
valid_loss: 1.354396
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0031552927552940353
Epoch-7 lr: 0.009465878265882105
epoch 7 training time: 16.663
---------------
2023-09-11 07:27:27.474704
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00561	Train Loss 1.0853	
start validation
acc: 0.530806
AUC: 0.557595
Avg Precision: 0.256049
Avg Recall: 1.000000
d_prime: 0.204883
train_loss: 1.098420
valid_loss: 1.356255
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0031552927552940353
Epoch-8 lr: 0.009465878265882105
epoch 8 training time: 15.251
---------------
2023-09-11 07:27:42.726006
current #epochs=9, #steps=320
start validation
acc: 0.530806
AUC: 0.538503
Avg Precision: 0.258061
Avg Recall: 1.000000
d_prime: 0.136702
train_loss: 1.099701
valid_loss: 1.351624
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0031552927552940353
Epoch-9 lr: 0.009465878265882105
epoch 9 training time: 15.015
---------------
2023-09-11 07:27:57.740826
current #epochs=10, #steps=360
start validation
acc: 0.530806
AUC: 0.497127
Avg Precision: 0.254697
Avg Recall: 1.000000
d_prime: -0.010183
train_loss: 1.097277
valid_loss: 1.351083
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0031552927552940353
Epoch-10 lr: 0.009465878265882105
epoch 10 training time: 15.017
---------------
2023-09-11 07:28:12.757830
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03394	Per Sample Data Time 0.02685	Per Sample DNN Time 0.00709	Train Loss 1.1989	
start validation
acc: 0.530806
AUC: 0.513654
Avg Precision: 0.261555
Avg Recall: 1.000000
d_prime: 0.048412
train_loss: 1.097033
valid_loss: 1.353056
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0031552927552940353
Epoch-11 lr: 0.009465878265882105
epoch 11 training time: 14.894
---------------
2023-09-11 07:28:27.651902
current #epochs=12, #steps=440
start validation
acc: 0.530806
AUC: 0.536401
Avg Precision: 0.254437
Avg Recall: 1.000000
d_prime: 0.129219
train_loss: 1.096475
valid_loss: 1.351054
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0031552927552940353
Epoch-12 lr: 0.009465878265882105
epoch 12 training time: 14.949
---------------
2023-09-11 07:28:42.600704
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00560	Train Loss 1.0910	
start validation
acc: 0.530806
AUC: 0.591444
Avg Precision: 0.257345
Avg Recall: 1.000000
d_prime: 0.327053
train_loss: 1.092517
valid_loss: 1.350321
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0031552927552940353
Epoch-13 lr: 0.009465878265882105
epoch 13 training time: 14.951
---------------
2023-09-11 07:28:57.552320
current #epochs=14, #steps=520
start validation
acc: 0.530806
AUC: 0.509119
Avg Precision: 0.253158
Avg Recall: 1.000000
d_prime: 0.032329
train_loss: 1.099367
valid_loss: 1.354407
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0031552927552940353
Epoch-14 lr: 0.009465878265882105
epoch 14 training time: 14.991
---------------
2023-09-11 07:29:12.543651
current #epochs=15, #steps=560
start validation
acc: 0.549763
AUC: 0.572186
Avg Precision: 0.257809
Avg Recall: 1.000000
d_prime: 0.257305
train_loss: 1.095584
valid_loss: 1.353364
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0031552927552940353
Epoch-15 lr: 0.009465878265882105
epoch 15 training time: 18.747
---------------
2023-09-11 07:29:31.289953
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03804	Per Sample Data Time 0.02791	Per Sample DNN Time 0.01014	Train Loss 1.1228	
start validation
acc: 0.530806
AUC: 0.532208
Avg Precision: 0.258484
Avg Recall: 1.000000
d_prime: 0.114299
train_loss: 1.096628
valid_loss: 1.345398
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0031552927552940353
Epoch-16 lr: 0.009465878265882105
epoch 16 training time: 15.135
---------------
2023-09-11 07:29:46.424569
current #epochs=17, #steps=640
start validation
acc: 0.530806
AUC: 0.516824
Avg Precision: 0.252585
Avg Recall: 1.000000
d_prime: 0.059658
train_loss: 1.076670
valid_loss: 1.350101
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0022236105860477936
Epoch-17 lr: 0.00667083175814338
epoch 17 training time: 14.972
---------------
2023-09-11 07:30:01.396752
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00561	Train Loss 1.0985	
start validation
acc: 0.545024
AUC: 0.601409
Avg Precision: 0.254208
Avg Recall: 1.000000
d_prime: 0.363445
train_loss: 1.054281
valid_loss: 1.328750
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0022236105860477936
Epoch-18 lr: 0.00667083175814338
epoch 18 training time: 17.184
---------------
2023-09-11 07:30:18.580744
current #epochs=19, #steps=720
start validation
acc: 0.540284
AUC: 0.606538
Avg Precision: 0.256968
Avg Recall: 1.000000
d_prime: 0.382273
train_loss: 1.022668
valid_loss: 1.324650
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0022236105860477936
Epoch-19 lr: 0.00667083175814338
epoch 19 training time: 14.987
---------------
2023-09-11 07:30:33.567188
current #epochs=20, #steps=760
start validation
acc: 0.540284
AUC: 0.630070
Avg Precision: 0.257775
Avg Recall: 1.000000
d_prime: 0.469575
train_loss: 1.059649
valid_loss: 1.334298
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0022236105860477936
Epoch-20 lr: 0.00667083175814338
epoch 20 training time: 16.303
---------------
2023-09-11 07:30:49.870403
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03517	Per Sample Data Time 0.02656	Per Sample DNN Time 0.00861	Train Loss 1.1559	
start validation
acc: 0.530806
AUC: 0.667042
Avg Precision: 0.262902
Avg Recall: 1.000000
d_prime: 0.610601
train_loss: 1.021566
valid_loss: 1.329669
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0022236105860477936
Epoch-21 lr: 0.00667083175814338
epoch 21 training time: 14.946
---------------
2023-09-11 07:31:04.816510
current #epochs=22, #steps=840
start validation
acc: 0.530806
AUC: 0.684793
Avg Precision: 0.264740
Avg Recall: 1.000000
d_prime: 0.680442
train_loss: 1.016370
valid_loss: 1.320676
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0022236105860477936
Epoch-22 lr: 0.00667083175814338
epoch 22 training time: 16.349
---------------
2023-09-11 07:31:21.165550
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00701	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00556	Train Loss 1.0195	
start validation
acc: 0.601896
AUC: 0.696815
Avg Precision: 0.261283
Avg Recall: 1.000000
d_prime: 0.728691
train_loss: 0.987696
valid_loss: 1.318644
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0022236105860477936
Epoch-23 lr: 0.00667083175814338
epoch 23 training time: 16.841
---------------
2023-09-11 07:31:38.006793
current #epochs=24, #steps=920
start validation
acc: 0.620853
AUC: 0.690225
Avg Precision: 0.259412
Avg Recall: 1.000000
d_prime: 0.702141
train_loss: 0.991630
valid_loss: 1.318248
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0022236105860477936
Epoch-24 lr: 0.00667083175814338
epoch 24 training time: 21.222
---------------
2023-09-11 07:31:59.229231
current #epochs=25, #steps=960
start validation
acc: 0.545024
AUC: 0.685733
Avg Precision: 0.256741
Avg Recall: 1.000000
d_prime: 0.684185
train_loss: 0.953552
valid_loss: 1.302346
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0022236105860477936
Epoch-25 lr: 0.00667083175814338
epoch 25 training time: 18.219
---------------
2023-09-11 07:32:17.447686
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03653	Per Sample Data Time 0.02948	Per Sample DNN Time 0.00705	Train Loss 0.7222	
start validation
acc: 0.578199
AUC: 0.681504
Avg Precision: 0.265734
Avg Recall: 1.000000
d_prime: 0.667381
train_loss: 0.936815
valid_loss: 1.299117
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0022236105860477936
Epoch-26 lr: 0.00667083175814338
epoch 26 training time: 15.997
---------------
2023-09-11 07:32:33.445251
current #epochs=27, #steps=1040
start validation
acc: 0.578199
AUC: 0.677867
Avg Precision: 0.259557
Avg Recall: 1.000000
d_prime: 0.653001
train_loss: 0.947550
valid_loss: 1.314743
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0015670317849549428
Epoch-27 lr: 0.004701095354864828
epoch 27 training time: 14.961
---------------
2023-09-11 07:32:48.405580
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00701	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00555	Train Loss 0.9646	
start validation
acc: 0.563981
AUC: 0.680670
Avg Precision: 0.263297
Avg Recall: 1.000000
d_prime: 0.664076
train_loss: 0.946910
valid_loss: 1.304773
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0015670317849549428
Epoch-28 lr: 0.004701095354864828
epoch 28 training time: 15.297
---------------
2023-09-11 07:33:03.702994
current #epochs=29, #steps=1120
start validation
acc: 0.611374
AUC: 0.664315
Avg Precision: 0.276557
Avg Recall: 1.000000
d_prime: 0.600006
train_loss: 0.941853
valid_loss: 1.305107
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0015670317849549428
Epoch-29 lr: 0.004701095354864828
epoch 29 training time: 16.278
---------------
2023-09-11 07:33:19.981005
current #epochs=30, #steps=1160
start validation
acc: 0.578199
AUC: 0.693167
Avg Precision: 0.266044
Avg Recall: 1.000000
d_prime: 0.713962
train_loss: 0.911519
valid_loss: 1.287364
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0015670317849549428
Epoch-30 lr: 0.004701095354864828
epoch 30 training time: 14.948
---------------
2023-09-11 07:33:34.928817
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03425	Per Sample Data Time 0.02724	Per Sample DNN Time 0.00701	Train Loss 0.9994	
start validation
acc: 0.568720
AUC: 0.696268
Avg Precision: 0.281446
Avg Recall: 1.000000
d_prime: 0.726476
train_loss: 0.908349
valid_loss: 1.293314
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0015670317849549428
Epoch-31 lr: 0.004701095354864828
epoch 31 training time: 16.401
---------------
2023-09-11 07:33:51.330275
current #epochs=32, #steps=1240
start validation
acc: 0.644550
AUC: 0.682713
Avg Precision: 0.261185
Avg Recall: 1.000000
d_prime: 0.672174
train_loss: 0.908887
valid_loss: 1.285408
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0015670317849549428
Epoch-32 lr: 0.004701095354864828
epoch 32 training time: 17.156
---------------
2023-09-11 07:34:08.485964
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00565	Train Loss 0.8812	
start validation
acc: 0.606635
AUC: 0.687831
Avg Precision: 0.257993
Avg Recall: 1.000000
d_prime: 0.692557
train_loss: 0.903759
valid_loss: 1.295038
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0015670317849549428
Epoch-33 lr: 0.004701095354864828
epoch 33 training time: 15.079
---------------
2023-09-11 07:34:23.565016
current #epochs=34, #steps=1320
start validation
acc: 0.573460
AUC: 0.682936
Avg Precision: 0.263388
Avg Recall: 1.000000
d_prime: 0.673058
train_loss: 0.922513
valid_loss: 1.299128
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0015670317849549428
Epoch-34 lr: 0.004701095354864828
epoch 34 training time: 14.865
---------------
2023-09-11 07:34:38.430534
current #epochs=35, #steps=1360
start validation
acc: 0.644550
AUC: 0.688409
Avg Precision: 0.257866
Avg Recall: 1.000000
d_prime: 0.694866
train_loss: 0.897817
valid_loss: 1.293646
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0015670317849549428
Epoch-35 lr: 0.004701095354864828
epoch 35 training time: 14.960
---------------
2023-09-11 07:34:53.390488
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03942	Per Sample Data Time 0.02960	Per Sample DNN Time 0.00981	Train Loss 1.0364	
start validation
acc: 0.639810
AUC: 0.685947
Avg Precision: 0.275776
Avg Recall: 1.000000
d_prime: 0.685037
train_loss: 0.900113
valid_loss: 1.289805
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0015670317849549428
Epoch-36 lr: 0.004701095354864828
epoch 36 training time: 15.133
---------------
2023-09-11 07:35:08.523260
current #epochs=37, #steps=1440
start validation
acc: 0.654028
AUC: 0.694695
Avg Precision: 0.264514
Avg Recall: 1.000000
d_prime: 0.720122
train_loss: 0.889840
valid_loss: 1.294314
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0011043249346206767
Epoch-37 lr: 0.0033129748038620297
epoch 37 training time: 16.949
---------------
2023-09-11 07:35:25.472616
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00141	Per Sample DNN Time 0.00565	Train Loss 0.8851	
start validation
acc: 0.616114
AUC: 0.707831
Avg Precision: 0.277022
Avg Recall: 1.000000
d_prime: 0.773660
train_loss: 0.884957
valid_loss: 1.282654
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0011043249346206767
Epoch-38 lr: 0.0033129748038620297
epoch 38 training time: 14.975
---------------
2023-09-11 07:35:40.447994
current #epochs=39, #steps=1520
start validation
acc: 0.606635
AUC: 0.697382
Avg Precision: 0.263177
Avg Recall: 1.000000
d_prime: 0.730988
train_loss: 0.889471
valid_loss: 1.293185
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0011043249346206767
Epoch-39 lr: 0.0033129748038620297
epoch 39 training time: 15.029
---------------
2023-09-11 07:35:55.476546
current #epochs=40, #steps=1560
start validation
acc: 0.597156
AUC: 0.699484
Avg Precision: 0.261856
Avg Recall: 1.000000
d_prime: 0.739516
train_loss: 0.876118
valid_loss: 1.291174
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0011043249346206767
Epoch-40 lr: 0.0033129748038620297
epoch 40 training time: 15.044
---------------
2023-09-11 07:36:10.520605
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03634	Per Sample Data Time 0.02787	Per Sample DNN Time 0.00847	Train Loss 0.8349	
start validation
acc: 0.635071
AUC: 0.701916
Avg Precision: 0.274552
Avg Recall: 1.000000
d_prime: 0.749420
train_loss: 0.868625
valid_loss: 1.275411
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0011043249346206767
Epoch-41 lr: 0.0033129748038620297
epoch 41 training time: 14.928
---------------
2023-09-11 07:36:25.448913
current #epochs=42, #steps=1640
start validation
acc: 0.611374
AUC: 0.708556
Avg Precision: 0.279424
Avg Recall: 1.000000
d_prime: 0.776644
train_loss: 0.866314
valid_loss: 1.283951
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0011043249346206767
Epoch-42 lr: 0.0033129748038620297
epoch 42 training time: 16.731
---------------
2023-09-11 07:36:42.180644
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00559	Train Loss 0.8620	
start validation
acc: 0.601896
AUC: 0.704589
Avg Precision: 0.267234
Avg Recall: 1.000000
d_prime: 0.760344
train_loss: 0.861673
valid_loss: 1.286697
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0011043249346206767
Epoch-43 lr: 0.0033129748038620297
epoch 43 training time: 17.270
---------------
2023-09-11 07:36:59.450492
current #epochs=44, #steps=1720
start validation
acc: 0.592417
AUC: 0.711736
Avg Precision: 0.270425
Avg Recall: 1.000000
d_prime: 0.789786
train_loss: 0.857824
valid_loss: 1.283489
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0011043249346206767
Epoch-44 lr: 0.0033129748038620297
epoch 44 training time: 14.978
---------------
2023-09-11 07:37:14.428641
current #epochs=45, #steps=1760
start validation
acc: 0.644550
AUC: 0.710381
Avg Precision: 0.266040
Avg Recall: 1.000000
d_prime: 0.784180
train_loss: 0.853624
valid_loss: 1.272058
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0011043249346206767
Epoch-45 lr: 0.0033129748038620297
epoch 45 training time: 15.071
---------------
2023-09-11 07:37:29.499646
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03534	Per Sample Data Time 0.02799	Per Sample DNN Time 0.00734	Train Loss 0.8388	
start validation
acc: 0.630332
AUC: 0.701423
Avg Precision: 0.264138
Avg Recall: 1.000000
d_prime: 0.747408
train_loss: 0.848322
valid_loss: 1.272548
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.0011043249346206767
Epoch-46 lr: 0.0033129748038620297
epoch 46 training time: 15.094
---------------
2023-09-11 07:37:44.594141
current #epochs=47, #steps=1840
start validation
acc: 0.616114
AUC: 0.711534
Avg Precision: 0.263996
Avg Recall: 1.000000
d_prime: 0.788949
train_loss: 0.846254
valid_loss: 1.262392
validation finished
normal learning rate scheduler step
Epoch-47 lr: 0.0007782443042532334
Epoch-47 lr: 0.0023347329127597
epoch 47 training time: 14.915
---------------
2023-09-11 07:37:59.509051
current #epochs=48, #steps=1880
Epoch: [48][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00563	Train Loss 0.8373	
start validation
[I 2023-09-11 07:38:14,486] Trial 2 finished with value: 0.6540284360189573 and parameters: {'warmup': 'True', 'num_epochs': 48, 'batch_size': 9, 'lr-adaptschedule': 'False', 'lr': 0.0044773452843226555, 'head-lr': 3, 'lr-scheduler-start': 7, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.7047240172300842}. Best is trial 2 with value: 0.6540284360189573.
acc: 0.625592
AUC: 0.715738
Avg Precision: 0.268467
Avg Recall: 1.000000
d_prime: 0.806420
train_loss: 0.846065
valid_loss: 1.261059
validation finished
normal learning rate scheduler step
Epoch-48 lr: 0.0007782443042532334
Epoch-48 lr: 0.0023347329127597
epoch 48 training time: 14.972
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f85b52a3880>
The learning rate scheduler starts at 7 epoch with decay rate of 0.805 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 07:38:14.491966
current #epochs=1, #steps=0
start validation
acc: 0.573460
AUC: 0.718668
Avg Precision: 0.260621
Avg Recall: 1.000000
d_prime: 0.818675
train_loss: 0.911954
valid_loss: 1.283594
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0025720619405081575
Epoch-1 lr: 0.012860309702540788
epoch 1 training time: 16.767
---------------
2023-09-11 07:38:31.259708
current #epochs=2, #steps=40
start validation
acc: 0.592417
AUC: 0.722024
Avg Precision: 0.266096
Avg Recall: 1.000000
d_prime: 0.832779
train_loss: 0.888018
valid_loss: 1.280606
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0025720619405081575
Epoch-2 lr: 0.012860309702540788
epoch 2 training time: 17.113
---------------
2023-09-11 07:38:48.372297
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00700	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00554	Train Loss 0.8674	
start validation
acc: 0.559242
AUC: 0.713735
Avg Precision: 0.274592
Avg Recall: 1.000000
d_prime: 0.798084
train_loss: 0.888535
valid_loss: 1.306630
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0025720619405081575
Epoch-3 lr: 0.012860309702540788
epoch 3 training time: 14.943
---------------
2023-09-11 07:39:03.315948
current #epochs=4, #steps=120
start validation
acc: 0.663507
AUC: 0.735963
Avg Precision: 0.279127
Avg Recall: 1.000000
d_prime: 0.892298
train_loss: 0.920332
valid_loss: 1.272977
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0025720619405081575
Epoch-4 lr: 0.012860309702540788
epoch 4 training time: 17.024
---------------
2023-09-11 07:39:20.339701
current #epochs=5, #steps=160
start validation
acc: 0.578199
AUC: 0.744014
Avg Precision: 0.288470
Avg Recall: 1.000000
d_prime: 0.927397
train_loss: 0.876509
valid_loss: 1.276264
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0025720619405081575
Epoch-5 lr: 0.012860309702540788
epoch 5 training time: 16.281
---------------
2023-09-11 07:39:36.620600
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03782	Per Sample Data Time 0.02797	Per Sample DNN Time 0.00985	Train Loss 0.9160	
start validation
acc: 0.587678
AUC: 0.740901
Avg Precision: 0.284368
Avg Recall: 1.000000
d_prime: 0.913761
train_loss: 0.886161
valid_loss: 1.275446
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0025720619405081575
Epoch-6 lr: 0.012860309702540788
epoch 6 training time: 15.088
---------------
2023-09-11 07:39:51.709016
current #epochs=7, #steps=240
start validation
acc: 0.630332
AUC: 0.738839
Avg Precision: 0.271239
Avg Recall: 1.000000
d_prime: 0.904774
train_loss: 0.863657
valid_loss: 1.275066
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0020702787967482495
Epoch-7 lr: 0.010351393983741249
epoch 7 training time: 14.907
---------------
2023-09-11 07:40:06.615682
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00561	Train Loss 0.8550	
start validation
acc: 0.563981
AUC: 0.739095
Avg Precision: 0.267388
Avg Recall: 1.000000
d_prime: 0.905884
train_loss: 0.858068
valid_loss: 1.281405
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0020702787967482495
Epoch-8 lr: 0.010351393983741249
epoch 8 training time: 15.005
---------------
2023-09-11 07:40:21.620744
current #epochs=9, #steps=320
start validation
acc: 0.601896
AUC: 0.749566
Avg Precision: 0.279448
Avg Recall: 1.000000
d_prime: 0.951943
train_loss: 0.862863
valid_loss: 1.263534
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0020702787967482495
Epoch-9 lr: 0.010351393983741249
epoch 9 training time: 16.472
---------------
2023-09-11 07:40:38.092967
current #epochs=10, #steps=360
start validation
[I 2023-09-11 07:40:53,970] Trial 3 finished with value: 0.6635071090047393 and parameters: {'warmup': 'False', 'num_epochs': 10, 'batch_size': 32, 'lr-adaptschedule': 'True', 'lr': 0.0025720619405081575, 'head-lr': 5, 'lr-scheduler-start': 7, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.8049101633762477}. Best is trial 3 with value: 0.6635071090047393.
acc: 0.635071
AUC: 0.775116
Avg Precision: 0.278518
Avg Recall: 1.000000
d_prime: 1.068865
train_loss: 0.841274
valid_loss: 1.235561
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0020702787967482495
Epoch-10 lr: 0.010351393983741249
epoch 10 training time: 15.874
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863f010bb0>
The learning rate scheduler starts at 8 epoch with decay rate of 0.774 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 07:40:53.976342
current #epochs=1, #steps=0
start validation
acc: 0.658768
AUC: 0.741333
Avg Precision: 0.271427
Avg Recall: 1.000000
d_prime: 0.915649
train_loss: 0.884734
valid_loss: 1.252238
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0043935854135118135
Epoch-1 lr: 0.0043935854135118135
epoch 1 training time: 16.970
---------------
2023-09-11 07:41:10.946352
current #epochs=2, #steps=40
start validation
acc: 0.635071
AUC: 0.773660
Avg Precision: 0.274078
Avg Recall: 1.000000
d_prime: 1.062011
train_loss: 0.863358
valid_loss: 1.271809
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0043935854135118135
Epoch-2 lr: 0.0043935854135118135
epoch 2 training time: 14.889
---------------
2023-09-11 07:41:25.835682
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00704	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00560	Train Loss 0.8590	
start validation
acc: 0.644550
AUC: 0.739742
Avg Precision: 0.264082
Avg Recall: 1.000000
d_prime: 0.908705
train_loss: 0.872066
valid_loss: 1.264459
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0043935854135118135
Epoch-3 lr: 0.0043935854135118135
epoch 3 training time: 14.943
---------------
2023-09-11 07:41:40.779327
current #epochs=4, #steps=120
start validation
acc: 0.639810
AUC: 0.767274
Avg Precision: 0.273685
Avg Recall: 1.000000
d_prime: 1.032234
train_loss: 0.857915
valid_loss: 1.240607
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0043935854135118135
Epoch-4 lr: 0.0043935854135118135
epoch 4 training time: 16.296
---------------
2023-09-11 07:41:57.074763
current #epochs=5, #steps=160
start validation
acc: 0.573460
AUC: 0.763990
Avg Precision: 0.286734
Avg Recall: 1.000000
d_prime: 1.017098
train_loss: 0.846388
valid_loss: 1.270114
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0043935854135118135
Epoch-5 lr: 0.0043935854135118135
epoch 5 training time: 16.136
---------------
2023-09-11 07:42:13.210363
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03509	Per Sample Data Time 0.02811	Per Sample DNN Time 0.00698	Train Loss 0.8833	
start validation
acc: 0.611374
AUC: 0.788876
Avg Precision: 0.287197
Avg Recall: 1.000000
d_prime: 1.134944
train_loss: 0.861401
valid_loss: 1.239529
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0043935854135118135
Epoch-6 lr: 0.0043935854135118135
epoch 6 training time: 15.226
---------------
2023-09-11 07:42:28.436211
current #epochs=7, #steps=240
start validation
acc: 0.554502
AUC: 0.704661
Avg Precision: 0.255021
Avg Recall: 1.000000
d_prime: 0.760642
train_loss: 0.893519
valid_loss: 1.307350
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0043935854135118135
Epoch-7 lr: 0.0043935854135118135
epoch 7 training time: 14.923
---------------
2023-09-11 07:42:43.359502
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00560	Train Loss 1.0014	
start validation
acc: 0.530806
AUC: 0.628657
Avg Precision: 0.262525
Avg Recall: 1.000000
d_prime: 0.464283
train_loss: 1.010147
valid_loss: 1.343652
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0034023881773411497
Epoch-8 lr: 0.0034023881773411497
epoch 8 training time: 15.024
---------------
2023-09-11 07:42:58.383636
current #epochs=9, #steps=320
start validation
acc: 0.530806
AUC: 0.635255
Avg Precision: 0.259711
Avg Recall: 1.000000
d_prime: 0.489040
train_loss: 1.035203
valid_loss: 1.331587
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0034023881773411497
Epoch-9 lr: 0.0034023881773411497
epoch 9 training time: 16.222
---------------
2023-09-11 07:43:14.605918
current #epochs=10, #steps=360
start validation
acc: 0.545024
AUC: 0.671464
Avg Precision: 0.266220
Avg Recall: 1.000000
d_prime: 0.627854
train_loss: 1.003751
valid_loss: 1.315739
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0034023881773411497
Epoch-10 lr: 0.0034023881773411497
epoch 10 training time: 15.007
---------------
2023-09-11 07:43:29.613670
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03931	Per Sample Data Time 0.02922	Per Sample DNN Time 0.01009	Train Loss 0.9832	
start validation
acc: 0.573460
AUC: 0.752052
Avg Precision: 0.268146
Avg Recall: 1.000000
d_prime: 0.963027
train_loss: 0.911807
valid_loss: 1.276692
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0034023881773411497
Epoch-11 lr: 0.0034023881773411497
epoch 11 training time: 15.112
---------------
2023-09-11 07:43:44.725596
current #epochs=12, #steps=440
start validation
acc: 0.592417
AUC: 0.726492
Avg Precision: 0.271865
Avg Recall: 1.000000
d_prime: 0.851692
train_loss: 0.868002
valid_loss: 1.268511
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0034023881773411497
Epoch-12 lr: 0.0034023881773411497
epoch 12 training time: 14.962
---------------
2023-09-11 07:43:59.687868
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00704	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00560	Train Loss 0.8720	
start validation
acc: 0.578199
AUC: 0.764962
Avg Precision: 0.272900
Avg Recall: 1.000000
d_prime: 1.021564
train_loss: 0.869141
valid_loss: 1.265371
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0034023881773411497
Epoch-13 lr: 0.0034023881773411497
epoch 13 training time: 14.886
---------------
2023-09-11 07:44:14.573212
current #epochs=14, #steps=520
start validation
acc: 0.592417
AUC: 0.778790
Avg Precision: 0.267540
Avg Recall: 1.000000
d_prime: 1.086275
train_loss: 0.858132
valid_loss: 1.278402
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0034023881773411497
Epoch-14 lr: 0.0034023881773411497
epoch 14 training time: 15.005
---------------
2023-09-11 07:44:29.578080
current #epochs=15, #steps=560
start validation
acc: 0.654028
AUC: 0.779028
Avg Precision: 0.276282
Avg Recall: 1.000000
d_prime: 1.087409
train_loss: 0.866088
valid_loss: 1.251313
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0034023881773411497
Epoch-15 lr: 0.0034023881773411497
epoch 15 training time: 16.225
---------------
2023-09-11 07:44:45.803318
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03632	Per Sample Data Time 0.02902	Per Sample DNN Time 0.00730	Train Loss 0.9261	
start validation
acc: 0.625592
AUC: 0.796845
Avg Precision: 0.268222
Avg Recall: 1.000000
d_prime: 1.174370
train_loss: 0.850072
valid_loss: 1.223210
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0034023881773411497
Epoch-16 lr: 0.0034023881773411497
epoch 16 training time: 15.320
---------------
2023-09-11 07:45:01.123338
current #epochs=17, #steps=640
start validation
acc: 0.668246
AUC: 0.801712
Avg Precision: 0.286881
Avg Recall: 1.000000
d_prime: 1.198905
train_loss: 0.797272
valid_loss: 1.226023
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0034023881773411497
Epoch-17 lr: 0.0034023881773411497
epoch 17 training time: 17.019
---------------
2023-09-11 07:45:18.142662
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00564	Train Loss 0.8075	
start validation
acc: 0.654028
AUC: 0.791019
Avg Precision: 0.288000
Avg Recall: 1.000000
d_prime: 1.145458
train_loss: 0.803180
valid_loss: 1.237517
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.002634806022823597
Epoch-18 lr: 0.002634806022823597
epoch 18 training time: 14.985
---------------
2023-09-11 07:45:33.128375
current #epochs=19, #steps=720
start validation
acc: 0.654028
AUC: 0.806929
Avg Precision: 0.291686
Avg Recall: 1.000000
d_prime: 1.225608
train_loss: 0.814706
valid_loss: 1.233735
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.002634806022823597
Epoch-19 lr: 0.002634806022823597
epoch 19 training time: 14.998
---------------
2023-09-11 07:45:48.126657
current #epochs=20, #steps=760
start validation
acc: 0.635071
AUC: 0.807391
Avg Precision: 0.289459
Avg Recall: 1.000000
d_prime: 1.227992
train_loss: 0.782167
valid_loss: 1.226715
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.002634806022823597
Epoch-20 lr: 0.002634806022823597
epoch 20 training time: 15.033
---------------
2023-09-11 07:46:03.159578
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03504	Per Sample Data Time 0.02769	Per Sample DNN Time 0.00735	Train Loss 0.8865	
start validation
acc: 0.701422
AUC: 0.810703
Avg Precision: 0.299307
Avg Recall: 1.000000
d_prime: 1.245203
train_loss: 0.771128
valid_loss: 1.211561
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.002634806022823597
Epoch-21 lr: 0.002634806022823597
epoch 21 training time: 16.908
---------------
2023-09-11 07:46:20.067778
current #epochs=22, #steps=840
start validation
acc: 0.687204
AUC: 0.799407
Avg Precision: 0.290515
Avg Recall: 1.000000
d_prime: 1.187240
train_loss: 0.772811
valid_loss: 1.215540
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.002634806022823597
Epoch-22 lr: 0.002634806022823597
epoch 22 training time: 15.009
---------------
2023-09-11 07:46:35.077199
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00704	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00559	Train Loss 0.7379	
start validation
acc: 0.696682
AUC: 0.807230
Avg Precision: 0.283460
Avg Recall: 1.000000
d_prime: 1.227160
train_loss: 0.761509
valid_loss: 1.216752
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.002634806022823597
Epoch-23 lr: 0.002634806022823597
epoch 23 training time: 14.848
---------------
2023-09-11 07:46:49.925519
current #epochs=24, #steps=920
start validation
acc: 0.668246
AUC: 0.802648
Avg Precision: 0.273075
Avg Recall: 1.000000
d_prime: 1.203661
train_loss: 0.761342
valid_loss: 1.217234
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.002634806022823597
Epoch-24 lr: 0.002634806022823597
epoch 24 training time: 15.857
---------------
2023-09-11 07:47:05.782632
current #epochs=25, #steps=960
start validation
acc: 0.611374
AUC: 0.776987
Avg Precision: 0.296827
Avg Recall: 1.000000
d_prime: 1.077712
train_loss: 0.842071
valid_loss: 1.251551
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.002634806022823597
Epoch-25 lr: 0.002634806022823597
epoch 25 training time: 16.603
---------------
2023-09-11 07:47:22.386123
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03374	Per Sample Data Time 0.02718	Per Sample DNN Time 0.00656	Train Loss 0.8029	
start validation
acc: 0.696682
AUC: 0.814473
Avg Precision: 0.301516
Avg Recall: 1.000000
d_prime: 1.265015
train_loss: 0.765852
valid_loss: 1.215554
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.002634806022823597
Epoch-26 lr: 0.002634806022823597
epoch 26 training time: 14.910
---------------
2023-09-11 07:47:37.295853
current #epochs=27, #steps=1040
start validation
acc: 0.696682
AUC: 0.811120
Avg Precision: 0.299565
Avg Recall: 1.000000
d_prime: 1.247383
train_loss: 0.762286
valid_loss: 1.204907
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.002634806022823597
Epoch-27 lr: 0.002634806022823597
epoch 27 training time: 15.106
---------------
2023-09-11 07:47:52.401835
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00565	Train Loss 0.7459	
start validation
acc: 0.682464
AUC: 0.812963
Avg Precision: 0.300117
Avg Recall: 1.000000
d_prime: 1.257047
train_loss: 0.760644
valid_loss: 1.213780
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0020403911652822036
Epoch-28 lr: 0.0020403911652822036
epoch 28 training time: 16.458
---------------
2023-09-11 07:48:08.859965
current #epochs=29, #steps=1120
start validation
acc: 0.672986
AUC: 0.830579
Avg Precision: 0.296187
Avg Recall: 1.000000
d_prime: 1.352632
train_loss: 0.743859
valid_loss: 1.194838
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0020403911652822036
Epoch-29 lr: 0.0020403911652822036
epoch 29 training time: 14.994
---------------
2023-09-11 07:48:23.854059
current #epochs=30, #steps=1160
start validation
acc: 0.677725
AUC: 0.827495
Avg Precision: 0.293282
Avg Recall: 1.000000
d_prime: 1.335461
train_loss: 0.743345
valid_loss: 1.178939
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0020403911652822036
Epoch-30 lr: 0.0020403911652822036
epoch 30 training time: 15.871
---------------
2023-09-11 07:48:39.725209
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03745	Per Sample Data Time 0.02760	Per Sample DNN Time 0.00985	Train Loss 0.8235	
start validation
acc: 0.630332
AUC: 0.806379
Avg Precision: 0.282000
Avg Recall: 1.000000
d_prime: 1.222771
train_loss: 0.755997
valid_loss: 1.240422
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0020403911652822036
Epoch-31 lr: 0.0020403911652822036
epoch 31 training time: 15.079
---------------
2023-09-11 07:48:54.803889
current #epochs=32, #steps=1240
start validation
acc: 0.677725
AUC: 0.815135
Avg Precision: 0.297101
Avg Recall: 1.000000
d_prime: 1.268520
train_loss: 0.764316
valid_loss: 1.221507
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0020403911652822036
Epoch-32 lr: 0.0020403911652822036
epoch 32 training time: 14.954
---------------
2023-09-11 07:49:09.757645
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00704	Per Sample Data Time 0.00143	Per Sample DNN Time 0.00561	Train Loss 0.7624	
start validation
acc: 0.706161
AUC: 0.807988
Avg Precision: 0.278179
Avg Recall: 1.000000
d_prime: 1.231080
train_loss: 0.766307
valid_loss: 1.201130
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0020403911652822036
Epoch-33 lr: 0.0020403911652822036
epoch 33 training time: 16.984
---------------
2023-09-11 07:49:26.741965
current #epochs=34, #steps=1320
start validation
acc: 0.672986
AUC: 0.842659
Avg Precision: 0.298495
Avg Recall: 1.000000
d_prime: 1.421913
train_loss: 0.745608
valid_loss: 1.195620
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0020403911652822036
Epoch-34 lr: 0.0020403911652822036
epoch 34 training time: 16.774
---------------
2023-09-11 07:49:43.515689
current #epochs=35, #steps=1360
start validation
[I 2023-09-11 07:49:58,330] Trial 4 finished with value: 0.7061611374407583 and parameters: {'warmup': 'True', 'num_epochs': 35, 'batch_size': 44, 'lr-adaptschedule': 'True', 'lr': 0.0043935854135118135, 'head-lr': 1, 'lr-scheduler-start': 8, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.7743990060777275}. Best is trial 4 with value: 0.7061611374407583.
acc: 0.696682
AUC: 0.836947
Avg Precision: 0.309353
Avg Recall: 1.000000
d_prime: 1.388740
train_loss: 0.738758
valid_loss: 1.211597
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0020403911652822036
Epoch-35 lr: 0.0020403911652822036
epoch 35 training time: 14.810
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863d9b0f40>
The learning rate scheduler starts at 6 epoch with decay rate of 0.828 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 07:49:58.336673
current #epochs=1, #steps=0
start validation
acc: 0.654028
AUC: 0.831238
Avg Precision: 0.285442
Avg Recall: 1.000000
d_prime: 1.356328
train_loss: 0.754442
valid_loss: 1.200105
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0022633716048290234
Epoch-1 lr: 0.009053486419316093
epoch 1 training time: 16.745
---------------
2023-09-11 07:50:15.082007
current #epochs=2, #steps=40
start validation
acc: 0.715640
AUC: 0.829258
Avg Precision: 0.294930
Avg Recall: 1.000000
d_prime: 1.345252
train_loss: 0.749524
valid_loss: 1.181507
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0022633716048290234
Epoch-2 lr: 0.009053486419316093
epoch 2 training time: 18.303
---------------
2023-09-11 07:50:33.384778
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00700	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00556	Train Loss 0.6862	
start validation
acc: 0.663507
AUC: 0.825249
Avg Precision: 0.298615
Avg Recall: 1.000000
d_prime: 1.323077
train_loss: 0.717719
valid_loss: 1.181556
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0022633716048290234
Epoch-3 lr: 0.009053486419316093
epoch 3 training time: 14.981
---------------
2023-09-11 07:50:48.366000
current #epochs=4, #steps=120
start validation
acc: 0.701422
AUC: 0.825362
Avg Precision: 0.302499
Avg Recall: 1.000000
d_prime: 1.323698
train_loss: 0.748588
valid_loss: 1.202465
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0022633716048290234
Epoch-4 lr: 0.009053486419316093
epoch 4 training time: 14.887
---------------
2023-09-11 07:51:03.252891
current #epochs=5, #steps=160
start validation
acc: 0.701422
AUC: 0.846884
Avg Precision: 0.298771
Avg Recall: 1.000000
d_prime: 1.446967
train_loss: 0.705885
valid_loss: 1.170214
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0022633716048290234
Epoch-5 lr: 0.009053486419316093
epoch 5 training time: 14.932
---------------
2023-09-11 07:51:18.184589
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03543	Per Sample Data Time 0.02832	Per Sample DNN Time 0.00711	Train Loss 0.7892	
start validation
acc: 0.715640
AUC: 0.830953
Avg Precision: 0.293755
Avg Recall: 1.000000
d_prime: 1.354731
train_loss: 0.734062
valid_loss: 1.169027
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0018738671402710424
Epoch-6 lr: 0.0074954685610841695
epoch 6 training time: 14.890
---------------
2023-09-11 07:51:33.074906
current #epochs=7, #steps=240
start validation
acc: 0.682464
AUC: 0.835330
Avg Precision: 0.290286
Avg Recall: 1.000000
d_prime: 1.379484
train_loss: 0.725951
valid_loss: 1.171176
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0018738671402710424
Epoch-7 lr: 0.0074954685610841695
epoch 7 training time: 15.446
---------------
2023-09-11 07:51:48.520501
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00562	Train Loss 0.7384	
start validation
acc: 0.658768
AUC: 0.817040
Avg Precision: 0.287777
Avg Recall: 1.000000
d_prime: 1.278649
train_loss: 0.725901
valid_loss: 1.200948
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0018738671402710424
Epoch-8 lr: 0.0074954685610841695
epoch 8 training time: 16.497
---------------
2023-09-11 07:52:05.017799
current #epochs=9, #steps=320
start validation
acc: 0.701422
AUC: 0.833996
Avg Precision: 0.280673
Avg Recall: 1.000000
d_prime: 1.371897
train_loss: 0.707179
valid_loss: 1.170384
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0018738671402710424
Epoch-9 lr: 0.0074954685610841695
epoch 9 training time: 17.633
---------------
2023-09-11 07:52:22.651370
current #epochs=10, #steps=360
start validation
acc: 0.677725
AUC: 0.834591
Avg Precision: 0.288108
Avg Recall: 1.000000
d_prime: 1.375274
train_loss: 0.722376
valid_loss: 1.191542
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0018738671402710424
Epoch-10 lr: 0.0074954685610841695
epoch 10 training time: 14.839
---------------
2023-09-11 07:52:37.490146
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03866	Per Sample Data Time 0.03017	Per Sample DNN Time 0.00849	Train Loss 0.5124	
start validation
acc: 0.706161
AUC: 0.847999
Avg Precision: 0.287002
Avg Recall: 1.000000
d_prime: 1.453654
train_loss: 0.715822
valid_loss: 1.191306
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0015513926444494855
Epoch-11 lr: 0.006205570577797942
epoch 11 training time: 15.030
---------------
2023-09-11 07:52:52.520516
current #epochs=12, #steps=440
start validation
acc: 0.687204
AUC: 0.843704
Avg Precision: 0.289354
Avg Recall: 1.000000
d_prime: 1.428070
train_loss: 0.724334
valid_loss: 1.186988
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0015513926444494855
Epoch-12 lr: 0.006205570577797942
epoch 12 training time: 14.912
---------------
2023-09-11 07:53:07.432971
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00553	Train Loss 0.7226	
start validation
acc: 0.729858
AUC: 0.835698
Avg Precision: 0.290160
Avg Recall: 1.000000
d_prime: 1.381587
train_loss: 0.722061
valid_loss: 1.181039
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0015513926444494855
Epoch-13 lr: 0.006205570577797942
epoch 13 training time: 16.964
---------------
2023-09-11 07:53:24.396659
current #epochs=14, #steps=520
start validation
acc: 0.672986
AUC: 0.854482
Avg Precision: 0.318446
Avg Recall: 1.000000
d_prime: 1.493197
train_loss: 0.705924
valid_loss: 1.164195
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0015513926444494855
Epoch-14 lr: 0.006205570577797942
epoch 14 training time: 15.166
---------------
2023-09-11 07:53:39.562982
current #epochs=15, #steps=560
start validation
acc: 0.677725
AUC: 0.845641
Avg Precision: 0.307765
Avg Recall: 1.000000
d_prime: 1.439552
train_loss: 0.686090
valid_loss: 1.165497
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0015513926444494855
Epoch-15 lr: 0.006205570577797942
epoch 15 training time: 14.870
---------------
2023-09-11 07:53:54.433351
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03736	Per Sample Data Time 0.02754	Per Sample DNN Time 0.00982	Train Loss 0.8502	
start validation
acc: 0.701422
AUC: 0.857254
Avg Precision: 0.306819
Avg Recall: 1.000000
d_prime: 1.510472
train_loss: 0.682342
valid_loss: 1.187890
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.001284412905017288
Epoch-16 lr: 0.005137651620069152
epoch 16 training time: 15.715
---------------
2023-09-11 07:54:10.148740
current #epochs=17, #steps=640
start validation
acc: 0.720379
AUC: 0.845938
Avg Precision: 0.301231
Avg Recall: 1.000000
d_prime: 1.441321
train_loss: 0.688189
valid_loss: 1.175332
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.001284412905017288
Epoch-17 lr: 0.005137651620069152
epoch 17 training time: 15.047
---------------
2023-09-11 07:54:25.195644
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00554	Train Loss 0.6936	
start validation
acc: 0.706161
AUC: 0.862997
Avg Precision: 0.306311
Avg Recall: 1.000000
d_prime: 1.546986
train_loss: 0.663804
valid_loss: 1.158404
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001284412905017288
Epoch-18 lr: 0.005137651620069152
epoch 18 training time: 15.252
---------------
2023-09-11 07:54:40.448070
current #epochs=19, #steps=720
start validation
acc: 0.696682
AUC: 0.856499
Avg Precision: 0.311557
Avg Recall: 1.000000
d_prime: 1.505742
train_loss: 0.671239
valid_loss: 1.158001
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.001284412905017288
Epoch-19 lr: 0.005137651620069152
epoch 19 training time: 14.855
---------------
2023-09-11 07:54:55.303230
current #epochs=20, #steps=760
start validation
[I 2023-09-11 07:55:11,241] Trial 5 finished with value: 0.7298578199052133 and parameters: {'warmup': 'True', 'num_epochs': 20, 'batch_size': 49, 'lr-adaptschedule': 'False', 'lr': 0.0022633716048290234, 'head-lr': 4, 'lr-scheduler-start': 6, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.8279096266265104}. Best is trial 5 with value: 0.7298578199052133.
acc: 0.710900
AUC: 0.831938
Avg Precision: 0.291915
Avg Recall: 1.000000
d_prime: 1.360265
train_loss: 0.646171
valid_loss: 1.172188
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.001284412905017288
Epoch-20 lr: 0.005137651620069152
epoch 20 training time: 15.933
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863d9b1e80>
The learning rate scheduler starts at 6 epoch with decay rate of 0.812 every 8 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 07:55:11.246858
current #epochs=1, #steps=0
start validation
acc: 0.691943
AUC: 0.829570
Avg Precision: 0.296583
Avg Recall: 1.000000
d_prime: 1.346990
train_loss: 0.762895
valid_loss: 1.197775
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003952076364421694
Epoch-1 lr: 0.007904152728843388
epoch 1 training time: 17.441
---------------
2023-09-11 07:55:28.687860
current #epochs=2, #steps=40
start validation
acc: 0.706161
AUC: 0.829671
Avg Precision: 0.293857
Avg Recall: 1.000000
d_prime: 1.347554
train_loss: 0.741272
valid_loss: 1.223542
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003952076364421694
Epoch-2 lr: 0.007904152728843388
epoch 2 training time: 16.946
---------------
2023-09-11 07:55:45.634363
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00565	Train Loss 0.7441	
start validation
acc: 0.682464
AUC: 0.843012
Avg Precision: 0.315613
Avg Recall: 1.000000
d_prime: 1.423994
train_loss: 0.731822
valid_loss: 1.180167
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003952076364421694
Epoch-3 lr: 0.007904152728843388
epoch 3 training time: 15.154
---------------
2023-09-11 07:56:00.787963
current #epochs=4, #steps=120
start validation
acc: 0.696682
AUC: 0.844109
Avg Precision: 0.296533
Avg Recall: 1.000000
d_prime: 1.430463
train_loss: 0.693793
valid_loss: 1.188060
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003952076364421694
Epoch-4 lr: 0.007904152728843388
epoch 4 training time: 15.017
---------------
2023-09-11 07:56:15.804722
current #epochs=5, #steps=160
start validation
acc: 0.677725
AUC: 0.852429
Avg Precision: 0.303582
Avg Recall: 1.000000
d_prime: 1.480551
train_loss: 0.709506
valid_loss: 1.184974
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.003952076364421694
Epoch-5 lr: 0.007904152728843388
epoch 5 training time: 14.926
---------------
2023-09-11 07:56:30.730390
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03495	Per Sample Data Time 0.02751	Per Sample DNN Time 0.00745	Train Loss 0.6034	
start validation
acc: 0.701422
AUC: 0.860571
Avg Precision: 0.290599
Avg Recall: 1.000000
d_prime: 1.531438
train_loss: 0.697546
valid_loss: 1.178428
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0032096095957838246
Epoch-6 lr: 0.006419219191567649
epoch 6 training time: 15.090
---------------
2023-09-11 07:56:45.820309
current #epochs=7, #steps=240
start validation
acc: 0.715640
AUC: 0.865005
Avg Precision: 0.294621
Avg Recall: 1.000000
d_prime: 1.559998
train_loss: 0.682596
valid_loss: 1.155557
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0032096095957838246
Epoch-7 lr: 0.006419219191567649
epoch 7 training time: 17.298
---------------
2023-09-11 07:57:03.117982
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00565	Train Loss 0.6527	
start validation
acc: 0.715640
AUC: 0.862804
Avg Precision: 0.289138
Avg Recall: 1.000000
d_prime: 1.545740
train_loss: 0.653949
valid_loss: 1.142228
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0032096095957838246
Epoch-8 lr: 0.006419219191567649
epoch 8 training time: 15.244
---------------
2023-09-11 07:57:18.361475
current #epochs=9, #steps=320
start validation
acc: 0.715640
AUC: 0.875607
Avg Precision: 0.319126
Avg Recall: 1.000000
d_prime: 1.631016
train_loss: 0.663446
valid_loss: 1.158825
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0032096095957838246
Epoch-9 lr: 0.006419219191567649
epoch 9 training time: 15.509
---------------
2023-09-11 07:57:33.870828
current #epochs=10, #steps=360
start validation
acc: 0.696682
AUC: 0.849647
Avg Precision: 0.300251
Avg Recall: 1.000000
d_prime: 1.463597
train_loss: 0.668508
valid_loss: 1.146815
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0032096095957838246
Epoch-10 lr: 0.006419219191567649
epoch 10 training time: 14.869
---------------
2023-09-11 07:57:48.739366
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03735	Per Sample Data Time 0.02771	Per Sample DNN Time 0.00964	Train Loss 0.8785	
start validation
acc: 0.701422
AUC: 0.861579
Avg Precision: 0.296864
Avg Recall: 1.000000
d_prime: 1.537874
train_loss: 0.680069
valid_loss: 1.168098
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0032096095957838246
Epoch-11 lr: 0.006419219191567649
epoch 11 training time: 16.334
---------------
2023-09-11 07:58:05.073475
current #epochs=12, #steps=440
start validation
acc: 0.710900
AUC: 0.868334
Avg Precision: 0.314469
Avg Recall: 1.000000
d_prime: 1.581869
train_loss: 0.644360
valid_loss: 1.155776
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0032096095957838246
Epoch-12 lr: 0.006419219191567649
epoch 12 training time: 15.494
---------------
2023-09-11 07:58:20.568037
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00701	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00556	Train Loss 0.6695	
start validation
acc: 0.691943
AUC: 0.863703
Avg Precision: 0.307676
Avg Recall: 1.000000
d_prime: 1.551546
train_loss: 0.673622
valid_loss: 1.142969
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0032096095957838246
Epoch-13 lr: 0.006419219191567649
epoch 13 training time: 14.893
---------------
2023-09-11 07:58:35.461154
current #epochs=14, #steps=520
start validation
acc: 0.706161
AUC: 0.864459
Avg Precision: 0.296110
Avg Recall: 1.000000
d_prime: 1.556449
train_loss: 0.668298
valid_loss: 1.139384
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.00260662821449682
Epoch-14 lr: 0.00521325642899364
epoch 14 training time: 14.965
---------------
2023-09-11 07:58:50.425997
current #epochs=15, #steps=560
start validation
acc: 0.734597
AUC: 0.885123
Avg Precision: 0.304914
Avg Recall: 1.000000
d_prime: 1.698461
train_loss: 0.642090
valid_loss: 1.141226
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.00260662821449682
Epoch-15 lr: 0.00521325642899364
epoch 15 training time: 16.808
---------------
2023-09-11 07:59:07.233644
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03532	Per Sample Data Time 0.02779	Per Sample DNN Time 0.00753	Train Loss 0.5347	
start validation
acc: 0.734597
AUC: 0.867168
Avg Precision: 0.309619
Avg Recall: 1.000000
d_prime: 1.574168
train_loss: 0.658628
valid_loss: 1.147856
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.00260662821449682
Epoch-16 lr: 0.00521325642899364
epoch 16 training time: 15.033
---------------
2023-09-11 07:59:22.267101
current #epochs=17, #steps=640
start validation
acc: 0.696682
AUC: 0.883977
Avg Precision: 0.299692
Avg Recall: 1.000000
d_prime: 1.690131
train_loss: 0.645690
valid_loss: 1.138253
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.00260662821449682
Epoch-17 lr: 0.00521325642899364
epoch 17 training time: 15.046
---------------
2023-09-11 07:59:37.313368
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00563	Train Loss 0.6298	
start validation
acc: 0.691943
AUC: 0.862035
Avg Precision: 0.302036
Avg Recall: 1.000000
d_prime: 1.540795
train_loss: 0.629448
valid_loss: 1.150354
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00260662821449682
Epoch-18 lr: 0.00521325642899364
epoch 18 training time: 14.917
---------------
2023-09-11 07:59:52.230293
current #epochs=19, #steps=720
start validation
acc: 0.720379
AUC: 0.891659
Avg Precision: 0.310506
Avg Recall: 1.000000
d_prime: 1.747115
train_loss: 0.678308
valid_loss: 1.166746
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00260662821449682
Epoch-19 lr: 0.00521325642899364
epoch 19 training time: 15.130
---------------
2023-09-11 08:00:07.360824
current #epochs=20, #steps=760
start validation
acc: 0.763033
AUC: 0.880844
Avg Precision: 0.297266
Avg Recall: 1.000000
d_prime: 1.667666
train_loss: 0.630328
valid_loss: 1.138111
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00260662821449682
Epoch-20 lr: 0.00521325642899364
epoch 20 training time: 18.481
---------------
2023-09-11 08:00:25.841756
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03558	Per Sample Data Time 0.02900	Per Sample DNN Time 0.00658	Train Loss 0.7624	
start validation
acc: 0.720379
AUC: 0.878441
Avg Precision: 0.293668
Avg Recall: 1.000000
d_prime: 1.650708
train_loss: 0.641325
valid_loss: 1.141703
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00260662821449682
Epoch-21 lr: 0.00521325642899364
epoch 21 training time: 14.980
---------------
2023-09-11 08:00:40.821899
current #epochs=22, #steps=840
start validation
acc: 0.725118
AUC: 0.866661
Avg Precision: 0.293376
Avg Recall: 1.000000
d_prime: 1.570833
train_loss: 0.630874
valid_loss: 1.132673
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0021169274473556592
Epoch-22 lr: 0.0042338548947113185
epoch 22 training time: 14.871
---------------
2023-09-11 08:00:55.693334
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00565	Train Loss 0.5951	
start validation
acc: 0.739336
AUC: 0.891753
Avg Precision: 0.314531
Avg Recall: 1.000000
d_prime: 1.747833
train_loss: 0.643782
valid_loss: 1.140092
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0021169274473556592
Epoch-23 lr: 0.0042338548947113185
epoch 23 training time: 14.963
---------------
2023-09-11 08:01:10.656791
current #epochs=24, #steps=920
start validation
acc: 0.744076
AUC: 0.892968
Avg Precision: 0.307986
Avg Recall: 1.000000
d_prime: 1.757118
train_loss: 0.620928
valid_loss: 1.117829
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0021169274473556592
Epoch-24 lr: 0.0042338548947113185
epoch 24 training time: 15.069
---------------
2023-09-11 08:01:25.725829
current #epochs=25, #steps=960
start validation
acc: 0.748815
AUC: 0.877433
Avg Precision: 0.288793
Avg Recall: 1.000000
d_prime: 1.643667
train_loss: 0.581226
valid_loss: 1.132043
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0021169274473556592
Epoch-25 lr: 0.0042338548947113185
epoch 25 training time: 14.986
---------------
2023-09-11 08:01:40.712248
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03505	Per Sample Data Time 0.02786	Per Sample DNN Time 0.00720	Train Loss 0.5533	
start validation
acc: 0.715640
AUC: 0.880367
Avg Precision: 0.302460
Avg Recall: 1.000000
d_prime: 1.664281
train_loss: 0.643226
valid_loss: 1.145277
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0021169274473556592
Epoch-26 lr: 0.0042338548947113185
epoch 26 training time: 17.501
---------------
2023-09-11 08:01:58.214219
current #epochs=27, #steps=1040
start validation
acc: 0.748815
AUC: 0.902452
Avg Precision: 0.305555
Avg Recall: 1.000000
d_prime: 1.832328
train_loss: 0.607680
valid_loss: 1.119247
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0021169274473556592
Epoch-27 lr: 0.0042338548947113185
epoch 27 training time: 16.459
---------------
2023-09-11 08:02:14.673209
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00562	Train Loss 0.5844	
start validation
acc: 0.758294
AUC: 0.891548
Avg Precision: 0.303915
Avg Recall: 1.000000
d_prime: 1.746278
train_loss: 0.593808
valid_loss: 1.114975
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0021169274473556592
Epoch-28 lr: 0.0042338548947113185
epoch 28 training time: 15.033
---------------
2023-09-11 08:02:29.705729
current #epochs=29, #steps=1120
start validation
acc: 0.744076
AUC: 0.890212
Avg Precision: 0.311458
Avg Recall: 1.000000
d_prime: 1.736168
train_loss: 0.614944
valid_loss: 1.121625
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0021169274473556592
Epoch-29 lr: 0.0042338548947113185
epoch 29 training time: 14.930
---------------
2023-09-11 08:02:44.635062
current #epochs=30, #steps=1160
start validation
acc: 0.677725
AUC: 0.841776
Avg Precision: 0.272848
Avg Recall: 1.000000
d_prime: 1.416734
train_loss: 0.715711
valid_loss: 1.199754
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0017192255467981372
Epoch-30 lr: 0.0034384510935962743
epoch 30 training time: 14.991
---------------
2023-09-11 08:02:59.625636
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03511	Per Sample Data Time 0.02820	Per Sample DNN Time 0.00691	Train Loss 0.7965	
start validation
acc: 0.701422
AUC: 0.862281
Avg Precision: 0.293725
Avg Recall: 1.000000
d_prime: 1.542377
train_loss: 0.698021
valid_loss: 1.168373
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0017192255467981372
Epoch-31 lr: 0.0034384510935962743
epoch 31 training time: 14.989
---------------
2023-09-11 08:03:14.614691
current #epochs=32, #steps=1240
start validation
acc: 0.734597
AUC: 0.867694
Avg Precision: 0.299415
Avg Recall: 1.000000
d_prime: 1.577634
train_loss: 0.621554
valid_loss: 1.140230
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0017192255467981372
Epoch-32 lr: 0.0034384510935962743
epoch 32 training time: 14.865
---------------
2023-09-11 08:03:29.479401
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00558	Train Loss 0.5923	
start validation
acc: 0.729858
AUC: 0.862081
Avg Precision: 0.298237
Avg Recall: 1.000000
d_prime: 1.541093
train_loss: 0.616893
valid_loss: 1.140964
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0017192255467981372
Epoch-33 lr: 0.0034384510935962743
epoch 33 training time: 16.030
---------------
2023-09-11 08:03:45.509637
current #epochs=34, #steps=1320
start validation
acc: 0.725118
AUC: 0.877442
Avg Precision: 0.305166
Avg Recall: 1.000000
d_prime: 1.643731
train_loss: 0.611578
valid_loss: 1.106820
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0017192255467981372
Epoch-34 lr: 0.0034384510935962743
epoch 34 training time: 14.955
---------------
2023-09-11 08:04:00.464837
current #epochs=35, #steps=1360
start validation
acc: 0.691943
AUC: 0.881768
Avg Precision: 0.305610
Avg Recall: 1.000000
d_prime: 1.674244
train_loss: 0.584816
valid_loss: 1.127702
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0017192255467981372
Epoch-35 lr: 0.0034384510935962743
epoch 35 training time: 15.165
---------------
2023-09-11 08:04:15.629665
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03880	Per Sample Data Time 0.02923	Per Sample DNN Time 0.00957	Train Loss 0.6335	
start validation
acc: 0.734597
AUC: 0.875749
Avg Precision: 0.303963
Avg Recall: 1.000000
d_prime: 1.631995
train_loss: 0.597900
valid_loss: 1.117539
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0017192255467981372
Epoch-36 lr: 0.0034384510935962743
epoch 36 training time: 15.150
---------------
2023-09-11 08:04:30.780548
current #epochs=37, #steps=1440
start validation
acc: 0.734597
AUC: 0.878369
Avg Precision: 0.310776
Avg Recall: 1.000000
d_prime: 1.650206
train_loss: 0.582399
valid_loss: 1.123137
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0017192255467981372
Epoch-37 lr: 0.0034384510935962743
epoch 37 training time: 14.980
---------------
2023-09-11 08:04:45.760770
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00563	Train Loss 0.5709	
start validation
acc: 0.734597
AUC: 0.887004
Avg Precision: 0.312049
Avg Recall: 1.000000
d_prime: 1.712259
train_loss: 0.582417
valid_loss: 1.109752
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0013962389143073776
Epoch-38 lr: 0.002792477828614755
epoch 38 training time: 15.056
---------------
2023-09-11 08:05:00.816558
current #epochs=39, #steps=1520
start validation
acc: 0.744076
AUC: 0.887105
Avg Precision: 0.307199
Avg Recall: 1.000000
d_prime: 1.713005
train_loss: 0.575013
valid_loss: 1.117124
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0013962389143073776
Epoch-39 lr: 0.002792477828614755
epoch 39 training time: 14.921
---------------
2023-09-11 08:05:15.737152
current #epochs=40, #steps=1560
start validation
acc: 0.715640
AUC: 0.874857
Avg Precision: 0.299183
Avg Recall: 1.000000
d_prime: 1.625860
train_loss: 0.585181
valid_loss: 1.133016
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0013962389143073776
Epoch-40 lr: 0.002792477828614755
epoch 40 training time: 14.988
---------------
2023-09-11 08:05:30.725251
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03595	Per Sample Data Time 0.02940	Per Sample DNN Time 0.00655	Train Loss 0.5449	
start validation
acc: 0.720379
AUC: 0.885508
Avg Precision: 0.304062
Avg Recall: 1.000000
d_prime: 1.701272
train_loss: 0.557783
valid_loss: 1.122372
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0013962389143073776
Epoch-41 lr: 0.002792477828614755
epoch 41 training time: 14.947
---------------
2023-09-11 08:05:45.672823
current #epochs=42, #steps=1640
start validation
acc: 0.748815
AUC: 0.888311
Avg Precision: 0.300333
Avg Recall: 1.000000
d_prime: 1.721942
train_loss: 0.606837
valid_loss: 1.138034
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0013962389143073776
Epoch-42 lr: 0.002792477828614755
epoch 42 training time: 15.034
---------------
2023-09-11 08:06:00.707273
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00560	Train Loss 0.5882	
start validation
acc: 0.748815
AUC: 0.890462
Avg Precision: 0.311856
Avg Recall: 1.000000
d_prime: 1.738052
train_loss: 0.561432
valid_loss: 1.109791
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0013962389143073776
Epoch-43 lr: 0.002792477828614755
epoch 43 training time: 16.354
---------------
2023-09-11 08:06:17.061289
current #epochs=44, #steps=1720
start validation
[I 2023-09-11 08:06:34,255] Trial 6 finished with value: 0.7819905213270142 and parameters: {'warmup': 'False', 'num_epochs': 44, 'batch_size': 20, 'lr-adaptschedule': 'True', 'lr': 0.003952076364421694, 'head-lr': 2, 'lr-scheduler-start': 6, 'lr-scheduler-step': 8, 'lr-scheduler-decay': 0.8121324842500824}. Best is trial 6 with value: 0.7819905213270142.
acc: 0.781991
AUC: 0.890374
Avg Precision: 0.300158
Avg Recall: 1.000000
d_prime: 1.737386
train_loss: 0.556011
valid_loss: 1.109876
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0013962389143073776
Epoch-44 lr: 0.002792477828614755
epoch 44 training time: 17.190
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f85b4044520>
The learning rate scheduler starts at 4 epoch with decay rate of 0.937 every 7 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 08:06:34.261915
current #epochs=1, #steps=0
start validation
acc: 0.720379
AUC: 0.866373
Avg Precision: 0.281148
Avg Recall: 1.000000
d_prime: 1.568940
train_loss: 0.678287
valid_loss: 1.162567
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003737927172511299
Epoch-1 lr: 0.014951708690045196
epoch 1 training time: 17.463
---------------
2023-09-11 08:06:51.725821
current #epochs=2, #steps=40
start validation
acc: 0.701422
AUC: 0.895376
Avg Precision: 0.331296
Avg Recall: 1.000000
d_prime: 1.775739
train_loss: 0.620457
valid_loss: 1.142128
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003737927172511299
Epoch-2 lr: 0.014951708690045196
epoch 2 training time: 15.047
---------------
2023-09-11 08:07:06.772726
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00560	Train Loss 0.7021	
start validation
acc: 0.715640
AUC: 0.886002
Avg Precision: 0.311788
Avg Recall: 1.000000
d_prime: 1.704889
train_loss: 0.683423
valid_loss: 1.129873
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003737927172511299
Epoch-3 lr: 0.014951708690045196
epoch 3 training time: 14.937
---------------
2023-09-11 08:07:21.709052
current #epochs=4, #steps=120
start validation
acc: 0.748815
AUC: 0.880094
Avg Precision: 0.304155
Avg Recall: 1.000000
d_prime: 1.662346
train_loss: 0.609756
valid_loss: 1.137942
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0035025036687571956
Epoch-4 lr: 0.014010014675028782
epoch 4 training time: 17.106
---------------
2023-09-11 08:07:38.815427
current #epochs=5, #steps=160
start validation
acc: 0.758294
AUC: 0.882661
Avg Precision: 0.301540
Avg Recall: 1.000000
d_prime: 1.680644
train_loss: 0.603439
valid_loss: 1.130340
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0035025036687571956
Epoch-5 lr: 0.014010014675028782
epoch 5 training time: 17.586
---------------
2023-09-11 08:07:56.401823
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03584	Per Sample Data Time 0.02850	Per Sample DNN Time 0.00734	Train Loss 0.4485	
start validation
acc: 0.767773
AUC: 0.890067
Avg Precision: 0.305002
Avg Recall: 1.000000
d_prime: 1.735080
train_loss: 0.611223
valid_loss: 1.141790
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0035025036687571956
Epoch-6 lr: 0.014010014675028782
epoch 6 training time: 16.991
---------------
2023-09-11 08:08:13.392752
current #epochs=7, #steps=240
start validation
acc: 0.734597
AUC: 0.896623
Avg Precision: 0.321564
Avg Recall: 1.000000
d_prime: 1.785502
train_loss: 0.620744
valid_loss: 1.115780
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0035025036687571956
Epoch-7 lr: 0.014010014675028782
epoch 7 training time: 15.284
---------------
2023-09-11 08:08:28.676422
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00698	Per Sample Data Time 0.00141	Per Sample DNN Time 0.00556	Train Loss 0.6165	
start validation
acc: 0.739336
AUC: 0.877652
Avg Precision: 0.323968
Avg Recall: 1.000000
d_prime: 1.645198
train_loss: 0.633275
valid_loss: 1.143293
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0035025036687571956
Epoch-8 lr: 0.014010014675028782
epoch 8 training time: 14.872
---------------
2023-09-11 08:08:43.548070
current #epochs=9, #steps=320
start validation
acc: 0.720379
AUC: 0.877399
Avg Precision: 0.330341
Avg Recall: 1.000000
d_prime: 1.643435
train_loss: 0.654245
valid_loss: 1.147414
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0035025036687571956
Epoch-9 lr: 0.014010014675028782
epoch 9 training time: 16.361
---------------
2023-09-11 08:08:59.909640
current #epochs=10, #steps=360
start validation
acc: 0.758294
AUC: 0.897147
Avg Precision: 0.342469
Avg Recall: 1.000000
d_prime: 1.789635
train_loss: 0.611668
valid_loss: 1.120187
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0035025036687571956
Epoch-10 lr: 0.014010014675028782
epoch 10 training time: 16.449
---------------
2023-09-11 08:09:16.358342
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03457	Per Sample Data Time 0.02720	Per Sample DNN Time 0.00738	Train Loss 0.7981	
start validation
acc: 0.763033
AUC: 0.891297
Avg Precision: 0.335909
Avg Recall: 1.000000
d_prime: 1.744367
train_loss: 0.599617
valid_loss: 1.128987
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.003281907694690521
Epoch-11 lr: 0.013127630778762084
epoch 11 training time: 15.698
---------------
2023-09-11 08:09:32.056500
current #epochs=12, #steps=440
start validation
acc: 0.763033
AUC: 0.884354
Avg Precision: 0.322174
Avg Recall: 1.000000
d_prime: 1.692866
train_loss: 0.599317
valid_loss: 1.112038
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.003281907694690521
Epoch-12 lr: 0.013127630778762084
epoch 12 training time: 14.955
---------------
2023-09-11 08:09:47.011921
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00702	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00557	Train Loss 0.5880	
start validation
acc: 0.744076
AUC: 0.889826
Avg Precision: 0.313871
Avg Recall: 1.000000
d_prime: 1.733264
train_loss: 0.594156
valid_loss: 1.103545
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.003281907694690521
Epoch-13 lr: 0.013127630778762084
epoch 13 training time: 14.917
---------------
2023-09-11 08:10:01.928934
current #epochs=14, #steps=520
start validation
acc: 0.725118
AUC: 0.875171
Avg Precision: 0.296403
Avg Recall: 1.000000
d_prime: 1.628012
train_loss: 0.575724
valid_loss: 1.104027
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.003281907694690521
Epoch-14 lr: 0.013127630778762084
epoch 14 training time: 14.951
---------------
2023-09-11 08:10:16.879648
current #epochs=15, #steps=560
start validation
acc: 0.772512
AUC: 0.897801
Avg Precision: 0.313167
Avg Recall: 1.000000
d_prime: 1.794808
train_loss: 0.582452
valid_loss: 1.142873
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.003281907694690521
Epoch-15 lr: 0.013127630778762084
epoch 15 training time: 16.933
---------------
2023-09-11 08:10:33.812969
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03451	Per Sample Data Time 0.02726	Per Sample DNN Time 0.00724	Train Loss 0.9386	
start validation
acc: 0.777251
AUC: 0.894382
Avg Precision: 0.323525
Avg Recall: 1.000000
d_prime: 1.768016
train_loss: 0.592276
valid_loss: 1.102680
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.003281907694690521
Epoch-16 lr: 0.013127630778762084
epoch 16 training time: 16.977
---------------
2023-09-11 08:10:50.789443
current #epochs=17, #steps=640
start validation
acc: 0.748815
AUC: 0.903312
Avg Precision: 0.322754
Avg Recall: 1.000000
d_prime: 1.839409
train_loss: 0.563358
valid_loss: 1.118970
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.003281907694690521
Epoch-17 lr: 0.013127630778762084
epoch 17 training time: 15.265
---------------
2023-09-11 08:11:06.054974
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00700	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00553	Train Loss 0.5985	
start validation
acc: 0.753555
AUC: 0.880830
Avg Precision: 0.297867
Avg Recall: 1.000000
d_prime: 1.667566
train_loss: 0.578832
valid_loss: 1.126906
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.003075205377383867
Epoch-18 lr: 0.012300821509535468
epoch 18 training time: 14.947
---------------
2023-09-11 08:11:21.002365
current #epochs=19, #steps=720
start validation
acc: 0.753555
AUC: 0.885553
Avg Precision: 0.291930
Avg Recall: 1.000000
d_prime: 1.701602
train_loss: 0.569187
valid_loss: 1.137977
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.003075205377383867
Epoch-19 lr: 0.012300821509535468
epoch 19 training time: 15.922
---------------
2023-09-11 08:11:36.924808
current #epochs=20, #steps=760
start validation
acc: 0.739336
AUC: 0.880310
Avg Precision: 0.298107
Avg Recall: 1.000000
d_prime: 1.663875
train_loss: 0.588599
valid_loss: 1.150250
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.003075205377383867
Epoch-20 lr: 0.012300821509535468
epoch 20 training time: 15.048
---------------
2023-09-11 08:11:51.972840
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03511	Per Sample Data Time 0.02889	Per Sample DNN Time 0.00622	Train Loss 0.4901	
start validation
acc: 0.767773
AUC: 0.883608
Avg Precision: 0.296829
Avg Recall: 1.000000
d_prime: 1.687462
train_loss: 0.558195
valid_loss: 1.098168
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.003075205377383867
Epoch-21 lr: 0.012300821509535468
epoch 21 training time: 15.054
---------------
2023-09-11 08:12:07.026691
current #epochs=22, #steps=840
start validation
acc: 0.777251
AUC: 0.893030
Avg Precision: 0.290900
Avg Recall: 1.000000
d_prime: 1.757587
train_loss: 0.551782
valid_loss: 1.112849
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.003075205377383867
Epoch-22 lr: 0.012300821509535468
epoch 22 training time: 15.003
---------------
2023-09-11 08:12:22.030007
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00557	Train Loss 0.5398	
start validation
acc: 0.720379
AUC: 0.861690
Avg Precision: 0.301441
Avg Recall: 1.000000
d_prime: 1.538583
train_loss: 0.554970
valid_loss: 1.129278
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.003075205377383867
Epoch-23 lr: 0.012300821509535468
epoch 23 training time: 15.031
---------------
2023-09-11 08:12:37.061491
current #epochs=24, #steps=920
start validation
acc: 0.777251
AUC: 0.888357
Avg Precision: 0.312515
Avg Recall: 1.000000
d_prime: 1.722280
train_loss: 0.568580
valid_loss: 1.099697
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.003075205377383867
Epoch-24 lr: 0.012300821509535468
epoch 24 training time: 14.971
---------------
2023-09-11 08:12:52.032636
current #epochs=25, #steps=960
start validation
acc: 0.791469
AUC: 0.891634
Avg Precision: 0.310712
Avg Recall: 1.000000
d_prime: 1.746925
train_loss: 0.558408
valid_loss: 1.102330
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.002881521661437959
Epoch-25 lr: 0.011526086645751835
epoch 25 training time: 18.633
---------------
2023-09-11 08:13:10.665885
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03578	Per Sample Data Time 0.02840	Per Sample DNN Time 0.00738	Train Loss 0.4658	
start validation
acc: 0.796209
AUC: 0.880981
Avg Precision: 0.301459
Avg Recall: 1.000000
d_prime: 1.668636
train_loss: 0.555560
valid_loss: 1.137043
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.002881521661437959
Epoch-26 lr: 0.011526086645751835
epoch 26 training time: 17.415
---------------
2023-09-11 08:13:28.080517
current #epochs=27, #steps=1040
start validation
acc: 0.767773
AUC: 0.892412
Avg Precision: 0.309750
Avg Recall: 1.000000
d_prime: 1.752857
train_loss: 0.547875
valid_loss: 1.103999
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.002881521661437959
Epoch-27 lr: 0.011526086645751835
epoch 27 training time: 14.951
---------------
2023-09-11 08:13:43.031449
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00699	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00552	Train Loss 0.4914	
start validation
acc: 0.796209
AUC: 0.898862
Avg Precision: 0.304957
Avg Recall: 1.000000
d_prime: 1.803252
train_loss: 0.511045
valid_loss: 1.107227
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.002881521661437959
Epoch-28 lr: 0.011526086645751835
epoch 28 training time: 14.958
---------------
2023-09-11 08:13:57.989534
current #epochs=29, #steps=1120
start validation
acc: 0.772512
AUC: 0.888449
Avg Precision: 0.310301
Avg Recall: 1.000000
d_prime: 1.722970
train_loss: 0.548216
valid_loss: 1.113778
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.002881521661437959
Epoch-29 lr: 0.011526086645751835
epoch 29 training time: 15.875
---------------
2023-09-11 08:14:13.864356
current #epochs=30, #steps=1160
start validation
acc: 0.767773
AUC: 0.902718
Avg Precision: 0.332951
Avg Recall: 1.000000
d_prime: 1.834513
train_loss: 0.553190
valid_loss: 1.108991
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.002881521661437959
Epoch-30 lr: 0.011526086645751835
epoch 30 training time: 14.991
---------------
2023-09-11 08:14:28.855365
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03624	Per Sample Data Time 0.02942	Per Sample DNN Time 0.00682	Train Loss 0.5866	
start validation
acc: 0.767773
AUC: 0.900996
Avg Precision: 0.333676
Avg Recall: 1.000000
d_prime: 1.820442
train_loss: 0.534227
valid_loss: 1.112975
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.002881521661437959
Epoch-31 lr: 0.011526086645751835
epoch 31 training time: 15.080
---------------
2023-09-11 08:14:43.935367
current #epochs=32, #steps=1240
start validation
acc: 0.791469
AUC: 0.919571
Avg Precision: 0.352062
Avg Recall: 1.000000
d_prime: 1.983002
train_loss: 0.509036
valid_loss: 1.074478
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00270003660451447
Epoch-32 lr: 0.01080014641805788
epoch 32 training time: 14.836
---------------
2023-09-11 08:14:58.771516
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00702	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00553	Train Loss 0.5111	
start validation
acc: 0.781991
AUC: 0.908001
Avg Precision: 0.340577
Avg Recall: 1.000000
d_prime: 1.878844
train_loss: 0.510050
valid_loss: 1.097994
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.00270003660451447
Epoch-33 lr: 0.01080014641805788
epoch 33 training time: 16.106
---------------
2023-09-11 08:15:14.877778
current #epochs=34, #steps=1320
start validation
acc: 0.781991
AUC: 0.887120
Avg Precision: 0.302847
Avg Recall: 1.000000
d_prime: 1.713115
train_loss: 0.514381
valid_loss: 1.098073
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.00270003660451447
Epoch-34 lr: 0.01080014641805788
epoch 34 training time: 15.070
---------------
2023-09-11 08:15:29.947687
current #epochs=35, #steps=1360
start validation
acc: 0.772512
AUC: 0.899918
Avg Precision: 0.299913
Avg Recall: 1.000000
d_prime: 1.811724
train_loss: 0.536923
valid_loss: 1.104819
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.00270003660451447
Epoch-35 lr: 0.01080014641805788
epoch 35 training time: 14.993
---------------
2023-09-11 08:15:44.940617
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03483	Per Sample Data Time 0.02760	Per Sample DNN Time 0.00723	Train Loss 0.4963	
start validation
acc: 0.791469
AUC: 0.903613
Avg Precision: 0.326883
Avg Recall: 1.000000
d_prime: 1.841892
train_loss: 0.504362
valid_loss: 1.100475
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.00270003660451447
Epoch-36 lr: 0.01080014641805788
epoch 36 training time: 14.971
---------------
2023-09-11 08:15:59.911715
current #epochs=37, #steps=1440
start validation
acc: 0.772512
AUC: 0.893726
Avg Precision: 0.313713
Avg Recall: 1.000000
d_prime: 1.762945
train_loss: 0.523435
valid_loss: 1.118299
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.00270003660451447
Epoch-37 lr: 0.01080014641805788
epoch 37 training time: 14.858
---------------
2023-09-11 08:16:14.769848
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00557	Train Loss 0.4980	
start validation
acc: 0.781991
AUC: 0.900107
Avg Precision: 0.339410
Avg Recall: 1.000000
d_prime: 1.813250
train_loss: 0.513226
valid_loss: 1.080363
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.00270003660451447
Epoch-38 lr: 0.01080014641805788
epoch 38 training time: 14.971
---------------
2023-09-11 08:16:29.740995
current #epochs=39, #steps=1520
start validation
[I 2023-09-11 08:16:44,874] Trial 7 finished with value: 0.7962085308056872 and parameters: {'warmup': 'True', 'num_epochs': 39, 'batch_size': 31, 'lr-adaptschedule': 'False', 'lr': 0.003737927172511299, 'head-lr': 4, 'lr-scheduler-start': 4, 'lr-scheduler-step': 7, 'lr-scheduler-decay': 0.9370176322627667}. Best is trial 7 with value: 0.7962085308056872.
acc: 0.786730
AUC: 0.892224
Avg Precision: 0.308650
Avg Recall: 1.000000
d_prime: 1.751419
train_loss: 0.509351
valid_loss: 1.096355
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.002529981906184949
Epoch-39 lr: 0.010119927624739795
epoch 39 training time: 15.129
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f85b55a7ee0>
The learning rate scheduler starts at 8 epoch with decay rate of 0.880 every 6 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 08:16:44.880591
current #epochs=1, #steps=0
start validation
acc: 0.763033
AUC: 0.888792
Avg Precision: 0.319768
Avg Recall: 1.000000
d_prime: 1.725520
train_loss: 0.570579
valid_loss: 1.116494
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0027997873166490327
Epoch-1 lr: 0.013998936583245164
epoch 1 training time: 16.962
---------------
2023-09-11 08:17:01.843266
current #epochs=2, #steps=40
start validation
acc: 0.791469
AUC: 0.907857
Avg Precision: 0.337788
Avg Recall: 1.000000
d_prime: 1.877612
train_loss: 0.528224
valid_loss: 1.093969
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0027997873166490327
Epoch-2 lr: 0.013998936583245164
epoch 2 training time: 17.612
---------------
2023-09-11 08:17:19.455212
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00558	Train Loss 0.5234	
start validation
acc: 0.786730
AUC: 0.904886
Avg Precision: 0.319783
Avg Recall: 1.000000
d_prime: 1.852482
train_loss: 0.524779
valid_loss: 1.097914
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0027997873166490327
Epoch-3 lr: 0.013998936583245164
epoch 3 training time: 16.491
---------------
2023-09-11 08:17:35.946747
current #epochs=4, #steps=120
start validation
acc: 0.791469
AUC: 0.917662
Avg Precision: 0.348484
Avg Recall: 1.000000
d_prime: 1.965069
train_loss: 0.488256
valid_loss: 1.074856
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0027997873166490327
Epoch-4 lr: 0.013998936583245164
epoch 4 training time: 15.142
---------------
2023-09-11 08:17:51.088526
current #epochs=5, #steps=160
start validation
acc: 0.786730
AUC: 0.906065
Avg Precision: 0.334708
Avg Recall: 1.000000
d_prime: 1.862390
train_loss: 0.508422
valid_loss: 1.082630
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0027997873166490327
Epoch-5 lr: 0.013998936583245164
epoch 5 training time: 15.001
---------------
2023-09-11 08:18:06.089860
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03355	Per Sample Data Time 0.02732	Per Sample DNN Time 0.00622	Train Loss 0.4105	
start validation
acc: 0.758294
AUC: 0.889498
Avg Precision: 0.311493
Avg Recall: 1.000000
d_prime: 1.730802
train_loss: 0.499312
valid_loss: 1.101102
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0027997873166490327
Epoch-6 lr: 0.013998936583245164
epoch 6 training time: 14.855
---------------
2023-09-11 08:18:20.945337
current #epochs=7, #steps=240
start validation
acc: 0.777251
AUC: 0.909306
Avg Precision: 0.355671
Avg Recall: 1.000000
d_prime: 1.890084
train_loss: 0.487068
valid_loss: 1.089542
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0027997873166490327
Epoch-7 lr: 0.013998936583245164
epoch 7 training time: 15.053
---------------
2023-09-11 08:18:35.998751
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00703	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00559	Train Loss 0.5005	
start validation
acc: 0.758294
AUC: 0.909382
Avg Precision: 0.321842
Avg Recall: 1.000000
d_prime: 1.890745
train_loss: 0.505198
valid_loss: 1.107846
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0024626932940499543
Epoch-8 lr: 0.012313466470249773
epoch 8 training time: 14.910
---------------
2023-09-11 08:18:50.908225
current #epochs=9, #steps=320
start validation
acc: 0.781991
AUC: 0.899511
Avg Precision: 0.339344
Avg Recall: 1.000000
d_prime: 1.808456
train_loss: 0.533865
valid_loss: 1.108276
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0024626932940499543
Epoch-9 lr: 0.012313466470249773
epoch 9 training time: 15.131
---------------
2023-09-11 08:19:06.039538
current #epochs=10, #steps=360
start validation
acc: 0.763033
AUC: 0.904030
Avg Precision: 0.337398
Avg Recall: 1.000000
d_prime: 1.845351
train_loss: 0.508977
valid_loss: 1.094695
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0024626932940499543
Epoch-10 lr: 0.012313466470249773
epoch 10 training time: 15.060
---------------
2023-09-11 08:19:21.099598
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03410	Per Sample Data Time 0.02662	Per Sample DNN Time 0.00748	Train Loss 0.3254	
start validation
acc: 0.791469
AUC: 0.910187
Avg Precision: 0.328662
Avg Recall: 1.000000
d_prime: 1.897744
train_loss: 0.491209
valid_loss: 1.098659
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0024626932940499543
Epoch-11 lr: 0.012313466470249773
epoch 11 training time: 14.865
---------------
2023-09-11 08:19:35.964660
current #epochs=12, #steps=440
start validation
acc: 0.781991
AUC: 0.903078
Avg Precision: 0.310408
Avg Recall: 1.000000
d_prime: 1.837475
train_loss: 0.487211
valid_loss: 1.097086
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0024626932940499543
Epoch-12 lr: 0.012313466470249773
epoch 12 training time: 16.710
---------------
2023-09-11 08:19:52.674764
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00557	Train Loss 0.4771	
start validation
acc: 0.800948
AUC: 0.910507
Avg Precision: 0.319126
Avg Recall: 1.000000
d_prime: 1.900538
train_loss: 0.464939
valid_loss: 1.082840
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0024626932940499543
Epoch-13 lr: 0.012313466470249773
epoch 13 training time: 16.790
---------------
2023-09-11 08:20:09.464597
current #epochs=14, #steps=520
start validation
acc: 0.767773
AUC: 0.891951
Avg Precision: 0.326387
Avg Recall: 1.000000
d_prime: 1.749343
train_loss: 0.463851
valid_loss: 1.112089
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.002166185347184668
Epoch-14 lr: 0.010830926735923342
epoch 14 training time: 14.936
---------------
2023-09-11 08:20:24.400864
current #epochs=15, #steps=560
start validation
acc: 0.763033
AUC: 0.898203
Avg Precision: 0.327602
Avg Recall: 1.000000
d_prime: 1.797998
train_loss: 0.493475
valid_loss: 1.088508
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.002166185347184668
Epoch-15 lr: 0.010830926735923342
epoch 15 training time: 15.019
---------------
2023-09-11 08:20:39.419916
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03468	Per Sample Data Time 0.02842	Per Sample DNN Time 0.00627	Train Loss 0.4498	
start validation
acc: 0.753555
AUC: 0.900754
Avg Precision: 0.312438
Avg Recall: 1.000000
d_prime: 1.818480
train_loss: 0.462347
valid_loss: 1.075626
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.002166185347184668
Epoch-16 lr: 0.010830926735923342
epoch 16 training time: 14.988
---------------
2023-09-11 08:20:54.407654
current #epochs=17, #steps=640
start validation
acc: 0.781991
AUC: 0.905306
Avg Precision: 0.321059
Avg Recall: 1.000000
d_prime: 1.855998
train_loss: 0.493176
valid_loss: 1.094000
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.002166185347184668
Epoch-17 lr: 0.010830926735923342
epoch 17 training time: 14.920
---------------
2023-09-11 08:21:09.327803
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00560	Train Loss 0.4079	
start validation
acc: 0.781991
AUC: 0.907127
Avg Precision: 0.323729
Avg Recall: 1.000000
d_prime: 1.871384
train_loss: 0.453477
valid_loss: 1.087820
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.002166185347184668
Epoch-18 lr: 0.010830926735923342
epoch 18 training time: 16.239
---------------
2023-09-11 08:21:25.567134
current #epochs=19, #steps=720
start validation
acc: 0.772512
AUC: 0.896883
Avg Precision: 0.308027
Avg Recall: 1.000000
d_prime: 1.787553
train_loss: 0.482806
valid_loss: 1.105031
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.002166185347184668
Epoch-19 lr: 0.010830926735923342
epoch 19 training time: 16.790
---------------
2023-09-11 08:21:42.356617
current #epochs=20, #steps=760
start validation
acc: 0.786730
AUC: 0.896445
Avg Precision: 0.298032
Avg Recall: 1.000000
d_prime: 1.784106
train_loss: 0.433470
valid_loss: 1.082404
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0019053769179031106
Epoch-20 lr: 0.009526884589515556
epoch 20 training time: 15.734
---------------
2023-09-11 08:21:58.091148
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03572	Per Sample Data Time 0.02871	Per Sample DNN Time 0.00702	Train Loss 0.5705	
start validation
acc: 0.786730
AUC: 0.903264
Avg Precision: 0.316342
Avg Recall: 1.000000
d_prime: 1.839012
train_loss: 0.413059
valid_loss: 1.073593
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0019053769179031106
Epoch-21 lr: 0.009526884589515556
epoch 21 training time: 14.889
---------------
2023-09-11 08:22:12.980289
current #epochs=22, #steps=840
start validation
acc: 0.786730
AUC: 0.904904
Avg Precision: 0.317478
Avg Recall: 1.000000
d_prime: 1.852639
train_loss: 0.446944
valid_loss: 1.084007
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0019053769179031106
Epoch-22 lr: 0.009526884589515556
epoch 22 training time: 14.865
---------------
2023-09-11 08:22:27.844761
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00563	Train Loss 0.4419	
start validation
acc: 0.815166
AUC: 0.900521
Avg Precision: 0.318507
Avg Recall: 1.000000
d_prime: 1.816597
train_loss: 0.452625
valid_loss: 1.087080
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0019053769179031106
Epoch-23 lr: 0.009526884589515556
epoch 23 training time: 17.050
---------------
2023-09-11 08:22:44.895042
current #epochs=24, #steps=920
start validation
acc: 0.786730
AUC: 0.909462
Avg Precision: 0.332124
Avg Recall: 1.000000
d_prime: 1.891442
train_loss: 0.442802
valid_loss: 1.093127
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0019053769179031106
Epoch-24 lr: 0.009526884589515556
epoch 24 training time: 15.030
---------------
2023-09-11 08:22:59.925419
current #epochs=25, #steps=960
start validation
acc: 0.772512
AUC: 0.913139
Avg Precision: 0.330295
Avg Recall: 1.000000
d_prime: 1.923815
train_loss: 0.456408
valid_loss: 1.083718
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0019053769179031106
Epoch-25 lr: 0.009526884589515556
epoch 25 training time: 15.300
---------------
2023-09-11 08:23:15.225761
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03947	Per Sample Data Time 0.03047	Per Sample DNN Time 0.00900	Train Loss 0.4925	
start validation
acc: 0.777251
AUC: 0.909158
Avg Precision: 0.338853
Avg Recall: 1.000000
d_prime: 1.888804
train_loss: 0.411286
valid_loss: 1.078169
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0016759697890101457
Epoch-26 lr: 0.008379848945050731
epoch 26 training time: 15.096
---------------
2023-09-11 08:23:30.321199
current #epochs=27, #steps=1040
start validation
acc: 0.781991
AUC: 0.901570
Avg Precision: 0.332263
Avg Recall: 1.000000
d_prime: 1.825115
train_loss: 0.434766
valid_loss: 1.091558
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0016759697890101457
Epoch-27 lr: 0.008379848945050731
epoch 27 training time: 14.947
---------------
2023-09-11 08:23:45.268744
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00560	Train Loss 0.4281	
start validation
acc: 0.772512
AUC: 0.909545
Avg Precision: 0.323735
Avg Recall: 1.000000
d_prime: 1.892156
train_loss: 0.426964
valid_loss: 1.069363
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0016759697890101457
Epoch-28 lr: 0.008379848945050731
epoch 28 training time: 14.981
---------------
2023-09-11 08:24:00.249345
current #epochs=29, #steps=1120
start validation
acc: 0.748815
AUC: 0.899138
Avg Precision: 0.318880
Avg Recall: 1.000000
d_prime: 1.805463
train_loss: 0.419813
valid_loss: 1.086458
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0016759697890101457
Epoch-29 lr: 0.008379848945050731
epoch 29 training time: 18.018
---------------
2023-09-11 08:24:18.267412
current #epochs=30, #steps=1160
start validation
acc: 0.796209
AUC: 0.909949
Avg Precision: 0.358965
Avg Recall: 1.000000
d_prime: 1.895673
train_loss: 0.412706
valid_loss: 1.064747
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0016759697890101457
Epoch-30 lr: 0.008379848945050731
epoch 30 training time: 14.934
---------------
2023-09-11 08:24:33.201781
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03570	Per Sample Data Time 0.02842	Per Sample DNN Time 0.00728	Train Loss 0.5562	
start validation
acc: 0.772512
AUC: 0.890531
Avg Precision: 0.331314
Avg Recall: 1.000000
d_prime: 1.738574
train_loss: 0.424042
valid_loss: 1.102164
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0016759697890101457
Epoch-31 lr: 0.008379848945050731
epoch 31 training time: 14.896
---------------
2023-09-11 08:24:48.098132
current #epochs=32, #steps=1240
start validation
acc: 0.777251
AUC: 0.893550
Avg Precision: 0.339245
Avg Recall: 1.000000
d_prime: 1.761591
train_loss: 0.405246
valid_loss: 1.095305
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0014741832480924097
Epoch-32 lr: 0.00737091624046205
epoch 32 training time: 15.054
---------------
2023-09-11 08:25:03.151716
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00560	Train Loss 0.4082	
start validation
acc: 0.767773
AUC: 0.899784
Avg Precision: 0.316437
Avg Recall: 1.000000
d_prime: 1.810646
train_loss: 0.394612
valid_loss: 1.089581
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0014741832480924097
Epoch-33 lr: 0.00737091624046205
epoch 33 training time: 16.058
---------------
2023-09-11 08:25:19.209908
current #epochs=34, #steps=1320
start validation
acc: 0.777251
AUC: 0.897219
Avg Precision: 0.325900
Avg Recall: 1.000000
d_prime: 1.790200
train_loss: 0.420733
valid_loss: 1.089459
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0014741832480924097
Epoch-34 lr: 0.00737091624046205
epoch 34 training time: 15.031
---------------
2023-09-11 08:25:34.241248
current #epochs=35, #steps=1360
start validation
acc: 0.763033
AUC: 0.903720
Avg Precision: 0.335756
Avg Recall: 1.000000
d_prime: 1.842785
train_loss: 0.395615
valid_loss: 1.075453
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0014741832480924097
Epoch-35 lr: 0.00737091624046205
epoch 35 training time: 14.832
---------------
2023-09-11 08:25:49.073455
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03598	Per Sample Data Time 0.02937	Per Sample DNN Time 0.00661	Train Loss 0.4738	
start validation
acc: 0.758294
AUC: 0.910214
Avg Precision: 0.330723
Avg Recall: 1.000000
d_prime: 1.897983
train_loss: 0.385517
valid_loss: 1.079753
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0014741832480924097
Epoch-36 lr: 0.00737091624046205
epoch 36 training time: 15.166
---------------
2023-09-11 08:26:04.239128
current #epochs=37, #steps=1440
start validation
acc: 0.796209
AUC: 0.902198
Avg Precision: 0.346547
Avg Recall: 1.000000
d_prime: 1.830240
train_loss: 0.395083
valid_loss: 1.081674
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0014741832480924097
Epoch-37 lr: 0.00737091624046205
epoch 37 training time: 14.867
---------------
2023-09-11 08:26:19.106291
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00558	Train Loss 0.3814	
start validation
acc: 0.772512
AUC: 0.906793
Avg Precision: 0.339777
Avg Recall: 1.000000
d_prime: 1.868546
train_loss: 0.376201
valid_loss: 1.078547
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0012966917800110364
Epoch-38 lr: 0.006483458900055184
epoch 38 training time: 15.770
---------------
2023-09-11 08:26:34.876361
current #epochs=39, #steps=1520
start validation
acc: 0.767773
AUC: 0.905264
Avg Precision: 0.341746
Avg Recall: 1.000000
d_prime: 1.855649
train_loss: 0.377916
valid_loss: 1.082631
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0012966917800110364
Epoch-39 lr: 0.006483458900055184
epoch 39 training time: 15.801
---------------
2023-09-11 08:26:50.677709
current #epochs=40, #steps=1560
start validation
[I 2023-09-11 08:27:06,267] Trial 8 finished with value: 0.8151658767772512 and parameters: {'warmup': 'True', 'num_epochs': 40, 'batch_size': 34, 'lr-adaptschedule': 'False', 'lr': 0.0027997873166490327, 'head-lr': 5, 'lr-scheduler-start': 8, 'lr-scheduler-step': 6, 'lr-scheduler-decay': 0.8796001322691417}. Best is trial 8 with value: 0.8151658767772512.
acc: 0.791469
AUC: 0.895971
Avg Precision: 0.315496
Avg Recall: 1.000000
d_prime: 1.780388
train_loss: 0.359571
valid_loss: 1.082071
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0012966917800110364
Epoch-40 lr: 0.006483458900055184
epoch 40 training time: 15.586
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f85da419ee0>
The learning rate scheduler starts at 5 epoch with decay rate of 0.781 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 08:27:06.274244
current #epochs=1, #steps=0
start validation
acc: 0.777251
AUC: 0.894304
Avg Precision: 0.325715
Avg Recall: 1.000000
d_prime: 1.767410
train_loss: 0.546263
valid_loss: 1.112017
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003919818969757041
Epoch-1 lr: 0.003919818969757041
epoch 1 training time: 17.141
---------------
2023-09-11 08:27:23.415186
current #epochs=2, #steps=40
start validation
acc: 0.777251
AUC: 0.889760
Avg Precision: 0.310996
Avg Recall: 1.000000
d_prime: 1.732767
train_loss: 0.508638
valid_loss: 1.098085
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003919818969757041
Epoch-2 lr: 0.003919818969757041
epoch 2 training time: 15.009
---------------
2023-09-11 08:27:38.424579
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00697	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00552	Train Loss 0.4520	
start validation
acc: 0.748815
AUC: 0.875175
Avg Precision: 0.319079
Avg Recall: 1.000000
d_prime: 1.628041
train_loss: 0.481488
valid_loss: 1.128379
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003919818969757041
Epoch-3 lr: 0.003919818969757041
epoch 3 training time: 15.322
---------------
2023-09-11 08:27:53.746654
current #epochs=4, #steps=120
start validation
acc: 0.781991
AUC: 0.896531
Avg Precision: 0.324168
Avg Recall: 1.000000
d_prime: 1.784780
train_loss: 0.446988
valid_loss: 1.105311
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003919818969757041
Epoch-4 lr: 0.003919818969757041
epoch 4 training time: 17.123
---------------
2023-09-11 08:28:10.869501
current #epochs=5, #steps=160
start validation
acc: 0.758294
AUC: 0.913252
Avg Precision: 0.342223
Avg Recall: 1.000000
d_prime: 1.924825
train_loss: 0.479825
valid_loss: 1.084957
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0030620176275746886
Epoch-5 lr: 0.0030620176275746886
epoch 5 training time: 16.520
---------------
2023-09-11 08:28:27.389098
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03397	Per Sample Data Time 0.02735	Per Sample DNN Time 0.00662	Train Loss 0.4825	
start validation
acc: 0.781991
AUC: 0.898049
Avg Precision: 0.337580
Avg Recall: 1.000000
d_prime: 1.796776
train_loss: 0.463861
valid_loss: 1.084753
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0023919349398319957
Epoch-6 lr: 0.0023919349398319957
epoch 6 training time: 14.867
---------------
2023-09-11 08:28:42.256496
current #epochs=7, #steps=240
start validation
acc: 0.786730
AUC: 0.903844
Avg Precision: 0.327881
Avg Recall: 1.000000
d_prime: 1.843809
train_loss: 0.416446
valid_loss: 1.073733
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0018684911232600466
Epoch-7 lr: 0.0018684911232600466
epoch 7 training time: 17.028
---------------
2023-09-11 08:28:59.284438
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00700	Per Sample Data Time 0.00143	Per Sample DNN Time 0.00556	Train Loss 0.3746	
start validation
acc: 0.763033
AUC: 0.898609
Avg Precision: 0.336540
Avg Recall: 1.000000
d_prime: 1.801236
train_loss: 0.396186
valid_loss: 1.079201
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0014595961702649025
Epoch-8 lr: 0.0014595961702649025
epoch 8 training time: 15.108
---------------
2023-09-11 08:29:14.392455
current #epochs=9, #steps=320
start validation
acc: 0.781991
AUC: 0.897917
Avg Precision: 0.341254
Avg Recall: 1.000000
d_prime: 1.795726
train_loss: 0.383426
valid_loss: 1.083250
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0011401825535755942
Epoch-9 lr: 0.0011401825535755942
epoch 9 training time: 17.168
---------------
2023-09-11 08:29:31.560294
current #epochs=10, #steps=360
start validation
acc: 0.777251
AUC: 0.903603
Avg Precision: 0.328640
Avg Recall: 1.000000
d_prime: 1.841809
train_loss: 0.366858
valid_loss: 1.066140
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0008906684478640571
Epoch-10 lr: 0.0008906684478640571
epoch 10 training time: 15.037
---------------
2023-09-11 08:29:46.597673
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03557	Per Sample Data Time 0.02837	Per Sample DNN Time 0.00720	Train Loss 0.3358	
start validation
acc: 0.781991
AUC: 0.904692
Avg Precision: 0.324177
Avg Recall: 1.000000
d_prime: 1.850866
train_loss: 0.347526
valid_loss: 1.064152
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0006957572553033923
Epoch-11 lr: 0.0006957572553033923
epoch 11 training time: 15.823
---------------
2023-09-11 08:30:02.420870
current #epochs=12, #steps=440
start validation
acc: 0.758294
AUC: 0.904022
Avg Precision: 0.330470
Avg Recall: 1.000000
d_prime: 1.845282
train_loss: 0.326021
valid_loss: 1.064168
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0005434998393265132
Epoch-12 lr: 0.0005434998393265132
epoch 12 training time: 16.472
---------------
2023-09-11 08:30:18.892876
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00561	Train Loss 0.3134	
start validation
acc: 0.763033
AUC: 0.896189
Avg Precision: 0.324625
Avg Recall: 1.000000
d_prime: 1.782093
train_loss: 0.315213
valid_loss: 1.073264
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0004245619763162035
Epoch-13 lr: 0.0004245619763162035
epoch 13 training time: 15.013
---------------
2023-09-11 08:30:33.905458
current #epochs=14, #steps=520
start validation
acc: 0.781991
AUC: 0.900537
Avg Precision: 0.313541
Avg Recall: 1.000000
d_prime: 1.816727
train_loss: 0.317799
valid_loss: 1.070840
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0003316521159544111
Epoch-14 lr: 0.0003316521159544111
epoch 14 training time: 16.838
---------------
2023-09-11 08:30:50.743538
current #epochs=15, #steps=560
start validation
acc: 0.777251
AUC: 0.898537
Avg Precision: 0.317656
Avg Recall: 1.000000
d_prime: 1.800663
train_loss: 0.321006
valid_loss: 1.075813
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.00025907436876805454
Epoch-15 lr: 0.00025907436876805454
epoch 15 training time: 14.869
---------------
2023-09-11 08:31:05.612872
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03861	Per Sample Data Time 0.02837	Per Sample DNN Time 0.01024	Train Loss 0.2110	
start validation
acc: 0.777251
AUC: 0.899504
Avg Precision: 0.327734
Avg Recall: 1.000000
d_prime: 1.808398
train_loss: 0.302504
valid_loss: 1.072684
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.00020237931652995143
Epoch-16 lr: 0.00020237931652995143
epoch 16 training time: 15.321
---------------
2023-09-11 08:31:20.933976
current #epochs=17, #steps=640
start validation
acc: 0.777251
AUC: 0.895067
Avg Precision: 0.317568
Avg Recall: 1.000000
d_prime: 1.773333
train_loss: 0.311304
valid_loss: 1.074545
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.00015809123825676023
Epoch-17 lr: 0.00015809123825676023
epoch 17 training time: 14.983
---------------
2023-09-11 08:31:35.917024
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00555	Train Loss 0.2850	
start validation
acc: 0.781991
AUC: 0.896218
Avg Precision: 0.315209
Avg Recall: 1.000000
d_prime: 1.782320
train_loss: 0.294629
valid_loss: 1.070777
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00012349502924552508
Epoch-18 lr: 0.00012349502924552508
epoch 18 training time: 16.165
---------------
2023-09-11 08:31:52.081682
current #epochs=19, #steps=720
start validation
acc: 0.767773
AUC: 0.897082
Avg Precision: 0.316078
Avg Recall: 1.000000
d_prime: 1.789119
train_loss: 0.291593
valid_loss: 1.070325
validation finished
normal learning rate scheduler step
Epoch-19 lr: 9.646975010457885e-05
Epoch-19 lr: 9.646975010457885e-05
epoch 19 training time: 16.763
---------------
2023-09-11 08:32:08.845091
current #epochs=20, #steps=760
start validation
acc: 0.781991
AUC: 0.897337
Avg Precision: 0.318186
Avg Recall: 1.000000
d_prime: 1.791132
train_loss: 0.313044
valid_loss: 1.071362
validation finished
normal learning rate scheduler step
Epoch-20 lr: 7.535860141170106e-05
Epoch-20 lr: 7.535860141170106e-05
epoch 20 training time: 18.122
---------------
2023-09-11 08:32:26.967941
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03516	Per Sample Data Time 0.02785	Per Sample DNN Time 0.00731	Train Loss 0.1696	
start validation
acc: 0.777251
AUC: 0.898382
Avg Precision: 0.322244
Avg Recall: 1.000000
d_prime: 1.799426
train_loss: 0.311713
valid_loss: 1.070229
validation finished
normal learning rate scheduler step
Epoch-21 lr: 5.886735272529838e-05
Epoch-21 lr: 5.886735272529838e-05
epoch 21 training time: 14.913
---------------
2023-09-11 08:32:41.880380
current #epochs=22, #steps=840
start validation
acc: 0.781991
AUC: 0.898803
Avg Precision: 0.323827
Avg Recall: 1.000000
d_prime: 1.802782
train_loss: 0.280209
valid_loss: 1.068822
validation finished
normal learning rate scheduler step
Epoch-22 lr: 4.5984999083948255e-05
Epoch-22 lr: 4.5984999083948255e-05
epoch 22 training time: 15.480
---------------
2023-09-11 08:32:57.360511
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00157	Per Sample DNN Time 0.00561	Train Loss 0.2806	
start validation
acc: 0.772512
AUC: 0.898121
Avg Precision: 0.324758
Avg Recall: 1.000000
d_prime: 1.797353
train_loss: 0.300795
valid_loss: 1.069860
validation finished
normal learning rate scheduler step
Epoch-23 lr: 3.592178079789817e-05
Epoch-23 lr: 3.592178079789817e-05
epoch 23 training time: 15.139
---------------
2023-09-11 08:33:12.499448
current #epochs=24, #steps=920
start validation
acc: 0.777251
AUC: 0.898535
Avg Precision: 0.320411
Avg Recall: 1.000000
d_prime: 1.800641
train_loss: 0.307097
valid_loss: 1.069617
validation finished
normal learning rate scheduler step
Epoch-24 lr: 2.8060766802160704e-05
Epoch-24 lr: 2.8060766802160704e-05
epoch 24 training time: 14.941
---------------
2023-09-11 08:33:27.440747
current #epochs=25, #steps=960
start validation
acc: 0.777251
AUC: 0.898544
Avg Precision: 0.318026
Avg Recall: 1.000000
d_prime: 1.800716
train_loss: 0.289434
valid_loss: 1.069629
validation finished
normal learning rate scheduler step
Epoch-25 lr: 2.192003336235815e-05
Epoch-25 lr: 2.192003336235815e-05
epoch 25 training time: 15.030
---------------
2023-09-11 08:33:42.470631
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03498	Per Sample Data Time 0.02865	Per Sample DNN Time 0.00634	Train Loss 0.2121	
start validation
acc: 0.772512
AUC: 0.898784
Avg Precision: 0.319474
Avg Recall: 1.000000
d_prime: 1.802629
train_loss: 0.313274
valid_loss: 1.069712
validation finished
normal learning rate scheduler step
Epoch-26 lr: 1.712311947832788e-05
Epoch-26 lr: 1.712311947832788e-05
epoch 26 training time: 14.991
---------------
2023-09-11 08:33:57.461448
current #epochs=27, #steps=1040
start validation
acc: 0.777251
AUC: 0.898743
Avg Precision: 0.318497
Avg Recall: 1.000000
d_prime: 1.802302
train_loss: 0.291955
valid_loss: 1.070000
validation finished
normal learning rate scheduler step
Epoch-27 lr: 1.3375947737953134e-05
Epoch-27 lr: 1.3375947737953134e-05
epoch 27 training time: 14.907
---------------
2023-09-11 08:34:12.368571
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00563	Train Loss 0.2745	
start validation
acc: 0.777251
AUC: 0.898027
Avg Precision: 0.318771
Avg Recall: 1.000000
d_prime: 1.796599
train_loss: 0.291405
valid_loss: 1.070238
validation finished
normal learning rate scheduler step
Epoch-28 lr: 1.0448795741622962e-05
Epoch-28 lr: 1.0448795741622962e-05
epoch 28 training time: 15.414
---------------
2023-09-11 08:34:27.782386
current #epochs=29, #steps=1120
start validation
acc: 0.777251
AUC: 0.897600
Avg Precision: 0.318940
Avg Recall: 1.000000
d_prime: 1.793212
train_loss: 0.288184
valid_loss: 1.070360
validation finished
normal learning rate scheduler step
Epoch-29 lr: 8.162212845701885e-06
Epoch-29 lr: 8.162212845701885e-06
epoch 29 training time: 15.000
---------------
2023-09-11 08:34:42.782047
current #epochs=30, #steps=1160
start validation
acc: 0.777251
AUC: 0.897716
Avg Precision: 0.317554
Avg Recall: 1.000000
d_prime: 1.794132
train_loss: 0.275315
valid_loss: 1.070599
validation finished
normal learning rate scheduler step
Epoch-30 lr: 6.3760188433153185e-06
Epoch-30 lr: 6.3760188433153185e-06
epoch 30 training time: 16.572
---------------
2023-09-11 08:34:59.353824
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03893	Per Sample Data Time 0.02904	Per Sample DNN Time 0.00988	Train Loss 0.2746	
start validation
acc: 0.777251
AUC: 0.897356
Avg Precision: 0.318243
Avg Recall: 1.000000
d_prime: 1.791288
train_loss: 0.308869
valid_loss: 1.070718
validation finished
normal learning rate scheduler step
Epoch-31 lr: 4.980710140598659e-06
Epoch-31 lr: 4.980710140598659e-06
epoch 31 training time: 15.224
---------------
2023-09-11 08:35:14.577526
current #epochs=32, #steps=1240
start validation
acc: 0.777251
AUC: 0.897286
Avg Precision: 0.317554
Avg Recall: 1.000000
d_prime: 1.790732
train_loss: 0.290596
valid_loss: 1.070761
validation finished
normal learning rate scheduler step
Epoch-32 lr: 3.8907465793754215e-06
Epoch-32 lr: 3.8907465793754215e-06
epoch 32 training time: 16.222
---------------
2023-09-11 08:35:30.798919
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00555	Train Loss 0.2779	
start validation
acc: 0.777251
AUC: 0.897440
Avg Precision: 0.318525
Avg Recall: 1.000000
d_prime: 1.791948
train_loss: 0.290416
valid_loss: 1.070689
validation finished
normal learning rate scheduler step
Epoch-33 lr: 3.0393073512810438e-06
Epoch-33 lr: 3.0393073512810438e-06
epoch 33 training time: 16.756
---------------
2023-09-11 08:35:47.554444
current #epochs=34, #steps=1320
start validation
[I 2023-09-11 08:36:03,099] Trial 9 finished with value: 0.7867298578199052 and parameters: {'warmup': 'False', 'num_epochs': 34, 'batch_size': 30, 'lr-adaptschedule': 'True', 'lr': 0.003919818969757041, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7811630208434036}. Best is trial 8 with value: 0.8151658767772512.
acc: 0.777251
AUC: 0.897577
Avg Precision: 0.318697
Avg Recall: 1.000000
d_prime: 1.793033
train_loss: 0.309529
valid_loss: 1.070662
validation finished
normal learning rate scheduler step
Epoch-34 lr: 2.374194511798264e-06
Epoch-34 lr: 2.374194511798264e-06
epoch 34 training time: 15.540
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863d97d130>
The learning rate scheduler starts at 10 epoch with decay rate of 0.932 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 08:36:03.128991
current #epochs=1, #steps=0
start validation
acc: 0.786730
AUC: 0.899158
Avg Precision: 0.322261
Avg Recall: 1.000000
d_prime: 1.805622
train_loss: 0.296377
valid_loss: 1.068658
validation finished
normal learning rate scheduler step
Epoch-1 lr: 4.098521542257724e-05
Epoch-1 lr: 0.0002049260771128862
epoch 1 training time: 17.120
---------------
2023-09-11 08:36:20.248831
current #epochs=2, #steps=40
start validation
acc: 0.781991
AUC: 0.898494
Avg Precision: 0.322600
Avg Recall: 1.000000
d_prime: 1.800319
train_loss: 0.289374
valid_loss: 1.069175
validation finished
normal learning rate scheduler step
Epoch-2 lr: 4.098521542257724e-05
Epoch-2 lr: 0.0002049260771128862
epoch 2 training time: 16.580
---------------
2023-09-11 08:36:36.829245
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00558	Train Loss 0.3032	
start validation
acc: 0.781991
AUC: 0.898623
Avg Precision: 0.324391
Avg Recall: 1.000000
d_prime: 1.801345
train_loss: 0.306275
valid_loss: 1.067699
validation finished
normal learning rate scheduler step
Epoch-3 lr: 4.098521542257724e-05
Epoch-3 lr: 0.0002049260771128862
epoch 3 training time: 14.916
---------------
2023-09-11 08:36:51.745673
current #epochs=4, #steps=120
start validation
acc: 0.781991
AUC: 0.898095
Avg Precision: 0.322770
Avg Recall: 1.000000
d_prime: 1.797144
train_loss: 0.291613
valid_loss: 1.069346
validation finished
normal learning rate scheduler step
Epoch-4 lr: 4.098521542257724e-05
Epoch-4 lr: 0.0002049260771128862
epoch 4 training time: 16.000
---------------
2023-09-11 08:37:07.745078
current #epochs=5, #steps=160
start validation
acc: 0.781991
AUC: 0.896352
Avg Precision: 0.320549
Avg Recall: 1.000000
d_prime: 1.783370
train_loss: 0.316069
valid_loss: 1.070633
validation finished
normal learning rate scheduler step
Epoch-5 lr: 4.098521542257724e-05
Epoch-5 lr: 0.0002049260771128862
epoch 5 training time: 15.063
---------------
2023-09-11 08:37:22.808393
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03451	Per Sample Data Time 0.02796	Per Sample DNN Time 0.00655	Train Loss 0.3777	
start validation
acc: 0.781991
AUC: 0.897249
Avg Precision: 0.320279
Avg Recall: 1.000000
d_prime: 1.790439
train_loss: 0.302138
valid_loss: 1.069787
validation finished
normal learning rate scheduler step
Epoch-6 lr: 4.098521542257724e-05
Epoch-6 lr: 0.0002049260771128862
epoch 6 training time: 16.595
---------------
2023-09-11 08:37:39.403526
current #epochs=7, #steps=240
start validation
acc: 0.781991
AUC: 0.896196
Avg Precision: 0.318724
Avg Recall: 1.000000
d_prime: 1.782148
train_loss: 0.305468
valid_loss: 1.070706
validation finished
normal learning rate scheduler step
Epoch-7 lr: 4.098521542257724e-05
Epoch-7 lr: 0.0002049260771128862
epoch 7 training time: 15.110
---------------
2023-09-11 08:37:54.513364
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00703	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00553	Train Loss 0.2611	
start validation
acc: 0.781991
AUC: 0.896602
Avg Precision: 0.320888
Avg Recall: 1.000000
d_prime: 1.785336
train_loss: 0.267693
valid_loss: 1.070938
validation finished
normal learning rate scheduler step
Epoch-8 lr: 4.098521542257724e-05
Epoch-8 lr: 0.0002049260771128862
epoch 8 training time: 14.971
---------------
2023-09-11 08:38:09.484557
current #epochs=9, #steps=320
start validation
acc: 0.786730
AUC: 0.898410
Avg Precision: 0.327364
Avg Recall: 1.000000
d_prime: 1.799650
train_loss: 0.300404
valid_loss: 1.069838
validation finished
normal learning rate scheduler step
Epoch-9 lr: 4.098521542257724e-05
Epoch-9 lr: 0.0002049260771128862
epoch 9 training time: 16.746
---------------
2023-09-11 08:38:26.231136
current #epochs=10, #steps=360
start validation
acc: 0.786730
AUC: 0.897889
Avg Precision: 0.327312
Avg Recall: 1.000000
d_prime: 1.795503
train_loss: 0.312304
valid_loss: 1.069709
validation finished
normal learning rate scheduler step
Epoch-10 lr: 3.8194354696491796e-05
Epoch-10 lr: 0.00019097177348245898
epoch 10 training time: 16.103
---------------
2023-09-11 08:38:42.334601
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03518	Per Sample Data Time 0.02838	Per Sample DNN Time 0.00680	Train Loss 0.2646	
start validation
acc: 0.786730
AUC: 0.897227
Avg Precision: 0.325162
Avg Recall: 1.000000
d_prime: 1.790267
train_loss: 0.309734
valid_loss: 1.071051
validation finished
normal learning rate scheduler step
Epoch-11 lr: 3.8194354696491796e-05
Epoch-11 lr: 0.00019097177348245898
epoch 11 training time: 15.643
---------------
2023-09-11 08:38:57.977298
current #epochs=12, #steps=440
start validation
acc: 0.781991
AUC: 0.898785
Avg Precision: 0.331288
Avg Recall: 1.000000
d_prime: 1.802641
train_loss: 0.293762
valid_loss: 1.068992
validation finished
normal learning rate scheduler step
Epoch-12 lr: 3.559353575772158e-05
Epoch-12 lr: 0.0001779676787886079
epoch 12 training time: 15.018
---------------
2023-09-11 08:39:12.995417
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00560	Train Loss 0.2966	
start validation
acc: 0.781991
AUC: 0.898046
Avg Precision: 0.327513
Avg Recall: 1.000000
d_prime: 1.796751
train_loss: 0.289058
valid_loss: 1.069403
validation finished
normal learning rate scheduler step
Epoch-13 lr: 3.559353575772158e-05
Epoch-13 lr: 0.0001779676787886079
epoch 13 training time: 15.392
---------------
2023-09-11 08:39:28.387537
current #epochs=14, #steps=520
start validation
[I 2023-09-11 08:39:43,378] Trial 10 finished with value: 0.7867298578199052 and parameters: {'warmup': 'False', 'num_epochs': 14, 'batch_size': 64, 'lr-adaptschedule': 'False', 'lr': 4.098521542257724e-05, 'head-lr': 5, 'lr-scheduler-start': 10, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.9319056714156476}. Best is trial 8 with value: 0.8151658767772512.
acc: 0.786730
AUC: 0.898256
Avg Precision: 0.326399
Avg Recall: 1.000000
d_prime: 1.798424
train_loss: 0.293458
valid_loss: 1.069767
validation finished
normal learning rate scheduler step
Epoch-14 lr: 3.316981783835639e-05
Epoch-14 lr: 0.00016584908919178195
epoch 14 training time: 14.986
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f859ea4ea00>
The learning rate scheduler starts at 9 epoch with decay rate of 0.947 every 7 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 08:39:43.408796
current #epochs=1, #steps=0
start validation
acc: 0.772512
AUC: 0.882317
Avg Precision: 0.317210
Avg Recall: 1.000000
d_prime: 1.678173
train_loss: 0.500106
valid_loss: 1.100507
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003218367936051358
Epoch-1 lr: 0.012873471744205433
epoch 1 training time: 18.568
---------------
2023-09-11 08:40:01.977173
current #epochs=2, #steps=40
start validation
acc: 0.758294
AUC: 0.886918
Avg Precision: 0.329699
Avg Recall: 1.000000
d_prime: 1.711620
train_loss: 0.446710
valid_loss: 1.104058
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003218367936051358
Epoch-2 lr: 0.012873471744205433
epoch 2 training time: 15.176
---------------
2023-09-11 08:40:17.153168
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00701	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00551	Train Loss 0.4275	
start validation
acc: 0.720379
AUC: 0.902812
Avg Precision: 0.342221
Avg Recall: 1.000000
d_prime: 1.835285
train_loss: 0.422242
valid_loss: 1.084175
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003218367936051358
Epoch-3 lr: 0.012873471744205433
epoch 3 training time: 15.819
---------------
2023-09-11 08:40:32.972550
current #epochs=4, #steps=120
start validation
acc: 0.772512
AUC: 0.903567
Avg Precision: 0.347063
Avg Recall: 1.000000
d_prime: 1.841519
train_loss: 0.413410
valid_loss: 1.080045
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003218367936051358
Epoch-4 lr: 0.012873471744205433
epoch 4 training time: 16.088
---------------
2023-09-11 08:40:49.060884
current #epochs=5, #steps=160
start validation
acc: 0.781991
AUC: 0.909560
Avg Precision: 0.344635
Avg Recall: 1.000000
d_prime: 1.892286
train_loss: 0.410597
valid_loss: 1.063070
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.003218367936051358
Epoch-5 lr: 0.012873471744205433
epoch 5 training time: 17.125
---------------
2023-09-11 08:41:06.185975
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03629	Per Sample Data Time 0.02702	Per Sample DNN Time 0.00927	Train Loss 0.3666	
start validation
acc: 0.748815
AUC: 0.892544
Avg Precision: 0.315579
Avg Recall: 1.000000
d_prime: 1.753864
train_loss: 0.387318
valid_loss: 1.098140
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.003218367936051358
Epoch-6 lr: 0.012873471744205433
epoch 6 training time: 14.951
---------------
2023-09-11 08:41:21.136853
current #epochs=7, #steps=240
start validation
acc: 0.739336
AUC: 0.904199
Avg Precision: 0.343822
Avg Recall: 1.000000
d_prime: 1.846759
train_loss: 0.460522
valid_loss: 1.104912
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.003218367936051358
Epoch-7 lr: 0.012873471744205433
epoch 7 training time: 16.496
---------------
2023-09-11 08:41:37.632918
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00565	Train Loss 0.4352	
start validation
acc: 0.772512
AUC: 0.886357
Avg Precision: 0.308481
Avg Recall: 1.000000
d_prime: 1.707489
train_loss: 0.421626
valid_loss: 1.094496
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.003218367936051358
Epoch-8 lr: 0.012873471744205433
epoch 8 training time: 15.371
---------------
2023-09-11 08:41:53.004438
current #epochs=9, #steps=320
start validation
acc: 0.781991
AUC: 0.897601
Avg Precision: 0.336906
Avg Recall: 1.000000
d_prime: 1.793220
train_loss: 0.413658
valid_loss: 1.091354
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0030482720202355293
Epoch-9 lr: 0.012193088080942117
epoch 9 training time: 17.744
---------------
2023-09-11 08:42:10.748790
current #epochs=10, #steps=360
start validation
acc: 0.748815
AUC: 0.884940
Avg Precision: 0.314295
Avg Recall: 1.000000
d_prime: 1.697123
train_loss: 0.421859
valid_loss: 1.106366
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0030482720202355293
Epoch-10 lr: 0.012193088080942117
epoch 10 training time: 14.863
---------------
2023-09-11 08:42:25.611381
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03837	Per Sample Data Time 0.02835	Per Sample DNN Time 0.01001	Train Loss 0.4453	
start validation
acc: 0.786730
AUC: 0.890415
Avg Precision: 0.314574
Avg Recall: 1.000000
d_prime: 1.737701
train_loss: 0.386027
valid_loss: 1.082776
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0030482720202355293
Epoch-11 lr: 0.012193088080942117
epoch 11 training time: 20.912
---------------
2023-09-11 08:42:46.523218
current #epochs=12, #steps=440
start validation
acc: 0.744076
AUC: 0.864370
Avg Precision: 0.312515
Avg Recall: 1.000000
d_prime: 1.555871
train_loss: 0.441074
valid_loss: 1.140328
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0030482720202355293
Epoch-12 lr: 0.012193088080942117
epoch 12 training time: 15.112
---------------
2023-09-11 08:43:01.635304
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00565	Train Loss 0.4386	
start validation
acc: 0.753555
AUC: 0.891424
Avg Precision: 0.330921
Avg Recall: 1.000000
d_prime: 1.745330
train_loss: 0.429708
valid_loss: 1.097214
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0030482720202355293
Epoch-13 lr: 0.012193088080942117
epoch 13 training time: 15.184
---------------
2023-09-11 08:43:16.819134
current #epochs=14, #steps=520
start validation
acc: 0.748815
AUC: 0.891528
Avg Precision: 0.332194
Avg Recall: 1.000000
d_prime: 1.746126
train_loss: 0.385105
valid_loss: 1.086819
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0030482720202355293
Epoch-14 lr: 0.012193088080942117
epoch 14 training time: 15.082
---------------
2023-09-11 08:43:31.901548
current #epochs=15, #steps=560
start validation
acc: 0.777251
AUC: 0.894301
Avg Precision: 0.316103
Avg Recall: 1.000000
d_prime: 1.767387
train_loss: 0.400196
valid_loss: 1.102985
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0030482720202355293
Epoch-15 lr: 0.012193088080942117
epoch 15 training time: 15.348
---------------
2023-09-11 08:43:47.250106
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03609	Per Sample Data Time 0.02822	Per Sample DNN Time 0.00787	Train Loss 0.3806	
start validation
acc: 0.710900
AUC: 0.890760
Avg Precision: 0.336313
Avg Recall: 1.000000
d_prime: 1.740302
train_loss: 0.381071
valid_loss: 1.097303
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0028871659468342765
Epoch-16 lr: 0.011548663787337106
epoch 16 training time: 14.966
---------------
2023-09-11 08:44:02.215950
current #epochs=17, #steps=640
start validation
acc: 0.781991
AUC: 0.893546
Avg Precision: 0.332792
Avg Recall: 1.000000
d_prime: 1.761555
train_loss: 0.369355
valid_loss: 1.067160
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0028871659468342765
Epoch-17 lr: 0.011548663787337106
epoch 17 training time: 15.467
---------------
2023-09-11 08:44:17.682881
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00554	Train Loss 0.3681	
start validation
acc: 0.800948
AUC: 0.899304
Avg Precision: 0.346807
Avg Recall: 1.000000
d_prime: 1.806796
train_loss: 0.364978
valid_loss: 1.079812
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0028871659468342765
Epoch-18 lr: 0.011548663787337106
epoch 18 training time: 19.609
---------------
2023-09-11 08:44:37.292096
current #epochs=19, #steps=720
start validation
acc: 0.772512
AUC: 0.900979
Avg Precision: 0.354654
Avg Recall: 1.000000
d_prime: 1.820305
train_loss: 0.364262
valid_loss: 1.068916
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0028871659468342765
Epoch-19 lr: 0.011548663787337106
epoch 19 training time: 14.904
---------------
2023-09-11 08:44:52.196211
current #epochs=20, #steps=760
start validation
acc: 0.748815
AUC: 0.897055
Avg Precision: 0.343268
Avg Recall: 1.000000
d_prime: 1.788903
train_loss: 0.415476
valid_loss: 1.086082
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0028871659468342765
Epoch-20 lr: 0.011548663787337106
epoch 20 training time: 16.079
---------------
2023-09-11 08:45:08.275915
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03826	Per Sample Data Time 0.02828	Per Sample DNN Time 0.00998	Train Loss 0.1538	
start validation
acc: 0.786730
AUC: 0.912000
Avg Precision: 0.354507
Avg Recall: 1.000000
d_prime: 1.913677
train_loss: 0.397516
valid_loss: 1.071050
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0028871659468342765
Epoch-21 lr: 0.011548663787337106
epoch 21 training time: 15.143
---------------
2023-09-11 08:45:23.419077
current #epochs=22, #steps=840
start validation
acc: 0.744076
AUC: 0.880288
Avg Precision: 0.324877
Avg Recall: 1.000000
d_prime: 1.663720
train_loss: 0.379274
valid_loss: 1.095251
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0028871659468342765
Epoch-22 lr: 0.011548663787337106
epoch 22 training time: 15.486
---------------
2023-09-11 08:45:38.905229
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00558	Train Loss 0.3674	
start validation
acc: 0.763033
AUC: 0.898798
Avg Precision: 0.338317
Avg Recall: 1.000000
d_prime: 1.802746
train_loss: 0.390241
valid_loss: 1.059789
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.002734574588233563
Epoch-23 lr: 0.010938298352934252
epoch 23 training time: 15.056
---------------
2023-09-11 08:45:53.960604
current #epochs=24, #steps=920
start validation
acc: 0.758294
AUC: 0.879331
Avg Precision: 0.322781
Avg Recall: 1.000000
d_prime: 1.656959
train_loss: 0.398049
valid_loss: 1.109959
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.002734574588233563
Epoch-24 lr: 0.010938298352934252
epoch 24 training time: 14.926
---------------
2023-09-11 08:46:08.886135
current #epochs=25, #steps=960
start validation
acc: 0.786730
AUC: 0.899824
Avg Precision: 0.336702
Avg Recall: 1.000000
d_prime: 1.810968
train_loss: 0.365525
valid_loss: 1.050348
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.002734574588233563
Epoch-25 lr: 0.010938298352934252
epoch 25 training time: 15.081
---------------
2023-09-11 08:46:23.967667
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03499	Per Sample Data Time 0.02864	Per Sample DNN Time 0.00635	Train Loss 0.4841	
start validation
acc: 0.753555
AUC: 0.892490
Avg Precision: 0.348462
Avg Recall: 1.000000
d_prime: 1.753455
train_loss: 0.342000
valid_loss: 1.077564
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.002734574588233563
Epoch-26 lr: 0.010938298352934252
epoch 26 training time: 14.980
---------------
2023-09-11 08:46:38.948421
current #epochs=27, #steps=1040
start validation
acc: 0.753555
AUC: 0.898070
Avg Precision: 0.336525
Avg Recall: 1.000000
d_prime: 1.796944
train_loss: 0.337487
valid_loss: 1.058410
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.002734574588233563
Epoch-27 lr: 0.010938298352934252
epoch 27 training time: 14.941
---------------
2023-09-11 08:46:53.889401
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00701	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00557	Train Loss 0.3820	
start validation
acc: 0.748815
AUC: 0.895422
Avg Precision: 0.340589
Avg Recall: 1.000000
d_prime: 1.776095
train_loss: 0.381626
valid_loss: 1.095122
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.002734574588233563
Epoch-28 lr: 0.010938298352934252
epoch 28 training time: 14.947
---------------
2023-09-11 08:47:08.836734
current #epochs=29, #steps=1120
start validation
acc: 0.786730
AUC: 0.908276
Avg Precision: 0.378028
Avg Recall: 1.000000
d_prime: 1.881208
train_loss: 0.417929
valid_loss: 1.057745
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.002734574588233563
Epoch-29 lr: 0.010938298352934252
epoch 29 training time: 14.960
---------------
2023-09-11 08:47:23.796888
current #epochs=30, #steps=1160
start validation
acc: 0.767773
AUC: 0.896519
Avg Precision: 0.304677
Avg Recall: 1.000000
d_prime: 1.784683
train_loss: 0.397109
valid_loss: 1.064063
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00259004792807706
Epoch-30 lr: 0.01036019171230824
epoch 30 training time: 14.923
---------------
2023-09-11 08:47:38.719564
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03741	Per Sample Data Time 0.02824	Per Sample DNN Time 0.00917	Train Loss 0.2708	
start validation
acc: 0.786730
AUC: 0.902876
Avg Precision: 0.317106
Avg Recall: 1.000000
d_prime: 1.835812
train_loss: 0.342487
valid_loss: 1.054473
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.00259004792807706
Epoch-31 lr: 0.01036019171230824
epoch 31 training time: 14.976
---------------
2023-09-11 08:47:53.695242
current #epochs=32, #steps=1240
start validation
acc: 0.772512
AUC: 0.888295
Avg Precision: 0.328747
Avg Recall: 1.000000
d_prime: 1.721818
train_loss: 0.357031
valid_loss: 1.077507
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00259004792807706
Epoch-32 lr: 0.01036019171230824
epoch 32 training time: 16.073
---------------
2023-09-11 08:48:09.768533
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00558	Train Loss 0.3386	
start validation
acc: 0.777251
AUC: 0.889866
Avg Precision: 0.322237
Avg Recall: 1.000000
d_prime: 1.733566
train_loss: 0.336397
valid_loss: 1.091404
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.00259004792807706
Epoch-33 lr: 0.01036019171230824
epoch 33 training time: 15.033
---------------
2023-09-11 08:48:24.801203
current #epochs=34, #steps=1320
start validation
acc: 0.772512
AUC: 0.902007
Avg Precision: 0.351817
Avg Recall: 1.000000
d_prime: 1.828678
train_loss: 0.312905
valid_loss: 1.059717
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.00259004792807706
Epoch-34 lr: 0.01036019171230824
epoch 34 training time: 15.127
---------------
2023-09-11 08:48:39.928089
current #epochs=35, #steps=1360
start validation
acc: 0.772512
AUC: 0.895461
Avg Precision: 0.316603
Avg Recall: 1.000000
d_prime: 1.776399
train_loss: 0.382298
valid_loss: 1.079577
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.00259004792807706
Epoch-35 lr: 0.01036019171230824
epoch 35 training time: 15.137
---------------
2023-09-11 08:48:55.065710
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03579	Per Sample Data Time 0.02962	Per Sample DNN Time 0.00617	Train Loss 0.2157	
start validation
acc: 0.763033
AUC: 0.887295
Avg Precision: 0.321681
Avg Recall: 1.000000
d_prime: 1.714407
train_loss: 0.340694
valid_loss: 1.082556
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.00259004792807706
Epoch-36 lr: 0.01036019171230824
epoch 36 training time: 15.012
---------------
2023-09-11 08:49:10.077420
current #epochs=37, #steps=1440
start validation
acc: 0.786730
AUC: 0.891195
Avg Precision: 0.329179
Avg Recall: 1.000000
d_prime: 1.743592
train_loss: 0.326759
valid_loss: 1.097237
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0024531597340958335
Epoch-37 lr: 0.009812638936383334
epoch 37 training time: 15.930
---------------
2023-09-11 08:49:26.007441
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00159	Per Sample DNN Time 0.00560	Train Loss 0.3045	
start validation
acc: 0.720379
AUC: 0.895997
Avg Precision: 0.378593
Avg Recall: 1.000000
d_prime: 1.780589
train_loss: 0.304770
valid_loss: 1.089052
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0024531597340958335
Epoch-38 lr: 0.009812638936383334
epoch 38 training time: 15.060
---------------
2023-09-11 08:49:41.067468
current #epochs=39, #steps=1520
start validation
[I 2023-09-11 08:49:57,659] Trial 11 finished with value: 0.8009478672985783 and parameters: {'warmup': 'True', 'num_epochs': 39, 'batch_size': 45, 'lr-adaptschedule': 'False', 'lr': 0.003218367936051358, 'head-lr': 4, 'lr-scheduler-start': 9, 'lr-scheduler-step': 7, 'lr-scheduler-decay': 0.9471483934728355}. Best is trial 8 with value: 0.8151658767772512.
acc: 0.786730
AUC: 0.885894
Avg Precision: 0.317914
Avg Recall: 1.000000
d_prime: 1.704095
train_loss: 0.338503
valid_loss: 1.072146
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0024531597340958335
Epoch-39 lr: 0.009812638936383334
epoch 39 training time: 16.586
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f86670dc700>
The learning rate scheduler starts at 9 epoch with decay rate of 0.893 every 8 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 08:49:57.690406
current #epochs=1, #steps=0
start validation
acc: 0.786730
AUC: 0.900866
Avg Precision: 0.347504
Avg Recall: 1.000000
d_prime: 1.819389
train_loss: 0.361168
valid_loss: 1.069671
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0029191550262401937
Epoch-1 lr: 0.011676620104960775
epoch 1 training time: 18.083
---------------
2023-09-11 08:50:15.773567
current #epochs=2, #steps=40
start validation
acc: 0.772512
AUC: 0.915447
Avg Precision: 0.344259
Avg Recall: 1.000000
d_prime: 1.944657
train_loss: 0.344439
valid_loss: 1.054513
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0029191550262401937
Epoch-2 lr: 0.011676620104960775
epoch 2 training time: 15.084
---------------
2023-09-11 08:50:30.857875
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00703	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00555	Train Loss 0.3075	
start validation
acc: 0.781991
AUC: 0.891154
Avg Precision: 0.313347
Avg Recall: 1.000000
d_prime: 1.743285
train_loss: 0.315780
valid_loss: 1.070928
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0029191550262401937
Epoch-3 lr: 0.011676620104960775
epoch 3 training time: 14.958
---------------
2023-09-11 08:50:45.815820
current #epochs=4, #steps=120
start validation
acc: 0.781991
AUC: 0.901616
Avg Precision: 0.360113
Avg Recall: 1.000000
d_prime: 1.825487
train_loss: 0.298530
valid_loss: 1.066051
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0029191550262401937
Epoch-4 lr: 0.011676620104960775
epoch 4 training time: 15.137
---------------
2023-09-11 08:51:00.952826
current #epochs=5, #steps=160
start validation
acc: 0.786730
AUC: 0.895123
Avg Precision: 0.318116
Avg Recall: 1.000000
d_prime: 1.773770
train_loss: 0.345520
valid_loss: 1.079992
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0029191550262401937
Epoch-5 lr: 0.011676620104960775
epoch 5 training time: 14.918
---------------
2023-09-11 08:51:15.870398
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03920	Per Sample Data Time 0.02917	Per Sample DNN Time 0.01003	Train Loss 0.4626	
start validation
acc: 0.800948
AUC: 0.918249
Avg Precision: 0.359614
Avg Recall: 1.000000
d_prime: 1.970549
train_loss: 0.311388
valid_loss: 1.046229
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0029191550262401937
Epoch-6 lr: 0.011676620104960775
epoch 6 training time: 17.165
---------------
2023-09-11 08:51:33.035510
current #epochs=7, #steps=240
start validation
acc: 0.767773
AUC: 0.910166
Avg Precision: 0.328993
Avg Recall: 1.000000
d_prime: 1.897560
train_loss: 0.304402
valid_loss: 1.068655
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0029191550262401937
Epoch-7 lr: 0.011676620104960775
epoch 7 training time: 15.189
---------------
2023-09-11 08:51:48.224814
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00692	Per Sample Data Time 0.00143	Per Sample DNN Time 0.00548	Train Loss 0.3229	
start validation
acc: 0.720379
AUC: 0.900556
Avg Precision: 0.320738
Avg Recall: 1.000000
d_prime: 1.816876
train_loss: 0.378956
valid_loss: 1.080797
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0029191550262401937
Epoch-8 lr: 0.011676620104960775
epoch 8 training time: 14.884
---------------
2023-09-11 08:52:03.108912
current #epochs=9, #steps=320
start validation
acc: 0.805687
AUC: 0.906407
Avg Precision: 0.336359
Avg Recall: 1.000000
d_prime: 1.865272
train_loss: 0.324230
valid_loss: 1.067643
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.002607341715137102
Epoch-9 lr: 0.010429366860548408
epoch 9 training time: 17.593
---------------
2023-09-11 08:52:20.702038
current #epochs=10, #steps=360
start validation
acc: 0.796209
AUC: 0.903716
Avg Precision: 0.325447
Avg Recall: 1.000000
d_prime: 1.842748
train_loss: 0.289429
valid_loss: 1.061091
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.002607341715137102
Epoch-10 lr: 0.010429366860548408
epoch 10 training time: 15.097
---------------
2023-09-11 08:52:35.798593
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03489	Per Sample Data Time 0.02780	Per Sample DNN Time 0.00708	Train Loss 0.1861	
start validation
acc: 0.796209
AUC: 0.894579
Avg Precision: 0.321533
Avg Recall: 1.000000
d_prime: 1.769537
train_loss: 0.297849
valid_loss: 1.065396
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.002607341715137102
Epoch-11 lr: 0.010429366860548408
epoch 11 training time: 16.388
---------------
2023-09-11 08:52:52.186126
current #epochs=12, #steps=440
start validation
acc: 0.786730
AUC: 0.909767
Avg Precision: 0.348709
Avg Recall: 1.000000
d_prime: 1.894084
train_loss: 0.315109
valid_loss: 1.058675
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.002607341715137102
Epoch-12 lr: 0.010429366860548408
epoch 12 training time: 15.103
---------------
2023-09-11 08:53:07.288823
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00561	Train Loss 0.3214	
start validation
acc: 0.800948
AUC: 0.914862
Avg Precision: 0.353775
Avg Recall: 1.000000
d_prime: 1.939335
train_loss: 0.291424
valid_loss: 1.060120
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.002607341715137102
Epoch-13 lr: 0.010429366860548408
epoch 13 training time: 14.945
---------------
2023-09-11 08:53:22.234316
current #epochs=14, #steps=520
start validation
acc: 0.772512
AUC: 0.915779
Avg Precision: 0.348663
Avg Recall: 1.000000
d_prime: 1.947693
train_loss: 0.285356
valid_loss: 1.055894
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.002607341715137102
Epoch-14 lr: 0.010429366860548408
epoch 14 training time: 15.060
---------------
2023-09-11 08:53:37.294555
current #epochs=15, #steps=560
start validation
acc: 0.772512
AUC: 0.909232
Avg Precision: 0.397174
Avg Recall: 1.000000
d_prime: 1.889445
train_loss: 0.292119
valid_loss: 1.055867
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.002607341715137102
Epoch-15 lr: 0.010429366860548408
epoch 15 training time: 15.077
---------------
2023-09-11 08:53:52.371408
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03839	Per Sample Data Time 0.02816	Per Sample DNN Time 0.01023	Train Loss 0.2505	
start validation
acc: 0.767773
AUC: 0.905653
Avg Precision: 0.377803
Avg Recall: 1.000000
d_prime: 1.858920
train_loss: 0.286496
valid_loss: 1.051970
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.002607341715137102
Epoch-16 lr: 0.010429366860548408
epoch 16 training time: 15.902
---------------
2023-09-11 08:54:08.273009
current #epochs=17, #steps=640
start validation
acc: 0.805687
AUC: 0.912508
Avg Precision: 0.370078
Avg Recall: 1.000000
d_prime: 1.918186
train_loss: 0.284779
valid_loss: 1.065597
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0023288351452338085
Epoch-17 lr: 0.009315340580935234
epoch 17 training time: 15.248
---------------
2023-09-11 08:54:23.520845
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00555	Train Loss 0.2956	
start validation
acc: 0.796209
AUC: 0.893743
Avg Precision: 0.321895
Avg Recall: 1.000000
d_prime: 1.763074
train_loss: 0.276500
valid_loss: 1.087055
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0023288351452338085
Epoch-18 lr: 0.009315340580935234
epoch 18 training time: 14.974
---------------
2023-09-11 08:54:38.494605
current #epochs=19, #steps=720
start validation
acc: 0.781991
AUC: 0.900489
Avg Precision: 0.361598
Avg Recall: 1.000000
d_prime: 1.816336
train_loss: 0.249722
valid_loss: 1.062238
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0023288351452338085
Epoch-19 lr: 0.009315340580935234
epoch 19 training time: 15.014
---------------
2023-09-11 08:54:53.508364
current #epochs=20, #steps=760
start validation
acc: 0.767773
AUC: 0.905702
Avg Precision: 0.355197
Avg Recall: 1.000000
d_prime: 1.859326
train_loss: 0.249312
valid_loss: 1.054073
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0023288351452338085
Epoch-20 lr: 0.009315340580935234
epoch 20 training time: 14.954
---------------
2023-09-11 08:55:08.462598
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03490	Per Sample Data Time 0.02836	Per Sample DNN Time 0.00654	Train Loss 0.3014	
start validation
acc: 0.786730
AUC: 0.915476
Avg Precision: 0.365627
Avg Recall: 1.000000
d_prime: 1.944928
train_loss: 0.237377
valid_loss: 1.065911
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0023288351452338085
Epoch-21 lr: 0.009315340580935234
epoch 21 training time: 16.894
---------------
2023-09-11 08:55:25.356998
current #epochs=22, #steps=840
start validation
acc: 0.767773
AUC: 0.907606
Avg Precision: 0.339383
Avg Recall: 1.000000
d_prime: 1.875471
train_loss: 0.230144
valid_loss: 1.054082
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0023288351452338085
Epoch-22 lr: 0.009315340580935234
epoch 22 training time: 15.128
---------------
2023-09-11 08:55:40.484844
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00698	Per Sample Data Time 0.00142	Per Sample DNN Time 0.00556	Train Loss 0.2335	
start validation
acc: 0.739336
AUC: 0.901955
Avg Precision: 0.350005
Avg Recall: 1.000000
d_prime: 1.828252
train_loss: 0.219562
valid_loss: 1.048049
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0023288351452338085
Epoch-23 lr: 0.009315340580935234
epoch 23 training time: 14.903
---------------
2023-09-11 08:55:55.387616
current #epochs=24, #steps=920
start validation
acc: 0.781991
AUC: 0.913636
Avg Precision: 0.355687
Avg Recall: 1.000000
d_prime: 1.928265
train_loss: 0.280030
valid_loss: 1.048644
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0023288351452338085
Epoch-24 lr: 0.009315340580935234
epoch 24 training time: 18.051
---------------
2023-09-11 08:56:13.439009
current #epochs=25, #steps=960
start validation
acc: 0.753555
AUC: 0.904530
Avg Precision: 0.335018
Avg Recall: 1.000000
d_prime: 1.849515
train_loss: 0.265851
valid_loss: 1.044478
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.002080077613988925
Epoch-25 lr: 0.0083203104559557
epoch 25 training time: 19.037
---------------
2023-09-11 08:56:32.475992
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03544	Per Sample Data Time 0.02805	Per Sample DNN Time 0.00739	Train Loss 0.3529	
start validation
acc: 0.772512
AUC: 0.906956
Avg Precision: 0.376236
Avg Recall: 1.000000
d_prime: 1.869934
train_loss: 0.244906
valid_loss: 1.053017
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.002080077613988925
Epoch-26 lr: 0.0083203104559557
epoch 26 training time: 16.397
---------------
2023-09-11 08:56:48.873306
current #epochs=27, #steps=1040
start validation
[I 2023-09-11 08:57:03,854] Trial 12 finished with value: 0.8056872037914692 and parameters: {'warmup': 'True', 'num_epochs': 27, 'batch_size': 49, 'lr-adaptschedule': 'False', 'lr': 0.0029191550262401937, 'head-lr': 4, 'lr-scheduler-start': 9, 'lr-scheduler-step': 8, 'lr-scheduler-decay': 0.8931837095665658}. Best is trial 8 with value: 0.8151658767772512.
acc: 0.763033
AUC: 0.890173
Avg Precision: 0.356518
Avg Recall: 1.000000
d_prime: 1.735871
train_loss: 0.187341
valid_loss: 1.074850
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.002080077613988925
Epoch-27 lr: 0.0083203104559557
epoch 27 training time: 14.976
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863d981e20>
The learning rate scheduler starts at 10 epoch with decay rate of 0.875 every 8 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 08:57:03.886188
current #epochs=1, #steps=0
start validation
acc: 0.781991
AUC: 0.890956
Avg Precision: 0.318208
Avg Recall: 1.000000
d_prime: 1.741782
train_loss: 0.354704
valid_loss: 1.071946
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0029875907483044293
Epoch-1 lr: 0.014937953741522146
epoch 1 training time: 17.290
---------------
2023-09-11 08:57:21.176209
current #epochs=2, #steps=40
start validation
acc: 0.786730
AUC: 0.904274
Avg Precision: 0.326428
Avg Recall: 1.000000
d_prime: 1.847384
train_loss: 0.295582
valid_loss: 1.059320
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0029875907483044293
Epoch-2 lr: 0.014937953741522146
epoch 2 training time: 19.362
---------------
2023-09-11 08:57:40.538361
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00703	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00556	Train Loss 0.2239	
start validation
acc: 0.786730
AUC: 0.899792
Avg Precision: 0.338847
Avg Recall: 1.000000
d_prime: 1.810710
train_loss: 0.241214
valid_loss: 1.048869
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0029875907483044293
Epoch-3 lr: 0.014937953741522146
epoch 3 training time: 15.543
---------------
2023-09-11 08:57:56.082228
current #epochs=4, #steps=120
start validation
acc: 0.748815
AUC: 0.893438
Avg Precision: 0.349377
Avg Recall: 1.000000
d_prime: 1.760724
train_loss: 0.228975
valid_loss: 1.058090
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0029875907483044293
Epoch-4 lr: 0.014937953741522146
epoch 4 training time: 14.825
---------------
2023-09-11 08:58:10.906990
current #epochs=5, #steps=160
start validation
acc: 0.758294
AUC: 0.890120
Avg Precision: 0.299626
Avg Recall: 1.000000
d_prime: 1.735475
train_loss: 0.302832
valid_loss: 1.094133
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0029875907483044293
Epoch-5 lr: 0.014937953741522146
epoch 5 training time: 15.430
---------------
2023-09-11 08:58:26.336876
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03840	Per Sample Data Time 0.02862	Per Sample DNN Time 0.00978	Train Loss 0.3477	
start validation
acc: 0.772512
AUC: 0.910285
Avg Precision: 0.348108
Avg Recall: 1.000000
d_prime: 1.898595
train_loss: 0.254792
valid_loss: 1.039564
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0029875907483044293
Epoch-6 lr: 0.014937953741522146
epoch 6 training time: 15.063
---------------
2023-09-11 08:58:41.400458
current #epochs=7, #steps=240
start validation
acc: 0.781991
AUC: 0.900583
Avg Precision: 0.342084
Avg Recall: 1.000000
d_prime: 1.817098
train_loss: 0.247360
valid_loss: 1.062037
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0029875907483044293
Epoch-7 lr: 0.014937953741522146
epoch 7 training time: 16.062
---------------
2023-09-11 08:58:57.461906
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00557	Train Loss 0.2366	
start validation
acc: 0.781991
AUC: 0.920372
Avg Precision: 0.323128
Avg Recall: 1.000000
d_prime: 1.990616
train_loss: 0.270175
valid_loss: 1.040490
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0029875907483044293
Epoch-8 lr: 0.014937953741522146
epoch 8 training time: 16.306
---------------
2023-09-11 08:59:13.767511
current #epochs=9, #steps=320
start validation
acc: 0.772512
AUC: 0.896129
Avg Precision: 0.314838
Avg Recall: 1.000000
d_prime: 1.781622
train_loss: 0.303499
valid_loss: 1.065867
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0029875907483044293
Epoch-9 lr: 0.014937953741522146
epoch 9 training time: 15.096
---------------
2023-09-11 08:59:28.863856
current #epochs=10, #steps=360
start validation
acc: 0.777251
AUC: 0.888865
Avg Precision: 0.344269
Avg Recall: 1.000000
d_prime: 1.726067
train_loss: 0.277625
valid_loss: 1.078784
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00261396358575501
Epoch-10 lr: 0.013069817928775049
epoch 10 training time: 14.947
---------------
2023-09-11 08:59:43.810680
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03635	Per Sample Data Time 0.02956	Per Sample DNN Time 0.00679	Train Loss 0.2579	
start validation
acc: 0.781991
AUC: 0.896749
Avg Precision: 0.329867
Avg Recall: 1.000000
d_prime: 1.786491
train_loss: 0.257087
valid_loss: 1.077330
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00261396358575501
Epoch-11 lr: 0.013069817928775049
epoch 11 training time: 14.987
---------------
2023-09-11 08:59:58.798250
current #epochs=12, #steps=440
start validation
acc: 0.791469
AUC: 0.898040
Avg Precision: 0.324808
Avg Recall: 1.000000
d_prime: 1.796701
train_loss: 0.204724
valid_loss: 1.059461
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00261396358575501
Epoch-12 lr: 0.013069817928775049
epoch 12 training time: 18.398
---------------
2023-09-11 09:00:17.195977
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00563	Train Loss 0.2242	
start validation
acc: 0.800948
AUC: 0.897274
Avg Precision: 0.308601
Avg Recall: 1.000000
d_prime: 1.790635
train_loss: 0.229838
valid_loss: 1.065678
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00261396358575501
Epoch-13 lr: 0.013069817928775049
epoch 13 training time: 19.018
---------------
2023-09-11 09:00:36.214324
current #epochs=14, #steps=520
start validation
acc: 0.781991
AUC: 0.902956
Avg Precision: 0.318487
Avg Recall: 1.000000
d_prime: 1.836473
train_loss: 0.260504
valid_loss: 1.081237
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.00261396358575501
Epoch-14 lr: 0.013069817928775049
epoch 14 training time: 15.050
---------------
2023-09-11 09:00:51.264621
current #epochs=15, #steps=560
start validation
acc: 0.786730
AUC: 0.904590
Avg Precision: 0.328642
Avg Recall: 1.000000
d_prime: 1.850010
train_loss: 0.247643
valid_loss: 1.059301
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.00261396358575501
Epoch-15 lr: 0.013069817928775049
epoch 15 training time: 15.350
---------------
2023-09-11 09:01:06.614594
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03811	Per Sample Data Time 0.02742	Per Sample DNN Time 0.01068	Train Loss 0.2283	
start validation
acc: 0.758294
AUC: 0.909457
Avg Precision: 0.378361
Avg Recall: 1.000000
d_prime: 1.891397
train_loss: 0.217458
valid_loss: 1.043029
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.00261396358575501
Epoch-16 lr: 0.013069817928775049
epoch 16 training time: 16.821
---------------
2023-09-11 09:01:23.435255
current #epochs=17, #steps=640
start validation
acc: 0.777251
AUC: 0.900282
Avg Precision: 0.321647
Avg Recall: 1.000000
d_prime: 1.814659
train_loss: 0.269348
valid_loss: 1.069831
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.00261396358575501
Epoch-17 lr: 0.013069817928775049
epoch 17 training time: 16.767
---------------
2023-09-11 09:01:40.202291
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00702	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00555	Train Loss 0.1975	
start validation
acc: 0.786730
AUC: 0.896300
Avg Precision: 0.324669
Avg Recall: 1.000000
d_prime: 1.782964
train_loss: 0.227749
valid_loss: 1.077832
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.002287062119043937
Epoch-18 lr: 0.011435310595219683
epoch 18 training time: 14.901
---------------
2023-09-11 09:01:55.103456
current #epochs=19, #steps=720
start validation
acc: 0.786730
AUC: 0.909584
Avg Precision: 0.336884
Avg Recall: 1.000000
d_prime: 1.892500
train_loss: 0.227927
valid_loss: 1.055039
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.002287062119043937
Epoch-19 lr: 0.011435310595219683
epoch 19 training time: 15.408
---------------
2023-09-11 09:02:10.511821
current #epochs=20, #steps=760
start validation
acc: 0.834123
AUC: 0.899339
Avg Precision: 0.328507
Avg Recall: 1.000000
d_prime: 1.807072
train_loss: 0.238044
valid_loss: 1.063074
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.002287062119043937
Epoch-20 lr: 0.011435310595219683
epoch 20 training time: 18.059
---------------
2023-09-11 09:02:28.570911
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03734	Per Sample Data Time 0.02842	Per Sample DNN Time 0.00893	Train Loss 0.1760	
start validation
acc: 0.786730
AUC: 0.897908
Avg Precision: 0.308996
Avg Recall: 1.000000
d_prime: 1.795656
train_loss: 0.193365
valid_loss: 1.059143
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.002287062119043937
Epoch-21 lr: 0.011435310595219683
epoch 21 training time: 15.006
---------------
2023-09-11 09:02:43.576684
current #epochs=22, #steps=840
start validation
acc: 0.781991
AUC: 0.890732
Avg Precision: 0.297197
Avg Recall: 1.000000
d_prime: 1.740090
train_loss: 0.203793
valid_loss: 1.076395
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.002287062119043937
Epoch-22 lr: 0.011435310595219683
epoch 22 training time: 17.911
---------------
2023-09-11 09:03:01.488053
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00564	Train Loss 0.2217	
start validation
acc: 0.772512
AUC: 0.917574
Avg Precision: 0.358698
Avg Recall: 1.000000
d_prime: 1.964257
train_loss: 0.204513
valid_loss: 1.059049
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.002287062119043937
Epoch-23 lr: 0.011435310595219683
epoch 23 training time: 15.375
---------------
2023-09-11 09:03:16.863624
current #epochs=24, #steps=920
start validation
acc: 0.772512
AUC: 0.903781
Avg Precision: 0.341008
Avg Recall: 1.000000
d_prime: 1.843289
train_loss: 0.259689
valid_loss: 1.074532
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.002287062119043937
Epoch-24 lr: 0.011435310595219683
epoch 24 training time: 14.928
---------------
2023-09-11 09:03:31.791429
current #epochs=25, #steps=960
start validation
[I 2023-09-11 09:03:46,702] Trial 13 finished with value: 0.8341232227488151 and parameters: {'warmup': 'True', 'num_epochs': 25, 'batch_size': 58, 'lr-adaptschedule': 'False', 'lr': 0.0029875907483044293, 'head-lr': 5, 'lr-scheduler-start': 10, 'lr-scheduler-step': 8, 'lr-scheduler-decay': 0.8749403134410337}. Best is trial 13 with value: 0.8341232227488151.
acc: 0.777251
AUC: 0.901434
Avg Precision: 0.330215
Avg Recall: 1.000000
d_prime: 1.824001
train_loss: 0.236841
valid_loss: 1.060017
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.002287062119043937
Epoch-25 lr: 0.011435310595219683
epoch 25 training time: 14.906
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863d97d880>
The learning rate scheduler starts at 10 epoch with decay rate of 0.874 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 09:03:46.734376
current #epochs=1, #steps=0
start validation
acc: 0.763033
AUC: 0.890545
Avg Precision: 0.299868
Avg Recall: 1.000000
d_prime: 1.738680
train_loss: 0.225866
valid_loss: 1.072695
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0016561496399333624
Epoch-1 lr: 0.008280748199666812
epoch 1 training time: 17.970
---------------
2023-09-11 09:04:04.704651
current #epochs=2, #steps=40
start validation
acc: 0.781991
AUC: 0.906888
Avg Precision: 0.367904
Avg Recall: 1.000000
d_prime: 1.869355
train_loss: 0.172618
valid_loss: 1.045189
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0016561496399333624
Epoch-2 lr: 0.008280748199666812
epoch 2 training time: 16.997
---------------
2023-09-11 09:04:21.701681
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00157	Per Sample DNN Time 0.00557	Train Loss 0.1418	
start validation
acc: 0.786730
AUC: 0.907187
Avg Precision: 0.358970
Avg Recall: 1.000000
d_prime: 1.871891
train_loss: 0.167351
valid_loss: 1.041226
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0016561496399333624
Epoch-3 lr: 0.008280748199666812
epoch 3 training time: 17.703
---------------
2023-09-11 09:04:39.405111
current #epochs=4, #steps=120
start validation
acc: 0.767773
AUC: 0.907738
Avg Precision: 0.350904
Avg Recall: 1.000000
d_prime: 1.876599
train_loss: 0.186724
valid_loss: 1.061061
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0016561496399333624
Epoch-4 lr: 0.008280748199666812
epoch 4 training time: 15.037
---------------
2023-09-11 09:04:54.441743
current #epochs=5, #steps=160
start validation
acc: 0.767773
AUC: 0.891176
Avg Precision: 0.318578
Avg Recall: 1.000000
d_prime: 1.743453
train_loss: 0.168026
valid_loss: 1.066571
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0016561496399333624
Epoch-5 lr: 0.008280748199666812
epoch 5 training time: 15.194
---------------
2023-09-11 09:05:09.635703
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03582	Per Sample Data Time 0.02820	Per Sample DNN Time 0.00761	Train Loss 0.0946	
start validation
acc: 0.786730
AUC: 0.891614
Avg Precision: 0.314298
Avg Recall: 1.000000
d_prime: 1.746774
train_loss: 0.201071
valid_loss: 1.093475
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0016561496399333624
Epoch-6 lr: 0.008280748199666812
epoch 6 training time: 16.168
---------------
2023-09-11 09:05:25.803691
current #epochs=7, #steps=240
start validation
acc: 0.791469
AUC: 0.905994
Avg Precision: 0.325643
Avg Recall: 1.000000
d_prime: 1.861788
train_loss: 0.182930
valid_loss: 1.072073
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0016561496399333624
Epoch-7 lr: 0.008280748199666812
epoch 7 training time: 16.904
---------------
2023-09-11 09:05:42.708552
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00563	Train Loss 0.1991	
start validation
acc: 0.800948
AUC: 0.908363
Avg Precision: 0.333889
Avg Recall: 1.000000
d_prime: 1.881956
train_loss: 0.197448
valid_loss: 1.053999
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0016561496399333624
Epoch-8 lr: 0.008280748199666812
epoch 8 training time: 18.886
---------------
2023-09-11 09:06:01.594058
current #epochs=9, #steps=320
start validation
acc: 0.763033
AUC: 0.895260
Avg Precision: 0.311887
Avg Recall: 1.000000
d_prime: 1.774832
train_loss: 0.164053
valid_loss: 1.055843
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0016561496399333624
Epoch-9 lr: 0.008280748199666812
epoch 9 training time: 15.058
---------------
2023-09-11 09:06:16.652557
current #epochs=10, #steps=360
start validation
acc: 0.781991
AUC: 0.904742
Avg Precision: 0.323210
Avg Recall: 1.000000
d_prime: 1.851284
train_loss: 0.147445
valid_loss: 1.058104
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0014477765780202543
Epoch-10 lr: 0.007238882890101272
epoch 10 training time: 15.133
---------------
2023-09-11 09:06:31.785937
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03767	Per Sample Data Time 0.02922	Per Sample DNN Time 0.00845	Train Loss 0.1861	
start validation
acc: 0.772512
AUC: 0.910368
Avg Precision: 0.351222
Avg Recall: 1.000000
d_prime: 1.899321
train_loss: 0.172217
valid_loss: 1.045295
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0014477765780202543
Epoch-11 lr: 0.007238882890101272
epoch 11 training time: 17.766
---------------
2023-09-11 09:06:49.552199
current #epochs=12, #steps=440
start validation
acc: 0.796209
AUC: 0.894929
Avg Precision: 0.320223
Avg Recall: 1.000000
d_prime: 1.772259
train_loss: 0.163997
valid_loss: 1.070056
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0014477765780202543
Epoch-12 lr: 0.007238882890101272
epoch 12 training time: 15.118
---------------
2023-09-11 09:07:04.670316
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00555	Train Loss 0.1210	
start validation
acc: 0.800948
AUC: 0.906804
Avg Precision: 0.307200
Avg Recall: 1.000000
d_prime: 1.868638
train_loss: 0.115619
valid_loss: 1.047088
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0014477765780202543
Epoch-13 lr: 0.007238882890101272
epoch 13 training time: 14.869
---------------
2023-09-11 09:07:19.539789
current #epochs=14, #steps=520
start validation
acc: 0.796209
AUC: 0.907286
Avg Precision: 0.322829
Avg Recall: 1.000000
d_prime: 1.872739
train_loss: 0.162795
valid_loss: 1.037784
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0014477765780202543
Epoch-14 lr: 0.007238882890101272
epoch 14 training time: 14.994
---------------
2023-09-11 09:07:34.534029
current #epochs=15, #steps=560
start validation
acc: 0.791469
AUC: 0.901317
Avg Precision: 0.312805
Avg Recall: 1.000000
d_prime: 1.823053
train_loss: 0.150169
valid_loss: 1.049957
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0014477765780202543
Epoch-15 lr: 0.007238882890101272
epoch 15 training time: 14.880
---------------
2023-09-11 09:07:49.414198
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03388	Per Sample Data Time 0.02726	Per Sample DNN Time 0.00661	Train Loss 0.1285	
start validation
acc: 0.800948
AUC: 0.914569
Avg Precision: 0.333032
Avg Recall: 1.000000
d_prime: 1.936678
train_loss: 0.145854
valid_loss: 1.045929
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0014477765780202543
Epoch-16 lr: 0.007238882890101272
epoch 16 training time: 16.930
---------------
2023-09-11 09:08:06.344269
current #epochs=17, #steps=640
start validation
acc: 0.777251
AUC: 0.901784
Avg Precision: 0.322685
Avg Recall: 1.000000
d_prime: 1.826862
train_loss: 0.129241
valid_loss: 1.059277
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0014477765780202543
Epoch-17 lr: 0.007238882890101272
epoch 17 training time: 15.165
---------------
2023-09-11 09:08:21.509655
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00703	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00558	Train Loss 0.1529	
start validation
acc: 0.767773
AUC: 0.900011
Avg Precision: 0.309008
Avg Recall: 1.000000
d_prime: 1.812472
train_loss: 0.155572
valid_loss: 1.048756
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0014477765780202543
Epoch-18 lr: 0.007238882890101272
epoch 18 training time: 15.376
---------------
2023-09-11 09:08:36.885641
current #epochs=19, #steps=720
start validation
acc: 0.781991
AUC: 0.895404
Avg Precision: 0.308622
Avg Recall: 1.000000
d_prime: 1.775956
train_loss: 0.166321
valid_loss: 1.058713
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0012656205510200005
Epoch-19 lr: 0.006328102755100003
epoch 19 training time: 14.806
---------------
2023-09-11 09:08:51.691786
current #epochs=20, #steps=760
start validation
acc: 0.786730
AUC: 0.893341
Avg Precision: 0.319675
Avg Recall: 1.000000
d_prime: 1.759981
train_loss: 0.137856
valid_loss: 1.063812
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0012656205510200005
Epoch-20 lr: 0.006328102755100003
epoch 20 training time: 16.819
---------------
2023-09-11 09:09:08.511070
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03703	Per Sample Data Time 0.02962	Per Sample DNN Time 0.00741	Train Loss 0.1342	
start validation
[I 2023-09-11 09:09:23,959] Trial 14 finished with value: 0.8009478672985783 and parameters: {'warmup': 'True', 'num_epochs': 21, 'batch_size': 63, 'lr-adaptschedule': 'False', 'lr': 0.0016561496399333624, 'head-lr': 5, 'lr-scheduler-start': 10, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.8741822255134553}. Best is trial 13 with value: 0.8341232227488151.
acc: 0.786730
AUC: 0.902720
Avg Precision: 0.306463
Avg Recall: 1.000000
d_prime: 1.834527
train_loss: 0.132900
valid_loss: 1.056559
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0012656205510200005
Epoch-21 lr: 0.006328102755100003
epoch 21 training time: 15.443
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f8644888e50>
The learning rate scheduler starts at 8 epoch with decay rate of 0.865 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 09:09:23.990951
current #epochs=1, #steps=0
start validation
acc: 0.763033
AUC: 0.893399
Avg Precision: 0.340815
Avg Recall: 1.000000
d_prime: 1.760422
train_loss: 0.353899
valid_loss: 1.094713
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0032584161084045033
Epoch-1 lr: 0.016292080542022518
epoch 1 training time: 18.701
---------------
2023-09-11 09:09:42.692632
current #epochs=2, #steps=40
start validation
acc: 0.786730
AUC: 0.909187
Avg Precision: 0.352155
Avg Recall: 1.000000
d_prime: 1.889061
train_loss: 0.227258
valid_loss: 1.073214
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0032584161084045033
Epoch-2 lr: 0.016292080542022518
epoch 2 training time: 17.264
---------------
2023-09-11 09:09:59.956654
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00562	Train Loss 0.1764	
start validation
acc: 0.800948
AUC: 0.902895
Avg Precision: 0.319378
Avg Recall: 1.000000
d_prime: 1.835969
train_loss: 0.176491
valid_loss: 1.049428
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0032584161084045033
Epoch-3 lr: 0.016292080542022518
epoch 3 training time: 17.662
---------------
2023-09-11 09:10:17.618110
current #epochs=4, #steps=120
start validation
acc: 0.796209
AUC: 0.889900
Avg Precision: 0.302017
Avg Recall: 1.000000
d_prime: 1.733818
train_loss: 0.216296
valid_loss: 1.066408
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0032584161084045033
Epoch-4 lr: 0.016292080542022518
epoch 4 training time: 15.181
---------------
2023-09-11 09:10:32.799517
current #epochs=5, #steps=160
start validation
acc: 0.763033
AUC: 0.913792
Avg Precision: 0.355449
Avg Recall: 1.000000
d_prime: 1.929670
train_loss: 0.176198
valid_loss: 1.045466
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0032584161084045033
Epoch-5 lr: 0.016292080542022518
epoch 5 training time: 16.189
---------------
2023-09-11 09:10:48.988875
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03874	Per Sample Data Time 0.02963	Per Sample DNN Time 0.00911	Train Loss 0.1677	
start validation
acc: 0.786730
AUC: 0.903214
Avg Precision: 0.300283
Avg Recall: 1.000000
d_prime: 1.838601
train_loss: 0.178221
valid_loss: 1.052714
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0032584161084045033
Epoch-6 lr: 0.016292080542022518
epoch 6 training time: 15.170
---------------
2023-09-11 09:11:04.158545
current #epochs=7, #steps=240
start validation
acc: 0.796209
AUC: 0.904456
Avg Precision: 0.309844
Avg Recall: 1.000000
d_prime: 1.848898
train_loss: 0.221049
valid_loss: 1.066624
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0032584161084045033
Epoch-7 lr: 0.016292080542022518
epoch 7 training time: 15.057
---------------
2023-09-11 09:11:19.215696
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00700	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00555	Train Loss 0.2081	
start validation
acc: 0.767773
AUC: 0.896504
Avg Precision: 0.304466
Avg Recall: 1.000000
d_prime: 1.784568
train_loss: 0.208084
valid_loss: 1.067278
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0028170160172226004
Epoch-8 lr: 0.014085080086113002
epoch 8 training time: 14.950
---------------
2023-09-11 09:11:34.165528
current #epochs=9, #steps=320
start validation
acc: 0.767773
AUC: 0.880069
Avg Precision: 0.294315
Avg Recall: 1.000000
d_prime: 1.662169
train_loss: 0.195543
valid_loss: 1.080401
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0028170160172226004
Epoch-9 lr: 0.014085080086113002
epoch 9 training time: 15.976
---------------
2023-09-11 09:11:50.141552
current #epochs=10, #steps=360
start validation
acc: 0.772512
AUC: 0.895532
Avg Precision: 0.312196
Avg Recall: 1.000000
d_prime: 1.776953
train_loss: 0.211529
valid_loss: 1.055468
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0028170160172226004
Epoch-10 lr: 0.014085080086113002
epoch 10 training time: 15.066
---------------
2023-09-11 09:12:05.207549
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03617	Per Sample Data Time 0.02883	Per Sample DNN Time 0.00734	Train Loss 0.2986	
start validation
acc: 0.777251
AUC: 0.901062
Avg Precision: 0.315157
Avg Recall: 1.000000
d_prime: 1.820983
train_loss: 0.203112
valid_loss: 1.065187
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0028170160172226004
Epoch-11 lr: 0.014085080086113002
epoch 11 training time: 15.974
---------------
2023-09-11 09:12:21.181713
current #epochs=12, #steps=440
start validation
acc: 0.763033
AUC: 0.885965
Avg Precision: 0.326415
Avg Recall: 1.000000
d_prime: 1.704613
train_loss: 0.178072
valid_loss: 1.077550
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0028170160172226004
Epoch-12 lr: 0.014085080086113002
epoch 12 training time: 14.914
---------------
2023-09-11 09:12:36.096073
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00564	Train Loss 0.1841	
start validation
acc: 0.791469
AUC: 0.897790
Avg Precision: 0.318849
Avg Recall: 1.000000
d_prime: 1.794717
train_loss: 0.183059
valid_loss: 1.069077
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0024354100204759823
Epoch-13 lr: 0.012177050102379912
epoch 13 training time: 17.333
---------------
2023-09-11 09:12:53.428124
current #epochs=14, #steps=520
start validation
acc: 0.791469
AUC: 0.904781
Avg Precision: 0.301365
Avg Recall: 1.000000
d_prime: 1.851612
train_loss: 0.151397
valid_loss: 1.059562
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0024354100204759823
Epoch-14 lr: 0.012177050102379912
epoch 14 training time: 16.352
---------------
2023-09-11 09:13:09.780521
current #epochs=15, #steps=560
start validation
acc: 0.781991
AUC: 0.896453
Avg Precision: 0.301537
Avg Recall: 1.000000
d_prime: 1.784169
train_loss: 0.139667
valid_loss: 1.063730
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0024354100204759823
Epoch-15 lr: 0.012177050102379912
epoch 15 training time: 16.427
---------------
2023-09-11 09:13:26.206984
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03613	Per Sample Data Time 0.02688	Per Sample DNN Time 0.00925	Train Loss 0.1131	
start validation
acc: 0.763033
AUC: 0.898060
Avg Precision: 0.307972
Avg Recall: 1.000000
d_prime: 1.796866
train_loss: 0.170239
valid_loss: 1.058664
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0024354100204759823
Epoch-16 lr: 0.012177050102379912
epoch 16 training time: 14.936
---------------
2023-09-11 09:13:41.142480
current #epochs=17, #steps=640
start validation
acc: 0.777251
AUC: 0.900079
Avg Precision: 0.316645
Avg Recall: 1.000000
d_prime: 1.813022
train_loss: 0.169525
valid_loss: 1.061712
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0024354100204759823
Epoch-17 lr: 0.012177050102379912
epoch 17 training time: 15.962
---------------
2023-09-11 09:13:57.104493
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00704	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00557	Train Loss 0.2534	
start validation
acc: 0.786730
AUC: 0.895699
Avg Precision: 0.324811
Avg Recall: 1.000000
d_prime: 1.778260
train_loss: 0.279238
valid_loss: 1.079067
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0021054981340442053
Epoch-18 lr: 0.010527490670221028
epoch 18 training time: 15.560
---------------
2023-09-11 09:14:12.664668
current #epochs=19, #steps=720
start validation
acc: 0.781991
AUC: 0.896327
Avg Precision: 0.304904
Avg Recall: 1.000000
d_prime: 1.783176
train_loss: 0.214362
valid_loss: 1.065723
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0021054981340442053
Epoch-19 lr: 0.010527490670221028
epoch 19 training time: 15.984
---------------
2023-09-11 09:14:28.648836
current #epochs=20, #steps=760
start validation
acc: 0.819905
AUC: 0.893609
Avg Precision: 0.300889
Avg Recall: 1.000000
d_prime: 1.762042
train_loss: 0.170725
valid_loss: 1.056129
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0021054981340442053
Epoch-20 lr: 0.010527490670221028
epoch 20 training time: 16.910
---------------
2023-09-11 09:14:45.558730
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03508	Per Sample Data Time 0.02754	Per Sample DNN Time 0.00754	Train Loss 0.1470	
start validation
acc: 0.796209
AUC: 0.913527
Avg Precision: 0.335698
Avg Recall: 1.000000
d_prime: 1.927292
train_loss: 0.138996
valid_loss: 1.045919
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0021054981340442053
Epoch-21 lr: 0.010527490670221028
epoch 21 training time: 15.446
---------------
2023-09-11 09:15:01.004492
current #epochs=22, #steps=840
start validation
acc: 0.805687
AUC: 0.917717
Avg Precision: 0.330737
Avg Recall: 1.000000
d_prime: 1.965582
train_loss: 0.171775
valid_loss: 1.037277
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0021054981340442053
Epoch-22 lr: 0.010527490670221028
epoch 22 training time: 15.010
---------------
2023-09-11 09:15:16.014780
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00563	Train Loss 0.1434	
start validation
acc: 0.805687
AUC: 0.908063
Avg Precision: 0.299427
Avg Recall: 1.000000
d_prime: 1.879377
train_loss: 0.145145
valid_loss: 1.040884
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0018202776350559693
Epoch-23 lr: 0.009101388175279848
epoch 23 training time: 15.041
---------------
2023-09-11 09:15:31.056194
current #epochs=24, #steps=920
start validation
[I 2023-09-11 09:15:49,118] Trial 15 finished with value: 0.8199052132701422 and parameters: {'warmup': 'True', 'num_epochs': 24, 'batch_size': 57, 'lr-adaptschedule': 'False', 'lr': 0.0032584161084045033, 'head-lr': 5, 'lr-scheduler-start': 8, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.8645353826838168}. Best is trial 13 with value: 0.8341232227488151.
acc: 0.810427
AUC: 0.906076
Avg Precision: 0.308276
Avg Recall: 1.000000
d_prime: 1.862476
train_loss: 0.154610
valid_loss: 1.032873
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0018202776350559693
Epoch-24 lr: 0.009101388175279848
epoch 24 training time: 18.056
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863ef9a7f0>
The learning rate scheduler starts at 9 epoch with decay rate of 0.852 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 09:15:49.149277
current #epochs=1, #steps=0
start validation
acc: 0.791469
AUC: 0.904455
Avg Precision: 0.317637
Avg Recall: 1.000000
d_prime: 1.848888
train_loss: 0.274671
valid_loss: 1.061487
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.00335443122033934
Epoch-1 lr: 0.010063293661018019
epoch 1 training time: 17.329
---------------
2023-09-11 09:16:06.478264
current #epochs=2, #steps=40
start validation
acc: 0.791469
AUC: 0.900981
Avg Precision: 0.312676
Avg Recall: 1.000000
d_prime: 1.820319
train_loss: 0.234829
valid_loss: 1.073646
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.00335443122033934
Epoch-2 lr: 0.010063293661018019
epoch 2 training time: 17.388
---------------
2023-09-11 09:16:23.866970
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00558	Train Loss 0.1952	
start validation
acc: 0.786730
AUC: 0.887460
Avg Precision: 0.303316
Avg Recall: 1.000000
d_prime: 1.715625
train_loss: 0.182112
valid_loss: 1.060841
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.00335443122033934
Epoch-3 lr: 0.010063293661018019
epoch 3 training time: 15.005
---------------
2023-09-11 09:16:38.871932
current #epochs=4, #steps=120
start validation
acc: 0.772512
AUC: 0.896759
Avg Precision: 0.303044
Avg Recall: 1.000000
d_prime: 1.786573
train_loss: 0.170876
valid_loss: 1.062269
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00335443122033934
Epoch-4 lr: 0.010063293661018019
epoch 4 training time: 15.033
---------------
2023-09-11 09:16:53.904674
current #epochs=5, #steps=160
start validation
acc: 0.767773
AUC: 0.886981
Avg Precision: 0.298982
Avg Recall: 1.000000
d_prime: 1.712084
train_loss: 0.247505
valid_loss: 1.071448
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00335443122033934
Epoch-5 lr: 0.010063293661018019
epoch 5 training time: 16.049
---------------
2023-09-11 09:17:09.953343
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03761	Per Sample Data Time 0.03045	Per Sample DNN Time 0.00717	Train Loss 0.1711	
start validation
acc: 0.772512
AUC: 0.905119
Avg Precision: 0.321471
Avg Recall: 1.000000
d_prime: 1.854433
train_loss: 0.204274
valid_loss: 1.048115
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00335443122033934
Epoch-6 lr: 0.010063293661018019
epoch 6 training time: 15.168
---------------
2023-09-11 09:17:25.121436
current #epochs=7, #steps=240
start validation
acc: 0.777251
AUC: 0.919168
Avg Precision: 0.336833
Avg Recall: 1.000000
d_prime: 1.979192
train_loss: 0.215978
valid_loss: 1.058817
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00335443122033934
Epoch-7 lr: 0.010063293661018019
epoch 7 training time: 15.012
---------------
2023-09-11 09:17:40.133457
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00562	Train Loss 0.1686	
start validation
acc: 0.791469
AUC: 0.905970
Avg Precision: 0.332844
Avg Recall: 1.000000
d_prime: 1.861587
train_loss: 0.207322
valid_loss: 1.061759
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00335443122033934
Epoch-8 lr: 0.010063293661018019
epoch 8 training time: 16.079
---------------
2023-09-11 09:17:56.212159
current #epochs=9, #steps=320
start validation
acc: 0.781991
AUC: 0.908114
Avg Precision: 0.332218
Avg Recall: 1.000000
d_prime: 1.879814
train_loss: 0.250458
valid_loss: 1.056780
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0028569870406408822
Epoch-9 lr: 0.008570961121922646
epoch 9 training time: 15.123
---------------
2023-09-11 09:18:11.335422
current #epochs=10, #steps=360
start validation
acc: 0.796209
AUC: 0.911151
Avg Precision: 0.350260
Avg Recall: 1.000000
d_prime: 1.906188
train_loss: 0.220203
valid_loss: 1.037094
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0028569870406408822
Epoch-10 lr: 0.008570961121922646
epoch 10 training time: 16.815
---------------
2023-09-11 09:18:28.150989
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03822	Per Sample Data Time 0.02798	Per Sample DNN Time 0.01024	Train Loss 0.2389	
start validation
acc: 0.786730
AUC: 0.904507
Avg Precision: 0.339771
Avg Recall: 1.000000
d_prime: 1.849322
train_loss: 0.185768
valid_loss: 1.064496
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0028569870406408822
Epoch-11 lr: 0.008570961121922646
epoch 11 training time: 15.137
---------------
2023-09-11 09:18:43.287797
current #epochs=12, #steps=440
start validation
acc: 0.800948
AUC: 0.897591
Avg Precision: 0.322937
Avg Recall: 1.000000
d_prime: 1.793144
train_loss: 0.206161
valid_loss: 1.050322
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0028569870406408822
Epoch-12 lr: 0.008570961121922646
epoch 12 training time: 17.080
---------------
2023-09-11 09:19:00.367558
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00567	Train Loss 0.1926	
start validation
acc: 0.781991
AUC: 0.893913
Avg Precision: 0.306369
Avg Recall: 1.000000
d_prime: 1.764386
train_loss: 0.210741
valid_loss: 1.077216
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.002433311167895768
Epoch-13 lr: 0.007299933503687304
epoch 13 training time: 16.024
---------------
2023-09-11 09:19:16.391518
current #epochs=14, #steps=520
start validation
acc: 0.810427
AUC: 0.891084
Avg Precision: 0.323510
Avg Recall: 1.000000
d_prime: 1.742753
train_loss: 0.143164
valid_loss: 1.056998
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.002433311167895768
Epoch-14 lr: 0.007299933503687304
epoch 14 training time: 17.124
---------------
2023-09-11 09:19:33.515374
current #epochs=15, #steps=560
start validation
acc: 0.781991
AUC: 0.898895
Avg Precision: 0.311328
Avg Recall: 1.000000
d_prime: 1.803518
train_loss: 0.137022
valid_loss: 1.065263
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.002433311167895768
Epoch-15 lr: 0.007299933503687304
epoch 15 training time: 16.172
---------------
2023-09-11 09:19:49.687688
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03520	Per Sample Data Time 0.02736	Per Sample DNN Time 0.00783	Train Loss 0.0806	
start validation
acc: 0.786730
AUC: 0.897601
Avg Precision: 0.310718
Avg Recall: 1.000000
d_prime: 1.793219
train_loss: 0.145309
valid_loss: 1.060335
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.002433311167895768
Epoch-16 lr: 0.007299933503687304
epoch 16 training time: 14.993
---------------
2023-09-11 09:20:04.680877
current #epochs=17, #steps=640
start validation
acc: 0.791469
AUC: 0.920146
Avg Precision: 0.359866
Avg Recall: 1.000000
d_prime: 1.988464
train_loss: 0.163890
valid_loss: 1.041150
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.002072464157372608
Epoch-17 lr: 0.006217392472117824
epoch 17 training time: 16.640
---------------
2023-09-11 09:20:21.320949
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00560	Train Loss 0.1519	
start validation
acc: 0.819905
AUC: 0.903677
Avg Precision: 0.338656
Avg Recall: 1.000000
d_prime: 1.842423
train_loss: 0.146365
valid_loss: 1.042503
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.002072464157372608
Epoch-18 lr: 0.006217392472117824
epoch 18 training time: 17.449
---------------
2023-09-11 09:20:38.769906
current #epochs=19, #steps=720
start validation
acc: 0.786730
AUC: 0.918527
Avg Precision: 0.344868
Avg Recall: 1.000000
d_prime: 1.973159
train_loss: 0.130543
valid_loss: 1.022640
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.002072464157372608
Epoch-19 lr: 0.006217392472117824
epoch 19 training time: 15.903
---------------
2023-09-11 09:20:54.672843
current #epochs=20, #steps=760
start validation
acc: 0.810427
AUC: 0.891369
Avg Precision: 0.317065
Avg Recall: 1.000000
d_prime: 1.744919
train_loss: 0.135359
valid_loss: 1.052170
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.002072464157372608
Epoch-20 lr: 0.006217392472117824
epoch 20 training time: 19.296
---------------
2023-09-11 09:21:13.968401
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03661	Per Sample Data Time 0.02701	Per Sample DNN Time 0.00960	Train Loss 0.1846	
start validation
[I 2023-09-11 09:21:30,431] Trial 16 finished with value: 0.8199052132701422 and parameters: {'warmup': 'True', 'num_epochs': 21, 'batch_size': 57, 'lr-adaptschedule': 'False', 'lr': 0.00335443122033934, 'head-lr': 3, 'lr-scheduler-start': 9, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.8517053571758328}. Best is trial 13 with value: 0.8341232227488151.
acc: 0.781991
AUC: 0.888859
Avg Precision: 0.311427
Avg Recall: 1.000000
d_prime: 1.726019
train_loss: 0.133065
valid_loss: 1.056773
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0017651288253891484
Epoch-21 lr: 0.005295386476167446
epoch 21 training time: 16.458
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f85b55a7850>
The learning rate scheduler starts at 8 epoch with decay rate of 0.896 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 09:21:30.462631
current #epochs=1, #steps=0
start validation
[I 2023-09-11 09:21:48,363] Trial 17 finished with value: 0.7677725118483413 and parameters: {'warmup': 'True', 'num_epochs': 1, 'batch_size': 56, 'lr-adaptschedule': 'False', 'lr': 0.004842172090995937, 'head-lr': 5, 'lr-scheduler-start': 8, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.8961405730333164}. Best is trial 13 with value: 0.8341232227488151.
acc: 0.767773
AUC: 0.875692
Avg Precision: 0.306873
Avg Recall: 1.000000
d_prime: 1.631604
train_loss: 0.395723
valid_loss: 1.106705
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.004842172090995937
Epoch-1 lr: 0.024210860454979687
epoch 1 training time: 17.895
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f8667062370>
The learning rate scheduler starts at 10 epoch with decay rate of 0.850 every 8 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 09:21:48.395026
current #epochs=1, #steps=0
start validation
acc: 0.767773
AUC: 0.877012
Avg Precision: 0.329032
Avg Recall: 1.000000
d_prime: 1.640741
train_loss: 0.282374
valid_loss: 1.074320
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0033835770004744577
Epoch-1 lr: 0.010150731001423373
epoch 1 training time: 16.877
---------------
2023-09-11 09:22:05.272159
current #epochs=2, #steps=40
start validation
acc: 0.767773
AUC: 0.900071
Avg Precision: 0.305282
Avg Recall: 1.000000
d_prime: 1.812959
train_loss: 0.265341
valid_loss: 1.060390
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0033835770004744577
Epoch-2 lr: 0.010150731001423373
epoch 2 training time: 16.413
---------------
2023-09-11 09:22:21.685091
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00724	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00571	Train Loss 0.2131	
start validation
acc: 0.805687
AUC: 0.909748
Avg Precision: 0.337424
Avg Recall: 1.000000
d_prime: 1.893917
train_loss: 0.199964
valid_loss: 1.046033
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0033835770004744577
Epoch-3 lr: 0.010150731001423373
epoch 3 training time: 18.351
---------------
2023-09-11 09:22:40.036344
current #epochs=4, #steps=120
start validation
acc: 0.781991
AUC: 0.893892
Avg Precision: 0.279102
Avg Recall: 1.000000
d_prime: 1.764226
train_loss: 0.171022
valid_loss: 1.080866
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0033835770004744577
Epoch-4 lr: 0.010150731001423373
epoch 4 training time: 16.324
---------------
2023-09-11 09:22:56.360288
current #epochs=5, #steps=160
start validation
acc: 0.777251
AUC: 0.885459
Avg Precision: 0.308942
Avg Recall: 1.000000
d_prime: 1.700913
train_loss: 0.249440
valid_loss: 1.077261
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0033835770004744577
Epoch-5 lr: 0.010150731001423373
epoch 5 training time: 14.940
---------------
2023-09-11 09:23:11.300690
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03956	Per Sample Data Time 0.02908	Per Sample DNN Time 0.01048	Train Loss 0.0413	
start validation
acc: 0.800948
AUC: 0.909824
Avg Precision: 0.356615
Avg Recall: 1.000000
d_prime: 1.894584
train_loss: 0.195818
valid_loss: 1.045226
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0033835770004744577
Epoch-6 lr: 0.010150731001423373
epoch 6 training time: 15.108
---------------
2023-09-11 09:23:26.409075
current #epochs=7, #steps=240
start validation
acc: 0.772512
AUC: 0.889226
Avg Precision: 0.290511
Avg Recall: 1.000000
d_prime: 1.728766
train_loss: 0.225044
valid_loss: 1.070083
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0033835770004744577
Epoch-7 lr: 0.010150731001423373
epoch 7 training time: 15.030
---------------
2023-09-11 09:23:41.438654
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00698	Per Sample Data Time 0.00143	Per Sample DNN Time 0.00555	Train Loss 0.1904	
start validation
acc: 0.781991
AUC: 0.909143
Avg Precision: 0.323307
Avg Recall: 1.000000
d_prime: 1.888675
train_loss: 0.175190
valid_loss: 1.042764
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0033835770004744577
Epoch-8 lr: 0.010150731001423373
epoch 8 training time: 14.973
---------------
2023-09-11 09:23:56.411412
current #epochs=9, #steps=320
start validation
acc: 0.796209
AUC: 0.902159
Avg Precision: 0.321553
Avg Recall: 1.000000
d_prime: 1.829927
train_loss: 0.191698
valid_loss: 1.067406
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0033835770004744577
Epoch-9 lr: 0.010150731001423373
epoch 9 training time: 14.880
---------------
2023-09-11 09:24:11.291542
current #epochs=10, #steps=360
start validation
acc: 0.777251
AUC: 0.891438
Avg Precision: 0.312085
Avg Recall: 1.000000
d_prime: 1.745436
train_loss: 0.228012
valid_loss: 1.074906
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00287435351085299
Epoch-10 lr: 0.008623060532558971
epoch 10 training time: 15.415
---------------
2023-09-11 09:24:26.706563
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03498	Per Sample Data Time 0.02751	Per Sample DNN Time 0.00747	Train Loss 0.1016	
start validation
acc: 0.800948
AUC: 0.914372
Avg Precision: 0.327467
Avg Recall: 1.000000
d_prime: 1.934896
train_loss: 0.195089
valid_loss: 1.049945
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00287435351085299
Epoch-11 lr: 0.008623060532558971
epoch 11 training time: 14.882
---------------
2023-09-11 09:24:41.588855
current #epochs=12, #steps=440
start validation
[I 2023-09-11 09:25:01,105] Trial 18 finished with value: 0.8199052132701422 and parameters: {'warmup': 'False', 'num_epochs': 12, 'batch_size': 56, 'lr-adaptschedule': 'True', 'lr': 0.0033835770004744577, 'head-lr': 3, 'lr-scheduler-start': 10, 'lr-scheduler-step': 8, 'lr-scheduler-decay': 0.8495014330839634}. Best is trial 13 with value: 0.8341232227488151.
acc: 0.819905
AUC: 0.913343
Avg Precision: 0.363634
Avg Recall: 1.000000
d_prime: 1.925636
train_loss: 0.184423
valid_loss: 1.035582
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00287435351085299
Epoch-12 lr: 0.008623060532558971
epoch 12 training time: 19.511
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f85b52a9f10>
The learning rate scheduler starts at 9 epoch with decay rate of 0.917 every 7 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 09:25:01.136641
current #epochs=1, #steps=0
start validation
acc: 0.786730
AUC: 0.901969
Avg Precision: 0.351213
Avg Recall: 1.000000
d_prime: 1.828368
train_loss: 0.132529
valid_loss: 1.054449
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.001845412040343473
Epoch-1 lr: 0.007381648161373892
epoch 1 training time: 18.085
---------------
2023-09-11 09:25:19.222418
current #epochs=2, #steps=40
start validation
acc: 0.810427
AUC: 0.907661
Avg Precision: 0.329231
Avg Recall: 1.000000
d_prime: 1.875941
train_loss: 0.154381
valid_loss: 1.055052
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.001845412040343473
Epoch-2 lr: 0.007381648161373892
epoch 2 training time: 17.135
---------------
2023-09-11 09:25:36.357594
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00559	Train Loss 0.1502	
start validation
acc: 0.791469
AUC: 0.915884
Avg Precision: 0.357819
Avg Recall: 1.000000
d_prime: 1.948652
train_loss: 0.162681
valid_loss: 1.035627
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.001845412040343473
Epoch-3 lr: 0.007381648161373892
epoch 3 training time: 14.978
---------------
2023-09-11 09:25:51.335468
current #epochs=4, #steps=120
start validation
acc: 0.819905
AUC: 0.899084
Avg Precision: 0.320843
Avg Recall: 1.000000
d_prime: 1.805034
train_loss: 0.139857
valid_loss: 1.049309
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.001845412040343473
Epoch-4 lr: 0.007381648161373892
epoch 4 training time: 17.188
---------------
2023-09-11 09:26:08.523640
current #epochs=5, #steps=160
start validation
acc: 0.819905
AUC: 0.904764
Avg Precision: 0.328163
Avg Recall: 1.000000
d_prime: 1.851463
train_loss: 0.127987
valid_loss: 1.050749
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.001845412040343473
Epoch-5 lr: 0.007381648161373892
epoch 5 training time: 15.390
---------------
2023-09-11 09:26:23.913346
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03388	Per Sample Data Time 0.02739	Per Sample DNN Time 0.00649	Train Loss 0.0206	
start validation
acc: 0.786730
AUC: 0.910708
Avg Precision: 0.320596
Avg Recall: 1.000000
d_prime: 1.902294
train_loss: 0.141702
valid_loss: 1.046406
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.001845412040343473
Epoch-6 lr: 0.007381648161373892
epoch 6 training time: 16.498
---------------
2023-09-11 09:26:40.410882
current #epochs=7, #steps=240
start validation
acc: 0.834123
AUC: 0.928556
Avg Precision: 0.369901
Avg Recall: 1.000000
d_prime: 2.071993
train_loss: 0.137166
valid_loss: 1.024681
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.001845412040343473
Epoch-7 lr: 0.007381648161373892
epoch 7 training time: 18.729
---------------
2023-09-11 09:26:59.140015
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00566	Train Loss 0.1134	
start validation
acc: 0.786730
AUC: 0.905015
Avg Precision: 0.327403
Avg Recall: 1.000000
d_prime: 1.853565
train_loss: 0.134838
valid_loss: 1.045922
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001845412040343473
Epoch-8 lr: 0.007381648161373892
epoch 8 training time: 15.205
---------------
2023-09-11 09:27:14.344952
current #epochs=9, #steps=320
start validation
acc: 0.815166
AUC: 0.928660
Avg Precision: 0.353444
Avg Recall: 1.000000
d_prime: 2.073073
train_loss: 0.141719
valid_loss: 1.020463
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0016914223178974347
Epoch-9 lr: 0.006765689271589739
epoch 9 training time: 15.640
---------------
2023-09-11 09:27:29.984935
current #epochs=10, #steps=360
start validation
acc: 0.786730
AUC: 0.907878
Avg Precision: 0.328024
Avg Recall: 1.000000
d_prime: 1.877794
train_loss: 0.127857
valid_loss: 1.042397
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0016914223178974347
Epoch-10 lr: 0.006765689271589739
epoch 10 training time: 15.534
---------------
2023-09-11 09:27:45.519139
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03887	Per Sample Data Time 0.02910	Per Sample DNN Time 0.00976	Train Loss 0.0890	
start validation
acc: 0.800948
AUC: 0.901594
Avg Precision: 0.314905
Avg Recall: 1.000000
d_prime: 1.825304
train_loss: 0.144606
valid_loss: 1.049517
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0016914223178974347
Epoch-11 lr: 0.006765689271589739
epoch 11 training time: 15.935
---------------
2023-09-11 09:28:01.454279
current #epochs=12, #steps=440
start validation
acc: 0.786730
AUC: 0.909969
Avg Precision: 0.345219
Avg Recall: 1.000000
d_prime: 1.895847
train_loss: 0.109922
valid_loss: 1.078529
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0016914223178974347
Epoch-12 lr: 0.006765689271589739
epoch 12 training time: 15.134
---------------
2023-09-11 09:28:16.588152
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00560	Train Loss 0.1667	
start validation
acc: 0.791469
AUC: 0.882024
Avg Precision: 0.308702
Avg Recall: 1.000000
d_prime: 1.676080
train_loss: 0.143189
valid_loss: 1.096430
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0016914223178974347
Epoch-13 lr: 0.006765689271589739
epoch 13 training time: 14.960
---------------
2023-09-11 09:28:31.548417
current #epochs=14, #steps=520
start validation
acc: 0.805687
AUC: 0.896008
Avg Precision: 0.315723
Avg Recall: 1.000000
d_prime: 1.780674
train_loss: 0.147910
valid_loss: 1.066353
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0016914223178974347
Epoch-14 lr: 0.006765689271589739
epoch 14 training time: 15.124
---------------
2023-09-11 09:28:46.672337
current #epochs=15, #steps=560
start validation
acc: 0.791469
AUC: 0.908110
Avg Precision: 0.316797
Avg Recall: 1.000000
d_prime: 1.879779
train_loss: 0.121479
valid_loss: 1.045865
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0016914223178974347
Epoch-15 lr: 0.006765689271589739
epoch 15 training time: 15.024
---------------
2023-09-11 09:29:01.695896
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03535	Per Sample Data Time 0.02775	Per Sample DNN Time 0.00760	Train Loss 0.2520	
start validation
acc: 0.796209
AUC: 0.911084
Avg Precision: 0.318569
Avg Recall: 1.000000
d_prime: 1.905598
train_loss: 0.137705
valid_loss: 1.057378
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0015502822106596044
Epoch-16 lr: 0.006201128842638418
epoch 16 training time: 15.029
---------------
2023-09-11 09:29:16.724745
current #epochs=17, #steps=640
start validation
acc: 0.800948
AUC: 0.905719
Avg Precision: 0.325099
Avg Recall: 1.000000
d_prime: 1.859469
train_loss: 0.137070
valid_loss: 1.052412
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0015502822106596044
Epoch-17 lr: 0.006201128842638418
epoch 17 training time: 14.959
---------------
2023-09-11 09:29:31.683946
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00560	Train Loss 0.1088	
start validation
acc: 0.819905
AUC: 0.904842
Avg Precision: 0.323522
Avg Recall: 1.000000
d_prime: 1.852116
train_loss: 0.098106
valid_loss: 1.060898
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0015502822106596044
Epoch-18 lr: 0.006201128842638418
epoch 18 training time: 15.005
---------------
2023-09-11 09:29:46.689315
current #epochs=19, #steps=720
start validation
acc: 0.810427
AUC: 0.911360
Avg Precision: 0.339377
Avg Recall: 1.000000
d_prime: 1.908025
train_loss: 0.114672
valid_loss: 1.045268
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0015502822106596044
Epoch-19 lr: 0.006201128842638418
epoch 19 training time: 15.093
---------------
2023-09-11 09:30:01.782430
current #epochs=20, #steps=760
start validation
acc: 0.796209
AUC: 0.908417
Avg Precision: 0.322507
Avg Recall: 1.000000
d_prime: 1.882420
train_loss: 0.109762
valid_loss: 1.059443
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0015502822106596044
Epoch-20 lr: 0.006201128842638418
epoch 20 training time: 15.033
---------------
2023-09-11 09:30:16.815846
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03515	Per Sample Data Time 0.02811	Per Sample DNN Time 0.00704	Train Loss 0.2264	
start validation
acc: 0.805687
AUC: 0.910990
Avg Precision: 0.329447
Avg Recall: 1.000000
d_prime: 1.904768
train_loss: 0.102755
valid_loss: 1.055952
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0015502822106596044
Epoch-21 lr: 0.006201128842638418
epoch 21 training time: 17.714
---------------
2023-09-11 09:30:34.529743
current #epochs=22, #steps=840
start validation
acc: 0.810427
AUC: 0.918114
Avg Precision: 0.350974
Avg Recall: 1.000000
d_prime: 1.969286
train_loss: 0.103976
valid_loss: 1.052909
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0015502822106596044
Epoch-22 lr: 0.006201128842638418
epoch 22 training time: 15.090
---------------
2023-09-11 09:30:49.619676
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00560	Train Loss 0.0858	
start validation
acc: 0.791469
AUC: 0.908229
Avg Precision: 0.317498
Avg Recall: 1.000000
d_prime: 1.880806
train_loss: 0.105676
valid_loss: 1.037946
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.001420919487260406
Epoch-23 lr: 0.005683677949041624
epoch 23 training time: 15.064
---------------
2023-09-11 09:31:04.683808
current #epochs=24, #steps=920
start validation
acc: 0.800948
AUC: 0.904400
Avg Precision: 0.316082
Avg Recall: 1.000000
d_prime: 1.848432
train_loss: 0.108105
valid_loss: 1.038627
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.001420919487260406
Epoch-24 lr: 0.005683677949041624
epoch 24 training time: 14.987
---------------
2023-09-11 09:31:19.670428
current #epochs=25, #steps=960
start validation
[I 2023-09-11 09:31:34,639] Trial 19 finished with value: 0.8341232227488151 and parameters: {'warmup': 'True', 'num_epochs': 25, 'batch_size': 41, 'lr-adaptschedule': 'False', 'lr': 0.001845412040343473, 'head-lr': 4, 'lr-scheduler-start': 9, 'lr-scheduler-step': 7, 'lr-scheduler-decay': 0.9165553713319344}. Best is trial 13 with value: 0.8341232227488151.
acc: 0.763033
AUC: 0.898218
Avg Precision: 0.318578
Avg Recall: 1.000000
d_prime: 1.798122
train_loss: 0.117137
valid_loss: 1.060657
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.001420919487260406
Epoch-25 lr: 0.005683677949041624
epoch 25 training time: 14.965
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f85b52a97c0>
The learning rate scheduler starts at 9 epoch with decay rate of 0.903 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 09:31:34.671351
current #epochs=1, #steps=0
start validation
acc: 0.772512
AUC: 0.890758
Avg Precision: 0.289964
Avg Recall: 1.000000
d_prime: 1.740291
train_loss: 0.158226
valid_loss: 1.068951
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0017902538887417786
Epoch-1 lr: 0.0071610155549671145
epoch 1 training time: 17.176
---------------
2023-09-11 09:31:51.847793
current #epochs=2, #steps=40
start validation
acc: 0.796209
AUC: 0.917901
Avg Precision: 0.386861
Avg Recall: 1.000000
d_prime: 1.967296
train_loss: 0.125177
valid_loss: 1.034578
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0017902538887417786
Epoch-2 lr: 0.0071610155549671145
epoch 2 training time: 17.196
---------------
2023-09-11 09:32:09.043790
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00558	Train Loss 0.1348	
start validation
acc: 0.800948
AUC: 0.890021
Avg Precision: 0.297614
Avg Recall: 1.000000
d_prime: 1.734728
train_loss: 0.112312
valid_loss: 1.055230
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0017902538887417786
Epoch-3 lr: 0.0071610155549671145
epoch 3 training time: 17.147
---------------
2023-09-11 09:32:26.191121
current #epochs=4, #steps=120
start validation
acc: 0.791469
AUC: 0.903612
Avg Precision: 0.314840
Avg Recall: 1.000000
d_prime: 1.841884
train_loss: 0.109970
valid_loss: 1.048822
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0017902538887417786
Epoch-4 lr: 0.0071610155549671145
epoch 4 training time: 15.196
---------------
2023-09-11 09:32:41.386896
current #epochs=5, #steps=160
start validation
acc: 0.777251
AUC: 0.888915
Avg Precision: 0.288936
Avg Recall: 1.000000
d_prime: 1.726440
train_loss: 0.153913
valid_loss: 1.062581
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0017902538887417786
Epoch-5 lr: 0.0071610155549671145
epoch 5 training time: 14.917
---------------
2023-09-11 09:32:56.303788
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03449	Per Sample Data Time 0.02718	Per Sample DNN Time 0.00731	Train Loss 0.0316	
start validation
acc: 0.796209
AUC: 0.903503
Avg Precision: 0.309359
Avg Recall: 1.000000
d_prime: 1.840983
train_loss: 0.133266
valid_loss: 1.055531
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0017902538887417786
Epoch-6 lr: 0.0071610155549671145
epoch 6 training time: 14.973
---------------
2023-09-11 09:33:11.276836
current #epochs=7, #steps=240
start validation
acc: 0.791469
AUC: 0.909440
Avg Precision: 0.327190
Avg Recall: 1.000000
d_prime: 1.891249
train_loss: 0.137648
valid_loss: 1.044774
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0017902538887417786
Epoch-7 lr: 0.0071610155549671145
epoch 7 training time: 15.027
---------------
2023-09-11 09:33:26.304090
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00562	Train Loss 0.1223	
start validation
acc: 0.796209
AUC: 0.900381
Avg Precision: 0.319570
Avg Recall: 1.000000
d_prime: 1.815460
train_loss: 0.131652
valid_loss: 1.055606
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0017902538887417786
Epoch-8 lr: 0.0071610155549671145
epoch 8 training time: 15.097
---------------
2023-09-11 09:33:41.400601
current #epochs=9, #steps=320
start validation
acc: 0.810427
AUC: 0.913506
Avg Precision: 0.318790
Avg Recall: 1.000000
d_prime: 1.927099
train_loss: 0.113153
valid_loss: 1.055815
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0016160622242536152
Epoch-9 lr: 0.006464248897014461
epoch 9 training time: 17.044
---------------
2023-09-11 09:33:58.444969
current #epochs=10, #steps=360
start validation
acc: 0.791469
AUC: 0.891638
Avg Precision: 0.306439
Avg Recall: 1.000000
d_prime: 1.746960
train_loss: 0.143147
valid_loss: 1.055148
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0016160622242536152
Epoch-10 lr: 0.006464248897014461
epoch 10 training time: 15.187
---------------
2023-09-11 09:34:13.632263
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03787	Per Sample Data Time 0.02792	Per Sample DNN Time 0.00995	Train Loss 0.0659	
start validation
acc: 0.781991
AUC: 0.895812
Avg Precision: 0.316789
Avg Recall: 1.000000
d_prime: 1.779144
train_loss: 0.122894
valid_loss: 1.045602
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0016160622242536152
Epoch-11 lr: 0.006464248897014461
epoch 11 training time: 16.093
---------------
2023-09-11 09:34:29.725420
current #epochs=12, #steps=440
start validation
acc: 0.800948
AUC: 0.914023
Avg Precision: 0.330887
Avg Recall: 1.000000
d_prime: 1.931747
train_loss: 0.143644
valid_loss: 1.049828
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0016160622242536152
Epoch-12 lr: 0.006464248897014461
epoch 12 training time: 15.124
---------------
2023-09-11 09:34:44.849468
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00698	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00554	Train Loss 0.1338	
start validation
acc: 0.796209
AUC: 0.915355
Avg Precision: 0.318179
Avg Recall: 1.000000
d_prime: 1.943819
train_loss: 0.114940
valid_loss: 1.034663
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0016160622242536152
Epoch-13 lr: 0.006464248897014461
epoch 13 training time: 15.695
---------------
2023-09-11 09:35:00.544934
current #epochs=14, #steps=520
start validation
acc: 0.805687
AUC: 0.906601
Avg Precision: 0.317935
Avg Recall: 1.000000
d_prime: 1.866918
train_loss: 0.102095
valid_loss: 1.035343
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0016160622242536152
Epoch-14 lr: 0.006464248897014461
epoch 14 training time: 14.936
---------------
2023-09-11 09:35:15.480993
current #epochs=15, #steps=560
start validation
acc: 0.800948
AUC: 0.901250
Avg Precision: 0.303960
Avg Recall: 1.000000
d_prime: 1.822503
train_loss: 0.093215
valid_loss: 1.046175
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0016160622242536152
Epoch-15 lr: 0.006464248897014461
epoch 15 training time: 15.057
---------------
2023-09-11 09:35:30.538371
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03515	Per Sample Data Time 0.02800	Per Sample DNN Time 0.00715	Train Loss 0.0308	
start validation
acc: 0.819905
AUC: 0.895592
Avg Precision: 0.322768
Avg Recall: 1.000000
d_prime: 1.777426
train_loss: 0.116720
valid_loss: 1.055502
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0016160622242536152
Epoch-16 lr: 0.006464248897014461
epoch 16 training time: 16.931
---------------
2023-09-11 09:35:47.469733
current #epochs=17, #steps=640
start validation
acc: 0.786730
AUC: 0.923265
Avg Precision: 0.358169
Avg Recall: 1.000000
d_prime: 2.018621
train_loss: 0.102660
valid_loss: 1.036559
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0016160622242536152
Epoch-17 lr: 0.006464248897014461
epoch 17 training time: 14.954
---------------
2023-09-11 09:36:02.424024
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00565	Train Loss 0.1120	
start validation
acc: 0.791469
AUC: 0.902005
Avg Precision: 0.320698
Avg Recall: 1.000000
d_prime: 1.828661
train_loss: 0.121655
valid_loss: 1.051354
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0014588194049365028
Epoch-18 lr: 0.005835277619746011
epoch 18 training time: 14.995
---------------
2023-09-11 09:36:17.418752
current #epochs=19, #steps=720
start validation
acc: 0.815166
AUC: 0.901276
Avg Precision: 0.304389
Avg Recall: 1.000000
d_prime: 1.822720
train_loss: 0.095120
valid_loss: 1.053201
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0014588194049365028
Epoch-19 lr: 0.005835277619746011
epoch 19 training time: 15.037
---------------
2023-09-11 09:36:32.455816
current #epochs=20, #steps=760
start validation
acc: 0.796209
AUC: 0.910870
Avg Precision: 0.339078
Avg Recall: 1.000000
d_prime: 1.903716
train_loss: 0.111535
valid_loss: 1.047098
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0014588194049365028
Epoch-20 lr: 0.005835277619746011
epoch 20 training time: 15.061
---------------
2023-09-11 09:36:47.517418
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03642	Per Sample Data Time 0.02907	Per Sample DNN Time 0.00735	Train Loss 0.0523	
start validation
acc: 0.805687
AUC: 0.911573
Avg Precision: 0.318220
Avg Recall: 1.000000
d_prime: 1.909904
train_loss: 0.114038
valid_loss: 1.050522
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0014588194049365028
Epoch-21 lr: 0.005835277619746011
epoch 21 training time: 16.061
---------------
2023-09-11 09:37:03.577884
current #epochs=22, #steps=840
start validation
acc: 0.791469
AUC: 0.897604
Avg Precision: 0.298926
Avg Recall: 1.000000
d_prime: 1.793244
train_loss: 0.100789
valid_loss: 1.056936
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0014588194049365028
Epoch-22 lr: 0.005835277619746011
epoch 22 training time: 15.094
---------------
2023-09-11 09:37:18.672040
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00560	Train Loss 0.1113	
start validation
acc: 0.815166
AUC: 0.912343
Avg Precision: 0.339181
Avg Recall: 1.000000
d_prime: 1.916717
train_loss: 0.106726
valid_loss: 1.048839
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0014588194049365028
Epoch-23 lr: 0.005835277619746011
epoch 23 training time: 15.064
---------------
2023-09-11 09:37:33.736127
current #epochs=24, #steps=920
start validation
acc: 0.791469
AUC: 0.921808
Avg Precision: 0.359105
Avg Recall: 1.000000
d_prime: 2.004422
train_loss: 0.124277
valid_loss: 1.039014
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0014588194049365028
Epoch-24 lr: 0.005835277619746011
epoch 24 training time: 15.107
---------------
2023-09-11 09:37:48.843513
current #epochs=25, #steps=960
start validation
acc: 0.805687
AUC: 0.909723
Avg Precision: 0.309283
Avg Recall: 1.000000
d_prime: 1.893702
train_loss: 0.115475
valid_loss: 1.043372
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0014588194049365028
Epoch-25 lr: 0.005835277619746011
epoch 25 training time: 14.944
---------------
2023-09-11 09:38:03.787139
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03774	Per Sample Data Time 0.02836	Per Sample DNN Time 0.00938	Train Loss 0.0826	
start validation
acc: 0.786730
AUC: 0.891405
Avg Precision: 0.303360
Avg Recall: 1.000000
d_prime: 1.745190
train_loss: 0.117553
valid_loss: 1.065892
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0014588194049365028
Epoch-26 lr: 0.005835277619746011
epoch 26 training time: 15.026
---------------
2023-09-11 09:38:18.812820
current #epochs=27, #steps=1040
start validation
[I 2023-09-11 09:38:33,898] Trial 20 finished with value: 0.8199052132701422 and parameters: {'warmup': 'True', 'num_epochs': 27, 'batch_size': 43, 'lr-adaptschedule': 'False', 'lr': 0.0017902538887417786, 'head-lr': 4, 'lr-scheduler-start': 9, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.9027000217211714}. Best is trial 13 with value: 0.8341232227488151.
acc: 0.791469
AUC: 0.910202
Avg Precision: 0.368020
Avg Recall: 1.000000
d_prime: 1.897872
train_loss: 0.117208
valid_loss: 1.040867
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0013168763085234475
Epoch-27 lr: 0.00526750523409379
epoch 27 training time: 15.079
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863d97db80>
The learning rate scheduler starts at 8 epoch with decay rate of 0.919 every 7 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 09:38:33.931471
current #epochs=1, #steps=0
start validation
acc: 0.781991
AUC: 0.889007
Avg Precision: 0.284420
Avg Recall: 1.000000
d_prime: 1.727132
train_loss: 0.141634
valid_loss: 1.042584
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0018688684219905815
Epoch-1 lr: 0.009344342109952906
epoch 1 training time: 17.197
---------------
2023-09-11 09:38:51.129104
current #epochs=2, #steps=40
start validation
acc: 0.796209
AUC: 0.901043
Avg Precision: 0.287283
Avg Recall: 1.000000
d_prime: 1.820825
train_loss: 0.133595
valid_loss: 1.049412
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0018688684219905815
Epoch-2 lr: 0.009344342109952906
epoch 2 training time: 16.991
---------------
2023-09-11 09:39:08.120811
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00558	Train Loss 0.1139	
start validation
acc: 0.796209
AUC: 0.886958
Avg Precision: 0.294277
Avg Recall: 1.000000
d_prime: 1.711915
train_loss: 0.115195
valid_loss: 1.072161
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0018688684219905815
Epoch-3 lr: 0.009344342109952906
epoch 3 training time: 16.108
---------------
2023-09-11 09:39:24.228455
current #epochs=4, #steps=120
start validation
acc: 0.786730
AUC: 0.893217
Avg Precision: 0.290834
Avg Recall: 1.000000
d_prime: 1.759030
train_loss: 0.120976
valid_loss: 1.046560
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0018688684219905815
Epoch-4 lr: 0.009344342109952906
epoch 4 training time: 16.129
---------------
2023-09-11 09:39:40.357398
current #epochs=5, #steps=160
start validation
acc: 0.800948
AUC: 0.898108
Avg Precision: 0.288467
Avg Recall: 1.000000
d_prime: 1.797248
train_loss: 0.152295
valid_loss: 1.034643
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0018688684219905815
Epoch-5 lr: 0.009344342109952906
epoch 5 training time: 16.925
---------------
2023-09-11 09:39:57.282769
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03674	Per Sample Data Time 0.03024	Per Sample DNN Time 0.00650	Train Loss 0.1498	
start validation
acc: 0.805687
AUC: 0.901419
Avg Precision: 0.301259
Avg Recall: 1.000000
d_prime: 1.823882
train_loss: 0.126629
valid_loss: 1.038219
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0018688684219905815
Epoch-6 lr: 0.009344342109952906
epoch 6 training time: 18.033
---------------
2023-09-11 09:40:15.315529
current #epochs=7, #steps=240
start validation
acc: 0.781991
AUC: 0.899695
Avg Precision: 0.293940
Avg Recall: 1.000000
d_prime: 1.809929
train_loss: 0.107522
valid_loss: 1.063844
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0018688684219905815
Epoch-7 lr: 0.009344342109952906
epoch 7 training time: 16.915
---------------
2023-09-11 09:40:32.230247
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00563	Train Loss 0.1147	
start validation
acc: 0.805687
AUC: 0.895695
Avg Precision: 0.289160
Avg Recall: 1.000000
d_prime: 1.778231
train_loss: 0.101625
valid_loss: 1.067569
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001717459899954802
Epoch-8 lr: 0.00858729949977401
epoch 8 training time: 15.044
---------------
2023-09-11 09:40:47.274148
current #epochs=9, #steps=320
start validation
acc: 0.824645
AUC: 0.909599
Avg Precision: 0.331986
Avg Recall: 1.000000
d_prime: 1.892627
train_loss: 0.093583
valid_loss: 1.034062
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001717459899954802
Epoch-9 lr: 0.00858729949977401
epoch 9 training time: 17.217
---------------
2023-09-11 09:41:04.491104
current #epochs=10, #steps=360
start validation
acc: 0.767773
AUC: 0.914594
Avg Precision: 0.363499
Avg Recall: 1.000000
d_prime: 1.936905
train_loss: 0.088855
valid_loss: 1.036042
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001717459899954802
Epoch-10 lr: 0.00858729949977401
epoch 10 training time: 15.921
---------------
2023-09-11 09:41:20.411795
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03717	Per Sample Data Time 0.02983	Per Sample DNN Time 0.00734	Train Loss 0.0108	
start validation
acc: 0.810427
AUC: 0.909333
Avg Precision: 0.309031
Avg Recall: 1.000000
d_prime: 1.890318
train_loss: 0.123368
valid_loss: 1.043299
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001717459899954802
Epoch-11 lr: 0.00858729949977401
epoch 11 training time: 15.036
---------------
2023-09-11 09:41:35.448231
current #epochs=12, #steps=440
start validation
acc: 0.810427
AUC: 0.911775
Avg Precision: 0.301416
Avg Recall: 1.000000
d_prime: 1.911688
train_loss: 0.126364
valid_loss: 1.032672
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001717459899954802
Epoch-12 lr: 0.00858729949977401
epoch 12 training time: 15.075
---------------
2023-09-11 09:41:50.522507
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00704	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00559	Train Loss 0.1167	
start validation
acc: 0.810427
AUC: 0.907745
Avg Precision: 0.296137
Avg Recall: 1.000000
d_prime: 1.876654
train_loss: 0.136700
valid_loss: 1.042392
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.001717459899954802
Epoch-13 lr: 0.00858729949977401
epoch 13 training time: 15.617
---------------
2023-09-11 09:42:06.139353
current #epochs=14, #steps=520
start validation
acc: 0.796209
AUC: 0.902039
Avg Precision: 0.315674
Avg Recall: 1.000000
d_prime: 1.828945
train_loss: 0.090440
valid_loss: 1.050031
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.001717459899954802
Epoch-14 lr: 0.00858729949977401
epoch 14 training time: 15.122
---------------
2023-09-11 09:42:21.261491
current #epochs=15, #steps=560
start validation
acc: 0.800948
AUC: 0.900378
Avg Precision: 0.312743
Avg Recall: 1.000000
d_prime: 1.815435
train_loss: 0.111398
valid_loss: 1.063841
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0015783179132595052
Epoch-15 lr: 0.007891589566297525
epoch 15 training time: 15.054
---------------
2023-09-11 09:42:36.315693
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03576	Per Sample Data Time 0.02849	Per Sample DNN Time 0.00726	Train Loss 0.0999	
start validation
acc: 0.810427
AUC: 0.915904
Avg Precision: 0.340075
Avg Recall: 1.000000
d_prime: 1.948835
train_loss: 0.116895
valid_loss: 1.048543
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0015783179132595052
Epoch-16 lr: 0.007891589566297525
epoch 16 training time: 14.960
---------------
2023-09-11 09:42:51.275444
current #epochs=17, #steps=640
start validation
acc: 0.791469
AUC: 0.919148
Avg Precision: 0.330389
Avg Recall: 1.000000
d_prime: 1.978997
train_loss: 0.131979
valid_loss: 1.033782
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0015783179132595052
Epoch-17 lr: 0.007891589566297525
epoch 17 training time: 15.488
---------------
2023-09-11 09:43:06.763459
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00703	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00556	Train Loss 0.1060	
start validation
acc: 0.800948
AUC: 0.922744
Avg Precision: 0.329631
Avg Recall: 1.000000
d_prime: 2.013518
train_loss: 0.097924
valid_loss: 1.019846
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0015783179132595052
Epoch-18 lr: 0.007891589566297525
epoch 18 training time: 14.997
---------------
2023-09-11 09:43:21.760644
current #epochs=19, #steps=720
start validation
acc: 0.791469
AUC: 0.918462
Avg Precision: 0.297039
Avg Recall: 1.000000
d_prime: 1.972544
train_loss: 0.100563
valid_loss: 1.019652
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0015783179132595052
Epoch-19 lr: 0.007891589566297525
epoch 19 training time: 14.999
---------------
2023-09-11 09:43:36.759392
current #epochs=20, #steps=760
start validation
acc: 0.791469
AUC: 0.887348
Avg Precision: 0.295499
Avg Recall: 1.000000
d_prime: 1.714794
train_loss: 0.112828
valid_loss: 1.046488
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0015783179132595052
Epoch-20 lr: 0.007891589566297525
epoch 20 training time: 14.973
---------------
2023-09-11 09:43:51.732568
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03415	Per Sample Data Time 0.02762	Per Sample DNN Time 0.00653	Train Loss 0.1438	
start validation
acc: 0.815166
AUC: 0.909837
Avg Precision: 0.308272
Avg Recall: 1.000000
d_prime: 1.894699
train_loss: 0.107478
valid_loss: 1.045550
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0015783179132595052
Epoch-21 lr: 0.007891589566297525
epoch 21 training time: 17.813
---------------
2023-09-11 09:44:09.545162
current #epochs=22, #steps=840
start validation
acc: 0.796209
AUC: 0.919300
Avg Precision: 0.332877
Avg Recall: 1.000000
d_prime: 1.980435
train_loss: 0.104162
valid_loss: 1.031726
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0014504486744531247
Epoch-22 lr: 0.007252243372265623
epoch 22 training time: 15.052
---------------
2023-09-11 09:44:24.597717
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00563	Train Loss 0.0897	
start validation
acc: 0.829384
AUC: 0.901879
Avg Precision: 0.309206
Avg Recall: 1.000000
d_prime: 1.827636
train_loss: 0.097301
valid_loss: 1.036740
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0014504486744531247
Epoch-23 lr: 0.007252243372265623
epoch 23 training time: 18.450
---------------
2023-09-11 09:44:43.047526
current #epochs=24, #steps=920
start validation
acc: 0.786730
AUC: 0.909803
Avg Precision: 0.322406
Avg Recall: 1.000000
d_prime: 1.894402
train_loss: 0.095054
valid_loss: 1.032033
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0014504486744531247
Epoch-24 lr: 0.007252243372265623
epoch 24 training time: 15.162
---------------
2023-09-11 09:44:58.209836
current #epochs=25, #steps=960
start validation
[I 2023-09-11 09:45:15,462] Trial 21 finished with value: 0.8293838862559242 and parameters: {'warmup': 'True', 'num_epochs': 25, 'batch_size': 52, 'lr-adaptschedule': 'False', 'lr': 0.0018688684219905815, 'head-lr': 5, 'lr-scheduler-start': 8, 'lr-scheduler-step': 7, 'lr-scheduler-decay': 0.9189838512684001}. Best is trial 13 with value: 0.8341232227488151.
acc: 0.805687
AUC: 0.903419
Avg Precision: 0.301956
Avg Recall: 1.000000
d_prime: 1.840293
train_loss: 0.094190
valid_loss: 1.052634
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0014504486744531247
Epoch-25 lr: 0.007252243372265623
epoch 25 training time: 17.247
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f8667062e20>
The learning rate scheduler starts at 10 epoch with decay rate of 0.927 every 7 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 09:45:15.494318
current #epochs=1, #steps=0
start validation
acc: 0.786730
AUC: 0.890554
Avg Precision: 0.293610
Avg Recall: 1.000000
d_prime: 1.738746
train_loss: 0.112342
valid_loss: 1.036916
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0017095613401550136
Epoch-1 lr: 0.006838245360620054
epoch 1 training time: 18.318
---------------
2023-09-11 09:45:33.812137
current #epochs=2, #steps=40
start validation
acc: 0.819905
AUC: 0.914839
Avg Precision: 0.324043
Avg Recall: 1.000000
d_prime: 1.939123
train_loss: 0.106879
valid_loss: 1.038920
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0017095613401550136
Epoch-2 lr: 0.006838245360620054
epoch 2 training time: 18.372
---------------
2023-09-11 09:45:52.183929
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00157	Per Sample DNN Time 0.00558	Train Loss 0.1148	
start validation
acc: 0.781991
AUC: 0.870577
Avg Precision: 0.282983
Avg Recall: 1.000000
d_prime: 1.596822
train_loss: 0.107934
valid_loss: 1.059862
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0017095613401550136
Epoch-3 lr: 0.006838245360620054
epoch 3 training time: 15.105
---------------
2023-09-11 09:46:07.288453
current #epochs=4, #steps=120
start validation
acc: 0.834123
AUC: 0.891192
Avg Precision: 0.309699
Avg Recall: 1.000000
d_prime: 1.743570
train_loss: 0.132894
valid_loss: 1.050931
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0017095613401550136
Epoch-4 lr: 0.006838245360620054
epoch 4 training time: 16.985
---------------
2023-09-11 09:46:24.273742
current #epochs=5, #steps=160
start validation
acc: 0.815166
AUC: 0.903998
Avg Precision: 0.295427
Avg Recall: 1.000000
d_prime: 1.845087
train_loss: 0.113270
valid_loss: 1.024118
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0017095613401550136
Epoch-5 lr: 0.006838245360620054
epoch 5 training time: 15.160
---------------
2023-09-11 09:46:39.434065
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03473	Per Sample Data Time 0.02754	Per Sample DNN Time 0.00719	Train Loss 0.0409	
start validation
acc: 0.800948
AUC: 0.902955
Avg Precision: 0.328553
Avg Recall: 1.000000
d_prime: 1.836458
train_loss: 0.098672
valid_loss: 1.039598
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0017095613401550136
Epoch-6 lr: 0.006838245360620054
epoch 6 training time: 14.945
---------------
2023-09-11 09:46:54.378977
current #epochs=7, #steps=240
start validation
acc: 0.800948
AUC: 0.917823
Avg Precision: 0.351953
Avg Recall: 1.000000
d_prime: 1.966573
train_loss: 0.117706
valid_loss: 1.040259
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0017095613401550136
Epoch-7 lr: 0.006838245360620054
epoch 7 training time: 15.813
---------------
2023-09-11 09:47:10.191874
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00566	Train Loss 0.1061	
start validation
acc: 0.781991
AUC: 0.905152
Avg Precision: 0.341797
Avg Recall: 1.000000
d_prime: 1.854711
train_loss: 0.099995
valid_loss: 1.069633
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0017095613401550136
Epoch-8 lr: 0.006838245360620054
epoch 8 training time: 14.986
---------------
2023-09-11 09:47:25.178255
current #epochs=9, #steps=320
start validation
acc: 0.796209
AUC: 0.903038
Avg Precision: 0.337302
Avg Recall: 1.000000
d_prime: 1.837142
train_loss: 0.109458
valid_loss: 1.043896
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0017095613401550136
Epoch-9 lr: 0.006838245360620054
epoch 9 training time: 15.211
---------------
2023-09-11 09:47:40.389728
current #epochs=10, #steps=360
start validation
acc: 0.834123
AUC: 0.893431
Avg Precision: 0.304381
Avg Recall: 1.000000
d_prime: 1.760673
train_loss: 0.114351
valid_loss: 1.071457
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001584186394552021
Epoch-10 lr: 0.006336745578208084
epoch 10 training time: 15.145
---------------
2023-09-11 09:47:55.535063
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03997	Per Sample Data Time 0.02940	Per Sample DNN Time 0.01057	Train Loss 0.1117	
start validation
acc: 0.796209
AUC: 0.901764
Avg Precision: 0.327932
Avg Recall: 1.000000
d_prime: 1.826697
train_loss: 0.121483
valid_loss: 1.058425
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001584186394552021
Epoch-11 lr: 0.006336745578208084
epoch 11 training time: 16.633
---------------
2023-09-11 09:48:12.167761
current #epochs=12, #steps=440
start validation
acc: 0.786730
AUC: 0.896824
Avg Precision: 0.296442
Avg Recall: 1.000000
d_prime: 1.787085
train_loss: 0.121580
valid_loss: 1.043851
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001584186394552021
Epoch-12 lr: 0.006336745578208084
epoch 12 training time: 14.884
---------------
2023-09-11 09:48:27.051618
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00562	Train Loss 0.0621	
start validation
acc: 0.819905
AUC: 0.920324
Avg Precision: 0.337978
Avg Recall: 1.000000
d_prime: 1.990156
train_loss: 0.086316
valid_loss: 1.039755
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.001584186394552021
Epoch-13 lr: 0.006336745578208084
epoch 13 training time: 14.926
---------------
2023-09-11 09:48:41.977724
current #epochs=14, #steps=520
start validation
acc: 0.786730
AUC: 0.907301
Avg Precision: 0.320768
Avg Recall: 1.000000
d_prime: 1.872869
train_loss: 0.106933
valid_loss: 1.053208
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.001584186394552021
Epoch-14 lr: 0.006336745578208084
epoch 14 training time: 15.005
---------------
2023-09-11 09:48:56.983136
current #epochs=15, #steps=560
start validation
acc: 0.786730
AUC: 0.909429
Avg Precision: 0.341973
Avg Recall: 1.000000
d_prime: 1.891155
train_loss: 0.104594
valid_loss: 1.040110
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.001584186394552021
Epoch-15 lr: 0.006336745578208084
epoch 15 training time: 15.071
---------------
2023-09-11 09:49:12.054136
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03548	Per Sample Data Time 0.02788	Per Sample DNN Time 0.00760	Train Loss 0.0412	
start validation
acc: 0.786730
AUC: 0.906983
Avg Precision: 0.350069
Avg Recall: 1.000000
d_prime: 1.870162
train_loss: 0.093618
valid_loss: 1.052248
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.001584186394552021
Epoch-16 lr: 0.006336745578208084
epoch 16 training time: 16.002
---------------
2023-09-11 09:49:28.056660
current #epochs=17, #steps=640
start validation
acc: 0.819905
AUC: 0.884264
Avg Precision: 0.295661
Avg Recall: 1.000000
d_prime: 1.692213
train_loss: 0.091815
valid_loss: 1.066875
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.001468006133348904
Epoch-17 lr: 0.005872024533395616
epoch 17 training time: 15.108
---------------
2023-09-11 09:49:43.164514
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00702	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00557	Train Loss 0.1276	
start validation
acc: 0.800948
AUC: 0.921849
Avg Precision: 0.382756
Avg Recall: 1.000000
d_prime: 2.004818
train_loss: 0.115513
valid_loss: 1.041882
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001468006133348904
Epoch-18 lr: 0.005872024533395616
epoch 18 training time: 15.892
---------------
2023-09-11 09:49:59.056785
current #epochs=19, #steps=720
start validation
acc: 0.824645
AUC: 0.904447
Avg Precision: 0.335029
Avg Recall: 1.000000
d_prime: 1.848821
train_loss: 0.101185
valid_loss: 1.043459
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.001468006133348904
Epoch-19 lr: 0.005872024533395616
epoch 19 training time: 15.766
---------------
2023-09-11 09:50:14.822487
current #epochs=20, #steps=760
start validation
acc: 0.829384
AUC: 0.912844
Avg Precision: 0.337475
Avg Recall: 1.000000
d_prime: 1.921182
train_loss: 0.104690
valid_loss: 1.045650
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.001468006133348904
Epoch-20 lr: 0.005872024533395616
epoch 20 training time: 16.652
---------------
2023-09-11 09:50:31.474721
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03620	Per Sample Data Time 0.02907	Per Sample DNN Time 0.00714	Train Loss 0.0347	
start validation
acc: 0.805687
AUC: 0.918021
Avg Precision: 0.355040
Avg Recall: 1.000000
d_prime: 1.968419
train_loss: 0.083061
valid_loss: 1.043274
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.001468006133348904
Epoch-21 lr: 0.005872024533395616
epoch 21 training time: 15.125
---------------
2023-09-11 09:50:46.599562
current #epochs=22, #steps=840
start validation
acc: 0.810427
AUC: 0.905556
Avg Precision: 0.314588
Avg Recall: 1.000000
d_prime: 1.858097
train_loss: 0.082691
valid_loss: 1.031000
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.001468006133348904
Epoch-22 lr: 0.005872024533395616
epoch 22 training time: 17.095
---------------
2023-09-11 09:51:03.695091
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00565	Train Loss 0.0852	
start validation
acc: 0.824645
AUC: 0.911278
Avg Precision: 0.321657
Avg Recall: 1.000000
d_prime: 1.907300
train_loss: 0.094506
valid_loss: 1.034188
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.001468006133348904
Epoch-23 lr: 0.005872024533395616
epoch 23 training time: 15.081
---------------
2023-09-11 09:51:18.776093
current #epochs=24, #steps=920
start validation
acc: 0.815166
AUC: 0.894821
Avg Precision: 0.300328
Avg Recall: 1.000000
d_prime: 1.771419
train_loss: 0.093632
valid_loss: 1.044312
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0013603462414278633
Epoch-24 lr: 0.005441384965711453
epoch 24 training time: 15.253
---------------
2023-09-11 09:51:34.029127
current #epochs=25, #steps=960
start validation
acc: 0.791469
AUC: 0.903709
Avg Precision: 0.309848
Avg Recall: 1.000000
d_prime: 1.842688
train_loss: 0.106983
valid_loss: 1.045844
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0013603462414278633
Epoch-25 lr: 0.005441384965711453
epoch 25 training time: 15.402
---------------
2023-09-11 09:51:49.430931
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03799	Per Sample Data Time 0.02749	Per Sample DNN Time 0.01050	Train Loss 0.3184	
start validation
acc: 0.805687
AUC: 0.907620
Avg Precision: 0.316961
Avg Recall: 1.000000
d_prime: 1.875585
train_loss: 0.122032
valid_loss: 1.064199
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0013603462414278633
Epoch-26 lr: 0.005441384965711453
epoch 26 training time: 15.051
---------------
2023-09-11 09:52:04.481997
current #epochs=27, #steps=1040
start validation
acc: 0.819905
AUC: 0.907375
Avg Precision: 0.321748
Avg Recall: 1.000000
d_prime: 1.873500
train_loss: 0.093887
valid_loss: 1.056078
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0013603462414278633
Epoch-27 lr: 0.005441384965711453
epoch 27 training time: 15.022
---------------
2023-09-11 09:52:19.503616
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00556	Train Loss 0.1319	
start validation
acc: 0.781991
AUC: 0.893317
Avg Precision: 0.317173
Avg Recall: 1.000000
d_prime: 1.759792
train_loss: 0.115971
valid_loss: 1.052683
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0013603462414278633
Epoch-28 lr: 0.005441384965711453
epoch 28 training time: 14.956
---------------
2023-09-11 09:52:34.460185
current #epochs=29, #steps=1120
start validation
acc: 0.796209
AUC: 0.908146
Avg Precision: 0.316191
Avg Recall: 1.000000
d_prime: 1.880088
train_loss: 0.104775
valid_loss: 1.058581
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0013603462414278633
Epoch-29 lr: 0.005441384965711453
epoch 29 training time: 14.995
---------------
2023-09-11 09:52:49.454609
current #epochs=30, #steps=1160
start validation
[I 2023-09-11 09:53:05,181] Trial 22 finished with value: 0.8341232227488151 and parameters: {'warmup': 'True', 'num_epochs': 30, 'batch_size': 51, 'lr-adaptschedule': 'False', 'lr': 0.0017095613401550136, 'head-lr': 4, 'lr-scheduler-start': 10, 'lr-scheduler-step': 7, 'lr-scheduler-decay': 0.9266625053701646}. Best is trial 13 with value: 0.8341232227488151.
acc: 0.800948
AUC: 0.904591
Avg Precision: 0.345172
Avg Recall: 1.000000
d_prime: 1.850023
train_loss: 0.128434
valid_loss: 1.045860
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0013603462414278633
Epoch-30 lr: 0.005441384965711453
epoch 30 training time: 15.721
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863d9a0160>
The learning rate scheduler starts at 10 epoch with decay rate of 0.919 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 09:53:05.213637
current #epochs=1, #steps=0
start validation
acc: 0.800948
AUC: 0.903958
Avg Precision: 0.308548
Avg Recall: 1.000000
d_prime: 1.844754
train_loss: 0.099781
valid_loss: 1.039420
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.001295284284977028
Epoch-1 lr: 0.005181137139908112
epoch 1 training time: 17.532
---------------
2023-09-11 09:53:22.745515
current #epochs=2, #steps=40
start validation
acc: 0.786730
AUC: 0.898082
Avg Precision: 0.324289
Avg Recall: 1.000000
d_prime: 1.797040
train_loss: 0.142445
valid_loss: 1.058561
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.001295284284977028
Epoch-2 lr: 0.005181137139908112
epoch 2 training time: 16.877
---------------
2023-09-11 09:53:39.622537
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00698	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00550	Train Loss 0.1216	
start validation
acc: 0.772512
AUC: 0.916479
Avg Precision: 0.331031
Avg Recall: 1.000000
d_prime: 1.954121
train_loss: 0.122553
valid_loss: 1.034409
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.001295284284977028
Epoch-3 lr: 0.005181137139908112
epoch 3 training time: 14.926
---------------
2023-09-11 09:53:54.548848
current #epochs=4, #steps=120
start validation
acc: 0.796209
AUC: 0.909358
Avg Precision: 0.319952
Avg Recall: 1.000000
d_prime: 1.890540
train_loss: 0.114353
valid_loss: 1.038487
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.001295284284977028
Epoch-4 lr: 0.005181137139908112
epoch 4 training time: 16.110
---------------
2023-09-11 09:54:10.658935
current #epochs=5, #steps=160
start validation
acc: 0.777251
AUC: 0.906801
Avg Precision: 0.326312
Avg Recall: 1.000000
d_prime: 1.868617
train_loss: 0.096357
valid_loss: 1.039312
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.001295284284977028
Epoch-5 lr: 0.005181137139908112
epoch 5 training time: 14.987
---------------
2023-09-11 09:54:25.646445
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03632	Per Sample Data Time 0.02972	Per Sample DNN Time 0.00660	Train Loss 0.0740	
start validation
acc: 0.777251
AUC: 0.899704
Avg Precision: 0.311688
Avg Recall: 1.000000
d_prime: 1.810008
train_loss: 0.103947
valid_loss: 1.051511
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.001295284284977028
Epoch-6 lr: 0.005181137139908112
epoch 6 training time: 17.522
---------------
2023-09-11 09:54:43.168603
current #epochs=7, #steps=240
start validation
acc: 0.772512
AUC: 0.898340
Avg Precision: 0.313136
Avg Recall: 1.000000
d_prime: 1.799090
train_loss: 0.085208
valid_loss: 1.060209
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.001295284284977028
Epoch-7 lr: 0.005181137139908112
epoch 7 training time: 15.558
---------------
2023-09-11 09:54:58.726338
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00566	Train Loss 0.1102	
start validation
acc: 0.800948
AUC: 0.901532
Avg Precision: 0.328468
Avg Recall: 1.000000
d_prime: 1.824803
train_loss: 0.100336
valid_loss: 1.049132
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001295284284977028
Epoch-8 lr: 0.005181137139908112
epoch 8 training time: 15.158
---------------
2023-09-11 09:55:13.884142
current #epochs=9, #steps=320
start validation
acc: 0.791469
AUC: 0.913252
Avg Precision: 0.317011
Avg Recall: 1.000000
d_prime: 1.924825
train_loss: 0.084562
valid_loss: 1.041996
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001295284284977028
Epoch-9 lr: 0.005181137139908112
epoch 9 training time: 17.189
---------------
2023-09-11 09:55:31.073577
current #epochs=10, #steps=360
start validation
acc: 0.810427
AUC: 0.913861
Avg Precision: 0.345487
Avg Recall: 1.000000
d_prime: 1.930288
train_loss: 0.127474
valid_loss: 1.029526
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0011897643437017904
Epoch-10 lr: 0.004759057374807162
epoch 10 training time: 19.947
---------------
2023-09-11 09:55:51.020394
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03776	Per Sample Data Time 0.02826	Per Sample DNN Time 0.00951	Train Loss 0.1190	
start validation
acc: 0.796209
AUC: 0.900095
Avg Precision: 0.291229
Avg Recall: 1.000000
d_prime: 1.813153
train_loss: 0.127525
valid_loss: 1.048614
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0011897643437017904
Epoch-11 lr: 0.004759057374807162
epoch 11 training time: 16.138
---------------
2023-09-11 09:56:07.158480
current #epochs=12, #steps=440
start validation
acc: 0.800948
AUC: 0.896636
Avg Precision: 0.291330
Avg Recall: 1.000000
d_prime: 1.785608
train_loss: 0.100151
valid_loss: 1.052284
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0011897643437017904
Epoch-12 lr: 0.004759057374807162
epoch 12 training time: 15.320
---------------
2023-09-11 09:56:22.478526
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00569	Train Loss 0.0782	
start validation
acc: 0.819905
AUC: 0.899271
Avg Precision: 0.294305
Avg Recall: 1.000000
d_prime: 1.806531
train_loss: 0.099013
valid_loss: 1.041746
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0011897643437017904
Epoch-13 lr: 0.004759057374807162
epoch 13 training time: 18.189
---------------
2023-09-11 09:56:40.667871
current #epochs=14, #steps=520
start validation
acc: 0.815166
AUC: 0.904394
Avg Precision: 0.302869
Avg Recall: 1.000000
d_prime: 1.848384
train_loss: 0.107009
valid_loss: 1.055270
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0011897643437017904
Epoch-14 lr: 0.004759057374807162
epoch 14 training time: 15.712
---------------
2023-09-11 09:56:56.379832
current #epochs=15, #steps=560
start validation
acc: 0.786730
AUC: 0.900675
Avg Precision: 0.320070
Avg Recall: 1.000000
d_prime: 1.817842
train_loss: 0.105780
valid_loss: 1.042501
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0011897643437017904
Epoch-15 lr: 0.004759057374807162
epoch 15 training time: 15.672
---------------
2023-09-11 09:57:12.051967
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03888	Per Sample Data Time 0.03009	Per Sample DNN Time 0.00879	Train Loss 0.0819	
start validation
[I 2023-09-11 09:57:27,134] Trial 23 finished with value: 0.8199052132701422 and parameters: {'warmup': 'True', 'num_epochs': 16, 'batch_size': 38, 'lr-adaptschedule': 'False', 'lr': 0.001295284284977028, 'head-lr': 4, 'lr-scheduler-start': 10, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.918535303408619}. Best is trial 13 with value: 0.8341232227488151.
acc: 0.805687
AUC: 0.902322
Avg Precision: 0.308293
Avg Recall: 1.000000
d_prime: 1.831262
train_loss: 0.089615
valid_loss: 1.041066
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0011897643437017904
Epoch-16 lr: 0.004759057374807162
epoch 16 training time: 15.076
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f86670be580>
The learning rate scheduler starts at 10 epoch with decay rate of 0.949 every 6 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 09:57:27.167402
current #epochs=1, #steps=0
start validation
acc: 0.796209
AUC: 0.902820
Avg Precision: 0.310522
Avg Recall: 1.000000
d_prime: 1.835351
train_loss: 0.111618
valid_loss: 1.041620
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0012101674132746023
Epoch-1 lr: 0.003630502239823807
epoch 1 training time: 18.415
---------------
2023-09-11 09:57:45.583295
current #epochs=2, #steps=40
start validation
acc: 0.791469
AUC: 0.897822
Avg Precision: 0.329809
Avg Recall: 1.000000
d_prime: 1.794978
train_loss: 0.101535
valid_loss: 1.057732
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0012101674132746023
Epoch-2 lr: 0.003630502239823807
epoch 2 training time: 15.585
---------------
2023-09-11 09:58:01.167752
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00551	Train Loss 0.1005	
start validation
acc: 0.786730
AUC: 0.896608
Avg Precision: 0.300984
Avg Recall: 1.000000
d_prime: 1.785389
train_loss: 0.106973
valid_loss: 1.060701
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0012101674132746023
Epoch-3 lr: 0.003630502239823807
epoch 3 training time: 15.082
---------------
2023-09-11 09:58:16.250252
current #epochs=4, #steps=120
start validation
acc: 0.805687
AUC: 0.882574
Avg Precision: 0.281223
Avg Recall: 1.000000
d_prime: 1.680021
train_loss: 0.097294
valid_loss: 1.051280
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0012101674132746023
Epoch-4 lr: 0.003630502239823807
epoch 4 training time: 17.604
---------------
2023-09-11 09:58:33.854363
current #epochs=5, #steps=160
start validation
acc: 0.800948
AUC: 0.902789
Avg Precision: 0.302871
Avg Recall: 1.000000
d_prime: 1.835098
train_loss: 0.091931
valid_loss: 1.045402
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0012101674132746023
Epoch-5 lr: 0.003630502239823807
epoch 5 training time: 16.792
---------------
2023-09-11 09:58:50.646790
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03632	Per Sample Data Time 0.02931	Per Sample DNN Time 0.00701	Train Loss 0.1202	
start validation
acc: 0.796209
AUC: 0.898329
Avg Precision: 0.320842
Avg Recall: 1.000000
d_prime: 1.799005
train_loss: 0.079258
valid_loss: 1.056997
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0012101674132746023
Epoch-6 lr: 0.003630502239823807
epoch 6 training time: 15.020
---------------
2023-09-11 09:59:05.666902
current #epochs=7, #steps=240
start validation
acc: 0.767773
AUC: 0.896989
Avg Precision: 0.319725
Avg Recall: 1.000000
d_prime: 1.788385
train_loss: 0.086599
valid_loss: 1.049508
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0012101674132746023
Epoch-7 lr: 0.003630502239823807
epoch 7 training time: 15.673
---------------
2023-09-11 09:59:21.340003
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00699	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00555	Train Loss 0.1058	
start validation
acc: 0.796209
AUC: 0.898754
Avg Precision: 0.335861
Avg Recall: 1.000000
d_prime: 1.802395
train_loss: 0.108525
valid_loss: 1.068056
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0012101674132746023
Epoch-8 lr: 0.003630502239823807
epoch 8 training time: 14.906
---------------
2023-09-11 09:59:36.246349
current #epochs=9, #steps=320
start validation
acc: 0.815166
AUC: 0.910607
Avg Precision: 0.303547
Avg Recall: 1.000000
d_prime: 1.901416
train_loss: 0.109592
valid_loss: 1.027635
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0012101674132746023
Epoch-9 lr: 0.003630502239823807
epoch 9 training time: 17.930
---------------
2023-09-11 09:59:54.176194
current #epochs=10, #steps=360
start validation
acc: 0.753555
AUC: 0.894319
Avg Precision: 0.298573
Avg Recall: 1.000000
d_prime: 1.767528
train_loss: 0.095558
valid_loss: 1.063585
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0011486478365579265
Epoch-10 lr: 0.0034459435096737792
epoch 10 training time: 15.126
---------------
2023-09-11 10:00:09.302005
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03514	Per Sample Data Time 0.02747	Per Sample DNN Time 0.00766	Train Loss 0.0575	
start validation
acc: 0.815166
AUC: 0.914164
Avg Precision: 0.339905
Avg Recall: 1.000000
d_prime: 1.933020
train_loss: 0.105039
valid_loss: 1.048409
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0011486478365579265
Epoch-11 lr: 0.0034459435096737792
epoch 11 training time: 15.943
---------------
2023-09-11 10:00:25.244748
current #epochs=12, #steps=440
start validation
acc: 0.786730
AUC: 0.888136
Avg Precision: 0.296751
Avg Recall: 1.000000
d_prime: 1.720641
train_loss: 0.097703
valid_loss: 1.059275
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0011486478365579265
Epoch-12 lr: 0.0034459435096737792
epoch 12 training time: 16.661
---------------
2023-09-11 10:00:41.905526
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00164	Per Sample DNN Time 0.00556	Train Loss 0.1058	
start validation
acc: 0.805687
AUC: 0.907373
Avg Precision: 0.334306
Avg Recall: 1.000000
d_prime: 1.873479
train_loss: 0.108858
valid_loss: 1.061689
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0011486478365579265
Epoch-13 lr: 0.0034459435096737792
epoch 13 training time: 15.934
---------------
2023-09-11 10:00:57.839472
current #epochs=14, #steps=520
start validation
acc: 0.800948
AUC: 0.904619
Avg Precision: 0.317669
Avg Recall: 1.000000
d_prime: 1.850254
train_loss: 0.098098
valid_loss: 1.056010
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0011486478365579265
Epoch-14 lr: 0.0034459435096737792
epoch 14 training time: 14.873
---------------
2023-09-11 10:01:12.712658
current #epochs=15, #steps=560
start validation
acc: 0.772512
AUC: 0.902686
Avg Precision: 0.298014
Avg Recall: 1.000000
d_prime: 1.834244
train_loss: 0.096147
valid_loss: 1.055861
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0011486478365579265
Epoch-15 lr: 0.0034459435096737792
epoch 15 training time: 16.539
---------------
2023-09-11 10:01:29.251671
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03740	Per Sample Data Time 0.02763	Per Sample DNN Time 0.00977	Train Loss 0.0683	
start validation
acc: 0.800948
AUC: 0.892688
Avg Precision: 0.305059
Avg Recall: 1.000000
d_prime: 1.754969
train_loss: 0.082136
valid_loss: 1.058726
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0010902556439352892
Epoch-16 lr: 0.0032707669318058677
epoch 16 training time: 15.057
---------------
2023-09-11 10:01:44.308698
current #epochs=17, #steps=640
start validation
acc: 0.800948
AUC: 0.896871
Avg Precision: 0.285604
Avg Recall: 1.000000
d_prime: 1.787453
train_loss: 0.092704
valid_loss: 1.058730
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0010902556439352892
Epoch-17 lr: 0.0032707669318058677
epoch 17 training time: 15.804
---------------
2023-09-11 10:02:00.112976
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00559	Train Loss 0.0984	
start validation
acc: 0.791469
AUC: 0.887407
Avg Precision: 0.304591
Avg Recall: 1.000000
d_prime: 1.715232
train_loss: 0.115871
valid_loss: 1.060629
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0010902556439352892
Epoch-18 lr: 0.0032707669318058677
epoch 18 training time: 14.924
---------------
2023-09-11 10:02:15.036982
current #epochs=19, #steps=720
start validation
acc: 0.786730
AUC: 0.885967
Avg Precision: 0.292906
Avg Recall: 1.000000
d_prime: 1.704633
train_loss: 0.092500
valid_loss: 1.056086
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0010902556439352892
Epoch-19 lr: 0.0032707669318058677
epoch 19 training time: 16.600
---------------
2023-09-11 10:02:31.637307
current #epochs=20, #steps=760
start validation
acc: 0.810427
AUC: 0.887337
Avg Precision: 0.291713
Avg Recall: 1.000000
d_prime: 1.714715
train_loss: 0.107926
valid_loss: 1.058730
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0010902556439352892
Epoch-20 lr: 0.0032707669318058677
epoch 20 training time: 15.052
---------------
2023-09-11 10:02:46.689441
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03659	Per Sample Data Time 0.02953	Per Sample DNN Time 0.00706	Train Loss 0.0304	
start validation
acc: 0.786730
AUC: 0.898793
Avg Precision: 0.288189
Avg Recall: 1.000000
d_prime: 1.802700
train_loss: 0.091024
valid_loss: 1.063936
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0010902556439352892
Epoch-21 lr: 0.0032707669318058677
epoch 21 training time: 14.990
---------------
2023-09-11 10:03:01.679130
current #epochs=22, #steps=840
start validation
acc: 0.767773
AUC: 0.902858
Avg Precision: 0.317259
Avg Recall: 1.000000
d_prime: 1.835666
train_loss: 0.113272
valid_loss: 1.061532
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0010348318529852629
Epoch-22 lr: 0.0031044955589557884
epoch 22 training time: 16.358
---------------
2023-09-11 10:03:18.036869
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00563	Train Loss 0.1024	
start validation
acc: 0.781991
AUC: 0.901980
Avg Precision: 0.328214
Avg Recall: 1.000000
d_prime: 1.828459
train_loss: 0.103714
valid_loss: 1.056320
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0010348318529852629
Epoch-23 lr: 0.0031044955589557884
epoch 23 training time: 15.048
---------------
2023-09-11 10:03:33.085531
current #epochs=24, #steps=920
start validation
acc: 0.810427
AUC: 0.885231
Avg Precision: 0.287388
Avg Recall: 1.000000
d_prime: 1.699247
train_loss: 0.085182
valid_loss: 1.059312
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0010348318529852629
Epoch-24 lr: 0.0031044955589557884
epoch 24 training time: 15.051
---------------
2023-09-11 10:03:48.136617
current #epochs=25, #steps=960
start validation
acc: 0.796209
AUC: 0.908313
Avg Precision: 0.317940
Avg Recall: 1.000000
d_prime: 1.881521
train_loss: 0.080999
valid_loss: 1.047984
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0010348318529852629
Epoch-25 lr: 0.0031044955589557884
epoch 25 training time: 16.271
---------------
2023-09-11 10:04:04.407182
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03580	Per Sample Data Time 0.02855	Per Sample DNN Time 0.00725	Train Loss 0.1618	
start validation
acc: 0.763033
AUC: 0.895587
Avg Precision: 0.312322
Avg Recall: 1.000000
d_prime: 1.777383
train_loss: 0.104943
valid_loss: 1.055132
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0010348318529852629
Epoch-26 lr: 0.0031044955589557884
epoch 26 training time: 15.010
---------------
2023-09-11 10:04:19.417633
current #epochs=27, #steps=1040
start validation
acc: 0.781991
AUC: 0.899612
Avg Precision: 0.300799
Avg Recall: 1.000000
d_prime: 1.809269
train_loss: 0.086668
valid_loss: 1.078066
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0010348318529852629
Epoch-27 lr: 0.0031044955589557884
epoch 27 training time: 14.915
---------------
2023-09-11 10:04:34.332586
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00141	Per Sample DNN Time 0.00564	Train Loss 0.0736	
start validation
acc: 0.786730
AUC: 0.905434
Avg Precision: 0.314034
Avg Recall: 1.000000
d_prime: 1.857079
train_loss: 0.077992
valid_loss: 1.054095
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0009822255632519093
Epoch-28 lr: 0.002946676689755728
epoch 28 training time: 14.950
---------------
2023-09-11 10:04:49.282624
current #epochs=29, #steps=1120
start validation
acc: 0.824645
AUC: 0.911970
Avg Precision: 0.326154
Avg Recall: 1.000000
d_prime: 1.913416
train_loss: 0.097456
valid_loss: 1.041025
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0009822255632519093
Epoch-29 lr: 0.002946676689755728
epoch 29 training time: 17.139
---------------
2023-09-11 10:05:06.421655
current #epochs=30, #steps=1160
start validation
[I 2023-09-11 10:05:21,518] Trial 24 finished with value: 0.8246445497630331 and parameters: {'warmup': 'True', 'num_epochs': 30, 'batch_size': 42, 'lr-adaptschedule': 'False', 'lr': 0.0012101674132746023, 'head-lr': 3, 'lr-scheduler-start': 10, 'lr-scheduler-step': 6, 'lr-scheduler-decay': 0.9491644081291121}. Best is trial 13 with value: 0.8341232227488151.
acc: 0.800948
AUC: 0.904959
Avg Precision: 0.305691
Avg Recall: 1.000000
d_prime: 1.853095
train_loss: 0.076777
valid_loss: 1.051676
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0009822255632519093
Epoch-30 lr: 0.002946676689755728
epoch 30 training time: 15.091
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f86448c0ee0>
The learning rate scheduler starts at 9 epoch with decay rate of 0.909 every 7 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 10:05:21.555395
current #epochs=1, #steps=0
start validation
acc: 0.834123
AUC: 0.908165
Avg Precision: 0.299619
Avg Recall: 1.000000
d_prime: 1.880249
train_loss: 0.145808
valid_loss: 1.050788
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002158955242185134
Epoch-1 lr: 0.008635820968740536
epoch 1 training time: 18.400
---------------
2023-09-11 10:05:39.955953
current #epochs=2, #steps=40
start validation
acc: 0.791469
AUC: 0.908041
Avg Precision: 0.340002
Avg Recall: 1.000000
d_prime: 1.879187
train_loss: 0.122013
valid_loss: 1.055618
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002158955242185134
Epoch-2 lr: 0.008635820968740536
epoch 2 training time: 15.030
---------------
2023-09-11 10:05:54.985640
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00723	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00569	Train Loss 0.1056	
start validation
acc: 0.767773
AUC: 0.909590
Avg Precision: 0.302470
Avg Recall: 1.000000
d_prime: 1.892546
train_loss: 0.096355
valid_loss: 1.046862
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002158955242185134
Epoch-3 lr: 0.008635820968740536
epoch 3 training time: 15.573
---------------
2023-09-11 10:06:10.558326
current #epochs=4, #steps=120
start validation
acc: 0.777251
AUC: 0.884927
Avg Precision: 0.278047
Avg Recall: 1.000000
d_prime: 1.697031
train_loss: 0.121252
valid_loss: 1.055049
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002158955242185134
Epoch-4 lr: 0.008635820968740536
epoch 4 training time: 15.239
---------------
2023-09-11 10:06:25.796952
current #epochs=5, #steps=160
start validation
acc: 0.815166
AUC: 0.908268
Avg Precision: 0.313690
Avg Recall: 1.000000
d_prime: 1.881133
train_loss: 0.131857
valid_loss: 1.025027
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002158955242185134
Epoch-5 lr: 0.008635820968740536
epoch 5 training time: 16.987
---------------
2023-09-11 10:06:42.784006
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03444	Per Sample Data Time 0.02781	Per Sample DNN Time 0.00663	Train Loss 0.0935	
start validation
acc: 0.791469
AUC: 0.919995
Avg Precision: 0.324730
Avg Recall: 1.000000
d_prime: 1.987024
train_loss: 0.128020
valid_loss: 1.028368
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002158955242185134
Epoch-6 lr: 0.008635820968740536
epoch 6 training time: 15.010
---------------
2023-09-11 10:06:57.793901
current #epochs=7, #steps=240
start validation
acc: 0.800948
AUC: 0.909402
Avg Precision: 0.356787
Avg Recall: 1.000000
d_prime: 1.890918
train_loss: 0.110934
valid_loss: 1.041272
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002158955242185134
Epoch-7 lr: 0.008635820968740536
epoch 7 training time: 15.628
---------------
2023-09-11 10:07:13.422034
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00157	Per Sample DNN Time 0.00559	Train Loss 0.0979	
start validation
acc: 0.800948
AUC: 0.910666
Avg Precision: 0.323882
Avg Recall: 1.000000
d_prime: 1.901927
train_loss: 0.103939
valid_loss: 1.045107
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.002158955242185134
Epoch-8 lr: 0.008635820968740536
epoch 8 training time: 15.268
---------------
2023-09-11 10:07:28.690316
current #epochs=9, #steps=320
start validation
acc: 0.800948
AUC: 0.907342
Avg Precision: 0.324526
Avg Recall: 1.000000
d_prime: 1.873217
train_loss: 0.091674
valid_loss: 1.039829
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001962531859847036
Epoch-9 lr: 0.007850127439388144
epoch 9 training time: 15.026
---------------
2023-09-11 10:07:43.715874
current #epochs=10, #steps=360
start validation
acc: 0.777251
AUC: 0.912568
Avg Precision: 0.320662
Avg Recall: 1.000000
d_prime: 1.918718
train_loss: 0.121536
valid_loss: 1.037500
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001962531859847036
Epoch-10 lr: 0.007850127439388144
epoch 10 training time: 14.938
---------------
2023-09-11 10:07:58.653514
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03910	Per Sample Data Time 0.02847	Per Sample DNN Time 0.01062	Train Loss 0.0324	
start validation
acc: 0.829384
AUC: 0.914362
Avg Precision: 0.305325
Avg Recall: 1.000000
d_prime: 1.934807
train_loss: 0.081012
valid_loss: 1.032311
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001962531859847036
Epoch-11 lr: 0.007850127439388144
epoch 11 training time: 15.214
---------------
2023-09-11 10:08:13.867805
current #epochs=12, #steps=440
start validation
acc: 0.815166
AUC: 0.911548
Avg Precision: 0.314197
Avg Recall: 1.000000
d_prime: 1.909686
train_loss: 0.104329
valid_loss: 1.039426
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001962531859847036
Epoch-12 lr: 0.007850127439388144
epoch 12 training time: 16.449
---------------
2023-09-11 10:08:30.316538
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00559	Train Loss 0.0995	
start validation
acc: 0.815166
AUC: 0.919162
Avg Precision: 0.345053
Avg Recall: 1.000000
d_prime: 1.979127
train_loss: 0.111177
valid_loss: 1.040271
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.001962531859847036
Epoch-13 lr: 0.007850127439388144
epoch 13 training time: 14.997
---------------
2023-09-11 10:08:45.313716
current #epochs=14, #steps=520
start validation
acc: 0.800948
AUC: 0.912066
Avg Precision: 0.325373
Avg Recall: 1.000000
d_prime: 1.914266
train_loss: 0.109117
valid_loss: 1.046509
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.001962531859847036
Epoch-14 lr: 0.007850127439388144
epoch 14 training time: 15.326
---------------
2023-09-11 10:09:00.639681
current #epochs=15, #steps=560
start validation
acc: 0.767773
AUC: 0.903103
Avg Precision: 0.346093
Avg Recall: 1.000000
d_prime: 1.837683
train_loss: 0.113857
valid_loss: 1.050491
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.001962531859847036
Epoch-15 lr: 0.007850127439388144
epoch 15 training time: 14.942
---------------
2023-09-11 10:09:15.581935
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03580	Per Sample Data Time 0.02832	Per Sample DNN Time 0.00749	Train Loss 0.2366	
start validation
acc: 0.791469
AUC: 0.883352
Avg Precision: 0.294051
Avg Recall: 1.000000
d_prime: 1.685617
train_loss: 0.139756
valid_loss: 1.056805
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0017839792255333797
Epoch-16 lr: 0.007135916902133519
epoch 16 training time: 16.221
---------------
2023-09-11 10:09:31.802869
current #epochs=17, #steps=640
start validation
acc: 0.810427
AUC: 0.909552
Avg Precision: 0.302010
Avg Recall: 1.000000
d_prime: 1.892223
train_loss: 0.103334
valid_loss: 1.032680
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0017839792255333797
Epoch-17 lr: 0.007135916902133519
epoch 17 training time: 15.108
---------------
2023-09-11 10:09:46.910872
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00700	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00555	Train Loss 0.0992	
start validation
acc: 0.796209
AUC: 0.904952
Avg Precision: 0.325881
Avg Recall: 1.000000
d_prime: 1.853033
train_loss: 0.109583
valid_loss: 1.050024
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0017839792255333797
Epoch-18 lr: 0.007135916902133519
epoch 18 training time: 15.628
---------------
2023-09-11 10:10:02.538577
current #epochs=19, #steps=720
start validation
acc: 0.781991
AUC: 0.904876
Avg Precision: 0.313944
Avg Recall: 1.000000
d_prime: 1.852398
train_loss: 0.107185
valid_loss: 1.045565
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0017839792255333797
Epoch-19 lr: 0.007135916902133519
epoch 19 training time: 14.987
---------------
2023-09-11 10:10:17.525414
current #epochs=20, #steps=760
start validation
acc: 0.796209
AUC: 0.903580
Avg Precision: 0.337395
Avg Recall: 1.000000
d_prime: 1.841625
train_loss: 0.111838
valid_loss: 1.046207
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0017839792255333797
Epoch-20 lr: 0.007135916902133519
epoch 20 training time: 15.096
---------------
2023-09-11 10:10:32.621387
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03559	Per Sample Data Time 0.02832	Per Sample DNN Time 0.00727	Train Loss 0.0969	
start validation
acc: 0.815166
AUC: 0.901941
Avg Precision: 0.311195
Avg Recall: 1.000000
d_prime: 1.828144
train_loss: 0.100039
valid_loss: 1.044310
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0017839792255333797
Epoch-21 lr: 0.007135916902133519
epoch 21 training time: 17.250
---------------
2023-09-11 10:10:49.871560
current #epochs=22, #steps=840
start validation
acc: 0.786730
AUC: 0.913879
Avg Precision: 0.363481
Avg Recall: 1.000000
d_prime: 1.930452
train_loss: 0.123775
valid_loss: 1.055488
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0017839792255333797
Epoch-22 lr: 0.007135916902133519
epoch 22 training time: 16.794
---------------
2023-09-11 10:11:06.665912
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00562	Train Loss 0.1185	
start validation
acc: 0.800948
AUC: 0.913615
Avg Precision: 0.352869
Avg Recall: 1.000000
d_prime: 1.928082
train_loss: 0.119813
valid_loss: 1.051216
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.001621671445060125
Epoch-23 lr: 0.0064866857802405
epoch 23 training time: 15.774
---------------
2023-09-11 10:11:22.439824
current #epochs=24, #steps=920
start validation
acc: 0.824645
AUC: 0.913168
Avg Precision: 0.354495
Avg Recall: 1.000000
d_prime: 1.924068
train_loss: 0.095857
valid_loss: 1.047697
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.001621671445060125
Epoch-24 lr: 0.0064866857802405
epoch 24 training time: 15.926
---------------
2023-09-11 10:11:38.365966
current #epochs=25, #steps=960
start validation
acc: 0.772512
AUC: 0.910942
Avg Precision: 0.349031
Avg Recall: 1.000000
d_prime: 1.904351
train_loss: 0.108125
valid_loss: 1.065288
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.001621671445060125
Epoch-25 lr: 0.0064866857802405
epoch 25 training time: 17.092
---------------
2023-09-11 10:11:55.457948
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03807	Per Sample Data Time 0.02784	Per Sample DNN Time 0.01023	Train Loss 0.1378	
start validation
acc: 0.791469
AUC: 0.907959
Avg Precision: 0.295078
Avg Recall: 1.000000
d_prime: 1.878490
train_loss: 0.104259
valid_loss: 1.059238
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.001621671445060125
Epoch-26 lr: 0.0064866857802405
epoch 26 training time: 15.065
---------------
2023-09-11 10:12:10.523464
current #epochs=27, #steps=1040
start validation
acc: 0.805687
AUC: 0.908451
Avg Precision: 0.339422
Avg Recall: 1.000000
d_prime: 1.882710
train_loss: 0.084090
valid_loss: 1.050149
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.001621671445060125
Epoch-27 lr: 0.0064866857802405
epoch 27 training time: 15.019
---------------
2023-09-11 10:12:25.542578
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00560	Train Loss 0.1264	
start validation
acc: 0.753555
AUC: 0.912513
Avg Precision: 0.314226
Avg Recall: 1.000000
d_prime: 1.918231
train_loss: 0.115063
valid_loss: 1.038891
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.001621671445060125
Epoch-28 lr: 0.0064866857802405
epoch 28 training time: 14.924
---------------
2023-09-11 10:12:40.466967
current #epochs=29, #steps=1120
start validation
acc: 0.777251
AUC: 0.909421
Avg Precision: 0.297849
Avg Recall: 1.000000
d_prime: 1.891087
train_loss: 0.072089
valid_loss: 1.038727
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.001621671445060125
Epoch-29 lr: 0.0064866857802405
epoch 29 training time: 15.111
---------------
2023-09-11 10:12:55.577717
current #epochs=30, #steps=1160
start validation
acc: 0.810427
AUC: 0.902307
Avg Precision: 0.306497
Avg Recall: 1.000000
d_prime: 1.831141
train_loss: 0.097138
valid_loss: 1.049311
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0014741305493269532
Epoch-30 lr: 0.005896522197307813
epoch 30 training time: 15.002
---------------
2023-09-11 10:13:10.579536
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03494	Per Sample Data Time 0.02774	Per Sample DNN Time 0.00720	Train Loss 0.0246	
start validation
[I 2023-09-11 10:13:25,711] Trial 25 finished with value: 0.8341232227488151 and parameters: {'warmup': 'True', 'num_epochs': 31, 'batch_size': 52, 'lr-adaptschedule': 'False', 'lr': 0.002158955242185134, 'head-lr': 4, 'lr-scheduler-start': 9, 'lr-scheduler-step': 7, 'lr-scheduler-decay': 0.9090192429652719}. Best is trial 13 with value: 0.8341232227488151.
acc: 0.791469
AUC: 0.898614
Avg Precision: 0.307072
Avg Recall: 1.000000
d_prime: 1.801271
train_loss: 0.091750
valid_loss: 1.055805
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0014741305493269532
Epoch-31 lr: 0.005896522197307813
epoch 31 training time: 15.125
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f85b52a6760>
The learning rate scheduler starts at 3 epoch with decay rate of 0.881 every 8 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 10:13:25.744563
current #epochs=1, #steps=0
start validation
acc: 0.786730
AUC: 0.888314
Avg Precision: 0.312240
Avg Recall: 1.000000
d_prime: 1.721961
train_loss: 0.152480
valid_loss: 1.086678
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0025879614822301583
Epoch-1 lr: 0.010351845928920633
epoch 1 training time: 18.039
---------------
2023-09-11 10:13:43.784307
current #epochs=2, #steps=40
start validation
acc: 0.772512
AUC: 0.909759
Avg Precision: 0.296805
Avg Recall: 1.000000
d_prime: 1.894017
train_loss: 0.142540
valid_loss: 1.054247
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0025879614822301583
Epoch-2 lr: 0.010351845928920633
epoch 2 training time: 16.356
---------------
2023-09-11 10:14:00.139719
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00697	Per Sample Data Time 0.00143	Per Sample DNN Time 0.00553	Train Loss 0.1482	
start validation
acc: 0.777251
AUC: 0.898357
Avg Precision: 0.311611
Avg Recall: 1.000000
d_prime: 1.799230
train_loss: 0.147611
valid_loss: 1.058051
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0022791504132755385
Epoch-3 lr: 0.009116601653102154
epoch 3 training time: 14.936
---------------
2023-09-11 10:14:15.076137
current #epochs=4, #steps=120
start validation
acc: 0.805687
AUC: 0.910656
Avg Precision: 0.333054
Avg Recall: 1.000000
d_prime: 1.901843
train_loss: 0.121082
valid_loss: 1.069202
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0022791504132755385
Epoch-4 lr: 0.009116601653102154
epoch 4 training time: 18.218
---------------
2023-09-11 10:14:33.294401
current #epochs=5, #steps=160
start validation
acc: 0.815166
AUC: 0.906848
Avg Precision: 0.333017
Avg Recall: 1.000000
d_prime: 1.869011
train_loss: 0.164059
valid_loss: 1.051661
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0022791504132755385
Epoch-5 lr: 0.009116601653102154
epoch 5 training time: 17.070
---------------
2023-09-11 10:14:50.364041
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03530	Per Sample Data Time 0.02871	Per Sample DNN Time 0.00659	Train Loss 0.2078	
start validation
acc: 0.791469
AUC: 0.910861
Avg Precision: 0.322916
Avg Recall: 1.000000
d_prime: 1.903640
train_loss: 0.115674
valid_loss: 1.037592
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0022791504132755385
Epoch-6 lr: 0.009116601653102154
epoch 6 training time: 15.086
---------------
2023-09-11 10:15:05.450208
current #epochs=7, #steps=240
start validation
acc: 0.791469
AUC: 0.910292
Avg Precision: 0.343742
Avg Recall: 1.000000
d_prime: 1.898657
train_loss: 0.111754
valid_loss: 1.045504
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0022791504132755385
Epoch-7 lr: 0.009116601653102154
epoch 7 training time: 16.603
---------------
2023-09-11 10:15:22.053805
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00700	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00555	Train Loss 0.1496	
start validation
acc: 0.824645
AUC: 0.909886
Avg Precision: 0.339623
Avg Recall: 1.000000
d_prime: 1.895125
train_loss: 0.143075
valid_loss: 1.034395
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0022791504132755385
Epoch-8 lr: 0.009116601653102154
epoch 8 training time: 18.983
---------------
2023-09-11 10:15:41.036405
current #epochs=9, #steps=320
start validation
acc: 0.819905
AUC: 0.903944
Avg Precision: 0.316834
Avg Recall: 1.000000
d_prime: 1.844637
train_loss: 0.121755
valid_loss: 1.034524
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0022791504132755385
Epoch-9 lr: 0.009116601653102154
epoch 9 training time: 17.692
---------------
2023-09-11 10:15:58.728811
current #epochs=10, #steps=360
start validation
acc: 0.796209
AUC: 0.928526
Avg Precision: 0.339771
Avg Recall: 1.000000
d_prime: 2.071683
train_loss: 0.122413
valid_loss: 1.006086
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0022791504132755385
Epoch-10 lr: 0.009116601653102154
epoch 10 training time: 15.111
---------------
2023-09-11 10:16:13.839965
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03829	Per Sample Data Time 0.02795	Per Sample DNN Time 0.01033	Train Loss 0.0780	
start validation
acc: 0.810427
AUC: 0.909236
Avg Precision: 0.338236
Avg Recall: 1.000000
d_prime: 1.889483
train_loss: 0.124140
valid_loss: 1.031150
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.002007188531205538
Epoch-11 lr: 0.008028754124822152
epoch 11 training time: 17.484
---------------
2023-09-11 10:16:31.323892
current #epochs=12, #steps=440
start validation
acc: 0.810427
AUC: 0.902465
Avg Precision: 0.321225
Avg Recall: 1.000000
d_prime: 1.832434
train_loss: 0.105803
valid_loss: 1.044886
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.002007188531205538
Epoch-12 lr: 0.008028754124822152
epoch 12 training time: 16.586
---------------
2023-09-11 10:16:47.909563
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00558	Train Loss 0.0893	
start validation
acc: 0.819905
AUC: 0.904052
Avg Precision: 0.318320
Avg Recall: 1.000000
d_prime: 1.845539
train_loss: 0.092204
valid_loss: 1.043049
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.002007188531205538
Epoch-13 lr: 0.008028754124822152
epoch 13 training time: 15.102
---------------
2023-09-11 10:17:03.011492
current #epochs=14, #steps=520
start validation
acc: 0.805687
AUC: 0.912354
Avg Precision: 0.310801
Avg Recall: 1.000000
d_prime: 1.916818
train_loss: 0.079613
valid_loss: 1.028897
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.002007188531205538
Epoch-14 lr: 0.008028754124822152
epoch 14 training time: 15.911
---------------
2023-09-11 10:17:18.922413
current #epochs=15, #steps=560
start validation
acc: 0.800948
AUC: 0.905335
Avg Precision: 0.335172
Avg Recall: 1.000000
d_prime: 1.856241
train_loss: 0.098260
valid_loss: 1.062675
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.002007188531205538
Epoch-15 lr: 0.008028754124822152
epoch 15 training time: 17.901
---------------
2023-09-11 10:17:36.823145
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03629	Per Sample Data Time 0.02995	Per Sample DNN Time 0.00634	Train Loss 0.1641	
start validation
acc: 0.800948
AUC: 0.912343
Avg Precision: 0.318622
Avg Recall: 1.000000
d_prime: 1.916721
train_loss: 0.130041
valid_loss: 1.038393
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.002007188531205538
Epoch-16 lr: 0.008028754124822152
epoch 16 training time: 14.997
---------------
2023-09-11 10:17:51.820129
current #epochs=17, #steps=640
start validation
acc: 0.800948
AUC: 0.902832
Avg Precision: 0.318187
Avg Recall: 1.000000
d_prime: 1.835448
train_loss: 0.115719
valid_loss: 1.048146
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.002007188531205538
Epoch-17 lr: 0.008028754124822152
epoch 17 training time: 14.946
---------------
2023-09-11 10:18:06.765515
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00557	Train Loss 0.0811	
start validation
[I 2023-09-11 10:18:21,724] Trial 26 finished with value: 0.8246445497630331 and parameters: {'warmup': 'True', 'num_epochs': 18, 'batch_size': 60, 'lr-adaptschedule': 'True', 'lr': 0.0025879614822301583, 'head-lr': 4, 'lr-scheduler-start': 3, 'lr-scheduler-step': 8, 'lr-scheduler-decay': 0.8806740088386077}. Best is trial 13 with value: 0.8341232227488151.
acc: 0.786730
AUC: 0.922136
Avg Precision: 0.342837
Avg Recall: 1.000000
d_prime: 2.007601
train_loss: 0.095621
valid_loss: 1.039022
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.002007188531205538
Epoch-18 lr: 0.008028754124822152
epoch 18 training time: 14.952
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f85b52a6790>
The learning rate scheduler starts at 10 epoch with decay rate of 0.919 every 7 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 10:18:21.759157
current #epochs=1, #steps=0
start validation
acc: 0.805687
AUC: 0.919551
Avg Precision: 0.358738
Avg Recall: 1.000000
d_prime: 1.982807
train_loss: 0.118553
valid_loss: 1.056100
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0019991740696277556
Epoch-1 lr: 0.0059975222088832665
epoch 1 training time: 17.042
---------------
2023-09-11 10:18:38.801762
current #epochs=2, #steps=40
start validation
acc: 0.810427
AUC: 0.903416
Avg Precision: 0.306199
Avg Recall: 1.000000
d_prime: 1.840262
train_loss: 0.127004
valid_loss: 1.052220
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0019991740696277556
Epoch-2 lr: 0.0059975222088832665
epoch 2 training time: 18.243
---------------
2023-09-11 10:18:57.044646
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00557	Train Loss 0.0871	
start validation
acc: 0.805687
AUC: 0.909848
Avg Precision: 0.310197
Avg Recall: 1.000000
d_prime: 1.894790
train_loss: 0.086305
valid_loss: 1.050972
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0019991740696277556
Epoch-3 lr: 0.0059975222088832665
epoch 3 training time: 15.116
---------------
2023-09-11 10:19:12.160222
current #epochs=4, #steps=120
start validation
acc: 0.815166
AUC: 0.903399
Avg Precision: 0.303198
Avg Recall: 1.000000
d_prime: 1.840123
train_loss: 0.098419
valid_loss: 1.048496
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0019991740696277556
Epoch-4 lr: 0.0059975222088832665
epoch 4 training time: 17.067
---------------
2023-09-11 10:19:29.227273
current #epochs=5, #steps=160
start validation
acc: 0.815166
AUC: 0.896821
Avg Precision: 0.303457
Avg Recall: 1.000000
d_prime: 1.787062
train_loss: 0.103533
valid_loss: 1.046669
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0019991740696277556
Epoch-5 lr: 0.0059975222088832665
epoch 5 training time: 14.951
---------------
2023-09-11 10:19:44.177958
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03817	Per Sample Data Time 0.02756	Per Sample DNN Time 0.01061	Train Loss 0.1866	
start validation
acc: 0.829384
AUC: 0.902117
Avg Precision: 0.291594
Avg Recall: 1.000000
d_prime: 1.829584
train_loss: 0.113759
valid_loss: 1.048551
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0019991740696277556
Epoch-6 lr: 0.0059975222088832665
epoch 6 training time: 17.843
---------------
2023-09-11 10:20:02.021008
current #epochs=7, #steps=240
start validation
acc: 0.800948
AUC: 0.901400
Avg Precision: 0.303099
Avg Recall: 1.000000
d_prime: 1.823729
train_loss: 0.134684
valid_loss: 1.045881
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0019991740696277556
Epoch-7 lr: 0.0059975222088832665
epoch 7 training time: 15.221
---------------
2023-09-11 10:20:17.241777
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00701	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00554	Train Loss 0.1030	
start validation
[I 2023-09-11 10:20:33,159] Trial 27 finished with value: 0.8293838862559242 and parameters: {'warmup': 'False', 'num_epochs': 8, 'batch_size': 26, 'lr-adaptschedule': 'False', 'lr': 0.0019991740696277556, 'head-lr': 3, 'lr-scheduler-start': 10, 'lr-scheduler-step': 7, 'lr-scheduler-decay': 0.919462955644556}. Best is trial 13 with value: 0.8341232227488151.
acc: 0.805687
AUC: 0.912664
Avg Precision: 0.321066
Avg Recall: 1.000000
d_prime: 1.919578
train_loss: 0.109667
valid_loss: 1.048696
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0019991740696277556
Epoch-8 lr: 0.0059975222088832665
epoch 8 training time: 15.911
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f85b52a6820>
The learning rate scheduler starts at 9 epoch with decay rate of 0.902 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 10:20:33.192911
current #epochs=1, #steps=0
start validation
acc: 0.800948
AUC: 0.905062
Avg Precision: 0.328150
Avg Recall: 1.000000
d_prime: 1.853956
train_loss: 0.118213
valid_loss: 1.051065
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0014888641417309533
Epoch-1 lr: 0.005955456566923813
epoch 1 training time: 17.715
---------------
2023-09-11 10:20:50.908434
current #epochs=2, #steps=40
start validation
acc: 0.786730
AUC: 0.903839
Avg Precision: 0.329471
Avg Recall: 1.000000
d_prime: 1.843768
train_loss: 0.101550
valid_loss: 1.038702
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0014888641417309533
Epoch-2 lr: 0.005955456566923813
epoch 2 training time: 16.260
---------------
2023-09-11 10:21:07.168328
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00551	Train Loss 0.0940	
start validation
acc: 0.810427
AUC: 0.896585
Avg Precision: 0.318905
Avg Recall: 1.000000
d_prime: 1.785206
train_loss: 0.107119
valid_loss: 1.042009
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0014888641417309533
Epoch-3 lr: 0.005955456566923813
epoch 3 training time: 18.532
---------------
2023-09-11 10:21:25.700452
current #epochs=4, #steps=120
start validation
acc: 0.791469
AUC: 0.909551
Avg Precision: 0.327609
Avg Recall: 1.000000
d_prime: 1.892207
train_loss: 0.088328
valid_loss: 1.051012
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0014888641417309533
Epoch-4 lr: 0.005955456566923813
epoch 4 training time: 15.225
---------------
2023-09-11 10:21:40.924972
current #epochs=5, #steps=160
start validation
acc: 0.805687
AUC: 0.904685
Avg Precision: 0.323248
Avg Recall: 1.000000
d_prime: 1.850810
train_loss: 0.085834
valid_loss: 1.045539
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0014888641417309533
Epoch-5 lr: 0.005955456566923813
epoch 5 training time: 16.174
---------------
2023-09-11 10:21:57.099435
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03715	Per Sample Data Time 0.02829	Per Sample DNN Time 0.00886	Train Loss 0.0811	
start validation
acc: 0.824645
AUC: 0.900859
Avg Precision: 0.309055
Avg Recall: 1.000000
d_prime: 1.819328
train_loss: 0.078578
valid_loss: 1.051874
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0014888641417309533
Epoch-6 lr: 0.005955456566923813
epoch 6 training time: 17.351
---------------
2023-09-11 10:22:14.450109
current #epochs=7, #steps=240
start validation
acc: 0.786730
AUC: 0.897183
Avg Precision: 0.303638
Avg Recall: 1.000000
d_prime: 1.789920
train_loss: 0.078435
valid_loss: 1.049850
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0014888641417309533
Epoch-7 lr: 0.005955456566923813
epoch 7 training time: 16.307
---------------
2023-09-11 10:22:30.756996
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00696	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00551	Train Loss 0.0900	
start validation
acc: 0.810427
AUC: 0.889846
Avg Precision: 0.280112
Avg Recall: 1.000000
d_prime: 1.733417
train_loss: 0.080407
valid_loss: 1.050495
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0014888641417309533
Epoch-8 lr: 0.005955456566923813
epoch 8 training time: 16.678
---------------
2023-09-11 10:22:47.435500
current #epochs=9, #steps=320
start validation
acc: 0.763033
AUC: 0.914924
Avg Precision: 0.341794
Avg Recall: 1.000000
d_prime: 1.939903
train_loss: 0.099267
valid_loss: 1.036004
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0013424262126224464
Epoch-9 lr: 0.005369704850489786
epoch 9 training time: 16.574
---------------
2023-09-11 10:23:04.010052
current #epochs=10, #steps=360
start validation
acc: 0.819905
AUC: 0.912200
Avg Precision: 0.331252
Avg Recall: 1.000000
d_prime: 1.915452
train_loss: 0.086867
valid_loss: 1.040003
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0013424262126224464
Epoch-10 lr: 0.005369704850489786
epoch 10 training time: 15.822
---------------
2023-09-11 10:23:19.831662
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03562	Per Sample Data Time 0.02847	Per Sample DNN Time 0.00715	Train Loss 0.1258	
start validation
acc: 0.805687
AUC: 0.898256
Avg Precision: 0.321125
Avg Recall: 1.000000
d_prime: 1.798425
train_loss: 0.088391
valid_loss: 1.055549
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0013424262126224464
Epoch-11 lr: 0.005369704850489786
epoch 11 training time: 16.671
---------------
2023-09-11 10:23:36.502892
current #epochs=12, #steps=440
start validation
acc: 0.786730
AUC: 0.902425
Avg Precision: 0.294738
Avg Recall: 1.000000
d_prime: 1.832102
train_loss: 0.085495
valid_loss: 1.051640
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0013424262126224464
Epoch-12 lr: 0.005369704850489786
epoch 12 training time: 14.986
---------------
2023-09-11 10:23:51.489065
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00562	Train Loss 0.1155	
start validation
acc: 0.796209
AUC: 0.898623
Avg Precision: 0.309971
Avg Recall: 1.000000
d_prime: 1.801345
train_loss: 0.118820
valid_loss: 1.061921
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0013424262126224464
Epoch-13 lr: 0.005369704850489786
epoch 13 training time: 15.132
---------------
2023-09-11 10:24:06.621521
current #epochs=14, #steps=520
start validation
acc: 0.815166
AUC: 0.913242
Avg Precision: 0.330277
Avg Recall: 1.000000
d_prime: 1.924736
train_loss: 0.086793
valid_loss: 1.038439
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0013424262126224464
Epoch-14 lr: 0.005369704850489786
epoch 14 training time: 14.965
---------------
2023-09-11 10:24:21.586504
current #epochs=15, #steps=560
start validation
acc: 0.763033
AUC: 0.900815
Avg Precision: 0.338037
Avg Recall: 1.000000
d_prime: 1.818973
train_loss: 0.087911
valid_loss: 1.063613
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0013424262126224464
Epoch-15 lr: 0.005369704850489786
epoch 15 training time: 16.563
---------------
2023-09-11 10:24:38.149768
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03854	Per Sample Data Time 0.02896	Per Sample DNN Time 0.00959	Train Loss 0.0742	
start validation
acc: 0.800948
AUC: 0.909121
Avg Precision: 0.346055
Avg Recall: 1.000000
d_prime: 1.888483
train_loss: 0.091200
valid_loss: 1.052051
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0013424262126224464
Epoch-16 lr: 0.005369704850489786
epoch 16 training time: 15.071
---------------
2023-09-11 10:24:53.220786
current #epochs=17, #steps=640
start validation
acc: 0.777251
AUC: 0.897373
Avg Precision: 0.335823
Avg Recall: 1.000000
d_prime: 1.791417
train_loss: 0.100526
valid_loss: 1.055558
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0013424262126224464
Epoch-17 lr: 0.005369704850489786
epoch 17 training time: 18.072
---------------
2023-09-11 10:25:11.293000
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00558	Train Loss 0.0867	
start validation
acc: 0.805687
AUC: 0.911375
Avg Precision: 0.314302
Avg Recall: 1.000000
d_prime: 1.908155
train_loss: 0.083774
valid_loss: 1.046857
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0012103912545309305
Epoch-18 lr: 0.004841565018123722
epoch 18 training time: 16.211
---------------
2023-09-11 10:25:27.504267
current #epochs=19, #steps=720
start validation
acc: 0.781991
AUC: 0.902993
Avg Precision: 0.293798
Avg Recall: 1.000000
d_prime: 1.836771
train_loss: 0.083934
valid_loss: 1.059013
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0012103912545309305
Epoch-19 lr: 0.004841565018123722
epoch 19 training time: 16.307
---------------
2023-09-11 10:25:43.811202
current #epochs=20, #steps=760
start validation
acc: 0.786730
AUC: 0.902865
Avg Precision: 0.335565
Avg Recall: 1.000000
d_prime: 1.835720
train_loss: 0.077629
valid_loss: 1.052938
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0012103912545309305
Epoch-20 lr: 0.004841565018123722
epoch 20 training time: 16.808
---------------
2023-09-11 10:26:00.619120
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03617	Per Sample Data Time 0.02892	Per Sample DNN Time 0.00725	Train Loss 0.1742	
start validation
acc: 0.796209
AUC: 0.896003
Avg Precision: 0.292116
Avg Recall: 1.000000
d_prime: 1.780639
train_loss: 0.080151
valid_loss: 1.049113
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0012103912545309305
Epoch-21 lr: 0.004841565018123722
epoch 21 training time: 15.007
---------------
2023-09-11 10:26:15.626146
current #epochs=22, #steps=840
start validation
acc: 0.805687
AUC: 0.905848
Avg Precision: 0.344251
Avg Recall: 1.000000
d_prime: 1.860557
train_loss: 0.099644
valid_loss: 1.046798
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0012103912545309305
Epoch-22 lr: 0.004841565018123722
epoch 22 training time: 15.090
---------------
2023-09-11 10:26:30.716499
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00560	Train Loss 0.0553	
start validation
acc: 0.800948
AUC: 0.905547
Avg Precision: 0.311261
Avg Recall: 1.000000
d_prime: 1.858029
train_loss: 0.052098
valid_loss: 1.043337
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0012103912545309305
Epoch-23 lr: 0.004841565018123722
epoch 23 training time: 14.962
---------------
2023-09-11 10:26:45.679040
current #epochs=24, #steps=920
start validation
acc: 0.805687
AUC: 0.901616
Avg Precision: 0.294157
Avg Recall: 1.000000
d_prime: 1.825486
train_loss: 0.084728
valid_loss: 1.061203
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0012103912545309305
Epoch-24 lr: 0.004841565018123722
epoch 24 training time: 16.070
---------------
2023-09-11 10:27:01.749135
current #epochs=25, #steps=960
start validation
acc: 0.796209
AUC: 0.905946
Avg Precision: 0.306636
Avg Recall: 1.000000
d_prime: 1.861380
train_loss: 0.070171
valid_loss: 1.038159
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0012103912545309305
Epoch-25 lr: 0.004841565018123722
epoch 25 training time: 15.480
---------------
2023-09-11 10:27:17.228844
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03737	Per Sample Data Time 0.03062	Per Sample DNN Time 0.00676	Train Loss 0.0886	
start validation
acc: 0.781991
AUC: 0.902555
Avg Precision: 0.301932
Avg Recall: 1.000000
d_prime: 1.833168
train_loss: 0.080841
valid_loss: 1.047357
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0012103912545309305
Epoch-26 lr: 0.004841565018123722
epoch 26 training time: 15.074
---------------
2023-09-11 10:27:32.302506
current #epochs=27, #steps=1040
start validation
acc: 0.796209
AUC: 0.897794
Avg Precision: 0.305672
Avg Recall: 1.000000
d_prime: 1.794750
train_loss: 0.084143
valid_loss: 1.058138
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0010913426565047268
Epoch-27 lr: 0.004365370626018907
epoch 27 training time: 15.032
---------------
2023-09-11 10:27:47.334916
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00566	Train Loss 0.0813	
start validation
acc: 0.815166
AUC: 0.898263
Avg Precision: 0.300152
Avg Recall: 1.000000
d_prime: 1.798482
train_loss: 0.075916
valid_loss: 1.053395
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0010913426565047268
Epoch-28 lr: 0.004365370626018907
epoch 28 training time: 15.151
---------------
2023-09-11 10:28:02.485712
current #epochs=29, #steps=1120
start validation
acc: 0.805687
AUC: 0.894951
Avg Precision: 0.286351
Avg Recall: 1.000000
d_prime: 1.772427
train_loss: 0.086087
valid_loss: 1.051364
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0010913426565047268
Epoch-29 lr: 0.004365370626018907
epoch 29 training time: 16.803
---------------
2023-09-11 10:28:19.289376
current #epochs=30, #steps=1160
start validation
acc: 0.815166
AUC: 0.907043
Avg Precision: 0.290204
Avg Recall: 1.000000
d_prime: 1.870668
train_loss: 0.091197
valid_loss: 1.047556
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0010913426565047268
Epoch-30 lr: 0.004365370626018907
epoch 30 training time: 15.035
---------------
2023-09-11 10:28:34.324112
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03985	Per Sample Data Time 0.02987	Per Sample DNN Time 0.00998	Train Loss 0.0287	
start validation
acc: 0.786730
AUC: 0.897568
Avg Precision: 0.319154
Avg Recall: 1.000000
d_prime: 1.792962
train_loss: 0.074691
valid_loss: 1.055063
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0010913426565047268
Epoch-31 lr: 0.004365370626018907
epoch 31 training time: 15.069
---------------
2023-09-11 10:28:49.392924
current #epochs=32, #steps=1240
start validation
acc: 0.815166
AUC: 0.888549
Avg Precision: 0.297792
Avg Recall: 1.000000
d_prime: 1.723710
train_loss: 0.103809
valid_loss: 1.057037
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0010913426565047268
Epoch-32 lr: 0.004365370626018907
epoch 32 training time: 15.138
---------------
2023-09-11 10:29:04.531265
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00555	Train Loss 0.1083	
start validation
acc: 0.777251
AUC: 0.895113
Avg Precision: 0.314865
Avg Recall: 1.000000
d_prime: 1.773691
train_loss: 0.099266
valid_loss: 1.046366
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0010913426565047268
Epoch-33 lr: 0.004365370626018907
epoch 33 training time: 14.983
---------------
2023-09-11 10:29:19.513918
current #epochs=34, #steps=1320
start validation
acc: 0.777251
AUC: 0.910529
Avg Precision: 0.322801
Avg Recall: 1.000000
d_prime: 1.900731
train_loss: 0.096627
valid_loss: 1.035125
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0010913426565047268
Epoch-34 lr: 0.004365370626018907
epoch 34 training time: 15.122
---------------
2023-09-11 10:29:34.635691
current #epochs=35, #steps=1360
start validation
[I 2023-09-11 10:29:49,644] Trial 28 finished with value: 0.8246445497630331 and parameters: {'warmup': 'True', 'num_epochs': 35, 'batch_size': 40, 'lr-adaptschedule': 'False', 'lr': 0.0014888641417309533, 'head-lr': 4, 'lr-scheduler-start': 9, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.9016445322282676}. Best is trial 13 with value: 0.8341232227488151.
acc: 0.786730
AUC: 0.908065
Avg Precision: 0.319059
Avg Recall: 1.000000
d_prime: 1.879398
train_loss: 0.086201
valid_loss: 1.041394
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0010913426565047268
Epoch-35 lr: 0.004365370626018907
epoch 35 training time: 15.002
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f86670be280>
The learning rate scheduler starts at 7 epoch with decay rate of 0.850 every 6 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 10:29:49.678886
current #epochs=1, #steps=0
start validation
acc: 0.810427
AUC: 0.907537
Avg Precision: 0.289335
Avg Recall: 1.000000
d_prime: 1.874883
train_loss: 0.144592
valid_loss: 1.043538
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002291067965697217
Epoch-1 lr: 0.011455339828486085
epoch 1 training time: 16.872
---------------
2023-09-11 10:30:06.551820
current #epochs=2, #steps=40
start validation
acc: 0.805687
AUC: 0.896480
Avg Precision: 0.302833
Avg Recall: 1.000000
d_prime: 1.784381
train_loss: 0.106830
valid_loss: 1.050614
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002291067965697217
Epoch-2 lr: 0.011455339828486085
epoch 2 training time: 15.963
---------------
2023-09-11 10:30:22.515262
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00556	Train Loss 0.1315	
start validation
acc: 0.796209
AUC: 0.884305
Avg Precision: 0.313810
Avg Recall: 1.000000
d_prime: 1.692508
train_loss: 0.122241
valid_loss: 1.057687
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002291067965697217
Epoch-3 lr: 0.011455339828486085
epoch 3 training time: 14.998
---------------
2023-09-11 10:30:37.513447
current #epochs=4, #steps=120
start validation
acc: 0.829384
AUC: 0.900397
Avg Precision: 0.294748
Avg Recall: 1.000000
d_prime: 1.815590
train_loss: 0.114218
valid_loss: 1.044274
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002291067965697217
Epoch-4 lr: 0.011455339828486085
epoch 4 training time: 16.968
---------------
2023-09-11 10:30:54.481484
current #epochs=5, #steps=160
start validation
acc: 0.805687
AUC: 0.878437
Avg Precision: 0.285905
Avg Recall: 1.000000
d_prime: 1.650684
train_loss: 0.090283
valid_loss: 1.055137
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002291067965697217
Epoch-5 lr: 0.011455339828486085
epoch 5 training time: 15.150
---------------
2023-09-11 10:31:09.632130
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03617	Per Sample Data Time 0.02870	Per Sample DNN Time 0.00747	Train Loss 0.1408	
start validation
acc: 0.781991
AUC: 0.901525
Avg Precision: 0.293900
Avg Recall: 1.000000
d_prime: 1.824748
train_loss: 0.114016
valid_loss: 1.048941
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002291067965697217
Epoch-6 lr: 0.011455339828486085
epoch 6 training time: 14.979
---------------
2023-09-11 10:31:24.610964
current #epochs=7, #steps=240
start validation
acc: 0.772512
AUC: 0.902242
Avg Precision: 0.308826
Avg Recall: 1.000000
d_prime: 1.830600
train_loss: 0.126936
valid_loss: 1.038426
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0019479427289428224
Epoch-7 lr: 0.009739713644714112
epoch 7 training time: 15.852
---------------
2023-09-11 10:31:40.462405
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00566	Train Loss 0.1163	
start validation
acc: 0.786730
AUC: 0.885717
Avg Precision: 0.303269
Avg Recall: 1.000000
d_prime: 1.702798
train_loss: 0.114082
valid_loss: 1.061620
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0019479427289428224
Epoch-8 lr: 0.009739713644714112
epoch 8 training time: 14.943
---------------
2023-09-11 10:31:55.405029
current #epochs=9, #steps=320
start validation
acc: 0.824645
AUC: 0.899926
Avg Precision: 0.311821
Avg Recall: 1.000000
d_prime: 1.811792
train_loss: 0.132055
valid_loss: 1.050083
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0019479427289428224
Epoch-9 lr: 0.009739713644714112
epoch 9 training time: 16.220
---------------
2023-09-11 10:32:11.625534
current #epochs=10, #steps=360
start validation
acc: 0.800948
AUC: 0.907777
Avg Precision: 0.319954
Avg Recall: 1.000000
d_prime: 1.876931
train_loss: 0.118779
valid_loss: 1.053578
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0019479427289428224
Epoch-10 lr: 0.009739713644714112
epoch 10 training time: 14.987
---------------
2023-09-11 10:32:26.612653
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03731	Per Sample Data Time 0.02771	Per Sample DNN Time 0.00960	Train Loss 0.0105	
start validation
acc: 0.800948
AUC: 0.906674
Avg Precision: 0.322811
Avg Recall: 1.000000
d_prime: 1.867536
train_loss: 0.080701
valid_loss: 1.051708
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0019479427289428224
Epoch-11 lr: 0.009739713644714112
epoch 11 training time: 14.962
---------------
2023-09-11 10:32:41.575338
current #epochs=12, #steps=440
start validation
acc: 0.772512
AUC: 0.887523
Avg Precision: 0.288062
Avg Recall: 1.000000
d_prime: 1.716092
train_loss: 0.099625
valid_loss: 1.059231
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0019479427289428224
Epoch-12 lr: 0.009739713644714112
epoch 12 training time: 15.100
---------------
2023-09-11 10:32:56.674732
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00702	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00555	Train Loss 0.1000	
start validation
acc: 0.786730
AUC: 0.890291
Avg Precision: 0.298102
Avg Recall: 1.000000
d_prime: 1.736767
train_loss: 0.103581
valid_loss: 1.044481
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.001656206158897811
Epoch-13 lr: 0.008281030794489056
epoch 13 training time: 15.604
---------------
2023-09-11 10:33:12.279323
current #epochs=14, #steps=520
start validation
acc: 0.810427
AUC: 0.898292
Avg Precision: 0.305409
Avg Recall: 1.000000
d_prime: 1.798709
train_loss: 0.088676
valid_loss: 1.048329
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.001656206158897811
Epoch-14 lr: 0.008281030794489056
epoch 14 training time: 16.336
---------------
2023-09-11 10:33:28.615594
current #epochs=15, #steps=560
start validation
acc: 0.800948
AUC: 0.887347
Avg Precision: 0.292641
Avg Recall: 1.000000
d_prime: 1.714786
train_loss: 0.085862
valid_loss: 1.046084
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.001656206158897811
Epoch-15 lr: 0.008281030794489056
epoch 15 training time: 16.292
---------------
2023-09-11 10:33:44.907629
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03658	Per Sample Data Time 0.02922	Per Sample DNN Time 0.00736	Train Loss 0.2036	
start validation
acc: 0.796209
AUC: 0.895687
Avg Precision: 0.297108
Avg Recall: 1.000000
d_prime: 1.778169
train_loss: 0.092136
valid_loss: 1.062434
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.001656206158897811
Epoch-16 lr: 0.008281030794489056
epoch 16 training time: 14.999
---------------
2023-09-11 10:33:59.906581
current #epochs=17, #steps=640
start validation
acc: 0.791469
AUC: 0.915717
Avg Precision: 0.306058
Avg Recall: 1.000000
d_prime: 1.947127
train_loss: 0.086720
valid_loss: 1.052172
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.001656206158897811
Epoch-17 lr: 0.008281030794489056
epoch 17 training time: 15.805
---------------
2023-09-11 10:34:15.711637
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00559	Train Loss 0.0707	
start validation
acc: 0.805687
AUC: 0.906152
Avg Precision: 0.288732
Avg Recall: 1.000000
d_prime: 1.863117
train_loss: 0.094429
valid_loss: 1.034114
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001656206158897811
Epoch-18 lr: 0.008281030794489056
epoch 18 training time: 16.365
---------------
2023-09-11 10:34:32.076915
current #epochs=19, #steps=720
start validation
acc: 0.791469
AUC: 0.897623
Avg Precision: 0.322258
Avg Recall: 1.000000
d_prime: 1.793397
train_loss: 0.074979
valid_loss: 1.041845
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0014081619546688208
Epoch-19 lr: 0.007040809773344104
epoch 19 training time: 15.007
---------------
2023-09-11 10:34:47.083176
current #epochs=20, #steps=760
start validation
acc: 0.786730
AUC: 0.890837
Avg Precision: 0.305904
Avg Recall: 1.000000
d_prime: 1.740887
train_loss: 0.100000
valid_loss: 1.059840
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0014081619546688208
Epoch-20 lr: 0.007040809773344104
epoch 20 training time: 16.628
---------------
2023-09-11 10:35:03.711227
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03513	Per Sample Data Time 0.02795	Per Sample DNN Time 0.00718	Train Loss 0.0580	
start validation
acc: 0.796209
AUC: 0.894052
Avg Precision: 0.302855
Avg Recall: 1.000000
d_prime: 1.765461
train_loss: 0.080709
valid_loss: 1.044682
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0014081619546688208
Epoch-21 lr: 0.007040809773344104
epoch 21 training time: 14.941
---------------
2023-09-11 10:35:18.652110
current #epochs=22, #steps=840
start validation
acc: 0.781991
AUC: 0.907486
Avg Precision: 0.316430
Avg Recall: 1.000000
d_prime: 1.874447
train_loss: 0.078468
valid_loss: 1.039304
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0014081619546688208
Epoch-22 lr: 0.007040809773344104
epoch 22 training time: 14.865
---------------
2023-09-11 10:35:33.517052
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00559	Train Loss 0.0830	
start validation
[I 2023-09-11 10:35:49,184] Trial 29 finished with value: 0.8293838862559242 and parameters: {'warmup': 'True', 'num_epochs': 23, 'batch_size': 49, 'lr-adaptschedule': 'False', 'lr': 0.002291067965697217, 'head-lr': 5, 'lr-scheduler-start': 7, 'lr-scheduler-step': 6, 'lr-scheduler-decay': 0.8502334972633713}. Best is trial 13 with value: 0.8341232227488151.
acc: 0.777251
AUC: 0.901497
Avg Precision: 0.305501
Avg Recall: 1.000000
d_prime: 1.824517
train_loss: 0.087186
valid_loss: 1.026719
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0014081619546688208
Epoch-23 lr: 0.007040809773344104
epoch 23 training time: 15.660
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f86670dc310>
The learning rate scheduler starts at 10 epoch with decay rate of 0.927 every 6 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 10:35:49.219682
current #epochs=1, #steps=0
start validation
acc: 0.800948
AUC: 0.910867
Avg Precision: 0.325871
Avg Recall: 1.000000
d_prime: 1.903691
train_loss: 0.107776
valid_loss: 1.038625
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0010768000370686473
Epoch-1 lr: 0.003230400111205942
epoch 1 training time: 18.176
---------------
2023-09-11 10:36:07.396140
current #epochs=2, #steps=40
start validation
acc: 0.800948
AUC: 0.904557
Avg Precision: 0.299215
Avg Recall: 1.000000
d_prime: 1.849738
train_loss: 0.081323
valid_loss: 1.044343
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0010768000370686473
Epoch-2 lr: 0.003230400111205942
epoch 2 training time: 16.621
---------------
2023-09-11 10:36:24.016767
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00561	Train Loss 0.0857	
start validation
acc: 0.800948
AUC: 0.902527
Avg Precision: 0.302438
Avg Recall: 1.000000
d_prime: 1.832939
train_loss: 0.087781
valid_loss: 1.046973
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0010768000370686473
Epoch-3 lr: 0.003230400111205942
epoch 3 training time: 15.087
---------------
2023-09-11 10:36:39.104183
current #epochs=4, #steps=120
start validation
acc: 0.786730
AUC: 0.901902
Avg Precision: 0.296951
Avg Recall: 1.000000
d_prime: 1.827819
train_loss: 0.083830
valid_loss: 1.041162
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0010768000370686473
Epoch-4 lr: 0.003230400111205942
epoch 4 training time: 15.088
---------------
2023-09-11 10:36:54.192415
current #epochs=5, #steps=160
start validation
acc: 0.800948
AUC: 0.905885
Avg Precision: 0.278769
Avg Recall: 1.000000
d_prime: 1.860867
train_loss: 0.070086
valid_loss: 1.037412
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0010768000370686473
Epoch-5 lr: 0.003230400111205942
epoch 5 training time: 15.225
---------------
2023-09-11 10:37:09.416901
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03614	Per Sample Data Time 0.02894	Per Sample DNN Time 0.00719	Train Loss 0.0557	
start validation
acc: 0.796209
AUC: 0.903441
Avg Precision: 0.307461
Avg Recall: 1.000000
d_prime: 1.840469
train_loss: 0.065075
valid_loss: 1.038684
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0010768000370686473
Epoch-6 lr: 0.003230400111205942
epoch 6 training time: 15.043
---------------
2023-09-11 10:37:24.459882
current #epochs=7, #steps=240
start validation
acc: 0.805687
AUC: 0.902814
Avg Precision: 0.327967
Avg Recall: 1.000000
d_prime: 1.835298
train_loss: 0.092290
valid_loss: 1.039323
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0010768000370686473
Epoch-7 lr: 0.003230400111205942
epoch 7 training time: 16.885
---------------
2023-09-11 10:37:41.344894
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00565	Train Loss 0.1100	
start validation
acc: 0.815166
AUC: 0.909262
Avg Precision: 0.301275
Avg Recall: 1.000000
d_prime: 1.889710
train_loss: 0.096119
valid_loss: 1.032102
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0010768000370686473
Epoch-8 lr: 0.003230400111205942
epoch 8 training time: 17.227
---------------
2023-09-11 10:37:58.572198
current #epochs=9, #steps=320
start validation
acc: 0.810427
AUC: 0.901623
Avg Precision: 0.293274
Avg Recall: 1.000000
d_prime: 1.825544
train_loss: 0.087726
valid_loss: 1.031374
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0010768000370686473
Epoch-9 lr: 0.003230400111205942
epoch 9 training time: 16.018
---------------
2023-09-11 10:38:14.590329
current #epochs=10, #steps=360
start validation
acc: 0.796209
AUC: 0.907594
Avg Precision: 0.316107
Avg Recall: 1.000000
d_prime: 1.875368
train_loss: 0.076768
valid_loss: 1.034245
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0009977369948702772
Epoch-10 lr: 0.0029932109846108317
epoch 10 training time: 15.096
---------------
2023-09-11 10:38:29.686580
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03448	Per Sample Data Time 0.02684	Per Sample DNN Time 0.00764	Train Loss 0.0408	
start validation
acc: 0.796209
AUC: 0.916957
Avg Precision: 0.322316
Avg Recall: 1.000000
d_prime: 1.958528
train_loss: 0.085077
valid_loss: 1.025437
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0009977369948702772
Epoch-11 lr: 0.0029932109846108317
epoch 11 training time: 18.303
---------------
2023-09-11 10:38:47.989944
current #epochs=12, #steps=440
start validation
acc: 0.810427
AUC: 0.916347
Avg Precision: 0.323439
Avg Recall: 1.000000
d_prime: 1.952906
train_loss: 0.077292
valid_loss: 1.030598
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0009977369948702772
Epoch-12 lr: 0.0029932109846108317
epoch 12 training time: 14.985
---------------
2023-09-11 10:39:02.974738
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00562	Train Loss 0.0986	
start validation
acc: 0.815166
AUC: 0.901192
Avg Precision: 0.303448
Avg Recall: 1.000000
d_prime: 1.822035
train_loss: 0.086436
valid_loss: 1.037683
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0009977369948702772
Epoch-13 lr: 0.0029932109846108317
epoch 13 training time: 15.207
---------------
2023-09-11 10:39:18.182042
current #epochs=14, #steps=520
start validation
acc: 0.805687
AUC: 0.915295
Avg Precision: 0.346589
Avg Recall: 1.000000
d_prime: 1.943274
train_loss: 0.084489
valid_loss: 1.031719
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0009977369948702772
Epoch-14 lr: 0.0029932109846108317
epoch 14 training time: 15.036
---------------
2023-09-11 10:39:33.217717
current #epochs=15, #steps=560
start validation
acc: 0.815166
AUC: 0.904610
Avg Precision: 0.319145
Avg Recall: 1.000000
d_prime: 1.850177
train_loss: 0.070843
valid_loss: 1.043824
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0009977369948702772
Epoch-15 lr: 0.0029932109846108317
epoch 15 training time: 16.636
---------------
2023-09-11 10:39:49.853949
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03604	Per Sample Data Time 0.02819	Per Sample DNN Time 0.00786	Train Loss 0.1339	
start validation
acc: 0.805687
AUC: 0.896678
Avg Precision: 0.293834
Avg Recall: 1.000000
d_prime: 1.785935
train_loss: 0.077157
valid_loss: 1.045352
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0009244790830828218
Epoch-16 lr: 0.0027734372492484653
epoch 16 training time: 16.225
---------------
2023-09-11 10:40:06.078654
current #epochs=17, #steps=640
start validation
acc: 0.786730
AUC: 0.901343
Avg Precision: 0.301600
Avg Recall: 1.000000
d_prime: 1.823261
train_loss: 0.081968
valid_loss: 1.055378
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0009244790830828218
Epoch-17 lr: 0.0027734372492484653
epoch 17 training time: 15.991
---------------
2023-09-11 10:40:22.069566
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00560	Train Loss 0.0925	
start validation
acc: 0.800948
AUC: 0.900326
Avg Precision: 0.301998
Avg Recall: 1.000000
d_prime: 1.815020
train_loss: 0.094841
valid_loss: 1.041671
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0009244790830828218
Epoch-18 lr: 0.0027734372492484653
epoch 18 training time: 15.020
---------------
2023-09-11 10:40:37.089543
current #epochs=19, #steps=720
start validation
acc: 0.791469
AUC: 0.914963
Avg Precision: 0.348916
Avg Recall: 1.000000
d_prime: 1.940250
train_loss: 0.086808
valid_loss: 1.025300
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0009244790830828218
Epoch-19 lr: 0.0027734372492484653
epoch 19 training time: 14.962
---------------
2023-09-11 10:40:52.051888
current #epochs=20, #steps=760
start validation
acc: 0.791469
AUC: 0.902385
Avg Precision: 0.293124
Avg Recall: 1.000000
d_prime: 1.831773
train_loss: 0.070676
valid_loss: 1.043251
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0009244790830828218
Epoch-20 lr: 0.0027734372492484653
epoch 20 training time: 15.012
---------------
2023-09-11 10:41:07.063881
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03659	Per Sample Data Time 0.02933	Per Sample DNN Time 0.00726	Train Loss 0.0913	
start validation
acc: 0.805687
AUC: 0.895484
Avg Precision: 0.300325
Avg Recall: 1.000000
d_prime: 1.776582
train_loss: 0.097209
valid_loss: 1.058900
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0009244790830828218
Epoch-21 lr: 0.0027734372492484653
epoch 21 training time: 15.078
---------------
2023-09-11 10:41:22.142127
current #epochs=22, #steps=840
start validation
acc: 0.791469
AUC: 0.913624
Avg Precision: 0.314001
Avg Recall: 1.000000
d_prime: 1.928163
train_loss: 0.084256
valid_loss: 1.036882
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0008566000653997756
Epoch-22 lr: 0.0025698001961993264
epoch 22 training time: 14.993
---------------
2023-09-11 10:41:37.134892
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00565	Train Loss 0.0746	
start validation
acc: 0.815166
AUC: 0.917798
Avg Precision: 0.309031
Avg Recall: 1.000000
d_prime: 1.966337
train_loss: 0.072228
valid_loss: 1.029657
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0008566000653997756
Epoch-23 lr: 0.0025698001961993264
epoch 23 training time: 15.083
---------------
2023-09-11 10:41:52.218018
current #epochs=24, #steps=920
start validation
acc: 0.824645
AUC: 0.909549
Avg Precision: 0.297614
Avg Recall: 1.000000
d_prime: 1.892193
train_loss: 0.079772
valid_loss: 1.029496
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0008566000653997756
Epoch-24 lr: 0.0025698001961993264
epoch 24 training time: 17.545
---------------
2023-09-11 10:42:09.762796
current #epochs=25, #steps=960
start validation
acc: 0.824645
AUC: 0.912061
Avg Precision: 0.309338
Avg Recall: 1.000000
d_prime: 1.914218
train_loss: 0.084935
valid_loss: 1.033813
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0008566000653997756
Epoch-25 lr: 0.0025698001961993264
epoch 25 training time: 15.074
---------------
2023-09-11 10:42:24.836974
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03600	Per Sample Data Time 0.02881	Per Sample DNN Time 0.00719	Train Loss 0.1845	
start validation
acc: 0.805687
AUC: 0.921888
Avg Precision: 0.317326
Avg Recall: 1.000000
d_prime: 2.005198
train_loss: 0.069532
valid_loss: 1.035168
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0008566000653997756
Epoch-26 lr: 0.0025698001961993264
epoch 26 training time: 14.978
---------------
2023-09-11 10:42:39.814966
current #epochs=27, #steps=1040
start validation
acc: 0.777251
AUC: 0.909079
Avg Precision: 0.296096
Avg Recall: 1.000000
d_prime: 1.888123
train_loss: 0.072889
valid_loss: 1.037569
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0008566000653997756
Epoch-27 lr: 0.0025698001961993264
epoch 27 training time: 15.583
---------------
2023-09-11 10:42:55.397500
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00566	Train Loss 0.0761	
start validation
acc: 0.810427
AUC: 0.907444
Avg Precision: 0.295436
Avg Recall: 1.000000
d_prime: 1.874085
train_loss: 0.075834
valid_loss: 1.037081
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0007937050015193947
Epoch-28 lr: 0.0023811150045581837
epoch 28 training time: 15.118
---------------
2023-09-11 10:43:10.515510
current #epochs=29, #steps=1120
start validation
[I 2023-09-11 10:43:26,643] Trial 30 finished with value: 0.8246445497630331 and parameters: {'warmup': 'True', 'num_epochs': 29, 'batch_size': 52, 'lr-adaptschedule': 'False', 'lr': 0.0010768000370686473, 'head-lr': 3, 'lr-scheduler-start': 10, 'lr-scheduler-step': 6, 'lr-scheduler-decay': 0.9265759291635967}. Best is trial 13 with value: 0.8341232227488151.
acc: 0.805687
AUC: 0.905799
Avg Precision: 0.291131
Avg Recall: 1.000000
d_prime: 1.860145
train_loss: 0.068722
valid_loss: 1.031571
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0007937050015193947
Epoch-29 lr: 0.0023811150045581837
epoch 29 training time: 16.121
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f8644891df0>
The learning rate scheduler starts at 9 epoch with decay rate of 0.902 every 7 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 10:43:26.678599
current #epochs=1, #steps=0
start validation
acc: 0.772512
AUC: 0.915711
Avg Precision: 0.361369
Avg Recall: 1.000000
d_prime: 1.947072
train_loss: 0.108129
valid_loss: 1.046745
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0021147377255374598
Epoch-1 lr: 0.008458950902149839
epoch 1 training time: 17.574
---------------
2023-09-11 10:43:44.252932
current #epochs=2, #steps=40
start validation
acc: 0.796209
AUC: 0.895498
Avg Precision: 0.282478
Avg Recall: 1.000000
d_prime: 1.776689
train_loss: 0.101407
valid_loss: 1.037937
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0021147377255374598
Epoch-2 lr: 0.008458950902149839
epoch 2 training time: 18.356
---------------
2023-09-11 10:44:02.608860
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00554	Train Loss 0.1557	
start validation
acc: 0.824645
AUC: 0.909758
Avg Precision: 0.298835
Avg Recall: 1.000000
d_prime: 1.894011
train_loss: 0.127571
valid_loss: 1.033652
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0021147377255374598
Epoch-3 lr: 0.008458950902149839
epoch 3 training time: 17.390
---------------
2023-09-11 10:44:19.999090
current #epochs=4, #steps=120
start validation
acc: 0.819905
AUC: 0.910011
Avg Precision: 0.322668
Avg Recall: 1.000000
d_prime: 1.896213
train_loss: 0.068332
valid_loss: 1.038033
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0021147377255374598
Epoch-4 lr: 0.008458950902149839
epoch 4 training time: 15.066
---------------
2023-09-11 10:44:35.064571
current #epochs=5, #steps=160
start validation
acc: 0.796209
AUC: 0.913931
Avg Precision: 0.319610
Avg Recall: 1.000000
d_prime: 1.930915
train_loss: 0.111248
valid_loss: 1.033667
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0021147377255374598
Epoch-5 lr: 0.008458950902149839
epoch 5 training time: 14.940
---------------
2023-09-11 10:44:50.004369
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03889	Per Sample Data Time 0.02937	Per Sample DNN Time 0.00952	Train Loss 0.1586	
start validation
acc: 0.815166
AUC: 0.905154
Avg Precision: 0.329263
Avg Recall: 1.000000
d_prime: 1.854729
train_loss: 0.091844
valid_loss: 1.060879
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0021147377255374598
Epoch-6 lr: 0.008458950902149839
epoch 6 training time: 15.016
---------------
2023-09-11 10:45:05.019723
current #epochs=7, #steps=240
start validation
acc: 0.767773
AUC: 0.912199
Avg Precision: 0.361702
Avg Recall: 1.000000
d_prime: 1.915438
train_loss: 0.087617
valid_loss: 1.059225
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0021147377255374598
Epoch-7 lr: 0.008458950902149839
epoch 7 training time: 15.104
---------------
2023-09-11 10:45:20.124021
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00697	Per Sample Data Time 0.00143	Per Sample DNN Time 0.00554	Train Loss 0.0930	
start validation
acc: 0.819905
AUC: 0.907800
Avg Precision: 0.302345
Avg Recall: 1.000000
d_prime: 1.877124
train_loss: 0.095834
valid_loss: 1.036330
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0021147377255374598
Epoch-8 lr: 0.008458950902149839
epoch 8 training time: 14.896
---------------
2023-09-11 10:45:35.020413
current #epochs=9, #steps=320
start validation
acc: 0.777251
AUC: 0.894314
Avg Precision: 0.336296
Avg Recall: 1.000000
d_prime: 1.767487
train_loss: 0.106613
valid_loss: 1.059779
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0019079229708253425
Epoch-9 lr: 0.00763169188330137
epoch 9 training time: 14.924
---------------
2023-09-11 10:45:49.944406
current #epochs=10, #steps=360
start validation
acc: 0.819905
AUC: 0.906888
Avg Precision: 0.336984
Avg Recall: 1.000000
d_prime: 1.869355
train_loss: 0.096333
valid_loss: 1.047136
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0019079229708253425
Epoch-10 lr: 0.00763169188330137
epoch 10 training time: 15.167
---------------
2023-09-11 10:46:05.111243
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03623	Per Sample Data Time 0.02901	Per Sample DNN Time 0.00722	Train Loss 0.0678	
start validation
acc: 0.791469
AUC: 0.911289
Avg Precision: 0.326107
Avg Recall: 1.000000
d_prime: 1.907398
train_loss: 0.103456
valid_loss: 1.052991
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0019079229708253425
Epoch-11 lr: 0.00763169188330137
epoch 11 training time: 16.245
---------------
2023-09-11 10:46:21.356048
current #epochs=12, #steps=440
start validation
acc: 0.777251
AUC: 0.903372
Avg Precision: 0.323751
Avg Recall: 1.000000
d_prime: 1.839904
train_loss: 0.107526
valid_loss: 1.049212
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0019079229708253425
Epoch-12 lr: 0.00763169188330137
epoch 12 training time: 16.734
---------------
2023-09-11 10:46:38.090445
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00562	Train Loss 0.1258	
start validation
acc: 0.800948
AUC: 0.908092
Avg Precision: 0.313179
Avg Recall: 1.000000
d_prime: 1.879624
train_loss: 0.126395
valid_loss: 1.047607
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0019079229708253425
Epoch-13 lr: 0.00763169188330137
epoch 13 training time: 15.016
---------------
2023-09-11 10:46:53.106858
current #epochs=14, #steps=520
start validation
acc: 0.796209
AUC: 0.911665
Avg Precision: 0.330944
Avg Recall: 1.000000
d_prime: 1.910717
train_loss: 0.090626
valid_loss: 1.038650
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0019079229708253425
Epoch-14 lr: 0.00763169188330137
epoch 14 training time: 14.928
---------------
2023-09-11 10:47:08.034709
current #epochs=15, #steps=560
start validation
acc: 0.815166
AUC: 0.911238
Avg Precision: 0.284194
Avg Recall: 1.000000
d_prime: 1.906954
train_loss: 0.095170
valid_loss: 1.035091
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0019079229708253425
Epoch-15 lr: 0.00763169188330137
epoch 15 training time: 14.981
---------------
2023-09-11 10:47:23.015313
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03637	Per Sample Data Time 0.02767	Per Sample DNN Time 0.00870	Train Loss 0.0270	
start validation
acc: 0.791469
AUC: 0.906485
Avg Precision: 0.306415
Avg Recall: 1.000000
d_prime: 1.865938
train_loss: 0.088362
valid_loss: 1.042671
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0017213340541687519
Epoch-16 lr: 0.0068853362166750075
epoch 16 training time: 14.988
---------------
2023-09-11 10:47:38.003192
current #epochs=17, #steps=640
start validation
acc: 0.781991
AUC: 0.918458
Avg Precision: 0.311745
Avg Recall: 1.000000
d_prime: 1.972505
train_loss: 0.111046
valid_loss: 1.029030
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0017213340541687519
Epoch-17 lr: 0.0068853362166750075
epoch 17 training time: 16.092
---------------
2023-09-11 10:47:54.095556
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00558	Train Loss 0.0985	
start validation
acc: 0.810427
AUC: 0.899306
Avg Precision: 0.303108
Avg Recall: 1.000000
d_prime: 1.806807
train_loss: 0.104059
valid_loss: 1.054378
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0017213340541687519
Epoch-18 lr: 0.0068853362166750075
epoch 18 training time: 14.974
---------------
2023-09-11 10:48:09.069886
current #epochs=19, #steps=720
start validation
acc: 0.819905
AUC: 0.902738
Avg Precision: 0.302085
Avg Recall: 1.000000
d_prime: 1.834676
train_loss: 0.108178
valid_loss: 1.049006
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0017213340541687519
Epoch-19 lr: 0.0068853362166750075
epoch 19 training time: 16.179
---------------
2023-09-11 10:48:25.248694
current #epochs=20, #steps=760
start validation
acc: 0.805687
AUC: 0.910658
Avg Precision: 0.317534
Avg Recall: 1.000000
d_prime: 1.901856
train_loss: 0.071296
valid_loss: 1.031664
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0017213340541687519
Epoch-20 lr: 0.0068853362166750075
epoch 20 training time: 15.007
---------------
2023-09-11 10:48:40.255407
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03616	Per Sample Data Time 0.02969	Per Sample DNN Time 0.00647	Train Loss 0.0065	
start validation
acc: 0.796209
AUC: 0.887142
Avg Precision: 0.284088
Avg Recall: 1.000000
d_prime: 1.713277
train_loss: 0.082129
valid_loss: 1.045964
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0017213340541687519
Epoch-21 lr: 0.0068853362166750075
epoch 21 training time: 14.978
---------------
2023-09-11 10:48:55.233542
current #epochs=22, #steps=840
start validation
acc: 0.800948
AUC: 0.901516
Avg Precision: 0.301263
Avg Recall: 1.000000
d_prime: 1.824671
train_loss: 0.073314
valid_loss: 1.041086
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0017213340541687519
Epoch-22 lr: 0.0068853362166750075
epoch 22 training time: 17.570
---------------
2023-09-11 10:49:12.803940
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00560	Train Loss 0.0786	
start validation
acc: 0.791469
AUC: 0.897268
Avg Precision: 0.297346
Avg Recall: 1.000000
d_prime: 1.790587
train_loss: 0.091143
valid_loss: 1.054792
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0015529929516804762
Epoch-23 lr: 0.006211971806721905
epoch 23 training time: 15.124
---------------
2023-09-11 10:49:27.927901
current #epochs=24, #steps=920
start validation
acc: 0.791469
AUC: 0.897449
Avg Precision: 0.300539
Avg Recall: 1.000000
d_prime: 1.792023
train_loss: 0.101476
valid_loss: 1.050553
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0015529929516804762
Epoch-24 lr: 0.006211971806721905
epoch 24 training time: 15.030
---------------
2023-09-11 10:49:42.958408
current #epochs=25, #steps=960
start validation
acc: 0.815166
AUC: 0.893379
Avg Precision: 0.297269
Avg Recall: 1.000000
d_prime: 1.760269
train_loss: 0.077945
valid_loss: 1.037354
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0015529929516804762
Epoch-25 lr: 0.006211971806721905
epoch 25 training time: 17.536
---------------
2023-09-11 10:50:00.494898
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03496	Per Sample Data Time 0.02782	Per Sample DNN Time 0.00713	Train Loss 0.0184	
start validation
acc: 0.819905
AUC: 0.892545
Avg Precision: 0.290402
Avg Recall: 1.000000
d_prime: 1.753878
train_loss: 0.084498
valid_loss: 1.041959
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0015529929516804762
Epoch-26 lr: 0.006211971806721905
epoch 26 training time: 15.167
---------------
2023-09-11 10:50:15.662053
current #epochs=27, #steps=1040
start validation
acc: 0.815166
AUC: 0.899179
Avg Precision: 0.290250
Avg Recall: 1.000000
d_prime: 1.805793
train_loss: 0.082860
valid_loss: 1.040913
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0015529929516804762
Epoch-27 lr: 0.006211971806721905
epoch 27 training time: 14.932
---------------
2023-09-11 10:50:30.594169
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00566	Train Loss 0.0745	
start validation
acc: 0.815166
AUC: 0.909075
Avg Precision: 0.292362
Avg Recall: 1.000000
d_prime: 1.888091
train_loss: 0.079964
valid_loss: 1.029901
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0015529929516804762
Epoch-28 lr: 0.006211971806721905
epoch 28 training time: 15.310
---------------
2023-09-11 10:50:45.904223
current #epochs=29, #steps=1120
start validation
acc: 0.815166
AUC: 0.913829
Avg Precision: 0.308493
Avg Recall: 1.000000
d_prime: 1.930005
train_loss: 0.086634
valid_loss: 1.033112
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0015529929516804762
Epoch-29 lr: 0.006211971806721905
epoch 29 training time: 16.908
---------------
2023-09-11 10:51:02.812415
current #epochs=30, #steps=1160
start validation
acc: 0.824645
AUC: 0.907808
Avg Precision: 0.313993
Avg Recall: 1.000000
d_prime: 1.877194
train_loss: 0.075473
valid_loss: 1.045566
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.001401115084040972
Epoch-30 lr: 0.005604460336163888
epoch 30 training time: 15.025
---------------
2023-09-11 10:51:17.837296
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03890	Per Sample Data Time 0.02822	Per Sample DNN Time 0.01068	Train Loss 0.0832	
start validation
acc: 0.796209
AUC: 0.915578
Avg Precision: 0.314815
Avg Recall: 1.000000
d_prime: 1.945857
train_loss: 0.094501
valid_loss: 1.034117
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.001401115084040972
Epoch-31 lr: 0.005604460336163888
epoch 31 training time: 15.084
---------------
2023-09-11 10:51:32.921536
current #epochs=32, #steps=1240
start validation
[I 2023-09-11 10:51:47,952] Trial 31 finished with value: 0.8246445497630331 and parameters: {'warmup': 'True', 'num_epochs': 32, 'batch_size': 52, 'lr-adaptschedule': 'False', 'lr': 0.0021147377255374598, 'head-lr': 4, 'lr-scheduler-start': 9, 'lr-scheduler-step': 7, 'lr-scheduler-decay': 0.9022031185169521}. Best is trial 13 with value: 0.8341232227488151.
acc: 0.815166
AUC: 0.910690
Avg Precision: 0.299085
Avg Recall: 1.000000
d_prime: 1.902138
train_loss: 0.092233
valid_loss: 1.046807
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.001401115084040972
Epoch-32 lr: 0.005604460336163888
epoch 32 training time: 15.025
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f8644888970>
The learning rate scheduler starts at 9 epoch with decay rate of 0.950 every 8 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 10:51:47.986837
current #epochs=1, #steps=0
start validation
acc: 0.805687
AUC: 0.918918
Avg Precision: 0.340173
Avg Recall: 1.000000
d_prime: 1.976830
train_loss: 0.133898
valid_loss: 1.012214
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0022697387543598314
Epoch-1 lr: 0.009078955017439326
epoch 1 training time: 16.969
---------------
2023-09-11 10:52:04.955870
current #epochs=2, #steps=40
start validation
acc: 0.800948
AUC: 0.896960
Avg Precision: 0.299913
Avg Recall: 1.000000
d_prime: 1.788161
train_loss: 0.139181
valid_loss: 1.032184
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0022697387543598314
Epoch-2 lr: 0.009078955017439326
epoch 2 training time: 15.237
---------------
2023-09-11 10:52:20.192999
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00699	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00552	Train Loss 0.0749	
start validation
acc: 0.805687
AUC: 0.905277
Avg Precision: 0.300667
Avg Recall: 1.000000
d_prime: 1.855758
train_loss: 0.087760
valid_loss: 1.027738
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0022697387543598314
Epoch-3 lr: 0.009078955017439326
epoch 3 training time: 15.957
---------------
2023-09-11 10:52:36.150247
current #epochs=4, #steps=120
start validation
acc: 0.805687
AUC: 0.896586
Avg Precision: 0.316519
Avg Recall: 1.000000
d_prime: 1.785215
train_loss: 0.091836
valid_loss: 1.049409
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0022697387543598314
Epoch-4 lr: 0.009078955017439326
epoch 4 training time: 15.959
---------------
2023-09-11 10:52:52.109668
current #epochs=5, #steps=160
start validation
acc: 0.796209
AUC: 0.896145
Avg Precision: 0.294328
Avg Recall: 1.000000
d_prime: 1.781748
train_loss: 0.103668
valid_loss: 1.041129
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0022697387543598314
Epoch-5 lr: 0.009078955017439326
epoch 5 training time: 16.435
---------------
2023-09-11 10:53:08.545076
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03537	Per Sample Data Time 0.02782	Per Sample DNN Time 0.00754	Train Loss 0.0792	
start validation
acc: 0.786730
AUC: 0.894808
Avg Precision: 0.312606
Avg Recall: 1.000000
d_prime: 1.771316
train_loss: 0.092101
valid_loss: 1.031167
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0022697387543598314
Epoch-6 lr: 0.009078955017439326
epoch 6 training time: 15.932
---------------
2023-09-11 10:53:24.476990
current #epochs=7, #steps=240
start validation
acc: 0.805687
AUC: 0.903656
Avg Precision: 0.312623
Avg Recall: 1.000000
d_prime: 1.842253
train_loss: 0.087548
valid_loss: 1.035392
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0022697387543598314
Epoch-7 lr: 0.009078955017439326
epoch 7 training time: 15.013
---------------
2023-09-11 10:53:39.489582
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00557	Train Loss 0.0829	
start validation
acc: 0.829384
AUC: 0.898787
Avg Precision: 0.304681
Avg Recall: 1.000000
d_prime: 1.802654
train_loss: 0.085855
valid_loss: 1.019453
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0022697387543598314
Epoch-8 lr: 0.009078955017439326
epoch 8 training time: 16.939
---------------
2023-09-11 10:53:56.428308
current #epochs=9, #steps=320
start validation
acc: 0.829384
AUC: 0.903032
Avg Precision: 0.295123
Avg Recall: 1.000000
d_prime: 1.837095
train_loss: 0.089688
valid_loss: 1.025755
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0021559531141131165
Epoch-9 lr: 0.008623812456452466
epoch 9 training time: 16.707
---------------
2023-09-11 10:54:13.135500
current #epochs=10, #steps=360
start validation
acc: 0.810427
AUC: 0.892538
Avg Precision: 0.303323
Avg Recall: 1.000000
d_prime: 1.753822
train_loss: 0.118027
valid_loss: 1.049652
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0021559531141131165
Epoch-10 lr: 0.008623812456452466
epoch 10 training time: 15.035
---------------
2023-09-11 10:54:28.170093
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03745	Per Sample Data Time 0.02709	Per Sample DNN Time 0.01036	Train Loss 0.8185	
start validation
acc: 0.796209
AUC: 0.891002
Avg Precision: 0.303286
Avg Recall: 1.000000
d_prime: 1.742132
train_loss: 0.106202
valid_loss: 1.041691
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0021559531141131165
Epoch-11 lr: 0.008623812456452466
epoch 11 training time: 16.231
---------------
2023-09-11 10:54:44.400995
current #epochs=12, #steps=440
start validation
acc: 0.829384
AUC: 0.902287
Avg Precision: 0.307528
Avg Recall: 1.000000
d_prime: 1.830969
train_loss: 0.114954
valid_loss: 1.035244
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0021559531141131165
Epoch-12 lr: 0.008623812456452466
epoch 12 training time: 15.593
---------------
2023-09-11 10:54:59.993985
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00560	Train Loss 0.0985	
start validation
acc: 0.791469
AUC: 0.880213
Avg Precision: 0.287357
Avg Recall: 1.000000
d_prime: 1.663192
train_loss: 0.099138
valid_loss: 1.060238
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0021559531141131165
Epoch-13 lr: 0.008623812456452466
epoch 13 training time: 14.967
---------------
2023-09-11 10:55:14.961377
current #epochs=14, #steps=520
start validation
acc: 0.815166
AUC: 0.910191
Avg Precision: 0.324145
Avg Recall: 1.000000
d_prime: 1.897781
train_loss: 0.088930
valid_loss: 1.039063
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0021559531141131165
Epoch-14 lr: 0.008623812456452466
epoch 14 training time: 16.238
---------------
2023-09-11 10:55:31.199333
current #epochs=15, #steps=560
start validation
acc: 0.786730
AUC: 0.917794
Avg Precision: 0.330192
Avg Recall: 1.000000
d_prime: 1.966297
train_loss: 0.076433
valid_loss: 1.037801
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0021559531141131165
Epoch-15 lr: 0.008623812456452466
epoch 15 training time: 16.372
---------------
2023-09-11 10:55:47.571920
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03495	Per Sample Data Time 0.02845	Per Sample DNN Time 0.00650	Train Loss 0.0436	
start validation
acc: 0.800948
AUC: 0.904754
Avg Precision: 0.306410
Avg Recall: 1.000000
d_prime: 1.851381
train_loss: 0.096206
valid_loss: 1.039809
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0021559531141131165
Epoch-16 lr: 0.008623812456452466
epoch 16 training time: 14.983
---------------
2023-09-11 10:56:02.555088
current #epochs=17, #steps=640
start validation
acc: 0.815166
AUC: 0.900318
Avg Precision: 0.298691
Avg Recall: 1.000000
d_prime: 1.814950
train_loss: 0.109581
valid_loss: 1.038278
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.002047871730315072
Epoch-17 lr: 0.008191486921260288
epoch 17 training time: 16.097
---------------
2023-09-11 10:56:18.652162
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00701	Per Sample Data Time 0.00142	Per Sample DNN Time 0.00560	Train Loss 0.1085	
start validation
acc: 0.810427
AUC: 0.920342
Avg Precision: 0.302180
Avg Recall: 1.000000
d_prime: 1.990332
train_loss: 0.105292
valid_loss: 1.030769
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.002047871730315072
Epoch-18 lr: 0.008191486921260288
epoch 18 training time: 14.937
---------------
2023-09-11 10:56:33.589480
current #epochs=19, #steps=720
start validation
acc: 0.824645
AUC: 0.904939
Avg Precision: 0.298791
Avg Recall: 1.000000
d_prime: 1.852925
train_loss: 0.082510
valid_loss: 1.051988
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.002047871730315072
Epoch-19 lr: 0.008191486921260288
epoch 19 training time: 17.886
---------------
2023-09-11 10:56:51.475648
current #epochs=20, #steps=760
start validation
acc: 0.796209
AUC: 0.893870
Avg Precision: 0.293160
Avg Recall: 1.000000
d_prime: 1.764051
train_loss: 0.101886
valid_loss: 1.044152
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.002047871730315072
Epoch-20 lr: 0.008191486921260288
epoch 20 training time: 15.083
---------------
2023-09-11 10:57:06.558345
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03376	Per Sample Data Time 0.02699	Per Sample DNN Time 0.00677	Train Loss 0.0550	
start validation
acc: 0.810427
AUC: 0.903043
Avg Precision: 0.299030
Avg Recall: 1.000000
d_prime: 1.837183
train_loss: 0.082731
valid_loss: 1.040460
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.002047871730315072
Epoch-21 lr: 0.008191486921260288
epoch 21 training time: 14.915
---------------
2023-09-11 10:57:21.473654
current #epochs=22, #steps=840
start validation
acc: 0.805687
AUC: 0.910454
Avg Precision: 0.322905
Avg Recall: 1.000000
d_prime: 1.900078
train_loss: 0.131655
valid_loss: 1.034177
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.002047871730315072
Epoch-22 lr: 0.008191486921260288
epoch 22 training time: 15.022
---------------
2023-09-11 10:57:36.495271
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00556	Train Loss 0.0658	
start validation
acc: 0.791469
AUC: 0.904621
Avg Precision: 0.309466
Avg Recall: 1.000000
d_prime: 1.850272
train_loss: 0.108482
valid_loss: 1.046469
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.002047871730315072
Epoch-23 lr: 0.008191486921260288
epoch 23 training time: 16.138
---------------
2023-09-11 10:57:52.633515
current #epochs=24, #steps=920
start validation
acc: 0.805687
AUC: 0.927438
Avg Precision: 0.342132
Avg Recall: 1.000000
d_prime: 2.060467
train_loss: 0.091109
valid_loss: 1.033249
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.002047871730315072
Epoch-24 lr: 0.008191486921260288
epoch 24 training time: 16.209
---------------
2023-09-11 10:58:08.842703
current #epochs=25, #steps=960
start validation
acc: 0.810427
AUC: 0.922130
Avg Precision: 0.320574
Avg Recall: 1.000000
d_prime: 2.007539
train_loss: 0.110571
valid_loss: 1.038960
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0019452086394507798
Epoch-25 lr: 0.007780834557803119
epoch 25 training time: 15.046
---------------
2023-09-11 10:58:23.888926
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03797	Per Sample Data Time 0.02910	Per Sample DNN Time 0.00887	Train Loss 0.1679	
start validation
acc: 0.815166
AUC: 0.917399
Avg Precision: 0.303557
Avg Recall: 1.000000
d_prime: 1.962628
train_loss: 0.085436
valid_loss: 1.024250
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0019452086394507798
Epoch-26 lr: 0.007780834557803119
epoch 26 training time: 15.925
---------------
2023-09-11 10:58:39.814125
current #epochs=27, #steps=1040
start validation
acc: 0.815166
AUC: 0.925740
Avg Precision: 0.318287
Avg Recall: 1.000000
d_prime: 2.043226
train_loss: 0.090762
valid_loss: 1.010651
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0019452086394507798
Epoch-27 lr: 0.007780834557803119
epoch 27 training time: 15.062
---------------
2023-09-11 10:58:54.876526
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00560	Train Loss 0.1089	
start validation
[I 2023-09-11 10:59:10,704] Trial 32 finished with value: 0.8293838862559242 and parameters: {'warmup': 'True', 'num_epochs': 28, 'batch_size': 47, 'lr-adaptschedule': 'False', 'lr': 0.0022697387543598314, 'head-lr': 4, 'lr-scheduler-start': 9, 'lr-scheduler-step': 8, 'lr-scheduler-decay': 0.9498683978373503}. Best is trial 13 with value: 0.8341232227488151.
acc: 0.810427
AUC: 0.907421
Avg Precision: 0.306257
Avg Recall: 1.000000
d_prime: 1.873889
train_loss: 0.093098
valid_loss: 1.028675
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0019452086394507798
Epoch-28 lr: 0.007780834557803119
epoch 28 training time: 15.821
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f85b52a6bb0>
The learning rate scheduler starts at 10 epoch with decay rate of 0.912 every 7 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 10:59:10.738415
current #epochs=1, #steps=0
start validation
acc: 0.810427
AUC: 0.911690
Avg Precision: 0.303418
Avg Recall: 1.000000
d_prime: 1.910932
train_loss: 0.110692
valid_loss: 1.018227
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0019513484921425998
Epoch-1 lr: 0.0039026969842851996
epoch 1 training time: 17.298
---------------
2023-09-11 10:59:28.036577
current #epochs=2, #steps=40
start validation
acc: 0.800948
AUC: 0.904604
Avg Precision: 0.316505
Avg Recall: 1.000000
d_prime: 1.850132
train_loss: 0.110008
valid_loss: 1.017887
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0019513484921425998
Epoch-2 lr: 0.0039026969842851996
epoch 2 training time: 15.082
---------------
2023-09-11 10:59:43.118825
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00555	Train Loss 0.0981	
start validation
acc: 0.810427
AUC: 0.912569
Avg Precision: 0.317514
Avg Recall: 1.000000
d_prime: 1.918729
train_loss: 0.095980
valid_loss: 1.016489
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0019513484921425998
Epoch-3 lr: 0.0039026969842851996
epoch 3 training time: 16.326
---------------
2023-09-11 10:59:59.444649
current #epochs=4, #steps=120
start validation
acc: 0.800948
AUC: 0.915305
Avg Precision: 0.305877
Avg Recall: 1.000000
d_prime: 1.943361
train_loss: 0.079540
valid_loss: 1.023178
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0019513484921425998
Epoch-4 lr: 0.0039026969842851996
epoch 4 training time: 15.120
---------------
2023-09-11 11:00:14.565050
current #epochs=5, #steps=160
start validation
acc: 0.810427
AUC: 0.912458
Avg Precision: 0.300200
Avg Recall: 1.000000
d_prime: 1.917744
train_loss: 0.083654
valid_loss: 1.021834
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0019513484921425998
Epoch-5 lr: 0.0039026969842851996
epoch 5 training time: 15.233
---------------
2023-09-11 11:00:29.798031
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03659	Per Sample Data Time 0.02946	Per Sample DNN Time 0.00713	Train Loss 0.0663	
start validation
acc: 0.815166
AUC: 0.913178
Avg Precision: 0.296733
Avg Recall: 1.000000
d_prime: 1.924159
train_loss: 0.099449
valid_loss: 1.032717
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0019513484921425998
Epoch-6 lr: 0.0039026969842851996
epoch 6 training time: 17.125
---------------
2023-09-11 11:00:46.923051
current #epochs=7, #steps=240
start validation
acc: 0.824645
AUC: 0.905761
Avg Precision: 0.304196
Avg Recall: 1.000000
d_prime: 1.859827
train_loss: 0.090961
valid_loss: 1.032112
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0019513484921425998
Epoch-7 lr: 0.0039026969842851996
epoch 7 training time: 16.949
---------------
2023-09-11 11:01:03.872468
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00703	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00557	Train Loss 0.0731	
start validation
acc: 0.834123
AUC: 0.928030
Avg Precision: 0.336926
Avg Recall: 1.000000
d_prime: 2.066552
train_loss: 0.071100
valid_loss: 1.001888
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0019513484921425998
Epoch-8 lr: 0.0039026969842851996
epoch 8 training time: 17.015
---------------
2023-09-11 11:01:20.887482
current #epochs=9, #steps=320
start validation
acc: 0.815166
AUC: 0.925330
Avg Precision: 0.313699
Avg Recall: 1.000000
d_prime: 2.039108
train_loss: 0.104040
valid_loss: 1.011407
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0019513484921425998
Epoch-9 lr: 0.0039026969842851996
epoch 9 training time: 15.018
---------------
2023-09-11 11:01:35.905389
current #epochs=10, #steps=360
start validation
acc: 0.829384
AUC: 0.919497
Avg Precision: 0.312011
Avg Recall: 1.000000
d_prime: 1.982298
train_loss: 0.101842
valid_loss: 1.032035
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0017797025355817738
Epoch-10 lr: 0.0035594050711635476
epoch 10 training time: 15.059
---------------
2023-09-11 11:01:50.963781
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03568	Per Sample Data Time 0.02747	Per Sample DNN Time 0.00820	Train Loss 0.2677	
start validation
acc: 0.796209
AUC: 0.932094
Avg Precision: 0.331003
Avg Recall: 1.000000
d_prime: 2.109398
train_loss: 0.097177
valid_loss: 1.009146
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0017797025355817738
Epoch-11 lr: 0.0035594050711635476
epoch 11 training time: 15.095
---------------
2023-09-11 11:02:06.058717
current #epochs=12, #steps=440
start validation
acc: 0.838863
AUC: 0.916428
Avg Precision: 0.324319
Avg Recall: 1.000000
d_prime: 1.953647
train_loss: 0.091463
valid_loss: 1.030118
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0017797025355817738
Epoch-12 lr: 0.0035594050711635476
epoch 12 training time: 17.155
---------------
2023-09-11 11:02:23.213853
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00701	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00552	Train Loss 0.0860	
start validation
acc: 0.838863
AUC: 0.915920
Avg Precision: 0.317672
Avg Recall: 1.000000
d_prime: 1.948986
train_loss: 0.083137
valid_loss: 1.022323
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0017797025355817738
Epoch-13 lr: 0.0035594050711635476
epoch 13 training time: 15.949
---------------
2023-09-11 11:02:39.163451
current #epochs=14, #steps=520
start validation
acc: 0.796209
AUC: 0.919633
Avg Precision: 0.321893
Avg Recall: 1.000000
d_prime: 1.983590
train_loss: 0.057888
valid_loss: 1.013298
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0017797025355817738
Epoch-14 lr: 0.0035594050711635476
epoch 14 training time: 15.016
---------------
2023-09-11 11:02:54.179484
current #epochs=15, #steps=560
start validation
acc: 0.810427
AUC: 0.925376
Avg Precision: 0.341756
Avg Recall: 1.000000
d_prime: 2.039573
train_loss: 0.084390
valid_loss: 1.016113
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0017797025355817738
Epoch-15 lr: 0.0035594050711635476
epoch 15 training time: 14.951
---------------
2023-09-11 11:03:09.130068
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03526	Per Sample Data Time 0.02819	Per Sample DNN Time 0.00707	Train Loss 0.0370	
start validation
acc: 0.786730
AUC: 0.918205
Avg Precision: 0.324653
Avg Recall: 1.000000
d_prime: 1.970137
train_loss: 0.091370
valid_loss: 1.029176
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0017797025355817738
Epoch-16 lr: 0.0035594050711635476
epoch 16 training time: 15.057
---------------
2023-09-11 11:03:24.187413
current #epochs=17, #steps=640
start validation
acc: 0.805687
AUC: 0.917719
Avg Precision: 0.315236
Avg Recall: 1.000000
d_prime: 1.965600
train_loss: 0.085717
valid_loss: 1.025548
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.001623155027361834
Epoch-17 lr: 0.003246310054723668
epoch 17 training time: 16.350
---------------
2023-09-11 11:03:40.537800
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00703	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00557	Train Loss 0.0989	
start validation
acc: 0.819905
AUC: 0.919149
Avg Precision: 0.307612
Avg Recall: 1.000000
d_prime: 1.979011
train_loss: 0.092022
valid_loss: 1.033808
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001623155027361834
Epoch-18 lr: 0.003246310054723668
epoch 18 training time: 15.447
---------------
2023-09-11 11:03:55.984883
current #epochs=19, #steps=720
start validation
acc: 0.834123
AUC: 0.921679
Avg Precision: 0.311298
Avg Recall: 1.000000
d_prime: 2.003170
train_loss: 0.084110
valid_loss: 1.017637
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.001623155027361834
Epoch-19 lr: 0.003246310054723668
epoch 19 training time: 15.023
---------------
2023-09-11 11:04:11.007828
current #epochs=20, #steps=760
start validation
acc: 0.810427
AUC: 0.920620
Avg Precision: 0.309536
Avg Recall: 1.000000
d_prime: 1.992983
train_loss: 0.074149
valid_loss: 1.013105
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.001623155027361834
Epoch-20 lr: 0.003246310054723668
epoch 20 training time: 15.007
---------------
2023-09-11 11:04:26.015074
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03605	Per Sample Data Time 0.02954	Per Sample DNN Time 0.00652	Train Loss 0.0623	
start validation
acc: 0.815166
AUC: 0.924591
Avg Precision: 0.303490
Avg Recall: 1.000000
d_prime: 2.031732
train_loss: 0.065785
valid_loss: 1.022143
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.001623155027361834
Epoch-21 lr: 0.003246310054723668
epoch 21 training time: 14.985
---------------
2023-09-11 11:04:40.999624
current #epochs=22, #steps=840
start validation
acc: 0.824645
AUC: 0.932556
Avg Precision: 0.339054
Avg Recall: 1.000000
d_prime: 2.114395
train_loss: 0.087572
valid_loss: 1.018399
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.001623155027361834
Epoch-22 lr: 0.003246310054723668
epoch 22 training time: 15.044
---------------
2023-09-11 11:04:56.043513
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00560	Train Loss 0.0842	
start validation
acc: 0.819905
AUC: 0.922738
Avg Precision: 0.334062
Avg Recall: 1.000000
d_prime: 2.013462
train_loss: 0.064886
valid_loss: 1.008792
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.001623155027361834
Epoch-23 lr: 0.003246310054723668
epoch 23 training time: 15.058
---------------
2023-09-11 11:05:11.101826
current #epochs=24, #steps=920
start validation
acc: 0.805687
AUC: 0.927203
Avg Precision: 0.340996
Avg Recall: 1.000000
d_prime: 2.058066
train_loss: 0.085810
valid_loss: 1.002680
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0014803778666240709
Epoch-24 lr: 0.0029607557332481417
epoch 24 training time: 14.999
---------------
2023-09-11 11:05:26.100460
current #epochs=25, #steps=960
start validation
acc: 0.800948
AUC: 0.915946
Avg Precision: 0.304703
Avg Recall: 1.000000
d_prime: 1.949227
train_loss: 0.102099
valid_loss: 1.034043
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0014803778666240709
Epoch-25 lr: 0.0029607557332481417
epoch 25 training time: 15.050
---------------
2023-09-11 11:05:41.150423
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03501	Per Sample Data Time 0.02728	Per Sample DNN Time 0.00773	Train Loss 0.1705	
start validation
acc: 0.810427
AUC: 0.930695
Avg Precision: 0.356430
Avg Recall: 1.000000
d_prime: 2.094434
train_loss: 0.088150
valid_loss: 1.010230
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0014803778666240709
Epoch-26 lr: 0.0029607557332481417
epoch 26 training time: 14.952
---------------
2023-09-11 11:05:56.102657
current #epochs=27, #steps=1040
start validation
acc: 0.805687
AUC: 0.930336
Avg Precision: 0.322395
Avg Recall: 1.000000
d_prime: 2.090631
train_loss: 0.078788
valid_loss: 1.016073
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0014803778666240709
Epoch-27 lr: 0.0029607557332481417
epoch 27 training time: 15.519
---------------
2023-09-11 11:06:11.621411
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00565	Train Loss 0.0696	
start validation
acc: 0.834123
AUC: 0.924135
Avg Precision: 0.312653
Avg Recall: 1.000000
d_prime: 2.027205
train_loss: 0.062703
valid_loss: 1.017759
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0014803778666240709
Epoch-28 lr: 0.0029607557332481417
epoch 28 training time: 15.140
---------------
2023-09-11 11:06:26.761315
current #epochs=29, #steps=1120
start validation
acc: 0.800948
AUC: 0.929606
Avg Precision: 0.321467
Avg Recall: 1.000000
d_prime: 2.082942
train_loss: 0.081530
valid_loss: 1.023097
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0014803778666240709
Epoch-29 lr: 0.0029607557332481417
epoch 29 training time: 17.003
---------------
2023-09-11 11:06:43.764523
current #epochs=30, #steps=1160
start validation
acc: 0.815166
AUC: 0.928302
Avg Precision: 0.318284
Avg Recall: 1.000000
d_prime: 2.069363
train_loss: 0.080696
valid_loss: 1.010023
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0014803778666240709
Epoch-30 lr: 0.0029607557332481417
epoch 30 training time: 16.303
---------------
2023-09-11 11:07:00.067830
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03853	Per Sample Data Time 0.02810	Per Sample DNN Time 0.01043	Train Loss 0.1271	
start validation
acc: 0.815166
AUC: 0.923623
Avg Precision: 0.321114
Avg Recall: 1.000000
d_prime: 2.022142
train_loss: 0.064638
valid_loss: 1.010568
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0013501597758979196
Epoch-31 lr: 0.002700319551795839
epoch 31 training time: 15.161
---------------
2023-09-11 11:07:15.228590
current #epochs=32, #steps=1240
start validation
[I 2023-09-11 11:07:30,306] Trial 33 finished with value: 0.8388625592417062 and parameters: {'warmup': 'True', 'num_epochs': 32, 'batch_size': 60, 'lr-adaptschedule': 'False', 'lr': 0.0019513484921425998, 'head-lr': 2, 'lr-scheduler-start': 10, 'lr-scheduler-step': 7, 'lr-scheduler-decay': 0.9120372617951205}. Best is trial 33 with value: 0.8388625592417062.
acc: 0.791469
AUC: 0.927231
Avg Precision: 0.314828
Avg Recall: 1.000000
d_prime: 2.058356
train_loss: 0.073377
valid_loss: 0.998167
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0013501597758979196
Epoch-32 lr: 0.002700319551795839
epoch 32 training time: 15.071
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f86448887c0>
The learning rate scheduler starts at 10 epoch with decay rate of 0.885 every 8 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 11:07:30.341413
current #epochs=1, #steps=0
start validation
acc: 0.829384
AUC: 0.912612
Avg Precision: 0.308748
Avg Recall: 1.000000
d_prime: 1.919109
train_loss: 0.098713
valid_loss: 1.026696
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0018228742702551162
Epoch-1 lr: 0.0036457485405102324
epoch 1 training time: 16.913
---------------
2023-09-11 11:07:47.254452
current #epochs=2, #steps=40
start validation
acc: 0.786730
AUC: 0.904650
Avg Precision: 0.299744
Avg Recall: 1.000000
d_prime: 1.850518
train_loss: 0.087184
valid_loss: 1.034963
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0018228742702551162
Epoch-2 lr: 0.0036457485405102324
epoch 2 training time: 15.183
---------------
2023-09-11 11:08:02.438207
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00701	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00549	Train Loss 0.1035	
start validation
acc: 0.819905
AUC: 0.921473
Avg Precision: 0.303985
Avg Recall: 1.000000
d_prime: 2.001184
train_loss: 0.092248
valid_loss: 1.036385
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0018228742702551162
Epoch-3 lr: 0.0036457485405102324
epoch 3 training time: 15.040
---------------
2023-09-11 11:08:17.477861
current #epochs=4, #steps=120
start validation
acc: 0.810427
AUC: 0.921565
Avg Precision: 0.330780
Avg Recall: 1.000000
d_prime: 2.002075
train_loss: 0.095750
valid_loss: 1.027261
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0018228742702551162
Epoch-4 lr: 0.0036457485405102324
epoch 4 training time: 15.968
---------------
2023-09-11 11:08:33.445780
current #epochs=5, #steps=160
start validation
acc: 0.815166
AUC: 0.920457
Avg Precision: 0.334690
Avg Recall: 1.000000
d_prime: 1.991430
train_loss: 0.091322
valid_loss: 1.035351
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0018228742702551162
Epoch-5 lr: 0.0036457485405102324
epoch 5 training time: 16.017
---------------
2023-09-11 11:08:49.462588
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03543	Per Sample Data Time 0.02797	Per Sample DNN Time 0.00746	Train Loss 0.0686	
start validation
acc: 0.810427
AUC: 0.913852
Avg Precision: 0.339696
Avg Recall: 1.000000
d_prime: 1.930210
train_loss: 0.075494
valid_loss: 1.023987
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0018228742702551162
Epoch-6 lr: 0.0036457485405102324
epoch 6 training time: 15.074
---------------
2023-09-11 11:09:04.537056
current #epochs=7, #steps=240
start validation
acc: 0.810427
AUC: 0.914096
Avg Precision: 0.320466
Avg Recall: 1.000000
d_prime: 1.932402
train_loss: 0.074025
valid_loss: 1.019129
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0018228742702551162
Epoch-7 lr: 0.0036457485405102324
epoch 7 training time: 14.951
---------------
2023-09-11 11:09:19.487691
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00556	Train Loss 0.0635	
start validation
acc: 0.810427
AUC: 0.924582
Avg Precision: 0.339176
Avg Recall: 1.000000
d_prime: 2.031635
train_loss: 0.063121
valid_loss: 1.021819
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0018228742702551162
Epoch-8 lr: 0.0036457485405102324
epoch 8 training time: 15.813
---------------
2023-09-11 11:09:35.301023
current #epochs=9, #steps=320
start validation
acc: 0.810427
AUC: 0.912454
Avg Precision: 0.324807
Avg Recall: 1.000000
d_prime: 1.917707
train_loss: 0.077479
valid_loss: 1.027581
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0018228742702551162
Epoch-9 lr: 0.0036457485405102324
epoch 9 training time: 17.322
---------------
2023-09-11 11:09:52.623056
current #epochs=10, #steps=360
start validation
acc: 0.815166
AUC: 0.925764
Avg Precision: 0.329959
Avg Recall: 1.000000
d_prime: 2.043467
train_loss: 0.061146
valid_loss: 1.015348
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0016138562760918272
Epoch-10 lr: 0.0032277125521836545
epoch 10 training time: 16.086
---------------
2023-09-11 11:10:08.709130
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03824	Per Sample Data Time 0.02816	Per Sample DNN Time 0.01007	Train Loss 0.0447	
start validation
acc: 0.796209
AUC: 0.922936
Avg Precision: 0.330356
Avg Recall: 1.000000
d_prime: 2.015399
train_loss: 0.084665
valid_loss: 1.018752
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0016138562760918272
Epoch-11 lr: 0.0032277125521836545
epoch 11 training time: 15.119
---------------
2023-09-11 11:10:23.828630
current #epochs=12, #steps=440
start validation
acc: 0.810427
AUC: 0.920294
Avg Precision: 0.356419
Avg Recall: 1.000000
d_prime: 1.989871
train_loss: 0.090859
valid_loss: 1.045851
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0016138562760918272
Epoch-12 lr: 0.0032277125521836545
epoch 12 training time: 15.083
---------------
2023-09-11 11:10:38.911046
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00555	Train Loss 0.0849	
start validation
acc: 0.781991
AUC: 0.914852
Avg Precision: 0.332081
Avg Recall: 1.000000
d_prime: 1.939247
train_loss: 0.093235
valid_loss: 1.038810
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0016138562760918272
Epoch-13 lr: 0.0032277125521836545
epoch 13 training time: 15.585
---------------
2023-09-11 11:10:54.496638
current #epochs=14, #steps=520
start validation
acc: 0.791469
AUC: 0.895063
Avg Precision: 0.299340
Avg Recall: 1.000000
d_prime: 1.773302
train_loss: 0.107296
valid_loss: 1.044905
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0016138562760918272
Epoch-14 lr: 0.0032277125521836545
epoch 14 training time: 15.776
---------------
2023-09-11 11:11:10.272632
current #epochs=15, #steps=560
start validation
acc: 0.819905
AUC: 0.912162
Avg Precision: 0.310670
Avg Recall: 1.000000
d_prime: 1.915116
train_loss: 0.098408
valid_loss: 1.042115
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0016138562760918272
Epoch-15 lr: 0.0032277125521836545
epoch 15 training time: 15.253
---------------
2023-09-11 11:11:25.525703
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03524	Per Sample Data Time 0.02770	Per Sample DNN Time 0.00753	Train Loss 0.0528	
start validation
acc: 0.800948
AUC: 0.908512
Avg Precision: 0.323653
Avg Recall: 1.000000
d_prime: 1.883232
train_loss: 0.093962
valid_loss: 1.034161
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0016138562760918272
Epoch-16 lr: 0.0032277125521836545
epoch 16 training time: 15.075
---------------
2023-09-11 11:11:40.601181
current #epochs=17, #steps=640
start validation
acc: 0.805687
AUC: 0.925680
Avg Precision: 0.350522
Avg Recall: 1.000000
d_prime: 2.042626
train_loss: 0.067439
valid_loss: 1.008987
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0016138562760918272
Epoch-17 lr: 0.0032277125521836545
epoch 17 training time: 15.050
---------------
2023-09-11 11:11:55.651246
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00700	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00555	Train Loss 0.0675	
start validation
acc: 0.800948
AUC: 0.916288
Avg Precision: 0.338261
Avg Recall: 1.000000
d_prime: 1.952359
train_loss: 0.065875
valid_loss: 1.012117
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0014288051141982867
Epoch-18 lr: 0.0028576102283965734
epoch 18 training time: 16.114
---------------
2023-09-11 11:12:11.764767
current #epochs=19, #steps=720
start validation
acc: 0.810427
AUC: 0.909613
Avg Precision: 0.329484
Avg Recall: 1.000000
d_prime: 1.892753
train_loss: 0.085648
valid_loss: 1.022858
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0014288051141982867
Epoch-19 lr: 0.0028576102283965734
epoch 19 training time: 15.234
---------------
2023-09-11 11:12:26.999326
current #epochs=20, #steps=760
start validation
acc: 0.791469
AUC: 0.901238
Avg Precision: 0.313103
Avg Recall: 1.000000
d_prime: 1.822406
train_loss: 0.083121
valid_loss: 1.033296
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0014288051141982867
Epoch-20 lr: 0.0028576102283965734
epoch 20 training time: 15.383
---------------
2023-09-11 11:12:42.382477
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03505	Per Sample Data Time 0.02838	Per Sample DNN Time 0.00667	Train Loss 0.0954	
start validation
acc: 0.800948
AUC: 0.906592
Avg Precision: 0.327745
Avg Recall: 1.000000
d_prime: 1.866840
train_loss: 0.084435
valid_loss: 1.030408
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0014288051141982867
Epoch-21 lr: 0.0028576102283965734
epoch 21 training time: 15.090
---------------
2023-09-11 11:12:57.472643
current #epochs=22, #steps=840
start validation
acc: 0.810427
AUC: 0.902309
Avg Precision: 0.317261
Avg Recall: 1.000000
d_prime: 1.831153
train_loss: 0.061420
valid_loss: 1.044608
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0014288051141982867
Epoch-22 lr: 0.0028576102283965734
epoch 22 training time: 15.728
---------------
2023-09-11 11:13:13.200385
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00567	Train Loss 0.0707	
start validation
acc: 0.758294
AUC: 0.918336
Avg Precision: 0.353514
Avg Recall: 1.000000
d_prime: 1.971365
train_loss: 0.074565
valid_loss: 1.018277
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0014288051141982867
Epoch-23 lr: 0.0028576102283965734
epoch 23 training time: 15.952
---------------
2023-09-11 11:13:29.152046
current #epochs=24, #steps=920
start validation
acc: 0.800948
AUC: 0.930727
Avg Precision: 0.345293
Avg Recall: 1.000000
d_prime: 2.094777
train_loss: 0.074098
valid_loss: 1.005140
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0014288051141982867
Epoch-24 lr: 0.0028576102283965734
epoch 24 training time: 15.724
---------------
2023-09-11 11:13:44.875896
current #epochs=25, #steps=960
start validation
acc: 0.796209
AUC: 0.911333
Avg Precision: 0.342216
Avg Recall: 1.000000
d_prime: 1.907790
train_loss: 0.083910
valid_loss: 1.030866
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0014288051141982867
Epoch-25 lr: 0.0028576102283965734
epoch 25 training time: 16.779
---------------
2023-09-11 11:14:01.655490
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03987	Per Sample Data Time 0.02905	Per Sample DNN Time 0.01082	Train Loss 0.1127	
start validation
acc: 0.796209
AUC: 0.922977
Avg Precision: 0.328050
Avg Recall: 1.000000
d_prime: 2.015799
train_loss: 0.093960
valid_loss: 1.015450
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0012649726525232538
Epoch-26 lr: 0.0025299453050465076
epoch 26 training time: 15.152
---------------
2023-09-11 11:14:16.807623
current #epochs=27, #steps=1040
start validation
acc: 0.800948
AUC: 0.922870
Avg Precision: 0.333344
Avg Recall: 1.000000
d_prime: 2.014748
train_loss: 0.074740
valid_loss: 1.015360
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0012649726525232538
Epoch-27 lr: 0.0025299453050465076
epoch 27 training time: 14.965
---------------
2023-09-11 11:14:31.772793
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00702	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00555	Train Loss 0.0833	
start validation
acc: 0.810427
AUC: 0.922657
Avg Precision: 0.339069
Avg Recall: 1.000000
d_prime: 2.012669
train_loss: 0.070661
valid_loss: 1.022577
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0012649726525232538
Epoch-28 lr: 0.0025299453050465076
epoch 28 training time: 14.885
---------------
2023-09-11 11:14:46.657527
current #epochs=29, #steps=1120
start validation
acc: 0.800948
AUC: 0.922872
Avg Precision: 0.336355
Avg Recall: 1.000000
d_prime: 2.014774
train_loss: 0.068090
valid_loss: 1.022244
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0012649726525232538
Epoch-29 lr: 0.0025299453050465076
epoch 29 training time: 16.523
---------------
2023-09-11 11:15:03.180864
current #epochs=30, #steps=1160
start validation
acc: 0.805687
AUC: 0.919712
Avg Precision: 0.361529
Avg Recall: 1.000000
d_prime: 1.984337
train_loss: 0.062619
valid_loss: 1.011826
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0012649726525232538
Epoch-30 lr: 0.0025299453050465076
epoch 30 training time: 16.739
---------------
2023-09-11 11:15:19.919741
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03529	Per Sample Data Time 0.02772	Per Sample DNN Time 0.00757	Train Loss 0.0494	
start validation
acc: 0.843602
AUC: 0.911775
Avg Precision: 0.328461
Avg Recall: 1.000000
d_prime: 1.911689
train_loss: 0.072368
valid_loss: 1.030765
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0012649726525232538
Epoch-31 lr: 0.0025299453050465076
epoch 31 training time: 17.065
---------------
2023-09-11 11:15:36.985345
current #epochs=32, #steps=1240
start validation
acc: 0.819905
AUC: 0.921206
Avg Precision: 0.317130
Avg Recall: 1.000000
d_prime: 1.998605
train_loss: 0.082137
valid_loss: 1.012534
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0012649726525232538
Epoch-32 lr: 0.0025299453050465076
epoch 32 training time: 15.061
---------------
2023-09-11 11:15:52.046564
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00703	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00554	Train Loss 0.0781	
start validation
acc: 0.824645
AUC: 0.922692
Avg Precision: 0.334791
Avg Recall: 1.000000
d_prime: 2.013017
train_loss: 0.068379
valid_loss: 1.021920
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0012649726525232538
Epoch-33 lr: 0.0025299453050465076
epoch 33 training time: 15.120
---------------
2023-09-11 11:16:07.167289
current #epochs=34, #steps=1320
start validation
acc: 0.805687
AUC: 0.922181
Avg Precision: 0.336693
Avg Recall: 1.000000
d_prime: 2.008033
train_loss: 0.068630
valid_loss: 1.019771
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.001119925870736805
Epoch-34 lr: 0.00223985174147361
epoch 34 training time: 15.073
---------------
2023-09-11 11:16:22.240253
current #epochs=35, #steps=1360
start validation
acc: 0.810427
AUC: 0.931284
Avg Precision: 0.331221
Avg Recall: 1.000000
d_prime: 2.100706
train_loss: 0.064016
valid_loss: 1.016210
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.001119925870736805
Epoch-35 lr: 0.00223985174147361
epoch 35 training time: 15.113
---------------
2023-09-11 11:16:37.353546
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03703	Per Sample Data Time 0.02987	Per Sample DNN Time 0.00716	Train Loss 0.0384	
start validation
acc: 0.834123
AUC: 0.930430
Avg Precision: 0.330611
Avg Recall: 1.000000
d_prime: 2.091620
train_loss: 0.060982
valid_loss: 1.010847
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.001119925870736805
Epoch-36 lr: 0.00223985174147361
epoch 36 training time: 16.045
---------------
2023-09-11 11:16:53.398803
current #epochs=37, #steps=1440
start validation
[I 2023-09-11 11:17:08,331] Trial 34 finished with value: 0.8436018957345972 and parameters: {'warmup': 'True', 'num_epochs': 37, 'batch_size': 60, 'lr-adaptschedule': 'False', 'lr': 0.0018228742702551162, 'head-lr': 2, 'lr-scheduler-start': 10, 'lr-scheduler-step': 8, 'lr-scheduler-decay': 0.8853360335520911}. Best is trial 34 with value: 0.8436018957345972.
acc: 0.834123
AUC: 0.928662
Avg Precision: 0.318618
Avg Recall: 1.000000
d_prime: 2.073097
train_loss: 0.061487
valid_loss: 1.013828
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.001119925870736805
Epoch-37 lr: 0.00223985174147361
epoch 37 training time: 14.926
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863d9807f0>
The learning rate scheduler starts at 10 epoch with decay rate of 0.886 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 11:17:08.368474
current #epochs=1, #steps=0
start validation
acc: 0.800948
AUC: 0.919486
Avg Precision: 0.330881
Avg Recall: 1.000000
d_prime: 1.982198
train_loss: 0.105851
valid_loss: 1.027125
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0025402638564874184
Epoch-1 lr: 0.005080527712974837
epoch 1 training time: 17.848
---------------
2023-09-11 11:17:26.216317
current #epochs=2, #steps=40
start validation
acc: 0.819905
AUC: 0.919390
Avg Precision: 0.295710
Avg Recall: 1.000000
d_prime: 1.981281
train_loss: 0.091441
valid_loss: 1.019216
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0025402638564874184
Epoch-2 lr: 0.005080527712974837
epoch 2 training time: 16.935
---------------
2023-09-11 11:17:43.151410
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00702	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00559	Train Loss 0.0898	
start validation
acc: 0.815166
AUC: 0.917931
Avg Precision: 0.308073
Avg Recall: 1.000000
d_prime: 1.967581
train_loss: 0.075250
valid_loss: 1.023682
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0025402638564874184
Epoch-3 lr: 0.005080527712974837
epoch 3 training time: 14.991
---------------
2023-09-11 11:17:58.142846
current #epochs=4, #steps=120
start validation
acc: 0.810427
AUC: 0.908241
Avg Precision: 0.316973
Avg Recall: 1.000000
d_prime: 1.880906
train_loss: 0.090307
valid_loss: 1.035363
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0025402638564874184
Epoch-4 lr: 0.005080527712974837
epoch 4 training time: 14.851
---------------
2023-09-11 11:18:12.993784
current #epochs=5, #steps=160
start validation
acc: 0.786730
AUC: 0.903920
Avg Precision: 0.296764
Avg Recall: 1.000000
d_prime: 1.844438
train_loss: 0.121831
valid_loss: 1.035361
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0025402638564874184
Epoch-5 lr: 0.005080527712974837
epoch 5 training time: 16.026
---------------
2023-09-11 11:18:29.019595
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03890	Per Sample Data Time 0.02852	Per Sample DNN Time 0.01038	Train Loss 0.2080	
start validation
acc: 0.781991
AUC: 0.913630
Avg Precision: 0.312395
Avg Recall: 1.000000
d_prime: 1.928212
train_loss: 0.127743
valid_loss: 1.047749
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0025402638564874184
Epoch-6 lr: 0.005080527712974837
epoch 6 training time: 15.134
---------------
2023-09-11 11:18:44.152979
current #epochs=7, #steps=240
start validation
acc: 0.810427
AUC: 0.914247
Avg Precision: 0.282603
Avg Recall: 1.000000
d_prime: 1.933770
train_loss: 0.087331
valid_loss: 1.056859
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0025402638564874184
Epoch-7 lr: 0.005080527712974837
epoch 7 training time: 15.057
---------------
2023-09-11 11:18:59.209959
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00561	Train Loss 0.1287	
start validation
acc: 0.819905
AUC: 0.911595
Avg Precision: 0.301455
Avg Recall: 1.000000
d_prime: 1.910094
train_loss: 0.125747
valid_loss: 1.045005
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0025402638564874184
Epoch-8 lr: 0.005080527712974837
epoch 8 training time: 15.042
---------------
2023-09-11 11:19:14.251996
current #epochs=9, #steps=320
start validation
acc: 0.800948
AUC: 0.914018
Avg Precision: 0.302853
Avg Recall: 1.000000
d_prime: 1.931705
train_loss: 0.142554
valid_loss: 1.028252
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0025402638564874184
Epoch-9 lr: 0.005080527712974837
epoch 9 training time: 14.970
---------------
2023-09-11 11:19:29.221493
current #epochs=10, #steps=360
start validation
acc: 0.824645
AUC: 0.917352
Avg Precision: 0.292057
Avg Recall: 1.000000
d_prime: 1.962187
train_loss: 0.087983
valid_loss: 1.029169
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.002251527406165051
Epoch-10 lr: 0.004503054812330102
epoch 10 training time: 17.457
---------------
2023-09-11 11:19:46.678420
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03558	Per Sample Data Time 0.02761	Per Sample DNN Time 0.00797	Train Loss 0.1356	
start validation
acc: 0.829384
AUC: 0.900766
Avg Precision: 0.300653
Avg Recall: 1.000000
d_prime: 1.818580
train_loss: 0.068784
valid_loss: 1.043221
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.002251527406165051
Epoch-11 lr: 0.004503054812330102
epoch 11 training time: 17.089
---------------
2023-09-11 11:20:03.767247
current #epochs=12, #steps=440
start validation
acc: 0.824645
AUC: 0.920101
Avg Precision: 0.304699
Avg Recall: 1.000000
d_prime: 1.988030
train_loss: 0.080170
valid_loss: 1.031518
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.002251527406165051
Epoch-12 lr: 0.004503054812330102
epoch 12 training time: 15.007
---------------
2023-09-11 11:20:18.774649
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00567	Train Loss 0.0730	
start validation
acc: 0.824645
AUC: 0.929448
Avg Precision: 0.329969
Avg Recall: 1.000000
d_prime: 2.081286
train_loss: 0.075048
valid_loss: 0.994977
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.002251527406165051
Epoch-13 lr: 0.004503054812330102
epoch 13 training time: 15.095
---------------
2023-09-11 11:20:33.869678
current #epochs=14, #steps=520
start validation
acc: 0.810427
AUC: 0.906258
Avg Precision: 0.290291
Avg Recall: 1.000000
d_prime: 1.864017
train_loss: 0.076465
valid_loss: 1.028954
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.002251527406165051
Epoch-14 lr: 0.004503054812330102
epoch 14 training time: 15.660
---------------
2023-09-11 11:20:49.529262
current #epochs=15, #steps=560
start validation
acc: 0.824645
AUC: 0.906907
Avg Precision: 0.287605
Avg Recall: 1.000000
d_prime: 1.869515
train_loss: 0.074482
valid_loss: 1.042021
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.002251527406165051
Epoch-15 lr: 0.004503054812330102
epoch 15 training time: 14.996
---------------
2023-09-11 11:21:04.525688
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03546	Per Sample Data Time 0.02838	Per Sample DNN Time 0.00708	Train Loss 0.0398	
start validation
acc: 0.796209
AUC: 0.917623
Avg Precision: 0.296627
Avg Recall: 1.000000
d_prime: 1.964706
train_loss: 0.105412
valid_loss: 1.027867
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.002251527406165051
Epoch-16 lr: 0.004503054812330102
epoch 16 training time: 16.026
---------------
2023-09-11 11:21:20.552200
current #epochs=17, #steps=640
start validation
acc: 0.843602
AUC: 0.914455
Avg Precision: 0.293854
Avg Recall: 1.000000
d_prime: 1.935647
train_loss: 0.096968
valid_loss: 1.023794
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.002251527406165051
Epoch-17 lr: 0.004503054812330102
epoch 17 training time: 19.075
---------------
2023-09-11 11:21:39.626986
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00572	Train Loss 0.0849	
start validation
acc: 0.777251
AUC: 0.912905
Avg Precision: 0.312778
Avg Recall: 1.000000
d_prime: 1.921722
train_loss: 0.079728
valid_loss: 1.020794
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.002251527406165051
Epoch-18 lr: 0.004503054812330102
epoch 18 training time: 16.873
---------------
2023-09-11 11:21:56.499579
current #epochs=19, #steps=720
start validation
acc: 0.819905
AUC: 0.913659
Avg Precision: 0.314792
Avg Recall: 1.000000
d_prime: 1.928471
train_loss: 0.091289
valid_loss: 1.029997
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.002251527406165051
Epoch-19 lr: 0.004503054812330102
epoch 19 training time: 15.790
---------------
2023-09-11 11:22:12.289820
current #epochs=20, #steps=760
start validation
acc: 0.815166
AUC: 0.908431
Avg Precision: 0.298878
Avg Recall: 1.000000
d_prime: 1.882540
train_loss: 0.090030
valid_loss: 1.031744
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0019956098842905494
Epoch-20 lr: 0.003991219768581099
epoch 20 training time: 15.678
---------------
2023-09-11 11:22:27.967720
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03607	Per Sample Data Time 0.02846	Per Sample DNN Time 0.00761	Train Loss 0.0567	
start validation
acc: 0.796209
AUC: 0.917480
Avg Precision: 0.306976
Avg Recall: 1.000000
d_prime: 1.963384
train_loss: 0.064645
valid_loss: 1.010084
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0019956098842905494
Epoch-21 lr: 0.003991219768581099
epoch 21 training time: 14.855
---------------
2023-09-11 11:22:42.822823
current #epochs=22, #steps=840
start validation
acc: 0.800948
AUC: 0.901288
Avg Precision: 0.282299
Avg Recall: 1.000000
d_prime: 1.822817
train_loss: 0.078146
valid_loss: 1.032164
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0019956098842905494
Epoch-22 lr: 0.003991219768581099
epoch 22 training time: 17.791
---------------
2023-09-11 11:23:00.613918
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00563	Train Loss 0.1054	
start validation
acc: 0.781991
AUC: 0.919919
Avg Precision: 0.318027
Avg Recall: 1.000000
d_prime: 1.986297
train_loss: 0.083585
valid_loss: 1.030989
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0019956098842905494
Epoch-23 lr: 0.003991219768581099
epoch 23 training time: 15.081
---------------
2023-09-11 11:23:15.694886
current #epochs=24, #steps=920
start validation
acc: 0.829384
AUC: 0.904374
Avg Precision: 0.294170
Avg Recall: 1.000000
d_prime: 1.848216
train_loss: 0.073054
valid_loss: 1.037766
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0019956098842905494
Epoch-24 lr: 0.003991219768581099
epoch 24 training time: 15.435
---------------
2023-09-11 11:23:31.129819
current #epochs=25, #steps=960
start validation
acc: 0.829384
AUC: 0.902359
Avg Precision: 0.297575
Avg Recall: 1.000000
d_prime: 1.831565
train_loss: 0.099300
valid_loss: 1.045536
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0019956098842905494
Epoch-25 lr: 0.003991219768581099
epoch 25 training time: 16.702
---------------
2023-09-11 11:23:47.832316
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03961	Per Sample Data Time 0.02922	Per Sample DNN Time 0.01039	Train Loss 0.0682	
start validation
acc: 0.829384
AUC: 0.912309
Avg Precision: 0.308502
Avg Recall: 1.000000
d_prime: 1.916416
train_loss: 0.088163
valid_loss: 1.035648
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0019956098842905494
Epoch-26 lr: 0.003991219768581099
epoch 26 training time: 15.993
---------------
2023-09-11 11:24:03.825037
current #epochs=27, #steps=1040
start validation
acc: 0.819905
AUC: 0.908032
Avg Precision: 0.293181
Avg Recall: 1.000000
d_prime: 1.879112
train_loss: 0.089454
valid_loss: 1.044027
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0019956098842905494
Epoch-27 lr: 0.003991219768581099
epoch 27 training time: 14.970
---------------
2023-09-11 11:24:18.795635
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00701	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00555	Train Loss 0.0810	
start validation
acc: 0.791469
AUC: 0.897019
Avg Precision: 0.305798
Avg Recall: 1.000000
d_prime: 1.788624
train_loss: 0.074525
valid_loss: 1.038679
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0019956098842905494
Epoch-28 lr: 0.003991219768581099
epoch 28 training time: 14.917
---------------
2023-09-11 11:24:33.712908
current #epochs=29, #steps=1120
start validation
acc: 0.786730
AUC: 0.913625
Avg Precision: 0.313427
Avg Recall: 1.000000
d_prime: 1.928170
train_loss: 0.085525
valid_loss: 1.033565
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0019956098842905494
Epoch-29 lr: 0.003991219768581099
epoch 29 training time: 15.141
---------------
2023-09-11 11:24:48.854325
current #epochs=30, #steps=1160
start validation
acc: 0.819905
AUC: 0.901537
Avg Precision: 0.292663
Avg Recall: 1.000000
d_prime: 1.824842
train_loss: 0.094551
valid_loss: 1.042099
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0017687809614813108
Epoch-30 lr: 0.0035375619229626215
epoch 30 training time: 14.932
---------------
2023-09-11 11:25:03.786295
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03518	Per Sample Data Time 0.02766	Per Sample DNN Time 0.00752	Train Loss 0.1716	
start validation
acc: 0.800948
AUC: 0.905397
Avg Precision: 0.319029
Avg Recall: 1.000000
d_prime: 1.856764
train_loss: 0.090119
valid_loss: 1.046941
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0017687809614813108
Epoch-31 lr: 0.0035375619229626215
epoch 31 training time: 14.950
---------------
2023-09-11 11:25:18.736562
current #epochs=32, #steps=1240
start validation
acc: 0.805687
AUC: 0.904408
Avg Precision: 0.299638
Avg Recall: 1.000000
d_prime: 1.848496
train_loss: 0.098789
valid_loss: 1.054185
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0017687809614813108
Epoch-32 lr: 0.0035375619229626215
epoch 32 training time: 15.037
---------------
2023-09-11 11:25:33.773375
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00559	Train Loss 0.0843	
start validation
acc: 0.819905
AUC: 0.909195
Avg Precision: 0.322132
Avg Recall: 1.000000
d_prime: 1.889131
train_loss: 0.085835
valid_loss: 1.042357
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0017687809614813108
Epoch-33 lr: 0.0035375619229626215
epoch 33 training time: 16.825
---------------
2023-09-11 11:25:50.598602
current #epochs=34, #steps=1320
start validation
acc: 0.796209
AUC: 0.903281
Avg Precision: 0.316991
Avg Recall: 1.000000
d_prime: 1.839153
train_loss: 0.071637
valid_loss: 1.041213
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0017687809614813108
Epoch-34 lr: 0.0035375619229626215
epoch 34 training time: 16.505
---------------
2023-09-11 11:26:07.103791
current #epochs=35, #steps=1360
start validation
acc: 0.815166
AUC: 0.908924
Avg Precision: 0.312470
Avg Recall: 1.000000
d_prime: 1.886787
train_loss: 0.077964
valid_loss: 1.018600
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0017687809614813108
Epoch-35 lr: 0.0035375619229626215
epoch 35 training time: 15.128
---------------
2023-09-11 11:26:22.231372
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03450	Per Sample Data Time 0.02781	Per Sample DNN Time 0.00669	Train Loss 0.1427	
start validation
acc: 0.838863
AUC: 0.917841
Avg Precision: 0.310581
Avg Recall: 1.000000
d_prime: 1.966742
train_loss: 0.074886
valid_loss: 1.017641
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0017687809614813108
Epoch-36 lr: 0.0035375619229626215
epoch 36 training time: 14.916
---------------
2023-09-11 11:26:37.147285
current #epochs=37, #steps=1440
start validation
acc: 0.829384
AUC: 0.916532
Avg Precision: 0.333116
Avg Recall: 1.000000
d_prime: 1.954604
train_loss: 0.068066
valid_loss: 0.989781
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0017687809614813108
Epoch-37 lr: 0.0035375619229626215
epoch 37 training time: 14.949
---------------
2023-09-11 11:26:52.095861
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00559	Train Loss 0.0946	
start validation
acc: 0.810427
AUC: 0.928205
Avg Precision: 0.351536
Avg Recall: 1.000000
d_prime: 2.068357
train_loss: 0.099289
valid_loss: 1.036608
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0017687809614813108
Epoch-38 lr: 0.0035375619229626215
epoch 38 training time: 17.148
---------------
2023-09-11 11:27:09.244332
current #epochs=39, #steps=1520
start validation
acc: 0.815166
AUC: 0.899283
Avg Precision: 0.290478
Avg Recall: 1.000000
d_prime: 1.806627
train_loss: 0.088555
valid_loss: 1.033519
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0017687809614813108
Epoch-39 lr: 0.0035375619229626215
epoch 39 training time: 14.994
---------------
2023-09-11 11:27:24.238311
current #epochs=40, #steps=1560
start validation
acc: 0.815166
AUC: 0.918739
Avg Precision: 0.314830
Avg Recall: 1.000000
d_prime: 1.975147
train_loss: 0.083534
valid_loss: 1.018655
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0015677343123658562
Epoch-40 lr: 0.0031354686247317123
epoch 40 training time: 14.902
---------------
2023-09-11 11:27:39.140466
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03941	Per Sample Data Time 0.02943	Per Sample DNN Time 0.00999	Train Loss 0.1690	
start validation
acc: 0.824645
AUC: 0.913554
Avg Precision: 0.302780
Avg Recall: 1.000000
d_prime: 1.927533
train_loss: 0.075516
valid_loss: 1.015564
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0015677343123658562
Epoch-41 lr: 0.0031354686247317123
epoch 41 training time: 15.103
---------------
2023-09-11 11:27:54.243606
current #epochs=42, #steps=1640
start validation
acc: 0.805687
AUC: 0.917422
Avg Precision: 0.317828
Avg Recall: 1.000000
d_prime: 1.962844
train_loss: 0.068289
valid_loss: 1.018385
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0015677343123658562
Epoch-42 lr: 0.0031354686247317123
epoch 42 training time: 15.020
---------------
2023-09-11 11:28:09.263902
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00557	Train Loss 0.0785	
start validation
acc: 0.810427
AUC: 0.917544
Avg Precision: 0.325352
Avg Recall: 1.000000
d_prime: 1.963975
train_loss: 0.100666
valid_loss: 1.021230
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0015677343123658562
Epoch-43 lr: 0.0031354686247317123
epoch 43 training time: 15.019
---------------
2023-09-11 11:28:24.282645
current #epochs=44, #steps=1720
start validation
acc: 0.796209
AUC: 0.902554
Avg Precision: 0.299239
Avg Recall: 1.000000
d_prime: 1.833160
train_loss: 0.086864
valid_loss: 1.052797
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0015677343123658562
Epoch-44 lr: 0.0031354686247317123
epoch 44 training time: 16.301
---------------
2023-09-11 11:28:40.583659
current #epochs=45, #steps=1760
start validation
acc: 0.838863
AUC: 0.925288
Avg Precision: 0.315046
Avg Recall: 1.000000
d_prime: 2.038689
train_loss: 0.079718
valid_loss: 1.012858
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0015677343123658562
Epoch-45 lr: 0.0031354686247317123
epoch 45 training time: 15.594
---------------
2023-09-11 11:28:56.178103
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03533	Per Sample Data Time 0.02809	Per Sample DNN Time 0.00725	Train Loss 0.0734	
start validation
acc: 0.843602
AUC: 0.906307
Avg Precision: 0.293256
Avg Recall: 1.000000
d_prime: 1.864430
train_loss: 0.077601
valid_loss: 1.025700
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.0015677343123658562
Epoch-46 lr: 0.0031354686247317123
epoch 46 training time: 15.010
---------------
2023-09-11 11:29:11.187965
current #epochs=47, #steps=1840
start validation
[I 2023-09-11 11:29:26,231] Trial 35 finished with value: 0.8436018957345972 and parameters: {'warmup': 'True', 'num_epochs': 47, 'batch_size': 64, 'lr-adaptschedule': 'False', 'lr': 0.0025402638564874184, 'head-lr': 2, 'lr-scheduler-start': 10, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.8863360396263633}. Best is trial 34 with value: 0.8436018957345972.
acc: 0.805687
AUC: 0.909686
Avg Precision: 0.306853
Avg Recall: 1.000000
d_prime: 1.893387
train_loss: 0.057720
valid_loss: 1.028114
validation finished
normal learning rate scheduler step
Epoch-47 lr: 0.0015677343123658562
Epoch-47 lr: 0.0031354686247317123
epoch 47 training time: 15.036
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f8644850d30>
The learning rate scheduler starts at 10 epoch with decay rate of 0.833 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 11:29:26.266926
current #epochs=1, #steps=0
start validation
acc: 0.796209
AUC: 0.923536
Avg Precision: 0.324379
Avg Recall: 1.000000
d_prime: 2.021286
train_loss: 0.133940
valid_loss: 1.014090
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002577728085772146
Epoch-1 lr: 0.005155456171544292
epoch 1 training time: 18.425
---------------
2023-09-11 11:29:44.691785
current #epochs=2, #steps=40
start validation
acc: 0.791469
AUC: 0.913668
Avg Precision: 0.297245
Avg Recall: 1.000000
d_prime: 1.928550
train_loss: 0.119690
valid_loss: 1.032113
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002577728085772146
Epoch-2 lr: 0.005155456171544292
epoch 2 training time: 14.988
---------------
2023-09-11 11:29:59.680336
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00565	Train Loss 0.0800	
start validation
acc: 0.786730
AUC: 0.904872
Avg Precision: 0.325100
Avg Recall: 1.000000
d_prime: 1.852368
train_loss: 0.074629
valid_loss: 1.038000
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002577728085772146
Epoch-3 lr: 0.005155456171544292
epoch 3 training time: 14.989
---------------
2023-09-11 11:30:14.669042
current #epochs=4, #steps=120
start validation
acc: 0.815166
AUC: 0.915811
Avg Precision: 0.349808
Avg Recall: 1.000000
d_prime: 1.947990
train_loss: 0.091455
valid_loss: 1.028273
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002577728085772146
Epoch-4 lr: 0.005155456171544292
epoch 4 training time: 17.087
---------------
2023-09-11 11:30:31.755760
current #epochs=5, #steps=160
start validation
acc: 0.815166
AUC: 0.913107
Avg Precision: 0.336739
Avg Recall: 1.000000
d_prime: 1.923523
train_loss: 0.091930
valid_loss: 1.029764
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002577728085772146
Epoch-5 lr: 0.005155456171544292
epoch 5 training time: 16.467
---------------
2023-09-11 11:30:48.222497
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03618	Per Sample Data Time 0.02877	Per Sample DNN Time 0.00742	Train Loss 0.0858	
start validation
acc: 0.781991
AUC: 0.920219
Avg Precision: 0.338836
Avg Recall: 1.000000
d_prime: 1.989152
train_loss: 0.084985
valid_loss: 1.036333
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002577728085772146
Epoch-6 lr: 0.005155456171544292
epoch 6 training time: 14.970
---------------
2023-09-11 11:31:03.192490
current #epochs=7, #steps=240
start validation
acc: 0.800948
AUC: 0.909837
Avg Precision: 0.324077
Avg Recall: 1.000000
d_prime: 1.894695
train_loss: 0.116732
valid_loss: 1.031340
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002577728085772146
Epoch-7 lr: 0.005155456171544292
epoch 7 training time: 15.013
---------------
2023-09-11 11:31:18.206049
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00562	Train Loss 0.1207	
start validation
acc: 0.810427
AUC: 0.915940
Avg Precision: 0.324118
Avg Recall: 1.000000
d_prime: 1.949166
train_loss: 0.103702
valid_loss: 1.029713
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.002577728085772146
Epoch-8 lr: 0.005155456171544292
epoch 8 training time: 15.051
---------------
2023-09-11 11:31:33.256536
current #epochs=9, #steps=320
start validation
acc: 0.843602
AUC: 0.916263
Avg Precision: 0.347898
Avg Recall: 1.000000
d_prime: 1.952128
train_loss: 0.073643
valid_loss: 1.019515
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.002577728085772146
Epoch-9 lr: 0.005155456171544292
epoch 9 training time: 16.920
---------------
2023-09-11 11:31:50.176341
current #epochs=10, #steps=360
start validation
acc: 0.819905
AUC: 0.922944
Avg Precision: 0.325320
Avg Recall: 1.000000
d_prime: 2.015477
train_loss: 0.088173
valid_loss: 1.042938
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0021466801742763713
Epoch-10 lr: 0.004293360348552743
epoch 10 training time: 14.999
---------------
2023-09-11 11:32:05.175359
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03610	Per Sample Data Time 0.02872	Per Sample DNN Time 0.00738	Train Loss 0.0839	
start validation
acc: 0.805687
AUC: 0.910467
Avg Precision: 0.334656
Avg Recall: 1.000000
d_prime: 1.900191
train_loss: 0.082921
valid_loss: 1.041103
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0021466801742763713
Epoch-11 lr: 0.004293360348552743
epoch 11 training time: 15.029
---------------
2023-09-11 11:32:20.205387
current #epochs=12, #steps=440
start validation
acc: 0.805687
AUC: 0.911922
Avg Precision: 0.328968
Avg Recall: 1.000000
d_prime: 1.912990
train_loss: 0.083283
valid_loss: 1.022635
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0021466801742763713
Epoch-12 lr: 0.004293360348552743
epoch 12 training time: 14.996
---------------
2023-09-11 11:32:35.200639
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00565	Train Loss 0.0995	
start validation
acc: 0.805687
AUC: 0.929679
Avg Precision: 0.363451
Avg Recall: 1.000000
d_prime: 2.083704
train_loss: 0.091962
valid_loss: 1.007319
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0021466801742763713
Epoch-13 lr: 0.004293360348552743
epoch 13 training time: 15.021
---------------
2023-09-11 11:32:50.221825
current #epochs=14, #steps=520
start validation
acc: 0.805687
AUC: 0.924813
Avg Precision: 0.330832
Avg Recall: 1.000000
d_prime: 2.033940
train_loss: 0.086917
valid_loss: 1.021185
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0021466801742763713
Epoch-14 lr: 0.004293360348552743
epoch 14 training time: 15.076
---------------
2023-09-11 11:33:05.297975
current #epochs=15, #steps=560
start validation
acc: 0.819905
AUC: 0.891900
Avg Precision: 0.305958
Avg Recall: 1.000000
d_prime: 1.748949
train_loss: 0.073845
valid_loss: 1.032021
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0021466801742763713
Epoch-15 lr: 0.004293360348552743
epoch 15 training time: 16.377
---------------
2023-09-11 11:33:21.675008
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03964	Per Sample Data Time 0.02888	Per Sample DNN Time 0.01076	Train Loss 0.1020	
start validation
acc: 0.815166
AUC: 0.897686
Avg Precision: 0.307069
Avg Recall: 1.000000
d_prime: 1.793895
train_loss: 0.068001
valid_loss: 1.022912
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0021466801742763713
Epoch-16 lr: 0.004293360348552743
epoch 16 training time: 16.564
---------------
2023-09-11 11:33:38.238706
current #epochs=17, #steps=640
start validation
acc: 0.810427
AUC: 0.936243
Avg Precision: 0.328465
Avg Recall: 1.000000
d_prime: 2.155229
train_loss: 0.117894
valid_loss: 0.996355
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0021466801742763713
Epoch-17 lr: 0.004293360348552743
epoch 17 training time: 15.088
---------------
2023-09-11 11:33:53.326704
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00704	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00555	Train Loss 0.1392	
start validation
acc: 0.810427
AUC: 0.915059
Avg Precision: 0.307211
Avg Recall: 1.000000
d_prime: 1.941126
train_loss: 0.112794
valid_loss: 1.022184
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0021466801742763713
Epoch-18 lr: 0.004293360348552743
epoch 18 training time: 16.029
---------------
2023-09-11 11:34:09.356339
current #epochs=19, #steps=720
start validation
acc: 0.791469
AUC: 0.914406
Avg Precision: 0.315937
Avg Recall: 1.000000
d_prime: 1.935209
train_loss: 0.069411
valid_loss: 1.034893
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0021466801742763713
Epoch-19 lr: 0.004293360348552743
epoch 19 training time: 15.716
---------------
2023-09-11 11:34:25.072381
current #epochs=20, #steps=760
start validation
acc: 0.824645
AUC: 0.916364
Avg Precision: 0.312714
Avg Recall: 1.000000
d_prime: 1.953063
train_loss: 0.087845
valid_loss: 1.027550
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0017877121314953813
Epoch-20 lr: 0.0035754242629907626
epoch 20 training time: 17.297
---------------
2023-09-11 11:34:42.369464
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03520	Per Sample Data Time 0.02770	Per Sample DNN Time 0.00750	Train Loss 0.0046	
start validation
acc: 0.834123
AUC: 0.917192
Avg Precision: 0.356020
Avg Recall: 1.000000
d_prime: 1.960705
train_loss: 0.072623
valid_loss: 1.031178
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0017877121314953813
Epoch-21 lr: 0.0035754242629907626
epoch 21 training time: 16.054
---------------
2023-09-11 11:34:58.423196
current #epochs=22, #steps=840
start validation
acc: 0.815166
AUC: 0.912236
Avg Precision: 0.327119
Avg Recall: 1.000000
d_prime: 1.915767
train_loss: 0.087385
valid_loss: 1.044478
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0017877121314953813
Epoch-22 lr: 0.0035754242629907626
epoch 22 training time: 17.403
---------------
2023-09-11 11:35:15.825982
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00157	Per Sample DNN Time 0.00558	Train Loss 0.0721	
start validation
acc: 0.824645
AUC: 0.907226
Avg Precision: 0.320712
Avg Recall: 1.000000
d_prime: 1.872230
train_loss: 0.071860
valid_loss: 1.036831
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0017877121314953813
Epoch-23 lr: 0.0035754242629907626
epoch 23 training time: 15.104
---------------
2023-09-11 11:35:30.930040
current #epochs=24, #steps=920
start validation
acc: 0.800948
AUC: 0.912674
Avg Precision: 0.325188
Avg Recall: 1.000000
d_prime: 1.919663
train_loss: 0.074497
valid_loss: 1.046727
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0017877121314953813
Epoch-24 lr: 0.0035754242629907626
epoch 24 training time: 18.274
---------------
2023-09-11 11:35:49.203751
current #epochs=25, #steps=960
start validation
acc: 0.810427
AUC: 0.909815
Avg Precision: 0.316957
Avg Recall: 1.000000
d_prime: 1.894500
train_loss: 0.067216
valid_loss: 1.043316
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0017877121314953813
Epoch-25 lr: 0.0035754242629907626
epoch 25 training time: 16.038
---------------
2023-09-11 11:36:05.241947
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03575	Per Sample Data Time 0.02887	Per Sample DNN Time 0.00688	Train Loss 0.0269	
start validation
acc: 0.829384
AUC: 0.902847
Avg Precision: 0.303515
Avg Recall: 1.000000
d_prime: 1.835573
train_loss: 0.073512
valid_loss: 1.035972
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0017877121314953813
Epoch-26 lr: 0.0035754242629907626
epoch 26 training time: 15.090
---------------
2023-09-11 11:36:20.332045
current #epochs=27, #steps=1040
start validation
acc: 0.834123
AUC: 0.917399
Avg Precision: 0.321249
Avg Recall: 1.000000
d_prime: 1.962624
train_loss: 0.071026
valid_loss: 1.037433
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0017877121314953813
Epoch-27 lr: 0.0035754242629907626
epoch 27 training time: 15.315
---------------
2023-09-11 11:36:35.646763
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00157	Per Sample DNN Time 0.00558	Train Loss 0.0965	
start validation
acc: 0.815166
AUC: 0.916603
Avg Precision: 0.316959
Avg Recall: 1.000000
d_prime: 1.955266
train_loss: 0.091131
valid_loss: 1.030366
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0017877121314953813
Epoch-28 lr: 0.0035754242629907626
epoch 28 training time: 16.284
---------------
2023-09-11 11:36:51.930550
current #epochs=29, #steps=1120
start validation
acc: 0.810427
AUC: 0.930472
Avg Precision: 0.316267
Avg Recall: 1.000000
d_prime: 2.092072
train_loss: 0.079531
valid_loss: 1.009653
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0017877121314953813
Epoch-29 lr: 0.0035754242629907626
epoch 29 training time: 17.375
---------------
2023-09-11 11:37:09.305633
current #epochs=30, #steps=1160
start validation
acc: 0.819905
AUC: 0.922027
Avg Precision: 0.338324
Avg Recall: 1.000000
d_prime: 2.006544
train_loss: 0.077730
valid_loss: 1.018417
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0014887707556031614
Epoch-30 lr: 0.0029775415112063227
epoch 30 training time: 15.962
---------------
2023-09-11 11:37:25.268186
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03765	Per Sample Data Time 0.02795	Per Sample DNN Time 0.00970	Train Loss 0.0388	
start validation
acc: 0.819905
AUC: 0.906387
Avg Precision: 0.312095
Avg Recall: 1.000000
d_prime: 1.865106
train_loss: 0.069305
valid_loss: 1.026290
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0014887707556031614
Epoch-31 lr: 0.0029775415112063227
epoch 31 training time: 15.116
---------------
2023-09-11 11:37:40.383846
current #epochs=32, #steps=1240
start validation
acc: 0.805687
AUC: 0.904512
Avg Precision: 0.310399
Avg Recall: 1.000000
d_prime: 1.849364
train_loss: 0.069835
valid_loss: 1.020399
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0014887707556031614
Epoch-32 lr: 0.0029775415112063227
epoch 32 training time: 15.224
---------------
2023-09-11 11:37:55.608206
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00556	Train Loss 0.0966	
start validation
acc: 0.796209
AUC: 0.901495
Avg Precision: 0.308792
Avg Recall: 1.000000
d_prime: 1.824503
train_loss: 0.087507
valid_loss: 1.029330
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0014887707556031614
Epoch-33 lr: 0.0029775415112063227
epoch 33 training time: 16.173
---------------
2023-09-11 11:38:11.781506
current #epochs=34, #steps=1320
start validation
acc: 0.834123
AUC: 0.910767
Avg Precision: 0.312362
Avg Recall: 1.000000
d_prime: 1.902814
train_loss: 0.087920
valid_loss: 1.026499
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0014887707556031614
Epoch-34 lr: 0.0029775415112063227
epoch 34 training time: 15.111
---------------
2023-09-11 11:38:26.892210
current #epochs=35, #steps=1360
start validation
acc: 0.838863
AUC: 0.913467
Avg Precision: 0.318094
Avg Recall: 1.000000
d_prime: 1.926746
train_loss: 0.055307
valid_loss: 1.013332
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0014887707556031614
Epoch-35 lr: 0.0029775415112063227
epoch 35 training time: 14.988
---------------
2023-09-11 11:38:41.880267
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03602	Per Sample Data Time 0.02820	Per Sample DNN Time 0.00781	Train Loss 0.0359	
start validation
acc: 0.824645
AUC: 0.907479
Avg Precision: 0.291165
Avg Recall: 1.000000
d_prime: 1.874382
train_loss: 0.066460
valid_loss: 1.016961
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0014887707556031614
Epoch-36 lr: 0.0029775415112063227
epoch 36 training time: 14.988
---------------
2023-09-11 11:38:56.868438
current #epochs=37, #steps=1440
start validation
acc: 0.805687
AUC: 0.907747
Avg Precision: 0.301971
Avg Recall: 1.000000
d_prime: 1.876676
train_loss: 0.050769
valid_loss: 1.019934
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0014887707556031614
Epoch-37 lr: 0.0029775415112063227
epoch 37 training time: 15.055
---------------
2023-09-11 11:39:11.923352
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00561	Train Loss 0.0878	
start validation
acc: 0.763033
AUC: 0.896983
Avg Precision: 0.307865
Avg Recall: 1.000000
d_prime: 1.788338
train_loss: 0.078781
valid_loss: 1.038594
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0014887707556031614
Epoch-38 lr: 0.0029775415112063227
epoch 38 training time: 15.553
---------------
2023-09-11 11:39:27.476632
current #epochs=39, #steps=1520
start validation
acc: 0.810427
AUC: 0.916128
Avg Precision: 0.301052
Avg Recall: 1.000000
d_prime: 1.950896
train_loss: 0.060493
valid_loss: 1.015822
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0014887707556031614
Epoch-39 lr: 0.0029775415112063227
epoch 39 training time: 15.108
---------------
2023-09-11 11:39:42.584156
current #epochs=40, #steps=1560
start validation
acc: 0.805687
AUC: 0.925098
Avg Precision: 0.332555
Avg Recall: 1.000000
d_prime: 2.036787
train_loss: 0.057308
valid_loss: 0.996633
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0012398183822163846
Epoch-40 lr: 0.002479636764432769
epoch 40 training time: 14.961
---------------
2023-09-11 11:39:57.544855
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03716	Per Sample Data Time 0.02968	Per Sample DNN Time 0.00748	Train Loss 0.1266	
start validation
acc: 0.805687
AUC: 0.917494
Avg Precision: 0.308277
Avg Recall: 1.000000
d_prime: 1.963508
train_loss: 0.075009
valid_loss: 1.018218
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0012398183822163846
Epoch-41 lr: 0.002479636764432769
epoch 41 training time: 15.096
---------------
2023-09-11 11:40:12.640586
current #epochs=42, #steps=1640
start validation
acc: 0.843602
AUC: 0.928036
Avg Precision: 0.314545
Avg Recall: 1.000000
d_prime: 2.066617
train_loss: 0.075196
valid_loss: 1.021303
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0012398183822163846
Epoch-42 lr: 0.002479636764432769
epoch 42 training time: 14.974
---------------
2023-09-11 11:40:27.614478
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00558	Train Loss 0.0650	
start validation
acc: 0.834123
AUC: 0.931394
Avg Precision: 0.330404
Avg Recall: 1.000000
d_prime: 2.101875
train_loss: 0.064394
valid_loss: 1.008491
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0012398183822163846
Epoch-43 lr: 0.002479636764432769
epoch 43 training time: 15.095
---------------
2023-09-11 11:40:42.709663
current #epochs=44, #steps=1720
start validation
acc: 0.838863
AUC: 0.925600
Avg Precision: 0.309693
Avg Recall: 1.000000
d_prime: 2.041814
train_loss: 0.070920
valid_loss: 1.028003
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0012398183822163846
Epoch-44 lr: 0.002479636764432769
epoch 44 training time: 15.035
---------------
2023-09-11 11:40:57.744891
current #epochs=45, #steps=1760
start validation
acc: 0.810427
AUC: 0.926570
Avg Precision: 0.331609
Avg Recall: 1.000000
d_prime: 2.051615
train_loss: 0.053501
valid_loss: 1.020759
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0012398183822163846
Epoch-45 lr: 0.002479636764432769
epoch 45 training time: 16.421
---------------
2023-09-11 11:41:14.165826
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03931	Per Sample Data Time 0.02928	Per Sample DNN Time 0.01003	Train Loss 0.0075	
start validation
acc: 0.810427
AUC: 0.921134
Avg Precision: 0.314489
Avg Recall: 1.000000
d_prime: 1.997920
train_loss: 0.084983
valid_loss: 1.040566
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.0012398183822163846
Epoch-46 lr: 0.002479636764432769
epoch 46 training time: 15.198
---------------
2023-09-11 11:41:29.364023
current #epochs=47, #steps=1840
start validation
[I 2023-09-11 11:41:44,671] Trial 36 finished with value: 0.8436018957345972 and parameters: {'warmup': 'True', 'num_epochs': 47, 'batch_size': 60, 'lr-adaptschedule': 'True', 'lr': 0.002577728085772146, 'head-lr': 2, 'lr-scheduler-start': 10, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.8327799142683212}. Best is trial 34 with value: 0.8436018957345972.
acc: 0.815166
AUC: 0.908649
Avg Precision: 0.309591
Avg Recall: 1.000000
d_prime: 1.884414
train_loss: 0.059515
valid_loss: 1.031712
validation finished
normal learning rate scheduler step
Epoch-47 lr: 0.0012398183822163846
Epoch-47 lr: 0.002479636764432769
epoch 47 training time: 15.300
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863d981820>
The learning rate scheduler starts at 10 epoch with decay rate of 0.834 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 11:41:44.708260
current #epochs=1, #steps=0
start validation
acc: 0.829384
AUC: 0.916903
Avg Precision: 0.325395
Avg Recall: 1.000000
d_prime: 1.958027
train_loss: 0.110292
valid_loss: 1.020005
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0026658296884435055
Epoch-1 lr: 0.005331659376887011
epoch 1 training time: 17.007
---------------
2023-09-11 11:42:01.716143
current #epochs=2, #steps=40
start validation
acc: 0.843602
AUC: 0.919367
Avg Precision: 0.320432
Avg Recall: 1.000000
d_prime: 1.981071
train_loss: 0.104731
valid_loss: 1.043322
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0026658296884435055
Epoch-2 lr: 0.005331659376887011
epoch 2 training time: 17.198
---------------
2023-09-11 11:42:18.913483
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00562	Train Loss 0.0760	
start validation
acc: 0.815166
AUC: 0.923521
Avg Precision: 0.335663
Avg Recall: 1.000000
d_prime: 2.021140
train_loss: 0.087528
valid_loss: 1.045702
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0026658296884435055
Epoch-3 lr: 0.005331659376887011
epoch 3 training time: 15.038
---------------
2023-09-11 11:42:33.951851
current #epochs=4, #steps=120
start validation
acc: 0.829384
AUC: 0.924536
Avg Precision: 0.324419
Avg Recall: 1.000000
d_prime: 2.031179
train_loss: 0.076799
valid_loss: 1.019836
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0026658296884435055
Epoch-4 lr: 0.005331659376887011
epoch 4 training time: 15.113
---------------
2023-09-11 11:42:49.064838
current #epochs=5, #steps=160
start validation
acc: 0.805687
AUC: 0.910540
Avg Precision: 0.327864
Avg Recall: 1.000000
d_prime: 1.900831
train_loss: 0.071373
valid_loss: 1.020875
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0026658296884435055
Epoch-5 lr: 0.005331659376887011
epoch 5 training time: 14.997
---------------
2023-09-11 11:43:04.062042
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03590	Per Sample Data Time 0.02863	Per Sample DNN Time 0.00727	Train Loss 0.0682	
start validation
acc: 0.805687
AUC: 0.911165
Avg Precision: 0.335795
Avg Recall: 1.000000
d_prime: 1.906311
train_loss: 0.100043
valid_loss: 1.019150
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0026658296884435055
Epoch-6 lr: 0.005331659376887011
epoch 6 training time: 14.946
---------------
2023-09-11 11:43:19.008136
current #epochs=7, #steps=240
start validation
acc: 0.824645
AUC: 0.911249
Avg Precision: 0.333931
Avg Recall: 1.000000
d_prime: 1.907047
train_loss: 0.110006
valid_loss: 1.032776
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0026658296884435055
Epoch-7 lr: 0.005331659376887011
epoch 7 training time: 15.036
---------------
2023-09-11 11:43:34.044448
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00561	Train Loss 0.0836	
start validation
acc: 0.800948
AUC: 0.907533
Avg Precision: 0.302388
Avg Recall: 1.000000
d_prime: 1.874843
train_loss: 0.091367
valid_loss: 1.030329
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0026658296884435055
Epoch-8 lr: 0.005331659376887011
epoch 8 training time: 15.089
---------------
2023-09-11 11:43:49.133252
current #epochs=9, #steps=320
start validation
acc: 0.800948
AUC: 0.901632
Avg Precision: 0.322449
Avg Recall: 1.000000
d_prime: 1.825622
train_loss: 0.105210
valid_loss: 1.035314
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0026658296884435055
Epoch-9 lr: 0.005331659376887011
epoch 9 training time: 15.060
---------------
2023-09-11 11:44:04.192916
current #epochs=10, #steps=360
start validation
acc: 0.819905
AUC: 0.920251
Avg Precision: 0.354223
Avg Recall: 1.000000
d_prime: 1.989466
train_loss: 0.112178
valid_loss: 1.020132
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.002222212941958896
Epoch-10 lr: 0.004444425883917792
epoch 10 training time: 14.945
---------------
2023-09-11 11:44:19.137393
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03527	Per Sample Data Time 0.02839	Per Sample DNN Time 0.00688	Train Loss 0.1744	
start validation
acc: 0.819905
AUC: 0.908599
Avg Precision: 0.311385
Avg Recall: 1.000000
d_prime: 1.883980
train_loss: 0.101797
valid_loss: 1.036960
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.002222212941958896
Epoch-11 lr: 0.004444425883917792
epoch 11 training time: 15.098
---------------
2023-09-11 11:44:34.234902
current #epochs=12, #steps=440
start validation
acc: 0.824645
AUC: 0.932857
Avg Precision: 0.325441
Avg Recall: 1.000000
d_prime: 2.117663
train_loss: 0.087776
valid_loss: 0.989494
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.002222212941958896
Epoch-12 lr: 0.004444425883917792
epoch 12 training time: 15.033
---------------
2023-09-11 11:44:49.267747
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00560	Train Loss 0.0920	
start validation
acc: 0.824645
AUC: 0.910521
Avg Precision: 0.335626
Avg Recall: 1.000000
d_prime: 1.900661
train_loss: 0.093813
valid_loss: 1.032549
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.002222212941958896
Epoch-13 lr: 0.004444425883917792
epoch 13 training time: 15.129
---------------
2023-09-11 11:45:04.396244
current #epochs=14, #steps=520
start validation
acc: 0.800948
AUC: 0.919562
Avg Precision: 0.311228
Avg Recall: 1.000000
d_prime: 1.982913
train_loss: 0.075398
valid_loss: 1.015949
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.002222212941958896
Epoch-14 lr: 0.004444425883917792
epoch 14 training time: 15.037
---------------
2023-09-11 11:45:19.433509
current #epochs=15, #steps=560
start validation
acc: 0.810427
AUC: 0.920651
Avg Precision: 0.316355
Avg Recall: 1.000000
d_prime: 1.993281
train_loss: 0.082648
valid_loss: 1.015965
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.002222212941958896
Epoch-15 lr: 0.004444425883917792
epoch 15 training time: 16.085
---------------
2023-09-11 11:45:35.518470
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03741	Per Sample Data Time 0.02954	Per Sample DNN Time 0.00787	Train Loss 0.0852	
start validation
acc: 0.843602
AUC: 0.915138
Avg Precision: 0.319040
Avg Recall: 1.000000
d_prime: 1.941846
train_loss: 0.079465
valid_loss: 1.027778
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.002222212941958896
Epoch-16 lr: 0.004444425883917792
epoch 16 training time: 15.146
---------------
2023-09-11 11:45:50.664499
current #epochs=17, #steps=640
start validation
acc: 0.819905
AUC: 0.922261
Avg Precision: 0.318498
Avg Recall: 1.000000
d_prime: 2.008818
train_loss: 0.080881
valid_loss: 1.008028
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.002222212941958896
Epoch-17 lr: 0.004444425883917792
epoch 17 training time: 14.993
---------------
2023-09-11 11:46:05.657705
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00560	Train Loss 0.0799	
start validation
acc: 0.815166
AUC: 0.925598
Avg Precision: 0.344128
Avg Recall: 1.000000
d_prime: 2.041800
train_loss: 0.080013
valid_loss: 1.014797
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.002222212941958896
Epoch-18 lr: 0.004444425883917792
epoch 18 training time: 15.110
---------------
2023-09-11 11:46:20.767249
current #epochs=19, #steps=720
start validation
acc: 0.834123
AUC: 0.931523
Avg Precision: 0.357629
Avg Recall: 1.000000
d_prime: 2.103256
train_loss: 0.080855
valid_loss: 1.007839
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.002222212941958896
Epoch-19 lr: 0.004444425883917792
epoch 19 training time: 14.944
---------------
2023-09-11 11:46:35.711019
current #epochs=20, #steps=760
start validation
acc: 0.843602
AUC: 0.932685
Avg Precision: 0.361462
Avg Recall: 1.000000
d_prime: 2.115791
train_loss: 0.072133
valid_loss: 1.004161
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0018524177972873016
Epoch-20 lr: 0.003704835594574603
epoch 20 training time: 15.806
---------------
2023-09-11 11:46:51.517499
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03759	Per Sample Data Time 0.02994	Per Sample DNN Time 0.00765	Train Loss 0.1039	
start validation
acc: 0.834123
AUC: 0.928725
Avg Precision: 0.353589
Avg Recall: 1.000000
d_prime: 2.073752
train_loss: 0.077063
valid_loss: 1.005334
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0018524177972873016
Epoch-21 lr: 0.003704835594574603
epoch 21 training time: 15.163
---------------
2023-09-11 11:47:06.680871
current #epochs=22, #steps=840
start validation
acc: 0.824645
AUC: 0.928085
Avg Precision: 0.334812
Avg Recall: 1.000000
d_prime: 2.067119
train_loss: 0.082928
valid_loss: 1.012580
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0018524177972873016
Epoch-22 lr: 0.003704835594574603
epoch 22 training time: 15.101
---------------
2023-09-11 11:47:21.781911
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00559	Train Loss 0.0718	
start validation
acc: 0.815166
AUC: 0.931349
Avg Precision: 0.339334
Avg Recall: 1.000000
d_prime: 2.101397
train_loss: 0.067140
valid_loss: 1.015597
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0018524177972873016
Epoch-23 lr: 0.003704835594574603
epoch 23 training time: 14.932
---------------
2023-09-11 11:47:36.714201
current #epochs=24, #steps=920
start validation
acc: 0.824645
AUC: 0.926989
Avg Precision: 0.349633
Avg Recall: 1.000000
d_prime: 2.055878
train_loss: 0.101982
valid_loss: 1.018551
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0018524177972873016
Epoch-24 lr: 0.003704835594574603
epoch 24 training time: 15.075
---------------
2023-09-11 11:47:51.788832
current #epochs=25, #steps=960
start validation
acc: 0.824645
AUC: 0.920767
Avg Precision: 0.319097
Avg Recall: 1.000000
d_prime: 1.994394
train_loss: 0.070311
valid_loss: 1.025016
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0018524177972873016
Epoch-25 lr: 0.003704835594574603
epoch 25 training time: 15.111
---------------
2023-09-11 11:48:06.900333
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03488	Per Sample Data Time 0.02799	Per Sample DNN Time 0.00689	Train Loss 0.1356	
start validation
acc: 0.857820
AUC: 0.914522
Avg Precision: 0.303247
Avg Recall: 1.000000
d_prime: 1.936250
train_loss: 0.081469
valid_loss: 1.031276
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0018524177972873016
Epoch-26 lr: 0.003704835594574603
epoch 26 training time: 16.928
---------------
2023-09-11 11:48:23.828734
current #epochs=27, #steps=1040
start validation
acc: 0.815166
AUC: 0.915387
Avg Precision: 0.334346
Avg Recall: 1.000000
d_prime: 1.944115
train_loss: 0.069988
valid_loss: 1.029498
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0018524177972873016
Epoch-27 lr: 0.003704835594574603
epoch 27 training time: 15.045
---------------
2023-09-11 11:48:38.873836
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00562	Train Loss 0.0830	
start validation
acc: 0.810427
AUC: 0.919423
Avg Precision: 0.327647
Avg Recall: 1.000000
d_prime: 1.981595
train_loss: 0.081371
valid_loss: 1.029941
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0018524177972873016
Epoch-28 lr: 0.003704835594574603
epoch 28 training time: 15.081
---------------
2023-09-11 11:48:53.954531
current #epochs=29, #steps=1120
start validation
acc: 0.848341
AUC: 0.923051
Avg Precision: 0.361314
Avg Recall: 1.000000
d_prime: 2.016522
train_loss: 0.057161
valid_loss: 1.014586
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0018524177972873016
Epoch-29 lr: 0.003704835594574603
epoch 29 training time: 15.022
---------------
2023-09-11 11:49:08.976311
current #epochs=30, #steps=1160
start validation
acc: 0.834123
AUC: 0.911181
Avg Precision: 0.303766
Avg Recall: 1.000000
d_prime: 1.906449
train_loss: 0.062904
valid_loss: 1.034941
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0015441597116619661
Epoch-30 lr: 0.0030883194233239323
epoch 30 training time: 16.770
---------------
2023-09-11 11:49:25.745680
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03749	Per Sample Data Time 0.02998	Per Sample DNN Time 0.00751	Train Loss 0.2105	
start validation
acc: 0.838863
AUC: 0.917482
Avg Precision: 0.325827
Avg Recall: 1.000000
d_prime: 1.963396
train_loss: 0.060052
valid_loss: 1.032460
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0015441597116619661
Epoch-31 lr: 0.0030883194233239323
epoch 31 training time: 15.077
---------------
2023-09-11 11:49:40.822761
current #epochs=32, #steps=1240
start validation
acc: 0.838863
AUC: 0.922673
Avg Precision: 0.321885
Avg Recall: 1.000000
d_prime: 2.012828
train_loss: 0.065958
valid_loss: 1.019131
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0015441597116619661
Epoch-32 lr: 0.0030883194233239323
epoch 32 training time: 15.067
---------------
2023-09-11 11:49:55.889712
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00159	Per Sample DNN Time 0.00557	Train Loss 0.0644	
start validation
acc: 0.824645
AUC: 0.922912
Avg Precision: 0.344542
Avg Recall: 1.000000
d_prime: 2.015163
train_loss: 0.071539
valid_loss: 1.035695
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0015441597116619661
Epoch-33 lr: 0.0030883194233239323
epoch 33 training time: 16.844
---------------
2023-09-11 11:50:12.733575
current #epochs=34, #steps=1320
start validation
acc: 0.819905
AUC: 0.931106
Avg Precision: 0.353138
Avg Recall: 1.000000
d_prime: 2.098803
train_loss: 0.064702
valid_loss: 1.001770
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0015441597116619661
Epoch-34 lr: 0.0030883194233239323
epoch 34 training time: 16.268
---------------
2023-09-11 11:50:29.001571
current #epochs=35, #steps=1360
start validation
acc: 0.843602
AUC: 0.934678
Avg Precision: 0.356051
Avg Recall: 1.000000
d_prime: 2.137679
train_loss: 0.070462
valid_loss: 1.007532
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0015441597116619661
Epoch-35 lr: 0.0030883194233239323
epoch 35 training time: 15.009
---------------
2023-09-11 11:50:44.010719
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03790	Per Sample Data Time 0.02757	Per Sample DNN Time 0.01033	Train Loss 0.1322	
start validation
acc: 0.843602
AUC: 0.931011
Avg Precision: 0.329067
Avg Recall: 1.000000
d_prime: 2.097797
train_loss: 0.077169
valid_loss: 1.009446
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0015441597116619661
Epoch-36 lr: 0.0030883194233239323
epoch 36 training time: 15.129
---------------
2023-09-11 11:50:59.139808
current #epochs=37, #steps=1440
start validation
acc: 0.815166
AUC: 0.924034
Avg Precision: 0.320630
Avg Recall: 1.000000
d_prime: 2.026201
train_loss: 0.073789
valid_loss: 1.025566
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0015441597116619661
Epoch-37 lr: 0.0030883194233239323
epoch 37 training time: 15.066
---------------
2023-09-11 11:51:14.205946
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00557	Train Loss 0.0817	
start validation
acc: 0.800948
AUC: 0.929575
Avg Precision: 0.366408
Avg Recall: 1.000000
d_prime: 2.082619
train_loss: 0.073425
valid_loss: 1.013492
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0015441597116619661
Epoch-38 lr: 0.0030883194233239323
epoch 38 training time: 15.979
---------------
2023-09-11 11:51:30.185233
current #epochs=39, #steps=1520
start validation
acc: 0.824645
AUC: 0.927429
Avg Precision: 0.332775
Avg Recall: 1.000000
d_prime: 2.060378
train_loss: 0.060353
valid_loss: 1.016322
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0015441597116619661
Epoch-39 lr: 0.0030883194233239323
epoch 39 training time: 15.082
---------------
2023-09-11 11:51:45.267357
current #epochs=40, #steps=1560
start validation
acc: 0.824645
AUC: 0.926674
Avg Precision: 0.343413
Avg Recall: 1.000000
d_prime: 2.052674
train_loss: 0.062437
valid_loss: 1.010894
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0012871983947745197
Epoch-40 lr: 0.0025743967895490395
epoch 40 training time: 15.163
---------------
2023-09-11 11:52:00.429836
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03554	Per Sample Data Time 0.02823	Per Sample DNN Time 0.00731	Train Loss 0.0518	
start validation
acc: 0.834123
AUC: 0.928236
Avg Precision: 0.357739
Avg Recall: 1.000000
d_prime: 2.068681
train_loss: 0.069311
valid_loss: 1.029725
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0012871983947745197
Epoch-41 lr: 0.0025743967895490395
epoch 41 training time: 15.844
---------------
2023-09-11 11:52:16.273416
current #epochs=42, #steps=1640
start validation
acc: 0.815166
AUC: 0.919971
Avg Precision: 0.328450
Avg Recall: 1.000000
d_prime: 1.986795
train_loss: 0.054681
valid_loss: 1.023916
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0012871983947745197
Epoch-42 lr: 0.0025743967895490395
epoch 42 training time: 15.052
---------------
2023-09-11 11:52:31.325288
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00561	Train Loss 0.0600	
start validation
acc: 0.838863
AUC: 0.929181
Avg Precision: 0.339315
Avg Recall: 1.000000
d_prime: 2.078499
train_loss: 0.060868
valid_loss: 0.997692
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0012871983947745197
Epoch-43 lr: 0.0025743967895490395
epoch 43 training time: 15.034
---------------
2023-09-11 11:52:46.359064
current #epochs=44, #steps=1720
start validation
acc: 0.824645
AUC: 0.934119
Avg Precision: 0.347551
Avg Recall: 1.000000
d_prime: 2.131487
train_loss: 0.076178
valid_loss: 0.999420
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0012871983947745197
Epoch-44 lr: 0.0025743967895490395
epoch 44 training time: 14.835
---------------
2023-09-11 11:53:01.193556
current #epochs=45, #steps=1760
start validation
acc: 0.838863
AUC: 0.929281
Avg Precision: 0.346965
Avg Recall: 1.000000
d_prime: 2.079542
train_loss: 0.047915
valid_loss: 1.007868
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0012871983947745197
Epoch-45 lr: 0.0025743967895490395
epoch 45 training time: 16.406
---------------
2023-09-11 11:53:17.599168
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03753	Per Sample Data Time 0.02998	Per Sample DNN Time 0.00755	Train Loss 0.1068	
start validation
acc: 0.819905
AUC: 0.934577
Avg Precision: 0.354406
Avg Recall: 1.000000
d_prime: 2.136557
train_loss: 0.067488
valid_loss: 0.997272
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.0012871983947745197
Epoch-46 lr: 0.0025743967895490395
epoch 46 training time: 15.174
---------------
2023-09-11 11:53:32.772799
current #epochs=47, #steps=1840
start validation
acc: 0.834123
AUC: 0.927859
Avg Precision: 0.353571
Avg Recall: 1.000000
d_prime: 2.064789
train_loss: 0.048984
valid_loss: 0.994316
validation finished
normal learning rate scheduler step
Epoch-47 lr: 0.0012871983947745197
Epoch-47 lr: 0.0025743967895490395
epoch 47 training time: 14.962
---------------
2023-09-11 11:53:47.734623
current #epochs=48, #steps=1880
Epoch: [48][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00563	Train Loss 0.0693	
start validation
acc: 0.815166
AUC: 0.919288
Avg Precision: 0.326854
Avg Recall: 1.000000
d_prime: 1.980322
train_loss: 0.067368
valid_loss: 1.010520
validation finished
normal learning rate scheduler step
Epoch-48 lr: 0.0012871983947745197
Epoch-48 lr: 0.0025743967895490395
epoch 48 training time: 15.107
---------------
2023-09-11 11:54:02.841318
current #epochs=49, #steps=1920
start validation
acc: 0.815166
AUC: 0.924617
Avg Precision: 0.349845
Avg Recall: 1.000000
d_prime: 2.031983
train_loss: 0.065513
valid_loss: 1.020000
validation finished
normal learning rate scheduler step
Epoch-49 lr: 0.0012871983947745197
Epoch-49 lr: 0.0025743967895490395
epoch 49 training time: 16.008
---------------
2023-09-11 11:54:18.850044
current #epochs=50, #steps=1960
start validation
[I 2023-09-11 11:54:33,858] Trial 37 finished with value: 0.8578199052132701 and parameters: {'warmup': 'False', 'num_epochs': 50, 'batch_size': 61, 'lr-adaptschedule': 'True', 'lr': 0.0026658296884435055, 'head-lr': 2, 'lr-scheduler-start': 10, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.8335914899561256}. Best is trial 37 with value: 0.8578199052132701.
acc: 0.834123
AUC: 0.922696
Avg Precision: 0.346776
Avg Recall: 1.000000
d_prime: 2.013049
train_loss: 0.050694
valid_loss: 1.010928
validation finished
normal learning rate scheduler step
Epoch-50 lr: 0.001072997627769225
Epoch-50 lr: 0.00214599525553845
epoch 50 training time: 15.000
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f86448d1520>
The learning rate scheduler starts at 8 epoch with decay rate of 0.831 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 11:54:33.893880
current #epochs=1, #steps=0
start validation
acc: 0.829384
AUC: 0.921143
Avg Precision: 0.342441
Avg Recall: 1.000000
d_prime: 1.998005
train_loss: 0.095144
valid_loss: 1.030005
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002429617012393468
Epoch-1 lr: 0.004859234024786936
epoch 1 training time: 17.181
---------------
2023-09-11 11:54:51.075661
current #epochs=2, #steps=40
start validation
acc: 0.834123
AUC: 0.913385
Avg Precision: 0.320683
Avg Recall: 1.000000
d_prime: 1.926017
train_loss: 0.104257
valid_loss: 1.016510
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002429617012393468
Epoch-2 lr: 0.004859234024786936
epoch 2 training time: 17.048
---------------
2023-09-11 11:55:08.123329
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00560	Train Loss 0.0956	
start validation
acc: 0.819905
AUC: 0.909390
Avg Precision: 0.327258
Avg Recall: 1.000000
d_prime: 1.890817
train_loss: 0.102896
valid_loss: 1.023588
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002429617012393468
Epoch-3 lr: 0.004859234024786936
epoch 3 training time: 15.063
---------------
2023-09-11 11:55:23.186243
current #epochs=4, #steps=120
start validation
acc: 0.843602
AUC: 0.913857
Avg Precision: 0.319776
Avg Recall: 1.000000
d_prime: 1.930256
train_loss: 0.081120
valid_loss: 1.004617
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002429617012393468
Epoch-4 lr: 0.004859234024786936
epoch 4 training time: 17.048
---------------
2023-09-11 11:55:40.234001
current #epochs=5, #steps=160
start validation
acc: 0.824645
AUC: 0.928579
Avg Precision: 0.334770
Avg Recall: 1.000000
d_prime: 2.072227
train_loss: 0.056574
valid_loss: 1.006888
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002429617012393468
Epoch-5 lr: 0.004859234024786936
epoch 5 training time: 15.634
---------------
2023-09-11 11:55:55.867518
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03745	Per Sample Data Time 0.02969	Per Sample DNN Time 0.00776	Train Loss 0.0734	
start validation
acc: 0.848341
AUC: 0.935054
Avg Precision: 0.350613
Avg Recall: 1.000000
d_prime: 2.141868
train_loss: 0.066642
valid_loss: 0.998888
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002429617012393468
Epoch-6 lr: 0.004859234024786936
epoch 6 training time: 17.099
---------------
2023-09-11 11:56:12.966311
current #epochs=7, #steps=240
start validation
acc: 0.810427
AUC: 0.908410
Avg Precision: 0.307213
Avg Recall: 1.000000
d_prime: 1.882359
train_loss: 0.084428
valid_loss: 1.017094
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002429617012393468
Epoch-7 lr: 0.004859234024786936
epoch 7 training time: 17.021
---------------
2023-09-11 11:56:29.987198
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00564	Train Loss 0.0701	
start validation
acc: 0.810427
AUC: 0.915754
Avg Precision: 0.350594
Avg Recall: 1.000000
d_prime: 1.947465
train_loss: 0.077666
valid_loss: 1.028158
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0020182546905526746
Epoch-8 lr: 0.004036509381105349
epoch 8 training time: 15.014
---------------
2023-09-11 11:56:45.000922
current #epochs=9, #steps=320
start validation
acc: 0.800948
AUC: 0.902172
Avg Precision: 0.340090
Avg Recall: 1.000000
d_prime: 1.830033
train_loss: 0.077669
valid_loss: 1.054962
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0020182546905526746
Epoch-9 lr: 0.004036509381105349
epoch 9 training time: 15.044
---------------
2023-09-11 11:57:00.044851
current #epochs=10, #steps=360
start validation
acc: 0.824645
AUC: 0.911324
Avg Precision: 0.345026
Avg Recall: 1.000000
d_prime: 1.907708
train_loss: 0.056093
valid_loss: 1.037919
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0020182546905526746
Epoch-10 lr: 0.004036509381105349
epoch 10 training time: 14.951
---------------
2023-09-11 11:57:14.996473
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03585	Per Sample Data Time 0.02908	Per Sample DNN Time 0.00676	Train Loss 0.0301	
start validation
acc: 0.834123
AUC: 0.912425
Avg Precision: 0.337534
Avg Recall: 1.000000
d_prime: 1.917451
train_loss: 0.079828
valid_loss: 1.030568
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0020182546905526746
Epoch-11 lr: 0.004036509381105349
epoch 11 training time: 14.981
---------------
2023-09-11 11:57:29.977147
current #epochs=12, #steps=440
start validation
acc: 0.838863
AUC: 0.926078
Avg Precision: 0.328528
Avg Recall: 1.000000
d_prime: 2.046630
train_loss: 0.078702
valid_loss: 1.007368
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0020182546905526746
Epoch-12 lr: 0.004036509381105349
epoch 12 training time: 16.535
---------------
2023-09-11 11:57:46.512362
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00560	Train Loss 0.0782	
start validation
acc: 0.815166
AUC: 0.898664
Avg Precision: 0.330541
Avg Recall: 1.000000
d_prime: 1.801671
train_loss: 0.076486
valid_loss: 1.028356
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0020182546905526746
Epoch-13 lr: 0.004036509381105349
epoch 13 training time: 16.772
---------------
2023-09-11 11:58:03.284408
current #epochs=14, #steps=520
start validation
acc: 0.829384
AUC: 0.900170
Avg Precision: 0.330785
Avg Recall: 1.000000
d_prime: 1.813761
train_loss: 0.080327
valid_loss: 1.034234
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0020182546905526746
Epoch-14 lr: 0.004036509381105349
epoch 14 training time: 15.097
---------------
2023-09-11 11:58:18.381048
current #epochs=15, #steps=560
start validation
acc: 0.819905
AUC: 0.902685
Avg Precision: 0.313537
Avg Recall: 1.000000
d_prime: 1.834243
train_loss: 0.080910
valid_loss: 1.011472
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0020182546905526746
Epoch-15 lr: 0.004036509381105349
epoch 15 training time: 14.861
---------------
2023-09-11 11:58:33.241720
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03906	Per Sample Data Time 0.03028	Per Sample DNN Time 0.00878	Train Loss 0.0731	
start validation
acc: 0.838863
AUC: 0.914679
Avg Precision: 0.325011
Avg Recall: 1.000000
d_prime: 1.937679
train_loss: 0.092435
valid_loss: 1.024214
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0020182546905526746
Epoch-16 lr: 0.004036509381105349
epoch 16 training time: 15.142
---------------
2023-09-11 11:58:48.384085
current #epochs=17, #steps=640
start validation
acc: 0.824645
AUC: 0.907079
Avg Precision: 0.311813
Avg Recall: 1.000000
d_prime: 1.870972
train_loss: 0.109129
valid_loss: 1.040074
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0020182546905526746
Epoch-17 lr: 0.004036509381105349
epoch 17 training time: 14.987
---------------
2023-09-11 11:59:03.370790
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00559	Train Loss 0.0865	
start validation
acc: 0.815166
AUC: 0.912659
Avg Precision: 0.346231
Avg Recall: 1.000000
d_prime: 1.919532
train_loss: 0.086642
valid_loss: 1.038942
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0016765407778920375
Epoch-18 lr: 0.003353081555784075
epoch 18 training time: 15.029
---------------
2023-09-11 11:59:18.399709
current #epochs=19, #steps=720
start validation
acc: 0.810427
AUC: 0.927178
Avg Precision: 0.349265
Avg Recall: 1.000000
d_prime: 2.057813
train_loss: 0.083061
valid_loss: 1.010588
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0016765407778920375
Epoch-19 lr: 0.003353081555784075
epoch 19 training time: 15.808
---------------
2023-09-11 11:59:34.207904
current #epochs=20, #steps=760
start validation
acc: 0.824645
AUC: 0.921533
Avg Precision: 0.328868
Avg Recall: 1.000000
d_prime: 2.001763
train_loss: 0.060628
valid_loss: 1.025154
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0016765407778920375
Epoch-20 lr: 0.003353081555784075
epoch 20 training time: 15.012
---------------
2023-09-11 11:59:49.219893
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03474	Per Sample Data Time 0.02705	Per Sample DNN Time 0.00769	Train Loss 0.0409	
start validation
acc: 0.805687
AUC: 0.909035
Avg Precision: 0.312677
Avg Recall: 1.000000
d_prime: 1.887740
train_loss: 0.071639
valid_loss: 1.031189
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0016765407778920375
Epoch-21 lr: 0.003353081555784075
epoch 21 training time: 14.864
---------------
2023-09-11 12:00:04.083670
current #epochs=22, #steps=840
start validation
acc: 0.834123
AUC: 0.928313
Avg Precision: 0.333882
Avg Recall: 1.000000
d_prime: 2.069481
train_loss: 0.056129
valid_loss: 1.014547
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0016765407778920375
Epoch-22 lr: 0.003353081555784075
epoch 22 training time: 14.979
---------------
2023-09-11 12:00:19.063137
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00555	Train Loss 0.0664	
start validation
acc: 0.829384
AUC: 0.928420
Avg Precision: 0.344270
Avg Recall: 1.000000
d_prime: 2.070580
train_loss: 0.057650
valid_loss: 1.011082
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0016765407778920375
Epoch-23 lr: 0.003353081555784075
epoch 23 training time: 15.065
---------------
2023-09-11 12:00:34.128024
current #epochs=24, #steps=920
start validation
acc: 0.805687
AUC: 0.910116
Avg Precision: 0.335429
Avg Recall: 1.000000
d_prime: 1.897127
train_loss: 0.082283
valid_loss: 1.022928
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0016765407778920375
Epoch-24 lr: 0.003353081555784075
epoch 24 training time: 15.066
---------------
2023-09-11 12:00:49.193494
current #epochs=25, #steps=960
start validation
acc: 0.829384
AUC: 0.900784
Avg Precision: 0.314846
Avg Recall: 1.000000
d_prime: 1.818721
train_loss: 0.073511
valid_loss: 1.027385
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0016765407778920375
Epoch-25 lr: 0.003353081555784075
epoch 25 training time: 17.380
---------------
2023-09-11 12:01:06.573660
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03563	Per Sample Data Time 0.02795	Per Sample DNN Time 0.00768	Train Loss 0.0555	
start validation
acc: 0.843602
AUC: 0.925400
Avg Precision: 0.352260
Avg Recall: 1.000000
d_prime: 2.039807
train_loss: 0.063970
valid_loss: 1.003579
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0016765407778920375
Epoch-26 lr: 0.003353081555784075
epoch 26 training time: 15.052
---------------
2023-09-11 12:01:21.625850
current #epochs=27, #steps=1040
start validation
acc: 0.834123
AUC: 0.917584
Avg Precision: 0.330339
Avg Recall: 1.000000
d_prime: 1.964342
train_loss: 0.065033
valid_loss: 1.009089
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0016765407778920375
Epoch-27 lr: 0.003353081555784075
epoch 27 training time: 14.991
---------------
2023-09-11 12:01:36.616609
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00564	Train Loss 0.0668	
start validation
acc: 0.819905
AUC: 0.926657
Avg Precision: 0.350778
Avg Recall: 1.000000
d_prime: 2.052506
train_loss: 0.065381
valid_loss: 1.005486
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.001392682991444027
Epoch-28 lr: 0.002785365982888054
epoch 28 training time: 15.040
---------------
2023-09-11 12:01:51.656912
current #epochs=29, #steps=1120
start validation
acc: 0.843602
AUC: 0.922987
Avg Precision: 0.323608
Avg Recall: 1.000000
d_prime: 2.015900
train_loss: 0.054886
valid_loss: 1.001216
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.001392682991444027
Epoch-29 lr: 0.002785365982888054
epoch 29 training time: 15.035
---------------
2023-09-11 12:02:06.691460
current #epochs=30, #steps=1160
start validation
acc: 0.843602
AUC: 0.915825
Avg Precision: 0.337436
Avg Recall: 1.000000
d_prime: 1.948114
train_loss: 0.066259
valid_loss: 1.003463
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.001392682991444027
Epoch-30 lr: 0.002785365982888054
epoch 30 training time: 14.997
---------------
2023-09-11 12:02:21.688891
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03856	Per Sample Data Time 0.02921	Per Sample DNN Time 0.00934	Train Loss 0.0180	
start validation
acc: 0.829384
AUC: 0.907250
Avg Precision: 0.320089
Avg Recall: 1.000000
d_prime: 1.872435
train_loss: 0.049537
valid_loss: 1.018717
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.001392682991444027
Epoch-31 lr: 0.002785365982888054
epoch 31 training time: 15.103
---------------
2023-09-11 12:02:36.791963
current #epochs=32, #steps=1240
start validation
acc: 0.824645
AUC: 0.909077
Avg Precision: 0.308831
Avg Recall: 1.000000
d_prime: 1.888104
train_loss: 0.061944
valid_loss: 1.022401
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.001392682991444027
Epoch-32 lr: 0.002785365982888054
epoch 32 training time: 15.125
---------------
2023-09-11 12:02:51.916473
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00555	Train Loss 0.0580	
start validation
acc: 0.819905
AUC: 0.914952
Avg Precision: 0.317001
Avg Recall: 1.000000
d_prime: 1.940154
train_loss: 0.064575
valid_loss: 1.009755
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.001392682991444027
Epoch-33 lr: 0.002785365982888054
epoch 33 training time: 14.975
---------------
2023-09-11 12:03:06.891110
current #epochs=34, #steps=1320
start validation
acc: 0.848341
AUC: 0.921817
Avg Precision: 0.340975
Avg Recall: 1.000000
d_prime: 2.004505
train_loss: 0.058843
valid_loss: 1.008823
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.001392682991444027
Epoch-34 lr: 0.002785365982888054
epoch 34 training time: 16.006
---------------
2023-09-11 12:03:22.897126
current #epochs=35, #steps=1360
start validation
acc: 0.815166
AUC: 0.921777
Avg Precision: 0.328258
Avg Recall: 1.000000
d_prime: 2.004122
train_loss: 0.049785
valid_loss: 1.006253
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.001392682991444027
Epoch-35 lr: 0.002785365982888054
epoch 35 training time: 15.125
---------------
2023-09-11 12:03:38.021564
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03652	Per Sample Data Time 0.02865	Per Sample DNN Time 0.00787	Train Loss 0.0941	
start validation
acc: 0.838863
AUC: 0.932411
Avg Precision: 0.357694
Avg Recall: 1.000000
d_prime: 2.112818
train_loss: 0.053352
valid_loss: 1.004156
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.001392682991444027
Epoch-36 lr: 0.002785365982888054
epoch 36 training time: 14.965
---------------
2023-09-11 12:03:52.986107
current #epochs=37, #steps=1440
start validation
acc: 0.815166
AUC: 0.925004
Avg Precision: 0.350780
Avg Recall: 1.000000
d_prime: 2.035846
train_loss: 0.056483
valid_loss: 1.002538
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.001392682991444027
Epoch-37 lr: 0.002785365982888054
epoch 37 training time: 15.165
---------------
2023-09-11 12:04:08.151268
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00556	Train Loss 0.0717	
start validation
acc: 0.829384
AUC: 0.917701
Avg Precision: 0.325009
Avg Recall: 1.000000
d_prime: 1.965431
train_loss: 0.071134
valid_loss: 1.002426
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.001156885618431635
Epoch-38 lr: 0.00231377123686327
epoch 38 training time: 15.063
---------------
2023-09-11 12:04:23.214109
current #epochs=39, #steps=1520
start validation
acc: 0.824645
AUC: 0.923356
Avg Precision: 0.326963
Avg Recall: 1.000000
d_prime: 2.019514
train_loss: 0.059453
valid_loss: 1.010783
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.001156885618431635
Epoch-39 lr: 0.00231377123686327
epoch 39 training time: 16.314
---------------
2023-09-11 12:04:39.528159
current #epochs=40, #steps=1560
start validation
acc: 0.805687
AUC: 0.911857
Avg Precision: 0.314465
Avg Recall: 1.000000
d_prime: 1.912414
train_loss: 0.053871
valid_loss: 1.020771
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.001156885618431635
Epoch-40 lr: 0.00231377123686327
epoch 40 training time: 15.080
---------------
2023-09-11 12:04:54.607741
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03474	Per Sample Data Time 0.02774	Per Sample DNN Time 0.00700	Train Loss 0.2520	
start validation
acc: 0.829384
AUC: 0.919256
Avg Precision: 0.339842
Avg Recall: 1.000000
d_prime: 1.980019
train_loss: 0.060870
valid_loss: 1.016199
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.001156885618431635
Epoch-41 lr: 0.00231377123686327
epoch 41 training time: 14.973
---------------
2023-09-11 12:05:09.580512
current #epochs=42, #steps=1640
start validation
acc: 0.843602
AUC: 0.921797
Avg Precision: 0.363657
Avg Recall: 1.000000
d_prime: 2.004317
train_loss: 0.048573
valid_loss: 1.029655
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.001156885618431635
Epoch-42 lr: 0.00231377123686327
epoch 42 training time: 15.075
---------------
2023-09-11 12:05:24.655645
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00558	Train Loss 0.0556	
start validation
acc: 0.838863
AUC: 0.920629
Avg Precision: 0.330832
Avg Recall: 1.000000
d_prime: 1.993068
train_loss: 0.053831
valid_loss: 1.033147
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.001156885618431635
Epoch-43 lr: 0.00231377123686327
epoch 43 training time: 15.774
---------------
2023-09-11 12:05:40.429312
current #epochs=44, #steps=1720
start validation
acc: 0.800948
AUC: 0.917516
Avg Precision: 0.320799
Avg Recall: 1.000000
d_prime: 1.963711
train_loss: 0.066908
valid_loss: 1.033067
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.001156885618431635
Epoch-44 lr: 0.00231377123686327
epoch 44 training time: 15.063
---------------
2023-09-11 12:05:55.492776
current #epochs=45, #steps=1760
start validation
acc: 0.829384
AUC: 0.918415
Avg Precision: 0.343940
Avg Recall: 1.000000
d_prime: 1.972106
train_loss: 0.054944
valid_loss: 1.026759
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.001156885618431635
Epoch-45 lr: 0.00231377123686327
epoch 45 training time: 15.620
---------------
2023-09-11 12:06:11.112405
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03832	Per Sample Data Time 0.02822	Per Sample DNN Time 0.01009	Train Loss 0.0801	
start validation
acc: 0.824645
AUC: 0.910535
Avg Precision: 0.321228
Avg Recall: 1.000000
d_prime: 1.900784
train_loss: 0.053957
valid_loss: 1.020297
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.001156885618431635
Epoch-46 lr: 0.00231377123686327
epoch 46 training time: 15.026
---------------
2023-09-11 12:06:26.138562
current #epochs=47, #steps=1840
start validation
acc: 0.829384
AUC: 0.910209
Avg Precision: 0.305005
Avg Recall: 1.000000
d_prime: 1.897933
train_loss: 0.060685
valid_loss: 1.024380
validation finished
normal learning rate scheduler step
Epoch-47 lr: 0.001156885618431635
Epoch-47 lr: 0.00231377123686327
epoch 47 training time: 16.077
---------------
2023-09-11 12:06:42.215339
current #epochs=48, #steps=1880
Epoch: [48][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00564	Train Loss 0.0415	
start validation
acc: 0.838863
AUC: 0.920887
Avg Precision: 0.320606
Avg Recall: 1.000000
d_prime: 1.995542
train_loss: 0.047924
valid_loss: 1.019321
validation finished
normal learning rate scheduler step
Epoch-48 lr: 0.0009610114737929124
Epoch-48 lr: 0.0019220229475858247
epoch 48 training time: 15.053
---------------
2023-09-11 12:06:57.268583
current #epochs=49, #steps=1920
start validation
acc: 0.815166
AUC: 0.924224
Avg Precision: 0.346890
Avg Recall: 1.000000
d_prime: 2.028086
train_loss: 0.063459
valid_loss: 1.011286
validation finished
normal learning rate scheduler step
Epoch-49 lr: 0.0009610114737929124
Epoch-49 lr: 0.0019220229475858247
epoch 49 training time: 15.063
---------------
2023-09-11 12:07:12.331331
current #epochs=50, #steps=1960
start validation
[I 2023-09-11 12:07:27,356] Trial 38 finished with value: 0.8483412322274881 and parameters: {'warmup': 'False', 'num_epochs': 50, 'batch_size': 64, 'lr-adaptschedule': 'True', 'lr': 0.002429617012393468, 'head-lr': 2, 'lr-scheduler-start': 8, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.8306884090198433}. Best is trial 37 with value: 0.8578199052132701.
acc: 0.805687
AUC: 0.919276
Avg Precision: 0.337212
Avg Recall: 1.000000
d_prime: 1.980210
train_loss: 0.054599
valid_loss: 1.037056
validation finished
normal learning rate scheduler step
Epoch-50 lr: 0.0009610114737929124
Epoch-50 lr: 0.0019220229475858247
epoch 50 training time: 15.018
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f859ea60cd0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.806 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 12:07:27.390947
current #epochs=1, #steps=0
start validation
acc: 0.838863
AUC: 0.912891
Avg Precision: 0.314644
Avg Recall: 1.000000
d_prime: 1.921595
train_loss: 0.077947
valid_loss: 1.025472
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002429515325467747
Epoch-1 lr: 0.002429515325467747
epoch 1 training time: 17.002
---------------
2023-09-11 12:07:44.393136
current #epochs=2, #steps=40
start validation
acc: 0.838863
AUC: 0.925320
Avg Precision: 0.343466
Avg Recall: 1.000000
d_prime: 2.039006
train_loss: 0.084289
valid_loss: 1.022399
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002429515325467747
Epoch-2 lr: 0.002429515325467747
epoch 2 training time: 15.283
---------------
2023-09-11 12:07:59.675690
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00552	Train Loss 0.0740	
start validation
acc: 0.829384
AUC: 0.919352
Avg Precision: 0.311679
Avg Recall: 1.000000
d_prime: 1.980930
train_loss: 0.080914
valid_loss: 1.022680
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002429515325467747
Epoch-3 lr: 0.002429515325467747
epoch 3 training time: 15.988
---------------
2023-09-11 12:08:15.663288
current #epochs=4, #steps=120
start validation
acc: 0.848341
AUC: 0.935744
Avg Precision: 0.343265
Avg Recall: 1.000000
d_prime: 2.149594
train_loss: 0.099564
valid_loss: 0.995505
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002429515325467747
Epoch-4 lr: 0.002429515325467747
epoch 4 training time: 17.161
---------------
2023-09-11 12:08:32.824439
current #epochs=5, #steps=160
start validation
acc: 0.791469
AUC: 0.914252
Avg Precision: 0.322456
Avg Recall: 1.000000
d_prime: 1.933811
train_loss: 0.080291
valid_loss: 1.030656
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002429515325467747
Epoch-5 lr: 0.002429515325467747
epoch 5 training time: 15.900
---------------
2023-09-11 12:08:48.724833
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03493	Per Sample Data Time 0.02733	Per Sample DNN Time 0.00759	Train Loss 0.0217	
start validation
acc: 0.829384
AUC: 0.917342
Avg Precision: 0.326916
Avg Recall: 1.000000
d_prime: 1.962099
train_loss: 0.058231
valid_loss: 1.036382
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0019573927984301988
Epoch-6 lr: 0.0019573927984301988
epoch 6 training time: 16.020
---------------
2023-09-11 12:09:04.744928
current #epochs=7, #steps=240
start validation
acc: 0.829384
AUC: 0.910734
Avg Precision: 0.306217
Avg Recall: 1.000000
d_prime: 1.902527
train_loss: 0.063311
valid_loss: 1.030727
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0019573927984301988
Epoch-7 lr: 0.0019573927984301988
epoch 7 training time: 15.283
---------------
2023-09-11 12:09:20.028200
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00561	Train Loss 0.0768	
start validation
acc: 0.843602
AUC: 0.928649
Avg Precision: 0.344721
Avg Recall: 1.000000
d_prime: 2.072963
train_loss: 0.078331
valid_loss: 1.003266
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0019573927984301988
Epoch-8 lr: 0.0019573927984301988
epoch 8 training time: 14.999
---------------
2023-09-11 12:09:35.026926
current #epochs=9, #steps=320
start validation
acc: 0.829384
AUC: 0.925253
Avg Precision: 0.318901
Avg Recall: 1.000000
d_prime: 2.038331
train_loss: 0.073652
valid_loss: 0.998157
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0019573927984301988
Epoch-9 lr: 0.0019573927984301988
epoch 9 training time: 14.991
---------------
2023-09-11 12:09:50.017529
current #epochs=10, #steps=360
start validation
acc: 0.838863
AUC: 0.913471
Avg Precision: 0.288165
Avg Recall: 1.000000
d_prime: 1.926783
train_loss: 0.074613
valid_loss: 1.018168
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0019573927984301988
Epoch-10 lr: 0.0019573927984301988
epoch 10 training time: 15.359
---------------
2023-09-11 12:10:05.376254
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.04067	Per Sample Data Time 0.03041	Per Sample DNN Time 0.01026	Train Loss 0.0588	
start validation
acc: 0.834123
AUC: 0.927145
Avg Precision: 0.326086
Avg Recall: 1.000000
d_prime: 2.057472
train_loss: 0.069342
valid_loss: 1.026818
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0019573927984301988
Epoch-11 lr: 0.0019573927984301988
epoch 11 training time: 15.132
---------------
2023-09-11 12:10:20.508520
current #epochs=12, #steps=440
start validation
acc: 0.829384
AUC: 0.932156
Avg Precision: 0.335300
Avg Recall: 1.000000
d_prime: 2.110068
train_loss: 0.078971
valid_loss: 0.995498
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0019573927984301988
Epoch-12 lr: 0.0019573927984301988
epoch 12 training time: 15.257
---------------
2023-09-11 12:10:35.765774
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00561	Train Loss 0.0650	
start validation
acc: 0.819905
AUC: 0.921992
Avg Precision: 0.321337
Avg Recall: 1.000000
d_prime: 2.006198
train_loss: 0.071783
valid_loss: 1.001022
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0019573927984301988
Epoch-13 lr: 0.0019573927984301988
epoch 13 training time: 16.084
---------------
2023-09-11 12:10:51.849719
current #epochs=14, #steps=520
start validation
acc: 0.843602
AUC: 0.927468
Avg Precision: 0.339051
Avg Recall: 1.000000
d_prime: 2.060781
train_loss: 0.068510
valid_loss: 1.006119
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0019573927984301988
Epoch-14 lr: 0.0019573927984301988
epoch 14 training time: 16.470
---------------
2023-09-11 12:11:08.319189
current #epochs=15, #steps=560
start validation
acc: 0.815166
AUC: 0.925113
Avg Precision: 0.323568
Avg Recall: 1.000000
d_prime: 2.036936
train_loss: 0.067397
valid_loss: 1.013037
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0019573927984301988
Epoch-15 lr: 0.0019573927984301988
epoch 15 training time: 14.965
---------------
2023-09-11 12:11:23.284625
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03601	Per Sample Data Time 0.02934	Per Sample DNN Time 0.00667	Train Loss 0.0441	
start validation
acc: 0.819905
AUC: 0.935166
Avg Precision: 0.345439
Avg Recall: 1.000000
d_prime: 2.143120
train_loss: 0.074220
valid_loss: 1.018588
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0015770168342563388
Epoch-16 lr: 0.0015770168342563388
epoch 16 training time: 15.019
---------------
2023-09-11 12:11:38.304051
current #epochs=17, #steps=640
start validation
acc: 0.819905
AUC: 0.931455
Avg Precision: 0.352273
Avg Recall: 1.000000
d_prime: 2.102532
train_loss: 0.079509
valid_loss: 1.014681
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0015770168342563388
Epoch-17 lr: 0.0015770168342563388
epoch 17 training time: 16.365
---------------
2023-09-11 12:11:54.668752
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00559	Train Loss 0.0731	
start validation
acc: 0.815166
AUC: 0.926208
Avg Precision: 0.356907
Avg Recall: 1.000000
d_prime: 2.047950
train_loss: 0.078337
valid_loss: 1.012788
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0015770168342563388
Epoch-18 lr: 0.0015770168342563388
epoch 18 training time: 16.893
---------------
2023-09-11 12:12:11.562008
current #epochs=19, #steps=720
start validation
acc: 0.824645
AUC: 0.924163
Avg Precision: 0.308073
Avg Recall: 1.000000
d_prime: 2.027481
train_loss: 0.057882
valid_loss: 1.016200
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0015770168342563388
Epoch-19 lr: 0.0015770168342563388
epoch 19 training time: 15.642
---------------
2023-09-11 12:12:27.203540
current #epochs=20, #steps=760
start validation
acc: 0.805687
AUC: 0.926250
Avg Precision: 0.316369
Avg Recall: 1.000000
d_prime: 2.048378
train_loss: 0.057797
valid_loss: 1.003582
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0015770168342563388
Epoch-20 lr: 0.0015770168342563388
epoch 20 training time: 15.083
---------------
2023-09-11 12:12:42.286511
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03620	Per Sample Data Time 0.02860	Per Sample DNN Time 0.00760	Train Loss 0.0050	
start validation
acc: 0.800948
AUC: 0.917279
Avg Precision: 0.321721
Avg Recall: 1.000000
d_prime: 1.961516
train_loss: 0.066990
valid_loss: 1.007688
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0015770168342563388
Epoch-21 lr: 0.0015770168342563388
epoch 21 training time: 16.789
---------------
2023-09-11 12:12:59.075108
current #epochs=22, #steps=840
start validation
acc: 0.834123
AUC: 0.911914
Avg Precision: 0.300016
Avg Recall: 1.000000
d_prime: 1.912913
train_loss: 0.092388
valid_loss: 1.028280
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0015770168342563388
Epoch-22 lr: 0.0015770168342563388
epoch 22 training time: 15.022
---------------
2023-09-11 12:13:14.097704
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00564	Train Loss 0.1012	
start validation
acc: 0.824645
AUC: 0.926560
Avg Precision: 0.328061
Avg Recall: 1.000000
d_prime: 2.051516
train_loss: 0.082367
valid_loss: 1.002741
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0015770168342563388
Epoch-23 lr: 0.0015770168342563388
epoch 23 training time: 15.077
---------------
2023-09-11 12:13:29.175268
current #epochs=24, #steps=920
start validation
acc: 0.819905
AUC: 0.931717
Avg Precision: 0.337166
Avg Recall: 1.000000
d_prime: 2.105339
train_loss: 0.057900
valid_loss: 1.007734
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0015770168342563388
Epoch-24 lr: 0.0015770168342563388
epoch 24 training time: 16.436
---------------
2023-09-11 12:13:45.610817
current #epochs=25, #steps=960
start validation
acc: 0.815166
AUC: 0.920537
Avg Precision: 0.316493
Avg Recall: 1.000000
d_prime: 1.992197
train_loss: 0.046728
valid_loss: 1.006018
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0015770168342563388
Epoch-25 lr: 0.0015770168342563388
epoch 25 training time: 14.967
---------------
2023-09-11 12:14:00.577441
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03915	Per Sample Data Time 0.02946	Per Sample DNN Time 0.00969	Train Loss 0.0925	
start validation
acc: 0.819905
AUC: 0.920518
Avg Precision: 0.319384
Avg Recall: 1.000000
d_prime: 1.992007
train_loss: 0.063224
valid_loss: 1.024173
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0012705585192315048
Epoch-26 lr: 0.0012705585192315048
epoch 26 training time: 15.150
---------------
2023-09-11 12:14:15.727038
current #epochs=27, #steps=1040
start validation
acc: 0.815166
AUC: 0.921883
Avg Precision: 0.325500
Avg Recall: 1.000000
d_prime: 2.005142
train_loss: 0.051082
valid_loss: 1.033255
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0012705585192315048
Epoch-27 lr: 0.0012705585192315048
epoch 27 training time: 15.203
---------------
2023-09-11 12:14:30.931205
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00559	Train Loss 0.0613	
start validation
acc: 0.824645
AUC: 0.920960
Avg Precision: 0.328000
Avg Recall: 1.000000
d_prime: 1.996241
train_loss: 0.061852
valid_loss: 1.024789
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0012705585192315048
Epoch-28 lr: 0.0012705585192315048
epoch 28 training time: 16.231
---------------
2023-09-11 12:14:47.161547
current #epochs=29, #steps=1120
start validation
acc: 0.824645
AUC: 0.913477
Avg Precision: 0.310119
Avg Recall: 1.000000
d_prime: 1.926841
train_loss: 0.062463
valid_loss: 1.038019
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0012705585192315048
Epoch-29 lr: 0.0012705585192315048
epoch 29 training time: 15.536
---------------
2023-09-11 12:15:02.697879
current #epochs=30, #steps=1160
start validation
acc: 0.824645
AUC: 0.919147
Avg Precision: 0.320695
Avg Recall: 1.000000
d_prime: 1.978992
train_loss: 0.041973
valid_loss: 1.011772
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0012705585192315048
Epoch-30 lr: 0.0012705585192315048
epoch 30 training time: 16.738
---------------
2023-09-11 12:15:19.435608
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03684	Per Sample Data Time 0.02986	Per Sample DNN Time 0.00698	Train Loss 0.0384	
start validation
acc: 0.824645
AUC: 0.916816
Avg Precision: 0.310130
Avg Recall: 1.000000
d_prime: 1.957223
train_loss: 0.061300
valid_loss: 1.020999
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0012705585192315048
Epoch-31 lr: 0.0012705585192315048
epoch 31 training time: 17.248
---------------
2023-09-11 12:15:36.684016
current #epochs=32, #steps=1240
start validation
acc: 0.829384
AUC: 0.911331
Avg Precision: 0.332039
Avg Recall: 1.000000
d_prime: 1.907768
train_loss: 0.058615
valid_loss: 1.035624
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0012705585192315048
Epoch-32 lr: 0.0012705585192315048
epoch 32 training time: 15.906
---------------
2023-09-11 12:15:52.590249
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00701	Per Sample Data Time 0.00142	Per Sample DNN Time 0.00559	Train Loss 0.0641	
start validation
acc: 0.838863
AUC: 0.907569
Avg Precision: 0.317323
Avg Recall: 1.000000
d_prime: 1.875156
train_loss: 0.049487
valid_loss: 1.035239
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0012705585192315048
Epoch-33 lr: 0.0012705585192315048
epoch 33 training time: 14.949
---------------
2023-09-11 12:16:07.539518
current #epochs=34, #steps=1320
start validation
acc: 0.848341
AUC: 0.930695
Avg Precision: 0.357197
Avg Recall: 1.000000
d_prime: 2.094434
train_loss: 0.058849
valid_loss: 1.010070
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0012705585192315048
Epoch-34 lr: 0.0012705585192315048
epoch 34 training time: 15.033
---------------
2023-09-11 12:16:22.572812
current #epochs=35, #steps=1360
start validation
acc: 0.867299
AUC: 0.936064
Avg Precision: 0.353800
Avg Recall: 1.000000
d_prime: 2.153209
train_loss: 0.051567
valid_loss: 0.996482
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0012705585192315048
Epoch-35 lr: 0.0012705585192315048
epoch 35 training time: 17.062
---------------
2023-09-11 12:16:39.635043
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03730	Per Sample Data Time 0.02673	Per Sample DNN Time 0.01056	Train Loss 0.0379	
start validation
acc: 0.819905
AUC: 0.926917
Avg Precision: 0.326287
Avg Recall: 1.000000
d_prime: 2.055146
train_loss: 0.064429
valid_loss: 1.024877
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0010236535943847459
Epoch-36 lr: 0.0010236535943847459
epoch 36 training time: 16.742
---------------
2023-09-11 12:16:56.377538
current #epochs=37, #steps=1440
start validation
acc: 0.810427
AUC: 0.934551
Avg Precision: 0.336967
Avg Recall: 1.000000
d_prime: 2.136270
train_loss: 0.037253
valid_loss: 1.009657
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0010236535943847459
Epoch-37 lr: 0.0010236535943847459
epoch 37 training time: 14.960
---------------
2023-09-11 12:17:11.337489
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00558	Train Loss 0.0433	
start validation
acc: 0.819905
AUC: 0.930672
Avg Precision: 0.327588
Avg Recall: 1.000000
d_prime: 2.094188
train_loss: 0.057177
valid_loss: 1.014680
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0010236535943847459
Epoch-38 lr: 0.0010236535943847459
epoch 38 training time: 14.919
---------------
2023-09-11 12:17:26.256863
current #epochs=39, #steps=1520
start validation
acc: 0.834123
AUC: 0.930897
Avg Precision: 0.345908
Avg Recall: 1.000000
d_prime: 2.096582
train_loss: 0.058585
valid_loss: 1.009537
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0010236535943847459
Epoch-39 lr: 0.0010236535943847459
epoch 39 training time: 15.032
---------------
2023-09-11 12:17:41.288594
current #epochs=40, #steps=1560
start validation
acc: 0.848341
AUC: 0.935110
Avg Precision: 0.345784
Avg Recall: 1.000000
d_prime: 2.142496
train_loss: 0.052105
valid_loss: 1.000818
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0010236535943847459
Epoch-40 lr: 0.0010236535943847459
epoch 40 training time: 14.960
---------------
2023-09-11 12:17:56.249049
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03926	Per Sample Data Time 0.02970	Per Sample DNN Time 0.00955	Train Loss 0.0253	
start validation
acc: 0.815166
AUC: 0.935807
Avg Precision: 0.331340
Avg Recall: 1.000000
d_prime: 2.150306
train_loss: 0.045151
valid_loss: 0.987363
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0010236535943847459
Epoch-41 lr: 0.0010236535943847459
epoch 41 training time: 15.037
---------------
2023-09-11 12:18:11.285955
current #epochs=42, #steps=1640
start validation
acc: 0.829384
AUC: 0.921677
Avg Precision: 0.309267
Avg Recall: 1.000000
d_prime: 2.003148
train_loss: 0.038628
valid_loss: 1.034198
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0010236535943847459
Epoch-42 lr: 0.0010236535943847459
epoch 42 training time: 16.084
---------------
2023-09-11 12:18:27.370235
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00563	Train Loss 0.0512	
start validation
acc: 0.824645
AUC: 0.919249
Avg Precision: 0.306810
Avg Recall: 1.000000
d_prime: 1.979955
train_loss: 0.048732
valid_loss: 1.006794
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0010236535943847459
Epoch-43 lr: 0.0010236535943847459
epoch 43 training time: 14.980
---------------
2023-09-11 12:18:42.350592
current #epochs=44, #steps=1720
start validation
acc: 0.829384
AUC: 0.923123
Avg Precision: 0.322989
Avg Recall: 1.000000
d_prime: 2.017226
train_loss: 0.055165
valid_loss: 1.015006
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0010236535943847459
Epoch-44 lr: 0.0010236535943847459
epoch 44 training time: 15.841
---------------
2023-09-11 12:18:58.191841
current #epochs=45, #steps=1760
start validation
acc: 0.815166
AUC: 0.916653
Avg Precision: 0.302393
Avg Recall: 1.000000
d_prime: 1.955724
train_loss: 0.061879
valid_loss: 1.012460
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0010236535943847459
Epoch-45 lr: 0.0010236535943847459
epoch 45 training time: 14.981
---------------
2023-09-11 12:19:13.172746
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03526	Per Sample Data Time 0.02788	Per Sample DNN Time 0.00739	Train Loss 0.0052	
start validation
acc: 0.791469
AUC: 0.923988
Avg Precision: 0.324197
Avg Recall: 1.000000
d_prime: 2.025744
train_loss: 0.060971
valid_loss: 1.021887
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.0008247291765282957
Epoch-46 lr: 0.0008247291765282957
epoch 46 training time: 16.290
---------------
2023-09-11 12:19:29.462913
current #epochs=47, #steps=1840
start validation
acc: 0.824645
AUC: 0.924629
Avg Precision: 0.318559
Avg Recall: 1.000000
d_prime: 2.032109
train_loss: 0.055635
valid_loss: 1.006388
validation finished
normal learning rate scheduler step
Epoch-47 lr: 0.0008247291765282957
Epoch-47 lr: 0.0008247291765282957
epoch 47 training time: 15.134
---------------
2023-09-11 12:19:44.596963
current #epochs=48, #steps=1880
Epoch: [48][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00558	Train Loss 0.0699	
start validation
acc: 0.819905
AUC: 0.925262
Avg Precision: 0.353882
Avg Recall: 1.000000
d_prime: 2.038422
train_loss: 0.071408
valid_loss: 1.024204
validation finished
normal learning rate scheduler step
Epoch-48 lr: 0.0008247291765282957
Epoch-48 lr: 0.0008247291765282957
epoch 48 training time: 14.997
---------------
2023-09-11 12:19:59.593721
current #epochs=49, #steps=1920
start validation
acc: 0.805687
AUC: 0.928203
Avg Precision: 0.334710
Avg Recall: 1.000000
d_prime: 2.068337
train_loss: 0.052305
valid_loss: 1.017699
validation finished
normal learning rate scheduler step
Epoch-49 lr: 0.0008247291765282957
Epoch-49 lr: 0.0008247291765282957
epoch 49 training time: 16.114
---------------
2023-09-11 12:20:15.708379
current #epochs=50, #steps=1960
start validation
[I 2023-09-11 12:20:30,844] Trial 39 finished with value: 0.8672985781990521 and parameters: {'warmup': 'False', 'num_epochs': 50, 'batch_size': 64, 'lr-adaptschedule': 'True', 'lr': 0.002429515325467747, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.8056721346482341}. Best is trial 39 with value: 0.8672985781990521.
acc: 0.815166
AUC: 0.928551
Avg Precision: 0.347724
Avg Recall: 1.000000
d_prime: 2.071946
train_loss: 0.043612
valid_loss: 1.008794
validation finished
normal learning rate scheduler step
Epoch-50 lr: 0.0008247291765282957
Epoch-50 lr: 0.0008247291765282957
epoch 50 training time: 15.127
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f86448c0f40>
The learning rate scheduler starts at 6 epoch with decay rate of 0.798 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 12:20:30.880257
current #epochs=1, #steps=0
start validation
acc: 0.824645
AUC: 0.914318
Avg Precision: 0.332489
Avg Recall: 1.000000
d_prime: 1.934412
train_loss: 0.088889
valid_loss: 1.025725
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0024180546113970872
Epoch-1 lr: 0.0024180546113970872
epoch 1 training time: 17.211
---------------
2023-09-11 12:20:48.091353
current #epochs=2, #steps=40
start validation
acc: 0.819905
AUC: 0.913074
Avg Precision: 0.348929
Avg Recall: 1.000000
d_prime: 1.923230
train_loss: 0.084916
valid_loss: 1.042347
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0024180546113970872
Epoch-2 lr: 0.0024180546113970872
epoch 2 training time: 14.917
---------------
2023-09-11 12:21:03.008461
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00142	Per Sample DNN Time 0.00563	Train Loss 0.0704	
start validation
acc: 0.791469
AUC: 0.916744
Avg Precision: 0.331268
Avg Recall: 1.000000
d_prime: 1.956565
train_loss: 0.072220
valid_loss: 1.033240
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0024180546113970872
Epoch-3 lr: 0.0024180546113970872
epoch 3 training time: 15.023
---------------
2023-09-11 12:21:18.031210
current #epochs=4, #steps=120
start validation
acc: 0.834123
AUC: 0.901355
Avg Precision: 0.317996
Avg Recall: 1.000000
d_prime: 1.823364
train_loss: 0.072402
valid_loss: 1.042534
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0024180546113970872
Epoch-4 lr: 0.0024180546113970872
epoch 4 training time: 17.460
---------------
2023-09-11 12:21:35.491066
current #epochs=5, #steps=160
start validation
acc: 0.815166
AUC: 0.920484
Avg Precision: 0.299988
Avg Recall: 1.000000
d_prime: 1.991687
train_loss: 0.061088
valid_loss: 1.028888
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0024180546113970872
Epoch-5 lr: 0.0024180546113970872
epoch 5 training time: 16.172
---------------
2023-09-11 12:21:51.662856
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03847	Per Sample Data Time 0.03106	Per Sample DNN Time 0.00741	Train Loss 0.0503	
start validation
acc: 0.772512
AUC: 0.915247
Avg Precision: 0.320982
Avg Recall: 1.000000
d_prime: 1.942838
train_loss: 0.111425
valid_loss: 1.026004
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0019287845040377096
Epoch-6 lr: 0.0019287845040377096
epoch 6 training time: 15.249
---------------
2023-09-11 12:22:06.911898
current #epochs=7, #steps=240
start validation
acc: 0.848341
AUC: 0.926064
Avg Precision: 0.340806
Avg Recall: 1.000000
d_prime: 2.046496
train_loss: 0.113835
valid_loss: 1.002874
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0019287845040377096
Epoch-7 lr: 0.0019287845040377096
epoch 7 training time: 18.299
---------------
2023-09-11 12:22:25.210729
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00569	Train Loss 0.0700	
start validation
acc: 0.824645
AUC: 0.930450
Avg Precision: 0.342066
Avg Recall: 1.000000
d_prime: 2.091839
train_loss: 0.065716
valid_loss: 0.997073
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0019287845040377096
Epoch-8 lr: 0.0019287845040377096
epoch 8 training time: 15.224
---------------
2023-09-11 12:22:40.434852
current #epochs=9, #steps=320
start validation
acc: 0.834123
AUC: 0.926686
Avg Precision: 0.342444
Avg Recall: 1.000000
d_prime: 2.052795
train_loss: 0.058961
valid_loss: 0.993961
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0019287845040377096
Epoch-9 lr: 0.0019287845040377096
epoch 9 training time: 14.912
---------------
2023-09-11 12:22:55.346677
current #epochs=10, #steps=360
start validation
acc: 0.800948
AUC: 0.926718
Avg Precision: 0.312764
Avg Recall: 1.000000
d_prime: 2.053125
train_loss: 0.074051
valid_loss: 1.011251
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0019287845040377096
Epoch-10 lr: 0.0019287845040377096
epoch 10 training time: 15.188
---------------
2023-09-11 12:23:10.534145
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03769	Per Sample Data Time 0.02740	Per Sample DNN Time 0.01029	Train Loss 0.0397	
start validation
acc: 0.824645
AUC: 0.923733
Avg Precision: 0.338286
Avg Recall: 1.000000
d_prime: 2.023230
train_loss: 0.051191
valid_loss: 1.015029
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0019287845040377096
Epoch-11 lr: 0.0019287845040377096
epoch 11 training time: 16.596
---------------
2023-09-11 12:23:27.130104
current #epochs=12, #steps=440
start validation
acc: 0.829384
AUC: 0.922024
Avg Precision: 0.321280
Avg Recall: 1.000000
d_prime: 2.006512
train_loss: 0.065188
valid_loss: 1.005231
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0019287845040377096
Epoch-12 lr: 0.0019287845040377096
epoch 12 training time: 16.891
---------------
2023-09-11 12:23:44.020722
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00698	Per Sample Data Time 0.00141	Per Sample DNN Time 0.00558	Train Loss 0.0548	
start validation
acc: 0.834123
AUC: 0.913981
Avg Precision: 0.322989
Avg Recall: 1.000000
d_prime: 1.931368
train_loss: 0.057305
valid_loss: 1.020890
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0019287845040377096
Epoch-13 lr: 0.0019287845040377096
epoch 13 training time: 14.973
---------------
2023-09-11 12:23:58.993462
current #epochs=14, #steps=520
start validation
acc: 0.824645
AUC: 0.925089
Avg Precision: 0.339672
Avg Recall: 1.000000
d_prime: 2.036697
train_loss: 0.060250
valid_loss: 1.006086
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0019287845040377096
Epoch-14 lr: 0.0019287845040377096
epoch 14 training time: 15.141
---------------
2023-09-11 12:24:14.135223
current #epochs=15, #steps=560
start validation
acc: 0.815166
AUC: 0.919651
Avg Precision: 0.338948
Avg Recall: 1.000000
d_prime: 1.983758
train_loss: 0.055915
valid_loss: 1.016420
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0019287845040377096
Epoch-15 lr: 0.0019287845040377096
epoch 15 training time: 15.310
---------------
2023-09-11 12:24:29.444872
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03594	Per Sample Data Time 0.02939	Per Sample DNN Time 0.00655	Train Loss 0.1134	
start validation
acc: 0.824645
AUC: 0.929079
Avg Precision: 0.320002
Avg Recall: 1.000000
d_prime: 2.077436
train_loss: 0.062120
valid_loss: 1.014052
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.001538513499852907
Epoch-16 lr: 0.001538513499852907
epoch 16 training time: 17.320
---------------
2023-09-11 12:24:46.765590
current #epochs=17, #steps=640
start validation
acc: 0.800948
AUC: 0.921558
Avg Precision: 0.352143
Avg Recall: 1.000000
d_prime: 2.002001
train_loss: 0.067602
valid_loss: 1.024329
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.001538513499852907
Epoch-17 lr: 0.001538513499852907
epoch 17 training time: 16.377
---------------
2023-09-11 12:25:03.142906
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00558	Train Loss 0.0716	
start validation
acc: 0.834123
AUC: 0.923164
Avg Precision: 0.317618
Avg Recall: 1.000000
d_prime: 2.017626
train_loss: 0.078648
valid_loss: 1.029482
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001538513499852907
Epoch-18 lr: 0.001538513499852907
epoch 18 training time: 15.435
---------------
2023-09-11 12:25:18.577759
current #epochs=19, #steps=720
start validation
acc: 0.810427
AUC: 0.923504
Avg Precision: 0.348944
Avg Recall: 1.000000
d_prime: 2.020970
train_loss: 0.067211
valid_loss: 1.018322
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.001538513499852907
Epoch-19 lr: 0.001538513499852907
epoch 19 training time: 16.574
---------------
2023-09-11 12:25:35.151735
current #epochs=20, #steps=760
start validation
acc: 0.805687
AUC: 0.920641
Avg Precision: 0.356244
Avg Recall: 1.000000
d_prime: 1.993192
train_loss: 0.066273
valid_loss: 1.012945
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.001538513499852907
Epoch-20 lr: 0.001538513499852907
epoch 20 training time: 16.759
---------------
2023-09-11 12:25:51.910794
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03579	Per Sample Data Time 0.02879	Per Sample DNN Time 0.00700	Train Loss 0.1048	
start validation
acc: 0.810427
AUC: 0.924386
Avg Precision: 0.343198
Avg Recall: 1.000000
d_prime: 2.029689
train_loss: 0.056739
valid_loss: 1.008074
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.001538513499852907
Epoch-21 lr: 0.001538513499852907
epoch 21 training time: 15.893
---------------
2023-09-11 12:26:07.803616
current #epochs=22, #steps=840
start validation
acc: 0.824645
AUC: 0.930192
Avg Precision: 0.342940
Avg Recall: 1.000000
d_prime: 2.089112
train_loss: 0.052203
valid_loss: 1.013433
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.001538513499852907
Epoch-22 lr: 0.001538513499852907
epoch 22 training time: 15.700
---------------
2023-09-11 12:26:23.503785
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00565	Train Loss 0.0349	
start validation
acc: 0.800948
AUC: 0.916270
Avg Precision: 0.354800
Avg Recall: 1.000000
d_prime: 1.952201
train_loss: 0.044580
valid_loss: 1.024542
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.001538513499852907
Epoch-23 lr: 0.001538513499852907
epoch 23 training time: 15.129
---------------
2023-09-11 12:26:38.632848
current #epochs=24, #steps=920
start validation
acc: 0.810427
AUC: 0.924536
Avg Precision: 0.339741
Avg Recall: 1.000000
d_prime: 2.031185
train_loss: 0.055441
valid_loss: 1.007896
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.001538513499852907
Epoch-24 lr: 0.001538513499852907
epoch 24 training time: 15.293
---------------
2023-09-11 12:26:53.925432
current #epochs=25, #steps=960
start validation
acc: 0.805687
AUC: 0.925667
Avg Precision: 0.314398
Avg Recall: 1.000000
d_prime: 2.042487
train_loss: 0.044487
valid_loss: 1.002663
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.001538513499852907
Epoch-25 lr: 0.001538513499852907
epoch 25 training time: 15.003
---------------
2023-09-11 12:27:08.928454
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03675	Per Sample Data Time 0.02712	Per Sample DNN Time 0.00962	Train Loss 0.0337	
start validation
acc: 0.853081
AUC: 0.925042
Avg Precision: 0.348787
Avg Recall: 1.000000
d_prime: 2.036229
train_loss: 0.050116
valid_loss: 1.023623
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.001227210081932182
Epoch-26 lr: 0.001227210081932182
epoch 26 training time: 17.785
---------------
2023-09-11 12:27:26.713622
current #epochs=27, #steps=1040
start validation
acc: 0.834123
AUC: 0.933266
Avg Precision: 0.357441
Avg Recall: 1.000000
d_prime: 2.122115
train_loss: 0.050968
valid_loss: 1.003363
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.001227210081932182
Epoch-27 lr: 0.001227210081932182
epoch 27 training time: 15.208
---------------
2023-09-11 12:27:41.921107
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00570	Train Loss 0.0563	
start validation
acc: 0.834123
AUC: 0.934726
Avg Precision: 0.367030
Avg Recall: 1.000000
d_prime: 2.138208
train_loss: 0.048845
valid_loss: 1.018272
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.001227210081932182
Epoch-28 lr: 0.001227210081932182
epoch 28 training time: 15.456
---------------
2023-09-11 12:27:57.376982
current #epochs=29, #steps=1120
start validation
acc: 0.857820
AUC: 0.937331
Avg Precision: 0.368198
Avg Recall: 1.000000
d_prime: 2.167633
train_loss: 0.046458
valid_loss: 1.010932
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.001227210081932182
Epoch-29 lr: 0.001227210081932182
epoch 29 training time: 18.313
---------------
2023-09-11 12:28:15.689575
current #epochs=30, #steps=1160
start validation
acc: 0.829384
AUC: 0.926966
Avg Precision: 0.349805
Avg Recall: 1.000000
d_prime: 2.055648
train_loss: 0.064293
valid_loss: 1.008828
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.001227210081932182
Epoch-30 lr: 0.001227210081932182
epoch 30 training time: 15.157
---------------
2023-09-11 12:28:30.847019
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03946	Per Sample Data Time 0.02998	Per Sample DNN Time 0.00948	Train Loss 0.0158	
start validation
acc: 0.838863
AUC: 0.923431
Avg Precision: 0.358943
Avg Recall: 1.000000
d_prime: 2.020252
train_loss: 0.048590
valid_loss: 1.015182
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.001227210081932182
Epoch-31 lr: 0.001227210081932182
epoch 31 training time: 15.090
---------------
2023-09-11 12:28:45.937285
current #epochs=32, #steps=1240
start validation
acc: 0.824645
AUC: 0.925305
Avg Precision: 0.346968
Avg Recall: 1.000000
d_prime: 2.038855
train_loss: 0.041717
valid_loss: 1.010304
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.001227210081932182
Epoch-32 lr: 0.001227210081932182
epoch 32 training time: 15.198
---------------
2023-09-11 12:29:01.135753
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00703	Per Sample Data Time 0.00142	Per Sample DNN Time 0.00562	Train Loss 0.0442	
start validation
acc: 0.819905
AUC: 0.928034
Avg Precision: 0.344522
Avg Recall: 1.000000
d_prime: 2.066600
train_loss: 0.052780
valid_loss: 1.016564
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.001227210081932182
Epoch-33 lr: 0.001227210081932182
epoch 33 training time: 15.020
---------------
2023-09-11 12:29:16.155972
current #epochs=34, #steps=1320
start validation
acc: 0.829384
AUC: 0.934948
Avg Precision: 0.350362
Avg Recall: 1.000000
d_prime: 2.140687
train_loss: 0.050084
valid_loss: 0.988008
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.001227210081932182
Epoch-34 lr: 0.001227210081932182
epoch 34 training time: 14.900
---------------
2023-09-11 12:29:31.056100
current #epochs=35, #steps=1360
start validation
acc: 0.848341
AUC: 0.935937
Avg Precision: 0.376855
Avg Recall: 1.000000
d_prime: 2.151771
train_loss: 0.058227
valid_loss: 0.999829
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.001227210081932182
Epoch-35 lr: 0.001227210081932182
epoch 35 training time: 16.205
---------------
2023-09-11 12:29:47.261773
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03691	Per Sample Data Time 0.02912	Per Sample DNN Time 0.00779	Train Loss 0.0897	
start validation
acc: 0.824645
AUC: 0.929583
Avg Precision: 0.338372
Avg Recall: 1.000000
d_prime: 2.082698
train_loss: 0.046297
valid_loss: 1.009596
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0009788959182613487
Epoch-36 lr: 0.0009788959182613487
epoch 36 training time: 15.182
---------------
2023-09-11 12:30:02.443642
current #epochs=37, #steps=1440
start validation
acc: 0.829384
AUC: 0.931608
Avg Precision: 0.351473
Avg Recall: 1.000000
d_prime: 2.104174
train_loss: 0.038455
valid_loss: 1.003614
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0009788959182613487
Epoch-37 lr: 0.0009788959182613487
epoch 37 training time: 16.245
---------------
2023-09-11 12:30:18.688919
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00560	Train Loss 0.0545	
start validation
acc: 0.829384
AUC: 0.929415
Avg Precision: 0.353905
Avg Recall: 1.000000
d_prime: 2.080938
train_loss: 0.060578
valid_loss: 0.997204
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0009788959182613487
Epoch-38 lr: 0.0009788959182613487
epoch 38 training time: 17.274
---------------
2023-09-11 12:30:35.962747
current #epochs=39, #steps=1520
start validation
acc: 0.834123
AUC: 0.926293
Avg Precision: 0.333857
Avg Recall: 1.000000
d_prime: 2.048811
train_loss: 0.039667
valid_loss: 1.007210
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0009788959182613487
Epoch-39 lr: 0.0009788959182613487
epoch 39 training time: 15.129
---------------
2023-09-11 12:30:51.092287
current #epochs=40, #steps=1560
start validation
acc: 0.819905
AUC: 0.930400
Avg Precision: 0.351178
Avg Recall: 1.000000
d_prime: 2.091308
train_loss: 0.032556
valid_loss: 1.014140
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0009788959182613487
Epoch-40 lr: 0.0009788959182613487
epoch 40 training time: 15.077
---------------
2023-09-11 12:31:06.169025
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03798	Per Sample Data Time 0.02853	Per Sample DNN Time 0.00945	Train Loss 0.0007	
start validation
acc: 0.838863
AUC: 0.932731
Avg Precision: 0.360104
Avg Recall: 1.000000
d_prime: 2.116296
train_loss: 0.053049
valid_loss: 1.003967
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0009788959182613487
Epoch-41 lr: 0.0009788959182613487
epoch 41 training time: 15.044
---------------
2023-09-11 12:31:21.212856
current #epochs=42, #steps=1640
start validation
acc: 0.819905
AUC: 0.932162
Avg Precision: 0.333786
Avg Recall: 1.000000
d_prime: 2.110127
train_loss: 0.056178
valid_loss: 0.988407
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0009788959182613487
Epoch-42 lr: 0.0009788959182613487
epoch 42 training time: 14.939
---------------
2023-09-11 12:31:36.151733
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00562	Train Loss 0.0482	
start validation
acc: 0.829384
AUC: 0.929800
Avg Precision: 0.329386
Avg Recall: 1.000000
d_prime: 2.084982
train_loss: 0.042479
valid_loss: 0.999594
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0009788959182613487
Epoch-43 lr: 0.0009788959182613487
epoch 43 training time: 16.864
---------------
2023-09-11 12:31:53.015624
current #epochs=44, #steps=1720
start validation
acc: 0.796209
AUC: 0.932179
Avg Precision: 0.349322
Avg Recall: 1.000000
d_prime: 2.110320
train_loss: 0.055285
valid_loss: 0.985766
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0009788959182613487
Epoch-44 lr: 0.0009788959182613487
epoch 44 training time: 15.224
---------------
2023-09-11 12:32:08.240095
current #epochs=45, #steps=1760
start validation
acc: 0.824645
AUC: 0.932322
Avg Precision: 0.344175
Avg Recall: 1.000000
d_prime: 2.111859
train_loss: 0.042754
valid_loss: 1.005729
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0009788959182613487
Epoch-45 lr: 0.0009788959182613487
epoch 45 training time: 15.006
---------------
2023-09-11 12:32:23.246412
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03565	Per Sample Data Time 0.02812	Per Sample DNN Time 0.00753	Train Loss 0.0390	
start validation
acc: 0.848341
AUC: 0.935715
Avg Precision: 0.351101
Avg Recall: 1.000000
d_prime: 2.149268
train_loss: 0.044953
valid_loss: 0.994607
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.0007808257387195123
Epoch-46 lr: 0.0007808257387195123
epoch 46 training time: 15.062
---------------
2023-09-11 12:32:38.308380
current #epochs=47, #steps=1840
start validation
acc: 0.824645
AUC: 0.935852
Avg Precision: 0.352160
Avg Recall: 1.000000
d_prime: 2.150814
train_loss: 0.036904
valid_loss: 0.994523
validation finished
normal learning rate scheduler step
Epoch-47 lr: 0.0007808257387195123
Epoch-47 lr: 0.0007808257387195123
epoch 47 training time: 15.131
---------------
2023-09-11 12:32:53.439333
current #epochs=48, #steps=1880
Epoch: [48][20/40]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00556	Train Loss 0.0346	
start validation
acc: 0.834123
AUC: 0.938841
Avg Precision: 0.361078
Avg Recall: 1.000000
d_prime: 2.185123
train_loss: 0.048485
valid_loss: 0.983661
validation finished
normal learning rate scheduler step
Epoch-48 lr: 0.0007808257387195123
Epoch-48 lr: 0.0007808257387195123
epoch 48 training time: 14.981
---------------
2023-09-11 12:33:08.420247
current #epochs=49, #steps=1920
start validation
acc: 0.824645
AUC: 0.934258
Avg Precision: 0.354933
Avg Recall: 1.000000
d_prime: 2.133026
train_loss: 0.040797
valid_loss: 0.995656
validation finished
normal learning rate scheduler step
Epoch-49 lr: 0.0007808257387195123
Epoch-49 lr: 0.0007808257387195123
epoch 49 training time: 15.832
---------------
2023-09-11 12:33:24.252723
current #epochs=50, #steps=1960
start validation
[I 2023-09-11 12:33:39,371] Trial 40 finished with value: 0.8578199052132701 and parameters: {'warmup': 'False', 'num_epochs': 50, 'batch_size': 62, 'lr-adaptschedule': 'True', 'lr': 0.0024180546113970872, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.7976596123787748}. Best is trial 39 with value: 0.8672985781990521.
acc: 0.810427
AUC: 0.931158
Avg Precision: 0.335758
Avg Recall: 1.000000
d_prime: 2.099361
train_loss: 0.045605
valid_loss: 1.003649
validation finished
normal learning rate scheduler step
Epoch-50 lr: 0.0007808257387195123
Epoch-50 lr: 0.0007808257387195123
epoch 50 training time: 15.110
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863d981850>
The learning rate scheduler starts at 6 epoch with decay rate of 0.790 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 12:33:39.407844
current #epochs=1, #steps=0
start validation
acc: 0.800948
AUC: 0.926632
Avg Precision: 0.323485
Avg Recall: 1.000000
d_prime: 2.052250
train_loss: 0.093744
valid_loss: 0.995314
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002339249308206011
Epoch-1 lr: 0.002339249308206011
epoch 1 training time: 17.270
---------------
2023-09-11 12:33:56.678078
current #epochs=2, #steps=40
start validation
acc: 0.815166
AUC: 0.906752
Avg Precision: 0.317172
Avg Recall: 1.000000
d_prime: 1.868196
train_loss: 0.064173
valid_loss: 1.014912
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002339249308206011
Epoch-2 lr: 0.002339249308206011
epoch 2 training time: 17.877
---------------
2023-09-11 12:34:14.554907
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00722	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00569	Train Loss 0.0727	
start validation
acc: 0.810427
AUC: 0.925312
Avg Precision: 0.326267
Avg Recall: 1.000000
d_prime: 2.038925
train_loss: 0.073699
valid_loss: 1.006227
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002339249308206011
Epoch-3 lr: 0.002339249308206011
epoch 3 training time: 16.406
---------------
2023-09-11 12:34:30.960918
current #epochs=4, #steps=120
start validation
acc: 0.829384
AUC: 0.936764
Avg Precision: 0.333941
Avg Recall: 1.000000
d_prime: 2.161147
train_loss: 0.065114
valid_loss: 1.008296
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002339249308206011
Epoch-4 lr: 0.002339249308206011
epoch 4 training time: 17.066
---------------
2023-09-11 12:34:48.026910
current #epochs=5, #steps=160
start validation
acc: 0.824645
AUC: 0.929059
Avg Precision: 0.326915
Avg Recall: 1.000000
d_prime: 2.077222
train_loss: 0.050469
valid_loss: 1.014836
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002339249308206011
Epoch-5 lr: 0.002339249308206011
epoch 5 training time: 16.651
---------------
2023-09-11 12:35:04.678105
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03631	Per Sample Data Time 0.02842	Per Sample DNN Time 0.00788	Train Loss 0.0825	
start validation
acc: 0.796209
AUC: 0.929397
Avg Precision: 0.373025
Avg Recall: 1.000000
d_prime: 2.080749
train_loss: 0.074224
valid_loss: 0.998872
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0018476519695987063
Epoch-6 lr: 0.0018476519695987063
epoch 6 training time: 15.028
---------------
2023-09-11 12:35:19.705998
current #epochs=7, #steps=240
start validation
acc: 0.810427
AUC: 0.933681
Avg Precision: 0.341619
Avg Recall: 1.000000
d_prime: 2.126663
train_loss: 0.069009
valid_loss: 1.007974
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0018476519695987063
Epoch-7 lr: 0.0018476519695987063
epoch 7 training time: 15.497
---------------
2023-09-11 12:35:35.202812
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00566	Train Loss 0.0492	
start validation
acc: 0.838863
AUC: 0.936202
Avg Precision: 0.352406
Avg Recall: 1.000000
d_prime: 2.154765
train_loss: 0.048397
valid_loss: 1.003586
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0018476519695987063
Epoch-8 lr: 0.0018476519695987063
epoch 8 training time: 17.127
---------------
2023-09-11 12:35:52.329667
current #epochs=9, #steps=320
start validation
acc: 0.824645
AUC: 0.918232
Avg Precision: 0.316955
Avg Recall: 1.000000
d_prime: 1.970391
train_loss: 0.078899
valid_loss: 1.013899
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0018476519695987063
Epoch-9 lr: 0.0018476519695987063
epoch 9 training time: 15.165
---------------
2023-09-11 12:36:07.494744
current #epochs=10, #steps=360
start validation
acc: 0.834123
AUC: 0.920794
Avg Precision: 0.329352
Avg Recall: 1.000000
d_prime: 1.994653
train_loss: 0.056586
valid_loss: 1.010870
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0018476519695987063
Epoch-10 lr: 0.0018476519695987063
epoch 10 training time: 15.102
---------------
2023-09-11 12:36:22.596800
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03854	Per Sample Data Time 0.02807	Per Sample DNN Time 0.01047	Train Loss 0.0173	
start validation
acc: 0.824645
AUC: 0.925163
Avg Precision: 0.337726
Avg Recall: 1.000000
d_prime: 2.037439
train_loss: 0.072574
valid_loss: 1.022511
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0018476519695987063
Epoch-11 lr: 0.0018476519695987063
epoch 11 training time: 15.051
---------------
2023-09-11 12:36:37.648011
current #epochs=12, #steps=440
start validation
acc: 0.848341
AUC: 0.931890
Avg Precision: 0.341025
Avg Recall: 1.000000
d_prime: 2.107203
train_loss: 0.069863
valid_loss: 1.006944
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0018476519695987063
Epoch-12 lr: 0.0018476519695987063
epoch 12 training time: 18.006
---------------
2023-09-11 12:36:55.654407
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00567	Train Loss 0.0753	
start validation
acc: 0.810427
AUC: 0.929016
Avg Precision: 0.325521
Avg Recall: 1.000000
d_prime: 2.076778
train_loss: 0.068174
valid_loss: 1.004392
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0018476519695987063
Epoch-13 lr: 0.0018476519695987063
epoch 13 training time: 16.523
---------------
2023-09-11 12:37:12.177460
current #epochs=14, #steps=520
start validation
acc: 0.834123
AUC: 0.929461
Avg Precision: 0.340426
Avg Recall: 1.000000
d_prime: 2.081422
train_loss: 0.068693
valid_loss: 1.004612
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0018476519695987063
Epoch-14 lr: 0.0018476519695987063
epoch 14 training time: 15.022
---------------
2023-09-11 12:37:27.200219
current #epochs=15, #steps=560
start validation
acc: 0.815166
AUC: 0.925833
Avg Precision: 0.314164
Avg Recall: 1.000000
d_prime: 2.044164
train_loss: 0.071260
valid_loss: 0.995723
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0018476519695987063
Epoch-15 lr: 0.0018476519695987063
epoch 15 training time: 16.422
---------------
2023-09-11 12:37:43.621572
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03842	Per Sample Data Time 0.02900	Per Sample DNN Time 0.00942	Train Loss 0.0056	
start validation
acc: 0.815166
AUC: 0.935541
Avg Precision: 0.363780
Avg Recall: 1.000000
d_prime: 2.147321
train_loss: 0.085148
valid_loss: 1.003116
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.001459364672583814
Epoch-16 lr: 0.001459364672583814
epoch 16 training time: 15.096
---------------
2023-09-11 12:37:58.717817
current #epochs=17, #steps=640
start validation
acc: 0.829384
AUC: 0.936495
Avg Precision: 0.355902
Avg Recall: 1.000000
d_prime: 2.158091
train_loss: 0.063975
valid_loss: 0.999373
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.001459364672583814
Epoch-17 lr: 0.001459364672583814
epoch 17 training time: 15.073
---------------
2023-09-11 12:38:13.791310
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00557	Train Loss 0.0537	
start validation
acc: 0.824645
AUC: 0.933624
Avg Precision: 0.349232
Avg Recall: 1.000000
d_prime: 2.126038
train_loss: 0.056690
valid_loss: 1.002786
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001459364672583814
Epoch-18 lr: 0.001459364672583814
epoch 18 training time: 14.943
---------------
2023-09-11 12:38:28.734687
current #epochs=19, #steps=720
start validation
acc: 0.838863
AUC: 0.934868
Avg Precision: 0.350086
Avg Recall: 1.000000
d_prime: 2.139791
train_loss: 0.044013
valid_loss: 0.999893
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.001459364672583814
Epoch-19 lr: 0.001459364672583814
epoch 19 training time: 16.851
---------------
2023-09-11 12:38:45.585469
current #epochs=20, #steps=760
start validation
acc: 0.829384
AUC: 0.930137
Avg Precision: 0.336551
Avg Recall: 1.000000
d_prime: 2.088525
train_loss: 0.039008
valid_loss: 1.003947
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.001459364672583814
Epoch-20 lr: 0.001459364672583814
epoch 20 training time: 15.037
---------------
2023-09-11 12:39:00.622483
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03482	Per Sample Data Time 0.02772	Per Sample DNN Time 0.00711	Train Loss 0.0620	
start validation
acc: 0.848341
AUC: 0.929315
Avg Precision: 0.329708
Avg Recall: 1.000000
d_prime: 2.079900
train_loss: 0.061415
valid_loss: 1.002941
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.001459364672583814
Epoch-21 lr: 0.001459364672583814
epoch 21 training time: 14.982
---------------
2023-09-11 12:39:15.604015
current #epochs=22, #steps=840
start validation
acc: 0.829384
AUC: 0.928120
Avg Precision: 0.336434
Avg Recall: 1.000000
d_prime: 2.067480
train_loss: 0.059775
valid_loss: 1.009717
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.001459364672583814
Epoch-22 lr: 0.001459364672583814
epoch 22 training time: 15.181
---------------
2023-09-11 12:39:30.785421
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00560	Train Loss 0.0539	
start validation
acc: 0.838863
AUC: 0.932149
Avg Precision: 0.328026
Avg Recall: 1.000000
d_prime: 2.109986
train_loss: 0.056126
valid_loss: 0.995090
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.001459364672583814
Epoch-23 lr: 0.001459364672583814
epoch 23 training time: 16.362
---------------
2023-09-11 12:39:47.147163
current #epochs=24, #steps=920
start validation
acc: 0.848341
AUC: 0.922771
Avg Precision: 0.322111
Avg Recall: 1.000000
d_prime: 2.013784
train_loss: 0.040205
valid_loss: 1.016002
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.001459364672583814
Epoch-24 lr: 0.001459364672583814
epoch 24 training time: 16.155
---------------
2023-09-11 12:40:03.302543
current #epochs=25, #steps=960
start validation
acc: 0.834123
AUC: 0.926004
Avg Precision: 0.342635
Avg Recall: 1.000000
d_prime: 2.045886
train_loss: 0.063613
valid_loss: 1.018084
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.001459364672583814
Epoch-25 lr: 0.001459364672583814
epoch 25 training time: 15.435
---------------
2023-09-11 12:40:18.737509
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03486	Per Sample Data Time 0.02796	Per Sample DNN Time 0.00689	Train Loss 0.0104	
start validation
acc: 0.834123
AUC: 0.935157
Avg Precision: 0.351098
Avg Recall: 1.000000
d_prime: 2.143020
train_loss: 0.041260
valid_loss: 1.001245
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0011526766310043903
Epoch-26 lr: 0.0011526766310043903
epoch 26 training time: 14.905
---------------
2023-09-11 12:40:33.642740
current #epochs=27, #steps=1040
start validation
acc: 0.848341
AUC: 0.934863
Avg Precision: 0.380594
Avg Recall: 1.000000
d_prime: 2.139736
train_loss: 0.045978
valid_loss: 1.018149
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0011526766310043903
Epoch-27 lr: 0.0011526766310043903
epoch 27 training time: 14.873
---------------
2023-09-11 12:40:48.515668
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00561	Train Loss 0.0503	
start validation
acc: 0.819905
AUC: 0.931894
Avg Precision: 0.376553
Avg Recall: 1.000000
d_prime: 2.107248
train_loss: 0.053987
valid_loss: 1.014824
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0011526766310043903
Epoch-28 lr: 0.0011526766310043903
epoch 28 training time: 15.048
---------------
2023-09-11 12:41:03.563697
current #epochs=29, #steps=1120
start validation
acc: 0.819905
AUC: 0.933392
Avg Precision: 0.355550
Avg Recall: 1.000000
d_prime: 2.123497
train_loss: 0.048470
valid_loss: 1.015056
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0011526766310043903
Epoch-29 lr: 0.0011526766310043903
epoch 29 training time: 15.499
---------------
2023-09-11 12:41:19.062832
current #epochs=30, #steps=1160
start validation
acc: 0.838863
AUC: 0.937549
Avg Precision: 0.367868
Avg Recall: 1.000000
d_prime: 2.170143
train_loss: 0.039599
valid_loss: 1.009533
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0011526766310043903
Epoch-30 lr: 0.0011526766310043903
epoch 30 training time: 17.559
---------------
2023-09-11 12:41:36.622075
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03851	Per Sample Data Time 0.02885	Per Sample DNN Time 0.00966	Train Loss 0.0172	
start validation
acc: 0.848341
AUC: 0.934297
Avg Precision: 0.360265
Avg Recall: 1.000000
d_prime: 2.133454
train_loss: 0.044049
valid_loss: 1.008949
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0011526766310043903
Epoch-31 lr: 0.0011526766310043903
epoch 31 training time: 16.023
---------------
2023-09-11 12:41:52.644960
current #epochs=32, #steps=1240
start validation
acc: 0.857820
AUC: 0.933151
Avg Precision: 0.352343
Avg Recall: 1.000000
d_prime: 2.120868
train_loss: 0.036621
valid_loss: 1.005114
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0011526766310043903
Epoch-32 lr: 0.0011526766310043903
epoch 32 training time: 17.013
---------------
2023-09-11 12:42:09.657923
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00560	Train Loss 0.0383	
start validation
acc: 0.853081
AUC: 0.934267
Avg Precision: 0.362359
Avg Recall: 1.000000
d_prime: 2.133119
train_loss: 0.039968
valid_loss: 1.006003
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0011526766310043903
Epoch-33 lr: 0.0011526766310043903
epoch 33 training time: 14.980
---------------
2023-09-11 12:42:24.637985
current #epochs=34, #steps=1320
start validation
acc: 0.853081
AUC: 0.932650
Avg Precision: 0.369574
Avg Recall: 1.000000
d_prime: 2.115412
train_loss: 0.041178
valid_loss: 1.006859
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0011526766310043903
Epoch-34 lr: 0.0011526766310043903
epoch 34 training time: 15.938
---------------
2023-09-11 12:42:40.575698
current #epochs=35, #steps=1360
start validation
acc: 0.824645
AUC: 0.929892
Avg Precision: 0.338837
Avg Recall: 1.000000
d_prime: 2.085949
train_loss: 0.057132
valid_loss: 1.011516
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0011526766310043903
Epoch-35 lr: 0.0011526766310043903
epoch 35 training time: 15.018
---------------
2023-09-11 12:42:55.593542
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03901	Per Sample Data Time 0.02862	Per Sample DNN Time 0.01039	Train Loss 0.1142	
start validation
acc: 0.838863
AUC: 0.925491
Avg Precision: 0.348273
Avg Recall: 1.000000
d_prime: 2.040726
train_loss: 0.055130
valid_loss: 1.007079
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0009104396184342495
Epoch-36 lr: 0.0009104396184342495
epoch 36 training time: 15.181
---------------
2023-09-11 12:43:10.773952
current #epochs=37, #steps=1440
start validation
acc: 0.819905
AUC: 0.930909
Avg Precision: 0.356004
Avg Recall: 1.000000
d_prime: 2.096703
train_loss: 0.041955
valid_loss: 1.013039
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0009104396184342495
Epoch-37 lr: 0.0009104396184342495
epoch 37 training time: 15.024
---------------
2023-09-11 12:43:25.797685
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00560	Train Loss 0.0480	
start validation
acc: 0.810427
AUC: 0.927655
Avg Precision: 0.357027
Avg Recall: 1.000000
d_prime: 2.062699
train_loss: 0.045520
valid_loss: 1.024251
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0009104396184342495
Epoch-38 lr: 0.0009104396184342495
epoch 38 training time: 15.004
---------------
2023-09-11 12:43:40.801250
current #epochs=39, #steps=1520
start validation
acc: 0.829384
AUC: 0.923671
Avg Precision: 0.347234
Avg Recall: 1.000000
d_prime: 2.022614
train_loss: 0.045407
valid_loss: 1.023096
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0009104396184342495
Epoch-39 lr: 0.0009104396184342495
epoch 39 training time: 14.986
---------------
2023-09-11 12:43:55.787571
current #epochs=40, #steps=1560
start validation
acc: 0.829384
AUC: 0.923688
Avg Precision: 0.338156
Avg Recall: 1.000000
d_prime: 2.022785
train_loss: 0.041802
valid_loss: 1.021554
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0009104396184342495
Epoch-40 lr: 0.0009104396184342495
epoch 40 training time: 16.541
---------------
2023-09-11 12:44:12.328473
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03632	Per Sample Data Time 0.02912	Per Sample DNN Time 0.00720	Train Loss 0.0071	
start validation
acc: 0.810427
AUC: 0.916815
Avg Precision: 0.328734
Avg Recall: 1.000000
d_prime: 1.957221
train_loss: 0.045421
valid_loss: 1.025997
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0009104396184342495
Epoch-41 lr: 0.0009104396184342495
epoch 41 training time: 15.020
---------------
2023-09-11 12:44:27.348878
current #epochs=42, #steps=1640
start validation
acc: 0.815166
AUC: 0.923230
Avg Precision: 0.353113
Avg Recall: 1.000000
d_prime: 2.018282
train_loss: 0.037761
valid_loss: 1.026017
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0009104396184342495
Epoch-42 lr: 0.0009104396184342495
epoch 42 training time: 15.651
---------------
2023-09-11 12:44:43.000332
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00557	Train Loss 0.0471	
start validation
acc: 0.824645
AUC: 0.930635
Avg Precision: 0.341168
Avg Recall: 1.000000
d_prime: 2.093796
train_loss: 0.042487
valid_loss: 1.021186
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0009104396184342495
Epoch-43 lr: 0.0009104396184342495
epoch 43 training time: 16.544
---------------
2023-09-11 12:44:59.544390
current #epochs=44, #steps=1720
start validation
acc: 0.819905
AUC: 0.931422
Avg Precision: 0.346375
Avg Recall: 1.000000
d_prime: 2.102175
train_loss: 0.051933
valid_loss: 1.010682
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0009104396184342495
Epoch-44 lr: 0.0009104396184342495
epoch 44 training time: 15.961
---------------
2023-09-11 12:45:15.505489
current #epochs=45, #steps=1760
start validation
acc: 0.838863
AUC: 0.929239
Avg Precision: 0.343894
Avg Recall: 1.000000
d_prime: 2.079105
train_loss: 0.059283
valid_loss: 1.010776
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0009104396184342495
Epoch-45 lr: 0.0009104396184342495
epoch 45 training time: 15.110
---------------
2023-09-11 12:45:30.615769
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03597	Per Sample Data Time 0.02919	Per Sample DNN Time 0.00677	Train Loss 0.0895	
start validation
acc: 0.848341
AUC: 0.922958
Avg Precision: 0.333613
Avg Recall: 1.000000
d_prime: 2.015608
train_loss: 0.037736
valid_loss: 1.009958
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.0007191091382606028
Epoch-46 lr: 0.0007191091382606028
epoch 46 training time: 15.959
---------------
2023-09-11 12:45:46.575082
current #epochs=47, #steps=1840
start validation
acc: 0.848341
AUC: 0.923805
Avg Precision: 0.344322
Avg Recall: 1.000000
d_prime: 2.023937
train_loss: 0.033957
valid_loss: 1.018539
validation finished
normal learning rate scheduler step
Epoch-47 lr: 0.0007191091382606028
Epoch-47 lr: 0.0007191091382606028
epoch 47 training time: 15.005
---------------
2023-09-11 12:46:01.579714
current #epochs=48, #steps=1880
Epoch: [48][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00558	Train Loss 0.0443	
start validation
acc: 0.824645
AUC: 0.922112
Avg Precision: 0.362750
Avg Recall: 1.000000
d_prime: 2.007363
train_loss: 0.045658
valid_loss: 1.006200
validation finished
normal learning rate scheduler step
Epoch-48 lr: 0.0007191091382606028
Epoch-48 lr: 0.0007191091382606028
epoch 48 training time: 15.086
---------------
2023-09-11 12:46:16.666274
current #epochs=49, #steps=1920
start validation
acc: 0.829384
AUC: 0.927560
Avg Precision: 0.357541
Avg Recall: 1.000000
d_prime: 2.061722
train_loss: 0.041309
valid_loss: 1.002298
validation finished
normal learning rate scheduler step
Epoch-49 lr: 0.0007191091382606028
Epoch-49 lr: 0.0007191091382606028
epoch 49 training time: 15.349
---------------
2023-09-11 12:46:32.015751
current #epochs=50, #steps=1960
start validation
[I 2023-09-11 12:46:47,183] Trial 41 finished with value: 0.8578199052132701 and parameters: {'warmup': 'False', 'num_epochs': 50, 'batch_size': 62, 'lr-adaptschedule': 'True', 'lr': 0.002339249308206011, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.7898482488023841}. Best is trial 39 with value: 0.8672985781990521.
acc: 0.829384
AUC: 0.927678
Avg Precision: 0.373105
Avg Recall: 1.000000
d_prime: 2.062928
train_loss: 0.038759
valid_loss: 1.009296
validation finished
normal learning rate scheduler step
Epoch-50 lr: 0.0007191091382606028
Epoch-50 lr: 0.0007191091382606028
epoch 50 training time: 15.159
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f85b4070a00>
The learning rate scheduler starts at 6 epoch with decay rate of 0.800 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 12:46:47.218510
current #epochs=1, #steps=0
start validation
acc: 0.853081
AUC: 0.940125
Avg Precision: 0.381286
Avg Recall: 1.000000
d_prime: 2.200263
train_loss: 0.071169
valid_loss: 0.982222
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002419520613558834
Epoch-1 lr: 0.002419520613558834
epoch 1 training time: 18.523
---------------
2023-09-11 12:47:05.741672
current #epochs=2, #steps=40
start validation
acc: 0.815166
AUC: 0.920170
Avg Precision: 0.338620
Avg Recall: 1.000000
d_prime: 1.988687
train_loss: 0.063724
valid_loss: 1.016902
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002419520613558834
Epoch-2 lr: 0.002419520613558834
epoch 2 training time: 15.255
---------------
2023-09-11 12:47:20.997045
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00556	Train Loss 0.0573	
start validation
acc: 0.781991
AUC: 0.916225
Avg Precision: 0.325777
Avg Recall: 1.000000
d_prime: 1.951781
train_loss: 0.057516
valid_loss: 1.029177
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002419520613558834
Epoch-3 lr: 0.002419520613558834
epoch 3 training time: 15.260
---------------
2023-09-11 12:47:36.256562
current #epochs=4, #steps=120
start validation
acc: 0.834123
AUC: 0.920027
Avg Precision: 0.342702
Avg Recall: 1.000000
d_prime: 1.987326
train_loss: 0.076011
valid_loss: 1.024108
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002419520613558834
Epoch-4 lr: 0.002419520613558834
epoch 4 training time: 15.767
---------------
2023-09-11 12:47:52.023502
current #epochs=5, #steps=160
start validation
acc: 0.843602
AUC: 0.928774
Avg Precision: 0.326401
Avg Recall: 1.000000
d_prime: 2.074258
train_loss: 0.087912
valid_loss: 1.015042
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002419520613558834
Epoch-5 lr: 0.002419520613558834
epoch 5 training time: 15.085
---------------
2023-09-11 12:48:07.108879
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03571	Per Sample Data Time 0.02889	Per Sample DNN Time 0.00682	Train Loss 0.0612	
start validation
acc: 0.815166
AUC: 0.913255
Avg Precision: 0.319308
Avg Recall: 1.000000
d_prime: 1.924849
train_loss: 0.078245
valid_loss: 1.021904
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0019364175070965706
Epoch-6 lr: 0.0019364175070965706
epoch 6 training time: 15.069
---------------
2023-09-11 12:48:22.177399
current #epochs=7, #steps=240
start validation
acc: 0.819905
AUC: 0.911342
Avg Precision: 0.318323
Avg Recall: 1.000000
d_prime: 1.907865
train_loss: 0.066247
valid_loss: 1.013107
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0019364175070965706
Epoch-7 lr: 0.0019364175070965706
epoch 7 training time: 15.047
---------------
2023-09-11 12:48:37.224433
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00700	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00555	Train Loss 0.0642	
start validation
acc: 0.819905
AUC: 0.915615
Avg Precision: 0.303815
Avg Recall: 1.000000
d_prime: 1.946194
train_loss: 0.068327
valid_loss: 1.032367
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0019364175070965706
Epoch-8 lr: 0.0019364175070965706
epoch 8 training time: 14.985
---------------
2023-09-11 12:48:52.209825
current #epochs=9, #steps=320
start validation
acc: 0.862559
AUC: 0.929235
Avg Precision: 0.323033
Avg Recall: 1.000000
d_prime: 2.079065
train_loss: 0.050856
valid_loss: 1.014136
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0019364175070965706
Epoch-9 lr: 0.0019364175070965706
epoch 9 training time: 18.239
---------------
2023-09-11 12:49:10.449326
current #epochs=10, #steps=360
start validation
acc: 0.810427
AUC: 0.933348
Avg Precision: 0.346252
Avg Recall: 1.000000
d_prime: 2.123014
train_loss: 0.057817
valid_loss: 1.006336
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0019364175070965706
Epoch-10 lr: 0.0019364175070965706
epoch 10 training time: 15.394
---------------
2023-09-11 12:49:25.843130
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03568	Per Sample Data Time 0.02804	Per Sample DNN Time 0.00764	Train Loss 0.0087	
start validation
acc: 0.805687
AUC: 0.920659
Avg Precision: 0.339639
Avg Recall: 1.000000
d_prime: 1.993361
train_loss: 0.064902
valid_loss: 1.008585
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0019364175070965706
Epoch-11 lr: 0.0019364175070965706
epoch 11 training time: 14.934
---------------
2023-09-11 12:49:40.777230
current #epochs=12, #steps=440
start validation
acc: 0.819905
AUC: 0.930149
Avg Precision: 0.332792
Avg Recall: 1.000000
d_prime: 2.088655
train_loss: 0.062918
valid_loss: 1.012151
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0019364175070965706
Epoch-12 lr: 0.0019364175070965706
epoch 12 training time: 16.165
---------------
2023-09-11 12:49:56.942334
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00568	Train Loss 0.0566	
start validation
acc: 0.834123
AUC: 0.938466
Avg Precision: 0.351534
Avg Recall: 1.000000
d_prime: 2.180746
train_loss: 0.054309
valid_loss: 0.996151
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0019364175070965706
Epoch-13 lr: 0.0019364175070965706
epoch 13 training time: 15.129
---------------
2023-09-11 12:50:12.071659
current #epochs=14, #steps=520
start validation
acc: 0.819905
AUC: 0.922061
Avg Precision: 0.337563
Avg Recall: 1.000000
d_prime: 2.006871
train_loss: 0.047333
valid_loss: 1.015337
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0019364175070965706
Epoch-14 lr: 0.0019364175070965706
epoch 14 training time: 15.140
---------------
2023-09-11 12:50:27.211526
current #epochs=15, #steps=560
start validation
acc: 0.796209
AUC: 0.929659
Avg Precision: 0.333066
Avg Recall: 1.000000
d_prime: 2.083499
train_loss: 0.047950
valid_loss: 1.000775
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0019364175070965706
Epoch-15 lr: 0.0019364175070965706
epoch 15 training time: 15.737
---------------
2023-09-11 12:50:42.948041
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03918	Per Sample Data Time 0.02819	Per Sample DNN Time 0.01099	Train Loss 0.0794	
start validation
acc: 0.843602
AUC: 0.939752
Avg Precision: 0.361030
Avg Recall: 1.000000
d_prime: 2.195847
train_loss: 0.078370
valid_loss: 0.999023
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0015497750838645284
Epoch-16 lr: 0.0015497750838645284
epoch 16 training time: 16.665
---------------
2023-09-11 12:50:59.613710
current #epochs=17, #steps=640
start validation
acc: 0.843602
AUC: 0.929669
Avg Precision: 0.316184
Avg Recall: 1.000000
d_prime: 2.083607
train_loss: 0.055699
valid_loss: 0.997714
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0015497750838645284
Epoch-17 lr: 0.0015497750838645284
epoch 17 training time: 14.972
---------------
2023-09-11 12:51:14.585603
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00559	Train Loss 0.0674	
start validation
acc: 0.834123
AUC: 0.933296
Avg Precision: 0.348104
Avg Recall: 1.000000
d_prime: 2.122443
train_loss: 0.056728
valid_loss: 1.000545
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0015497750838645284
Epoch-18 lr: 0.0015497750838645284
epoch 18 training time: 16.599
---------------
2023-09-11 12:51:31.184527
current #epochs=19, #steps=720
start validation
acc: 0.857820
AUC: 0.938025
Avg Precision: 0.355632
Avg Recall: 1.000000
d_prime: 2.175628
train_loss: 0.044048
valid_loss: 1.000446
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0015497750838645284
Epoch-19 lr: 0.0015497750838645284
epoch 19 training time: 16.861
---------------
2023-09-11 12:51:48.045539
current #epochs=20, #steps=760
start validation
acc: 0.867299
AUC: 0.941528
Avg Precision: 0.368917
Avg Recall: 1.000000
d_prime: 2.217105
train_loss: 0.048075
valid_loss: 0.992800
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0015497750838645284
Epoch-20 lr: 0.0015497750838645284
epoch 20 training time: 17.960
---------------
2023-09-11 12:52:06.005753
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03671	Per Sample Data Time 0.02932	Per Sample DNN Time 0.00739	Train Loss 0.0810	
start validation
acc: 0.843602
AUC: 0.938830
Avg Precision: 0.352053
Avg Recall: 1.000000
d_prime: 2.184997
train_loss: 0.058897
valid_loss: 1.002710
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0015497750838645284
Epoch-21 lr: 0.0015497750838645284
epoch 21 training time: 15.085
---------------
2023-09-11 12:52:21.090479
current #epochs=22, #steps=840
start validation
acc: 0.834123
AUC: 0.926374
Avg Precision: 0.314659
Avg Recall: 1.000000
d_prime: 2.049627
train_loss: 0.056963
valid_loss: 1.008868
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0015497750838645284
Epoch-22 lr: 0.0015497750838645284
epoch 22 training time: 15.203
---------------
2023-09-11 12:52:36.293272
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00572	Train Loss 0.0331	
start validation
acc: 0.834123
AUC: 0.923333
Avg Precision: 0.325304
Avg Recall: 1.000000
d_prime: 2.019294
train_loss: 0.037407
valid_loss: 1.008203
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0015497750838645284
Epoch-23 lr: 0.0015497750838645284
epoch 23 training time: 16.043
---------------
2023-09-11 12:52:52.336690
current #epochs=24, #steps=920
start validation
acc: 0.853081
AUC: 0.941546
Avg Precision: 0.344827
Avg Recall: 1.000000
d_prime: 2.217325
train_loss: 0.057353
valid_loss: 0.994898
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0015497750838645284
Epoch-24 lr: 0.0015497750838645284
epoch 24 training time: 15.111
---------------
2023-09-11 12:53:07.447551
current #epochs=25, #steps=960
start validation
acc: 0.857820
AUC: 0.941141
Avg Precision: 0.368926
Avg Recall: 1.000000
d_prime: 2.212431
train_loss: 0.054787
valid_loss: 1.003974
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0015497750838645284
Epoch-25 lr: 0.0015497750838645284
epoch 25 training time: 15.894
---------------
2023-09-11 12:53:23.341548
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03512	Per Sample Data Time 0.02803	Per Sample DNN Time 0.00709	Train Loss 0.0172	
start validation
acc: 0.810427
AUC: 0.936018
Avg Precision: 0.336112
Avg Recall: 1.000000
d_prime: 2.152687
train_loss: 0.053239
valid_loss: 0.984619
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0012403331418793697
Epoch-26 lr: 0.0012403331418793697
epoch 26 training time: 14.934
---------------
2023-09-11 12:53:38.275924
current #epochs=27, #steps=1040
start validation
acc: 0.834123
AUC: 0.920121
Avg Precision: 0.327465
Avg Recall: 1.000000
d_prime: 1.988223
train_loss: 0.063577
valid_loss: 1.029779
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0012403331418793697
Epoch-27 lr: 0.0012403331418793697
epoch 27 training time: 15.197
---------------
2023-09-11 12:53:53.472784
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00560	Train Loss 0.0549	
start validation
acc: 0.815166
AUC: 0.939927
Avg Precision: 0.350347
Avg Recall: 1.000000
d_prime: 2.197920
train_loss: 0.058690
valid_loss: 1.012552
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0012403331418793697
Epoch-28 lr: 0.0012403331418793697
epoch 28 training time: 14.975
---------------
2023-09-11 12:54:08.447769
current #epochs=29, #steps=1120
start validation
acc: 0.824645
AUC: 0.933922
Avg Precision: 0.376272
Avg Recall: 1.000000
d_prime: 2.129322
train_loss: 0.040607
valid_loss: 1.004262
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0012403331418793697
Epoch-29 lr: 0.0012403331418793697
epoch 29 training time: 15.749
---------------
2023-09-11 12:54:24.197181
current #epochs=30, #steps=1160
start validation
acc: 0.815166
AUC: 0.941298
Avg Precision: 0.385915
Avg Recall: 1.000000
d_prime: 2.214325
train_loss: 0.047141
valid_loss: 1.016624
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0012403331418793697
Epoch-30 lr: 0.0012403331418793697
epoch 30 training time: 17.130
---------------
2023-09-11 12:54:41.327751
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03683	Per Sample Data Time 0.02952	Per Sample DNN Time 0.00731	Train Loss 0.0479	
start validation
acc: 0.834123
AUC: 0.938329
Avg Precision: 0.363212
Avg Recall: 1.000000
d_prime: 2.179158
train_loss: 0.048236
valid_loss: 1.002469
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0012403331418793697
Epoch-31 lr: 0.0012403331418793697
epoch 31 training time: 15.041
---------------
2023-09-11 12:54:56.368811
current #epochs=32, #steps=1240
start validation
acc: 0.815166
AUC: 0.931458
Avg Precision: 0.363457
Avg Recall: 1.000000
d_prime: 2.102568
train_loss: 0.046993
valid_loss: 1.010568
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0012403331418793697
Epoch-32 lr: 0.0012403331418793697
epoch 32 training time: 14.922
---------------
2023-09-11 12:55:11.290582
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00565	Train Loss 0.0405	
start validation
acc: 0.819905
AUC: 0.934791
Avg Precision: 0.351636
Avg Recall: 1.000000
d_prime: 2.138940
train_loss: 0.050440
valid_loss: 1.016840
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0012403331418793697
Epoch-33 lr: 0.0012403331418793697
epoch 33 training time: 15.229
---------------
2023-09-11 12:55:26.519651
current #epochs=34, #steps=1320
start validation
acc: 0.810427
AUC: 0.929695
Avg Precision: 0.346668
Avg Recall: 1.000000
d_prime: 2.083877
train_loss: 0.057066
valid_loss: 1.006185
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0012403331418793697
Epoch-34 lr: 0.0012403331418793697
epoch 34 training time: 15.303
---------------
2023-09-11 12:55:41.823272
current #epochs=35, #steps=1360
start validation
acc: 0.829384
AUC: 0.921716
Avg Precision: 0.336833
Avg Recall: 1.000000
d_prime: 2.003533
train_loss: 0.038480
valid_loss: 1.012210
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0012403331418793697
Epoch-35 lr: 0.0012403331418793697
epoch 35 training time: 15.070
---------------
2023-09-11 12:55:56.892863
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03701	Per Sample Data Time 0.02720	Per Sample DNN Time 0.00981	Train Loss 0.0617	
start validation
acc: 0.824645
AUC: 0.926648
Avg Precision: 0.328654
Avg Recall: 1.000000
d_prime: 2.052407
train_loss: 0.041750
valid_loss: 1.017188
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0009926771431943012
Epoch-36 lr: 0.0009926771431943012
epoch 36 training time: 15.219
---------------
2023-09-11 12:56:12.112023
current #epochs=37, #steps=1440
start validation
acc: 0.824645
AUC: 0.932721
Avg Precision: 0.346559
Avg Recall: 1.000000
d_prime: 2.116183
train_loss: 0.046472
valid_loss: 0.999909
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0009926771431943012
Epoch-37 lr: 0.0009926771431943012
epoch 37 training time: 15.092
---------------
2023-09-11 12:56:27.203779
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00703	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00557	Train Loss 0.0474	
start validation
acc: 0.843602
AUC: 0.936886
Avg Precision: 0.350705
Avg Recall: 1.000000
d_prime: 2.162540
train_loss: 0.044723
valid_loss: 1.008131
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0009926771431943012
Epoch-38 lr: 0.0009926771431943012
epoch 38 training time: 14.948
---------------
2023-09-11 12:56:42.151361
current #epochs=39, #steps=1520
start validation
acc: 0.819905
AUC: 0.940437
Avg Precision: 0.346090
Avg Recall: 1.000000
d_prime: 2.203987
train_loss: 0.039731
valid_loss: 0.983971
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0009926771431943012
Epoch-39 lr: 0.0009926771431943012
epoch 39 training time: 15.085
---------------
2023-09-11 12:56:57.236923
current #epochs=40, #steps=1560
start validation
acc: 0.819905
AUC: 0.934502
Avg Precision: 0.348740
Avg Recall: 1.000000
d_prime: 2.135722
train_loss: 0.043168
valid_loss: 0.995005
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0009926771431943012
Epoch-40 lr: 0.0009926771431943012
epoch 40 training time: 15.021
---------------
2023-09-11 12:57:12.257847
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03658	Per Sample Data Time 0.02895	Per Sample DNN Time 0.00763	Train Loss 0.1316	
start validation
acc: 0.824645
AUC: 0.933471
Avg Precision: 0.370832
Avg Recall: 1.000000
d_prime: 2.124364
train_loss: 0.049957
valid_loss: 1.000799
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0009926771431943012
Epoch-41 lr: 0.0009926771431943012
epoch 41 training time: 14.950
---------------
2023-09-11 12:57:27.208031
current #epochs=42, #steps=1640
start validation
acc: 0.819905
AUC: 0.926214
Avg Precision: 0.350306
Avg Recall: 1.000000
d_prime: 2.048009
train_loss: 0.034210
valid_loss: 1.022472
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0009926771431943012
Epoch-42 lr: 0.0009926771431943012
epoch 42 training time: 15.011
---------------
2023-09-11 12:57:42.218762
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00564	Train Loss 0.0466	
start validation
acc: 0.838863
AUC: 0.927055
Avg Precision: 0.322566
Avg Recall: 1.000000
d_prime: 2.056554
train_loss: 0.039748
valid_loss: 1.016017
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0009926771431943012
Epoch-43 lr: 0.0009926771431943012
epoch 43 training time: 15.158
---------------
2023-09-11 12:57:57.376879
current #epochs=44, #steps=1720
start validation
acc: 0.843602
AUC: 0.934575
Avg Precision: 0.353416
Avg Recall: 1.000000
d_prime: 2.136530
train_loss: 0.038580
valid_loss: 1.001736
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0009926771431943012
Epoch-44 lr: 0.0009926771431943012
epoch 44 training time: 16.058
---------------
2023-09-11 12:58:13.434935
current #epochs=45, #steps=1760
start validation
acc: 0.815166
AUC: 0.933528
Avg Precision: 0.328421
Avg Recall: 1.000000
d_prime: 2.124987
train_loss: 0.040161
valid_loss: 1.007747
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0009926771431943012
Epoch-45 lr: 0.0009926771431943012
epoch 45 training time: 15.261
---------------
2023-09-11 12:58:28.696221
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03475	Per Sample Data Time 0.02748	Per Sample DNN Time 0.00727	Train Loss 0.0733	
start validation
acc: 0.800948
AUC: 0.915594
Avg Precision: 0.332370
Avg Recall: 1.000000
d_prime: 1.946003
train_loss: 0.043883
valid_loss: 1.028832
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.0007944703542528064
Epoch-46 lr: 0.0007944703542528064
epoch 46 training time: 14.992
---------------
2023-09-11 12:58:43.688160
current #epochs=47, #steps=1840
start validation
acc: 0.824645
AUC: 0.923880
Avg Precision: 0.347454
Avg Recall: 1.000000
d_prime: 2.024677
train_loss: 0.052047
valid_loss: 1.004684
validation finished
normal learning rate scheduler step
Epoch-47 lr: 0.0007944703542528064
Epoch-47 lr: 0.0007944703542528064
epoch 47 training time: 15.143
---------------
2023-09-11 12:58:58.831243
current #epochs=48, #steps=1880
Epoch: [48][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00562	Train Loss 0.0305	
start validation
acc: 0.829384
AUC: 0.933381
Avg Precision: 0.366307
Avg Recall: 1.000000
d_prime: 2.123375
train_loss: 0.043490
valid_loss: 0.990970
validation finished
normal learning rate scheduler step
Epoch-48 lr: 0.0007944703542528064
Epoch-48 lr: 0.0007944703542528064
epoch 48 training time: 14.954
---------------
2023-09-11 12:59:13.784915
current #epochs=49, #steps=1920
start validation
acc: 0.834123
AUC: 0.933332
Avg Precision: 0.351593
Avg Recall: 1.000000
d_prime: 2.122844
train_loss: 0.052476
valid_loss: 1.002078
validation finished
normal learning rate scheduler step
Epoch-49 lr: 0.0007944703542528064
Epoch-49 lr: 0.0007944703542528064
epoch 49 training time: 15.149
---------------
2023-09-11 12:59:28.933536
current #epochs=50, #steps=1960
start validation
[I 2023-09-11 12:59:44,004] Trial 42 finished with value: 0.8672985781990521 and parameters: {'warmup': 'False', 'num_epochs': 50, 'batch_size': 62, 'lr-adaptschedule': 'True', 'lr': 0.002419520613558834, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.8003310640318643}. Best is trial 39 with value: 0.8672985781990521.
acc: 0.834123
AUC: 0.929689
Avg Precision: 0.349487
Avg Recall: 1.000000
d_prime: 2.083809
train_loss: 0.030901
valid_loss: 1.002245
validation finished
normal learning rate scheduler step
Epoch-50 lr: 0.0007944703542528064
Epoch-50 lr: 0.0007944703542528064
epoch 50 training time: 15.059
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863d97d4c0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.787 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 12:59:44.040174
current #epochs=1, #steps=0
start validation
acc: 0.834123
AUC: 0.909470
Avg Precision: 0.355734
Avg Recall: 1.000000
d_prime: 1.891505
train_loss: 0.087278
valid_loss: 1.022668
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0026508405853396485
Epoch-1 lr: 0.0026508405853396485
epoch 1 training time: 18.802
---------------
2023-09-11 13:00:02.842619
current #epochs=2, #steps=40
start validation
acc: 0.786730
AUC: 0.926943
Avg Precision: 0.321504
Avg Recall: 1.000000
d_prime: 2.055413
train_loss: 0.076394
valid_loss: 1.021904
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0026508405853396485
Epoch-2 lr: 0.0026508405853396485
epoch 2 training time: 16.385
---------------
2023-09-11 13:00:19.228071
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00703	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00553	Train Loss 0.0756	
start validation
acc: 0.824645
AUC: 0.927008
Avg Precision: 0.354060
Avg Recall: 1.000000
d_prime: 2.056078
train_loss: 0.072584
valid_loss: 1.014174
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0026508405853396485
Epoch-3 lr: 0.0026508405853396485
epoch 3 training time: 16.299
---------------
2023-09-11 13:00:35.527301
current #epochs=4, #steps=120
start validation
acc: 0.791469
AUC: 0.922928
Avg Precision: 0.358572
Avg Recall: 1.000000
d_prime: 2.015320
train_loss: 0.059291
valid_loss: 1.004241
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0026508405853396485
Epoch-4 lr: 0.0026508405853396485
epoch 4 training time: 16.173
---------------
2023-09-11 13:00:51.700669
current #epochs=5, #steps=160
start validation
acc: 0.791469
AUC: 0.932963
Avg Precision: 0.382038
Avg Recall: 1.000000
d_prime: 2.118815
train_loss: 0.054114
valid_loss: 0.998271
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0026508405853396485
Epoch-5 lr: 0.0026508405853396485
epoch 5 training time: 16.353
---------------
2023-09-11 13:01:08.053866
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03911	Per Sample Data Time 0.02875	Per Sample DNN Time 0.01036	Train Loss 0.1339	
start validation
acc: 0.824645
AUC: 0.929148
Avg Precision: 0.364619
Avg Recall: 1.000000
d_prime: 2.078147
train_loss: 0.065545
valid_loss: 0.988009
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00208736283810541
Epoch-6 lr: 0.00208736283810541
epoch 6 training time: 15.148
---------------
2023-09-11 13:01:23.201847
current #epochs=7, #steps=240
start validation
acc: 0.843602
AUC: 0.925845
Avg Precision: 0.345328
Avg Recall: 1.000000
d_prime: 2.044283
train_loss: 0.072974
valid_loss: 1.008044
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00208736283810541
Epoch-7 lr: 0.00208736283810541
epoch 7 training time: 17.261
---------------
2023-09-11 13:01:40.463030
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00568	Train Loss 0.0452	
start validation
acc: 0.824645
AUC: 0.928677
Avg Precision: 0.330866
Avg Recall: 1.000000
d_prime: 2.073249
train_loss: 0.051117
valid_loss: 1.008884
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00208736283810541
Epoch-8 lr: 0.00208736283810541
epoch 8 training time: 16.663
---------------
2023-09-11 13:01:57.125918
current #epochs=9, #steps=320
start validation
acc: 0.824645
AUC: 0.934138
Avg Precision: 0.341282
Avg Recall: 1.000000
d_prime: 2.131698
train_loss: 0.067530
valid_loss: 0.999043
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00208736283810541
Epoch-9 lr: 0.00208736283810541
epoch 9 training time: 15.151
---------------
2023-09-11 13:02:12.276471
current #epochs=10, #steps=360
start validation
acc: 0.853081
AUC: 0.940279
Avg Precision: 0.334437
Avg Recall: 1.000000
d_prime: 2.202097
train_loss: 0.052129
valid_loss: 0.993572
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00208736283810541
Epoch-10 lr: 0.00208736283810541
epoch 10 training time: 17.222
---------------
2023-09-11 13:02:29.497930
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03920	Per Sample Data Time 0.02878	Per Sample DNN Time 0.01042	Train Loss 0.0326	
start validation
acc: 0.843602
AUC: 0.931147
Avg Precision: 0.325261
Avg Recall: 1.000000
d_prime: 2.099238
train_loss: 0.044471
valid_loss: 0.997120
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00208736283810541
Epoch-11 lr: 0.00208736283810541
epoch 11 training time: 16.143
---------------
2023-09-11 13:02:45.641198
current #epochs=12, #steps=440
start validation
acc: 0.819905
AUC: 0.928994
Avg Precision: 0.338399
Avg Recall: 1.000000
d_prime: 2.076542
train_loss: 0.069289
valid_loss: 0.991454
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00208736283810541
Epoch-12 lr: 0.00208736283810541
epoch 12 training time: 15.136
---------------
2023-09-11 13:03:00.776661
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00563	Train Loss 0.0737	
start validation
acc: 0.829384
AUC: 0.930683
Avg Precision: 0.343442
Avg Recall: 1.000000
d_prime: 2.094304
train_loss: 0.066629
valid_loss: 0.990451
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00208736283810541
Epoch-13 lr: 0.00208736283810541
epoch 13 training time: 15.125
---------------
2023-09-11 13:03:15.901276
current #epochs=14, #steps=520
start validation
acc: 0.815166
AUC: 0.921524
Avg Precision: 0.329944
Avg Recall: 1.000000
d_prime: 2.001676
train_loss: 0.072305
valid_loss: 0.993179
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.00208736283810541
Epoch-14 lr: 0.00208736283810541
epoch 14 training time: 15.084
---------------
2023-09-11 13:03:30.985086
current #epochs=15, #steps=560
start validation
acc: 0.824645
AUC: 0.930033
Avg Precision: 0.347682
Avg Recall: 1.000000
d_prime: 2.087427
train_loss: 0.054121
valid_loss: 1.007785
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.00208736283810541
Epoch-15 lr: 0.00208736283810541
epoch 15 training time: 14.998
---------------
2023-09-11 13:03:45.982977
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03946	Per Sample Data Time 0.02872	Per Sample DNN Time 0.01074	Train Loss 0.0321	
start validation
acc: 0.810427
AUC: 0.937334
Avg Precision: 0.360556
Avg Recall: 1.000000
d_prime: 2.167665
train_loss: 0.047491
valid_loss: 0.989454
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0016436611247013953
Epoch-16 lr: 0.0016436611247013953
epoch 16 training time: 16.888
---------------
2023-09-11 13:04:02.871667
current #epochs=17, #steps=640
start validation
acc: 0.838863
AUC: 0.928852
Avg Precision: 0.326836
Avg Recall: 1.000000
d_prime: 2.075072
train_loss: 0.039158
valid_loss: 1.005100
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0016436611247013953
Epoch-17 lr: 0.0016436611247013953
epoch 17 training time: 15.482
---------------
2023-09-11 13:04:18.352985
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00559	Train Loss 0.0418	
start validation
acc: 0.810427
AUC: 0.918511
Avg Precision: 0.325430
Avg Recall: 1.000000
d_prime: 1.973009
train_loss: 0.046755
valid_loss: 1.007992
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0016436611247013953
Epoch-18 lr: 0.0016436611247013953
epoch 18 training time: 15.199
---------------
2023-09-11 13:04:33.552180
current #epochs=19, #steps=720
start validation
acc: 0.834123
AUC: 0.924890
Avg Precision: 0.327911
Avg Recall: 1.000000
d_prime: 2.034704
train_loss: 0.051704
valid_loss: 1.014470
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0016436611247013953
Epoch-19 lr: 0.0016436611247013953
epoch 19 training time: 15.103
---------------
2023-09-11 13:04:48.655218
current #epochs=20, #steps=760
start validation
acc: 0.824645
AUC: 0.917967
Avg Precision: 0.324854
Avg Recall: 1.000000
d_prime: 1.967914
train_loss: 0.048022
valid_loss: 1.018866
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0016436611247013953
Epoch-20 lr: 0.0016436611247013953
epoch 20 training time: 15.142
---------------
2023-09-11 13:05:03.797834
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03635	Per Sample Data Time 0.02884	Per Sample DNN Time 0.00752	Train Loss 0.0301	
start validation
acc: 0.843602
AUC: 0.915843
Avg Precision: 0.330632
Avg Recall: 1.000000
d_prime: 1.948276
train_loss: 0.048103
valid_loss: 0.996500
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0016436611247013953
Epoch-21 lr: 0.0016436611247013953
epoch 21 training time: 14.956
---------------
2023-09-11 13:05:18.753740
current #epochs=22, #steps=840
start validation
acc: 0.838863
AUC: 0.921479
Avg Precision: 0.325541
Avg Recall: 1.000000
d_prime: 2.001236
train_loss: 0.049016
valid_loss: 1.003994
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0016436611247013953
Epoch-22 lr: 0.0016436611247013953
epoch 22 training time: 15.800
---------------
2023-09-11 13:05:34.553955
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00563	Train Loss 0.0434	
start validation
acc: 0.834123
AUC: 0.906747
Avg Precision: 0.329572
Avg Recall: 1.000000
d_prime: 1.868155
train_loss: 0.044395
valid_loss: 1.023337
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0016436611247013953
Epoch-23 lr: 0.0016436611247013953
epoch 23 training time: 15.079
---------------
2023-09-11 13:05:49.633422
current #epochs=24, #steps=920
start validation
acc: 0.829384
AUC: 0.910130
Avg Precision: 0.333727
Avg Recall: 1.000000
d_prime: 1.897251
train_loss: 0.050420
valid_loss: 1.018981
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0016436611247013953
Epoch-24 lr: 0.0016436611247013953
epoch 24 training time: 15.523
---------------
2023-09-11 13:06:05.156697
current #epochs=25, #steps=960
start validation
acc: 0.824645
AUC: 0.920389
Avg Precision: 0.322707
Avg Recall: 1.000000
d_prime: 1.990780
train_loss: 0.057340
valid_loss: 1.010983
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0016436611247013953
Epoch-25 lr: 0.0016436611247013953
epoch 25 training time: 15.257
---------------
2023-09-11 13:06:20.414276
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03722	Per Sample Data Time 0.03006	Per Sample DNN Time 0.00716	Train Loss 0.0227	
start validation
acc: 0.838863
AUC: 0.917548
Avg Precision: 0.335455
Avg Recall: 1.000000
d_prime: 1.964011
train_loss: 0.046357
valid_loss: 1.006055
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0012942751703421034
Epoch-26 lr: 0.0012942751703421034
epoch 26 training time: 15.112
---------------
2023-09-11 13:06:35.526012
current #epochs=27, #steps=1040
start validation
acc: 0.800948
AUC: 0.915569
Avg Precision: 0.332728
Avg Recall: 1.000000
d_prime: 1.945770
train_loss: 0.056734
valid_loss: 1.006940
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0012942751703421034
Epoch-27 lr: 0.0012942751703421034
epoch 27 training time: 16.436
---------------
2023-09-11 13:06:51.962140
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00563	Train Loss 0.0606	
start validation
acc: 0.824645
AUC: 0.921083
Avg Precision: 0.344120
Avg Recall: 1.000000
d_prime: 1.997431
train_loss: 0.056386
valid_loss: 1.029824
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0012942751703421034
Epoch-28 lr: 0.0012942751703421034
epoch 28 training time: 15.208
---------------
2023-09-11 13:07:07.169802
current #epochs=29, #steps=1120
start validation
acc: 0.819905
AUC: 0.913189
Avg Precision: 0.335429
Avg Recall: 1.000000
d_prime: 1.924260
train_loss: 0.046570
valid_loss: 1.008539
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0012942751703421034
Epoch-29 lr: 0.0012942751703421034
epoch 29 training time: 15.052
---------------
2023-09-11 13:07:22.221871
current #epochs=30, #steps=1160
start validation
acc: 0.819905
AUC: 0.927819
Avg Precision: 0.346039
Avg Recall: 1.000000
d_prime: 2.064387
train_loss: 0.042484
valid_loss: 1.012968
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0012942751703421034
Epoch-30 lr: 0.0012942751703421034
epoch 30 training time: 15.017
---------------
2023-09-11 13:07:37.238828
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03954	Per Sample Data Time 0.02980	Per Sample DNN Time 0.00974	Train Loss 0.0081	
start validation
acc: 0.805687
AUC: 0.929660
Avg Precision: 0.341194
Avg Recall: 1.000000
d_prime: 2.083510
train_loss: 0.051045
valid_loss: 1.000883
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0012942751703421034
Epoch-31 lr: 0.0012942751703421034
epoch 31 training time: 15.106
---------------
2023-09-11 13:07:52.345005
current #epochs=32, #steps=1240
start validation
acc: 0.819905
AUC: 0.930378
Avg Precision: 0.348084
Avg Recall: 1.000000
d_prime: 2.091076
train_loss: 0.046159
valid_loss: 0.999405
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0012942751703421034
Epoch-32 lr: 0.0012942751703421034
epoch 32 training time: 15.350
---------------
2023-09-11 13:08:07.695274
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00560	Train Loss 0.0453	
start validation
acc: 0.829384
AUC: 0.926721
Avg Precision: 0.328739
Avg Recall: 1.000000
d_prime: 2.053149
train_loss: 0.044951
valid_loss: 1.005394
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0012942751703421034
Epoch-33 lr: 0.0012942751703421034
epoch 33 training time: 15.209
---------------
2023-09-11 13:08:22.904230
current #epochs=34, #steps=1320
start validation
acc: 0.819905
AUC: 0.923387
Avg Precision: 0.327031
Avg Recall: 1.000000
d_prime: 2.019818
train_loss: 0.040981
valid_loss: 0.991079
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0012942751703421034
Epoch-34 lr: 0.0012942751703421034
epoch 34 training time: 15.899
---------------
2023-09-11 13:08:38.803558
current #epochs=35, #steps=1360
start validation
acc: 0.829384
AUC: 0.924791
Avg Precision: 0.354972
Avg Recall: 1.000000
d_prime: 2.033718
train_loss: 0.035091
valid_loss: 0.988252
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0012942751703421034
Epoch-35 lr: 0.0012942751703421034
epoch 35 training time: 15.096
---------------
2023-09-11 13:08:53.900027
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03453	Per Sample Data Time 0.02730	Per Sample DNN Time 0.00723	Train Loss 0.0795	
start validation
acc: 0.843602
AUC: 0.921365
Avg Precision: 0.350115
Avg Recall: 1.000000
d_prime: 2.000142
train_loss: 0.041525
valid_loss: 0.996585
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.001019156681015015
Epoch-36 lr: 0.001019156681015015
epoch 36 training time: 15.012
---------------
2023-09-11 13:09:08.911879
current #epochs=37, #steps=1440
start validation
acc: 0.834123
AUC: 0.935832
Avg Precision: 0.349197
Avg Recall: 1.000000
d_prime: 2.150588
train_loss: 0.031313
valid_loss: 0.996369
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.001019156681015015
Epoch-37 lr: 0.001019156681015015
epoch 37 training time: 15.103
---------------
2023-09-11 13:09:24.014590
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00703	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00557	Train Loss 0.0312	
start validation
acc: 0.815166
AUC: 0.934007
Avg Precision: 0.336012
Avg Recall: 1.000000
d_prime: 2.130252
train_loss: 0.039861
valid_loss: 0.981058
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.001019156681015015
Epoch-38 lr: 0.001019156681015015
epoch 38 training time: 14.914
---------------
2023-09-11 13:09:38.929037
current #epochs=39, #steps=1520
start validation
acc: 0.834123
AUC: 0.931897
Avg Precision: 0.345804
Avg Recall: 1.000000
d_prime: 2.107276
train_loss: 0.047655
valid_loss: 1.008267
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.001019156681015015
Epoch-39 lr: 0.001019156681015015
epoch 39 training time: 14.938
---------------
2023-09-11 13:09:53.867104
current #epochs=40, #steps=1560
start validation
acc: 0.843602
AUC: 0.936191
Avg Precision: 0.341020
Avg Recall: 1.000000
d_prime: 2.154641
train_loss: 0.040126
valid_loss: 0.990684
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.001019156681015015
Epoch-40 lr: 0.001019156681015015
epoch 40 training time: 15.076
---------------
2023-09-11 13:10:08.943112
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03487	Per Sample Data Time 0.02815	Per Sample DNN Time 0.00672	Train Loss 0.0265	
start validation
acc: 0.834123
AUC: 0.942482
Avg Precision: 0.372645
Avg Recall: 1.000000
d_prime: 2.228733
train_loss: 0.042357
valid_loss: 0.979457
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.001019156681015015
Epoch-41 lr: 0.001019156681015015
epoch 41 training time: 15.104
---------------
2023-09-11 13:10:24.047710
current #epochs=42, #steps=1640
start validation
acc: 0.824645
AUC: 0.936688
Avg Precision: 0.349588
Avg Recall: 1.000000
d_prime: 2.160281
train_loss: 0.039256
valid_loss: 0.984957
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.001019156681015015
Epoch-42 lr: 0.001019156681015015
epoch 42 training time: 14.976
---------------
2023-09-11 13:10:39.024097
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00560	Train Loss 0.0520	
start validation
[I 2023-09-11 13:10:54,942] Trial 43 finished with value: 0.8530805687203792 and parameters: {'warmup': 'False', 'num_epochs': 43, 'batch_size': 62, 'lr-adaptschedule': 'True', 'lr': 0.0026508405853396485, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.7874343141000156}. Best is trial 39 with value: 0.8672985781990521.
acc: 0.834123
AUC: 0.937865
Avg Precision: 0.358442
Avg Recall: 1.000000
d_prime: 2.173786
train_loss: 0.042428
valid_loss: 0.986761
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.001019156681015015
Epoch-43 lr: 0.001019156681015015
epoch 43 training time: 15.910
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f85b52a9520>
The learning rate scheduler starts at 5 epoch with decay rate of 0.762 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 13:10:54.978931
current #epochs=1, #steps=0
start validation
acc: 0.848341
AUC: 0.933411
Avg Precision: 0.347059
Avg Recall: 1.000000
d_prime: 2.123710
train_loss: 0.087511
valid_loss: 0.996075
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0028406508090060827
Epoch-1 lr: 0.0028406508090060827
epoch 1 training time: 17.144
---------------
2023-09-11 13:11:12.123309
current #epochs=2, #steps=40
start validation
acc: 0.781991
AUC: 0.922081
Avg Precision: 0.349629
Avg Recall: 1.000000
d_prime: 2.007061
train_loss: 0.074371
valid_loss: 1.019974
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0028406508090060827
Epoch-2 lr: 0.0028406508090060827
epoch 2 training time: 17.006
---------------
2023-09-11 13:11:29.129420
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00566	Train Loss 0.0809	
start validation
acc: 0.815166
AUC: 0.916412
Avg Precision: 0.331789
Avg Recall: 1.000000
d_prime: 1.953503
train_loss: 0.063359
valid_loss: 0.999888
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0028406508090060827
Epoch-3 lr: 0.0028406508090060827
epoch 3 training time: 15.148
---------------
2023-09-11 13:11:44.277730
current #epochs=4, #steps=120
start validation
acc: 0.796209
AUC: 0.919937
Avg Precision: 0.340759
Avg Recall: 1.000000
d_prime: 1.986472
train_loss: 0.079934
valid_loss: 1.005048
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0028406508090060827
Epoch-4 lr: 0.0028406508090060827
epoch 4 training time: 17.409
---------------
2023-09-11 13:12:01.686171
current #epochs=5, #steps=160
start validation
acc: 0.805687
AUC: 0.930201
Avg Precision: 0.319867
Avg Recall: 1.000000
d_prime: 2.089200
train_loss: 0.075646
valid_loss: 1.014518
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002163404452860269
Epoch-5 lr: 0.002163404452860269
epoch 5 training time: 18.368
---------------
2023-09-11 13:12:20.054697
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03705	Per Sample Data Time 0.02953	Per Sample DNN Time 0.00752	Train Loss 0.1257	
start validation
acc: 0.819905
AUC: 0.921806
Avg Precision: 0.326927
Avg Recall: 1.000000
d_prime: 2.004399
train_loss: 0.092281
valid_loss: 1.015597
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002163404452860269
Epoch-6 lr: 0.002163404452860269
epoch 6 training time: 15.070
---------------
2023-09-11 13:12:35.124979
current #epochs=7, #steps=240
start validation
acc: 0.853081
AUC: 0.935517
Avg Precision: 0.331248
Avg Recall: 1.000000
d_prime: 2.147044
train_loss: 0.058497
valid_loss: 0.995552
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002163404452860269
Epoch-7 lr: 0.002163404452860269
epoch 7 training time: 17.125
---------------
2023-09-11 13:12:52.249622
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00567	Train Loss 0.0502	
start validation
acc: 0.824645
AUC: 0.939988
Avg Precision: 0.388236
Avg Recall: 1.000000
d_prime: 2.198639
train_loss: 0.061699
valid_loss: 1.004029
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.002163404452860269
Epoch-8 lr: 0.002163404452860269
epoch 8 training time: 15.159
---------------
2023-09-11 13:13:07.409013
current #epochs=9, #steps=320
start validation
acc: 0.834123
AUC: 0.936564
Avg Precision: 0.337480
Avg Recall: 1.000000
d_prime: 2.158873
train_loss: 0.053728
valid_loss: 1.011671
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.002163404452860269
Epoch-9 lr: 0.002163404452860269
epoch 9 training time: 14.872
---------------
2023-09-11 13:13:22.281097
current #epochs=10, #steps=360
start validation
acc: 0.848341
AUC: 0.934720
Avg Precision: 0.373627
Avg Recall: 1.000000
d_prime: 2.138147
train_loss: 0.047879
valid_loss: 1.015408
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.002163404452860269
Epoch-10 lr: 0.002163404452860269
epoch 10 training time: 15.051
---------------
2023-09-11 13:13:37.332079
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03908	Per Sample Data Time 0.02854	Per Sample DNN Time 0.01054	Train Loss 0.1666	
start validation
acc: 0.824645
AUC: 0.943765
Avg Precision: 0.350023
Avg Recall: 1.000000
d_prime: 2.244619
train_loss: 0.056607
valid_loss: 1.004558
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.002163404452860269
Epoch-11 lr: 0.002163404452860269
epoch 11 training time: 16.563
---------------
2023-09-11 13:13:53.895260
current #epochs=12, #steps=440
start validation
acc: 0.815166
AUC: 0.926250
Avg Precision: 0.314441
Avg Recall: 1.000000
d_prime: 2.048378
train_loss: 0.057295
valid_loss: 1.002015
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.002163404452860269
Epoch-12 lr: 0.002163404452860269
epoch 12 training time: 17.602
---------------
2023-09-11 13:14:11.496838
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00559	Train Loss 0.0545	
start validation
acc: 0.805687
AUC: 0.924083
Avg Precision: 0.336469
Avg Recall: 1.000000
d_prime: 2.026685
train_loss: 0.049783
valid_loss: 1.021488
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.002163404452860269
Epoch-13 lr: 0.002163404452860269
epoch 13 training time: 15.317
---------------
2023-09-11 13:14:26.813244
current #epochs=14, #steps=520
start validation
acc: 0.800948
AUC: 0.919769
Avg Precision: 0.336819
Avg Recall: 1.000000
d_prime: 1.984872
train_loss: 0.065166
valid_loss: 1.036496
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0016476220209175377
Epoch-14 lr: 0.0016476220209175377
epoch 14 training time: 15.269
---------------
2023-09-11 13:14:42.082386
current #epochs=15, #steps=560
start validation
acc: 0.800948
AUC: 0.929565
Avg Precision: 0.354353
Avg Recall: 1.000000
d_prime: 2.082516
train_loss: 0.060562
valid_loss: 1.024274
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0016476220209175377
Epoch-15 lr: 0.0016476220209175377
epoch 15 training time: 14.984
---------------
2023-09-11 13:14:57.066128
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03560	Per Sample Data Time 0.02855	Per Sample DNN Time 0.00705	Train Loss 0.0135	
start validation
acc: 0.819905
AUC: 0.943248
Avg Precision: 0.357042
Avg Recall: 1.000000
d_prime: 2.238183
train_loss: 0.056860
valid_loss: 0.994982
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0016476220209175377
Epoch-16 lr: 0.0016476220209175377
epoch 16 training time: 14.986
---------------
2023-09-11 13:15:12.052606
current #epochs=17, #steps=640
start validation
acc: 0.810427
AUC: 0.931469
Avg Precision: 0.322932
Avg Recall: 1.000000
d_prime: 2.102679
train_loss: 0.059020
valid_loss: 1.015116
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0016476220209175377
Epoch-17 lr: 0.0016476220209175377
epoch 17 training time: 15.170
---------------
2023-09-11 13:15:27.223133
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00561	Train Loss 0.0489	
start validation
acc: 0.819905
AUC: 0.931925
Avg Precision: 0.352965
Avg Recall: 1.000000
d_prime: 2.107580
train_loss: 0.049479
valid_loss: 1.002311
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0016476220209175377
Epoch-18 lr: 0.0016476220209175377
epoch 18 training time: 14.982
---------------
2023-09-11 13:15:42.205064
current #epochs=19, #steps=720
start validation
acc: 0.800948
AUC: 0.932741
Avg Precision: 0.390474
Avg Recall: 1.000000
d_prime: 2.116404
train_loss: 0.049860
valid_loss: 1.014748
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0016476220209175377
Epoch-19 lr: 0.0016476220209175377
epoch 19 training time: 15.528
---------------
2023-09-11 13:15:57.732973
current #epochs=20, #steps=760
start validation
acc: 0.824645
AUC: 0.938399
Avg Precision: 0.385439
Avg Recall: 1.000000
d_prime: 2.179967
train_loss: 0.058450
valid_loss: 1.004033
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0016476220209175377
Epoch-20 lr: 0.0016476220209175377
epoch 20 training time: 17.068
---------------
2023-09-11 13:16:14.800893
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03596	Per Sample Data Time 0.02829	Per Sample DNN Time 0.00768	Train Loss 0.0298	
start validation
acc: 0.805687
AUC: 0.919558
Avg Precision: 0.320633
Avg Recall: 1.000000
d_prime: 1.982871
train_loss: 0.036029
valid_loss: 1.020827
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0016476220209175377
Epoch-21 lr: 0.0016476220209175377
epoch 21 training time: 17.036
---------------
2023-09-11 13:16:31.836536
current #epochs=22, #steps=840
start validation
acc: 0.800948
AUC: 0.914906
Avg Precision: 0.300321
Avg Recall: 1.000000
d_prime: 1.939731
train_loss: 0.045945
valid_loss: 1.040793
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0016476220209175377
Epoch-22 lr: 0.0016476220209175377
epoch 22 training time: 15.037
---------------
2023-09-11 13:16:46.873373
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00567	Train Loss 0.0462	
start validation
acc: 0.786730
AUC: 0.916577
Avg Precision: 0.312632
Avg Recall: 1.000000
d_prime: 1.955025
train_loss: 0.047822
valid_loss: 1.014013
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.001254808512676999
Epoch-23 lr: 0.001254808512676999
epoch 23 training time: 16.291
---------------
2023-09-11 13:17:03.164493
current #epochs=24, #steps=920
start validation
acc: 0.800948
AUC: 0.921540
Avg Precision: 0.347174
Avg Recall: 1.000000
d_prime: 2.001827
train_loss: 0.044749
valid_loss: 1.010311
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.001254808512676999
Epoch-24 lr: 0.001254808512676999
epoch 24 training time: 15.064
---------------
2023-09-11 13:17:18.228730
current #epochs=25, #steps=960
start validation
acc: 0.810427
AUC: 0.923965
Avg Precision: 0.317595
Avg Recall: 1.000000
d_prime: 2.025514
train_loss: 0.049821
valid_loss: 0.998695
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.001254808512676999
Epoch-25 lr: 0.001254808512676999
epoch 25 training time: 16.028
---------------
2023-09-11 13:17:34.257550
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03679	Per Sample Data Time 0.02721	Per Sample DNN Time 0.00958	Train Loss 0.0173	
start validation
acc: 0.819905
AUC: 0.927374
Avg Precision: 0.355657
Avg Recall: 1.000000
d_prime: 2.059815
train_loss: 0.056503
valid_loss: 1.000483
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.001254808512676999
Epoch-26 lr: 0.001254808512676999
epoch 26 training time: 15.744
---------------
2023-09-11 13:17:50.001946
current #epochs=27, #steps=1040
start validation
acc: 0.843602
AUC: 0.933994
Avg Precision: 0.364604
Avg Recall: 1.000000
d_prime: 2.130108
train_loss: 0.047572
valid_loss: 0.995935
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.001254808512676999
Epoch-27 lr: 0.001254808512676999
epoch 27 training time: 15.495
---------------
2023-09-11 13:18:05.496804
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00560	Train Loss 0.0452	
start validation
acc: 0.824645
AUC: 0.936944
Avg Precision: 0.347943
Avg Recall: 1.000000
d_prime: 2.163197
train_loss: 0.045207
valid_loss: 0.986643
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.001254808512676999
Epoch-28 lr: 0.001254808512676999
epoch 28 training time: 16.120
---------------
2023-09-11 13:18:21.616957
current #epochs=29, #steps=1120
start validation
acc: 0.810427
AUC: 0.929820
Avg Precision: 0.353265
Avg Recall: 1.000000
d_prime: 2.085191
train_loss: 0.046633
valid_loss: 1.030409
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.001254808512676999
Epoch-29 lr: 0.001254808512676999
epoch 29 training time: 15.060
---------------
2023-09-11 13:18:36.676588
current #epochs=30, #steps=1160
start validation
acc: 0.834123
AUC: 0.929860
Avg Precision: 0.348222
Avg Recall: 1.000000
d_prime: 2.085611
train_loss: 0.034703
valid_loss: 0.991932
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.001254808512676999
Epoch-30 lr: 0.001254808512676999
epoch 30 training time: 15.831
---------------
2023-09-11 13:18:52.508100
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03682	Per Sample Data Time 0.02891	Per Sample DNN Time 0.00791	Train Loss 0.0076	
start validation
acc: 0.824645
AUC: 0.923136
Avg Precision: 0.316178
Avg Recall: 1.000000
d_prime: 2.017352
train_loss: 0.053397
valid_loss: 1.010332
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.001254808512676999
Epoch-31 lr: 0.001254808512676999
epoch 31 training time: 15.024
---------------
2023-09-11 13:19:07.532120
current #epochs=32, #steps=1240
start validation
acc: 0.824645
AUC: 0.924002
Avg Precision: 0.328016
Avg Recall: 1.000000
d_prime: 2.025886
train_loss: 0.043279
valid_loss: 1.025204
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0009556466128134294
Epoch-32 lr: 0.0009556466128134294
epoch 32 training time: 15.014
---------------
2023-09-11 13:19:22.545517
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00561	Train Loss 0.0444	
start validation
acc: 0.834123
AUC: 0.923137
Avg Precision: 0.313362
Avg Recall: 1.000000
d_prime: 2.017364
train_loss: 0.042978
valid_loss: 1.016687
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0009556466128134294
Epoch-33 lr: 0.0009556466128134294
epoch 33 training time: 14.990
---------------
2023-09-11 13:19:37.535676
current #epochs=34, #steps=1320
start validation
acc: 0.824645
AUC: 0.921792
Avg Precision: 0.322246
Avg Recall: 1.000000
d_prime: 2.004260
train_loss: 0.040181
valid_loss: 1.022005
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0009556466128134294
Epoch-34 lr: 0.0009556466128134294
epoch 34 training time: 15.054
---------------
2023-09-11 13:19:52.589977
current #epochs=35, #steps=1360
start validation
acc: 0.824645
AUC: 0.919454
Avg Precision: 0.313834
Avg Recall: 1.000000
d_prime: 1.981894
train_loss: 0.031375
valid_loss: 1.034690
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0009556466128134294
Epoch-35 lr: 0.0009556466128134294
epoch 35 training time: 15.095
---------------
2023-09-11 13:20:07.684816
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03692	Per Sample Data Time 0.02955	Per Sample DNN Time 0.00738	Train Loss 0.0281	
start validation
acc: 0.815166
AUC: 0.921022
Avg Precision: 0.338316
Avg Recall: 1.000000
d_prime: 1.996839
train_loss: 0.037134
valid_loss: 1.032019
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0009556466128134294
Epoch-36 lr: 0.0009556466128134294
epoch 36 training time: 15.138
---------------
2023-09-11 13:20:22.822501
current #epochs=37, #steps=1440
start validation
acc: 0.819905
AUC: 0.923120
Avg Precision: 0.321728
Avg Recall: 1.000000
d_prime: 2.017203
train_loss: 0.040336
valid_loss: 1.029206
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0009556466128134294
Epoch-37 lr: 0.0009556466128134294
epoch 37 training time: 15.022
---------------
2023-09-11 13:20:37.844402
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00564	Train Loss 0.0432	
start validation
acc: 0.815166
AUC: 0.927103
Avg Precision: 0.328086
Avg Recall: 1.000000
d_prime: 2.057049
train_loss: 0.046923
valid_loss: 1.018340
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0009556466128134294
Epoch-38 lr: 0.0009556466128134294
epoch 38 training time: 15.760
---------------
2023-09-11 13:20:53.604539
current #epochs=39, #steps=1520
start validation
acc: 0.834123
AUC: 0.935885
Avg Precision: 0.354676
Avg Recall: 1.000000
d_prime: 2.151188
train_loss: 0.056899
valid_loss: 1.002898
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0009556466128134294
Epoch-39 lr: 0.0009556466128134294
epoch 39 training time: 15.393
---------------
2023-09-11 13:21:08.997987
current #epochs=40, #steps=1560
start validation
acc: 0.805687
AUC: 0.933991
Avg Precision: 0.348553
Avg Recall: 1.000000
d_prime: 2.130077
train_loss: 0.046769
valid_loss: 1.006601
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0009556466128134294
Epoch-40 lr: 0.0009556466128134294
epoch 40 training time: 14.932
---------------
2023-09-11 13:21:23.929647
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03923	Per Sample Data Time 0.02864	Per Sample DNN Time 0.01058	Train Loss 0.1213	
start validation
acc: 0.824645
AUC: 0.930975
Avg Precision: 0.349271
Avg Recall: 1.000000
d_prime: 2.097407
train_loss: 0.045543
valid_loss: 1.001988
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0007278086172952698
Epoch-41 lr: 0.0007278086172952698
epoch 41 training time: 15.645
---------------
2023-09-11 13:21:39.574423
current #epochs=42, #steps=1640
start validation
acc: 0.834123
AUC: 0.930721
Avg Precision: 0.346094
Avg Recall: 1.000000
d_prime: 2.094708
train_loss: 0.045491
valid_loss: 1.014040
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0007278086172952698
Epoch-42 lr: 0.0007278086172952698
epoch 42 training time: 15.099
---------------
2023-09-11 13:21:54.672855
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00564	Train Loss 0.0439	
start validation
acc: 0.834123
AUC: 0.931041
Avg Precision: 0.361051
Avg Recall: 1.000000
d_prime: 2.098111
train_loss: 0.042884
valid_loss: 1.013326
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0007278086172952698
Epoch-43 lr: 0.0007278086172952698
epoch 43 training time: 15.300
---------------
2023-09-11 13:22:09.972664
current #epochs=44, #steps=1720
start validation
acc: 0.838863
AUC: 0.932062
Avg Precision: 0.357232
Avg Recall: 1.000000
d_prime: 2.109055
train_loss: 0.046828
valid_loss: 1.008002
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0007278086172952698
Epoch-44 lr: 0.0007278086172952698
epoch 44 training time: 15.013
---------------
2023-09-11 13:22:24.985922
current #epochs=45, #steps=1760
start validation
acc: 0.834123
AUC: 0.930425
Avg Precision: 0.348727
Avg Recall: 1.000000
d_prime: 2.091566
train_loss: 0.031097
valid_loss: 1.004962
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0007278086172952698
Epoch-45 lr: 0.0007278086172952698
epoch 45 training time: 14.994
---------------
2023-09-11 13:22:39.979977
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03613	Per Sample Data Time 0.02883	Per Sample DNN Time 0.00730	Train Loss 0.0349	
start validation
acc: 0.824645
AUC: 0.932652
Avg Precision: 0.353580
Avg Recall: 1.000000
d_prime: 2.115435
train_loss: 0.033673
valid_loss: 1.010945
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.0007278086172952698
Epoch-46 lr: 0.0007278086172952698
epoch 46 training time: 15.004
---------------
2023-09-11 13:22:54.984534
current #epochs=47, #steps=1840
start validation
acc: 0.829384
AUC: 0.932147
Avg Precision: 0.356898
Avg Recall: 1.000000
d_prime: 2.109968
train_loss: 0.025284
valid_loss: 1.020571
validation finished
normal learning rate scheduler step
Epoch-47 lr: 0.0007278086172952698
Epoch-47 lr: 0.0007278086172952698
epoch 47 training time: 15.109
---------------
2023-09-11 13:23:10.093692
current #epochs=48, #steps=1880
Epoch: [48][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00562	Train Loss 0.0342	
start validation
acc: 0.834123
AUC: 0.928877
Avg Precision: 0.344283
Avg Recall: 1.000000
d_prime: 2.075324
train_loss: 0.033254
valid_loss: 1.017809
validation finished
normal learning rate scheduler step
Epoch-48 lr: 0.0007278086172952698
Epoch-48 lr: 0.0007278086172952698
epoch 48 training time: 15.041
---------------
2023-09-11 13:23:25.134655
current #epochs=49, #steps=1920
start validation
acc: 0.815166
AUC: 0.930009
Avg Precision: 0.353411
Avg Recall: 1.000000
d_prime: 2.087174
train_loss: 0.035358
valid_loss: 1.021911
validation finished
normal learning rate scheduler step
Epoch-49 lr: 0.0007278086172952698
Epoch-49 lr: 0.0007278086172952698
epoch 49 training time: 15.146
---------------
2023-09-11 13:23:40.280657
current #epochs=50, #steps=1960
start validation
[I 2023-09-11 13:23:55,356] Trial 44 finished with value: 0.8530805687203792 and parameters: {'warmup': 'False', 'num_epochs': 50, 'batch_size': 16, 'lr-adaptschedule': 'True', 'lr': 0.0028406508090060827, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.7615876073191918}. Best is trial 39 with value: 0.8672985781990521.
acc: 0.829384
AUC: 0.930930
Avg Precision: 0.352335
Avg Recall: 1.000000
d_prime: 2.096934
train_loss: 0.030404
valid_loss: 1.044489
validation finished
normal learning rate scheduler step
Epoch-50 lr: 0.0005542900234321939
Epoch-50 lr: 0.0005542900234321939
epoch 50 training time: 15.065
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863ef92220>
The learning rate scheduler starts at 6 epoch with decay rate of 0.804 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 13:23:55.391252
current #epochs=1, #steps=0
start validation
acc: 0.796209
AUC: 0.903522
Avg Precision: 0.327595
Avg Recall: 1.000000
d_prime: 1.841142
train_loss: 0.069137
valid_loss: 1.029044
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002293932796357264
Epoch-1 lr: 0.002293932796357264
epoch 1 training time: 18.416
---------------
2023-09-11 13:24:13.807938
current #epochs=2, #steps=40
start validation
acc: 0.829384
AUC: 0.925639
Avg Precision: 0.318368
Avg Recall: 1.000000
d_prime: 2.042208
train_loss: 0.050640
valid_loss: 1.008114
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002293932796357264
Epoch-2 lr: 0.002293932796357264
epoch 2 training time: 16.921
---------------
2023-09-11 13:24:30.731291
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00722	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00572	Train Loss 0.0414	
start validation
acc: 0.819905
AUC: 0.919195
Avg Precision: 0.332331
Avg Recall: 1.000000
d_prime: 1.979442
train_loss: 0.054679
valid_loss: 1.014230
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002293932796357264
Epoch-3 lr: 0.002293932796357264
epoch 3 training time: 16.027
---------------
2023-09-11 13:24:46.754969
current #epochs=4, #steps=120
start validation
acc: 0.815166
AUC: 0.917526
Avg Precision: 0.346661
Avg Recall: 1.000000
d_prime: 1.963809
train_loss: 0.061312
valid_loss: 1.018372
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002293932796357264
Epoch-4 lr: 0.002293932796357264
epoch 4 training time: 15.152
---------------
2023-09-11 13:25:01.906809
current #epochs=5, #steps=160
start validation
acc: 0.819905
AUC: 0.918466
Avg Precision: 0.362078
Avg Recall: 1.000000
d_prime: 1.972586
train_loss: 0.052846
valid_loss: 0.998831
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002293932796357264
Epoch-5 lr: 0.002293932796357264
epoch 5 training time: 15.143
---------------
2023-09-11 13:25:17.050081
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03533	Per Sample Data Time 0.02733	Per Sample DNN Time 0.00801	Train Loss 0.0151	
start validation
acc: 0.800948
AUC: 0.920818
Avg Precision: 0.328682
Avg Recall: 1.000000
d_prime: 1.994885
train_loss: 0.062002
valid_loss: 1.020345
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0018442572284712473
Epoch-6 lr: 0.0018442572284712473
epoch 6 training time: 15.062
---------------
2023-09-11 13:25:32.112527
current #epochs=7, #steps=240
start validation
acc: 0.810427
AUC: 0.922182
Avg Precision: 0.333319
Avg Recall: 1.000000
d_prime: 2.008049
train_loss: 0.055904
valid_loss: 1.014882
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0018442572284712473
Epoch-7 lr: 0.0018442572284712473
epoch 7 training time: 15.371
---------------
2023-09-11 13:25:47.483160
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00569	Train Loss 0.0542	
start validation
acc: 0.829384
AUC: 0.929852
Avg Precision: 0.360893
Avg Recall: 1.000000
d_prime: 2.085523
train_loss: 0.049498
valid_loss: 1.006011
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0018442572284712473
Epoch-8 lr: 0.0018442572284712473
epoch 8 training time: 15.839
---------------
2023-09-11 13:26:03.322139
current #epochs=9, #steps=320
start validation
acc: 0.800948
AUC: 0.924344
Avg Precision: 0.340685
Avg Recall: 1.000000
d_prime: 2.029268
train_loss: 0.060593
valid_loss: 1.014527
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0018442572284712473
Epoch-9 lr: 0.0018442572284712473
epoch 9 training time: 15.609
---------------
2023-09-11 13:26:18.931201
current #epochs=10, #steps=360
start validation
acc: 0.815166
AUC: 0.933858
Avg Precision: 0.358661
Avg Recall: 1.000000
d_prime: 2.128607
train_loss: 0.075610
valid_loss: 1.022275
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0018442572284712473
Epoch-10 lr: 0.0018442572284712473
epoch 10 training time: 15.360
---------------
2023-09-11 13:26:34.291429
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03974	Per Sample Data Time 0.02930	Per Sample DNN Time 0.01044	Train Loss 0.0092	
start validation
acc: 0.786730
AUC: 0.916868
Avg Precision: 0.343092
Avg Recall: 1.000000
d_prime: 1.957703
train_loss: 0.042043
valid_loss: 1.025911
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0018442572284712473
Epoch-11 lr: 0.0018442572284712473
epoch 11 training time: 15.186
---------------
2023-09-11 13:26:49.477546
current #epochs=12, #steps=440
start validation
acc: 0.800948
AUC: 0.912389
Avg Precision: 0.341028
Avg Recall: 1.000000
d_prime: 1.917128
train_loss: 0.047753
valid_loss: 1.033985
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0018442572284712473
Epoch-12 lr: 0.0018442572284712473
epoch 12 training time: 15.205
---------------
2023-09-11 13:27:04.683097
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00564	Train Loss 0.0542	
start validation
acc: 0.786730
AUC: 0.918932
Avg Precision: 0.333640
Avg Recall: 1.000000
d_prime: 1.976967
train_loss: 0.051225
valid_loss: 1.033967
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0018442572284712473
Epoch-13 lr: 0.0018442572284712473
epoch 13 training time: 15.002
---------------
2023-09-11 13:27:19.685291
current #epochs=14, #steps=520
start validation
acc: 0.815166
AUC: 0.930690
Avg Precision: 0.367815
Avg Recall: 1.000000
d_prime: 2.094376
train_loss: 0.058954
valid_loss: 1.012963
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0018442572284712473
Epoch-14 lr: 0.0018442572284712473
epoch 14 training time: 15.141
---------------
2023-09-11 13:27:34.826031
current #epochs=15, #steps=560
start validation
acc: 0.815166
AUC: 0.929572
Avg Precision: 0.365684
Avg Recall: 1.000000
d_prime: 2.082590
train_loss: 0.057682
valid_loss: 1.008465
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0018442572284712473
Epoch-15 lr: 0.0018442572284712473
epoch 15 training time: 14.999
---------------
2023-09-11 13:27:49.825035
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03754	Per Sample Data Time 0.03009	Per Sample DNN Time 0.00745	Train Loss 0.0108	
start validation
acc: 0.824645
AUC: 0.937921
Avg Precision: 0.356792
Avg Recall: 1.000000
d_prime: 2.174431
train_loss: 0.060600
valid_loss: 1.004803
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0014827307627187875
Epoch-16 lr: 0.0014827307627187875
epoch 16 training time: 15.150
---------------
2023-09-11 13:28:04.975151
current #epochs=17, #steps=640
start validation
acc: 0.829384
AUC: 0.928982
Avg Precision: 0.339622
Avg Recall: 1.000000
d_prime: 2.076416
train_loss: 0.043616
valid_loss: 0.997958
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0014827307627187875
Epoch-17 lr: 0.0014827307627187875
epoch 17 training time: 17.087
---------------
2023-09-11 13:28:22.061707
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00564	Train Loss 0.0410	
start validation
acc: 0.829384
AUC: 0.927633
Avg Precision: 0.335822
Avg Recall: 1.000000
d_prime: 2.062470
train_loss: 0.046626
valid_loss: 1.005496
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0014827307627187875
Epoch-18 lr: 0.0014827307627187875
epoch 18 training time: 15.049
---------------
2023-09-11 13:28:37.110815
current #epochs=19, #steps=720
start validation
acc: 0.838863
AUC: 0.930968
Avg Precision: 0.348233
Avg Recall: 1.000000
d_prime: 2.097339
train_loss: 0.040328
valid_loss: 1.001776
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0014827307627187875
Epoch-19 lr: 0.0014827307627187875
epoch 19 training time: 18.487
---------------
2023-09-11 13:28:55.597978
current #epochs=20, #steps=760
start validation
acc: 0.815166
AUC: 0.930361
Avg Precision: 0.324448
Avg Recall: 1.000000
d_prime: 2.090896
train_loss: 0.038326
valid_loss: 0.989091
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0014827307627187875
Epoch-20 lr: 0.0014827307627187875
epoch 20 training time: 15.318
---------------
2023-09-11 13:29:10.916088
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03615	Per Sample Data Time 0.02970	Per Sample DNN Time 0.00645	Train Loss 0.0445	
start validation
acc: 0.805687
AUC: 0.920421
Avg Precision: 0.313068
Avg Recall: 1.000000
d_prime: 1.991088
train_loss: 0.041711
valid_loss: 1.005053
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0014827307627187875
Epoch-21 lr: 0.0014827307627187875
epoch 21 training time: 14.948
---------------
2023-09-11 13:29:25.863892
current #epochs=22, #steps=840
start validation
acc: 0.800948
AUC: 0.917415
Avg Precision: 0.323009
Avg Recall: 1.000000
d_prime: 1.962771
train_loss: 0.051811
valid_loss: 1.011114
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0014827307627187875
Epoch-22 lr: 0.0014827307627187875
epoch 22 training time: 15.157
---------------
2023-09-11 13:29:41.020490
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00563	Train Loss 0.0503	
start validation
acc: 0.810427
AUC: 0.926023
Avg Precision: 0.342398
Avg Recall: 1.000000
d_prime: 2.046077
train_loss: 0.046149
valid_loss: 1.005197
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0014827307627187875
Epoch-23 lr: 0.0014827307627187875
epoch 23 training time: 15.064
---------------
2023-09-11 13:29:56.083995
current #epochs=24, #steps=920
start validation
acc: 0.815166
AUC: 0.922002
Avg Precision: 0.334837
Avg Recall: 1.000000
d_prime: 2.006294
train_loss: 0.067355
valid_loss: 1.013870
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0014827307627187875
Epoch-24 lr: 0.0014827307627187875
epoch 24 training time: 15.102
---------------
2023-09-11 13:30:11.185676
current #epochs=25, #steps=960
start validation
acc: 0.781991
AUC: 0.921860
Avg Precision: 0.312629
Avg Recall: 1.000000
d_prime: 2.004924
train_loss: 0.052229
valid_loss: 1.007810
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0014827307627187875
Epoch-25 lr: 0.0014827307627187875
epoch 25 training time: 15.950
---------------
2023-09-11 13:30:27.136065
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03916	Per Sample Data Time 0.02875	Per Sample DNN Time 0.01041	Train Loss 0.0278	
start validation
acc: 0.829384
AUC: 0.925512
Avg Precision: 0.341309
Avg Recall: 1.000000
d_prime: 2.040931
train_loss: 0.047541
valid_loss: 1.012707
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0011920736873212762
Epoch-26 lr: 0.0011920736873212762
epoch 26 training time: 15.190
---------------
2023-09-11 13:30:42.325710
current #epochs=27, #steps=1040
start validation
acc: 0.848341
AUC: 0.937834
Avg Precision: 0.369061
Avg Recall: 1.000000
d_prime: 2.173420
train_loss: 0.045266
valid_loss: 0.994623
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0011920736873212762
Epoch-27 lr: 0.0011920736873212762
epoch 27 training time: 17.072
---------------
2023-09-11 13:30:59.397755
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00563	Train Loss 0.0551	
start validation
acc: 0.824645
AUC: 0.935705
Avg Precision: 0.362450
Avg Recall: 1.000000
d_prime: 2.149165
train_loss: 0.047010
valid_loss: 0.992801
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0011920736873212762
Epoch-28 lr: 0.0011920736873212762
epoch 28 training time: 14.986
---------------
2023-09-11 13:31:14.384153
current #epochs=29, #steps=1120
start validation
acc: 0.824645
AUC: 0.934343
Avg Precision: 0.358677
Avg Recall: 1.000000
d_prime: 2.133959
train_loss: 0.034912
valid_loss: 1.000877
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0011920736873212762
Epoch-29 lr: 0.0011920736873212762
epoch 29 training time: 14.986
---------------
2023-09-11 13:31:29.369887
current #epochs=30, #steps=1160
start validation
acc: 0.824645
AUC: 0.934501
Avg Precision: 0.343684
Avg Recall: 1.000000
d_prime: 2.135709
train_loss: 0.044891
valid_loss: 0.999709
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0011920736873212762
Epoch-30 lr: 0.0011920736873212762
epoch 30 training time: 15.211
---------------
2023-09-11 13:31:44.580790
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03846	Per Sample Data Time 0.02868	Per Sample DNN Time 0.00978	Train Loss 0.0625	
start validation
acc: 0.800948
AUC: 0.929707
Avg Precision: 0.343674
Avg Recall: 1.000000
d_prime: 2.083997
train_loss: 0.040939
valid_loss: 0.991823
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0011920736873212762
Epoch-31 lr: 0.0011920736873212762
epoch 31 training time: 15.158
---------------
2023-09-11 13:31:59.738998
current #epochs=32, #steps=1240
start validation
acc: 0.796209
AUC: 0.929203
Avg Precision: 0.329558
Avg Recall: 1.000000
d_prime: 2.078727
train_loss: 0.044908
valid_loss: 0.999840
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0011920736873212762
Epoch-32 lr: 0.0011920736873212762
epoch 32 training time: 15.173
---------------
2023-09-11 13:32:14.912162
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00563	Train Loss 0.0476	
start validation
acc: 0.796209
AUC: 0.920244
Avg Precision: 0.329538
Avg Recall: 1.000000
d_prime: 1.989391
train_loss: 0.038189
valid_loss: 1.006349
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0011920736873212762
Epoch-33 lr: 0.0011920736873212762
epoch 33 training time: 14.935
---------------
2023-09-11 13:32:29.847018
current #epochs=34, #steps=1320
start validation
acc: 0.805687
AUC: 0.919396
Avg Precision: 0.323304
Avg Recall: 1.000000
d_prime: 1.981343
train_loss: 0.039687
valid_loss: 1.002968
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0011920736873212762
Epoch-34 lr: 0.0011920736873212762
epoch 34 training time: 16.767
---------------
2023-09-11 13:32:46.613887
current #epochs=35, #steps=1360
start validation
acc: 0.791469
AUC: 0.914454
Avg Precision: 0.300097
Avg Recall: 1.000000
d_prime: 1.935635
train_loss: 0.044324
valid_loss: 1.000708
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0011920736873212762
Epoch-35 lr: 0.0011920736873212762
epoch 35 training time: 16.865
---------------
2023-09-11 13:33:03.478726
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03473	Per Sample Data Time 0.02739	Per Sample DNN Time 0.00734	Train Loss 0.0431	
start validation
acc: 0.810427
AUC: 0.920761
Avg Precision: 0.320973
Avg Recall: 1.000000
d_prime: 1.994340
train_loss: 0.048429
valid_loss: 1.007755
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0009583936016799673
Epoch-36 lr: 0.0009583936016799673
epoch 36 training time: 14.987
---------------
2023-09-11 13:33:18.466117
current #epochs=37, #steps=1440
start validation
acc: 0.810427
AUC: 0.919883
Avg Precision: 0.323692
Avg Recall: 1.000000
d_prime: 1.985956
train_loss: 0.037627
valid_loss: 0.995597
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0009583936016799673
Epoch-37 lr: 0.0009583936016799673
epoch 37 training time: 15.182
---------------
2023-09-11 13:33:33.648586
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00561	Train Loss 0.0532	
start validation
acc: 0.815166
AUC: 0.920659
Avg Precision: 0.316660
Avg Recall: 1.000000
d_prime: 1.993357
train_loss: 0.051758
valid_loss: 1.018857
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0009583936016799673
Epoch-38 lr: 0.0009583936016799673
epoch 38 training time: 16.171
---------------
2023-09-11 13:33:49.819726
current #epochs=39, #steps=1520
start validation
acc: 0.838863
AUC: 0.922132
Avg Precision: 0.317550
Avg Recall: 1.000000
d_prime: 2.007561
train_loss: 0.042262
valid_loss: 0.991826
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0009583936016799673
Epoch-39 lr: 0.0009583936016799673
epoch 39 training time: 15.604
---------------
2023-09-11 13:34:05.423343
current #epochs=40, #steps=1560
start validation
acc: 0.834123
AUC: 0.924754
Avg Precision: 0.319573
Avg Recall: 1.000000
d_prime: 2.033348
train_loss: 0.039347
valid_loss: 0.987698
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0009583936016799673
Epoch-40 lr: 0.0009583936016799673
epoch 40 training time: 16.503
---------------
2023-09-11 13:34:21.926829
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03652	Per Sample Data Time 0.02927	Per Sample DNN Time 0.00724	Train Loss 0.0033	
start validation
acc: 0.829384
AUC: 0.928285
Avg Precision: 0.321770
Avg Recall: 1.000000
d_prime: 2.069186
train_loss: 0.053513
valid_loss: 0.978031
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0009583936016799673
Epoch-41 lr: 0.0009583936016799673
epoch 41 training time: 15.158
---------------
2023-09-11 13:34:37.084887
current #epochs=42, #steps=1640
start validation
acc: 0.829384
AUC: 0.926294
Avg Precision: 0.333905
Avg Recall: 1.000000
d_prime: 2.048817
train_loss: 0.041964
valid_loss: 0.979228
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0009583936016799673
Epoch-42 lr: 0.0009583936016799673
epoch 42 training time: 16.088
---------------
2023-09-11 13:34:53.172844
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00562	Train Loss 0.0495	
start validation
acc: 0.834123
AUC: 0.925109
Avg Precision: 0.328112
Avg Recall: 1.000000
d_prime: 2.036895
train_loss: 0.046340
valid_loss: 0.993452
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0009583936016799673
Epoch-43 lr: 0.0009583936016799673
epoch 43 training time: 15.667
---------------
2023-09-11 13:35:08.839417
current #epochs=44, #steps=1720
start validation
[I 2023-09-11 13:35:24,214] Trial 45 finished with value: 0.8483412322274881 and parameters: {'warmup': 'False', 'num_epochs': 44, 'batch_size': 55, 'lr-adaptschedule': 'True', 'lr': 0.002293932796357264, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.8039717778131532}. Best is trial 39 with value: 0.8672985781990521.
acc: 0.819905
AUC: 0.934322
Avg Precision: 0.330881
Avg Recall: 1.000000
d_prime: 2.133736
train_loss: 0.049873
valid_loss: 0.988210
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0009583936016799673
Epoch-44 lr: 0.0009583936016799673
epoch 44 training time: 15.364
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f86448d13a0>
The learning rate scheduler starts at 5 epoch with decay rate of 0.757 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 13:35:24.250015
current #epochs=1, #steps=0
start validation
acc: 0.819905
AUC: 0.938630
Avg Precision: 0.407060
Avg Recall: 1.000000
d_prime: 2.182664
train_loss: 0.072171
valid_loss: 1.002577
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002987340761247892
Epoch-1 lr: 0.002987340761247892
epoch 1 training time: 17.514
---------------
2023-09-11 13:35:41.764435
current #epochs=2, #steps=40
start validation
acc: 0.824645
AUC: 0.935843
Avg Precision: 0.337783
Avg Recall: 1.000000
d_prime: 2.150717
train_loss: 0.077877
valid_loss: 1.007115
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002987340761247892
Epoch-2 lr: 0.002987340761247892
epoch 2 training time: 17.104
---------------
2023-09-11 13:35:58.868434
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00559	Train Loss 0.1007	
start validation
acc: 0.853081
AUC: 0.933693
Avg Precision: 0.354929
Avg Recall: 1.000000
d_prime: 2.126802
train_loss: 0.090262
valid_loss: 0.998759
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002987340761247892
Epoch-3 lr: 0.002987340761247892
epoch 3 training time: 17.236
---------------
2023-09-11 13:36:16.104388
current #epochs=4, #steps=120
start validation
acc: 0.824645
AUC: 0.940551
Avg Precision: 0.399933
Avg Recall: 1.000000
d_prime: 2.205345
train_loss: 0.073399
valid_loss: 0.999997
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002987340761247892
Epoch-4 lr: 0.002987340761247892
epoch 4 training time: 16.360
---------------
2023-09-11 13:36:32.464533
current #epochs=5, #steps=160
start validation
acc: 0.815166
AUC: 0.928876
Avg Precision: 0.334876
Avg Recall: 1.000000
d_prime: 2.075314
train_loss: 0.079116
valid_loss: 0.998324
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0022616279045128227
Epoch-5 lr: 0.0022616279045128227
epoch 5 training time: 15.773
---------------
2023-09-11 13:36:48.237151
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03874	Per Sample Data Time 0.02905	Per Sample DNN Time 0.00969	Train Loss 0.0396	
start validation
acc: 0.834123
AUC: 0.926920
Avg Precision: 0.366924
Avg Recall: 1.000000
d_prime: 2.055179
train_loss: 0.062678
valid_loss: 1.000759
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0022616279045128227
Epoch-6 lr: 0.0022616279045128227
epoch 6 training time: 15.026
---------------
2023-09-11 13:37:03.263387
current #epochs=7, #steps=240
start validation
acc: 0.819905
AUC: 0.928931
Avg Precision: 0.348184
Avg Recall: 1.000000
d_prime: 2.075886
train_loss: 0.051014
valid_loss: 1.016045
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0022616279045128227
Epoch-7 lr: 0.0022616279045128227
epoch 7 training time: 16.614
---------------
2023-09-11 13:37:19.877183
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00564	Train Loss 0.0479	
start validation
acc: 0.834123
AUC: 0.919890
Avg Precision: 0.331662
Avg Recall: 1.000000
d_prime: 1.986030
train_loss: 0.046191
valid_loss: 1.007677
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0022616279045128227
Epoch-8 lr: 0.0022616279045128227
epoch 8 training time: 15.082
---------------
2023-09-11 13:37:34.959299
current #epochs=9, #steps=320
start validation
acc: 0.838863
AUC: 0.926470
Avg Precision: 0.324355
Avg Recall: 1.000000
d_prime: 2.050597
train_loss: 0.062939
valid_loss: 1.005765
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0022616279045128227
Epoch-9 lr: 0.0022616279045128227
epoch 9 training time: 15.025
---------------
2023-09-11 13:37:49.983931
current #epochs=10, #steps=360
start validation
acc: 0.796209
AUC: 0.923047
Avg Precision: 0.349197
Avg Recall: 1.000000
d_prime: 2.016489
train_loss: 0.038577
valid_loss: 1.019248
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0022616279045128227
Epoch-10 lr: 0.0022616279045128227
epoch 10 training time: 15.053
---------------
2023-09-11 13:38:05.037420
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03717	Per Sample Data Time 0.03015	Per Sample DNN Time 0.00702	Train Loss 0.0162	
start validation
acc: 0.791469
AUC: 0.925956
Avg Precision: 0.342139
Avg Recall: 1.000000
d_prime: 2.045399
train_loss: 0.050056
valid_loss: 1.007635
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0022616279045128227
Epoch-11 lr: 0.0022616279045128227
epoch 11 training time: 15.768
---------------
2023-09-11 13:38:20.805159
current #epochs=12, #steps=440
start validation
acc: 0.834123
AUC: 0.924488
Avg Precision: 0.335881
Avg Recall: 1.000000
d_prime: 2.030708
train_loss: 0.045729
valid_loss: 1.005342
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0022616279045128227
Epoch-12 lr: 0.0022616279045128227
epoch 12 training time: 15.733
---------------
2023-09-11 13:38:36.537948
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00563	Train Loss 0.0621	
start validation
acc: 0.815166
AUC: 0.927514
Avg Precision: 0.328201
Avg Recall: 1.000000
d_prime: 2.061252
train_loss: 0.059805
valid_loss: 1.001032
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0022616279045128227
Epoch-13 lr: 0.0022616279045128227
epoch 13 training time: 15.049
---------------
2023-09-11 13:38:51.587123
current #epochs=14, #steps=520
start validation
acc: 0.815166
AUC: 0.910839
Avg Precision: 0.284188
Avg Recall: 1.000000
d_prime: 1.903446
train_loss: 0.055463
valid_loss: 1.015629
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0017122120264359815
Epoch-14 lr: 0.0017122120264359815
epoch 14 training time: 15.131
---------------
2023-09-11 13:39:06.717753
current #epochs=15, #steps=560
start validation
acc: 0.805687
AUC: 0.912461
Avg Precision: 0.309260
Avg Recall: 1.000000
d_prime: 1.917772
train_loss: 0.045481
valid_loss: 1.016737
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0017122120264359815
Epoch-15 lr: 0.0017122120264359815
epoch 15 training time: 14.939
---------------
2023-09-11 13:39:21.657381
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03948	Per Sample Data Time 0.02987	Per Sample DNN Time 0.00961	Train Loss 0.1589	
start validation
acc: 0.824645
AUC: 0.914968
Avg Precision: 0.313678
Avg Recall: 1.000000
d_prime: 1.940302
train_loss: 0.046511
valid_loss: 1.022817
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0017122120264359815
Epoch-16 lr: 0.0017122120264359815
epoch 16 training time: 15.738
---------------
2023-09-11 13:39:37.395167
current #epochs=17, #steps=640
start validation
acc: 0.805687
AUC: 0.922768
Avg Precision: 0.341210
Avg Recall: 1.000000
d_prime: 2.013755
train_loss: 0.069009
valid_loss: 1.003601
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0017122120264359815
Epoch-17 lr: 0.0017122120264359815
epoch 17 training time: 15.153
---------------
2023-09-11 13:39:52.548651
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00562	Train Loss 0.0541	
start validation
acc: 0.805687
AUC: 0.926684
Avg Precision: 0.340802
Avg Recall: 1.000000
d_prime: 2.052774
train_loss: 0.054102
valid_loss: 0.995594
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0017122120264359815
Epoch-18 lr: 0.0017122120264359815
epoch 18 training time: 15.084
---------------
2023-09-11 13:40:07.632139
current #epochs=19, #steps=720
start validation
acc: 0.815166
AUC: 0.922949
Avg Precision: 0.331616
Avg Recall: 1.000000
d_prime: 2.015527
train_loss: 0.074910
valid_loss: 0.984113
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0017122120264359815
Epoch-19 lr: 0.0017122120264359815
epoch 19 training time: 15.526
---------------
2023-09-11 13:40:23.157733
current #epochs=20, #steps=760
start validation
acc: 0.824645
AUC: 0.926324
Avg Precision: 0.343671
Avg Recall: 1.000000
d_prime: 2.049121
train_loss: 0.053725
valid_loss: 1.006943
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0017122120264359815
Epoch-20 lr: 0.0017122120264359815
epoch 20 training time: 15.058
---------------
2023-09-11 13:40:38.215224
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03730	Per Sample Data Time 0.02991	Per Sample DNN Time 0.00738	Train Loss 0.0806	
start validation
acc: 0.824645
AUC: 0.934069
Avg Precision: 0.360042
Avg Recall: 1.000000
d_prime: 2.130939
train_loss: 0.045735
valid_loss: 0.994552
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0017122120264359815
Epoch-21 lr: 0.0017122120264359815
epoch 21 training time: 15.059
---------------
2023-09-11 13:40:53.274878
current #epochs=22, #steps=840
start validation
acc: 0.796209
AUC: 0.934265
Avg Precision: 0.355284
Avg Recall: 1.000000
d_prime: 2.133101
train_loss: 0.047583
valid_loss: 0.974836
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0017122120264359815
Epoch-22 lr: 0.0017122120264359815
epoch 22 training time: 15.109
---------------
2023-09-11 13:41:08.383824
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00159	Per Sample DNN Time 0.00556	Train Loss 0.0523	
start validation
acc: 0.796209
AUC: 0.934310
Avg Precision: 0.351017
Avg Recall: 1.000000
d_prime: 2.133595
train_loss: 0.048963
valid_loss: 0.981539
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0012962654102481642
Epoch-23 lr: 0.0012962654102481642
epoch 23 training time: 16.916
---------------
2023-09-11 13:41:25.300322
current #epochs=24, #steps=920
start validation
acc: 0.786730
AUC: 0.938110
Avg Precision: 0.367997
Avg Recall: 1.000000
d_prime: 2.176615
train_loss: 0.044296
valid_loss: 1.000210
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0012962654102481642
Epoch-24 lr: 0.0012962654102481642
epoch 24 training time: 15.003
---------------
2023-09-11 13:41:40.303370
current #epochs=25, #steps=960
start validation
acc: 0.819905
AUC: 0.941155
Avg Precision: 0.388598
Avg Recall: 1.000000
d_prime: 2.212595
train_loss: 0.039879
valid_loss: 0.992081
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0012962654102481642
Epoch-25 lr: 0.0012962654102481642
epoch 25 training time: 15.008
---------------
2023-09-11 13:41:55.311868
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.04032	Per Sample Data Time 0.03244	Per Sample DNN Time 0.00789	Train Loss 0.0945	
start validation
acc: 0.848341
AUC: 0.949289
Avg Precision: 0.387540
Avg Recall: 1.000000
d_prime: 2.316481
train_loss: 0.047456
valid_loss: 0.985288
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0012962654102481642
Epoch-26 lr: 0.0012962654102481642
epoch 26 training time: 16.240
---------------
2023-09-11 13:42:11.551714
current #epochs=27, #steps=1040
start validation
acc: 0.834123
AUC: 0.946283
Avg Precision: 0.391961
Avg Recall: 1.000000
d_prime: 2.276655
train_loss: 0.040862
valid_loss: 0.992942
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0012962654102481642
Epoch-27 lr: 0.0012962654102481642
epoch 27 training time: 15.389
---------------
2023-09-11 13:42:26.940639
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00560	Train Loss 0.0380	
start validation
acc: 0.834123
AUC: 0.947141
Avg Precision: 0.384127
Avg Recall: 1.000000
d_prime: 2.287830
train_loss: 0.043126
valid_loss: 0.992983
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0012962654102481642
Epoch-28 lr: 0.0012962654102481642
epoch 28 training time: 15.306
---------------
2023-09-11 13:42:42.247073
current #epochs=29, #steps=1120
start validation
acc: 0.838863
AUC: 0.939290
Avg Precision: 0.362401
Avg Recall: 1.000000
d_prime: 2.190387
train_loss: 0.044342
valid_loss: 0.983094
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0012962654102481642
Epoch-29 lr: 0.0012962654102481642
epoch 29 training time: 15.062
---------------
2023-09-11 13:42:57.308798
current #epochs=30, #steps=1160
start validation
acc: 0.834123
AUC: 0.940501
Avg Precision: 0.362133
Avg Recall: 1.000000
d_prime: 2.204754
train_loss: 0.050634
valid_loss: 1.009835
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0012962654102481642
Epoch-30 lr: 0.0012962654102481642
epoch 30 training time: 15.033
---------------
2023-09-11 13:43:12.341959
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03749	Per Sample Data Time 0.02757	Per Sample DNN Time 0.00991	Train Loss 0.1252	
start validation
acc: 0.838863
AUC: 0.941463
Avg Precision: 0.365276
Avg Recall: 1.000000
d_prime: 2.216317
train_loss: 0.036683
valid_loss: 1.000825
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0012962654102481642
Epoch-31 lr: 0.0012962654102481642
epoch 31 training time: 15.102
---------------
2023-09-11 13:43:27.443703
current #epochs=32, #steps=1240
start validation
acc: 0.834123
AUC: 0.935700
Avg Precision: 0.359749
Avg Recall: 1.000000
d_prime: 2.149109
train_loss: 0.040123
valid_loss: 0.998598
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0009813644501162878
Epoch-32 lr: 0.0009813644501162878
epoch 32 training time: 15.194
---------------
2023-09-11 13:43:42.638201
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00556	Train Loss 0.0298	
start validation
acc: 0.824645
AUC: 0.937483
Avg Precision: 0.378315
Avg Recall: 1.000000
d_prime: 2.169378
train_loss: 0.030460
valid_loss: 1.001672
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0009813644501162878
Epoch-33 lr: 0.0009813644501162878
epoch 33 training time: 14.901
---------------
2023-09-11 13:43:57.539281
current #epochs=34, #steps=1320
start validation
acc: 0.829384
AUC: 0.929161
Avg Precision: 0.359715
Avg Recall: 1.000000
d_prime: 2.078288
train_loss: 0.048933
valid_loss: 1.007802
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0009813644501162878
Epoch-34 lr: 0.0009813644501162878
epoch 34 training time: 15.695
---------------
2023-09-11 13:44:13.234036
current #epochs=35, #steps=1360
start validation
acc: 0.810427
AUC: 0.935548
Avg Precision: 0.346050
Avg Recall: 1.000000
d_prime: 2.147393
train_loss: 0.028496
valid_loss: 0.998912
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0009813644501162878
Epoch-35 lr: 0.0009813644501162878
epoch 35 training time: 15.049
---------------
2023-09-11 13:44:28.283428
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03701	Per Sample Data Time 0.02960	Per Sample DNN Time 0.00741	Train Loss 0.0008	
start validation
acc: 0.810427
AUC: 0.933348
Avg Precision: 0.336774
Avg Recall: 1.000000
d_prime: 2.123018
train_loss: 0.036402
valid_loss: 0.993943
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0009813644501162878
Epoch-36 lr: 0.0009813644501162878
epoch 36 training time: 15.064
---------------
2023-09-11 13:44:43.347586
current #epochs=37, #steps=1440
start validation
acc: 0.829384
AUC: 0.940767
Avg Precision: 0.360717
Avg Recall: 1.000000
d_prime: 2.207935
train_loss: 0.030093
valid_loss: 0.991014
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0009813644501162878
Epoch-37 lr: 0.0009813644501162878
epoch 37 training time: 15.145
---------------
2023-09-11 13:44:58.493136
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00556	Train Loss 0.0278	
start validation
acc: 0.829384
AUC: 0.948827
Avg Precision: 0.395218
Avg Recall: 1.000000
d_prime: 2.310239
train_loss: 0.039886
valid_loss: 0.988122
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0009813644501162878
Epoch-38 lr: 0.0009813644501162878
epoch 38 training time: 16.348
---------------
2023-09-11 13:45:14.841525
current #epochs=39, #steps=1520
start validation
acc: 0.838863
AUC: 0.942877
Avg Precision: 0.374216
Avg Recall: 1.000000
d_prime: 2.233597
train_loss: 0.038992
valid_loss: 0.999017
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0009813644501162878
Epoch-39 lr: 0.0009813644501162878
epoch 39 training time: 15.060
---------------
2023-09-11 13:45:29.901626
current #epochs=40, #steps=1560
start validation
acc: 0.819905
AUC: 0.942085
Avg Precision: 0.370846
Avg Recall: 1.000000
d_prime: 2.223885
train_loss: 0.044206
valid_loss: 1.003278
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0009813644501162878
Epoch-40 lr: 0.0009813644501162878
epoch 40 training time: 15.091
---------------
2023-09-11 13:45:44.992898
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03597	Per Sample Data Time 0.02832	Per Sample DNN Time 0.00765	Train Loss 0.0973	
start validation
acc: 0.829384
AUC: 0.936376
Avg Precision: 0.356915
Avg Recall: 1.000000
d_prime: 2.156739
train_loss: 0.030852
valid_loss: 1.007332
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0007429621868623858
Epoch-41 lr: 0.0007429621868623858
epoch 41 training time: 15.114
---------------
2023-09-11 13:46:00.107552
current #epochs=42, #steps=1640
start validation
[I 2023-09-11 13:46:15,141] Trial 46 finished with value: 0.8530805687203792 and parameters: {'warmup': 'False', 'num_epochs': 42, 'batch_size': 61, 'lr-adaptschedule': 'True', 'lr': 0.002987340761247892, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.7570706140561213}. Best is trial 39 with value: 0.8672985781990521.
acc: 0.819905
AUC: 0.939449
Avg Precision: 0.366819
Avg Recall: 1.000000
d_prime: 2.192264
train_loss: 0.050721
valid_loss: 1.002222
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0007429621868623858
Epoch-42 lr: 0.0007429621868623858
epoch 42 training time: 15.024
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f864485ffa0>
The learning rate scheduler starts at 7 epoch with decay rate of 0.816 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 13:46:15.176772
current #epochs=1, #steps=0
start validation
acc: 0.829384
AUC: 0.940580
Avg Precision: 0.354291
Avg Recall: 1.000000
d_prime: 2.205694
train_loss: 0.062969
valid_loss: 0.976348
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0023620388834963853
Epoch-1 lr: 0.0023620388834963853
epoch 1 training time: 17.191
---------------
2023-09-11 13:46:32.368289
current #epochs=2, #steps=40
start validation
acc: 0.786730
AUC: 0.915181
Avg Precision: 0.322652
Avg Recall: 1.000000
d_prime: 1.942233
train_loss: 0.079755
valid_loss: 1.005758
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0023620388834963853
Epoch-2 lr: 0.0023620388834963853
epoch 2 training time: 15.145
---------------
2023-09-11 13:46:47.512896
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00551	Train Loss 0.0434	
start validation
acc: 0.838863
AUC: 0.925999
Avg Precision: 0.339530
Avg Recall: 1.000000
d_prime: 2.045838
train_loss: 0.044332
valid_loss: 0.999207
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0023620388834963853
Epoch-3 lr: 0.0023620388834963853
epoch 3 training time: 17.311
---------------
2023-09-11 13:47:04.823554
current #epochs=4, #steps=120
start validation
acc: 0.843602
AUC: 0.946498
Avg Precision: 0.371845
Avg Recall: 1.000000
d_prime: 2.279441
train_loss: 0.054062
valid_loss: 0.982272
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0023620388834963853
Epoch-4 lr: 0.0023620388834963853
epoch 4 training time: 17.465
---------------
2023-09-11 13:47:22.288346
current #epochs=5, #steps=160
start validation
acc: 0.819905
AUC: 0.940637
Avg Precision: 0.379181
Avg Recall: 1.000000
d_prime: 2.206377
train_loss: 0.049668
valid_loss: 0.984873
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0023620388834963853
Epoch-5 lr: 0.0023620388834963853
epoch 5 training time: 15.169
---------------
2023-09-11 13:47:37.457774
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03606	Per Sample Data Time 0.02811	Per Sample DNN Time 0.00795	Train Loss 0.0316	
start validation
acc: 0.838863
AUC: 0.936490
Avg Precision: 0.347343
Avg Recall: 1.000000
d_prime: 2.158032
train_loss: 0.049883
valid_loss: 0.981388
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0023620388834963853
Epoch-6 lr: 0.0023620388834963853
epoch 6 training time: 15.157
---------------
2023-09-11 13:47:52.614846
current #epochs=7, #steps=240
start validation
acc: 0.819905
AUC: 0.941777
Avg Precision: 0.366273
Avg Recall: 1.000000
d_prime: 2.220125
train_loss: 0.044975
valid_loss: 0.990980
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.001926495105489634
Epoch-7 lr: 0.001926495105489634
epoch 7 training time: 15.204
---------------
2023-09-11 13:48:07.819350
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00560	Train Loss 0.0632	
start validation
acc: 0.853081
AUC: 0.938273
Avg Precision: 0.339041
Avg Recall: 1.000000
d_prime: 2.178511
train_loss: 0.060498
valid_loss: 0.987976
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001926495105489634
Epoch-8 lr: 0.001926495105489634
epoch 8 training time: 16.987
---------------
2023-09-11 13:48:24.806508
current #epochs=9, #steps=320
start validation
acc: 0.848341
AUC: 0.945366
Avg Precision: 0.343217
Avg Recall: 1.000000
d_prime: 2.264852
train_loss: 0.057143
valid_loss: 0.986902
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001926495105489634
Epoch-9 lr: 0.001926495105489634
epoch 9 training time: 15.697
---------------
2023-09-11 13:48:40.503733
current #epochs=10, #steps=360
start validation
acc: 0.824645
AUC: 0.927794
Avg Precision: 0.337024
Avg Recall: 1.000000
d_prime: 2.064126
train_loss: 0.065144
valid_loss: 0.995515
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001926495105489634
Epoch-10 lr: 0.001926495105489634
epoch 10 training time: 15.198
---------------
2023-09-11 13:48:55.701507
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03832	Per Sample Data Time 0.02946	Per Sample DNN Time 0.00885	Train Loss 0.0174	
start validation
acc: 0.810427
AUC: 0.936204
Avg Precision: 0.361658
Avg Recall: 1.000000
d_prime: 2.154791
train_loss: 0.063074
valid_loss: 1.002898
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001926495105489634
Epoch-11 lr: 0.001926495105489634
epoch 11 training time: 15.349
---------------
2023-09-11 13:49:11.050588
current #epochs=12, #steps=440
start validation
acc: 0.829384
AUC: 0.929089
Avg Precision: 0.325139
Avg Recall: 1.000000
d_prime: 2.077540
train_loss: 0.058744
valid_loss: 0.987070
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001926495105489634
Epoch-12 lr: 0.001926495105489634
epoch 12 training time: 15.038
---------------
2023-09-11 13:49:26.088798
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00558	Train Loss 0.0402	
start validation
acc: 0.853081
AUC: 0.928737
Avg Precision: 0.339758
Avg Recall: 1.000000
d_prime: 2.073867
train_loss: 0.037738
valid_loss: 0.985911
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.001926495105489634
Epoch-13 lr: 0.001926495105489634
epoch 13 training time: 14.977
---------------
2023-09-11 13:49:41.065778
current #epochs=14, #steps=520
start validation
acc: 0.857820
AUC: 0.923569
Avg Precision: 0.318810
Avg Recall: 1.000000
d_prime: 2.021612
train_loss: 0.054728
valid_loss: 1.000211
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.001926495105489634
Epoch-14 lr: 0.001926495105489634
epoch 14 training time: 17.210
---------------
2023-09-11 13:49:58.275327
current #epochs=15, #steps=560
start validation
acc: 0.848341
AUC: 0.919280
Avg Precision: 0.315839
Avg Recall: 1.000000
d_prime: 1.980245
train_loss: 0.051110
valid_loss: 1.006706
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.001926495105489634
Epoch-15 lr: 0.001926495105489634
epoch 15 training time: 15.128
---------------
2023-09-11 13:50:13.404051
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03755	Per Sample Data Time 0.02797	Per Sample DNN Time 0.00958	Train Loss 0.0142	
start validation
acc: 0.805687
AUC: 0.921224
Avg Precision: 0.310069
Avg Recall: 1.000000
d_prime: 1.998779
train_loss: 0.054109
valid_loss: 1.019016
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.001926495105489634
Epoch-16 lr: 0.001926495105489634
epoch 16 training time: 15.120
---------------
2023-09-11 13:50:28.523691
current #epochs=17, #steps=640
start validation
acc: 0.829384
AUC: 0.925818
Avg Precision: 0.312031
Avg Recall: 1.000000
d_prime: 2.044007
train_loss: 0.048147
valid_loss: 1.011504
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0015712626144332462
Epoch-17 lr: 0.0015712626144332462
epoch 17 training time: 15.027
---------------
2023-09-11 13:50:43.550422
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00558	Train Loss 0.0491	
start validation
acc: 0.815166
AUC: 0.920669
Avg Precision: 0.318467
Avg Recall: 1.000000
d_prime: 1.993457
train_loss: 0.052637
valid_loss: 1.005047
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0015712626144332462
Epoch-18 lr: 0.0015712626144332462
epoch 18 training time: 15.067
---------------
2023-09-11 13:50:58.617047
current #epochs=19, #steps=720
start validation
acc: 0.819905
AUC: 0.924364
Avg Precision: 0.320850
Avg Recall: 1.000000
d_prime: 2.029474
train_loss: 0.067626
valid_loss: 0.997945
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0015712626144332462
Epoch-19 lr: 0.0015712626144332462
epoch 19 training time: 15.036
---------------
2023-09-11 13:51:13.652809
current #epochs=20, #steps=760
start validation
acc: 0.838863
AUC: 0.921287
Avg Precision: 0.343159
Avg Recall: 1.000000
d_prime: 1.999393
train_loss: 0.060571
valid_loss: 1.020198
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0015712626144332462
Epoch-20 lr: 0.0015712626144332462
epoch 20 training time: 16.584
---------------
2023-09-11 13:51:30.236816
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03598	Per Sample Data Time 0.02892	Per Sample DNN Time 0.00706	Train Loss 0.0592	
start validation
acc: 0.800948
AUC: 0.931641
Avg Precision: 0.337166
Avg Recall: 1.000000
d_prime: 2.104521
train_loss: 0.066648
valid_loss: 1.002066
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0015712626144332462
Epoch-21 lr: 0.0015712626144332462
epoch 21 training time: 14.973
---------------
2023-09-11 13:51:45.210064
current #epochs=22, #steps=840
start validation
acc: 0.838863
AUC: 0.931481
Avg Precision: 0.316496
Avg Recall: 1.000000
d_prime: 2.102809
train_loss: 0.045528
valid_loss: 0.981497
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0015712626144332462
Epoch-22 lr: 0.0015712626144332462
epoch 22 training time: 14.968
---------------
2023-09-11 13:52:00.178006
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00703	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00558	Train Loss 0.0252	
start validation
acc: 0.838863
AUC: 0.931913
Avg Precision: 0.325405
Avg Recall: 1.000000
d_prime: 2.107448
train_loss: 0.035221
valid_loss: 0.998039
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0015712626144332462
Epoch-23 lr: 0.0015712626144332462
epoch 23 training time: 14.953
---------------
2023-09-11 13:52:15.131297
current #epochs=24, #steps=920
start validation
acc: 0.824645
AUC: 0.933242
Avg Precision: 0.352432
Avg Recall: 1.000000
d_prime: 2.121860
train_loss: 0.033970
valid_loss: 1.007926
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0015712626144332462
Epoch-24 lr: 0.0015712626144332462
epoch 24 training time: 15.102
---------------
2023-09-11 13:52:30.233855
current #epochs=25, #steps=960
start validation
acc: 0.824645
AUC: 0.935176
Avg Precision: 0.344515
Avg Recall: 1.000000
d_prime: 2.143230
train_loss: 0.037207
valid_loss: 0.998799
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0015712626144332462
Epoch-25 lr: 0.0015712626144332462
epoch 25 training time: 15.012
---------------
2023-09-11 13:52:45.245607
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.04025	Per Sample Data Time 0.03019	Per Sample DNN Time 0.01006	Train Loss 0.0465	
start validation
acc: 0.800948
AUC: 0.931260
Avg Precision: 0.347430
Avg Recall: 1.000000
d_prime: 2.100443
train_loss: 0.041638
valid_loss: 1.002848
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0015712626144332462
Epoch-26 lr: 0.0015712626144332462
epoch 26 training time: 16.523
---------------
2023-09-11 13:53:01.768457
current #epochs=27, #steps=1040
start validation
acc: 0.810427
AUC: 0.939127
Avg Precision: 0.344688
Avg Recall: 1.000000
d_prime: 2.188474
train_loss: 0.034801
valid_loss: 1.000776
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0012815325595587838
Epoch-27 lr: 0.0012815325595587838
epoch 27 training time: 15.126
---------------
2023-09-11 13:53:16.894796
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00561	Train Loss 0.0441	
start validation
acc: 0.815166
AUC: 0.936733
Avg Precision: 0.337630
Avg Recall: 1.000000
d_prime: 2.160801
train_loss: 0.044802
valid_loss: 1.001713
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0012815325595587838
Epoch-28 lr: 0.0012815325595587838
epoch 28 training time: 16.307
---------------
2023-09-11 13:53:33.201658
current #epochs=29, #steps=1120
start validation
acc: 0.805687
AUC: 0.935631
Avg Precision: 0.328582
Avg Recall: 1.000000
d_prime: 2.148323
train_loss: 0.046210
valid_loss: 0.976387
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0012815325595587838
Epoch-29 lr: 0.0012815325595587838
epoch 29 training time: 15.160
---------------
2023-09-11 13:53:48.361719
current #epochs=30, #steps=1160
start validation
acc: 0.815166
AUC: 0.930619
Avg Precision: 0.348481
Avg Recall: 1.000000
d_prime: 2.093629
train_loss: 0.042821
valid_loss: 1.013099
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0012815325595587838
Epoch-30 lr: 0.0012815325595587838
epoch 30 training time: 15.073
---------------
2023-09-11 13:54:03.435063
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03631	Per Sample Data Time 0.02850	Per Sample DNN Time 0.00781	Train Loss 0.0893	
start validation
acc: 0.834123
AUC: 0.943325
Avg Precision: 0.361916
Avg Recall: 1.000000
d_prime: 2.239147
train_loss: 0.044894
valid_loss: 0.981188
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0012815325595587838
Epoch-31 lr: 0.0012815325595587838
epoch 31 training time: 15.101
---------------
2023-09-11 13:54:18.535915
current #epochs=32, #steps=1240
start validation
acc: 0.834123
AUC: 0.940394
Avg Precision: 0.354702
Avg Recall: 1.000000
d_prime: 2.203472
train_loss: 0.031318
valid_loss: 0.991879
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0012815325595587838
Epoch-32 lr: 0.0012815325595587838
epoch 32 training time: 15.262
---------------
2023-09-11 13:54:33.797517
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00562	Train Loss 0.0412	
start validation
acc: 0.819905
AUC: 0.940159
Avg Precision: 0.346179
Avg Recall: 1.000000
d_prime: 2.200671
train_loss: 0.034733
valid_loss: 0.990864
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0012815325595587838
Epoch-33 lr: 0.0012815325595587838
epoch 33 training time: 15.402
---------------
2023-09-11 13:54:49.199455
current #epochs=34, #steps=1320
start validation
acc: 0.829384
AUC: 0.934053
Avg Precision: 0.361905
Avg Recall: 1.000000
d_prime: 2.130763
train_loss: 0.036657
valid_loss: 1.008419
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0012815325595587838
Epoch-34 lr: 0.0012815325595587838
epoch 34 training time: 15.846
---------------
2023-09-11 13:55:05.045222
current #epochs=35, #steps=1360
start validation
acc: 0.834123
AUC: 0.933910
Avg Precision: 0.346126
Avg Recall: 1.000000
d_prime: 2.129180
train_loss: 0.049796
valid_loss: 1.000687
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0012815325595587838
Epoch-35 lr: 0.0012815325595587838
epoch 35 training time: 15.213
---------------
2023-09-11 13:55:20.258908
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03644	Per Sample Data Time 0.02873	Per Sample DNN Time 0.00772	Train Loss 0.0012	
start validation
acc: 0.838863
AUC: 0.931437
Avg Precision: 0.353793
Avg Recall: 1.000000
d_prime: 2.102344
train_loss: 0.039222
valid_loss: 1.001181
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0012815325595587838
Epoch-36 lr: 0.0012815325595587838
epoch 36 training time: 15.059
---------------
2023-09-11 13:55:35.317603
current #epochs=37, #steps=1440
start validation
acc: 0.810427
AUC: 0.924958
Avg Precision: 0.344603
Avg Recall: 1.000000
d_prime: 2.035382
train_loss: 0.038193
valid_loss: 1.013199
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0010452267406627466
Epoch-37 lr: 0.0010452267406627466
epoch 37 training time: 15.558
---------------
2023-09-11 13:55:50.876302
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00569	Train Loss 0.0458	
start validation
acc: 0.853081
AUC: 0.935184
Avg Precision: 0.356362
Avg Recall: 1.000000
d_prime: 2.143314
train_loss: 0.040301
valid_loss: 1.011563
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0010452267406627466
Epoch-38 lr: 0.0010452267406627466
epoch 38 training time: 15.739
---------------
2023-09-11 13:56:06.615420
current #epochs=39, #steps=1520
start validation
acc: 0.824645
AUC: 0.934928
Avg Precision: 0.359864
Avg Recall: 1.000000
d_prime: 2.140460
train_loss: 0.046269
valid_loss: 1.015463
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0010452267406627466
Epoch-39 lr: 0.0010452267406627466
epoch 39 training time: 15.093
---------------
2023-09-11 13:56:21.708656
current #epochs=40, #steps=1560
start validation
acc: 0.824645
AUC: 0.935486
Avg Precision: 0.361512
Avg Recall: 1.000000
d_prime: 2.146697
train_loss: 0.034531
valid_loss: 1.006688
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0010452267406627466
Epoch-40 lr: 0.0010452267406627466
epoch 40 training time: 14.937
---------------
2023-09-11 13:56:36.645790
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03952	Per Sample Data Time 0.02979	Per Sample DNN Time 0.00972	Train Loss 0.0041	
start validation
acc: 0.819905
AUC: 0.935994
Avg Precision: 0.358513
Avg Recall: 1.000000
d_prime: 2.152415
train_loss: 0.038837
valid_loss: 1.014243
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0010452267406627466
Epoch-41 lr: 0.0010452267406627466
epoch 41 training time: 15.139
---------------
2023-09-11 13:56:51.784586
current #epochs=42, #steps=1640
start validation
acc: 0.819905
AUC: 0.942274
Avg Precision: 0.385964
Avg Recall: 1.000000
d_prime: 2.226184
train_loss: 0.029331
valid_loss: 1.011035
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0010452267406627466
Epoch-42 lr: 0.0010452267406627466
epoch 42 training time: 15.032
---------------
2023-09-11 13:57:06.816898
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00700	Per Sample Data Time 0.00142	Per Sample DNN Time 0.00558	Train Loss 0.0370	
start validation
acc: 0.815166
AUC: 0.934204
Avg Precision: 0.358033
Avg Recall: 1.000000
d_prime: 2.132430
train_loss: 0.037817
valid_loss: 1.015169
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0010452267406627466
Epoch-43 lr: 0.0010452267406627466
epoch 43 training time: 14.801
---------------
2023-09-11 13:57:21.617750
current #epochs=44, #steps=1720
start validation
acc: 0.824645
AUC: 0.921695
Avg Precision: 0.324534
Avg Recall: 1.000000
d_prime: 2.003322
train_loss: 0.038278
valid_loss: 1.009037
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0010452267406627466
Epoch-44 lr: 0.0010452267406627466
epoch 44 training time: 16.661
---------------
2023-09-11 13:57:38.279034
current #epochs=45, #steps=1760
start validation
acc: 0.819905
AUC: 0.929797
Avg Precision: 0.343169
Avg Recall: 1.000000
d_prime: 2.084947
train_loss: 0.039362
valid_loss: 1.017701
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0010452267406627466
Epoch-45 lr: 0.0010452267406627466
epoch 45 training time: 15.151
---------------
2023-09-11 13:57:53.429739
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03553	Per Sample Data Time 0.02770	Per Sample DNN Time 0.00783	Train Loss 0.0562	
start validation
acc: 0.810427
AUC: 0.930857
Avg Precision: 0.332263
Avg Recall: 1.000000
d_prime: 2.096151
train_loss: 0.031826
valid_loss: 1.010504
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.0010452267406627466
Epoch-46 lr: 0.0010452267406627466
epoch 46 training time: 14.937
---------------
2023-09-11 13:58:08.366689
current #epochs=47, #steps=1840
start validation
acc: 0.815166
AUC: 0.927817
Avg Precision: 0.343722
Avg Recall: 1.000000
d_prime: 2.064362
train_loss: 0.027212
valid_loss: 1.025787
validation finished
normal learning rate scheduler step
Epoch-47 lr: 0.0008524940948613922
Epoch-47 lr: 0.0008524940948613922
epoch 47 training time: 16.623
---------------
2023-09-11 13:58:24.989596
current #epochs=48, #steps=1880
Epoch: [48][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00561	Train Loss 0.0321	
start validation
acc: 0.819905
AUC: 0.933681
Avg Precision: 0.338802
Avg Recall: 1.000000
d_prime: 2.126666
train_loss: 0.030500
valid_loss: 1.012327
validation finished
normal learning rate scheduler step
Epoch-48 lr: 0.0008524940948613922
Epoch-48 lr: 0.0008524940948613922
epoch 48 training time: 15.125
---------------
2023-09-11 13:58:40.114167
current #epochs=49, #steps=1920
start validation
[I 2023-09-11 13:58:55,019] Trial 47 finished with value: 0.8578199052132701 and parameters: {'warmup': 'False', 'num_epochs': 49, 'batch_size': 55, 'lr-adaptschedule': 'True', 'lr': 0.0023620388834963853, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.8156068551411644}. Best is trial 39 with value: 0.8672985781990521.
acc: 0.834123
AUC: 0.935221
Avg Precision: 0.336436
Avg Recall: 1.000000
d_prime: 2.143736
train_loss: 0.035947
valid_loss: 0.991187
validation finished
normal learning rate scheduler step
Epoch-49 lr: 0.0008524940948613922
Epoch-49 lr: 0.0008524940948613922
epoch 49 training time: 14.894
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f85b55a7a00>
The learning rate scheduler starts at 6 epoch with decay rate of 0.794 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 13:58:55.055087
current #epochs=1, #steps=0
start validation
acc: 0.819905
AUC: 0.925407
Avg Precision: 0.327037
Avg Recall: 1.000000
d_prime: 2.039884
train_loss: 0.071509
valid_loss: 1.020409
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002799035645819194
Epoch-1 lr: 0.002799035645819194
epoch 1 training time: 17.116
---------------
2023-09-11 13:59:12.171230
current #epochs=2, #steps=40
start validation
acc: 0.824645
AUC: 0.929379
Avg Precision: 0.358986
Avg Recall: 1.000000
d_prime: 2.080565
train_loss: 0.088068
valid_loss: 1.005633
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002799035645819194
Epoch-2 lr: 0.002799035645819194
epoch 2 training time: 17.112
---------------
2023-09-11 13:59:29.282932
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00561	Train Loss 0.0670	
start validation
acc: 0.867299
AUC: 0.934005
Avg Precision: 0.339479
Avg Recall: 1.000000
d_prime: 2.130230
train_loss: 0.059763
valid_loss: 1.005760
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002799035645819194
Epoch-3 lr: 0.002799035645819194
epoch 3 training time: 16.999
---------------
2023-09-11 13:59:46.281650
current #epochs=4, #steps=120
start validation
acc: 0.819905
AUC: 0.925682
Avg Precision: 0.334824
Avg Recall: 1.000000
d_prime: 2.042638
train_loss: 0.049212
valid_loss: 1.008652
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002799035645819194
Epoch-4 lr: 0.002799035645819194
epoch 4 training time: 15.170
---------------
2023-09-11 14:00:01.451468
current #epochs=5, #steps=160
start validation
acc: 0.815166
AUC: 0.906485
Avg Precision: 0.295262
Avg Recall: 1.000000
d_prime: 1.865933
train_loss: 0.052257
valid_loss: 1.026803
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002799035645819194
Epoch-5 lr: 0.002799035645819194
epoch 5 training time: 15.717
---------------
2023-09-11 14:00:17.168297
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03603	Per Sample Data Time 0.02845	Per Sample DNN Time 0.00759	Train Loss 0.0076	
start validation
acc: 0.824645
AUC: 0.911040
Avg Precision: 0.327460
Avg Recall: 1.000000
d_prime: 1.905206
train_loss: 0.050679
valid_loss: 1.005815
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002223143205883321
Epoch-6 lr: 0.002223143205883321
epoch 6 training time: 15.102
---------------
2023-09-11 14:00:32.270644
current #epochs=7, #steps=240
start validation
acc: 0.829384
AUC: 0.915235
Avg Precision: 0.308816
Avg Recall: 1.000000
d_prime: 1.942729
train_loss: 0.051126
valid_loss: 1.015424
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002223143205883321
Epoch-7 lr: 0.002223143205883321
epoch 7 training time: 15.045
---------------
2023-09-11 14:00:47.315926
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00555	Train Loss 0.0409	
start validation
acc: 0.824645
AUC: 0.921481
Avg Precision: 0.333289
Avg Recall: 1.000000
d_prime: 2.001263
train_loss: 0.037282
valid_loss: 1.015579
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.002223143205883321
Epoch-8 lr: 0.002223143205883321
epoch 8 training time: 16.403
---------------
2023-09-11 14:01:03.719315
current #epochs=9, #steps=320
start validation
acc: 0.819905
AUC: 0.929974
Avg Precision: 0.358669
Avg Recall: 1.000000
d_prime: 2.086813
train_loss: 0.033879
valid_loss: 1.013859
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.002223143205883321
Epoch-9 lr: 0.002223143205883321
epoch 9 training time: 15.244
---------------
2023-09-11 14:01:18.962749
current #epochs=10, #steps=360
start validation
acc: 0.834123
AUC: 0.930059
Avg Precision: 0.332608
Avg Recall: 1.000000
d_prime: 2.087707
train_loss: 0.049904
valid_loss: 0.990177
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.002223143205883321
Epoch-10 lr: 0.002223143205883321
epoch 10 training time: 15.058
---------------
2023-09-11 14:01:34.020791
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03696	Per Sample Data Time 0.02787	Per Sample DNN Time 0.00910	Train Loss 0.0059	
start validation
acc: 0.843602
AUC: 0.904273
Avg Precision: 0.326852
Avg Recall: 1.000000
d_prime: 1.847369
train_loss: 0.068684
valid_loss: 1.043875
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.002223143205883321
Epoch-11 lr: 0.002223143205883321
epoch 11 training time: 15.073
---------------
2023-09-11 14:01:49.094033
current #epochs=12, #steps=440
start validation
acc: 0.815166
AUC: 0.922359
Avg Precision: 0.326669
Avg Recall: 1.000000
d_prime: 2.009771
train_loss: 0.052397
valid_loss: 1.003294
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.002223143205883321
Epoch-12 lr: 0.002223143205883321
epoch 12 training time: 15.065
---------------
2023-09-11 14:02:04.158960
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00559	Train Loss 0.0463	
start validation
acc: 0.829384
AUC: 0.940213
Avg Precision: 0.351541
Avg Recall: 1.000000
d_prime: 2.201318
train_loss: 0.043781
valid_loss: 0.999909
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.002223143205883321
Epoch-13 lr: 0.002223143205883321
epoch 13 training time: 15.086
---------------
2023-09-11 14:02:19.245337
current #epochs=14, #steps=520
start validation
acc: 0.815166
AUC: 0.933990
Avg Precision: 0.329476
Avg Recall: 1.000000
d_prime: 2.130069
train_loss: 0.079140
valid_loss: 1.029582
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.002223143205883321
Epoch-14 lr: 0.002223143205883321
epoch 14 training time: 15.123
---------------
2023-09-11 14:02:34.368600
current #epochs=15, #steps=560
start validation
acc: 0.834123
AUC: 0.927836
Avg Precision: 0.312821
Avg Recall: 1.000000
d_prime: 2.064560
train_loss: 0.060696
valid_loss: 1.007276
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.002223143205883321
Epoch-15 lr: 0.002223143205883321
epoch 15 training time: 16.184
---------------
2023-09-11 14:02:50.552671
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03653	Per Sample Data Time 0.02840	Per Sample DNN Time 0.00813	Train Loss 0.0945	
start validation
acc: 0.810427
AUC: 0.922027
Avg Precision: 0.324621
Avg Recall: 1.000000
d_prime: 2.006539
train_loss: 0.058200
valid_loss: 0.996053
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0017657387540767411
Epoch-16 lr: 0.0017657387540767411
epoch 16 training time: 15.061
---------------
2023-09-11 14:03:05.614000
current #epochs=17, #steps=640
start validation
acc: 0.805687
AUC: 0.905221
Avg Precision: 0.322866
Avg Recall: 1.000000
d_prime: 1.855291
train_loss: 0.053524
valid_loss: 1.034389
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0017657387540767411
Epoch-17 lr: 0.0017657387540767411
epoch 17 training time: 15.657
---------------
2023-09-11 14:03:21.271055
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00562	Train Loss 0.0473	
start validation
acc: 0.819905
AUC: 0.914422
Avg Precision: 0.323672
Avg Recall: 1.000000
d_prime: 1.935346
train_loss: 0.044271
valid_loss: 1.021691
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0017657387540767411
Epoch-18 lr: 0.0017657387540767411
epoch 18 training time: 15.803
---------------
2023-09-11 14:03:37.073628
current #epochs=19, #steps=720
start validation
acc: 0.819905
AUC: 0.917024
Avg Precision: 0.318973
Avg Recall: 1.000000
d_prime: 1.959154
train_loss: 0.034747
valid_loss: 1.008631
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0017657387540767411
Epoch-19 lr: 0.0017657387540767411
epoch 19 training time: 15.097
---------------
2023-09-11 14:03:52.170742
current #epochs=20, #steps=760
start validation
acc: 0.805687
AUC: 0.901787
Avg Precision: 0.311409
Avg Recall: 1.000000
d_prime: 1.826881
train_loss: 0.049041
valid_loss: 1.017035
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0017657387540767411
Epoch-20 lr: 0.0017657387540767411
epoch 20 training time: 15.041
---------------
2023-09-11 14:04:07.211305
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03767	Per Sample Data Time 0.02753	Per Sample DNN Time 0.01015	Train Loss 0.0065	
start validation
acc: 0.848341
AUC: 0.923663
Avg Precision: 0.314391
Avg Recall: 1.000000
d_prime: 2.022541
train_loss: 0.031808
valid_loss: 0.995490
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0017657387540767411
Epoch-21 lr: 0.0017657387540767411
epoch 21 training time: 14.984
---------------
2023-09-11 14:04:22.195257
current #epochs=22, #steps=840
start validation
acc: 0.838863
AUC: 0.914111
Avg Precision: 0.316482
Avg Recall: 1.000000
d_prime: 1.932545
train_loss: 0.046920
valid_loss: 1.007357
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0017657387540767411
Epoch-22 lr: 0.0017657387540767411
epoch 22 training time: 15.012
---------------
2023-09-11 14:04:37.207645
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00560	Train Loss 0.0419	
start validation
acc: 0.805687
AUC: 0.915440
Avg Precision: 0.321935
Avg Recall: 1.000000
d_prime: 1.944596
train_loss: 0.051503
valid_loss: 1.003147
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0017657387540767411
Epoch-23 lr: 0.0017657387540767411
epoch 23 training time: 15.000
---------------
2023-09-11 14:04:52.207715
current #epochs=24, #steps=920
start validation
acc: 0.829384
AUC: 0.936145
Avg Precision: 0.403755
Avg Recall: 1.000000
d_prime: 2.154128
train_loss: 0.068320
valid_loss: 0.986969
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0017657387540767411
Epoch-24 lr: 0.0017657387540767411
epoch 24 training time: 15.082
---------------
2023-09-11 14:05:07.290042
current #epochs=25, #steps=960
start validation
acc: 0.810427
AUC: 0.929618
Avg Precision: 0.353862
Avg Recall: 1.000000
d_prime: 2.083064
train_loss: 0.049812
valid_loss: 1.015742
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0017657387540767411
Epoch-25 lr: 0.0017657387540767411
epoch 25 training time: 14.983
---------------
2023-09-11 14:05:22.272691
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03695	Per Sample Data Time 0.02969	Per Sample DNN Time 0.00726	Train Loss 0.0339	
start validation
acc: 0.819905
AUC: 0.929084
Avg Precision: 0.387148
Avg Recall: 1.000000
d_prime: 2.077481
train_loss: 0.044971
valid_loss: 1.022517
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0014024437739311867
Epoch-26 lr: 0.0014024437739311867
epoch 26 training time: 15.137
---------------
2023-09-11 14:05:37.409918
current #epochs=27, #steps=1040
start validation
acc: 0.819905
AUC: 0.930435
Avg Precision: 0.389703
Avg Recall: 1.000000
d_prime: 2.091681
train_loss: 0.041459
valid_loss: 1.006692
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0014024437739311867
Epoch-27 lr: 0.0014024437739311867
epoch 27 training time: 15.077
---------------
2023-09-11 14:05:52.486926
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00559	Train Loss 0.0530	
start validation
acc: 0.838863
AUC: 0.925575
Avg Precision: 0.350503
Avg Recall: 1.000000
d_prime: 2.041569
train_loss: 0.039655
valid_loss: 1.003262
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0014024437739311867
Epoch-28 lr: 0.0014024437739311867
epoch 28 training time: 15.025
---------------
2023-09-11 14:06:07.511976
current #epochs=29, #steps=1120
start validation
acc: 0.805687
AUC: 0.922254
Avg Precision: 0.342159
Avg Recall: 1.000000
d_prime: 2.008741
train_loss: 0.051365
valid_loss: 1.019030
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0014024437739311867
Epoch-29 lr: 0.0014024437739311867
epoch 29 training time: 15.128
---------------
2023-09-11 14:06:22.639971
current #epochs=30, #steps=1160
start validation
acc: 0.834123
AUC: 0.930497
Avg Precision: 0.348826
Avg Recall: 1.000000
d_prime: 2.092333
train_loss: 0.047672
valid_loss: 1.031287
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0014024437739311867
Epoch-30 lr: 0.0014024437739311867
epoch 30 training time: 15.262
---------------
2023-09-11 14:06:37.902065
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03730	Per Sample Data Time 0.02996	Per Sample DNN Time 0.00734	Train Loss 0.0029	
start validation
acc: 0.805687
AUC: 0.923291
Avg Precision: 0.329845
Avg Recall: 1.000000
d_prime: 2.018873
train_loss: 0.041007
valid_loss: 1.014776
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0014024437739311867
Epoch-31 lr: 0.0014024437739311867
epoch 31 training time: 15.059
---------------
2023-09-11 14:06:52.961040
current #epochs=32, #steps=1240
start validation
acc: 0.834123
AUC: 0.933447
Avg Precision: 0.356352
Avg Recall: 1.000000
d_prime: 2.124099
train_loss: 0.042243
valid_loss: 0.998876
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0014024437739311867
Epoch-32 lr: 0.0014024437739311867
epoch 32 training time: 15.067
---------------
2023-09-11 14:07:08.028460
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00723	Per Sample Data Time 0.00161	Per Sample DNN Time 0.00562	Train Loss 0.0281	
start validation
acc: 0.848341
AUC: 0.930678
Avg Precision: 0.328016
Avg Recall: 1.000000
d_prime: 2.094249
train_loss: 0.033444
valid_loss: 0.992016
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0014024437739311867
Epoch-33 lr: 0.0014024437739311867
epoch 33 training time: 15.158
---------------
2023-09-11 14:07:23.186877
current #epochs=34, #steps=1320
start validation
acc: 0.829384
AUC: 0.927858
Avg Precision: 0.336356
Avg Recall: 1.000000
d_prime: 2.064788
train_loss: 0.031484
valid_loss: 1.001213
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0014024437739311867
Epoch-34 lr: 0.0014024437739311867
epoch 34 training time: 15.070
---------------
2023-09-11 14:07:38.257341
current #epochs=35, #steps=1360
start validation
acc: 0.824645
AUC: 0.918371
Avg Precision: 0.319206
Avg Recall: 1.000000
d_prime: 1.971689
train_loss: 0.029426
valid_loss: 1.016055
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0014024437739311867
Epoch-35 lr: 0.0014024437739311867
epoch 35 training time: 15.075
---------------
2023-09-11 14:07:53.332552
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03865	Per Sample Data Time 0.02832	Per Sample DNN Time 0.01032	Train Loss 0.0013	
start validation
acc: 0.843602
AUC: 0.919612
Avg Precision: 0.338299
Avg Recall: 1.000000
d_prime: 1.983391
train_loss: 0.025753
valid_loss: 1.008486
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0011138955490993703
Epoch-36 lr: 0.0011138955490993703
epoch 36 training time: 15.091
---------------
2023-09-11 14:08:08.423987
current #epochs=37, #steps=1440
start validation
acc: 0.838863
AUC: 0.923348
Avg Precision: 0.329061
Avg Recall: 1.000000
d_prime: 2.019435
train_loss: 0.026898
valid_loss: 1.004120
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0011138955490993703
Epoch-37 lr: 0.0011138955490993703
epoch 37 training time: 15.075
---------------
2023-09-11 14:08:23.498390
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00561	Train Loss 0.0346	
start validation
acc: 0.829384
AUC: 0.920289
Avg Precision: 0.319558
Avg Recall: 1.000000
d_prime: 1.989821
train_loss: 0.033229
valid_loss: 0.992424
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0011138955490993703
Epoch-38 lr: 0.0011138955490993703
epoch 38 training time: 14.957
---------------
2023-09-11 14:08:38.455450
current #epochs=39, #steps=1520
start validation
acc: 0.834123
AUC: 0.925673
Avg Precision: 0.329601
Avg Recall: 1.000000
d_prime: 2.042547
train_loss: 0.040120
valid_loss: 0.977772
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0011138955490993703
Epoch-39 lr: 0.0011138955490993703
epoch 39 training time: 16.398
---------------
2023-09-11 14:08:54.853360
current #epochs=40, #steps=1560
start validation
acc: 0.819905
AUC: 0.923778
Avg Precision: 0.337420
Avg Recall: 1.000000
d_prime: 2.023671
train_loss: 0.036021
valid_loss: 0.994017
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0011138955490993703
Epoch-40 lr: 0.0011138955490993703
epoch 40 training time: 15.127
---------------
2023-09-11 14:09:09.980765
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03613	Per Sample Data Time 0.02863	Per Sample DNN Time 0.00751	Train Loss 0.0701	
start validation
acc: 0.838863
AUC: 0.918737
Avg Precision: 0.326917
Avg Recall: 1.000000
d_prime: 1.975132
train_loss: 0.033855
valid_loss: 1.010223
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0011138955490993703
Epoch-41 lr: 0.0011138955490993703
epoch 41 training time: 15.087
---------------
2023-09-11 14:09:25.067692
current #epochs=42, #steps=1640
start validation
acc: 0.815166
AUC: 0.921672
Avg Precision: 0.337784
Avg Recall: 1.000000
d_prime: 2.003104
train_loss: 0.043432
valid_loss: 0.986481
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0011138955490993703
Epoch-42 lr: 0.0011138955490993703
epoch 42 training time: 15.200
---------------
2023-09-11 14:09:40.267273
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00560	Train Loss 0.0455	
start validation
acc: 0.815166
AUC: 0.922753
Avg Precision: 0.333868
Avg Recall: 1.000000
d_prime: 2.013612
train_loss: 0.043891
valid_loss: 1.005662
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0011138955490993703
Epoch-43 lr: 0.0011138955490993703
epoch 43 training time: 15.076
---------------
2023-09-11 14:09:55.343772
current #epochs=44, #steps=1720
start validation
acc: 0.800948
AUC: 0.913303
Avg Precision: 0.335261
Avg Recall: 1.000000
d_prime: 1.925278
train_loss: 0.030909
valid_loss: 1.006823
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0011138955490993703
Epoch-44 lr: 0.0011138955490993703
epoch 44 training time: 15.054
---------------
2023-09-11 14:10:10.398001
current #epochs=45, #steps=1760
start validation
acc: 0.791469
AUC: 0.913848
Avg Precision: 0.332998
Avg Recall: 1.000000
d_prime: 1.930169
train_loss: 0.045913
valid_loss: 1.024576
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0011138955490993703
Epoch-45 lr: 0.0011138955490993703
epoch 45 training time: 15.944
---------------
2023-09-11 14:10:26.342250
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03651	Per Sample Data Time 0.02838	Per Sample DNN Time 0.00813	Train Loss 0.0514	
start validation
[I 2023-09-11 14:10:41,471] Trial 48 finished with value: 0.8672985781990521 and parameters: {'warmup': 'False', 'num_epochs': 46, 'batch_size': 58, 'lr-adaptschedule': 'True', 'lr': 0.002799035645819194, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.7942532669078151}. Best is trial 39 with value: 0.8672985781990521.
acc: 0.796209
AUC: 0.921501
Avg Precision: 0.321803
Avg Recall: 1.000000
d_prime: 2.001450
train_loss: 0.033170
valid_loss: 1.017298
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.0008847151788662494
Epoch-46 lr: 0.0008847151788662494
epoch 46 training time: 15.119
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f85b52a6a60>
The learning rate scheduler starts at 5 epoch with decay rate of 0.738 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 14:10:41.508004
current #epochs=1, #steps=0
start validation
acc: 0.819905
AUC: 0.914981
Avg Precision: 0.346562
Avg Recall: 1.000000
d_prime: 1.940417
train_loss: 0.073964
valid_loss: 1.012481
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0027669493319444054
Epoch-1 lr: 0.0027669493319444054
epoch 1 training time: 17.033
---------------
2023-09-11 14:10:58.541123
current #epochs=2, #steps=40
start validation
acc: 0.824645
AUC: 0.912910
Avg Precision: 0.331348
Avg Recall: 1.000000
d_prime: 1.921771
train_loss: 0.053027
valid_loss: 1.030154
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0027669493319444054
Epoch-2 lr: 0.0027669493319444054
epoch 2 training time: 17.327
---------------
2023-09-11 14:11:15.868837
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00559	Train Loss 0.0548	
start validation
acc: 0.815166
AUC: 0.908497
Avg Precision: 0.329131
Avg Recall: 1.000000
d_prime: 1.883108
train_loss: 0.051933
valid_loss: 1.026509
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0027669493319444054
Epoch-3 lr: 0.0027669493319444054
epoch 3 training time: 15.138
---------------
2023-09-11 14:11:31.006785
current #epochs=4, #steps=120
start validation
acc: 0.843602
AUC: 0.910862
Avg Precision: 0.326422
Avg Recall: 1.000000
d_prime: 1.903645
train_loss: 0.047184
valid_loss: 1.003713
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0027669493319444054
Epoch-4 lr: 0.0027669493319444054
epoch 4 training time: 17.032
---------------
2023-09-11 14:11:48.038847
current #epochs=5, #steps=160
start validation
acc: 0.796209
AUC: 0.885363
Avg Precision: 0.325623
Avg Recall: 1.000000
d_prime: 1.700211
train_loss: 0.064696
valid_loss: 1.055029
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002042145337852125
Epoch-5 lr: 0.002042145337852125
epoch 5 training time: 15.095
---------------
2023-09-11 14:12:03.133592
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03899	Per Sample Data Time 0.02886	Per Sample DNN Time 0.01013	Train Loss 0.1617	
start validation
acc: 0.838863
AUC: 0.919973
Avg Precision: 0.319862
Avg Recall: 1.000000
d_prime: 1.986812
train_loss: 0.088365
valid_loss: 1.017096
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002042145337852125
Epoch-6 lr: 0.002042145337852125
epoch 6 training time: 15.093
---------------
2023-09-11 14:12:18.226815
current #epochs=7, #steps=240
start validation
acc: 0.838863
AUC: 0.917293
Avg Precision: 0.324108
Avg Recall: 1.000000
d_prime: 1.961640
train_loss: 0.058680
valid_loss: 1.000312
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002042145337852125
Epoch-7 lr: 0.002042145337852125
epoch 7 training time: 15.108
---------------
2023-09-11 14:12:33.334944
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00561	Train Loss 0.0400	
start validation
acc: 0.824645
AUC: 0.934362
Avg Precision: 0.349345
Avg Recall: 1.000000
d_prime: 2.134177
train_loss: 0.046264
valid_loss: 1.007741
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.002042145337852125
Epoch-8 lr: 0.002042145337852125
epoch 8 training time: 15.552
---------------
2023-09-11 14:12:48.887242
current #epochs=9, #steps=320
start validation
acc: 0.834123
AUC: 0.934248
Avg Precision: 0.362030
Avg Recall: 1.000000
d_prime: 2.132916
train_loss: 0.048840
valid_loss: 1.008413
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.002042145337852125
Epoch-9 lr: 0.002042145337852125
epoch 9 training time: 15.084
---------------
2023-09-11 14:13:03.971891
current #epochs=10, #steps=360
start validation
acc: 0.838863
AUC: 0.928855
Avg Precision: 0.339930
Avg Recall: 1.000000
d_prime: 2.075096
train_loss: 0.044876
valid_loss: 1.008898
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.002042145337852125
Epoch-10 lr: 0.002042145337852125
epoch 10 training time: 15.075
---------------
2023-09-11 14:13:19.046843
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03638	Per Sample Data Time 0.02873	Per Sample DNN Time 0.00765	Train Loss 0.0382	
start validation
acc: 0.819905
AUC: 0.927838
Avg Precision: 0.334742
Avg Recall: 1.000000
d_prime: 2.064582
train_loss: 0.054143
valid_loss: 1.014609
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.002042145337852125
Epoch-11 lr: 0.002042145337852125
epoch 11 training time: 15.172
---------------
2023-09-11 14:13:34.218608
current #epochs=12, #steps=440
start validation
acc: 0.829384
AUC: 0.923316
Avg Precision: 0.343066
Avg Recall: 1.000000
d_prime: 2.019121
train_loss: 0.049604
valid_loss: 1.012761
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.002042145337852125
Epoch-12 lr: 0.002042145337852125
epoch 12 training time: 15.503
---------------
2023-09-11 14:13:49.722098
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00570	Train Loss 0.0443	
start validation
acc: 0.810427
AUC: 0.927789
Avg Precision: 0.328813
Avg Recall: 1.000000
d_prime: 2.064069
train_loss: 0.044808
valid_loss: 0.996797
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.002042145337852125
Epoch-13 lr: 0.002042145337852125
epoch 13 training time: 15.132
---------------
2023-09-11 14:14:04.854087
current #epochs=14, #steps=520
start validation
acc: 0.805687
AUC: 0.923425
Avg Precision: 0.317648
Avg Recall: 1.000000
d_prime: 2.020197
train_loss: 0.033173
valid_loss: 1.002868
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.001507204173478867
Epoch-14 lr: 0.001507204173478867
epoch 14 training time: 15.227
---------------
2023-09-11 14:14:20.080754
current #epochs=15, #steps=560
start validation
acc: 0.819905
AUC: 0.921129
Avg Precision: 0.308410
Avg Recall: 1.000000
d_prime: 1.997873
train_loss: 0.030115
valid_loss: 1.023140
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.001507204173478867
Epoch-15 lr: 0.001507204173478867
epoch 15 training time: 15.753
---------------
2023-09-11 14:14:35.833856
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03929	Per Sample Data Time 0.02847	Per Sample DNN Time 0.01081	Train Loss 0.0165	
start validation
acc: 0.819905
AUC: 0.925250
Avg Precision: 0.325020
Avg Recall: 1.000000
d_prime: 2.038302
train_loss: 0.034709
valid_loss: 0.996171
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.001507204173478867
Epoch-16 lr: 0.001507204173478867
epoch 16 training time: 15.046
---------------
2023-09-11 14:14:50.879928
current #epochs=17, #steps=640
start validation
acc: 0.800948
AUC: 0.926701
Avg Precision: 0.319835
Avg Recall: 1.000000
d_prime: 2.052948
train_loss: 0.037534
valid_loss: 1.005584
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.001507204173478867
Epoch-17 lr: 0.001507204173478867
epoch 17 training time: 14.993
---------------
2023-09-11 14:15:05.872647
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00563	Train Loss 0.0401	
start validation
acc: 0.829384
AUC: 0.926882
Avg Precision: 0.327954
Avg Recall: 1.000000
d_prime: 2.054795
train_loss: 0.031709
valid_loss: 0.987115
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001507204173478867
Epoch-18 lr: 0.001507204173478867
epoch 18 training time: 14.898
---------------
2023-09-11 14:15:20.770231
current #epochs=19, #steps=720
start validation
acc: 0.829384
AUC: 0.915047
Avg Precision: 0.309216
Avg Recall: 1.000000
d_prime: 1.941018
train_loss: 0.035704
valid_loss: 1.017801
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.001507204173478867
Epoch-19 lr: 0.001507204173478867
epoch 19 training time: 16.194
---------------
2023-09-11 14:15:36.963915
current #epochs=20, #steps=760
start validation
acc: 0.815166
AUC: 0.922870
Avg Precision: 0.321862
Avg Recall: 1.000000
d_prime: 2.014755
train_loss: 0.027852
valid_loss: 1.004204
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.001507204173478867
Epoch-20 lr: 0.001507204173478867
epoch 20 training time: 15.564
---------------
2023-09-11 14:15:52.527622
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03638	Per Sample Data Time 0.02880	Per Sample DNN Time 0.00757	Train Loss 0.0009	
start validation
acc: 0.815166
AUC: 0.917528
Avg Precision: 0.318497
Avg Recall: 1.000000
d_prime: 1.963830
train_loss: 0.042478
valid_loss: 1.018560
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.001507204173478867
Epoch-21 lr: 0.001507204173478867
epoch 21 training time: 14.997
---------------
2023-09-11 14:16:07.524566
current #epochs=22, #steps=840
start validation
acc: 0.815166
AUC: 0.908573
Avg Precision: 0.310260
Avg Recall: 1.000000
d_prime: 1.883755
train_loss: 0.045230
valid_loss: 1.019184
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.001507204173478867
Epoch-22 lr: 0.001507204173478867
epoch 22 training time: 15.312
---------------
2023-09-11 14:16:22.836469
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00561	Train Loss 0.0318	
start validation
acc: 0.829384
AUC: 0.920834
Avg Precision: 0.328057
Avg Recall: 1.000000
d_prime: 1.995037
train_loss: 0.032899
valid_loss: 1.004621
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.001112391159652423
Epoch-23 lr: 0.001112391159652423
epoch 23 training time: 15.051
---------------
2023-09-11 14:16:37.887338
current #epochs=24, #steps=920
start validation
acc: 0.848341
AUC: 0.913371
Avg Precision: 0.334286
Avg Recall: 1.000000
d_prime: 1.925885
train_loss: 0.031312
valid_loss: 1.018179
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.001112391159652423
Epoch-24 lr: 0.001112391159652423
epoch 24 training time: 17.393
---------------
2023-09-11 14:16:55.280171
current #epochs=25, #steps=960
start validation
acc: 0.829384
AUC: 0.912428
Avg Precision: 0.312485
Avg Recall: 1.000000
d_prime: 1.917475
train_loss: 0.029910
valid_loss: 1.012696
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.001112391159652423
Epoch-25 lr: 0.001112391159652423
epoch 25 training time: 15.253
---------------
2023-09-11 14:17:10.533474
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03499	Per Sample Data Time 0.02693	Per Sample DNN Time 0.00806	Train Loss 0.0137	
start validation
acc: 0.791469
AUC: 0.907986
Avg Precision: 0.339624
Avg Recall: 1.000000
d_prime: 1.878716
train_loss: 0.047000
valid_loss: 1.009078
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.001112391159652423
Epoch-26 lr: 0.001112391159652423
epoch 26 training time: 14.947
---------------
2023-09-11 14:17:25.480050
current #epochs=27, #steps=1040
start validation
acc: 0.815166
AUC: 0.907524
Avg Precision: 0.316973
Avg Recall: 1.000000
d_prime: 1.874764
train_loss: 0.048583
valid_loss: 1.022320
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.001112391159652423
Epoch-27 lr: 0.001112391159652423
epoch 27 training time: 15.027
---------------
2023-09-11 14:17:40.506613
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00143	Per Sample DNN Time 0.00565	Train Loss 0.0297	
start validation
acc: 0.815166
AUC: 0.910710
Avg Precision: 0.330757
Avg Recall: 1.000000
d_prime: 1.902317
train_loss: 0.028225
valid_loss: 1.015460
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.001112391159652423
Epoch-28 lr: 0.001112391159652423
epoch 28 training time: 16.494
---------------
2023-09-11 14:17:57.001027
current #epochs=29, #steps=1120
start validation
acc: 0.838863
AUC: 0.920570
Avg Precision: 0.347319
Avg Recall: 1.000000
d_prime: 1.992510
train_loss: 0.030039
valid_loss: 1.006724
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.001112391159652423
Epoch-29 lr: 0.001112391159652423
epoch 29 training time: 16.375
---------------
2023-09-11 14:18:13.375922
current #epochs=30, #steps=1160
start validation
acc: 0.834123
AUC: 0.920948
Avg Precision: 0.320419
Avg Recall: 1.000000
d_prime: 1.996127
train_loss: 0.033906
valid_loss: 1.002091
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.001112391159652423
Epoch-30 lr: 0.001112391159652423
epoch 30 training time: 16.225
---------------
2023-09-11 14:18:29.600919
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03711	Per Sample Data Time 0.02832	Per Sample DNN Time 0.00879	Train Loss 0.1719	
start validation
acc: 0.810427
AUC: 0.917629
Avg Precision: 0.310855
Avg Recall: 1.000000
d_prime: 1.964766
train_loss: 0.031773
valid_loss: 1.012206
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.001112391159652423
Epoch-31 lr: 0.001112391159652423
epoch 31 training time: 15.408
---------------
2023-09-11 14:18:45.008832
current #epochs=32, #steps=1240
start validation
acc: 0.819905
AUC: 0.924142
Avg Precision: 0.331640
Avg Recall: 1.000000
d_prime: 2.027270
train_loss: 0.031022
valid_loss: 0.997070
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0008209996454672187
Epoch-32 lr: 0.0008209996454672187
epoch 32 training time: 15.223
---------------
2023-09-11 14:19:00.232091
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00564	Train Loss 0.0308	
start validation
acc: 0.815166
AUC: 0.920682
Avg Precision: 0.327894
Avg Recall: 1.000000
d_prime: 1.993581
train_loss: 0.036291
valid_loss: 1.006133
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0008209996454672187
Epoch-33 lr: 0.0008209996454672187
epoch 33 training time: 14.981
---------------
2023-09-11 14:19:15.213139
current #epochs=34, #steps=1320
start validation
acc: 0.843602
AUC: 0.918973
Avg Precision: 0.319153
Avg Recall: 1.000000
d_prime: 1.977353
train_loss: 0.030684
valid_loss: 1.012375
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0008209996454672187
Epoch-34 lr: 0.0008209996454672187
epoch 34 training time: 15.412
---------------
2023-09-11 14:19:30.625005
current #epochs=35, #steps=1360
start validation
acc: 0.834123
AUC: 0.921282
Avg Precision: 0.321659
Avg Recall: 1.000000
d_prime: 1.999342
train_loss: 0.019902
valid_loss: 1.014833
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0008209996454672187
Epoch-35 lr: 0.0008209996454672187
epoch 35 training time: 15.060
---------------
2023-09-11 14:19:45.684717
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03664	Per Sample Data Time 0.02915	Per Sample DNN Time 0.00750	Train Loss 0.0470	
start validation
acc: 0.824645
AUC: 0.908477
Avg Precision: 0.337113
Avg Recall: 1.000000
d_prime: 1.882929
train_loss: 0.045903
valid_loss: 1.017960
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0008209996454672187
Epoch-36 lr: 0.0008209996454672187
epoch 36 training time: 14.990
---------------
2023-09-11 14:20:00.675298
current #epochs=37, #steps=1440
start validation
acc: 0.848341
AUC: 0.928556
Avg Precision: 0.322832
Avg Recall: 1.000000
d_prime: 2.071989
train_loss: 0.045604
valid_loss: 1.008715
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0008209996454672187
Epoch-37 lr: 0.0008209996454672187
epoch 37 training time: 15.113
---------------
2023-09-11 14:20:15.788634
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00159	Per Sample DNN Time 0.00556	Train Loss 0.0319	
start validation
acc: 0.829384
AUC: 0.923136
Avg Precision: 0.312569
Avg Recall: 1.000000
d_prime: 2.017352
train_loss: 0.038047
valid_loss: 1.014718
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0008209996454672187
Epoch-38 lr: 0.0008209996454672187
epoch 38 training time: 15.137
---------------
2023-09-11 14:20:30.925961
current #epochs=39, #steps=1520
start validation
acc: 0.815166
AUC: 0.923927
Avg Precision: 0.330560
Avg Recall: 1.000000
d_prime: 2.025142
train_loss: 0.028437
valid_loss: 1.015785
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0008209996454672187
Epoch-39 lr: 0.0008209996454672187
epoch 39 training time: 16.169
---------------
2023-09-11 14:20:47.094965
current #epochs=40, #steps=1560
start validation
acc: 0.824645
AUC: 0.920675
Avg Precision: 0.329640
Avg Recall: 1.000000
d_prime: 1.993513
train_loss: 0.034594
valid_loss: 1.017877
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0008209996454672187
Epoch-40 lr: 0.0008209996454672187
epoch 40 training time: 15.068
---------------
2023-09-11 14:21:02.162674
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03717	Per Sample Data Time 0.02951	Per Sample DNN Time 0.00766	Train Loss 0.0030	
start validation
acc: 0.810427
AUC: 0.917703
Avg Precision: 0.317718
Avg Recall: 1.000000
d_prime: 1.965458
train_loss: 0.032460
valid_loss: 1.024693
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0006059383086682468
Epoch-41 lr: 0.0006059383086682468
epoch 41 training time: 15.108
---------------
2023-09-11 14:21:17.270411
current #epochs=42, #steps=1640
start validation
acc: 0.848341
AUC: 0.920920
Avg Precision: 0.325026
Avg Recall: 1.000000
d_prime: 1.995862
train_loss: 0.025199
valid_loss: 1.011578
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0006059383086682468
Epoch-42 lr: 0.0006059383086682468
epoch 42 training time: 15.601
---------------
2023-09-11 14:21:32.871806
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00568	Train Loss 0.0264	
start validation
acc: 0.862559
AUC: 0.922239
Avg Precision: 0.318596
Avg Recall: 1.000000
d_prime: 2.008602
train_loss: 0.031774
valid_loss: 1.012520
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0006059383086682468
Epoch-43 lr: 0.0006059383086682468
epoch 43 training time: 17.207
---------------
2023-09-11 14:21:50.079103
current #epochs=44, #steps=1720
start validation
acc: 0.848341
AUC: 0.926279
Avg Precision: 0.325030
Avg Recall: 1.000000
d_prime: 2.048664
train_loss: 0.033225
valid_loss: 1.012405
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0006059383086682468
Epoch-44 lr: 0.0006059383086682468
epoch 44 training time: 15.105
---------------
2023-09-11 14:22:05.184262
current #epochs=45, #steps=1760
start validation
[I 2023-09-11 14:22:21,851] Trial 49 finished with value: 0.8625592417061612 and parameters: {'warmup': 'False', 'num_epochs': 45, 'batch_size': 58, 'lr-adaptschedule': 'True', 'lr': 0.0027669493319444054, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.7380494157502544}. Best is trial 39 with value: 0.8672985781990521.
acc: 0.810427
AUC: 0.921335
Avg Precision: 0.331655
Avg Recall: 1.000000
d_prime: 1.999850
train_loss: 0.032382
valid_loss: 1.015322
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0006059383086682468
Epoch-45 lr: 0.0006059383086682468
epoch 45 training time: 16.655
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f859ea60040>
The learning rate scheduler starts at 4 epoch with decay rate of 0.735 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 14:22:21.888758
current #epochs=1, #steps=0
start validation
acc: 0.815166
AUC: 0.928980
Avg Precision: 0.347154
Avg Recall: 1.000000
d_prime: 2.076399
train_loss: 0.085425
valid_loss: 1.004555
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0030400716311932458
Epoch-1 lr: 0.0030400716311932458
epoch 1 training time: 17.296
---------------
2023-09-11 14:22:39.184581
current #epochs=2, #steps=40
start validation
acc: 0.810427
AUC: 0.934566
Avg Precision: 0.334268
Avg Recall: 1.000000
d_prime: 2.136440
train_loss: 0.081325
valid_loss: 1.000042
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0030400716311932458
Epoch-2 lr: 0.0030400716311932458
epoch 2 training time: 15.012
---------------
2023-09-11 14:22:54.196406
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00704	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00558	Train Loss 0.0613	
start validation
acc: 0.819905
AUC: 0.930767
Avg Precision: 0.354240
Avg Recall: 1.000000
d_prime: 2.095199
train_loss: 0.070487
valid_loss: 1.018945
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0030400716311932458
Epoch-3 lr: 0.0030400716311932458
epoch 3 training time: 17.108
---------------
2023-09-11 14:23:11.304350
current #epochs=4, #steps=120
start validation
acc: 0.815166
AUC: 0.922416
Avg Precision: 0.327188
Avg Recall: 1.000000
d_prime: 2.010317
train_loss: 0.051990
valid_loss: 1.007164
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002234992274509762
Epoch-4 lr: 0.002234992274509762
epoch 4 training time: 14.909
---------------
2023-09-11 14:23:26.213473
current #epochs=5, #steps=160
start validation
acc: 0.819905
AUC: 0.925395
Avg Precision: 0.337877
Avg Recall: 1.000000
d_prime: 2.039758
train_loss: 0.042970
valid_loss: 1.010727
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002234992274509762
Epoch-5 lr: 0.002234992274509762
epoch 5 training time: 15.078
---------------
2023-09-11 14:23:41.291331
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03886	Per Sample Data Time 0.02851	Per Sample DNN Time 0.01034	Train Loss 0.0030	
start validation
acc: 0.829384
AUC: 0.914019
Avg Precision: 0.343538
Avg Recall: 1.000000
d_prime: 1.931711
train_loss: 0.058145
valid_loss: 1.020061
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002234992274509762
Epoch-6 lr: 0.002234992274509762
epoch 6 training time: 17.124
---------------
2023-09-11 14:23:58.414935
current #epochs=7, #steps=240
start validation
acc: 0.824645
AUC: 0.946439
Avg Precision: 0.394115
Avg Recall: 1.000000
d_prime: 2.278666
train_loss: 0.068762
valid_loss: 0.999111
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002234992274509762
Epoch-7 lr: 0.002234992274509762
epoch 7 training time: 15.124
---------------
2023-09-11 14:24:13.539322
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00573	Train Loss 0.0561	
start validation
acc: 0.881517
AUC: 0.949651
Avg Precision: 0.357016
Avg Recall: 1.000000
d_prime: 2.321400
train_loss: 0.049730
valid_loss: 0.996153
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.002234992274509762
Epoch-8 lr: 0.002234992274509762
epoch 8 training time: 17.167
---------------
2023-09-11 14:24:30.706409
current #epochs=9, #steps=320
start validation
acc: 0.819905
AUC: 0.945662
Avg Precision: 0.379143
Avg Recall: 1.000000
d_prime: 2.268643
train_loss: 0.068591
valid_loss: 1.001854
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.002234992274509762
Epoch-9 lr: 0.002234992274509762
epoch 9 training time: 16.509
---------------
2023-09-11 14:24:47.214949
current #epochs=10, #steps=360
start validation
acc: 0.838863
AUC: 0.948624
Avg Precision: 0.369874
Avg Recall: 1.000000
d_prime: 2.307514
train_loss: 0.045368
valid_loss: 0.995379
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.002234992274509762
Epoch-10 lr: 0.002234992274509762
epoch 10 training time: 15.154
---------------
2023-09-11 14:25:02.368645
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03452	Per Sample Data Time 0.02700	Per Sample DNN Time 0.00752	Train Loss 0.0018	
start validation
acc: 0.824645
AUC: 0.941159
Avg Precision: 0.380659
Avg Recall: 1.000000
d_prime: 2.212652
train_loss: 0.048858
valid_loss: 1.012410
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.002234992274509762
Epoch-11 lr: 0.002234992274509762
epoch 11 training time: 15.073
---------------
2023-09-11 14:25:17.442125
current #epochs=12, #steps=440
start validation
acc: 0.824645
AUC: 0.945818
Avg Precision: 0.394751
Avg Recall: 1.000000
d_prime: 2.270650
train_loss: 0.046014
valid_loss: 0.997180
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.002234992274509762
Epoch-12 lr: 0.002234992274509762
epoch 12 training time: 15.220
---------------
2023-09-11 14:25:32.662096
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00704	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00553	Train Loss 0.0494	
start validation
acc: 0.838863
AUC: 0.939052
Avg Precision: 0.357686
Avg Recall: 1.000000
d_prime: 2.187601
train_loss: 0.046551
valid_loss: 1.007774
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.001643116042353804
Epoch-13 lr: 0.001643116042353804
epoch 13 training time: 15.093
---------------
2023-09-11 14:25:47.755508
current #epochs=14, #steps=520
start validation
acc: 0.796209
AUC: 0.939162
Avg Precision: 0.370963
Avg Recall: 1.000000
d_prime: 2.188891
train_loss: 0.048333
valid_loss: 0.995182
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.001643116042353804
Epoch-14 lr: 0.001643116042353804
epoch 14 training time: 15.165
---------------
2023-09-11 14:26:02.920125
current #epochs=15, #steps=560
start validation
acc: 0.805687
AUC: 0.940991
Avg Precision: 0.374894
Avg Recall: 1.000000
d_prime: 2.210623
train_loss: 0.036956
valid_loss: 0.994252
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.001643116042353804
Epoch-15 lr: 0.001643116042353804
epoch 15 training time: 14.953
---------------
2023-09-11 14:26:17.873815
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03731	Per Sample Data Time 0.02919	Per Sample DNN Time 0.00812	Train Loss 0.0658	
start validation
acc: 0.834123
AUC: 0.945537
Avg Precision: 0.379971
Avg Recall: 1.000000
d_prime: 2.267037
train_loss: 0.041943
valid_loss: 1.006114
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.001643116042353804
Epoch-16 lr: 0.001643116042353804
epoch 16 training time: 15.170
---------------
2023-09-11 14:26:33.043341
current #epochs=17, #steps=640
start validation
acc: 0.838863
AUC: 0.940358
Avg Precision: 0.357269
Avg Recall: 1.000000
d_prime: 2.203040
train_loss: 0.040213
valid_loss: 0.996521
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.001643116042353804
Epoch-17 lr: 0.001643116042353804
epoch 17 training time: 14.992
---------------
2023-09-11 14:26:48.035856
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00566	Train Loss 0.0402	
start validation
acc: 0.815166
AUC: 0.943975
Avg Precision: 0.401523
Avg Recall: 1.000000
d_prime: 2.247249
train_loss: 0.039978
valid_loss: 0.988004
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001643116042353804
Epoch-18 lr: 0.001643116042353804
epoch 18 training time: 18.199
---------------
2023-09-11 14:27:06.234306
current #epochs=19, #steps=720
start validation
acc: 0.800948
AUC: 0.937346
Avg Precision: 0.359095
Avg Recall: 1.000000
d_prime: 2.167808
train_loss: 0.038104
valid_loss: 0.971926
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.001643116042353804
Epoch-19 lr: 0.001643116042353804
epoch 19 training time: 14.924
---------------
2023-09-11 14:27:21.158199
current #epochs=20, #steps=760
start validation
acc: 0.824645
AUC: 0.946711
Avg Precision: 0.359585
Avg Recall: 1.000000
d_prime: 2.282205
train_loss: 0.045044
valid_loss: 0.983926
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.001643116042353804
Epoch-20 lr: 0.001643116042353804
epoch 20 training time: 15.054
---------------
2023-09-11 14:27:36.212593
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03832	Per Sample Data Time 0.02868	Per Sample DNN Time 0.00964	Train Loss 0.0250	
start validation
acc: 0.819905
AUC: 0.951811
Avg Precision: 0.383913
Avg Recall: 1.000000
d_prime: 2.351368
train_loss: 0.030200
valid_loss: 0.993147
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.001643116042353804
Epoch-21 lr: 0.001643116042353804
epoch 21 training time: 15.037
---------------
2023-09-11 14:27:51.249603
current #epochs=22, #steps=840
start validation
acc: 0.829384
AUC: 0.941023
Avg Precision: 0.356570
Avg Recall: 1.000000
d_prime: 2.211003
train_loss: 0.035063
valid_loss: 0.984399
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0012079819511826395
Epoch-22 lr: 0.0012079819511826395
epoch 22 training time: 15.062
---------------
2023-09-11 14:28:06.311430
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00555	Train Loss 0.0317	
start validation
acc: 0.805687
AUC: 0.938634
Avg Precision: 0.364480
Avg Recall: 1.000000
d_prime: 2.182708
train_loss: 0.030722
valid_loss: 1.006194
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0012079819511826395
Epoch-23 lr: 0.0012079819511826395
epoch 23 training time: 16.259
---------------
2023-09-11 14:28:22.570212
current #epochs=24, #steps=920
start validation
acc: 0.829384
AUC: 0.939404
Avg Precision: 0.350724
Avg Recall: 1.000000
d_prime: 2.191737
train_loss: 0.049851
valid_loss: 0.987449
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0012079819511826395
Epoch-24 lr: 0.0012079819511826395
epoch 24 training time: 15.116
---------------
2023-09-11 14:28:37.686559
current #epochs=25, #steps=960
start validation
acc: 0.824645
AUC: 0.942483
Avg Precision: 0.369072
Avg Recall: 1.000000
d_prime: 2.228744
train_loss: 0.043276
valid_loss: 1.001969
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0012079819511826395
Epoch-25 lr: 0.0012079819511826395
epoch 25 training time: 15.708
---------------
2023-09-11 14:28:53.395087
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03533	Per Sample Data Time 0.02846	Per Sample DNN Time 0.00687	Train Loss 0.0269	
start validation
acc: 0.815166
AUC: 0.931473
Avg Precision: 0.344106
Avg Recall: 1.000000
d_prime: 2.102723
train_loss: 0.036085
valid_loss: 1.019326
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0012079819511826395
Epoch-26 lr: 0.0012079819511826395
epoch 26 training time: 14.992
---------------
2023-09-11 14:29:08.387162
current #epochs=27, #steps=1040
start validation
acc: 0.829384
AUC: 0.938749
Avg Precision: 0.351644
Avg Recall: 1.000000
d_prime: 2.184052
train_loss: 0.035321
valid_loss: 1.000260
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0012079819511826395
Epoch-27 lr: 0.0012079819511826395
epoch 27 training time: 15.021
---------------
2023-09-11 14:29:23.408220
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00561	Train Loss 0.0303	
start validation
acc: 0.819905
AUC: 0.933459
Avg Precision: 0.347514
Avg Recall: 1.000000
d_prime: 2.124228
train_loss: 0.028604
valid_loss: 1.019237
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0012079819511826395
Epoch-28 lr: 0.0012079819511826395
epoch 28 training time: 15.204
---------------
2023-09-11 14:29:38.612244
current #epochs=29, #steps=1120
start validation
acc: 0.815166
AUC: 0.937624
Avg Precision: 0.370730
Avg Recall: 1.000000
d_prime: 2.171005
train_loss: 0.030905
valid_loss: 1.011872
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0012079819511826395
Epoch-29 lr: 0.0012079819511826395
epoch 29 training time: 15.148
---------------
2023-09-11 14:29:53.760457
current #epochs=30, #steps=1160
start validation
acc: 0.824645
AUC: 0.928875
Avg Precision: 0.354923
Avg Recall: 1.000000
d_prime: 2.075305
train_loss: 0.033755
valid_loss: 0.986202
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0012079819511826395
Epoch-30 lr: 0.0012079819511826395
epoch 30 training time: 15.134
---------------
2023-09-11 14:30:08.894873
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03700	Per Sample Data Time 0.02919	Per Sample DNN Time 0.00781	Train Loss 0.0018	
start validation
acc: 0.829384
AUC: 0.946912
Avg Precision: 0.361713
Avg Recall: 1.000000
d_prime: 2.284836
train_loss: 0.033240
valid_loss: 0.985098
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0008880811560287902
Epoch-31 lr: 0.0008880811560287902
epoch 31 training time: 15.121
---------------
2023-09-11 14:30:24.015441
current #epochs=32, #steps=1240
start validation
acc: 0.834123
AUC: 0.953232
Avg Precision: 0.386525
Avg Recall: 1.000000
d_prime: 2.371677
train_loss: 0.039160
valid_loss: 0.975709
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0008880811560287902
Epoch-32 lr: 0.0008880811560287902
epoch 32 training time: 14.931
---------------
2023-09-11 14:30:38.946062
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00560	Train Loss 0.0298	
start validation
acc: 0.843602
AUC: 0.955743
Avg Precision: 0.401900
Avg Recall: 1.000000
d_prime: 2.408822
train_loss: 0.032678
valid_loss: 0.974179
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0008880811560287902
Epoch-33 lr: 0.0008880811560287902
epoch 33 training time: 15.060
---------------
2023-09-11 14:30:54.006237
current #epochs=34, #steps=1320
start validation
acc: 0.829384
AUC: 0.943073
Avg Precision: 0.376568
Avg Recall: 1.000000
d_prime: 2.236022
train_loss: 0.036653
valid_loss: 0.991476
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0008880811560287902
Epoch-34 lr: 0.0008880811560287902
epoch 34 training time: 15.040
---------------
2023-09-11 14:31:09.045633
current #epochs=35, #steps=1360
start validation
acc: 0.829384
AUC: 0.942715
Avg Precision: 0.372233
Avg Recall: 1.000000
d_prime: 2.231599
train_loss: 0.036540
valid_loss: 0.992912
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0008880811560287902
Epoch-35 lr: 0.0008880811560287902
epoch 35 training time: 14.969
---------------
2023-09-11 14:31:24.014752
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03899	Per Sample Data Time 0.02896	Per Sample DNN Time 0.01002	Train Loss 0.0350	
start validation
acc: 0.810427
AUC: 0.947551
Avg Precision: 0.380995
Avg Recall: 1.000000
d_prime: 2.293232
train_loss: 0.025498
valid_loss: 0.984738
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0008880811560287902
Epoch-36 lr: 0.0008880811560287902
epoch 36 training time: 15.041
---------------
2023-09-11 14:31:39.055542
current #epochs=37, #steps=1440
start validation
acc: 0.815166
AUC: 0.940637
Avg Precision: 0.377129
Avg Recall: 1.000000
d_prime: 2.206370
train_loss: 0.032805
valid_loss: 1.003531
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0008880811560287902
Epoch-37 lr: 0.0008880811560287902
epoch 37 training time: 15.258
---------------
2023-09-11 14:31:54.313959
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00564	Train Loss 0.0385	
start validation
acc: 0.810427
AUC: 0.939640
Avg Precision: 0.367182
Avg Recall: 1.000000
d_prime: 2.194517
train_loss: 0.035015
valid_loss: 1.004061
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0008880811560287902
Epoch-38 lr: 0.0008880811560287902
epoch 38 training time: 15.045
---------------
2023-09-11 14:32:09.358882
current #epochs=39, #steps=1520
start validation
acc: 0.805687
AUC: 0.935728
Avg Precision: 0.369090
Avg Recall: 1.000000
d_prime: 2.149415
train_loss: 0.033282
valid_loss: 1.005078
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0008880811560287902
Epoch-39 lr: 0.0008880811560287902
epoch 39 training time: 15.091
---------------
2023-09-11 14:32:24.449934
current #epochs=40, #steps=1560
start validation
acc: 0.824645
AUC: 0.943891
Avg Precision: 0.377073
Avg Recall: 1.000000
d_prime: 2.246199
train_loss: 0.038646
valid_loss: 0.977272
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0006528972878454768
Epoch-40 lr: 0.0006528972878454768
epoch 40 training time: 15.156
---------------
2023-09-11 14:32:39.605690
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03566	Per Sample Data Time 0.02792	Per Sample DNN Time 0.00774	Train Loss 0.0581	
start validation
acc: 0.810427
AUC: 0.940748
Avg Precision: 0.353663
Avg Recall: 1.000000
d_prime: 2.207702
train_loss: 0.034434
valid_loss: 0.978954
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0006528972878454768
Epoch-41 lr: 0.0006528972878454768
epoch 41 training time: 15.013
---------------
2023-09-11 14:32:54.618600
current #epochs=42, #steps=1640
start validation
acc: 0.805687
AUC: 0.937470
Avg Precision: 0.362986
Avg Recall: 1.000000
d_prime: 2.169230
train_loss: 0.025088
valid_loss: 0.995327
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0006528972878454768
Epoch-42 lr: 0.0006528972878454768
epoch 42 training time: 15.140
---------------
2023-09-11 14:33:09.758278
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00562	Train Loss 0.0167	
start validation
acc: 0.819905
AUC: 0.940525
Avg Precision: 0.381800
Avg Recall: 1.000000
d_prime: 2.205041
train_loss: 0.020311
valid_loss: 0.974006
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0006528972878454768
Epoch-43 lr: 0.0006528972878454768
epoch 43 training time: 15.062
---------------
2023-09-11 14:33:24.819739
current #epochs=44, #steps=1720
start validation
acc: 0.815166
AUC: 0.941104
Avg Precision: 0.382585
Avg Recall: 1.000000
d_prime: 2.211980
train_loss: 0.039253
valid_loss: 0.979131
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0006528972878454768
Epoch-44 lr: 0.0006528972878454768
epoch 44 training time: 15.001
---------------
2023-09-11 14:33:39.820777
current #epochs=45, #steps=1760
start validation
[I 2023-09-11 14:33:54,930] Trial 50 finished with value: 0.8815165876777251 and parameters: {'warmup': 'False', 'num_epochs': 45, 'batch_size': 58, 'lr-adaptschedule': 'True', 'lr': 0.0030400716311932458, 'head-lr': 1, 'lr-scheduler-start': 4, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.7351775042328573}. Best is trial 50 with value: 0.8815165876777251.
acc: 0.819905
AUC: 0.935455
Avg Precision: 0.365313
Avg Recall: 1.000000
d_prime: 2.146356
train_loss: 0.032778
valid_loss: 0.986969
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0006528972878454768
Epoch-45 lr: 0.0006528972878454768
epoch 45 training time: 15.099
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f85b4070a30>
The learning rate scheduler starts at 4 epoch with decay rate of 0.739 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 14:33:54.967768
current #epochs=1, #steps=0
start validation
acc: 0.796209
AUC: 0.925619
Avg Precision: 0.322814
Avg Recall: 1.000000
d_prime: 2.042005
train_loss: 0.058164
valid_loss: 1.007105
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002728976004699452
Epoch-1 lr: 0.002728976004699452
epoch 1 training time: 17.222
---------------
2023-09-11 14:34:12.190569
current #epochs=2, #steps=40
start validation
acc: 0.829384
AUC: 0.921107
Avg Precision: 0.345457
Avg Recall: 1.000000
d_prime: 1.997658
train_loss: 0.066027
valid_loss: 1.003150
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002728976004699452
Epoch-2 lr: 0.002728976004699452
epoch 2 training time: 18.146
---------------
2023-09-11 14:34:30.336449
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00569	Train Loss 0.0703	
start validation
acc: 0.810427
AUC: 0.917936
Avg Precision: 0.348688
Avg Recall: 1.000000
d_prime: 1.967623
train_loss: 0.072859
valid_loss: 1.012280
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002728976004699452
Epoch-3 lr: 0.002728976004699452
epoch 3 training time: 15.175
---------------
2023-09-11 14:34:45.511405
current #epochs=4, #steps=120
start validation
acc: 0.786730
AUC: 0.924897
Avg Precision: 0.327715
Avg Recall: 1.000000
d_prime: 2.034780
train_loss: 0.043103
valid_loss: 1.014161
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0020160753982918934
Epoch-4 lr: 0.0020160753982918934
epoch 4 training time: 15.238
---------------
2023-09-11 14:35:00.749894
current #epochs=5, #steps=160
start validation
acc: 0.777251
AUC: 0.915737
Avg Precision: 0.328805
Avg Recall: 1.000000
d_prime: 1.947306
train_loss: 0.041311
valid_loss: 1.023190
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0020160753982918934
Epoch-5 lr: 0.0020160753982918934
epoch 5 training time: 15.128
---------------
2023-09-11 14:35:15.877526
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03540	Per Sample Data Time 0.02831	Per Sample DNN Time 0.00709	Train Loss 0.0364	
start validation
acc: 0.796209
AUC: 0.920245
Avg Precision: 0.325870
Avg Recall: 1.000000
d_prime: 1.989405
train_loss: 0.045351
valid_loss: 1.006801
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0020160753982918934
Epoch-6 lr: 0.0020160753982918934
epoch 6 training time: 15.039
---------------
2023-09-11 14:35:30.916971
current #epochs=7, #steps=240
start validation
acc: 0.796209
AUC: 0.923431
Avg Precision: 0.338228
Avg Recall: 1.000000
d_prime: 2.020256
train_loss: 0.050949
valid_loss: 1.014101
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0020160753982918934
Epoch-7 lr: 0.0020160753982918934
epoch 7 training time: 15.120
---------------
2023-09-11 14:35:46.037151
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00570	Train Loss 0.0424	
start validation
acc: 0.815166
AUC: 0.942718
Avg Precision: 0.360029
Avg Recall: 1.000000
d_prime: 2.231640
train_loss: 0.039324
valid_loss: 0.978234
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0020160753982918934
Epoch-8 lr: 0.0020160753982918934
epoch 8 training time: 15.643
---------------
2023-09-11 14:36:01.679944
current #epochs=9, #steps=320
start validation
acc: 0.796209
AUC: 0.928664
Avg Precision: 0.336827
Avg Recall: 1.000000
d_prime: 2.073110
train_loss: 0.053990
valid_loss: 1.014446
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0020160753982918934
Epoch-9 lr: 0.0020160753982918934
epoch 9 training time: 15.056
---------------
2023-09-11 14:36:16.736320
current #epochs=10, #steps=360
start validation
acc: 0.791469
AUC: 0.923228
Avg Precision: 0.322274
Avg Recall: 1.000000
d_prime: 2.018254
train_loss: 0.038002
valid_loss: 1.017583
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0020160753982918934
Epoch-10 lr: 0.0020160753982918934
epoch 10 training time: 14.960
---------------
2023-09-11 14:36:31.696524
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03938	Per Sample Data Time 0.02884	Per Sample DNN Time 0.01054	Train Loss 0.0391	
start validation
acc: 0.800948
AUC: 0.914082
Avg Precision: 0.351529
Avg Recall: 1.000000
d_prime: 1.932279
train_loss: 0.046324
valid_loss: 1.017424
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0020160753982918934
Epoch-11 lr: 0.0020160753982918934
epoch 11 training time: 15.927
---------------
2023-09-11 14:36:47.624032
current #epochs=12, #steps=440
start validation
acc: 0.800948
AUC: 0.920276
Avg Precision: 0.334536
Avg Recall: 1.000000
d_prime: 1.989696
train_loss: 0.032306
valid_loss: 1.034232
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0020160753982918934
Epoch-12 lr: 0.0020160753982918934
epoch 12 training time: 15.475
---------------
2023-09-11 14:37:03.099114
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00558	Train Loss 0.0359	
start validation
acc: 0.815166
AUC: 0.917437
Avg Precision: 0.330922
Avg Recall: 1.000000
d_prime: 1.962984
train_loss: 0.038900
valid_loss: 1.021839
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.001489408483108101
Epoch-13 lr: 0.001489408483108101
epoch 13 training time: 15.028
---------------
2023-09-11 14:37:18.127021
current #epochs=14, #steps=520
start validation
acc: 0.824645
AUC: 0.917708
Avg Precision: 0.317414
Avg Recall: 1.000000
d_prime: 1.965503
train_loss: 0.033590
valid_loss: 1.021195
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.001489408483108101
Epoch-14 lr: 0.001489408483108101
epoch 14 training time: 15.122
---------------
2023-09-11 14:37:33.249046
current #epochs=15, #steps=560
start validation
acc: 0.819905
AUC: 0.913038
Avg Precision: 0.328280
Avg Recall: 1.000000
d_prime: 1.922910
train_loss: 0.042777
valid_loss: 1.028509
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.001489408483108101
Epoch-15 lr: 0.001489408483108101
epoch 15 training time: 15.121
---------------
2023-09-11 14:37:48.370319
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03647	Per Sample Data Time 0.03002	Per Sample DNN Time 0.00645	Train Loss 0.0164	
start validation
acc: 0.819905
AUC: 0.927459
Avg Precision: 0.336737
Avg Recall: 1.000000
d_prime: 2.060689
train_loss: 0.035676
valid_loss: 1.003339
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.001489408483108101
Epoch-16 lr: 0.001489408483108101
epoch 16 training time: 14.992
---------------
2023-09-11 14:38:03.362029
current #epochs=17, #steps=640
start validation
acc: 0.810427
AUC: 0.918938
Avg Precision: 0.330804
Avg Recall: 1.000000
d_prime: 1.977021
train_loss: 0.053629
valid_loss: 1.009501
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.001489408483108101
Epoch-17 lr: 0.001489408483108101
epoch 17 training time: 15.140
---------------
2023-09-11 14:38:18.502548
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00562	Train Loss 0.0476	
start validation
acc: 0.834123
AUC: 0.918594
Avg Precision: 0.322405
Avg Recall: 1.000000
d_prime: 1.973789
train_loss: 0.045848
valid_loss: 1.005113
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001489408483108101
Epoch-18 lr: 0.001489408483108101
epoch 18 training time: 17.088
---------------
2023-09-11 14:38:35.590677
current #epochs=19, #steps=720
start validation
acc: 0.838863
AUC: 0.922699
Avg Precision: 0.313979
Avg Recall: 1.000000
d_prime: 2.013080
train_loss: 0.033748
valid_loss: 1.022203
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.001489408483108101
Epoch-19 lr: 0.001489408483108101
epoch 19 training time: 17.057
---------------
2023-09-11 14:38:52.647272
current #epochs=20, #steps=760
start validation
acc: 0.815166
AUC: 0.931885
Avg Precision: 0.347916
Avg Recall: 1.000000
d_prime: 2.107143
train_loss: 0.030094
valid_loss: 1.001441
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.001489408483108101
Epoch-20 lr: 0.001489408483108101
epoch 20 training time: 15.129
---------------
2023-09-11 14:39:07.775781
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03935	Per Sample Data Time 0.03020	Per Sample DNN Time 0.00915	Train Loss 0.0211	
start validation
acc: 0.824645
AUC: 0.930810
Avg Precision: 0.349091
Avg Recall: 1.000000
d_prime: 2.095654
train_loss: 0.037990
valid_loss: 1.009777
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.001489408483108101
Epoch-21 lr: 0.001489408483108101
epoch 21 training time: 15.142
---------------
2023-09-11 14:39:22.918103
current #epochs=22, #steps=840
start validation
acc: 0.819905
AUC: 0.935255
Avg Precision: 0.346196
Avg Recall: 1.000000
d_prime: 2.144107
train_loss: 0.042015
valid_loss: 1.003535
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0011003247355896742
Epoch-22 lr: 0.0011003247355896742
epoch 22 training time: 15.184
---------------
2023-09-11 14:39:38.101981
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00560	Train Loss 0.0409	
start validation
acc: 0.819905
AUC: 0.924346
Avg Precision: 0.358139
Avg Recall: 1.000000
d_prime: 2.029297
train_loss: 0.043554
valid_loss: 1.009406
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0011003247355896742
Epoch-23 lr: 0.0011003247355896742
epoch 23 training time: 16.311
---------------
2023-09-11 14:39:54.412864
current #epochs=24, #steps=920
start validation
acc: 0.805687
AUC: 0.924396
Avg Precision: 0.358080
Avg Recall: 1.000000
d_prime: 2.029791
train_loss: 0.045321
valid_loss: 1.010855
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0011003247355896742
Epoch-24 lr: 0.0011003247355896742
epoch 24 training time: 15.131
---------------
2023-09-11 14:40:09.544034
current #epochs=25, #steps=960
start validation
acc: 0.815166
AUC: 0.924455
Avg Precision: 0.338861
Avg Recall: 1.000000
d_prime: 2.030375
train_loss: 0.030045
valid_loss: 1.009588
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0011003247355896742
Epoch-25 lr: 0.0011003247355896742
epoch 25 training time: 15.001
---------------
2023-09-11 14:40:24.545065
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03550	Per Sample Data Time 0.02763	Per Sample DNN Time 0.00787	Train Loss 0.0119	
start validation
acc: 0.796209
AUC: 0.925003
Avg Precision: 0.329880
Avg Recall: 1.000000
d_prime: 2.035834
train_loss: 0.028961
valid_loss: 1.017086
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0011003247355896742
Epoch-26 lr: 0.0011003247355896742
epoch 26 training time: 15.028
---------------
2023-09-11 14:40:39.572976
current #epochs=27, #steps=1040
start validation
acc: 0.786730
AUC: 0.931170
Avg Precision: 0.360769
Avg Recall: 1.000000
d_prime: 2.099483
train_loss: 0.031688
valid_loss: 1.002432
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0011003247355896742
Epoch-27 lr: 0.0011003247355896742
epoch 27 training time: 15.017
---------------
2023-09-11 14:40:54.590092
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00567	Train Loss 0.0362	
start validation
acc: 0.796209
AUC: 0.914897
Avg Precision: 0.340093
Avg Recall: 1.000000
d_prime: 1.939656
train_loss: 0.031953
valid_loss: 1.015271
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0011003247355896742
Epoch-28 lr: 0.0011003247355896742
epoch 28 training time: 15.174
---------------
2023-09-11 14:41:09.764739
current #epochs=29, #steps=1120
start validation
acc: 0.810427
AUC: 0.927223
Avg Precision: 0.356239
Avg Recall: 1.000000
d_prime: 2.058267
train_loss: 0.035940
valid_loss: 1.006289
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0011003247355896742
Epoch-29 lr: 0.0011003247355896742
epoch 29 training time: 15.144
---------------
2023-09-11 14:41:24.908603
current #epochs=30, #steps=1160
start validation
acc: 0.819905
AUC: 0.926954
Avg Precision: 0.347144
Avg Recall: 1.000000
d_prime: 2.055525
train_loss: 0.035909
valid_loss: 1.009102
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0011003247355896742
Epoch-30 lr: 0.0011003247355896742
epoch 30 training time: 15.700
---------------
2023-09-11 14:41:40.608979
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03875	Per Sample Data Time 0.02916	Per Sample DNN Time 0.00959	Train Loss 0.0083	
start validation
acc: 0.819905
AUC: 0.923487
Avg Precision: 0.350094
Avg Recall: 1.000000
d_prime: 2.020802
train_loss: 0.037916
valid_loss: 1.011512
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0008128827903705533
Epoch-31 lr: 0.0008128827903705533
epoch 31 training time: 15.106
---------------
2023-09-11 14:41:55.714819
current #epochs=32, #steps=1240
start validation
acc: 0.815166
AUC: 0.927512
Avg Precision: 0.355261
Avg Recall: 1.000000
d_prime: 2.061231
train_loss: 0.028997
valid_loss: 1.004582
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0008128827903705533
Epoch-32 lr: 0.0008128827903705533
epoch 32 training time: 15.144
---------------
2023-09-11 14:42:10.858906
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00561	Train Loss 0.0226	
start validation
acc: 0.810427
AUC: 0.929089
Avg Precision: 0.358608
Avg Recall: 1.000000
d_prime: 2.077532
train_loss: 0.022967
valid_loss: 1.006163
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0008128827903705533
Epoch-33 lr: 0.0008128827903705533
epoch 33 training time: 15.536
---------------
2023-09-11 14:42:26.395200
current #epochs=34, #steps=1320
start validation
acc: 0.815166
AUC: 0.929019
Avg Precision: 0.357874
Avg Recall: 1.000000
d_prime: 2.076810
train_loss: 0.017390
valid_loss: 1.008582
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0008128827903705533
Epoch-34 lr: 0.0008128827903705533
epoch 34 training time: 15.136
---------------
2023-09-11 14:42:41.531683
current #epochs=35, #steps=1360
start validation
acc: 0.800948
AUC: 0.924084
Avg Precision: 0.361156
Avg Recall: 1.000000
d_prime: 2.026697
train_loss: 0.017991
valid_loss: 1.009464
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0008128827903705533
Epoch-35 lr: 0.0008128827903705533
epoch 35 training time: 15.063
---------------
2023-09-11 14:42:56.594815
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03498	Per Sample Data Time 0.02758	Per Sample DNN Time 0.00740	Train Loss 0.0525	
start validation
acc: 0.815166
AUC: 0.923039
Avg Precision: 0.345717
Avg Recall: 1.000000
d_prime: 2.016404
train_loss: 0.033122
valid_loss: 1.012844
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0008128827903705533
Epoch-36 lr: 0.0008128827903705533
epoch 36 training time: 15.007
---------------
2023-09-11 14:43:11.601745
current #epochs=37, #steps=1440
start validation
acc: 0.819905
AUC: 0.922419
Avg Precision: 0.329891
Avg Recall: 1.000000
d_prime: 2.010352
train_loss: 0.013847
valid_loss: 1.016209
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0008128827903705533
Epoch-37 lr: 0.0008128827903705533
epoch 37 training time: 15.268
---------------
2023-09-11 14:43:26.870327
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00558	Train Loss 0.0453	
start validation
acc: 0.819905
AUC: 0.929693
Avg Precision: 0.359240
Avg Recall: 1.000000
d_prime: 2.083858
train_loss: 0.039473
valid_loss: 0.998284
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0008128827903705533
Epoch-38 lr: 0.0008128827903705533
epoch 38 training time: 15.023
---------------
2023-09-11 14:43:41.892679
current #epochs=39, #steps=1520
start validation
acc: 0.834123
AUC: 0.931619
Avg Precision: 0.357074
Avg Recall: 1.000000
d_prime: 2.104295
train_loss: 0.024492
valid_loss: 1.017256
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0008128827903705533
Epoch-39 lr: 0.0008128827903705533
epoch 39 training time: 15.166
---------------
2023-09-11 14:43:57.059355
current #epochs=40, #steps=1560
start validation
acc: 0.796209
AUC: 0.933376
Avg Precision: 0.362402
Avg Recall: 1.000000
d_prime: 2.123319
train_loss: 0.031860
valid_loss: 1.009377
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0006005303793579626
Epoch-40 lr: 0.0006005303793579626
epoch 40 training time: 15.094
---------------
2023-09-11 14:44:12.152891
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03736	Per Sample Data Time 0.02953	Per Sample DNN Time 0.00783	Train Loss 0.0630	
start validation
acc: 0.810427
AUC: 0.929197
Avg Precision: 0.349496
Avg Recall: 1.000000
d_prime: 2.078660
train_loss: 0.024860
valid_loss: 1.019449
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0006005303793579626
Epoch-41 lr: 0.0006005303793579626
epoch 41 training time: 15.118
---------------
2023-09-11 14:44:27.270762
current #epochs=42, #steps=1640
start validation
acc: 0.824645
AUC: 0.928255
Avg Precision: 0.345371
Avg Recall: 1.000000
d_prime: 2.068872
train_loss: 0.020823
valid_loss: 1.027903
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0006005303793579626
Epoch-42 lr: 0.0006005303793579626
epoch 42 training time: 14.987
---------------
2023-09-11 14:44:42.257631
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00564	Train Loss 0.0258	
start validation
acc: 0.829384
AUC: 0.930016
Avg Precision: 0.353223
Avg Recall: 1.000000
d_prime: 2.087257
train_loss: 0.027968
valid_loss: 1.017216
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0006005303793579626
Epoch-43 lr: 0.0006005303793579626
epoch 43 training time: 16.334
---------------
2023-09-11 14:44:58.592255
current #epochs=44, #steps=1720
start validation
acc: 0.819905
AUC: 0.932585
Avg Precision: 0.349481
Avg Recall: 1.000000
d_prime: 2.114704
train_loss: 0.022432
valid_loss: 1.022329
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0006005303793579626
Epoch-44 lr: 0.0006005303793579626
epoch 44 training time: 15.037
---------------
2023-09-11 14:45:13.629054
current #epochs=45, #steps=1760
start validation
[I 2023-09-11 14:45:28,620] Trial 51 finished with value: 0.8388625592417062 and parameters: {'warmup': 'False', 'num_epochs': 45, 'batch_size': 58, 'lr-adaptschedule': 'True', 'lr': 0.002728976004699452, 'head-lr': 1, 'lr-scheduler-start': 4, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.7387662606120746}. Best is trial 50 with value: 0.8815165876777251.
acc: 0.805687
AUC: 0.930052
Avg Precision: 0.357549
Avg Recall: 1.000000
d_prime: 2.087634
train_loss: 0.016260
valid_loss: 1.019671
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0006005303793579626
Epoch-45 lr: 0.0006005303793579626
epoch 45 training time: 14.980
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f859ea60850>
The learning rate scheduler starts at 5 epoch with decay rate of 0.726 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 14:45:28.656589
current #epochs=1, #steps=0
start validation
acc: 0.786730
AUC: 0.900548
Avg Precision: 0.320163
Avg Recall: 1.000000
d_prime: 1.816814
train_loss: 0.094460
valid_loss: 1.043729
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003072013327594189
Epoch-1 lr: 0.003072013327594189
epoch 1 training time: 18.283
---------------
2023-09-11 14:45:46.940088
current #epochs=2, #steps=40
start validation
acc: 0.834123
AUC: 0.927242
Avg Precision: 0.323428
Avg Recall: 1.000000
d_prime: 2.058466
train_loss: 0.073811
valid_loss: 1.006327
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003072013327594189
Epoch-2 lr: 0.003072013327594189
epoch 2 training time: 17.172
---------------
2023-09-11 14:46:04.112212
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00559	Train Loss 0.0670	
start validation
acc: 0.796209
AUC: 0.912817
Avg Precision: 0.334660
Avg Recall: 1.000000
d_prime: 1.920937
train_loss: 0.058468
valid_loss: 1.036320
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003072013327594189
Epoch-3 lr: 0.003072013327594189
epoch 3 training time: 15.948
---------------
2023-09-11 14:46:20.060375
current #epochs=4, #steps=120
start validation
acc: 0.800948
AUC: 0.917057
Avg Precision: 0.329691
Avg Recall: 1.000000
d_prime: 1.959458
train_loss: 0.060720
valid_loss: 1.020584
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003072013327594189
Epoch-4 lr: 0.003072013327594189
epoch 4 training time: 14.983
---------------
2023-09-11 14:46:35.043720
current #epochs=5, #steps=160
start validation
acc: 0.805687
AUC: 0.915812
Avg Precision: 0.336477
Avg Recall: 1.000000
d_prime: 1.947996
train_loss: 0.062691
valid_loss: 1.023258
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0022312135695398113
Epoch-5 lr: 0.0022312135695398113
epoch 5 training time: 15.745
---------------
2023-09-11 14:46:50.788950
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03928	Per Sample Data Time 0.02848	Per Sample DNN Time 0.01080	Train Loss 0.0385	
start validation
acc: 0.829384
AUC: 0.924332
Avg Precision: 0.313912
Avg Recall: 1.000000
d_prime: 2.029158
train_loss: 0.060542
valid_loss: 0.998680
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0022312135695398113
Epoch-6 lr: 0.0022312135695398113
epoch 6 training time: 16.003
---------------
2023-09-11 14:47:06.792197
current #epochs=7, #steps=240
start validation
acc: 0.838863
AUC: 0.933523
Avg Precision: 0.353105
Avg Recall: 1.000000
d_prime: 2.124938
train_loss: 0.053063
valid_loss: 0.998693
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0022312135695398113
Epoch-7 lr: 0.0022312135695398113
epoch 7 training time: 17.637
---------------
2023-09-11 14:47:24.428813
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00566	Train Loss 0.0293	
start validation
acc: 0.848341
AUC: 0.924174
Avg Precision: 0.337951
Avg Recall: 1.000000
d_prime: 2.027588
train_loss: 0.029024
valid_loss: 1.006481
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0022312135695398113
Epoch-8 lr: 0.0022312135695398113
epoch 8 training time: 17.119
---------------
2023-09-11 14:47:41.547451
current #epochs=9, #steps=320
start validation
acc: 0.838863
AUC: 0.927070
Avg Precision: 0.332742
Avg Recall: 1.000000
d_prime: 2.056705
train_loss: 0.041044
valid_loss: 1.014851
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0022312135695398113
Epoch-9 lr: 0.0022312135695398113
epoch 9 training time: 15.755
---------------
2023-09-11 14:47:57.302786
current #epochs=10, #steps=360
start validation
acc: 0.853081
AUC: 0.929804
Avg Precision: 0.351840
Avg Recall: 1.000000
d_prime: 2.085019
train_loss: 0.036712
valid_loss: 1.014069
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0022312135695398113
Epoch-10 lr: 0.0022312135695398113
epoch 10 training time: 16.987
---------------
2023-09-11 14:48:14.289572
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03912	Per Sample Data Time 0.02896	Per Sample DNN Time 0.01016	Train Loss 0.0178	
start validation
acc: 0.843602
AUC: 0.922675
Avg Precision: 0.327128
Avg Recall: 1.000000
d_prime: 2.012844
train_loss: 0.053969
valid_loss: 0.993592
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0022312135695398113
Epoch-11 lr: 0.0022312135695398113
epoch 11 training time: 15.325
---------------
2023-09-11 14:48:29.614019
current #epochs=12, #steps=440
start validation
acc: 0.810427
AUC: 0.921959
Avg Precision: 0.322138
Avg Recall: 1.000000
d_prime: 2.005878
train_loss: 0.035346
valid_loss: 1.000547
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0022312135695398113
Epoch-12 lr: 0.0022312135695398113
epoch 12 training time: 15.059
---------------
2023-09-11 14:48:44.672931
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00568	Train Loss 0.0420	
start validation
acc: 0.805687
AUC: 0.925821
Avg Precision: 0.315490
Avg Recall: 1.000000
d_prime: 2.044038
train_loss: 0.050512
valid_loss: 0.986515
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0022312135695398113
Epoch-13 lr: 0.0022312135695398113
epoch 13 training time: 15.875
---------------
2023-09-11 14:49:00.547509
current #epochs=14, #steps=520
start validation
acc: 0.857820
AUC: 0.925446
Avg Precision: 0.308264
Avg Recall: 1.000000
d_prime: 2.040273
train_loss: 0.051698
valid_loss: 0.989281
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.001620537889006261
Epoch-14 lr: 0.001620537889006261
epoch 14 training time: 16.920
---------------
2023-09-11 14:49:17.467451
current #epochs=15, #steps=560
start validation
acc: 0.824645
AUC: 0.930007
Avg Precision: 0.357073
Avg Recall: 1.000000
d_prime: 2.087161
train_loss: 0.041711
valid_loss: 1.000416
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.001620537889006261
Epoch-15 lr: 0.001620537889006261
epoch 15 training time: 15.796
---------------
2023-09-11 14:49:33.263451
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03899	Per Sample Data Time 0.02975	Per Sample DNN Time 0.00924	Train Loss 0.0367	
start validation
acc: 0.824645
AUC: 0.935771
Avg Precision: 0.348975
Avg Recall: 1.000000
d_prime: 2.149902
train_loss: 0.046727
valid_loss: 0.989998
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.001620537889006261
Epoch-16 lr: 0.001620537889006261
epoch 16 training time: 15.372
---------------
2023-09-11 14:49:48.635397
current #epochs=17, #steps=640
start validation
acc: 0.805687
AUC: 0.937136
Avg Precision: 0.361826
Avg Recall: 1.000000
d_prime: 2.165393
train_loss: 0.047651
valid_loss: 0.993253
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.001620537889006261
Epoch-17 lr: 0.001620537889006261
epoch 17 training time: 15.181
---------------
2023-09-11 14:50:03.816333
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00559	Train Loss 0.0489	
start validation
acc: 0.800948
AUC: 0.930325
Avg Precision: 0.350119
Avg Recall: 1.000000
d_prime: 2.090514
train_loss: 0.052416
valid_loss: 0.995322
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001620537889006261
Epoch-18 lr: 0.001620537889006261
epoch 18 training time: 15.385
---------------
2023-09-11 14:50:19.201324
current #epochs=19, #steps=720
start validation
acc: 0.810427
AUC: 0.930122
Avg Precision: 0.367322
Avg Recall: 1.000000
d_prime: 2.088368
train_loss: 0.035354
valid_loss: 1.002775
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.001620537889006261
Epoch-19 lr: 0.001620537889006261
epoch 19 training time: 15.034
---------------
2023-09-11 14:50:34.235310
current #epochs=20, #steps=760
start validation
acc: 0.819905
AUC: 0.930243
Avg Precision: 0.362838
Avg Recall: 1.000000
d_prime: 2.089649
train_loss: 0.044387
valid_loss: 0.996128
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.001620537889006261
Epoch-20 lr: 0.001620537889006261
epoch 20 training time: 16.184
---------------
2023-09-11 14:50:50.419053
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03764	Per Sample Data Time 0.02948	Per Sample DNN Time 0.00816	Train Loss 0.0294	
start validation
acc: 0.829384
AUC: 0.924728
Avg Precision: 0.353354
Avg Recall: 1.000000
d_prime: 2.033089
train_loss: 0.024773
valid_loss: 1.016122
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.001620537889006261
Epoch-21 lr: 0.001620537889006261
epoch 21 training time: 16.262
---------------
2023-09-11 14:51:06.680932
current #epochs=22, #steps=840
start validation
acc: 0.791469
AUC: 0.931647
Avg Precision: 0.348925
Avg Recall: 1.000000
d_prime: 2.104590
train_loss: 0.024234
valid_loss: 0.980384
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.001620537889006261
Epoch-22 lr: 0.001620537889006261
epoch 22 training time: 15.140
---------------
2023-09-11 14:51:21.821466
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00560	Train Loss 0.0446	
start validation
acc: 0.819905
AUC: 0.928967
Avg Precision: 0.348679
Avg Recall: 1.000000
d_prime: 2.076262
train_loss: 0.033519
valid_loss: 1.008447
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0011770020967766487
Epoch-23 lr: 0.0011770020967766487
epoch 23 training time: 15.083
---------------
2023-09-11 14:51:36.904621
current #epochs=24, #steps=920
start validation
acc: 0.800948
AUC: 0.935490
Avg Precision: 0.343916
Avg Recall: 1.000000
d_prime: 2.146748
train_loss: 0.034064
valid_loss: 0.999539
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0011770020967766487
Epoch-24 lr: 0.0011770020967766487
epoch 24 training time: 15.075
---------------
2023-09-11 14:51:51.980134
current #epochs=25, #steps=960
start validation
acc: 0.819905
AUC: 0.933815
Avg Precision: 0.334556
Avg Recall: 1.000000
d_prime: 2.128143
train_loss: 0.029220
valid_loss: 1.011448
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0011770020967766487
Epoch-25 lr: 0.0011770020967766487
epoch 25 training time: 16.429
---------------
2023-09-11 14:52:08.408877
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03886	Per Sample Data Time 0.02833	Per Sample DNN Time 0.01054	Train Loss 0.0200	
start validation
acc: 0.805687
AUC: 0.936025
Avg Precision: 0.338855
Avg Recall: 1.000000
d_prime: 2.152766
train_loss: 0.025688
valid_loss: 1.006094
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0011770020967766487
Epoch-26 lr: 0.0011770020967766487
epoch 26 training time: 16.895
---------------
2023-09-11 14:52:25.304384
current #epochs=27, #steps=1040
start validation
acc: 0.824645
AUC: 0.937988
Avg Precision: 0.357412
Avg Recall: 1.000000
d_prime: 2.175208
train_loss: 0.021078
valid_loss: 0.999954
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0011770020967766487
Epoch-27 lr: 0.0011770020967766487
epoch 27 training time: 15.199
---------------
2023-09-11 14:52:40.502772
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00704	Per Sample Data Time 0.00142	Per Sample DNN Time 0.00562	Train Loss 0.0248	
start validation
acc: 0.815166
AUC: 0.934812
Avg Precision: 0.358717
Avg Recall: 1.000000
d_prime: 2.139173
train_loss: 0.028842
valid_loss: 0.997605
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0011770020967766487
Epoch-28 lr: 0.0011770020967766487
epoch 28 training time: 14.842
---------------
2023-09-11 14:52:55.344900
current #epochs=29, #steps=1120
start validation
acc: 0.824645
AUC: 0.934902
Avg Precision: 0.332950
Avg Recall: 1.000000
d_prime: 2.140175
train_loss: 0.026507
valid_loss: 0.985464
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0011770020967766487
Epoch-29 lr: 0.0011770020967766487
epoch 29 training time: 15.085
---------------
2023-09-11 14:53:10.429748
current #epochs=30, #steps=1160
start validation
acc: 0.819905
AUC: 0.934619
Avg Precision: 0.359964
Avg Recall: 1.000000
d_prime: 2.137020
train_loss: 0.022497
valid_loss: 1.010451
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0011770020967766487
Epoch-30 lr: 0.0011770020967766487
epoch 30 training time: 15.066
---------------
2023-09-11 14:53:25.495307
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03609	Per Sample Data Time 0.02907	Per Sample DNN Time 0.00701	Train Loss 0.1557	
start validation
acc: 0.810427
AUC: 0.931007
Avg Precision: 0.339020
Avg Recall: 1.000000
d_prime: 2.097748
train_loss: 0.041567
valid_loss: 1.005839
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0011770020967766487
Epoch-31 lr: 0.0011770020967766487
epoch 31 training time: 14.988
---------------
2023-09-11 14:53:40.484010
current #epochs=32, #steps=1240
start validation
acc: 0.805687
AUC: 0.930083
Avg Precision: 0.354283
Avg Recall: 1.000000
d_prime: 2.087962
train_loss: 0.037664
valid_loss: 1.003465
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0008548605652572157
Epoch-32 lr: 0.0008548605652572157
epoch 32 training time: 14.927
---------------
2023-09-11 14:53:55.410183
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00563	Train Loss 0.0278	
start validation
acc: 0.800948
AUC: 0.927782
Avg Precision: 0.353512
Avg Recall: 1.000000
d_prime: 2.063997
train_loss: 0.024267
valid_loss: 1.011393
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0008548605652572157
Epoch-33 lr: 0.0008548605652572157
epoch 33 training time: 16.891
---------------
2023-09-11 14:54:12.301375
current #epochs=34, #steps=1320
start validation
acc: 0.791469
AUC: 0.932365
Avg Precision: 0.359523
Avg Recall: 1.000000
d_prime: 2.112327
train_loss: 0.028062
valid_loss: 0.999306
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0008548605652572157
Epoch-34 lr: 0.0008548605652572157
epoch 34 training time: 15.019
---------------
2023-09-11 14:54:27.320821
current #epochs=35, #steps=1360
start validation
acc: 0.819905
AUC: 0.932124
Avg Precision: 0.377040
Avg Recall: 1.000000
d_prime: 2.109722
train_loss: 0.020554
valid_loss: 1.010568
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0008548605652572157
Epoch-35 lr: 0.0008548605652572157
epoch 35 training time: 15.640
---------------
2023-09-11 14:54:42.960907
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03762	Per Sample Data Time 0.03042	Per Sample DNN Time 0.00720	Train Loss 0.0011	
start validation
acc: 0.800948
AUC: 0.933423
Avg Precision: 0.379144
Avg Recall: 1.000000
d_prime: 2.123839
train_loss: 0.027762
valid_loss: 0.991998
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0008548605652572157
Epoch-36 lr: 0.0008548605652572157
epoch 36 training time: 15.193
---------------
2023-09-11 14:54:58.154218
current #epochs=37, #steps=1440
start validation
acc: 0.819905
AUC: 0.927162
Avg Precision: 0.357550
Avg Recall: 1.000000
d_prime: 2.057643
train_loss: 0.035514
valid_loss: 0.995778
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0008548605652572157
Epoch-37 lr: 0.0008548605652572157
epoch 37 training time: 15.003
---------------
2023-09-11 14:55:13.157732
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00559	Train Loss 0.0299	
start validation
acc: 0.819905
AUC: 0.928323
Avg Precision: 0.343613
Avg Recall: 1.000000
d_prime: 2.069584
train_loss: 0.040357
valid_loss: 1.016800
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0008548605652572157
Epoch-38 lr: 0.0008548605652572157
epoch 38 training time: 16.191
---------------
2023-09-11 14:55:29.348787
current #epochs=39, #steps=1520
start validation
acc: 0.824645
AUC: 0.928153
Avg Precision: 0.344544
Avg Recall: 1.000000
d_prime: 2.067829
train_loss: 0.042549
valid_loss: 0.989587
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0008548605652572157
Epoch-39 lr: 0.0008548605652572157
epoch 39 training time: 16.474
---------------
2023-09-11 14:55:45.822548
current #epochs=40, #steps=1560
start validation
acc: 0.815166
AUC: 0.926422
Avg Precision: 0.349725
Avg Recall: 1.000000
d_prime: 2.050117
train_loss: 0.033306
valid_loss: 0.997136
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0008548605652572157
Epoch-40 lr: 0.0008548605652572157
epoch 40 training time: 15.143
---------------
2023-09-11 14:56:00.965102
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03863	Per Sample Data Time 0.02921	Per Sample DNN Time 0.00942	Train Loss 0.0233	
start validation
[I 2023-09-11 14:56:16,279] Trial 52 finished with value: 0.8578199052132701 and parameters: {'warmup': 'False', 'num_epochs': 41, 'batch_size': 54, 'lr-adaptschedule': 'True', 'lr': 0.003072013327594189, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.7263033494998409}. Best is trial 50 with value: 0.8815165876777251.
acc: 0.824645
AUC: 0.941663
Avg Precision: 0.381352
Avg Recall: 1.000000
d_prime: 2.218739
train_loss: 0.025546
valid_loss: 0.993319
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0006208880919016431
Epoch-41 lr: 0.0006208880919016431
epoch 41 training time: 15.303
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f85b528b430>
The learning rate scheduler starts at 3 epoch with decay rate of 0.775 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 14:56:16.317145
current #epochs=1, #steps=0
start validation
acc: 0.800948
AUC: 0.937364
Avg Precision: 0.357503
Avg Recall: 1.000000
d_prime: 2.168014
train_loss: 0.083031
valid_loss: 1.021757
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0034758288245907857
Epoch-1 lr: 0.0034758288245907857
epoch 1 training time: 16.926
---------------
2023-09-11 14:56:33.243519
current #epochs=2, #steps=40
start validation
acc: 0.810427
AUC: 0.942388
Avg Precision: 0.362836
Avg Recall: 1.000000
d_prime: 2.227584
train_loss: 0.067606
valid_loss: 0.994285
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0034758288245907857
Epoch-2 lr: 0.0034758288245907857
epoch 2 training time: 17.162
---------------
2023-09-11 14:56:50.405237
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00567	Train Loss 0.0547	
start validation
acc: 0.848341
AUC: 0.943569
Avg Precision: 0.326943
Avg Recall: 1.000000
d_prime: 2.242178
train_loss: 0.057343
valid_loss: 0.988297
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0026935220421357487
Epoch-3 lr: 0.0026935220421357487
epoch 3 training time: 17.175
---------------
2023-09-11 14:57:07.580716
current #epochs=4, #steps=120
start validation
acc: 0.819905
AUC: 0.937988
Avg Precision: 0.321035
Avg Recall: 1.000000
d_prime: 2.175207
train_loss: 0.072613
valid_loss: 0.980748
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0026935220421357487
Epoch-4 lr: 0.0026935220421357487
epoch 4 training time: 15.133
---------------
2023-09-11 14:57:22.713692
current #epochs=5, #steps=160
start validation
acc: 0.838863
AUC: 0.934071
Avg Precision: 0.329143
Avg Recall: 1.000000
d_prime: 2.130960
train_loss: 0.048880
valid_loss: 0.986683
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0026935220421357487
Epoch-5 lr: 0.0026935220421357487
epoch 5 training time: 15.127
---------------
2023-09-11 14:57:37.840401
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03852	Per Sample Data Time 0.02804	Per Sample DNN Time 0.01048	Train Loss 0.0091	
start validation
acc: 0.829384
AUC: 0.932378
Avg Precision: 0.342784
Avg Recall: 1.000000
d_prime: 2.112465
train_loss: 0.049584
valid_loss: 0.992915
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0026935220421357487
Epoch-6 lr: 0.0026935220421357487
epoch 6 training time: 15.083
---------------
2023-09-11 14:57:52.923969
current #epochs=7, #steps=240
start validation
acc: 0.838863
AUC: 0.942305
Avg Precision: 0.351935
Avg Recall: 1.000000
d_prime: 2.226567
train_loss: 0.051273
valid_loss: 0.998870
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0026935220421357487
Epoch-7 lr: 0.0026935220421357487
epoch 7 training time: 15.061
---------------
2023-09-11 14:58:07.985010
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00565	Train Loss 0.0869	
start validation
acc: 0.829384
AUC: 0.928327
Avg Precision: 0.322148
Avg Recall: 1.000000
d_prime: 2.069621
train_loss: 0.090737
valid_loss: 1.022583
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0026935220421357487
Epoch-8 lr: 0.0026935220421357487
epoch 8 training time: 15.264
---------------
2023-09-11 14:58:23.248579
current #epochs=9, #steps=320
start validation
acc: 0.829384
AUC: 0.934721
Avg Precision: 0.366243
Avg Recall: 1.000000
d_prime: 2.138155
train_loss: 0.049490
valid_loss: 1.008582
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0026935220421357487
Epoch-9 lr: 0.0026935220421357487
epoch 9 training time: 16.508
---------------
2023-09-11 14:58:39.756853
current #epochs=10, #steps=360
start validation
acc: 0.834123
AUC: 0.939015
Avg Precision: 0.308638
Avg Recall: 1.000000
d_prime: 2.187165
train_loss: 0.067033
valid_loss: 1.014679
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0026935220421357487
Epoch-10 lr: 0.0026935220421357487
epoch 10 training time: 15.114
---------------
2023-09-11 14:58:54.870916
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03638	Per Sample Data Time 0.02853	Per Sample DNN Time 0.00785	Train Loss 0.0224	
start validation
acc: 0.829384
AUC: 0.937205
Avg Precision: 0.352730
Avg Recall: 1.000000
d_prime: 2.166193
train_loss: 0.037184
valid_loss: 0.977381
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0026935220421357487
Epoch-11 lr: 0.0026935220421357487
epoch 11 training time: 15.124
---------------
2023-09-11 14:59:09.994876
current #epochs=12, #steps=440
start validation
acc: 0.791469
AUC: 0.937661
Avg Precision: 0.404090
Avg Recall: 1.000000
d_prime: 2.171427
train_loss: 0.050394
valid_loss: 0.997055
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0026935220421357487
Epoch-12 lr: 0.0026935220421357487
epoch 12 training time: 15.038
---------------
2023-09-11 14:59:25.033034
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00562	Train Loss 0.0547	
start validation
acc: 0.800948
AUC: 0.942074
Avg Precision: 0.362430
Avg Recall: 1.000000
d_prime: 2.223745
train_loss: 0.067714
valid_loss: 0.982536
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0020872894948517156
Epoch-13 lr: 0.0020872894948517156
epoch 13 training time: 15.197
---------------
2023-09-11 14:59:40.229909
current #epochs=14, #steps=520
start validation
acc: 0.853081
AUC: 0.945996
Avg Precision: 0.401778
Avg Recall: 1.000000
d_prime: 2.272937
train_loss: 0.039701
valid_loss: 0.980715
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0020872894948517156
Epoch-14 lr: 0.0020872894948517156
epoch 14 training time: 17.182
---------------
2023-09-11 14:59:57.412347
current #epochs=15, #steps=560
start validation
acc: 0.834123
AUC: 0.948009
Avg Precision: 0.384364
Avg Recall: 1.000000
d_prime: 2.299302
train_loss: 0.037256
valid_loss: 0.970724
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0020872894948517156
Epoch-15 lr: 0.0020872894948517156
epoch 15 training time: 15.164
---------------
2023-09-11 15:00:12.575991
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03603	Per Sample Data Time 0.02803	Per Sample DNN Time 0.00799	Train Loss 0.0570	
start validation
acc: 0.853081
AUC: 0.941320
Avg Precision: 0.369098
Avg Recall: 1.000000
d_prime: 2.214592
train_loss: 0.048303
valid_loss: 0.991727
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0020872894948517156
Epoch-16 lr: 0.0020872894948517156
epoch 16 training time: 16.139
---------------
2023-09-11 15:00:28.715487
current #epochs=17, #steps=640
start validation
acc: 0.796209
AUC: 0.935042
Avg Precision: 0.354083
Avg Recall: 1.000000
d_prime: 2.141733
train_loss: 0.035029
valid_loss: 0.994509
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0020872894948517156
Epoch-17 lr: 0.0020872894948517156
epoch 17 training time: 15.346
---------------
2023-09-11 15:00:44.061139
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00562	Train Loss 0.0372	
start validation
acc: 0.834123
AUC: 0.934838
Avg Precision: 0.366897
Avg Recall: 1.000000
d_prime: 2.139458
train_loss: 0.040685
valid_loss: 0.994181
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0020872894948517156
Epoch-18 lr: 0.0020872894948517156
epoch 18 training time: 17.029
---------------
2023-09-11 15:01:01.090489
current #epochs=19, #steps=720
start validation
acc: 0.810427
AUC: 0.922557
Avg Precision: 0.336408
Avg Recall: 1.000000
d_prime: 2.011695
train_loss: 0.037634
valid_loss: 1.023646
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0020872894948517156
Epoch-19 lr: 0.0020872894948517156
epoch 19 training time: 16.006
---------------
2023-09-11 15:01:17.096824
current #epochs=20, #steps=760
start validation
acc: 0.824645
AUC: 0.920642
Avg Precision: 0.355289
Avg Recall: 1.000000
d_prime: 1.993200
train_loss: 0.044377
valid_loss: 1.006440
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0020872894948517156
Epoch-20 lr: 0.0020872894948517156
epoch 20 training time: 15.319
---------------
2023-09-11 15:01:32.415742
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03874	Per Sample Data Time 0.02844	Per Sample DNN Time 0.01030	Train Loss 0.0344	
start validation
acc: 0.829384
AUC: 0.932726
Avg Precision: 0.365432
Avg Recall: 1.000000
d_prime: 2.116238
train_loss: 0.048192
valid_loss: 0.998035
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0020872894948517156
Epoch-21 lr: 0.0020872894948517156
epoch 21 training time: 15.081
---------------
2023-09-11 15:01:47.496716
current #epochs=22, #steps=840
start validation
acc: 0.810427
AUC: 0.933964
Avg Precision: 0.380528
Avg Recall: 1.000000
d_prime: 2.129784
train_loss: 0.040979
valid_loss: 1.009992
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0020872894948517156
Epoch-22 lr: 0.0020872894948517156
epoch 22 training time: 16.500
---------------
2023-09-11 15:02:03.997069
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00563	Train Loss 0.0288	
start validation
acc: 0.815166
AUC: 0.934490
Avg Precision: 0.383646
Avg Recall: 1.000000
d_prime: 2.135596
train_loss: 0.036271
valid_loss: 0.995121
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0016175020538772916
Epoch-23 lr: 0.0016175020538772916
epoch 23 training time: 15.165
---------------
2023-09-11 15:02:19.161823
current #epochs=24, #steps=920
start validation
acc: 0.805687
AUC: 0.925562
Avg Precision: 0.338189
Avg Recall: 1.000000
d_prime: 2.041433
train_loss: 0.045279
valid_loss: 1.015150
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0016175020538772916
Epoch-24 lr: 0.0016175020538772916
epoch 24 training time: 15.346
---------------
2023-09-11 15:02:34.507765
current #epochs=25, #steps=960
start validation
acc: 0.819905
AUC: 0.931905
Avg Precision: 0.342282
Avg Recall: 1.000000
d_prime: 2.107364
train_loss: 0.043803
valid_loss: 0.992208
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0016175020538772916
Epoch-25 lr: 0.0016175020538772916
epoch 25 training time: 15.056
---------------
2023-09-11 15:02:49.563099
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03572	Per Sample Data Time 0.02762	Per Sample DNN Time 0.00811	Train Loss 0.0549	
start validation
acc: 0.800948
AUC: 0.929124
Avg Precision: 0.370062
Avg Recall: 1.000000
d_prime: 2.077900
train_loss: 0.039959
valid_loss: 0.994747
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0016175020538772916
Epoch-26 lr: 0.0016175020538772916
epoch 26 training time: 15.082
---------------
2023-09-11 15:03:04.644907
current #epochs=27, #steps=1040
start validation
acc: 0.810427
AUC: 0.924698
Avg Precision: 0.352394
Avg Recall: 1.000000
d_prime: 2.032796
train_loss: 0.042546
valid_loss: 1.012341
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0016175020538772916
Epoch-27 lr: 0.0016175020538772916
epoch 27 training time: 15.136
---------------
2023-09-11 15:03:19.780536
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00561	Train Loss 0.0398	
start validation
acc: 0.810427
AUC: 0.918658
Avg Precision: 0.334585
Avg Recall: 1.000000
d_prime: 1.974384
train_loss: 0.037858
valid_loss: 1.019548
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0016175020538772916
Epoch-28 lr: 0.0016175020538772916
epoch 28 training time: 15.163
---------------
2023-09-11 15:03:34.943991
current #epochs=29, #steps=1120
start validation
acc: 0.810427
AUC: 0.924749
Avg Precision: 0.343528
Avg Recall: 1.000000
d_prime: 2.033301
train_loss: 0.038830
valid_loss: 1.002289
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0016175020538772916
Epoch-29 lr: 0.0016175020538772916
epoch 29 training time: 15.041
---------------
2023-09-11 15:03:49.985100
current #epochs=30, #steps=1160
start validation
acc: 0.824645
AUC: 0.930264
Avg Precision: 0.327083
Avg Recall: 1.000000
d_prime: 2.089874
train_loss: 0.033080
valid_loss: 0.985100
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0016175020538772916
Epoch-30 lr: 0.0016175020538772916
epoch 30 training time: 15.532
---------------
2023-09-11 15:04:05.516550
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03849	Per Sample Data Time 0.03018	Per Sample DNN Time 0.00831	Train Loss 0.0206	
start validation
acc: 0.824645
AUC: 0.931070
Avg Precision: 0.346728
Avg Recall: 1.000000
d_prime: 2.098418
train_loss: 0.035150
valid_loss: 0.992426
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0016175020538772916
Epoch-31 lr: 0.0016175020538772916
epoch 31 training time: 16.133
---------------
2023-09-11 15:04:21.649977
current #epochs=32, #steps=1240
start validation
acc: 0.829384
AUC: 0.925082
Avg Precision: 0.335669
Avg Recall: 1.000000
d_prime: 2.036621
train_loss: 0.030708
valid_loss: 0.988270
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0016175020538772916
Epoch-32 lr: 0.0016175020538772916
epoch 32 training time: 15.053
---------------
2023-09-11 15:04:36.702539
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00563	Train Loss 0.0567	
start validation
acc: 0.781991
AUC: 0.926466
Avg Precision: 0.353251
Avg Recall: 1.000000
d_prime: 2.050560
train_loss: 0.048032
valid_loss: 1.017421
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0012534499410601038
Epoch-33 lr: 0.0012534499410601038
epoch 33 training time: 15.555
---------------
2023-09-11 15:04:52.257084
current #epochs=34, #steps=1320
start validation
acc: 0.815166
AUC: 0.926119
Avg Precision: 0.337830
Avg Recall: 1.000000
d_prime: 2.047049
train_loss: 0.028640
valid_loss: 0.988547
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0012534499410601038
Epoch-34 lr: 0.0012534499410601038
epoch 34 training time: 15.209
---------------
2023-09-11 15:05:07.465752
current #epochs=35, #steps=1360
start validation
acc: 0.805687
AUC: 0.927369
Avg Precision: 0.349274
Avg Recall: 1.000000
d_prime: 2.059763
train_loss: 0.044241
valid_loss: 0.991081
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0012534499410601038
Epoch-35 lr: 0.0012534499410601038
epoch 35 training time: 15.169
---------------
2023-09-11 15:05:22.635126
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03753	Per Sample Data Time 0.02840	Per Sample DNN Time 0.00913	Train Loss 0.0174	
start validation
acc: 0.824645
AUC: 0.936056
Avg Precision: 0.375155
Avg Recall: 1.000000
d_prime: 2.153113
train_loss: 0.040511
valid_loss: 0.991903
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0012534499410601038
Epoch-36 lr: 0.0012534499410601038
epoch 36 training time: 15.958
---------------
2023-09-11 15:05:38.592918
current #epochs=37, #steps=1440
start validation
acc: 0.810427
AUC: 0.929712
Avg Precision: 0.349050
Avg Recall: 1.000000
d_prime: 2.084052
train_loss: 0.034788
valid_loss: 0.986331
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0012534499410601038
Epoch-37 lr: 0.0012534499410601038
epoch 37 training time: 15.153
---------------
2023-09-11 15:05:53.745666
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00564	Train Loss 0.0394	
start validation
acc: 0.810427
AUC: 0.930399
Avg Precision: 0.362970
Avg Recall: 1.000000
d_prime: 2.091301
train_loss: 0.039711
valid_loss: 0.985337
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0012534499410601038
Epoch-38 lr: 0.0012534499410601038
epoch 38 training time: 16.303
---------------
2023-09-11 15:06:10.048819
current #epochs=39, #steps=1520
start validation
acc: 0.786730
AUC: 0.926762
Avg Precision: 0.355442
Avg Recall: 1.000000
d_prime: 2.053566
train_loss: 0.028419
valid_loss: 0.992935
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0012534499410601038
Epoch-39 lr: 0.0012534499410601038
epoch 39 training time: 15.100
---------------
2023-09-11 15:06:25.149252
current #epochs=40, #steps=1560
start validation
acc: 0.796209
AUC: 0.924754
Avg Precision: 0.350510
Avg Recall: 1.000000
d_prime: 2.033354
train_loss: 0.024181
valid_loss: 0.994135
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0012534499410601038
Epoch-40 lr: 0.0012534499410601038
epoch 40 training time: 15.060
---------------
2023-09-11 15:06:40.209092
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03578	Per Sample Data Time 0.02845	Per Sample DNN Time 0.00733	Train Loss 0.0563	
start validation
acc: 0.805687
AUC: 0.918167
Avg Precision: 0.358015
Avg Recall: 1.000000
d_prime: 1.969781
train_loss: 0.029549
valid_loss: 0.987480
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0012534499410601038
Epoch-41 lr: 0.0012534499410601038
epoch 41 training time: 15.124
---------------
2023-09-11 15:06:55.332781
current #epochs=42, #steps=1640
start validation
acc: 0.800948
AUC: 0.927401
Avg Precision: 0.332404
Avg Recall: 1.000000
d_prime: 2.060096
train_loss: 0.032198
valid_loss: 0.977669
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0012534499410601038
Epoch-42 lr: 0.0012534499410601038
epoch 42 training time: 17.946
---------------
2023-09-11 15:07:13.279187
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00562	Train Loss 0.0320	
start validation
acc: 0.838863
AUC: 0.931139
Avg Precision: 0.336281
Avg Recall: 1.000000
d_prime: 2.099158
train_loss: 0.043045
valid_loss: 0.990659
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0009713352455889794
Epoch-43 lr: 0.0009713352455889794
epoch 43 training time: 15.459
---------------
2023-09-11 15:07:28.737843
current #epochs=44, #steps=1720
start validation
acc: 0.819905
AUC: 0.921292
Avg Precision: 0.355382
Avg Recall: 1.000000
d_prime: 1.999441
train_loss: 0.034708
valid_loss: 0.982227
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0009713352455889794
Epoch-44 lr: 0.0009713352455889794
epoch 44 training time: 15.900
---------------
2023-09-11 15:07:44.637656
current #epochs=45, #steps=1760
start validation
acc: 0.800948
AUC: 0.923182
Avg Precision: 0.366575
Avg Recall: 1.000000
d_prime: 2.017805
train_loss: 0.036450
valid_loss: 0.993447
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0009713352455889794
Epoch-45 lr: 0.0009713352455889794
epoch 45 training time: 15.499
---------------
2023-09-11 15:08:00.137154
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03674	Per Sample Data Time 0.02874	Per Sample DNN Time 0.00800	Train Loss 0.0066	
start validation
[I 2023-09-11 15:08:15,294] Trial 53 finished with value: 0.8530805687203792 and parameters: {'warmup': 'False', 'num_epochs': 46, 'batch_size': 59, 'lr-adaptschedule': 'True', 'lr': 0.0034758288245907857, 'head-lr': 1, 'lr-scheduler-start': 3, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.7749294277898915}. Best is trial 50 with value: 0.8815165876777251.
acc: 0.815166
AUC: 0.923383
Avg Precision: 0.367485
Avg Recall: 1.000000
d_prime: 2.019777
train_loss: 0.021209
valid_loss: 0.987437
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.0009713352455889794
Epoch-46 lr: 0.0009713352455889794
epoch 46 training time: 15.145
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863efc6c40>
The learning rate scheduler starts at 5 epoch with decay rate of 0.702 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 15:08:15.331399
current #epochs=1, #steps=0
start validation
acc: 0.800948
AUC: 0.919498
Avg Precision: 0.357221
Avg Recall: 1.000000
d_prime: 1.982305
train_loss: 0.050535
valid_loss: 1.020037
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0028074557415677815
Epoch-1 lr: 0.0028074557415677815
epoch 1 training time: 17.831
---------------
2023-09-11 15:08:33.162473
current #epochs=2, #steps=40
start validation
acc: 0.834123
AUC: 0.936881
Avg Precision: 0.374319
Avg Recall: 1.000000
d_prime: 2.162481
train_loss: 0.051404
valid_loss: 0.985612
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0028074557415677815
Epoch-2 lr: 0.0028074557415677815
epoch 2 training time: 18.104
---------------
2023-09-11 15:08:51.266644
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00564	Train Loss 0.0628	
start validation
acc: 0.800948
AUC: 0.925529
Avg Precision: 0.340003
Avg Recall: 1.000000
d_prime: 2.041102
train_loss: 0.072407
valid_loss: 1.031960
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0028074557415677815
Epoch-3 lr: 0.0028074557415677815
epoch 3 training time: 15.943
---------------
2023-09-11 15:09:07.210158
current #epochs=4, #steps=120
start validation
acc: 0.791469
AUC: 0.926463
Avg Precision: 0.356517
Avg Recall: 1.000000
d_prime: 2.050526
train_loss: 0.050228
valid_loss: 1.031970
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0028074557415677815
Epoch-4 lr: 0.0028074557415677815
epoch 4 training time: 15.201
---------------
2023-09-11 15:09:22.411150
current #epochs=5, #steps=160
start validation
acc: 0.848341
AUC: 0.947804
Avg Precision: 0.381471
Avg Recall: 1.000000
d_prime: 2.296574
train_loss: 0.054368
valid_loss: 0.960110
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0019698111228362665
Epoch-5 lr: 0.0019698111228362665
epoch 5 training time: 17.497
---------------
2023-09-11 15:09:39.908402
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03509	Per Sample Data Time 0.02750	Per Sample DNN Time 0.00759	Train Loss 0.0267	
start validation
acc: 0.838863
AUC: 0.944524
Avg Precision: 0.404156
Avg Recall: 1.000000
d_prime: 2.254155
train_loss: 0.052899
valid_loss: 0.970784
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0019698111228362665
Epoch-6 lr: 0.0019698111228362665
epoch 6 training time: 15.498
---------------
2023-09-11 15:09:55.406596
current #epochs=7, #steps=240
start validation
acc: 0.824645
AUC: 0.937501
Avg Precision: 0.353669
Avg Recall: 1.000000
d_prime: 2.169584
train_loss: 0.057208
valid_loss: 0.998332
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0019698111228362665
Epoch-7 lr: 0.0019698111228362665
epoch 7 training time: 15.750
---------------
2023-09-11 15:10:11.156763
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00560	Train Loss 0.0381	
start validation
acc: 0.805687
AUC: 0.923034
Avg Precision: 0.357463
Avg Recall: 1.000000
d_prime: 2.016358
train_loss: 0.041709
valid_loss: 1.000607
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0019698111228362665
Epoch-8 lr: 0.0019698111228362665
epoch 8 training time: 15.619
---------------
2023-09-11 15:10:26.775115
current #epochs=9, #steps=320
start validation
acc: 0.810427
AUC: 0.924778
Avg Precision: 0.341048
Avg Recall: 1.000000
d_prime: 2.033590
train_loss: 0.048330
valid_loss: 1.010782
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0019698111228362665
Epoch-9 lr: 0.0019698111228362665
epoch 9 training time: 15.800
---------------
2023-09-11 15:10:42.575726
current #epochs=10, #steps=360
start validation
acc: 0.824645
AUC: 0.941497
Avg Precision: 0.368139
Avg Recall: 1.000000
d_prime: 2.216733
train_loss: 0.044922
valid_loss: 1.005498
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0019698111228362665
Epoch-10 lr: 0.0019698111228362665
epoch 10 training time: 15.201
---------------
2023-09-11 15:10:57.776684
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03633	Per Sample Data Time 0.02946	Per Sample DNN Time 0.00687	Train Loss 0.0989	
start validation
acc: 0.824645
AUC: 0.930577
Avg Precision: 0.356299
Avg Recall: 1.000000
d_prime: 2.093185
train_loss: 0.047978
valid_loss: 0.996833
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0019698111228362665
Epoch-11 lr: 0.0019698111228362665
epoch 11 training time: 15.482
---------------
2023-09-11 15:11:13.259120
current #epochs=12, #steps=440
start validation
acc: 0.853081
AUC: 0.930239
Avg Precision: 0.331857
Avg Recall: 1.000000
d_prime: 2.089606
train_loss: 0.030451
valid_loss: 1.014311
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0019698111228362665
Epoch-12 lr: 0.0019698111228362665
epoch 12 training time: 17.135
---------------
2023-09-11 15:11:30.393551
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00570	Train Loss 0.0332	
start validation
acc: 0.819905
AUC: 0.941304
Avg Precision: 0.407200
Avg Recall: 1.000000
d_prime: 2.214391
train_loss: 0.037253
valid_loss: 1.003844
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0019698111228362665
Epoch-13 lr: 0.0019698111228362665
epoch 13 training time: 15.046
---------------
2023-09-11 15:11:45.439948
current #epochs=14, #steps=520
start validation
acc: 0.824645
AUC: 0.939656
Avg Precision: 0.434783
Avg Recall: 1.000000
d_prime: 2.194703
train_loss: 0.032643
valid_loss: 0.995072
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0013820897698222157
Epoch-14 lr: 0.0013820897698222157
epoch 14 training time: 14.963
---------------
2023-09-11 15:12:00.402778
current #epochs=15, #steps=560
start validation
acc: 0.838863
AUC: 0.941917
Avg Precision: 0.405667
Avg Recall: 1.000000
d_prime: 2.221825
train_loss: 0.036662
valid_loss: 0.984919
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0013820897698222157
Epoch-15 lr: 0.0013820897698222157
epoch 15 training time: 14.984
---------------
2023-09-11 15:12:15.386536
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03870	Per Sample Data Time 0.02812	Per Sample DNN Time 0.01058	Train Loss 0.0027	
start validation
acc: 0.834123
AUC: 0.938423
Avg Precision: 0.378709
Avg Recall: 1.000000
d_prime: 2.180253
train_loss: 0.041227
valid_loss: 0.997098
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0013820897698222157
Epoch-16 lr: 0.0013820897698222157
epoch 16 training time: 15.087
---------------
2023-09-11 15:12:30.473132
current #epochs=17, #steps=640
start validation
acc: 0.857820
AUC: 0.941084
Avg Precision: 0.367809
Avg Recall: 1.000000
d_prime: 2.211742
train_loss: 0.034206
valid_loss: 0.991138
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0013820897698222157
Epoch-17 lr: 0.0013820897698222157
epoch 17 training time: 16.939
---------------
2023-09-11 15:12:47.412097
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00569	Train Loss 0.0441	
start validation
acc: 0.838863
AUC: 0.940868
Avg Precision: 0.394764
Avg Recall: 1.000000
d_prime: 2.209147
train_loss: 0.031939
valid_loss: 0.994838
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0013820897698222157
Epoch-18 lr: 0.0013820897698222157
epoch 18 training time: 15.010
---------------
2023-09-11 15:13:02.421637
current #epochs=19, #steps=720
start validation
acc: 0.824645
AUC: 0.933054
Avg Precision: 0.382262
Avg Recall: 1.000000
d_prime: 2.119804
train_loss: 0.030028
valid_loss: 0.998497
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0013820897698222157
Epoch-19 lr: 0.0013820897698222157
epoch 19 training time: 14.930
---------------
2023-09-11 15:13:17.351418
current #epochs=20, #steps=760
start validation
acc: 0.838863
AUC: 0.932865
Avg Precision: 0.382269
Avg Recall: 1.000000
d_prime: 2.117751
train_loss: 0.051814
valid_loss: 1.003053
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0013820897698222157
Epoch-20 lr: 0.0013820897698222157
epoch 20 training time: 15.119
---------------
2023-09-11 15:13:32.470805
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03809	Per Sample Data Time 0.02788	Per Sample DNN Time 0.01021	Train Loss 0.0122	
start validation
acc: 0.824645
AUC: 0.918837
Avg Precision: 0.382918
Avg Recall: 1.000000
d_prime: 1.976072
train_loss: 0.043087
valid_loss: 1.005200
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0013820897698222157
Epoch-21 lr: 0.0013820897698222157
epoch 21 training time: 16.271
---------------
2023-09-11 15:13:48.741736
current #epochs=22, #steps=840
start validation
acc: 0.796209
AUC: 0.931665
Avg Precision: 0.374574
Avg Recall: 1.000000
d_prime: 2.104786
train_loss: 0.038461
valid_loss: 0.997959
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0013820897698222157
Epoch-22 lr: 0.0013820897698222157
epoch 22 training time: 15.101
---------------
2023-09-11 15:14:03.842251
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00559	Train Loss 0.0359	
start validation
acc: 0.777251
AUC: 0.931202
Avg Precision: 0.362862
Avg Recall: 1.000000
d_prime: 2.099830
train_loss: 0.032247
valid_loss: 0.996809
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0009697234977010541
Epoch-23 lr: 0.0009697234977010541
epoch 23 training time: 15.070
---------------
2023-09-11 15:14:18.912388
current #epochs=24, #steps=920
start validation
acc: 0.796209
AUC: 0.925576
Avg Precision: 0.369418
Avg Recall: 1.000000
d_prime: 2.041575
train_loss: 0.041662
valid_loss: 1.003299
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0009697234977010541
Epoch-24 lr: 0.0009697234977010541
epoch 24 training time: 15.123
---------------
2023-09-11 15:14:34.036068
current #epochs=25, #steps=960
start validation
acc: 0.796209
AUC: 0.928231
Avg Precision: 0.376035
Avg Recall: 1.000000
d_prime: 2.068629
train_loss: 0.026772
valid_loss: 1.000992
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0009697234977010541
Epoch-25 lr: 0.0009697234977010541
epoch 25 training time: 15.072
---------------
2023-09-11 15:14:49.107869
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03564	Per Sample Data Time 0.02838	Per Sample DNN Time 0.00726	Train Loss 0.0229	
start validation
acc: 0.815166
AUC: 0.927485
Avg Precision: 0.369925
Avg Recall: 1.000000
d_prime: 2.060948
train_loss: 0.036294
valid_loss: 1.002055
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0009697234977010541
Epoch-26 lr: 0.0009697234977010541
epoch 26 training time: 15.115
---------------
2023-09-11 15:15:04.222824
current #epochs=27, #steps=1040
start validation
acc: 0.815166
AUC: 0.931707
Avg Precision: 0.376253
Avg Recall: 1.000000
d_prime: 2.105237
train_loss: 0.025182
valid_loss: 0.999639
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0009697234977010541
Epoch-27 lr: 0.0009697234977010541
epoch 27 training time: 15.059
---------------
2023-09-11 15:15:19.281263
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00142	Per Sample DNN Time 0.00563	Train Loss 0.0192	
start validation
acc: 0.815166
AUC: 0.933616
Avg Precision: 0.356977
Avg Recall: 1.000000
d_prime: 2.125954
train_loss: 0.026644
valid_loss: 0.991741
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0009697234977010541
Epoch-28 lr: 0.0009697234977010541
epoch 28 training time: 15.818
---------------
2023-09-11 15:15:35.099147
current #epochs=29, #steps=1120
start validation
acc: 0.805687
AUC: 0.927127
Avg Precision: 0.361421
Avg Recall: 1.000000
d_prime: 2.057286
train_loss: 0.027003
valid_loss: 0.990227
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0009697234977010541
Epoch-29 lr: 0.0009697234977010541
epoch 29 training time: 15.211
---------------
2023-09-11 15:15:50.309982
current #epochs=30, #steps=1160
start validation
acc: 0.796209
AUC: 0.920748
Avg Precision: 0.339517
Avg Recall: 1.000000
d_prime: 1.994212
train_loss: 0.032158
valid_loss: 1.007432
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0009697234977010541
Epoch-30 lr: 0.0009697234977010541
epoch 30 training time: 15.112
---------------
2023-09-11 15:16:05.421941
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03642	Per Sample Data Time 0.02866	Per Sample DNN Time 0.00777	Train Loss 0.0552	
start validation
acc: 0.810427
AUC: 0.924937
Avg Precision: 0.355613
Avg Recall: 1.000000
d_prime: 2.035180
train_loss: 0.030864
valid_loss: 1.000740
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0009697234977010541
Epoch-31 lr: 0.0009697234977010541
epoch 31 training time: 15.124
---------------
2023-09-11 15:16:20.545894
current #epochs=32, #steps=1240
start validation
acc: 0.838863
AUC: 0.926696
Avg Precision: 0.354427
Avg Recall: 1.000000
d_prime: 2.052899
train_loss: 0.024529
valid_loss: 0.992473
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0006803926072866666
Epoch-32 lr: 0.0006803926072866666
epoch 32 training time: 15.164
---------------
2023-09-11 15:16:35.709838
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00568	Train Loss 0.0221	
start validation
acc: 0.824645
AUC: 0.930123
Avg Precision: 0.356131
Avg Recall: 1.000000
d_prime: 2.088385
train_loss: 0.024957
valid_loss: 0.994356
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0006803926072866666
Epoch-33 lr: 0.0006803926072866666
epoch 33 training time: 15.159
---------------
2023-09-11 15:16:50.868762
current #epochs=34, #steps=1320
start validation
acc: 0.819905
AUC: 0.932773
Avg Precision: 0.364191
Avg Recall: 1.000000
d_prime: 2.116750
train_loss: 0.025361
valid_loss: 0.998668
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0006803926072866666
Epoch-34 lr: 0.0006803926072866666
epoch 34 training time: 15.122
---------------
2023-09-11 15:17:05.990576
current #epochs=35, #steps=1360
start validation
acc: 0.829384
AUC: 0.926965
Avg Precision: 0.353184
Avg Recall: 1.000000
d_prime: 2.055636
train_loss: 0.021297
valid_loss: 1.016455
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0006803926072866666
Epoch-35 lr: 0.0006803926072866666
epoch 35 training time: 15.020
---------------
2023-09-11 15:17:21.010691
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03829	Per Sample Data Time 0.02769	Per Sample DNN Time 0.01060	Train Loss 0.0043	
start validation
acc: 0.819905
AUC: 0.925085
Avg Precision: 0.347622
Avg Recall: 1.000000
d_prime: 2.036659
train_loss: 0.020604
valid_loss: 1.018757
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0006803926072866666
Epoch-36 lr: 0.0006803926072866666
epoch 36 training time: 15.097
---------------
2023-09-11 15:17:36.108242
current #epochs=37, #steps=1440
start validation
acc: 0.810427
AUC: 0.924958
Avg Precision: 0.370979
Avg Recall: 1.000000
d_prime: 2.035388
train_loss: 0.025203
valid_loss: 1.009928
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0006803926072866666
Epoch-37 lr: 0.0006803926072866666
epoch 37 training time: 15.096
---------------
2023-09-11 15:17:51.203896
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00563	Train Loss 0.0193	
start validation
acc: 0.810427
AUC: 0.931521
Avg Precision: 0.388156
Avg Recall: 1.000000
d_prime: 2.103241
train_loss: 0.021429
valid_loss: 1.015757
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0006803926072866666
Epoch-38 lr: 0.0006803926072866666
epoch 38 training time: 14.938
---------------
2023-09-11 15:18:06.141763
current #epochs=39, #steps=1520
start validation
acc: 0.796209
AUC: 0.931896
Avg Precision: 0.396188
Avg Recall: 1.000000
d_prime: 2.107260
train_loss: 0.026616
valid_loss: 1.018719
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0006803926072866666
Epoch-39 lr: 0.0006803926072866666
epoch 39 training time: 16.119
---------------
2023-09-11 15:18:22.261379
current #epochs=40, #steps=1560
start validation
acc: 0.819905
AUC: 0.930251
Avg Precision: 0.371927
Avg Recall: 1.000000
d_prime: 2.089732
train_loss: 0.029088
valid_loss: 1.019845
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0006803926072866666
Epoch-40 lr: 0.0006803926072866666
epoch 40 training time: 15.108
---------------
2023-09-11 15:18:37.369211
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03703	Per Sample Data Time 0.02965	Per Sample DNN Time 0.00739	Train Loss 0.0002	
start validation
acc: 0.815166
AUC: 0.933161
Avg Precision: 0.378430
Avg Recall: 1.000000
d_prime: 2.120968
train_loss: 0.025035
valid_loss: 1.014796
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.00047738773077875984
Epoch-41 lr: 0.00047738773077875984
epoch 41 training time: 14.965
---------------
2023-09-11 15:18:52.334220
current #epochs=42, #steps=1640
start validation
acc: 0.796209
AUC: 0.935211
Avg Precision: 0.378329
Avg Recall: 1.000000
d_prime: 2.143621
train_loss: 0.024683
valid_loss: 1.010506
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.00047738773077875984
Epoch-42 lr: 0.00047738773077875984
epoch 42 training time: 15.119
---------------
2023-09-11 15:19:07.453878
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00556	Train Loss 0.0175	
start validation
acc: 0.815166
AUC: 0.933780
Avg Precision: 0.363730
Avg Recall: 1.000000
d_prime: 2.127754
train_loss: 0.017330
valid_loss: 1.008543
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.00047738773077875984
Epoch-43 lr: 0.00047738773077875984
epoch 43 training time: 15.063
---------------
2023-09-11 15:19:22.516704
current #epochs=44, #steps=1720
start validation
acc: 0.824645
AUC: 0.933239
Avg Precision: 0.365622
Avg Recall: 1.000000
d_prime: 2.121829
train_loss: 0.020976
valid_loss: 1.007177
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.00047738773077875984
Epoch-44 lr: 0.00047738773077875984
epoch 44 training time: 14.810
---------------
2023-09-11 15:19:37.326808
current #epochs=45, #steps=1760
start validation
acc: 0.834123
AUC: 0.930622
Avg Precision: 0.362177
Avg Recall: 1.000000
d_prime: 2.093654
train_loss: 0.036382
valid_loss: 1.011220
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.00047738773077875984
Epoch-45 lr: 0.00047738773077875984
epoch 45 training time: 15.062
---------------
2023-09-11 15:19:52.389023
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03654	Per Sample Data Time 0.02882	Per Sample DNN Time 0.00772	Train Loss 0.0186	
start validation
acc: 0.838863
AUC: 0.932931
Avg Precision: 0.356558
Avg Recall: 1.000000
d_prime: 2.118467
train_loss: 0.021211
valid_loss: 0.999266
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.00047738773077875984
Epoch-46 lr: 0.00047738773077875984
epoch 46 training time: 15.081
---------------
2023-09-11 15:20:07.470059
current #epochs=47, #steps=1840
start validation
acc: 0.824645
AUC: 0.934676
Avg Precision: 0.381119
Avg Recall: 1.000000
d_prime: 2.137661
train_loss: 0.022964
valid_loss: 0.995114
validation finished
normal learning rate scheduler step
Epoch-47 lr: 0.00047738773077875984
Epoch-47 lr: 0.00047738773077875984
epoch 47 training time: 15.078
---------------
2023-09-11 15:20:22.547599
current #epochs=48, #steps=1880
Epoch: [48][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00565	Train Loss 0.0265	
start validation
[I 2023-09-11 15:20:37,635] Trial 54 finished with value: 0.8578199052132701 and parameters: {'warmup': 'False', 'num_epochs': 48, 'batch_size': 58, 'lr-adaptschedule': 'True', 'lr': 0.0028074557415677815, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.7016356816140777}. Best is trial 50 with value: 0.8815165876777251.
acc: 0.834123
AUC: 0.930778
Avg Precision: 0.385779
Avg Recall: 1.000000
d_prime: 2.095312
train_loss: 0.024093
valid_loss: 1.001096
validation finished
normal learning rate scheduler step
Epoch-48 lr: 0.00047738773077875984
Epoch-48 lr: 0.00047738773077875984
epoch 48 training time: 15.077
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f86448188b0>
The learning rate scheduler starts at 4 epoch with decay rate of 0.817 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 15:20:37.672503
current #epochs=1, #steps=0
start validation
acc: 0.815166
AUC: 0.931758
Avg Precision: 0.376952
Avg Recall: 1.000000
d_prime: 2.105784
train_loss: 0.074479
valid_loss: 0.996774
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003086356188225822
Epoch-1 lr: 0.003086356188225822
epoch 1 training time: 17.152
---------------
2023-09-11 15:20:54.825138
current #epochs=2, #steps=40
start validation
acc: 0.829384
AUC: 0.931718
Avg Precision: 0.348775
Avg Recall: 1.000000
d_prime: 2.105357
train_loss: 0.048621
valid_loss: 0.993640
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003086356188225822
Epoch-2 lr: 0.003086356188225822
epoch 2 training time: 17.135
---------------
2023-09-11 15:21:11.960847
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00726	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00568	Train Loss 0.0381	
start validation
acc: 0.810427
AUC: 0.928402
Avg Precision: 0.364886
Avg Recall: 1.000000
d_prime: 2.070395
train_loss: 0.052795
valid_loss: 1.002126
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003086356188225822
Epoch-3 lr: 0.003086356188225822
epoch 3 training time: 15.190
---------------
2023-09-11 15:21:27.150252
current #epochs=4, #steps=120
start validation
acc: 0.824645
AUC: 0.919252
Avg Precision: 0.358322
Avg Recall: 1.000000
d_prime: 1.979981
train_loss: 0.062487
valid_loss: 1.008569
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0025202140925606464
Epoch-4 lr: 0.0025202140925606464
epoch 4 training time: 15.097
---------------
2023-09-11 15:21:42.247865
current #epochs=5, #steps=160
start validation
acc: 0.824645
AUC: 0.926160
Avg Precision: 0.361004
Avg Recall: 1.000000
d_prime: 2.047463
train_loss: 0.069799
valid_loss: 1.008560
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0025202140925606464
Epoch-5 lr: 0.0025202140925606464
epoch 5 training time: 15.192
---------------
2023-09-11 15:21:57.439692
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03752	Per Sample Data Time 0.02965	Per Sample DNN Time 0.00787	Train Loss 0.0670	
start validation
acc: 0.810427
AUC: 0.932435
Avg Precision: 0.375699
Avg Recall: 1.000000
d_prime: 2.113079
train_loss: 0.053849
valid_loss: 0.985551
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0025202140925606464
Epoch-6 lr: 0.0025202140925606464
epoch 6 training time: 15.105
---------------
2023-09-11 15:22:12.544711
current #epochs=7, #steps=240
start validation
acc: 0.781991
AUC: 0.916881
Avg Precision: 0.354086
Avg Recall: 1.000000
d_prime: 1.957831
train_loss: 0.054615
valid_loss: 1.010642
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0025202140925606464
Epoch-7 lr: 0.0025202140925606464
epoch 7 training time: 15.045
---------------
2023-09-11 15:22:27.589557
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00562	Train Loss 0.0362	
start validation
acc: 0.819905
AUC: 0.918166
Avg Precision: 0.354784
Avg Recall: 1.000000
d_prime: 1.969770
train_loss: 0.058261
valid_loss: 1.030853
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0025202140925606464
Epoch-8 lr: 0.0025202140925606464
epoch 8 training time: 15.061
---------------
2023-09-11 15:22:42.650440
current #epochs=9, #steps=320
start validation
acc: 0.805687
AUC: 0.923131
Avg Precision: 0.366753
Avg Recall: 1.000000
d_prime: 2.017309
train_loss: 0.056649
valid_loss: 1.022718
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0025202140925606464
Epoch-9 lr: 0.0025202140925606464
epoch 9 training time: 15.121
---------------
2023-09-11 15:22:57.771306
current #epochs=10, #steps=360
start validation
acc: 0.810427
AUC: 0.931785
Avg Precision: 0.354866
Avg Recall: 1.000000
d_prime: 2.106073
train_loss: 0.041562
valid_loss: 1.008699
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0025202140925606464
Epoch-10 lr: 0.0025202140925606464
epoch 10 training time: 15.138
---------------
2023-09-11 15:23:12.909375
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03854	Per Sample Data Time 0.02871	Per Sample DNN Time 0.00983	Train Loss 0.0067	
start validation
acc: 0.805687
AUC: 0.926134
Avg Precision: 0.352492
Avg Recall: 1.000000
d_prime: 2.047198
train_loss: 0.047865
valid_loss: 1.004373
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0025202140925606464
Epoch-11 lr: 0.0025202140925606464
epoch 11 training time: 15.100
---------------
2023-09-11 15:23:28.009019
current #epochs=12, #steps=440
start validation
acc: 0.819905
AUC: 0.933202
Avg Precision: 0.369183
Avg Recall: 1.000000
d_prime: 2.121426
train_loss: 0.039698
valid_loss: 1.005700
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0025202140925606464
Epoch-12 lr: 0.0025202140925606464
epoch 12 training time: 15.095
---------------
2023-09-11 15:23:43.104280
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00560	Train Loss 0.0359	
start validation
acc: 0.834123
AUC: 0.931569
Avg Precision: 0.333520
Avg Recall: 1.000000
d_prime: 2.103758
train_loss: 0.037979
valid_loss: 0.999856
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0025202140925606464
Epoch-13 lr: 0.0025202140925606464
epoch 13 training time: 17.265
---------------
2023-09-11 15:24:00.369212
current #epochs=14, #steps=520
start validation
acc: 0.815166
AUC: 0.929485
Avg Precision: 0.351985
Avg Recall: 1.000000
d_prime: 2.081680
train_loss: 0.028245
valid_loss: 1.009665
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0020579216023645028
Epoch-14 lr: 0.0020579216023645028
epoch 14 training time: 15.269
---------------
2023-09-11 15:24:15.637878
current #epochs=15, #steps=560
start validation
acc: 0.834123
AUC: 0.929233
Avg Precision: 0.354635
Avg Recall: 1.000000
d_prime: 2.079043
train_loss: 0.038578
valid_loss: 1.005049
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0020579216023645028
Epoch-15 lr: 0.0020579216023645028
epoch 15 training time: 15.667
---------------
2023-09-11 15:24:31.304999
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.04090	Per Sample Data Time 0.03202	Per Sample DNN Time 0.00888	Train Loss 0.1244	
start validation
acc: 0.819905
AUC: 0.931007
Avg Precision: 0.355285
Avg Recall: 1.000000
d_prime: 2.097750
train_loss: 0.086029
valid_loss: 1.000100
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0020579216023645028
Epoch-16 lr: 0.0020579216023645028
epoch 16 training time: 15.263
---------------
2023-09-11 15:24:46.567356
current #epochs=17, #steps=640
start validation
acc: 0.796209
AUC: 0.932022
Avg Precision: 0.385535
Avg Recall: 1.000000
d_prime: 2.108621
train_loss: 0.054753
valid_loss: 1.031265
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0020579216023645028
Epoch-17 lr: 0.0020579216023645028
epoch 17 training time: 15.041
---------------
2023-09-11 15:25:01.607938
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00560	Train Loss 0.0596	
start validation
acc: 0.791469
AUC: 0.941138
Avg Precision: 0.435345
Avg Recall: 1.000000
d_prime: 2.212396
train_loss: 0.055750
valid_loss: 1.005476
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0020579216023645028
Epoch-18 lr: 0.0020579216023645028
epoch 18 training time: 16.007
---------------
2023-09-11 15:25:17.614854
current #epochs=19, #steps=720
start validation
acc: 0.829384
AUC: 0.939428
Avg Precision: 0.370621
Avg Recall: 1.000000
d_prime: 2.192018
train_loss: 0.036459
valid_loss: 1.011608
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0020579216023645028
Epoch-19 lr: 0.0020579216023645028
epoch 19 training time: 15.099
---------------
2023-09-11 15:25:32.713664
current #epochs=20, #steps=760
start validation
acc: 0.796209
AUC: 0.932933
Avg Precision: 0.357987
Avg Recall: 1.000000
d_prime: 2.118490
train_loss: 0.046709
valid_loss: 1.022495
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0020579216023645028
Epoch-20 lr: 0.0020579216023645028
epoch 20 training time: 16.414
---------------
2023-09-11 15:25:49.127873
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03691	Per Sample Data Time 0.02936	Per Sample DNN Time 0.00754	Train Loss 0.0286	
start validation
acc: 0.810427
AUC: 0.934552
Avg Precision: 0.358039
Avg Recall: 1.000000
d_prime: 2.136280
train_loss: 0.035427
valid_loss: 0.995466
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0020579216023645028
Epoch-21 lr: 0.0020579216023645028
epoch 21 training time: 15.163
---------------
2023-09-11 15:26:04.290851
current #epochs=22, #steps=840
start validation
acc: 0.805687
AUC: 0.930659
Avg Precision: 0.377437
Avg Recall: 1.000000
d_prime: 2.094053
train_loss: 0.030935
valid_loss: 1.015124
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0020579216023645028
Epoch-22 lr: 0.0020579216023645028
epoch 22 training time: 15.077
---------------
2023-09-11 15:26:19.368244
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00568	Train Loss 0.0479	
start validation
acc: 0.810427
AUC: 0.935432
Avg Precision: 0.409448
Avg Recall: 1.000000
d_prime: 2.146094
train_loss: 0.046362
valid_loss: 1.020832
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0020579216023645028
Epoch-23 lr: 0.0020579216023645028
epoch 23 training time: 15.140
---------------
2023-09-11 15:26:34.508124
current #epochs=24, #steps=920
start validation
acc: 0.796209
AUC: 0.935839
Avg Precision: 0.389757
Avg Recall: 1.000000
d_prime: 2.150668
train_loss: 0.039892
valid_loss: 1.020225
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0016804291881311949
Epoch-24 lr: 0.0016804291881311949
epoch 24 training time: 15.028
---------------
2023-09-11 15:26:49.536492
current #epochs=25, #steps=960
start validation
acc: 0.810427
AUC: 0.935781
Avg Precision: 0.374624
Avg Recall: 1.000000
d_prime: 2.150011
train_loss: 0.045048
valid_loss: 0.996322
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0016804291881311949
Epoch-25 lr: 0.0016804291881311949
epoch 25 training time: 15.428
---------------
2023-09-11 15:27:04.963823
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.04005	Per Sample Data Time 0.02882	Per Sample DNN Time 0.01123	Train Loss 0.0285	
start validation
acc: 0.815166
AUC: 0.921586
Avg Precision: 0.319826
Avg Recall: 1.000000
d_prime: 2.002274
train_loss: 0.042323
valid_loss: 1.008879
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0016804291881311949
Epoch-26 lr: 0.0016804291881311949
epoch 26 training time: 15.295
---------------
2023-09-11 15:27:20.259124
current #epochs=27, #steps=1040
start validation
acc: 0.819905
AUC: 0.934985
Avg Precision: 0.369645
Avg Recall: 1.000000
d_prime: 2.141096
train_loss: 0.047496
valid_loss: 1.010603
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0016804291881311949
Epoch-27 lr: 0.0016804291881311949
epoch 27 training time: 16.680
---------------
2023-09-11 15:27:36.939496
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00564	Train Loss 0.0474	
start validation
acc: 0.810427
AUC: 0.931554
Avg Precision: 0.373965
Avg Recall: 1.000000
d_prime: 2.103594
train_loss: 0.041509
valid_loss: 1.010969
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0016804291881311949
Epoch-28 lr: 0.0016804291881311949
epoch 28 training time: 15.088
---------------
2023-09-11 15:27:52.027982
current #epochs=29, #steps=1120
start validation
acc: 0.838863
AUC: 0.931407
Avg Precision: 0.340198
Avg Recall: 1.000000
d_prime: 2.102017
train_loss: 0.034431
valid_loss: 1.003092
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0016804291881311949
Epoch-29 lr: 0.0016804291881311949
epoch 29 training time: 17.192
---------------
2023-09-11 15:28:09.220430
current #epochs=30, #steps=1160
start validation
acc: 0.815166
AUC: 0.926268
Avg Precision: 0.345980
Avg Recall: 1.000000
d_prime: 2.048556
train_loss: 0.039322
valid_loss: 1.002949
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0016804291881311949
Epoch-30 lr: 0.0016804291881311949
epoch 30 training time: 16.267
---------------
2023-09-11 15:28:25.487179
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03908	Per Sample Data Time 0.02899	Per Sample DNN Time 0.01009	Train Loss 0.0320	
start validation
acc: 0.819905
AUC: 0.927964
Avg Precision: 0.327765
Avg Recall: 1.000000
d_prime: 2.065872
train_loss: 0.030346
valid_loss: 1.002606
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0016804291881311949
Epoch-31 lr: 0.0016804291881311949
epoch 31 training time: 15.235
---------------
2023-09-11 15:28:40.721954
current #epochs=32, #steps=1240
start validation
acc: 0.819905
AUC: 0.924161
Avg Precision: 0.336663
Avg Recall: 1.000000
d_prime: 2.027454
train_loss: 0.020824
valid_loss: 1.002711
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0016804291881311949
Epoch-32 lr: 0.0016804291881311949
epoch 32 training time: 15.110
---------------
2023-09-11 15:28:55.831633
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00558	Train Loss 0.0443	
start validation
acc: 0.810427
AUC: 0.936760
Avg Precision: 0.340280
Avg Recall: 1.000000
d_prime: 2.161107
train_loss: 0.034468
valid_loss: 1.002101
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0016804291881311949
Epoch-33 lr: 0.0016804291881311949
epoch 33 training time: 15.052
---------------
2023-09-11 15:29:10.883302
current #epochs=34, #steps=1320
start validation
acc: 0.815166
AUC: 0.913615
Avg Precision: 0.329880
Avg Recall: 1.000000
d_prime: 1.928075
train_loss: 0.038892
valid_loss: 1.021397
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.001372181648260429
Epoch-34 lr: 0.001372181648260429
epoch 34 training time: 14.916
---------------
2023-09-11 15:29:25.799423
current #epochs=35, #steps=1360
start validation
acc: 0.824645
AUC: 0.928400
Avg Precision: 0.345998
Avg Recall: 1.000000
d_prime: 2.070381
train_loss: 0.041897
valid_loss: 1.013673
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.001372181648260429
Epoch-35 lr: 0.001372181648260429
epoch 35 training time: 15.166
---------------
2023-09-11 15:29:40.965027
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03466	Per Sample Data Time 0.02694	Per Sample DNN Time 0.00771	Train Loss 0.0484	
start validation
acc: 0.838863
AUC: 0.931033
Avg Precision: 0.361709
Avg Recall: 1.000000
d_prime: 2.098028
train_loss: 0.026853
valid_loss: 1.001558
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.001372181648260429
Epoch-36 lr: 0.001372181648260429
epoch 36 training time: 14.978
---------------
2023-09-11 15:29:55.943461
current #epochs=37, #steps=1440
start validation
acc: 0.843602
AUC: 0.935909
Avg Precision: 0.363808
Avg Recall: 1.000000
d_prime: 2.151463
train_loss: 0.033159
valid_loss: 1.002337
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.001372181648260429
Epoch-37 lr: 0.001372181648260429
epoch 37 training time: 17.491
---------------
2023-09-11 15:30:13.434754
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00571	Train Loss 0.0414	
start validation
[I 2023-09-11 15:30:28,778] Trial 55 finished with value: 0.8436018957345972 and parameters: {'warmup': 'False', 'num_epochs': 38, 'batch_size': 46, 'lr-adaptschedule': 'True', 'lr': 0.003086356188225822, 'head-lr': 1, 'lr-scheduler-start': 4, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.8165661831823048}. Best is trial 50 with value: 0.8815165876777251.
acc: 0.805687
AUC: 0.926166
Avg Precision: 0.389319
Avg Recall: 1.000000
d_prime: 2.047527
train_loss: 0.044642
valid_loss: 1.022051
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.001372181648260429
Epoch-38 lr: 0.001372181648260429
epoch 38 training time: 15.332
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863d9802e0>
The learning rate scheduler starts at 7 epoch with decay rate of 0.802 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 15:30:28.815257
current #epochs=1, #steps=0
start validation
acc: 0.786730
AUC: 0.917967
Avg Precision: 0.351617
Avg Recall: 1.000000
d_prime: 1.967915
train_loss: 0.056097
valid_loss: 1.039181
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0027153986877539236
Epoch-1 lr: 0.005430797375507847
epoch 1 training time: 17.126
---------------
2023-09-11 15:30:45.941322
current #epochs=2, #steps=40
start validation
acc: 0.796209
AUC: 0.918517
Avg Precision: 0.327391
Avg Recall: 1.000000
d_prime: 1.973057
train_loss: 0.049189
valid_loss: 1.033201
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0027153986877539236
Epoch-2 lr: 0.005430797375507847
epoch 2 training time: 17.229
---------------
2023-09-11 15:31:03.169945
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00564	Train Loss 0.0574	
start validation
acc: 0.800948
AUC: 0.924773
Avg Precision: 0.381027
Avg Recall: 1.000000
d_prime: 2.033539
train_loss: 0.062722
valid_loss: 1.020536
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0027153986877539236
Epoch-3 lr: 0.005430797375507847
epoch 3 training time: 17.342
---------------
2023-09-11 15:31:20.511787
current #epochs=4, #steps=120
start validation
acc: 0.824645
AUC: 0.925190
Avg Precision: 0.338251
Avg Recall: 1.000000
d_prime: 2.037707
train_loss: 0.050165
valid_loss: 1.022207
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0027153986877539236
Epoch-4 lr: 0.005430797375507847
epoch 4 training time: 17.144
---------------
2023-09-11 15:31:37.655611
current #epochs=5, #steps=160
start validation
acc: 0.824645
AUC: 0.933706
Avg Precision: 0.366623
Avg Recall: 1.000000
d_prime: 2.126937
train_loss: 0.038574
valid_loss: 1.025161
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0027153986877539236
Epoch-5 lr: 0.005430797375507847
epoch 5 training time: 15.171
---------------
2023-09-11 15:31:52.826158
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03819	Per Sample Data Time 0.03093	Per Sample DNN Time 0.00726	Train Loss 0.0059	
start validation
acc: 0.829384
AUC: 0.931151
Avg Precision: 0.355193
Avg Recall: 1.000000
d_prime: 2.099289
train_loss: 0.045060
valid_loss: 1.012860
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0027153986877539236
Epoch-6 lr: 0.005430797375507847
epoch 6 training time: 18.065
---------------
2023-09-11 15:32:10.890886
current #epochs=7, #steps=240
start validation
acc: 0.824645
AUC: 0.937696
Avg Precision: 0.399732
Avg Recall: 1.000000
d_prime: 2.171825
train_loss: 0.031782
valid_loss: 0.990650
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0021768181451040764
Epoch-7 lr: 0.004353636290208153
epoch 7 training time: 15.050
---------------
2023-09-11 15:32:25.940722
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00724	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00572	Train Loss 0.0385	
start validation
acc: 0.815166
AUC: 0.919470
Avg Precision: 0.355115
Avg Recall: 1.000000
d_prime: 1.982039
train_loss: 0.040890
valid_loss: 1.030388
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0021768181451040764
Epoch-8 lr: 0.004353636290208153
epoch 8 training time: 15.160
---------------
2023-09-11 15:32:41.100965
current #epochs=9, #steps=320
start validation
acc: 0.791469
AUC: 0.916088
Avg Precision: 0.341853
Avg Recall: 1.000000
d_prime: 1.950529
train_loss: 0.051138
valid_loss: 1.016953
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0021768181451040764
Epoch-9 lr: 0.004353636290208153
epoch 9 training time: 16.387
---------------
2023-09-11 15:32:57.488106
current #epochs=10, #steps=360
start validation
acc: 0.810427
AUC: 0.927410
Avg Precision: 0.358345
Avg Recall: 1.000000
d_prime: 2.060181
train_loss: 0.060654
valid_loss: 1.009513
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0021768181451040764
Epoch-10 lr: 0.004353636290208153
epoch 10 training time: 15.011
---------------
2023-09-11 15:33:12.499329
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03691	Per Sample Data Time 0.02902	Per Sample DNN Time 0.00789	Train Loss 0.0130	
start validation
acc: 0.805687
AUC: 0.923919
Avg Precision: 0.335645
Avg Recall: 1.000000
d_prime: 2.025068
train_loss: 0.066697
valid_loss: 1.001238
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001745061326804239
Epoch-11 lr: 0.003490122653608478
epoch 11 training time: 15.010
---------------
2023-09-11 15:33:27.508917
current #epochs=12, #steps=440
start validation
acc: 0.800948
AUC: 0.929066
Avg Precision: 0.374516
Avg Recall: 1.000000
d_prime: 2.077299
train_loss: 0.048200
valid_loss: 1.019296
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001745061326804239
Epoch-12 lr: 0.003490122653608478
epoch 12 training time: 15.051
---------------
2023-09-11 15:33:42.560031
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00563	Train Loss 0.0494	
start validation
acc: 0.805687
AUC: 0.922110
Avg Precision: 0.370948
Avg Recall: 1.000000
d_prime: 2.007344
train_loss: 0.040670
valid_loss: 0.999162
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.001745061326804239
Epoch-13 lr: 0.003490122653608478
epoch 13 training time: 15.123
---------------
2023-09-11 15:33:57.683088
current #epochs=14, #steps=520
start validation
acc: 0.815166
AUC: 0.927431
Avg Precision: 0.375294
Avg Recall: 1.000000
d_prime: 2.060397
train_loss: 0.044232
valid_loss: 1.003261
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.001745061326804239
Epoch-14 lr: 0.003490122653608478
epoch 14 training time: 14.948
---------------
2023-09-11 15:34:12.631689
current #epochs=15, #steps=560
start validation
acc: 0.824645
AUC: 0.925419
Avg Precision: 0.344931
Avg Recall: 1.000000
d_prime: 2.039998
train_loss: 0.031431
valid_loss: 1.006925
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.001398940486212354
Epoch-15 lr: 0.002797880972424708
epoch 15 training time: 15.096
---------------
2023-09-11 15:34:27.727123
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03538	Per Sample Data Time 0.02849	Per Sample DNN Time 0.00689	Train Loss 0.0195	
start validation
acc: 0.819905
AUC: 0.928030
Avg Precision: 0.342534
Avg Recall: 1.000000
d_prime: 2.066559
train_loss: 0.033614
valid_loss: 0.990847
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.001398940486212354
Epoch-16 lr: 0.002797880972424708
epoch 16 training time: 15.015
---------------
2023-09-11 15:34:42.741833
current #epochs=17, #steps=640
start validation
acc: 0.815166
AUC: 0.939946
Avg Precision: 0.353429
Avg Recall: 1.000000
d_prime: 2.198147
train_loss: 0.037318
valid_loss: 0.982582
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.001398940486212354
Epoch-17 lr: 0.002797880972424708
epoch 17 training time: 15.160
---------------
2023-09-11 15:34:57.901839
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00722	Per Sample Data Time 0.00157	Per Sample DNN Time 0.00565	Train Loss 0.0289	
start validation
acc: 0.834123
AUC: 0.937381
Avg Precision: 0.379364
Avg Recall: 1.000000
d_prime: 2.168202
train_loss: 0.030074
valid_loss: 1.001955
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001398940486212354
Epoch-18 lr: 0.002797880972424708
epoch 18 training time: 17.189
---------------
2023-09-11 15:35:15.091004
current #epochs=19, #steps=720
start validation
acc: 0.829384
AUC: 0.937697
Avg Precision: 0.355002
Avg Recall: 1.000000
d_prime: 2.171848
train_loss: 0.024177
valid_loss: 0.989305
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0011214703196408625
Epoch-19 lr: 0.002242940639281725
epoch 19 training time: 15.323
---------------
2023-09-11 15:35:30.413570
current #epochs=20, #steps=760
start validation
acc: 0.829384
AUC: 0.936741
Avg Precision: 0.374559
Avg Recall: 1.000000
d_prime: 2.160885
train_loss: 0.031555
valid_loss: 0.994393
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0011214703196408625
Epoch-20 lr: 0.002242940639281725
epoch 20 training time: 16.076
---------------
2023-09-11 15:35:46.489114
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03820	Per Sample Data Time 0.02844	Per Sample DNN Time 0.00976	Train Loss 0.1003	
start validation
acc: 0.815166
AUC: 0.945703
Avg Precision: 0.435997
Avg Recall: 1.000000
d_prime: 2.269168
train_loss: 0.038797
valid_loss: 0.991053
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0011214703196408625
Epoch-21 lr: 0.002242940639281725
epoch 21 training time: 15.037
---------------
2023-09-11 15:36:01.526634
current #epochs=22, #steps=840
start validation
acc: 0.824645
AUC: 0.934054
Avg Precision: 0.373628
Avg Recall: 1.000000
d_prime: 2.130775
train_loss: 0.037695
valid_loss: 0.997825
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0011214703196408625
Epoch-22 lr: 0.002242940639281725
epoch 22 training time: 15.145
---------------
2023-09-11 15:36:16.671888
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00563	Train Loss 0.0371	
start validation
acc: 0.824645
AUC: 0.942926
Avg Precision: 0.397005
Avg Recall: 1.000000
d_prime: 2.234198
train_loss: 0.036649
valid_loss: 0.989545
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0008990344408721791
Epoch-23 lr: 0.0017980688817443582
epoch 23 training time: 14.990
---------------
2023-09-11 15:36:31.662438
current #epochs=24, #steps=920
start validation
acc: 0.838863
AUC: 0.946417
Avg Precision: 0.399460
Avg Recall: 1.000000
d_prime: 2.278382
train_loss: 0.030987
valid_loss: 0.993221
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0008990344408721791
Epoch-24 lr: 0.0017980688817443582
epoch 24 training time: 17.218
---------------
2023-09-11 15:36:48.880314
current #epochs=25, #steps=960
start validation
acc: 0.838863
AUC: 0.943115
Avg Precision: 0.375200
Avg Recall: 1.000000
d_prime: 2.236545
train_loss: 0.018398
valid_loss: 0.980603
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0008990344408721791
Epoch-25 lr: 0.0017980688817443582
epoch 25 training time: 15.244
---------------
2023-09-11 15:37:04.124036
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03813	Per Sample Data Time 0.02805	Per Sample DNN Time 0.01008	Train Loss 0.0218	
start validation
acc: 0.829384
AUC: 0.942127
Avg Precision: 0.384140
Avg Recall: 1.000000
d_prime: 2.224387
train_loss: 0.021342
valid_loss: 0.983074
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0008990344408721791
Epoch-26 lr: 0.0017980688817443582
epoch 26 training time: 15.120
---------------
2023-09-11 15:37:19.244326
current #epochs=27, #steps=1040
start validation
acc: 0.838863
AUC: 0.938088
Avg Precision: 0.391328
Avg Recall: 1.000000
d_prime: 2.176357
train_loss: 0.027355
valid_loss: 0.996282
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0007207171796870989
Epoch-27 lr: 0.0014414343593741978
epoch 27 training time: 16.287
---------------
2023-09-11 15:37:35.531776
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00567	Train Loss 0.0241	
start validation
acc: 0.843602
AUC: 0.936271
Avg Precision: 0.386393
Avg Recall: 1.000000
d_prime: 2.155549
train_loss: 0.030429
valid_loss: 0.992143
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0007207171796870989
Epoch-28 lr: 0.0014414343593741978
epoch 28 training time: 17.200
---------------
2023-09-11 15:37:52.731530
current #epochs=29, #steps=1120
start validation
acc: 0.853081
AUC: 0.939002
Avg Precision: 0.383373
Avg Recall: 1.000000
d_prime: 2.187008
train_loss: 0.031234
valid_loss: 0.988446
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0007207171796870989
Epoch-29 lr: 0.0014414343593741978
epoch 29 training time: 17.082
---------------
2023-09-11 15:38:09.813562
current #epochs=30, #steps=1160
start validation
acc: 0.819905
AUC: 0.932489
Avg Precision: 0.377305
Avg Recall: 1.000000
d_prime: 2.113670
train_loss: 0.024899
valid_loss: 0.998340
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0007207171796870989
Epoch-30 lr: 0.0014414343593741978
epoch 30 training time: 15.183
---------------
2023-09-11 15:38:24.996738
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03612	Per Sample Data Time 0.02626	Per Sample DNN Time 0.00986	Train Loss 0.0049	
start validation
acc: 0.819905
AUC: 0.935950
Avg Precision: 0.389081
Avg Recall: 1.000000
d_prime: 2.151924
train_loss: 0.024609
valid_loss: 0.995754
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0005777679135319987
Epoch-31 lr: 0.0011555358270639974
epoch 31 training time: 15.005
---------------
2023-09-11 15:38:40.001264
current #epochs=32, #steps=1240
start validation
acc: 0.819905
AUC: 0.937197
Avg Precision: 0.395413
Avg Recall: 1.000000
d_prime: 2.166091
train_loss: 0.021079
valid_loss: 0.997298
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0005777679135319987
Epoch-32 lr: 0.0011555358270639974
epoch 32 training time: 15.174
---------------
2023-09-11 15:38:55.175371
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00562	Train Loss 0.0197	
start validation
acc: 0.824645
AUC: 0.934118
Avg Precision: 0.388567
Avg Recall: 1.000000
d_prime: 2.131480
train_loss: 0.020806
valid_loss: 0.995802
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0005777679135319987
Epoch-33 lr: 0.0011555358270639974
epoch 33 training time: 15.106
---------------
2023-09-11 15:39:10.281440
current #epochs=34, #steps=1320
start validation
acc: 0.815166
AUC: 0.935364
Avg Precision: 0.383127
Avg Recall: 1.000000
d_prime: 2.145329
train_loss: 0.016515
valid_loss: 0.995856
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0005777679135319987
Epoch-34 lr: 0.0011555358270639974
epoch 34 training time: 16.863
---------------
2023-09-11 15:39:27.144230
current #epochs=35, #steps=1360
start validation
acc: 0.815166
AUC: 0.935388
Avg Precision: 0.383575
Avg Recall: 1.000000
d_prime: 2.145602
train_loss: 0.029846
valid_loss: 0.995372
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.00046317164529371437
Epoch-35 lr: 0.0009263432905874287
epoch 35 training time: 15.108
---------------
2023-09-11 15:39:42.251835
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03652	Per Sample Data Time 0.02834	Per Sample DNN Time 0.00818	Train Loss 0.0163	
start validation
acc: 0.834123
AUC: 0.933645
Avg Precision: 0.390313
Avg Recall: 1.000000
d_prime: 2.126268
train_loss: 0.025614
valid_loss: 1.003943
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.00046317164529371437
Epoch-36 lr: 0.0009263432905874287
epoch 36 training time: 15.009
---------------
2023-09-11 15:39:57.261327
current #epochs=37, #steps=1440
start validation
acc: 0.834123
AUC: 0.938029
Avg Precision: 0.402316
Avg Recall: 1.000000
d_prime: 2.175674
train_loss: 0.016304
valid_loss: 0.992886
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.00046317164529371437
Epoch-37 lr: 0.0009263432905874287
epoch 37 training time: 14.999
---------------
2023-09-11 15:40:12.260838
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00567	Train Loss 0.0156	
start validation
acc: 0.834123
AUC: 0.938624
Avg Precision: 0.396061
Avg Recall: 1.000000
d_prime: 2.182596
train_loss: 0.014664
valid_loss: 0.992202
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.00046317164529371437
Epoch-38 lr: 0.0009263432905874287
epoch 38 training time: 15.119
---------------
2023-09-11 15:40:27.379907
current #epochs=39, #steps=1520
start validation
acc: 0.824645
AUC: 0.938120
Avg Precision: 0.390328
Avg Recall: 1.000000
d_prime: 2.176729
train_loss: 0.014980
valid_loss: 0.992712
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0003713047540017209
Epoch-39 lr: 0.0007426095080034418
epoch 39 training time: 14.902
---------------
2023-09-11 15:40:42.282562
current #epochs=40, #steps=1560
start validation
acc: 0.829384
AUC: 0.937067
Avg Precision: 0.381358
Avg Recall: 1.000000
d_prime: 2.164604
train_loss: 0.021338
valid_loss: 0.989836
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0003713047540017209
Epoch-40 lr: 0.0007426095080034418
epoch 40 training time: 14.944
---------------
2023-09-11 15:40:57.226091
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03793	Per Sample Data Time 0.02735	Per Sample DNN Time 0.01059	Train Loss 0.0041	
start validation
acc: 0.815166
AUC: 0.936240
Avg Precision: 0.382087
Avg Recall: 1.000000
d_prime: 2.155199
train_loss: 0.015268
valid_loss: 0.994469
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0003713047540017209
Epoch-41 lr: 0.0007426095080034418
epoch 41 training time: 15.729
---------------
2023-09-11 15:41:12.954978
current #epochs=42, #steps=1640
start validation
acc: 0.810427
AUC: 0.936634
Avg Precision: 0.390411
Avg Recall: 1.000000
d_prime: 2.159673
train_loss: 0.021963
valid_loss: 0.993455
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0003713047540017209
Epoch-42 lr: 0.0007426095080034418
epoch 42 training time: 15.179
---------------
2023-09-11 15:41:28.134009
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00558	Train Loss 0.0202	
start validation
acc: 0.819905
AUC: 0.939289
Avg Precision: 0.377607
Avg Recall: 1.000000
d_prime: 2.190385
train_loss: 0.019811
valid_loss: 0.997684
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0002976590249967736
Epoch-43 lr: 0.0005953180499935472
epoch 43 training time: 15.026
---------------
2023-09-11 15:41:43.159794
current #epochs=44, #steps=1720
start validation
acc: 0.819905
AUC: 0.939343
Avg Precision: 0.385601
Avg Recall: 1.000000
d_prime: 2.191020
train_loss: 0.023870
valid_loss: 0.988725
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0002976590249967736
Epoch-44 lr: 0.0005953180499935472
epoch 44 training time: 15.119
---------------
2023-09-11 15:41:58.279128
current #epochs=45, #steps=1760
start validation
[I 2023-09-11 15:42:14,346] Trial 56 finished with value: 0.8530805687203792 and parameters: {'warmup': 'False', 'num_epochs': 45, 'batch_size': 64, 'lr-adaptschedule': 'True', 'lr': 0.0027153986877539236, 'head-lr': 2, 'lr-scheduler-start': 7, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.8016569187137152}. Best is trial 50 with value: 0.8815165876777251.
acc: 0.819905
AUC: 0.938597
Avg Precision: 0.376876
Avg Recall: 1.000000
d_prime: 2.182271
train_loss: 0.018477
valid_loss: 0.986877
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0002976590249967736
Epoch-45 lr: 0.0005953180499935472
epoch 45 training time: 16.058
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863efc0430>
The learning rate scheduler starts at 4 epoch with decay rate of 0.768 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 15:42:14.383696
current #epochs=1, #steps=0
start validation
acc: 0.819905
AUC: 0.923404
Avg Precision: 0.356966
Avg Recall: 1.000000
d_prime: 2.019986
train_loss: 0.088120
valid_loss: 1.011547
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003179017690556341
Epoch-1 lr: 0.006358035381112682
epoch 1 training time: 17.539
---------------
2023-09-11 15:42:31.923295
current #epochs=2, #steps=40
start validation
acc: 0.848341
AUC: 0.937804
Avg Precision: 0.334290
Avg Recall: 1.000000
d_prime: 2.173079
train_loss: 0.055026
valid_loss: 0.978528
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003179017690556341
Epoch-2 lr: 0.006358035381112682
epoch 2 training time: 18.239
---------------
2023-09-11 15:42:50.162735
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00563	Train Loss 0.0392	
start validation
acc: 0.829384
AUC: 0.918202
Avg Precision: 0.344361
Avg Recall: 1.000000
d_prime: 1.970108
train_loss: 0.044640
valid_loss: 1.014891
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003179017690556341
Epoch-3 lr: 0.006358035381112682
epoch 3 training time: 16.583
---------------
2023-09-11 15:43:06.746149
current #epochs=4, #steps=120
start validation
acc: 0.819905
AUC: 0.919221
Avg Precision: 0.367754
Avg Recall: 1.000000
d_prime: 1.979689
train_loss: 0.054035
valid_loss: 1.010354
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0024412003800292435
Epoch-4 lr: 0.004882400760058487
epoch 4 training time: 15.025
---------------
2023-09-11 15:43:21.771071
current #epochs=5, #steps=160
start validation
acc: 0.829384
AUC: 0.924311
Avg Precision: 0.390371
Avg Recall: 1.000000
d_prime: 2.028949
train_loss: 0.048279
valid_loss: 1.005577
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0018746228789975664
Epoch-5 lr: 0.003749245757995133
epoch 5 training time: 15.907
---------------
2023-09-11 15:43:37.678338
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03652	Per Sample Data Time 0.02845	Per Sample DNN Time 0.00808	Train Loss 0.0034	
start validation
acc: 0.824645
AUC: 0.934710
Avg Precision: 0.363847
Avg Recall: 1.000000
d_prime: 2.138035
train_loss: 0.027261
valid_loss: 0.986617
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.001439542188838684
Epoch-6 lr: 0.002879084377677368
epoch 6 training time: 15.067
---------------
2023-09-11 15:43:52.745626
current #epochs=7, #steps=240
start validation
acc: 0.824645
AUC: 0.938295
Avg Precision: 0.378799
Avg Recall: 1.000000
d_prime: 2.178761
train_loss: 0.030512
valid_loss: 0.981889
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0011054392521628665
Epoch-7 lr: 0.002210878504325733
epoch 7 training time: 15.135
---------------
2023-09-11 15:44:07.880607
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00561	Train Loss 0.0292	
start validation
acc: 0.815166
AUC: 0.936521
Avg Precision: 0.373439
Avg Recall: 1.000000
d_prime: 2.158382
train_loss: 0.024240
valid_loss: 0.976486
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0008488781709191956
Epoch-8 lr: 0.0016977563418383913
epoch 8 training time: 15.151
---------------
2023-09-11 15:44:23.031725
current #epochs=9, #steps=320
start validation
acc: 0.843602
AUC: 0.938383
Avg Precision: 0.373273
Avg Recall: 1.000000
d_prime: 2.179787
train_loss: 0.025542
valid_loss: 0.976754
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0006518622779616592
Epoch-9 lr: 0.0013037245559233185
epoch 9 training time: 14.921
---------------
2023-09-11 15:44:37.953305
current #epochs=10, #steps=360
start validation
acc: 0.829384
AUC: 0.937769
Avg Precision: 0.372373
Avg Recall: 1.000000
d_prime: 2.172678
train_loss: 0.028462
valid_loss: 0.985560
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0005005717474973353
Epoch-10 lr: 0.0010011434949946706
epoch 10 training time: 15.148
---------------
2023-09-11 15:44:53.101139
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03888	Per Sample Data Time 0.02840	Per Sample DNN Time 0.01048	Train Loss 0.0004	
start validation
acc: 0.819905
AUC: 0.939136
Avg Precision: 0.363781
Avg Recall: 1.000000
d_prime: 2.188585
train_loss: 0.026295
valid_loss: 0.989597
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0003843941931661737
Epoch-11 lr: 0.0007687883863323474
epoch 11 training time: 16.023
---------------
2023-09-11 15:45:09.123918
current #epochs=12, #steps=440
start validation
acc: 0.819905
AUC: 0.937896
Avg Precision: 0.363552
Avg Recall: 1.000000
d_prime: 2.174135
train_loss: 0.027310
valid_loss: 0.990298
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.000295180254336388
Epoch-12 lr: 0.000590360508672776
epoch 12 training time: 15.122
---------------
2023-09-11 15:45:24.245980
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00567	Train Loss 0.0296	
start validation
acc: 0.824645
AUC: 0.937587
Avg Precision: 0.367138
Avg Recall: 1.000000
d_prime: 2.170570
train_loss: 0.024775
valid_loss: 0.990952
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0002266719531645677
Epoch-13 lr: 0.0004533439063291354
epoch 13 training time: 15.252
---------------
2023-09-11 15:45:39.498333
current #epochs=14, #steps=520
start validation
acc: 0.834123
AUC: 0.938132
Avg Precision: 0.367847
Avg Recall: 1.000000
d_prime: 2.176874
train_loss: 0.027347
valid_loss: 0.986199
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.00017406372410292401
Epoch-14 lr: 0.00034812744820584803
epoch 14 training time: 15.340
---------------
2023-09-11 15:45:54.838404
current #epochs=15, #steps=560
start validation
acc: 0.829384
AUC: 0.939149
Avg Precision: 0.366816
Avg Recall: 1.000000
d_prime: 2.188737
train_loss: 0.019054
valid_loss: 0.984406
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0001336653239431958
Epoch-15 lr: 0.0002673306478863916
epoch 15 training time: 15.134
---------------
2023-09-11 15:46:09.972927
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03576	Per Sample Data Time 0.02822	Per Sample DNN Time 0.00754	Train Loss 0.0014	
start validation
acc: 0.824645
AUC: 0.939241
Avg Precision: 0.367203
Avg Recall: 1.000000
d_prime: 2.189816
train_loss: 0.015241
valid_loss: 0.985681
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.00010264297697247385
Epoch-16 lr: 0.0002052859539449477
epoch 16 training time: 15.017
---------------
2023-09-11 15:46:24.989938
current #epochs=17, #steps=640
start validation
acc: 0.843602
AUC: 0.939332
Avg Precision: 0.365480
Avg Recall: 1.000000
d_prime: 2.190886
train_loss: 0.026596
valid_loss: 0.987266
validation finished
normal learning rate scheduler step
Epoch-17 lr: 7.88205976760969e-05
Epoch-17 lr: 0.0001576411953521938
epoch 17 training time: 15.216
---------------
2023-09-11 15:46:40.206234
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00563	Train Loss 0.0236	
start validation
acc: 0.843602
AUC: 0.939593
Avg Precision: 0.365393
Avg Recall: 1.000000
d_prime: 2.193960
train_loss: 0.022169
valid_loss: 0.987914
validation finished
normal learning rate scheduler step
Epoch-18 lr: 6.0527147606827604e-05
Epoch-18 lr: 0.00012105429521365521
epoch 18 training time: 15.050
---------------
2023-09-11 15:46:55.256451
current #epochs=19, #steps=720
start validation
acc: 0.843602
AUC: 0.939642
Avg Precision: 0.367640
Avg Recall: 1.000000
d_prime: 2.194542
train_loss: 0.020641
valid_loss: 0.988859
validation finished
normal learning rate scheduler step
Epoch-19 lr: 4.6479419154794085e-05
Epoch-19 lr: 9.295883830958817e-05
epoch 19 training time: 15.086
---------------
2023-09-11 15:47:10.342669
current #epochs=20, #steps=760
start validation
acc: 0.838863
AUC: 0.939626
Avg Precision: 0.369679
Avg Recall: 1.000000
d_prime: 2.194356
train_loss: 0.029115
valid_loss: 0.988945
validation finished
normal learning rate scheduler step
Epoch-20 lr: 3.569202399888655e-05
Epoch-20 lr: 7.13840479977731e-05
epoch 20 training time: 15.076
---------------
2023-09-11 15:47:25.418787
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03557	Per Sample Data Time 0.02825	Per Sample DNN Time 0.00732	Train Loss 0.0101	
start validation
acc: 0.834123
AUC: 0.939605
Avg Precision: 0.369842
Avg Recall: 1.000000
d_prime: 2.194100
train_loss: 0.020443
valid_loss: 0.988388
validation finished
normal learning rate scheduler step
Epoch-21 lr: 2.7408272312837104e-05
Epoch-21 lr: 5.481654462567421e-05
epoch 21 training time: 15.046
---------------
2023-09-11 15:47:40.464124
current #epochs=22, #steps=840
start validation
acc: 0.834123
AUC: 0.939852
Avg Precision: 0.370678
Avg Recall: 1.000000
d_prime: 2.197025
train_loss: 0.020921
valid_loss: 0.988066
validation finished
normal learning rate scheduler step
Epoch-22 lr: 2.1047094196677328e-05
Epoch-22 lr: 4.2094188393354655e-05
epoch 22 training time: 16.342
---------------
2023-09-11 15:47:56.806519
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00567	Train Loss 0.0210	
start validation
acc: 0.834123
AUC: 0.939986
Avg Precision: 0.370841
Avg Recall: 1.000000
d_prime: 2.198610
train_loss: 0.022538
valid_loss: 0.987583
validation finished
normal learning rate scheduler step
Epoch-23 lr: 1.6162280098053887e-05
Epoch-23 lr: 3.2324560196107774e-05
epoch 23 training time: 15.340
---------------
2023-09-11 15:48:12.146032
current #epochs=24, #steps=920
start validation
acc: 0.834123
AUC: 0.939863
Avg Precision: 0.372274
Avg Recall: 1.000000
d_prime: 2.197153
train_loss: 0.022208
valid_loss: 0.987626
validation finished
normal learning rate scheduler step
Epoch-24 lr: 1.2411181112554104e-05
Epoch-24 lr: 2.482236222510821e-05
epoch 24 training time: 15.037
---------------
2023-09-11 15:48:27.183989
current #epochs=25, #steps=960
start validation
acc: 0.834123
AUC: 0.940006
Avg Precision: 0.373798
Avg Recall: 1.000000
d_prime: 2.198849
train_loss: 0.039547
valid_loss: 0.987446
validation finished
normal learning rate scheduler step
Epoch-25 lr: 9.530673622415905e-06
Epoch-25 lr: 1.906134724483181e-05
epoch 25 training time: 14.964
---------------
2023-09-11 15:48:42.147716
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03875	Per Sample Data Time 0.02945	Per Sample DNN Time 0.00930	Train Loss 0.0098	
start validation
acc: 0.829384
AUC: 0.940108
Avg Precision: 0.374667
Avg Recall: 1.000000
d_prime: 2.200070
train_loss: 0.023415
valid_loss: 0.987305
validation finished
normal learning rate scheduler step
Epoch-26 lr: 7.318702295395122e-06
Epoch-26 lr: 1.4637404590790243e-05
epoch 26 training time: 15.979
---------------
2023-09-11 15:48:58.127038
current #epochs=27, #steps=1040
start validation
acc: 0.829384
AUC: 0.940060
Avg Precision: 0.374667
Avg Recall: 1.000000
d_prime: 2.199494
train_loss: 0.023113
valid_loss: 0.987248
validation finished
normal learning rate scheduler step
Epoch-27 lr: 5.620106763769777e-06
Epoch-27 lr: 1.1240213527539553e-05
epoch 27 training time: 16.384
---------------
2023-09-11 15:49:14.510580
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00562	Train Loss 0.0128	
start validation
acc: 0.829384
AUC: 0.939957
Avg Precision: 0.373637
Avg Recall: 1.000000
d_prime: 2.198274
train_loss: 0.018061
valid_loss: 0.987267
validation finished
normal learning rate scheduler step
Epoch-28 lr: 4.315737785378187e-06
Epoch-28 lr: 8.631475570756374e-06
epoch 28 training time: 15.500
---------------
2023-09-11 15:49:30.010943
current #epochs=29, #steps=1120
start validation
acc: 0.829384
AUC: 0.940020
Avg Precision: 0.374667
Avg Recall: 1.000000
d_prime: 2.199018
train_loss: 0.022078
valid_loss: 0.987250
validation finished
normal learning rate scheduler step
Epoch-29 lr: 3.3140994317423963e-06
Epoch-29 lr: 6.628198863484793e-06
epoch 29 training time: 15.093
---------------
2023-09-11 15:49:45.104294
current #epochs=30, #steps=1160
start validation
acc: 0.829384
AUC: 0.939979
Avg Precision: 0.373798
Avg Recall: 1.000000
d_prime: 2.198536
train_loss: 0.020460
valid_loss: 0.987226
validation finished
normal learning rate scheduler step
Epoch-30 lr: 2.544931038370028e-06
Epoch-30 lr: 5.089862076740056e-06
epoch 30 training time: 15.020
---------------
2023-09-11 15:50:00.124324
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03713	Per Sample Data Time 0.02970	Per Sample DNN Time 0.00743	Train Loss 0.0017	
start validation
acc: 0.829384
AUC: 0.939942
Avg Precision: 0.372697
Avg Recall: 1.000000
d_prime: 2.198095
train_loss: 0.021320
valid_loss: 0.987245
validation finished
normal learning rate scheduler step
Epoch-31 lr: 1.954278718382937e-06
Epoch-31 lr: 3.908557436765874e-06
epoch 31 training time: 15.057
---------------
2023-09-11 15:50:15.181638
current #epochs=32, #steps=1240
start validation
acc: 0.834123
AUC: 0.939965
Avg Precision: 0.372697
Avg Recall: 1.000000
d_prime: 2.198362
train_loss: 0.026132
valid_loss: 0.987239
validation finished
normal learning rate scheduler step
Epoch-32 lr: 1.500710727144328e-06
Epoch-32 lr: 3.001421454288656e-06
epoch 32 training time: 15.068
---------------
2023-09-11 15:50:30.249342
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00564	Train Loss 0.0329	
start validation
acc: 0.834123
AUC: 0.939942
Avg Precision: 0.371610
Avg Recall: 1.000000
d_prime: 2.198095
train_loss: 0.027191
valid_loss: 0.987228
validation finished
normal learning rate scheduler step
Epoch-33 lr: 1.1524112018318345e-06
Epoch-33 lr: 2.304822403663669e-06
epoch 33 training time: 15.041
---------------
2023-09-11 15:50:45.289715
current #epochs=34, #steps=1320
start validation
acc: 0.834123
AUC: 0.939968
Avg Precision: 0.372641
Avg Recall: 1.000000
d_prime: 2.198402
train_loss: 0.022672
valid_loss: 0.987234
validation finished
normal learning rate scheduler step
Epoch-34 lr: 8.849484141654772e-07
Epoch-34 lr: 1.7698968283309543e-06
epoch 34 training time: 17.057
---------------
2023-09-11 15:51:02.346665
current #epochs=35, #steps=1360
start validation
acc: 0.834123
AUC: 0.939968
Avg Precision: 0.372641
Avg Recall: 1.000000
d_prime: 2.198402
train_loss: 0.019532
valid_loss: 0.987227
validation finished
normal learning rate scheduler step
Epoch-35 lr: 6.795609887244671e-07
Epoch-35 lr: 1.3591219774489343e-06
epoch 35 training time: 16.607
---------------
2023-09-11 15:51:18.953516
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03687	Per Sample Data Time 0.02893	Per Sample DNN Time 0.00795	Train Loss 0.0001	
start validation
acc: 0.834123
AUC: 0.939968
Avg Precision: 0.372641
Avg Recall: 1.000000
d_prime: 2.198402
train_loss: 0.024523
valid_loss: 0.987226
validation finished
normal learning rate scheduler step
Epoch-36 lr: 5.218418723668365e-07
Epoch-36 lr: 1.043683744733673e-06
epoch 36 training time: 15.101
---------------
2023-09-11 15:51:34.054234
current #epochs=37, #steps=1440
start validation
acc: 0.834123
AUC: 0.939968
Avg Precision: 0.372641
Avg Recall: 1.000000
d_prime: 2.198402
train_loss: 0.020697
valid_loss: 0.987217
validation finished
normal learning rate scheduler step
Epoch-37 lr: 4.0072774081170714e-07
Epoch-37 lr: 8.014554816234143e-07
epoch 37 training time: 14.966
---------------
2023-09-11 15:51:49.020675
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00563	Train Loss 0.0370	
start validation
acc: 0.834123
AUC: 0.939968
Avg Precision: 0.372641
Avg Recall: 1.000000
d_prime: 2.198402
train_loss: 0.028539
valid_loss: 0.987222
validation finished
normal learning rate scheduler step
Epoch-38 lr: 3.0772295356009823e-07
Epoch-38 lr: 6.154459071201965e-07
epoch 38 training time: 15.904
---------------
2023-09-11 15:52:04.924378
current #epochs=39, #steps=1520
start validation
acc: 0.834123
AUC: 0.939968
Avg Precision: 0.372641
Avg Recall: 1.000000
d_prime: 2.198402
train_loss: 0.024359
valid_loss: 0.987223
validation finished
normal learning rate scheduler step
Epoch-39 lr: 2.3630362089717332e-07
Epoch-39 lr: 4.7260724179434664e-07
epoch 39 training time: 15.065
---------------
2023-09-11 15:52:19.989479
current #epochs=40, #steps=1560
start validation
acc: 0.834123
AUC: 0.939968
Avg Precision: 0.372641
Avg Recall: 1.000000
d_prime: 2.198402
train_loss: 0.020975
valid_loss: 0.987223
validation finished
normal learning rate scheduler step
Epoch-40 lr: 1.8145998081423453e-07
Epoch-40 lr: 3.6291996162846905e-07
epoch 40 training time: 14.973
---------------
2023-09-11 15:52:34.962663
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03888	Per Sample Data Time 0.02905	Per Sample DNN Time 0.00983	Train Loss 0.0696	
start validation
[I 2023-09-11 15:52:50,118] Trial 57 finished with value: 0.8483412322274881 and parameters: {'warmup': 'False', 'num_epochs': 41, 'batch_size': 54, 'lr-adaptschedule': 'True', 'lr': 0.003179017690556341, 'head-lr': 2, 'lr-scheduler-start': 4, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.767910284765362}. Best is trial 50 with value: 0.8815165876777251.
acc: 0.834123
AUC: 0.939968
Avg Precision: 0.372641
Avg Recall: 1.000000
d_prime: 2.198402
train_loss: 0.023215
valid_loss: 0.987223
validation finished
normal learning rate scheduler step
Epoch-41 lr: 1.3934498554057596e-07
Epoch-41 lr: 2.786899710811519e-07
epoch 41 training time: 15.145
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f85b4070af0>
The learning rate scheduler starts at 5 epoch with decay rate of 0.781 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 15:52:50.155524
current #epochs=1, #steps=0
start validation
acc: 0.824645
AUC: 0.940379
Avg Precision: 0.421856
Avg Recall: 1.000000
d_prime: 2.203287
train_loss: 0.063689
valid_loss: 0.966462
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002924200182158528
Epoch-1 lr: 0.002924200182158528
epoch 1 training time: 17.016
---------------
2023-09-11 15:53:07.172533
current #epochs=2, #steps=40
start validation
acc: 0.819905
AUC: 0.938680
Avg Precision: 0.343506
Avg Recall: 1.000000
d_prime: 2.183241
train_loss: 0.054024
valid_loss: 0.999320
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002924200182158528
Epoch-2 lr: 0.002924200182158528
epoch 2 training time: 14.927
---------------
2023-09-11 15:53:22.099778
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00562	Train Loss 0.0515	
start validation
acc: 0.815166
AUC: 0.925339
Avg Precision: 0.330753
Avg Recall: 1.000000
d_prime: 2.039199
train_loss: 0.058998
valid_loss: 1.002533
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002924200182158528
Epoch-3 lr: 0.002924200182158528
epoch 3 training time: 15.129
---------------
2023-09-11 15:53:37.228551
current #epochs=4, #steps=120
start validation
acc: 0.815166
AUC: 0.919704
Avg Precision: 0.325163
Avg Recall: 1.000000
d_prime: 1.984263
train_loss: 0.045594
valid_loss: 1.002896
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002924200182158528
Epoch-4 lr: 0.002924200182158528
epoch 4 training time: 15.104
---------------
2023-09-11 15:53:52.332128
current #epochs=5, #steps=160
start validation
acc: 0.824645
AUC: 0.929945
Avg Precision: 0.341150
Avg Recall: 1.000000
d_prime: 2.086506
train_loss: 0.056693
valid_loss: 1.000922
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002283552647552705
Epoch-5 lr: 0.002283552647552705
epoch 5 training time: 15.041
---------------
2023-09-11 15:54:07.373481
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03649	Per Sample Data Time 0.02825	Per Sample DNN Time 0.00824	Train Loss 0.0053	
start validation
acc: 0.834123
AUC: 0.923668
Avg Precision: 0.354369
Avg Recall: 1.000000
d_prime: 2.022588
train_loss: 0.057489
valid_loss: 1.007262
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002283552647552705
Epoch-6 lr: 0.002283552647552705
epoch 6 training time: 17.126
---------------
2023-09-11 15:54:24.499295
current #epochs=7, #steps=240
start validation
acc: 0.838863
AUC: 0.940202
Avg Precision: 0.390568
Avg Recall: 1.000000
d_prime: 2.201182
train_loss: 0.050801
valid_loss: 0.994328
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002283552647552705
Epoch-7 lr: 0.002283552647552705
epoch 7 training time: 18.391
---------------
2023-09-11 15:54:42.890270
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00567	Train Loss 0.0285	
start validation
acc: 0.838863
AUC: 0.937075
Avg Precision: 0.366131
Avg Recall: 1.000000
d_prime: 2.164705
train_loss: 0.037335
valid_loss: 0.988805
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.002283552647552705
Epoch-8 lr: 0.002283552647552705
epoch 8 training time: 15.252
---------------
2023-09-11 15:54:58.142004
current #epochs=9, #steps=320
start validation
acc: 0.829384
AUC: 0.940123
Avg Precision: 0.385107
Avg Recall: 1.000000
d_prime: 2.200240
train_loss: 0.037642
valid_loss: 0.991855
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.002283552647552705
Epoch-9 lr: 0.002283552647552705
epoch 9 training time: 15.150
---------------
2023-09-11 15:55:13.292638
current #epochs=10, #steps=360
start validation
acc: 0.824645
AUC: 0.936661
Avg Precision: 0.374971
Avg Recall: 1.000000
d_prime: 2.159975
train_loss: 0.034061
valid_loss: 0.990185
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.002283552647552705
Epoch-10 lr: 0.002283552647552705
epoch 10 training time: 15.901
---------------
2023-09-11 15:55:29.193129
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03760	Per Sample Data Time 0.02958	Per Sample DNN Time 0.00802	Train Loss 0.0249	
start validation
acc: 0.829384
AUC: 0.923581
Avg Precision: 0.369032
Avg Recall: 1.000000
d_prime: 2.021733
train_loss: 0.061286
valid_loss: 1.001137
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.002283552647552705
Epoch-11 lr: 0.002283552647552705
epoch 11 training time: 15.135
---------------
2023-09-11 15:55:44.328763
current #epochs=12, #steps=440
start validation
acc: 0.800948
AUC: 0.930228
Avg Precision: 0.350264
Avg Recall: 1.000000
d_prime: 2.089488
train_loss: 0.057025
valid_loss: 1.008643
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.002283552647552705
Epoch-12 lr: 0.002283552647552705
epoch 12 training time: 15.117
---------------
2023-09-11 15:55:59.445642
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00568	Train Loss 0.0369	
start validation
acc: 0.824645
AUC: 0.922712
Avg Precision: 0.351946
Avg Recall: 1.000000
d_prime: 2.013208
train_loss: 0.042550
valid_loss: 1.020257
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.002283552647552705
Epoch-13 lr: 0.002283552647552705
epoch 13 training time: 15.103
---------------
2023-09-11 15:56:14.548508
current #epochs=14, #steps=520
start validation
acc: 0.829384
AUC: 0.928421
Avg Precision: 0.326474
Avg Recall: 1.000000
d_prime: 2.070595
train_loss: 0.034496
valid_loss: 1.006112
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0017832611891487363
Epoch-14 lr: 0.0017832611891487363
epoch 14 training time: 15.026
---------------
2023-09-11 15:56:29.574085
current #epochs=15, #steps=560
start validation
acc: 0.838863
AUC: 0.924344
Avg Precision: 0.339752
Avg Recall: 1.000000
d_prime: 2.029276
train_loss: 0.038767
valid_loss: 1.002649
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0017832611891487363
Epoch-15 lr: 0.0017832611891487363
epoch 15 training time: 16.109
---------------
2023-09-11 15:56:45.682687
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03858	Per Sample Data Time 0.02865	Per Sample DNN Time 0.00993	Train Loss 0.0159	
start validation
acc: 0.829384
AUC: 0.922363
Avg Precision: 0.333030
Avg Recall: 1.000000
d_prime: 2.009808
train_loss: 0.035553
valid_loss: 1.010620
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0017832611891487363
Epoch-16 lr: 0.0017832611891487363
epoch 16 training time: 15.030
---------------
2023-09-11 15:57:00.712494
current #epochs=17, #steps=640
start validation
acc: 0.824645
AUC: 0.925969
Avg Precision: 0.348016
Avg Recall: 1.000000
d_prime: 2.045537
train_loss: 0.035335
valid_loss: 1.000046
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0017832611891487363
Epoch-17 lr: 0.0017832611891487363
epoch 17 training time: 16.579
---------------
2023-09-11 15:57:17.290903
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00700	Per Sample Data Time 0.00142	Per Sample DNN Time 0.00559	Train Loss 0.0310	
start validation
acc: 0.810427
AUC: 0.924247
Avg Precision: 0.358707
Avg Recall: 1.000000
d_prime: 2.028309
train_loss: 0.033445
valid_loss: 1.009548
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0017832611891487363
Epoch-18 lr: 0.0017832611891487363
epoch 18 training time: 14.939
---------------
2023-09-11 15:57:32.229663
current #epochs=19, #steps=720
start validation
acc: 0.815166
AUC: 0.928216
Avg Precision: 0.360441
Avg Recall: 1.000000
d_prime: 2.068473
train_loss: 0.040981
valid_loss: 1.005449
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0017832611891487363
Epoch-19 lr: 0.0017832611891487363
epoch 19 training time: 15.058
---------------
2023-09-11 15:57:47.288004
current #epochs=20, #steps=760
start validation
acc: 0.824645
AUC: 0.927276
Avg Precision: 0.341172
Avg Recall: 1.000000
d_prime: 2.058809
train_loss: 0.040965
valid_loss: 1.009719
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0017832611891487363
Epoch-20 lr: 0.0017832611891487363
epoch 20 training time: 15.897
---------------
2023-09-11 15:58:03.184751
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03656	Per Sample Data Time 0.02806	Per Sample DNN Time 0.00850	Train Loss 0.0167	
start validation
acc: 0.829384
AUC: 0.935557
Avg Precision: 0.364633
Avg Recall: 1.000000
d_prime: 2.147502
train_loss: 0.025093
valid_loss: 0.983272
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0017832611891487363
Epoch-21 lr: 0.0017832611891487363
epoch 21 training time: 15.002
---------------
2023-09-11 15:58:18.186633
current #epochs=22, #steps=840
start validation
acc: 0.829384
AUC: 0.922680
Avg Precision: 0.348186
Avg Recall: 1.000000
d_prime: 2.012895
train_loss: 0.029394
valid_loss: 1.010337
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0017832611891487363
Epoch-22 lr: 0.0017832611891487363
epoch 22 training time: 15.054
---------------
2023-09-11 15:58:33.241396
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00564	Train Loss 0.0414	
start validation
acc: 0.824645
AUC: 0.924560
Avg Precision: 0.303139
Avg Recall: 1.000000
d_prime: 2.031423
train_loss: 0.044860
valid_loss: 1.006125
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0013925759373808217
Epoch-23 lr: 0.0013925759373808217
epoch 23 training time: 15.108
---------------
2023-09-11 15:58:48.349593
current #epochs=24, #steps=920
start validation
acc: 0.843602
AUC: 0.929991
Avg Precision: 0.343851
Avg Recall: 1.000000
d_prime: 2.086987
train_loss: 0.037654
valid_loss: 1.008006
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0013925759373808217
Epoch-24 lr: 0.0013925759373808217
epoch 24 training time: 19.151
---------------
2023-09-11 15:59:07.501103
current #epochs=25, #steps=960
start validation
acc: 0.829384
AUC: 0.935068
Avg Precision: 0.365902
Avg Recall: 1.000000
d_prime: 2.142025
train_loss: 0.018767
valid_loss: 1.000414
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0013925759373808217
Epoch-25 lr: 0.0013925759373808217
epoch 25 training time: 15.867
---------------
2023-09-11 15:59:23.367806
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03537	Per Sample Data Time 0.02812	Per Sample DNN Time 0.00725	Train Loss 0.0194	
start validation
acc: 0.815166
AUC: 0.941121
Avg Precision: 0.389545
Avg Recall: 1.000000
d_prime: 2.212189
train_loss: 0.031820
valid_loss: 0.992418
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0013925759373808217
Epoch-26 lr: 0.0013925759373808217
epoch 26 training time: 14.921
---------------
2023-09-11 15:59:38.288701
current #epochs=27, #steps=1040
start validation
acc: 0.843602
AUC: 0.935609
Avg Precision: 0.352675
Avg Recall: 1.000000
d_prime: 2.148084
train_loss: 0.029396
valid_loss: 0.993606
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0013925759373808217
Epoch-27 lr: 0.0013925759373808217
epoch 27 training time: 15.139
---------------
2023-09-11 15:59:53.427357
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00566	Train Loss 0.0260	
start validation
acc: 0.819905
AUC: 0.929398
Avg Precision: 0.341770
Avg Recall: 1.000000
d_prime: 2.080760
train_loss: 0.020455
valid_loss: 0.993907
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0013925759373808217
Epoch-28 lr: 0.0013925759373808217
epoch 28 training time: 15.047
---------------
2023-09-11 16:00:08.474641
current #epochs=29, #steps=1120
start validation
acc: 0.824645
AUC: 0.929654
Avg Precision: 0.347012
Avg Recall: 1.000000
d_prime: 2.083441
train_loss: 0.037016
valid_loss: 1.003248
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0013925759373808217
Epoch-29 lr: 0.0013925759373808217
epoch 29 training time: 14.997
---------------
2023-09-11 16:00:23.471844
current #epochs=30, #steps=1160
start validation
acc: 0.834123
AUC: 0.942981
Avg Precision: 0.357868
Avg Recall: 1.000000
d_prime: 2.234878
train_loss: 0.034704
valid_loss: 0.990356
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0013925759373808217
Epoch-30 lr: 0.0013925759373808217
epoch 30 training time: 15.997
---------------
2023-09-11 16:00:39.469010
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03973	Per Sample Data Time 0.02820	Per Sample DNN Time 0.01154	Train Loss 0.0852	
start validation
acc: 0.843602
AUC: 0.932051
Avg Precision: 0.354558
Avg Recall: 1.000000
d_prime: 2.108929
train_loss: 0.038082
valid_loss: 1.004057
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0013925759373808217
Epoch-31 lr: 0.0013925759373808217
epoch 31 training time: 15.156
---------------
2023-09-11 16:00:54.625367
current #epochs=32, #steps=1240
start validation
acc: 0.853081
AUC: 0.927717
Avg Precision: 0.365182
Avg Recall: 1.000000
d_prime: 2.063334
train_loss: 0.019884
valid_loss: 1.012484
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0010874838487893127
Epoch-32 lr: 0.0010874838487893127
epoch 32 training time: 17.127
---------------
2023-09-11 16:01:11.752518
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00567	Train Loss 0.0220	
start validation
acc: 0.838863
AUC: 0.933614
Avg Precision: 0.368544
Avg Recall: 1.000000
d_prime: 2.125930
train_loss: 0.024684
valid_loss: 1.010684
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0010874838487893127
Epoch-33 lr: 0.0010874838487893127
epoch 33 training time: 15.041
---------------
2023-09-11 16:01:26.794462
current #epochs=34, #steps=1320
start validation
acc: 0.819905
AUC: 0.934839
Avg Precision: 0.370359
Avg Recall: 1.000000
d_prime: 2.139467
train_loss: 0.026470
valid_loss: 0.999614
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0010874838487893127
Epoch-34 lr: 0.0010874838487893127
epoch 34 training time: 15.801
---------------
2023-09-11 16:01:42.595204
current #epochs=35, #steps=1360
start validation
acc: 0.834123
AUC: 0.938037
Avg Precision: 0.355350
Avg Recall: 1.000000
d_prime: 2.175771
train_loss: 0.032587
valid_loss: 0.989519
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0010874838487893127
Epoch-35 lr: 0.0010874838487893127
epoch 35 training time: 15.225
---------------
2023-09-11 16:01:57.820184
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03901	Per Sample Data Time 0.02906	Per Sample DNN Time 0.00994	Train Loss 0.0017	
start validation
acc: 0.843602
AUC: 0.936678
Avg Precision: 0.364059
Avg Recall: 1.000000
d_prime: 2.160172
train_loss: 0.048473
valid_loss: 0.989723
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0010874838487893127
Epoch-36 lr: 0.0010874838487893127
epoch 36 training time: 15.138
---------------
2023-09-11 16:02:12.958363
current #epochs=37, #steps=1440
start validation
acc: 0.824645
AUC: 0.928206
Avg Precision: 0.354360
Avg Recall: 1.000000
d_prime: 2.068367
train_loss: 0.038857
valid_loss: 0.998878
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0010874838487893127
Epoch-37 lr: 0.0010874838487893127
epoch 37 training time: 15.049
---------------
2023-09-11 16:02:28.006917
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00563	Train Loss 0.0240	
start validation
acc: 0.829384
AUC: 0.931678
Avg Precision: 0.358336
Avg Recall: 1.000000
d_prime: 2.104924
train_loss: 0.026873
valid_loss: 0.986060
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0010874838487893127
Epoch-38 lr: 0.0010874838487893127
epoch 38 training time: 16.002
---------------
2023-09-11 16:02:44.009325
current #epochs=39, #steps=1520
start validation
acc: 0.824645
AUC: 0.930949
Avg Precision: 0.361116
Avg Recall: 1.000000
d_prime: 2.097135
train_loss: 0.022746
valid_loss: 0.989218
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0010874838487893127
Epoch-39 lr: 0.0010874838487893127
epoch 39 training time: 15.107
---------------
2023-09-11 16:02:59.115855
current #epochs=40, #steps=1560
start validation
acc: 0.843602
AUC: 0.929273
Avg Precision: 0.365985
Avg Recall: 1.000000
d_prime: 2.079460
train_loss: 0.027445
valid_loss: 0.992890
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0010874838487893127
Epoch-40 lr: 0.0010874838487893127
epoch 40 training time: 15.135
---------------
2023-09-11 16:03:14.251321
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03654	Per Sample Data Time 0.02851	Per Sample DNN Time 0.00804	Train Loss 0.0970	
start validation
acc: 0.824645
AUC: 0.929250
Avg Precision: 0.356815
Avg Recall: 1.000000
d_prime: 2.079215
train_loss: 0.032744
valid_loss: 0.986927
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0008492327704598348
Epoch-41 lr: 0.0008492327704598348
epoch 41 training time: 15.431
---------------
2023-09-11 16:03:29.681729
current #epochs=42, #steps=1640
start validation
acc: 0.853081
AUC: 0.929684
Avg Precision: 0.343603
Avg Recall: 1.000000
d_prime: 2.083757
train_loss: 0.036846
valid_loss: 0.987732
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0008492327704598348
Epoch-42 lr: 0.0008492327704598348
epoch 42 training time: 15.103
---------------
2023-09-11 16:03:44.784873
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00558	Train Loss 0.0338	
start validation
acc: 0.838863
AUC: 0.928448
Avg Precision: 0.367620
Avg Recall: 1.000000
d_prime: 2.070879
train_loss: 0.026733
valid_loss: 0.984674
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0008492327704598348
Epoch-43 lr: 0.0008492327704598348
epoch 43 training time: 15.032
---------------
2023-09-11 16:03:59.817117
current #epochs=44, #steps=1720
start validation
acc: 0.819905
AUC: 0.929013
Avg Precision: 0.361951
Avg Recall: 1.000000
d_prime: 2.076746
train_loss: 0.019840
valid_loss: 0.989997
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0008492327704598348
Epoch-44 lr: 0.0008492327704598348
epoch 44 training time: 15.049
---------------
2023-09-11 16:04:14.866544
current #epochs=45, #steps=1760
start validation
acc: 0.843602
AUC: 0.925509
Avg Precision: 0.351316
Avg Recall: 1.000000
d_prime: 2.040906
train_loss: 0.021462
valid_loss: 0.987320
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0008492327704598348
Epoch-45 lr: 0.0008492327704598348
epoch 45 training time: 15.110
---------------
2023-09-11 16:04:29.976529
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03562	Per Sample Data Time 0.02866	Per Sample DNN Time 0.00696	Train Loss 0.0015	
start validation
acc: 0.834123
AUC: 0.933189
Avg Precision: 0.354170
Avg Recall: 1.000000
d_prime: 2.121274
train_loss: 0.023990
valid_loss: 0.991551
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.0008492327704598348
Epoch-46 lr: 0.0008492327704598348
epoch 46 training time: 15.017
---------------
2023-09-11 16:04:44.993436
current #epochs=47, #steps=1840
start validation
[I 2023-09-11 16:05:01,185] Trial 58 finished with value: 0.8530805687203792 and parameters: {'warmup': 'False', 'num_epochs': 47, 'batch_size': 57, 'lr-adaptschedule': 'True', 'lr': 0.002924200182158528, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.7809152948848657}. Best is trial 50 with value: 0.8815165876777251.
acc: 0.824645
AUC: 0.932515
Avg Precision: 0.353437
Avg Recall: 1.000000
d_prime: 2.113950
train_loss: 0.022246
valid_loss: 0.973110
validation finished
normal learning rate scheduler step
Epoch-47 lr: 0.0008492327704598348
Epoch-47 lr: 0.0008492327704598348
epoch 47 training time: 16.180
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863ef9a0a0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.751 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 16:05:01.221911
current #epochs=1, #steps=0
start validation
acc: 0.805687
AUC: 0.925599
Avg Precision: 0.310597
Avg Recall: 1.000000
d_prime: 2.041807
train_loss: 0.063919
valid_loss: 0.986533
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0035324986653354666
Epoch-1 lr: 0.0035324986653354666
epoch 1 training time: 17.272
---------------
2023-09-11 16:05:18.494264
current #epochs=2, #steps=40
start validation
acc: 0.824645
AUC: 0.911923
Avg Precision: 0.316768
Avg Recall: 1.000000
d_prime: 1.912999
train_loss: 0.069771
valid_loss: 1.018871
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0035324986653354666
Epoch-2 lr: 0.0035324986653354666
epoch 2 training time: 16.995
---------------
2023-09-11 16:05:35.489417
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00559	Train Loss 0.0754	
start validation
acc: 0.800948
AUC: 0.913109
Avg Precision: 0.343341
Avg Recall: 1.000000
d_prime: 1.923544
train_loss: 0.075235
valid_loss: 1.013836
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0035324986653354666
Epoch-3 lr: 0.0035324986653354666
epoch 3 training time: 15.186
---------------
2023-09-11 16:05:50.675438
current #epochs=4, #steps=120
start validation
acc: 0.819905
AUC: 0.922849
Avg Precision: 0.337322
Avg Recall: 1.000000
d_prime: 2.014545
train_loss: 0.064764
valid_loss: 1.003923
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0035324986653354666
Epoch-4 lr: 0.0035324986653354666
epoch 4 training time: 15.003
---------------
2023-09-11 16:06:05.678460
current #epochs=5, #steps=160
start validation
acc: 0.834123
AUC: 0.936797
Avg Precision: 0.392379
Avg Recall: 1.000000
d_prime: 2.161525
train_loss: 0.048125
valid_loss: 0.984559
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0035324986653354666
Epoch-5 lr: 0.0035324986653354666
epoch 5 training time: 17.117
---------------
2023-09-11 16:06:22.795521
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03889	Per Sample Data Time 0.02874	Per Sample DNN Time 0.01014	Train Loss 0.0594	
start validation
acc: 0.810427
AUC: 0.925865
Avg Precision: 0.373633
Avg Recall: 1.000000
d_prime: 2.044490
train_loss: 0.063456
valid_loss: 1.020847
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002652989724040255
Epoch-6 lr: 0.002652989724040255
epoch 6 training time: 15.221
---------------
2023-09-11 16:06:38.016994
current #epochs=7, #steps=240
start validation
acc: 0.767773
AUC: 0.930910
Avg Precision: 0.356353
Avg Recall: 1.000000
d_prime: 2.096716
train_loss: 0.050635
valid_loss: 1.030609
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002652989724040255
Epoch-7 lr: 0.002652989724040255
epoch 7 training time: 15.026
---------------
2023-09-11 16:06:53.043266
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00732	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00582	Train Loss 0.0582	
start validation
acc: 0.843602
AUC: 0.935333
Avg Precision: 0.381703
Avg Recall: 1.000000
d_prime: 2.144981
train_loss: 0.054290
valid_loss: 0.987015
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001992457787721424
Epoch-8 lr: 0.001992457787721424
epoch 8 training time: 17.271
---------------
2023-09-11 16:07:10.314151
current #epochs=9, #steps=320
start validation
acc: 0.819905
AUC: 0.929091
Avg Precision: 0.346184
Avg Recall: 1.000000
d_prime: 2.077561
train_loss: 0.037883
valid_loss: 1.013140
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001992457787721424
Epoch-9 lr: 0.001992457787721424
epoch 9 training time: 15.295
---------------
2023-09-11 16:07:25.609538
current #epochs=10, #steps=360
start validation
acc: 0.829384
AUC: 0.918585
Avg Precision: 0.346678
Avg Recall: 1.000000
d_prime: 1.973701
train_loss: 0.044427
valid_loss: 1.022779
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0014963827412817808
Epoch-10 lr: 0.0014963827412817808
epoch 10 training time: 15.019
---------------
2023-09-11 16:07:40.628755
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03790	Per Sample Data Time 0.02684	Per Sample DNN Time 0.01106	Train Loss 0.0099	
start validation
acc: 0.819905
AUC: 0.934851
Avg Precision: 0.378308
Avg Recall: 1.000000
d_prime: 2.139602
train_loss: 0.037806
valid_loss: 1.013874
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0014963827412817808
Epoch-11 lr: 0.0014963827412817808
epoch 11 training time: 15.078
---------------
2023-09-11 16:07:55.707017
current #epochs=12, #steps=440
start validation
acc: 0.815166
AUC: 0.936393
Avg Precision: 0.371399
Avg Recall: 1.000000
d_prime: 2.156929
train_loss: 0.038677
valid_loss: 1.008440
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0011238186937785432
Epoch-12 lr: 0.0011238186937785432
epoch 12 training time: 15.032
---------------
2023-09-11 16:08:10.739003
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00561	Train Loss 0.0410	
start validation
acc: 0.829384
AUC: 0.931080
Avg Precision: 0.347182
Avg Recall: 1.000000
d_prime: 2.098532
train_loss: 0.032358
valid_loss: 1.012506
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0011238186937785432
Epoch-13 lr: 0.0011238186937785432
epoch 13 training time: 15.050
---------------
2023-09-11 16:08:25.788786
current #epochs=14, #steps=520
start validation
acc: 0.819905
AUC: 0.937570
Avg Precision: 0.372803
Avg Recall: 1.000000
d_prime: 2.170378
train_loss: 0.031370
valid_loss: 0.999755
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.000844014316420323
Epoch-14 lr: 0.000844014316420323
epoch 14 training time: 14.996
---------------
2023-09-11 16:08:40.784493
current #epochs=15, #steps=560
start validation
acc: 0.824645
AUC: 0.936586
Avg Precision: 0.368734
Avg Recall: 1.000000
d_prime: 2.159120
train_loss: 0.024521
valid_loss: 1.003436
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.000844014316420323
Epoch-15 lr: 0.000844014316420323
epoch 15 training time: 15.100
---------------
2023-09-11 16:08:55.884908
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03626	Per Sample Data Time 0.02915	Per Sample DNN Time 0.00711	Train Loss 0.0183	
start validation
acc: 0.824645
AUC: 0.938439
Avg Precision: 0.373581
Avg Recall: 1.000000
d_prime: 2.180439
train_loss: 0.026115
valid_loss: 0.996203
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0006338746367773456
Epoch-16 lr: 0.0006338746367773456
epoch 16 training time: 17.404
---------------
2023-09-11 16:09:13.288889
current #epochs=17, #steps=640
start validation
acc: 0.829384
AUC: 0.941220
Avg Precision: 0.385745
Avg Recall: 1.000000
d_prime: 2.213377
train_loss: 0.029476
valid_loss: 0.989372
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0006338746367773456
Epoch-17 lr: 0.0006338746367773456
epoch 17 training time: 15.683
---------------
2023-09-11 16:09:28.972002
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00562	Train Loss 0.0271	
start validation
acc: 0.834123
AUC: 0.940550
Avg Precision: 0.378089
Avg Recall: 1.000000
d_prime: 2.205332
train_loss: 0.027212
valid_loss: 0.992083
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00047605478643269247
Epoch-18 lr: 0.00047605478643269247
epoch 18 training time: 15.058
---------------
2023-09-11 16:09:44.029957
current #epochs=19, #steps=720
start validation
acc: 0.824645
AUC: 0.940146
Avg Precision: 0.380888
Avg Recall: 1.000000
d_prime: 2.200514
train_loss: 0.025669
valid_loss: 0.999914
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00047605478643269247
Epoch-19 lr: 0.00047605478643269247
epoch 19 training time: 15.007
---------------
2023-09-11 16:09:59.037662
current #epochs=20, #steps=760
start validation
acc: 0.819905
AUC: 0.938114
Avg Precision: 0.383671
Avg Recall: 1.000000
d_prime: 2.176659
train_loss: 0.019951
valid_loss: 1.009228
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0003575283605566975
Epoch-20 lr: 0.0003575283605566975
epoch 20 training time: 15.110
---------------
2023-09-11 16:10:14.147249
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03871	Per Sample Data Time 0.02907	Per Sample DNN Time 0.00964	Train Loss 0.0087	
start validation
acc: 0.810427
AUC: 0.939423
Avg Precision: 0.392135
Avg Recall: 1.000000
d_prime: 2.191958
train_loss: 0.025277
valid_loss: 1.005377
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0003575283605566975
Epoch-21 lr: 0.0003575283605566975
epoch 21 training time: 15.172
---------------
2023-09-11 16:10:29.319047
current #epochs=22, #steps=840
start validation
acc: 0.815166
AUC: 0.940506
Avg Precision: 0.379159
Avg Recall: 1.000000
d_prime: 2.204804
train_loss: 0.022746
valid_loss: 0.997120
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00026851222221758455
Epoch-22 lr: 0.00026851222221758455
epoch 22 training time: 16.871
---------------
2023-09-11 16:10:46.190974
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00564	Train Loss 0.0297	
start validation
acc: 0.815166
AUC: 0.939639
Avg Precision: 0.374110
Avg Recall: 1.000000
d_prime: 2.194506
train_loss: 0.026964
valid_loss: 0.994753
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00026851222221758455
Epoch-23 lr: 0.00026851222221758455
epoch 23 training time: 14.958
---------------
2023-09-11 16:11:01.148459
current #epochs=24, #steps=920
start validation
acc: 0.819905
AUC: 0.938979
Avg Precision: 0.375405
Avg Recall: 1.000000
d_prime: 2.186739
train_loss: 0.020579
valid_loss: 1.001956
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00020165900508693196
Epoch-24 lr: 0.00020165900508693196
epoch 24 training time: 15.124
---------------
2023-09-11 16:11:16.272819
current #epochs=25, #steps=960
start validation
acc: 0.824645
AUC: 0.940296
Avg Precision: 0.380398
Avg Recall: 1.000000
d_prime: 2.202298
train_loss: 0.021364
valid_loss: 0.996562
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00020165900508693196
Epoch-25 lr: 0.00020165900508693196
epoch 25 training time: 14.926
---------------
2023-09-11 16:11:31.199122
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03653	Per Sample Data Time 0.02906	Per Sample DNN Time 0.00748	Train Loss 0.0140	
start validation
acc: 0.819905
AUC: 0.939787
Avg Precision: 0.383502
Avg Recall: 1.000000
d_prime: 2.196254
train_loss: 0.019076
valid_loss: 0.993604
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00015145066394667847
Epoch-26 lr: 0.00015145066394667847
epoch 26 training time: 15.069
---------------
2023-09-11 16:11:46.268104
current #epochs=27, #steps=1040
start validation
acc: 0.824645
AUC: 0.939072
Avg Precision: 0.379744
Avg Recall: 1.000000
d_prime: 2.187826
train_loss: 0.017916
valid_loss: 0.994467
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00015145066394667847
Epoch-27 lr: 0.00015145066394667847
epoch 27 training time: 15.088
---------------
2023-09-11 16:12:01.356073
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00563	Train Loss 0.0201	
start validation
acc: 0.824645
AUC: 0.938124
Avg Precision: 0.379019
Avg Recall: 1.000000
d_prime: 2.176780
train_loss: 0.022355
valid_loss: 0.996637
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00011374301683181384
Epoch-28 lr: 0.00011374301683181384
epoch 28 training time: 15.088
---------------
2023-09-11 16:12:16.444436
current #epochs=29, #steps=1120
start validation
acc: 0.819905
AUC: 0.937516
Avg Precision: 0.380666
Avg Recall: 1.000000
d_prime: 2.169759
train_loss: 0.026988
valid_loss: 1.000818
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00011374301683181384
Epoch-29 lr: 0.00011374301683181384
epoch 29 training time: 14.973
---------------
2023-09-11 16:12:31.416887
current #epochs=30, #steps=1160
start validation
acc: 0.829384
AUC: 0.937165
Avg Precision: 0.380666
Avg Recall: 1.000000
d_prime: 2.165733
train_loss: 0.016055
valid_loss: 1.001319
validation finished
normal learning rate scheduler step
Epoch-30 lr: 8.542368544886147e-05
Epoch-30 lr: 8.542368544886147e-05
epoch 30 training time: 15.539
---------------
2023-09-11 16:12:46.955697
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03627	Per Sample Data Time 0.02743	Per Sample DNN Time 0.00883	Train Loss 0.0001	
start validation
acc: 0.824645
AUC: 0.936004
Avg Precision: 0.376928
Avg Recall: 1.000000
d_prime: 2.152529
train_loss: 0.024178
valid_loss: 1.003101
validation finished
normal learning rate scheduler step
Epoch-31 lr: 8.542368544886147e-05
Epoch-31 lr: 8.542368544886147e-05
epoch 31 training time: 15.059
---------------
2023-09-11 16:13:02.014706
current #epochs=32, #steps=1240
start validation
acc: 0.829384
AUC: 0.935897
Avg Precision: 0.374258
Avg Recall: 1.000000
d_prime: 2.151321
train_loss: 0.027762
valid_loss: 1.002838
validation finished
normal learning rate scheduler step
Epoch-32 lr: 6.415520037116691e-05
Epoch-32 lr: 6.415520037116691e-05
epoch 32 training time: 15.040
---------------
2023-09-11 16:13:17.054675
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00566	Train Loss 0.0161	
start validation
acc: 0.829384
AUC: 0.936215
Avg Precision: 0.375988
Avg Recall: 1.000000
d_prime: 2.154916
train_loss: 0.024349
valid_loss: 1.002350
validation finished
normal learning rate scheduler step
Epoch-33 lr: 6.415520037116691e-05
Epoch-33 lr: 6.415520037116691e-05
epoch 33 training time: 16.005
---------------
2023-09-11 16:13:33.060091
current #epochs=34, #steps=1320
start validation
acc: 0.829384
AUC: 0.936508
Avg Precision: 0.374981
Avg Recall: 1.000000
d_prime: 2.158241
train_loss: 0.017159
valid_loss: 0.999993
validation finished
normal learning rate scheduler step
Epoch-34 lr: 4.818206698806661e-05
Epoch-34 lr: 4.818206698806661e-05
epoch 34 training time: 15.065
---------------
2023-09-11 16:13:48.124930
current #epochs=35, #steps=1360
start validation
acc: 0.824645
AUC: 0.936829
Avg Precision: 0.374082
Avg Recall: 1.000000
d_prime: 2.161891
train_loss: 0.020989
valid_loss: 0.998781
validation finished
normal learning rate scheduler step
Epoch-35 lr: 4.818206698806661e-05
Epoch-35 lr: 4.818206698806661e-05
epoch 35 training time: 15.802
---------------
2023-09-11 16:14:03.926632
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03763	Per Sample Data Time 0.02847	Per Sample DNN Time 0.00916	Train Loss 0.0124	
start validation
acc: 0.829384
AUC: 0.936822
Avg Precision: 0.374082
Avg Recall: 1.000000
d_prime: 2.161815
train_loss: 0.016298
valid_loss: 0.999274
validation finished
normal learning rate scheduler step
Epoch-36 lr: 3.6185867487149e-05
Epoch-36 lr: 3.6185867487149e-05
epoch 36 training time: 15.027
---------------
2023-09-11 16:14:18.954079
current #epochs=37, #steps=1440
start validation
acc: 0.824645
AUC: 0.936886
Avg Precision: 0.374981
Avg Recall: 1.000000
d_prime: 2.162539
train_loss: 0.024781
valid_loss: 0.999346
validation finished
normal learning rate scheduler step
Epoch-37 lr: 3.6185867487149e-05
Epoch-37 lr: 3.6185867487149e-05
epoch 37 training time: 15.119
---------------
2023-09-11 16:14:34.072716
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00565	Train Loss 0.0321	
start validation
acc: 0.824645
AUC: 0.936950
Avg Precision: 0.373916
Avg Recall: 1.000000
d_prime: 2.163273
train_loss: 0.023298
valid_loss: 0.998671
validation finished
normal learning rate scheduler step
Epoch-38 lr: 2.717643902910629e-05
Epoch-38 lr: 2.717643902910629e-05
epoch 38 training time: 15.096
---------------
2023-09-11 16:14:49.169160
current #epochs=39, #steps=1520
start validation
acc: 0.824645
AUC: 0.937039
Avg Precision: 0.374815
Avg Recall: 1.000000
d_prime: 2.164285
train_loss: 0.018904
valid_loss: 0.999022
validation finished
normal learning rate scheduler step
Epoch-39 lr: 2.717643902910629e-05
Epoch-39 lr: 2.717643902910629e-05
epoch 39 training time: 15.119
---------------
2023-09-11 16:15:04.287657
current #epochs=40, #steps=1560
start validation
acc: 0.829384
AUC: 0.936879
Avg Precision: 0.374815
Avg Recall: 1.000000
d_prime: 2.162463
train_loss: 0.017212
valid_loss: 0.999108
validation finished
normal learning rate scheduler step
Epoch-40 lr: 2.0410145993184287e-05
Epoch-40 lr: 2.0410145993184287e-05
epoch 40 training time: 15.082
---------------
2023-09-11 16:15:19.369441
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03668	Per Sample Data Time 0.02920	Per Sample DNN Time 0.00748	Train Loss 0.0163	
start validation
acc: 0.829384
AUC: 0.936991
Avg Precision: 0.373983
Avg Recall: 1.000000
d_prime: 2.163736
train_loss: 0.021347
valid_loss: 0.999132
validation finished
normal learning rate scheduler step
Epoch-41 lr: 2.0410145993184287e-05
Epoch-41 lr: 2.0410145993184287e-05
epoch 41 training time: 15.121
---------------
2023-09-11 16:15:34.490642
current #epochs=42, #steps=1640
start validation
acc: 0.829384
AUC: 0.937107
Avg Precision: 0.374815
Avg Recall: 1.000000
d_prime: 2.165069
train_loss: 0.016788
valid_loss: 0.998696
validation finished
normal learning rate scheduler step
Epoch-42 lr: 1.5328500507993e-05
Epoch-42 lr: 1.5328500507993e-05
epoch 42 training time: 15.180
---------------
2023-09-11 16:15:49.671024
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00564	Train Loss 0.0113	
start validation
[I 2023-09-11 16:16:04,784] Trial 59 finished with value: 0.8436018957345972 and parameters: {'warmup': 'False', 'num_epochs': 43, 'batch_size': 11, 'lr-adaptschedule': 'True', 'lr': 0.0035324986653354666, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.7510235601995087}. Best is trial 50 with value: 0.8815165876777251.
acc: 0.829384
AUC: 0.936911
Avg Precision: 0.374815
Avg Recall: 1.000000
d_prime: 2.162820
train_loss: 0.021550
valid_loss: 0.998561
validation finished
normal learning rate scheduler step
Epoch-43 lr: 1.5328500507993e-05
Epoch-43 lr: 1.5328500507993e-05
epoch 43 training time: 15.100
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f86670dc250>
The learning rate scheduler starts at 5 epoch with decay rate of 0.772 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 16:16:04.821579
current #epochs=1, #steps=0
start validation
acc: 0.843602
AUC: 0.930388
Avg Precision: 0.354398
Avg Recall: 1.000000
d_prime: 2.091175
train_loss: 0.061994
valid_loss: 1.008997
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0028213607626414363
Epoch-1 lr: 0.0028213607626414363
epoch 1 training time: 18.123
---------------
2023-09-11 16:16:22.945186
current #epochs=2, #steps=40
start validation
acc: 0.805687
AUC: 0.932319
Avg Precision: 0.388613
Avg Recall: 1.000000
d_prime: 2.111832
train_loss: 0.041028
valid_loss: 0.999358
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0028213607626414363
Epoch-2 lr: 0.0028213607626414363
epoch 2 training time: 16.404
---------------
2023-09-11 16:16:39.349529
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00704	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00558	Train Loss 0.0436	
start validation
acc: 0.829384
AUC: 0.922875
Avg Precision: 0.347031
Avg Recall: 1.000000
d_prime: 2.014800
train_loss: 0.049468
valid_loss: 1.032316
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0028213607626414363
Epoch-3 lr: 0.0028213607626414363
epoch 3 training time: 14.913
---------------
2023-09-11 16:16:54.262719
current #epochs=4, #steps=120
start validation
acc: 0.810427
AUC: 0.922218
Avg Precision: 0.343211
Avg Recall: 1.000000
d_prime: 2.008399
train_loss: 0.050288
valid_loss: 1.013289
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0028213607626414363
Epoch-4 lr: 0.0028213607626414363
epoch 4 training time: 15.140
---------------
2023-09-11 16:17:09.403210
current #epochs=5, #steps=160
start validation
acc: 0.810427
AUC: 0.929278
Avg Precision: 0.343561
Avg Recall: 1.000000
d_prime: 2.079508
train_loss: 0.048372
valid_loss: 1.002023
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0021789748075261278
Epoch-5 lr: 0.0021789748075261278
epoch 5 training time: 15.137
---------------
2023-09-11 16:17:24.540684
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03653	Per Sample Data Time 0.02891	Per Sample DNN Time 0.00762	Train Loss 0.0711	
start validation
acc: 0.848341
AUC: 0.934946
Avg Precision: 0.332825
Avg Recall: 1.000000
d_prime: 2.140661
train_loss: 0.044258
valid_loss: 0.993164
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0021789748075261278
Epoch-6 lr: 0.0021789748075261278
epoch 6 training time: 17.032
---------------
2023-09-11 16:17:41.572666
current #epochs=7, #steps=240
start validation
acc: 0.800948
AUC: 0.927198
Avg Precision: 0.333199
Avg Recall: 1.000000
d_prime: 2.058016
train_loss: 0.031047
valid_loss: 0.998720
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0021789748075261278
Epoch-7 lr: 0.0021789748075261278
epoch 7 training time: 15.040
---------------
2023-09-11 16:17:56.612718
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00563	Train Loss 0.0340	
start validation
acc: 0.791469
AUC: 0.920850
Avg Precision: 0.343576
Avg Recall: 1.000000
d_prime: 1.995193
train_loss: 0.043985
valid_loss: 1.007504
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0021789748075261278
Epoch-8 lr: 0.0021789748075261278
epoch 8 training time: 16.337
---------------
2023-09-11 16:18:12.950006
current #epochs=9, #steps=320
start validation
acc: 0.819905
AUC: 0.915791
Avg Precision: 0.317369
Avg Recall: 1.000000
d_prime: 1.947805
train_loss: 0.049626
valid_loss: 1.012663
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0021789748075261278
Epoch-9 lr: 0.0021789748075261278
epoch 9 training time: 16.781
---------------
2023-09-11 16:18:29.730482
current #epochs=10, #steps=360
start validation
acc: 0.834123
AUC: 0.920907
Avg Precision: 0.316823
Avg Recall: 1.000000
d_prime: 1.995738
train_loss: 0.052465
valid_loss: 1.022607
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0021789748075261278
Epoch-10 lr: 0.0021789748075261278
epoch 10 training time: 15.177
---------------
2023-09-11 16:18:44.907737
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03656	Per Sample Data Time 0.02891	Per Sample DNN Time 0.00765	Train Loss 0.0031	
start validation
acc: 0.834123
AUC: 0.931841
Avg Precision: 0.353181
Avg Recall: 1.000000
d_prime: 2.106675
train_loss: 0.028390
valid_loss: 1.023797
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0021789748075261278
Epoch-11 lr: 0.0021789748075261278
epoch 11 training time: 15.149
---------------
2023-09-11 16:19:00.056841
current #epochs=12, #steps=440
start validation
acc: 0.800948
AUC: 0.923821
Avg Precision: 0.328013
Avg Recall: 1.000000
d_prime: 2.024093
train_loss: 0.057963
valid_loss: 1.028023
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0021789748075261278
Epoch-12 lr: 0.0021789748075261278
epoch 12 training time: 15.220
---------------
2023-09-11 16:19:15.277166
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00569	Train Loss 0.0471	
start validation
acc: 0.810427
AUC: 0.920821
Avg Precision: 0.313081
Avg Recall: 1.000000
d_prime: 1.994916
train_loss: 0.046490
valid_loss: 1.019672
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0021789748075261278
Epoch-13 lr: 0.0021789748075261278
epoch 13 training time: 16.407
---------------
2023-09-11 16:19:31.683910
current #epochs=14, #steps=520
start validation
acc: 0.824645
AUC: 0.933758
Avg Precision: 0.364336
Avg Recall: 1.000000
d_prime: 2.127517
train_loss: 0.043476
valid_loss: 0.990938
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0021789748075261278
Epoch-14 lr: 0.0021789748075261278
epoch 14 training time: 15.154
---------------
2023-09-11 16:19:46.837755
current #epochs=15, #steps=560
start validation
acc: 0.824645
AUC: 0.936082
Avg Precision: 0.379573
Avg Recall: 1.000000
d_prime: 2.153413
train_loss: 0.051127
valid_loss: 0.997478
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0016828515072239043
Epoch-15 lr: 0.0016828515072239043
epoch 15 training time: 14.999
---------------
2023-09-11 16:20:01.836642
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03891	Per Sample Data Time 0.02966	Per Sample DNN Time 0.00925	Train Loss 0.0557	
start validation
acc: 0.815166
AUC: 0.935213
Avg Precision: 0.355968
Avg Recall: 1.000000
d_prime: 2.143644
train_loss: 0.044520
valid_loss: 1.003935
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0016828515072239043
Epoch-16 lr: 0.0016828515072239043
epoch 16 training time: 15.163
---------------
2023-09-11 16:20:16.999629
current #epochs=17, #steps=640
start validation
acc: 0.829384
AUC: 0.934873
Avg Precision: 0.362491
Avg Recall: 1.000000
d_prime: 2.139843
train_loss: 0.043067
valid_loss: 1.008140
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0016828515072239043
Epoch-17 lr: 0.0016828515072239043
epoch 17 training time: 15.140
---------------
2023-09-11 16:20:32.139549
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00562	Train Loss 0.0520	
start validation
acc: 0.838863
AUC: 0.937436
Avg Precision: 0.385641
Avg Recall: 1.000000
d_prime: 2.168835
train_loss: 0.041435
valid_loss: 0.991836
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0016828515072239043
Epoch-18 lr: 0.0016828515072239043
epoch 18 training time: 15.061
---------------
2023-09-11 16:20:47.200833
current #epochs=19, #steps=720
start validation
acc: 0.810427
AUC: 0.931071
Avg Precision: 0.352162
Avg Recall: 1.000000
d_prime: 2.098430
train_loss: 0.040241
valid_loss: 1.007541
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0016828515072239043
Epoch-19 lr: 0.0016828515072239043
epoch 19 training time: 14.988
---------------
2023-09-11 16:21:02.189231
current #epochs=20, #steps=760
start validation
acc: 0.824645
AUC: 0.919872
Avg Precision: 0.336792
Avg Recall: 1.000000
d_prime: 1.985850
train_loss: 0.045024
valid_loss: 1.013087
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0016828515072239043
Epoch-20 lr: 0.0016828515072239043
epoch 20 training time: 15.156
---------------
2023-09-11 16:21:17.345617
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03666	Per Sample Data Time 0.02850	Per Sample DNN Time 0.00816	Train Loss 0.0082	
start validation
acc: 0.819905
AUC: 0.918626
Avg Precision: 0.322627
Avg Recall: 1.000000
d_prime: 1.974087
train_loss: 0.035362
valid_loss: 0.990000
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0016828515072239043
Epoch-21 lr: 0.0016828515072239043
epoch 21 training time: 15.022
---------------
2023-09-11 16:21:32.367892
current #epochs=22, #steps=840
start validation
acc: 0.824645
AUC: 0.917455
Avg Precision: 0.310524
Avg Recall: 1.000000
d_prime: 1.963145
train_loss: 0.030255
valid_loss: 1.015656
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0016828515072239043
Epoch-22 lr: 0.0016828515072239043
epoch 22 training time: 15.195
---------------
2023-09-11 16:21:47.562530
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00561	Train Loss 0.0409	
start validation
acc: 0.838863
AUC: 0.933285
Avg Precision: 0.340694
Avg Recall: 1.000000
d_prime: 2.122330
train_loss: 0.041598
valid_loss: 0.996785
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0016828515072239043
Epoch-23 lr: 0.0016828515072239043
epoch 23 training time: 15.003
---------------
2023-09-11 16:22:02.565617
current #epochs=24, #steps=920
start validation
acc: 0.838863
AUC: 0.929867
Avg Precision: 0.361817
Avg Recall: 1.000000
d_prime: 2.085681
train_loss: 0.033330
valid_loss: 1.004378
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0016828515072239043
Epoch-24 lr: 0.0016828515072239043
epoch 24 training time: 16.671
---------------
2023-09-11 16:22:19.236501
current #epochs=25, #steps=960
start validation
acc: 0.805687
AUC: 0.935487
Avg Precision: 0.372525
Avg Recall: 1.000000
d_prime: 2.146712
train_loss: 0.033487
valid_loss: 0.977682
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0012996888195238158
Epoch-25 lr: 0.0012996888195238158
epoch 25 training time: 15.206
---------------
2023-09-11 16:22:34.442115
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03638	Per Sample Data Time 0.02822	Per Sample DNN Time 0.00816	Train Loss 0.0563	
start validation
acc: 0.815166
AUC: 0.921747
Avg Precision: 0.357032
Avg Recall: 1.000000
d_prime: 2.003831
train_loss: 0.032112
valid_loss: 0.999138
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0012996888195238158
Epoch-26 lr: 0.0012996888195238158
epoch 26 training time: 15.101
---------------
2023-09-11 16:22:49.543212
current #epochs=27, #steps=1040
start validation
acc: 0.834123
AUC: 0.921908
Avg Precision: 0.331357
Avg Recall: 1.000000
d_prime: 2.005391
train_loss: 0.029953
valid_loss: 1.003466
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0012996888195238158
Epoch-27 lr: 0.0012996888195238158
epoch 27 training time: 15.257
---------------
2023-09-11 16:23:04.799956
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00563	Train Loss 0.0243	
start validation
acc: 0.824645
AUC: 0.921215
Avg Precision: 0.337121
Avg Recall: 1.000000
d_prime: 1.998692
train_loss: 0.024815
valid_loss: 0.995772
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0012996888195238158
Epoch-28 lr: 0.0012996888195238158
epoch 28 training time: 15.056
---------------
2023-09-11 16:23:19.856377
current #epochs=29, #steps=1120
start validation
acc: 0.829384
AUC: 0.930425
Avg Precision: 0.323823
Avg Recall: 1.000000
d_prime: 2.091570
train_loss: 0.025765
valid_loss: 0.968860
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0012996888195238158
Epoch-29 lr: 0.0012996888195238158
epoch 29 training time: 15.064
---------------
2023-09-11 16:23:34.920479
current #epochs=30, #steps=1160
start validation
acc: 0.843602
AUC: 0.932671
Avg Precision: 0.343166
Avg Recall: 1.000000
d_prime: 2.115636
train_loss: 0.023281
valid_loss: 0.974966
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0012996888195238158
Epoch-30 lr: 0.0012996888195238158
epoch 30 training time: 15.489
---------------
2023-09-11 16:23:50.409777
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03928	Per Sample Data Time 0.02940	Per Sample DNN Time 0.00988	Train Loss 0.0171	
start validation
acc: 0.843602
AUC: 0.926340
Avg Precision: 0.332342
Avg Recall: 1.000000
d_prime: 2.049285
train_loss: 0.024702
valid_loss: 0.984952
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0012996888195238158
Epoch-31 lr: 0.0012996888195238158
epoch 31 training time: 15.130
---------------
2023-09-11 16:24:05.540250
current #epochs=32, #steps=1240
start validation
acc: 0.838863
AUC: 0.928273
Avg Precision: 0.351054
Avg Recall: 1.000000
d_prime: 2.069065
train_loss: 0.028583
valid_loss: 0.984752
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0012996888195238158
Epoch-32 lr: 0.0012996888195238158
epoch 32 training time: 15.204
---------------
2023-09-11 16:24:20.744583
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00143	Per Sample DNN Time 0.00563	Train Loss 0.0227	
start validation
acc: 0.834123
AUC: 0.936332
Avg Precision: 0.344860
Avg Recall: 1.000000
d_prime: 2.156243
train_loss: 0.026786
valid_loss: 0.970588
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0012996888195238158
Epoch-33 lr: 0.0012996888195238158
epoch 33 training time: 16.730
---------------
2023-09-11 16:24:37.474914
current #epochs=34, #steps=1320
start validation
acc: 0.848341
AUC: 0.927770
Avg Precision: 0.330121
Avg Recall: 1.000000
d_prime: 2.063875
train_loss: 0.028729
valid_loss: 0.988438
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0012996888195238158
Epoch-34 lr: 0.0012996888195238158
epoch 34 training time: 15.187
---------------
2023-09-11 16:24:52.661857
current #epochs=35, #steps=1360
start validation
acc: 0.848341
AUC: 0.931088
Avg Precision: 0.333331
Avg Recall: 1.000000
d_prime: 2.098613
train_loss: 0.025392
valid_loss: 0.977826
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0010037671299838946
Epoch-35 lr: 0.0010037671299838946
epoch 35 training time: 14.948
---------------
2023-09-11 16:25:07.610109
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03649	Per Sample Data Time 0.02928	Per Sample DNN Time 0.00720	Train Loss 0.0176	
start validation
acc: 0.838863
AUC: 0.924978
Avg Precision: 0.332767
Avg Recall: 1.000000
d_prime: 2.035585
train_loss: 0.029177
valid_loss: 0.982391
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0010037671299838946
Epoch-36 lr: 0.0010037671299838946
epoch 36 training time: 15.380
---------------
2023-09-11 16:25:22.990156
current #epochs=37, #steps=1440
start validation
acc: 0.810427
AUC: 0.920673
Avg Precision: 0.330372
Avg Recall: 1.000000
d_prime: 1.993497
train_loss: 0.024463
valid_loss: 1.009163
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0010037671299838946
Epoch-37 lr: 0.0010037671299838946
epoch 37 training time: 15.152
---------------
2023-09-11 16:25:38.142666
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00563	Train Loss 0.0302	
start validation
acc: 0.829384
AUC: 0.924333
Avg Precision: 0.336487
Avg Recall: 1.000000
d_prime: 2.029160
train_loss: 0.034838
valid_loss: 1.023659
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0010037671299838946
Epoch-38 lr: 0.0010037671299838946
epoch 38 training time: 15.456
---------------
2023-09-11 16:25:53.598697
current #epochs=39, #steps=1520
start validation
acc: 0.815166
AUC: 0.929563
Avg Precision: 0.330443
Avg Recall: 1.000000
d_prime: 2.082490
train_loss: 0.016821
valid_loss: 0.989186
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0010037671299838946
Epoch-39 lr: 0.0010037671299838946
epoch 39 training time: 16.444
---------------
2023-09-11 16:26:10.043256
current #epochs=40, #steps=1560
start validation
acc: 0.819905
AUC: 0.926180
Avg Precision: 0.338217
Avg Recall: 1.000000
d_prime: 2.047664
train_loss: 0.022436
valid_loss: 1.012558
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0010037671299838946
Epoch-40 lr: 0.0010037671299838946
epoch 40 training time: 15.094
---------------
2023-09-11 16:26:25.137455
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03634	Per Sample Data Time 0.02835	Per Sample DNN Time 0.00799	Train Loss 0.0130	
start validation
acc: 0.834123
AUC: 0.925313
Avg Precision: 0.345529
Avg Recall: 1.000000
d_prime: 2.038934
train_loss: 0.025039
valid_loss: 1.002115
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0010037671299838946
Epoch-41 lr: 0.0010037671299838946
epoch 41 training time: 15.243
---------------
2023-09-11 16:26:40.380650
current #epochs=42, #steps=1640
start validation
acc: 0.843602
AUC: 0.922953
Avg Precision: 0.348522
Avg Recall: 1.000000
d_prime: 2.015565
train_loss: 0.015635
valid_loss: 0.999332
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0010037671299838946
Epoch-42 lr: 0.0010037671299838946
epoch 42 training time: 15.312
---------------
2023-09-11 16:26:55.692391
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00567	Train Loss 0.0223	
start validation
acc: 0.838863
AUC: 0.922467
Avg Precision: 0.336421
Avg Recall: 1.000000
d_prime: 2.010818
train_loss: 0.026356
valid_loss: 1.002840
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0010037671299838946
Epoch-43 lr: 0.0010037671299838946
epoch 43 training time: 15.858
---------------
2023-09-11 16:27:11.550421
current #epochs=44, #steps=1720
start validation
acc: 0.824645
AUC: 0.915905
Avg Precision: 0.340394
Avg Recall: 1.000000
d_prime: 1.948849
train_loss: 0.020820
valid_loss: 1.002986
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0010037671299838946
Epoch-44 lr: 0.0010037671299838946
epoch 44 training time: 15.214
---------------
2023-09-11 16:27:26.764816
current #epochs=45, #steps=1760
start validation
acc: 0.819905
AUC: 0.924137
Avg Precision: 0.340055
Avg Recall: 1.000000
d_prime: 2.027221
train_loss: 0.030184
valid_loss: 1.010115
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0007752228349592586
Epoch-45 lr: 0.0007752228349592586
epoch 45 training time: 15.396
---------------
2023-09-11 16:27:42.161036
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03690	Per Sample Data Time 0.02753	Per Sample DNN Time 0.00938	Train Loss 0.0187	
start validation
acc: 0.810427
AUC: 0.919448
Avg Precision: 0.348499
Avg Recall: 1.000000
d_prime: 1.981833
train_loss: 0.021681
valid_loss: 1.004694
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.0007752228349592586
Epoch-46 lr: 0.0007752228349592586
epoch 46 training time: 15.112
---------------
2023-09-11 16:27:57.273534
current #epochs=47, #steps=1840
start validation
acc: 0.815166
AUC: 0.920183
Avg Precision: 0.357236
Avg Recall: 1.000000
d_prime: 1.988809
train_loss: 0.029432
valid_loss: 0.997619
validation finished
normal learning rate scheduler step
Epoch-47 lr: 0.0007752228349592586
Epoch-47 lr: 0.0007752228349592586
epoch 47 training time: 17.278
---------------
2023-09-11 16:28:14.551606
current #epochs=48, #steps=1880
Epoch: [48][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00562	Train Loss 0.0274	
start validation
[I 2023-09-11 16:28:30,195] Trial 60 finished with value: 0.8483412322274881 and parameters: {'warmup': 'False', 'num_epochs': 48, 'batch_size': 26, 'lr-adaptschedule': 'True', 'lr': 0.0028213607626414363, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.772313429880591}. Best is trial 50 with value: 0.8815165876777251.
acc: 0.834123
AUC: 0.917495
Avg Precision: 0.345327
Avg Recall: 1.000000
d_prime: 1.963520
train_loss: 0.026788
valid_loss: 0.988459
validation finished
normal learning rate scheduler step
Epoch-48 lr: 0.0007752228349592586
Epoch-48 lr: 0.0007752228349592586
epoch 48 training time: 15.618
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863efae310>
The learning rate scheduler starts at 7 epoch with decay rate of 0.790 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 16:28:30.233787
current #epochs=1, #steps=0
start validation
acc: 0.834123
AUC: 0.925747
Avg Precision: 0.306744
Avg Recall: 1.000000
d_prime: 2.043293
train_loss: 0.048220
valid_loss: 1.020090
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002565868453306876
Epoch-1 lr: 0.002565868453306876
epoch 1 training time: 17.116
---------------
2023-09-11 16:28:47.349920
current #epochs=2, #steps=40
start validation
acc: 0.796209
AUC: 0.914495
Avg Precision: 0.351842
Avg Recall: 1.000000
d_prime: 1.936009
train_loss: 0.060412
valid_loss: 1.042956
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002565868453306876
Epoch-2 lr: 0.002565868453306876
epoch 2 training time: 15.087
---------------
2023-09-11 16:29:02.437156
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00701	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00557	Train Loss 0.0568	
start validation
acc: 0.824645
AUC: 0.938748
Avg Precision: 0.375656
Avg Recall: 1.000000
d_prime: 2.184036
train_loss: 0.051193
valid_loss: 0.990961
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002565868453306876
Epoch-3 lr: 0.002565868453306876
epoch 3 training time: 16.267
---------------
2023-09-11 16:29:18.704534
current #epochs=4, #steps=120
start validation
acc: 0.834123
AUC: 0.929478
Avg Precision: 0.315145
Avg Recall: 1.000000
d_prime: 2.081598
train_loss: 0.038348
valid_loss: 0.982343
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002565868453306876
Epoch-4 lr: 0.002565868453306876
epoch 4 training time: 14.981
---------------
2023-09-11 16:29:33.685767
current #epochs=5, #steps=160
start validation
acc: 0.810427
AUC: 0.922915
Avg Precision: 0.357801
Avg Recall: 1.000000
d_prime: 2.015190
train_loss: 0.038375
valid_loss: 1.015053
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002565868453306876
Epoch-5 lr: 0.002565868453306876
epoch 5 training time: 15.912
---------------
2023-09-11 16:29:49.598227
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03722	Per Sample Data Time 0.02753	Per Sample DNN Time 0.00969	Train Loss 0.0220	
start validation
acc: 0.805687
AUC: 0.918875
Avg Precision: 0.320056
Avg Recall: 1.000000
d_prime: 1.976426
train_loss: 0.052716
valid_loss: 1.008772
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002565868453306876
Epoch-6 lr: 0.002565868453306876
epoch 6 training time: 15.317
---------------
2023-09-11 16:30:04.915511
current #epochs=7, #steps=240
start validation
acc: 0.800948
AUC: 0.928259
Avg Precision: 0.350424
Avg Recall: 1.000000
d_prime: 2.068919
train_loss: 0.060512
valid_loss: 1.002520
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002026880540375065
Epoch-7 lr: 0.002026880540375065
epoch 7 training time: 15.412
---------------
2023-09-11 16:30:20.326996
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00563	Train Loss 0.0424	
start validation
acc: 0.810427
AUC: 0.936203
Avg Precision: 0.353863
Avg Recall: 1.000000
d_prime: 2.154774
train_loss: 0.036036
valid_loss: 0.981263
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.002026880540375065
Epoch-8 lr: 0.002026880540375065
epoch 8 training time: 15.135
---------------
2023-09-11 16:30:35.462119
current #epochs=9, #steps=320
start validation
acc: 0.824645
AUC: 0.927637
Avg Precision: 0.341950
Avg Recall: 1.000000
d_prime: 2.062508
train_loss: 0.039467
valid_loss: 1.011152
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.002026880540375065
Epoch-9 lr: 0.002026880540375065
epoch 9 training time: 16.030
---------------
2023-09-11 16:30:51.491813
current #epochs=10, #steps=360
start validation
acc: 0.848341
AUC: 0.926075
Avg Precision: 0.340926
Avg Recall: 1.000000
d_prime: 2.046606
train_loss: 0.031907
valid_loss: 0.989901
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.002026880540375065
Epoch-10 lr: 0.002026880540375065
epoch 10 training time: 17.827
---------------
2023-09-11 16:31:09.319022
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03830	Per Sample Data Time 0.02827	Per Sample DNN Time 0.01003	Train Loss 0.0105	
start validation
acc: 0.834123
AUC: 0.921665
Avg Precision: 0.322534
Avg Recall: 1.000000
d_prime: 2.003032
train_loss: 0.023817
valid_loss: 0.999396
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.002026880540375065
Epoch-11 lr: 0.002026880540375065
epoch 11 training time: 16.033
---------------
2023-09-11 16:31:25.352486
current #epochs=12, #steps=440
start validation
acc: 0.815166
AUC: 0.921484
Avg Precision: 0.312847
Avg Recall: 1.000000
d_prime: 2.001284
train_loss: 0.033246
valid_loss: 1.007153
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.002026880540375065
Epoch-12 lr: 0.002026880540375065
epoch 12 training time: 15.156
---------------
2023-09-11 16:31:40.508803
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00569	Train Loss 0.0225	
start validation
acc: 0.829384
AUC: 0.928619
Avg Precision: 0.342338
Avg Recall: 1.000000
d_prime: 2.072644
train_loss: 0.028303
valid_loss: 0.994052
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.002026880540375065
Epoch-13 lr: 0.002026880540375065
epoch 13 training time: 15.144
---------------
2023-09-11 16:31:55.652406
current #epochs=14, #steps=520
start validation
acc: 0.815166
AUC: 0.928450
Avg Precision: 0.318029
Avg Recall: 1.000000
d_prime: 2.070897
train_loss: 0.030442
valid_loss: 0.995604
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.002026880540375065
Epoch-14 lr: 0.002026880540375065
epoch 14 training time: 15.149
---------------
2023-09-11 16:32:10.801743
current #epochs=15, #steps=560
start validation
acc: 0.819905
AUC: 0.934517
Avg Precision: 0.390948
Avg Recall: 1.000000
d_prime: 2.135897
train_loss: 0.031964
valid_loss: 1.012542
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.002026880540375065
Epoch-15 lr: 0.002026880540375065
epoch 15 training time: 14.970
---------------
2023-09-11 16:32:25.772054
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03980	Per Sample Data Time 0.02885	Per Sample DNN Time 0.01096	Train Loss 0.0005	
start validation
acc: 0.838863
AUC: 0.932477
Avg Precision: 0.345386
Avg Recall: 1.000000
d_prime: 2.113540
train_loss: 0.027699
valid_loss: 1.003083
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0016011127615121632
Epoch-16 lr: 0.0016011127615121632
epoch 16 training time: 15.186
---------------
2023-09-11 16:32:40.958063
current #epochs=17, #steps=640
start validation
acc: 0.810427
AUC: 0.929238
Avg Precision: 0.357408
Avg Recall: 1.000000
d_prime: 2.079094
train_loss: 0.041689
valid_loss: 1.014011
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0016011127615121632
Epoch-17 lr: 0.0016011127615121632
epoch 17 training time: 14.978
---------------
2023-09-11 16:32:55.936389
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00563	Train Loss 0.0349	
start validation
acc: 0.819905
AUC: 0.918299
Avg Precision: 0.339133
Avg Recall: 1.000000
d_prime: 1.971014
train_loss: 0.031409
valid_loss: 1.041751
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0016011127615121632
Epoch-18 lr: 0.0016011127615121632
epoch 18 training time: 15.346
---------------
2023-09-11 16:33:11.282764
current #epochs=19, #steps=720
start validation
acc: 0.829384
AUC: 0.936832
Avg Precision: 0.375600
Avg Recall: 1.000000
d_prime: 2.161929
train_loss: 0.038463
valid_loss: 1.020786
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0016011127615121632
Epoch-19 lr: 0.0016011127615121632
epoch 19 training time: 15.104
---------------
2023-09-11 16:33:26.386488
current #epochs=20, #steps=760
start validation
acc: 0.829384
AUC: 0.927751
Avg Precision: 0.337082
Avg Recall: 1.000000
d_prime: 2.063686
train_loss: 0.031381
valid_loss: 1.001073
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0016011127615121632
Epoch-20 lr: 0.0016011127615121632
epoch 20 training time: 15.119
---------------
2023-09-11 16:33:41.505916
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03541	Per Sample Data Time 0.02831	Per Sample DNN Time 0.00710	Train Loss 0.0007	
start validation
acc: 0.810427
AUC: 0.931687
Avg Precision: 0.360411
Avg Recall: 1.000000
d_prime: 2.105021
train_loss: 0.021840
valid_loss: 0.993296
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0016011127615121632
Epoch-21 lr: 0.0016011127615121632
epoch 21 training time: 16.025
---------------
2023-09-11 16:33:57.530569
current #epochs=22, #steps=840
start validation
acc: 0.800948
AUC: 0.918585
Avg Precision: 0.352127
Avg Recall: 1.000000
d_prime: 1.973699
train_loss: 0.032397
valid_loss: 1.003894
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0016011127615121632
Epoch-22 lr: 0.0016011127615121632
epoch 22 training time: 15.211
---------------
2023-09-11 16:34:12.741472
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00565	Train Loss 0.0285	
start validation
acc: 0.834123
AUC: 0.923179
Avg Precision: 0.361379
Avg Recall: 1.000000
d_prime: 2.017779
train_loss: 0.024353
valid_loss: 1.028777
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0016011127615121632
Epoch-23 lr: 0.0016011127615121632
epoch 23 training time: 15.509
---------------
2023-09-11 16:34:28.250282
current #epochs=24, #steps=920
start validation
acc: 0.815166
AUC: 0.929667
Avg Precision: 0.346608
Avg Recall: 1.000000
d_prime: 2.083587
train_loss: 0.045253
valid_loss: 1.006926
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0016011127615121632
Epoch-24 lr: 0.0016011127615121632
epoch 24 training time: 15.423
---------------
2023-09-11 16:34:43.673033
current #epochs=25, #steps=960
start validation
acc: 0.819905
AUC: 0.916644
Avg Precision: 0.335743
Avg Recall: 1.000000
d_prime: 1.955641
train_loss: 0.033427
valid_loss: 1.011611
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00126478202538899
Epoch-25 lr: 0.00126478202538899
epoch 25 training time: 16.251
---------------
2023-09-11 16:34:59.923630
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03731	Per Sample Data Time 0.02969	Per Sample DNN Time 0.00762	Train Loss 0.0079	
start validation
acc: 0.829384
AUC: 0.917475
Avg Precision: 0.327358
Avg Recall: 1.000000
d_prime: 1.963335
train_loss: 0.026918
valid_loss: 1.020543
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00126478202538899
Epoch-26 lr: 0.00126478202538899
epoch 26 training time: 15.138
---------------
2023-09-11 16:35:15.061469
current #epochs=27, #steps=1040
start validation
acc: 0.815166
AUC: 0.911921
Avg Precision: 0.330067
Avg Recall: 1.000000
d_prime: 1.912982
train_loss: 0.034424
valid_loss: 1.025398
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00126478202538899
Epoch-27 lr: 0.00126478202538899
epoch 27 training time: 15.168
---------------
2023-09-11 16:35:30.229563
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00561	Train Loss 0.0400	
start validation
acc: 0.824645
AUC: 0.917353
Avg Precision: 0.315724
Avg Recall: 1.000000
d_prime: 1.962203
train_loss: 0.036534
valid_loss: 1.038006
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00126478202538899
Epoch-28 lr: 0.00126478202538899
epoch 28 training time: 15.183
---------------
2023-09-11 16:35:45.413039
current #epochs=29, #steps=1120
start validation
acc: 0.819905
AUC: 0.923145
Avg Precision: 0.329939
Avg Recall: 1.000000
d_prime: 2.017445
train_loss: 0.027309
valid_loss: 1.024722
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00126478202538899
Epoch-29 lr: 0.00126478202538899
epoch 29 training time: 15.053
---------------
2023-09-11 16:36:00.466344
current #epochs=30, #steps=1160
start validation
acc: 0.834123
AUC: 0.936224
Avg Precision: 0.339378
Avg Recall: 1.000000
d_prime: 2.155012
train_loss: 0.020348
valid_loss: 1.010044
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00126478202538899
Epoch-30 lr: 0.00126478202538899
epoch 30 training time: 15.304
---------------
2023-09-11 16:36:15.770750
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03787	Per Sample Data Time 0.02820	Per Sample DNN Time 0.00967	Train Loss 0.0033	
start validation
acc: 0.824645
AUC: 0.932164
Avg Precision: 0.347230
Avg Recall: 1.000000
d_prime: 2.110155
train_loss: 0.020557
valid_loss: 1.018013
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.00126478202538899
Epoch-31 lr: 0.00126478202538899
epoch 31 training time: 15.126
---------------
2023-09-11 16:36:30.897082
current #epochs=32, #steps=1240
start validation
acc: 0.829384
AUC: 0.942247
Avg Precision: 0.366077
Avg Recall: 1.000000
d_prime: 2.225858
train_loss: 0.031188
valid_loss: 0.987243
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00126478202538899
Epoch-32 lr: 0.00126478202538899
epoch 32 training time: 15.070
---------------
2023-09-11 16:36:45.967120
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00561	Train Loss 0.0302	
start validation
acc: 0.834123
AUC: 0.936002
Avg Precision: 0.362873
Avg Recall: 1.000000
d_prime: 2.152511
train_loss: 0.024167
valid_loss: 1.004566
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.00126478202538899
Epoch-33 lr: 0.00126478202538899
epoch 33 training time: 15.078
---------------
2023-09-11 16:37:01.044917
current #epochs=34, #steps=1320
start validation
acc: 0.853081
AUC: 0.932743
Avg Precision: 0.353373
Avg Recall: 1.000000
d_prime: 2.116421
train_loss: 0.022121
valid_loss: 1.010300
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0009991011315382133
Epoch-34 lr: 0.0009991011315382133
epoch 34 training time: 17.175
---------------
2023-09-11 16:37:18.219451
current #epochs=35, #steps=1360
start validation
acc: 0.834123
AUC: 0.927751
Avg Precision: 0.347431
Avg Recall: 1.000000
d_prime: 2.063687
train_loss: 0.025053
valid_loss: 1.007681
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0009991011315382133
Epoch-35 lr: 0.0009991011315382133
epoch 35 training time: 15.882
---------------
2023-09-11 16:37:34.101608
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03843	Per Sample Data Time 0.02781	Per Sample DNN Time 0.01062	Train Loss 0.0002	
start validation
acc: 0.834123
AUC: 0.931931
Avg Precision: 0.348876
Avg Recall: 1.000000
d_prime: 2.107647
train_loss: 0.029015
valid_loss: 1.004136
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0009991011315382133
Epoch-36 lr: 0.0009991011315382133
epoch 36 training time: 15.084
---------------
2023-09-11 16:37:49.185196
current #epochs=37, #steps=1440
start validation
acc: 0.843602
AUC: 0.929440
Avg Precision: 0.352417
Avg Recall: 1.000000
d_prime: 2.081207
train_loss: 0.023810
valid_loss: 1.011311
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0009991011315382133
Epoch-37 lr: 0.0009991011315382133
epoch 37 training time: 15.191
---------------
2023-09-11 16:38:04.376285
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00564	Train Loss 0.0341	
start validation
acc: 0.843602
AUC: 0.928240
Avg Precision: 0.352928
Avg Recall: 1.000000
d_prime: 2.068722
train_loss: 0.027744
valid_loss: 1.021646
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0009991011315382133
Epoch-38 lr: 0.0009991011315382133
epoch 38 training time: 16.167
---------------
2023-09-11 16:38:20.543703
current #epochs=39, #steps=1520
start validation
acc: 0.838863
AUC: 0.929430
Avg Precision: 0.358414
Avg Recall: 1.000000
d_prime: 2.081102
train_loss: 0.024400
valid_loss: 1.026506
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0009991011315382133
Epoch-39 lr: 0.0009991011315382133
epoch 39 training time: 15.026
---------------
2023-09-11 16:38:35.569930
current #epochs=40, #steps=1560
start validation
acc: 0.838863
AUC: 0.929417
Avg Precision: 0.340000
Avg Recall: 1.000000
d_prime: 2.080963
train_loss: 0.025469
valid_loss: 1.019439
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0009991011315382133
Epoch-40 lr: 0.0009991011315382133
epoch 40 training time: 15.206
---------------
2023-09-11 16:38:50.776510
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03592	Per Sample Data Time 0.02802	Per Sample DNN Time 0.00791	Train Loss 0.0002	
start validation
acc: 0.819905
AUC: 0.929380
Avg Precision: 0.325170
Avg Recall: 1.000000
d_prime: 2.080571
train_loss: 0.025992
valid_loss: 0.990850
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0009991011315382133
Epoch-41 lr: 0.0009991011315382133
epoch 41 training time: 16.153
---------------
2023-09-11 16:39:06.928832
current #epochs=42, #steps=1640
start validation
acc: 0.838863
AUC: 0.928269
Avg Precision: 0.340080
Avg Recall: 1.000000
d_prime: 2.069023
train_loss: 0.015966
valid_loss: 0.992800
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0009991011315382133
Epoch-42 lr: 0.0009991011315382133
epoch 42 training time: 15.958
---------------
2023-09-11 16:39:22.886778
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00567	Train Loss 0.0163	
start validation
acc: 0.834123
AUC: 0.931441
Avg Precision: 0.335381
Avg Recall: 1.000000
d_prime: 2.102378
train_loss: 0.017776
valid_loss: 0.991930
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0007892293304325984
Epoch-43 lr: 0.0007892293304325984
epoch 43 training time: 15.114
---------------
2023-09-11 16:39:38.001505
current #epochs=44, #steps=1720
start validation
acc: 0.838863
AUC: 0.932746
Avg Precision: 0.338481
Avg Recall: 1.000000
d_prime: 2.116451
train_loss: 0.026819
valid_loss: 0.996958
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0007892293304325984
Epoch-44 lr: 0.0007892293304325984
epoch 44 training time: 15.060
---------------
2023-09-11 16:39:53.061341
current #epochs=45, #steps=1760
start validation
[I 2023-09-11 16:40:08,167] Trial 61 finished with value: 0.8530805687203792 and parameters: {'warmup': 'False', 'num_epochs': 45, 'batch_size': 62, 'lr-adaptschedule': 'True', 'lr': 0.002565868453306876, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.7899393820298283}. Best is trial 50 with value: 0.8815165876777251.
acc: 0.848341
AUC: 0.934900
Avg Precision: 0.344029
Avg Recall: 1.000000
d_prime: 2.140146
train_loss: 0.023973
valid_loss: 0.973308
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0007892293304325984
Epoch-45 lr: 0.0007892293304325984
epoch 45 training time: 15.093
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f8644891370>
The learning rate scheduler starts at 6 epoch with decay rate of 0.821 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 16:40:08.205512
current #epochs=1, #steps=0
start validation
acc: 0.824645
AUC: 0.927404
Avg Precision: 0.332415
Avg Recall: 1.000000
d_prime: 2.060121
train_loss: 0.060157
valid_loss: 1.011347
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002428605025360999
Epoch-1 lr: 0.002428605025360999
epoch 1 training time: 17.331
---------------
2023-09-11 16:40:25.536908
current #epochs=2, #steps=40
start validation
acc: 0.834123
AUC: 0.919513
Avg Precision: 0.352506
Avg Recall: 1.000000
d_prime: 1.982448
train_loss: 0.051028
valid_loss: 1.004536
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002428605025360999
Epoch-2 lr: 0.002428605025360999
epoch 2 training time: 17.198
---------------
2023-09-11 16:40:42.735042
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00558	Train Loss 0.0510	
start validation
acc: 0.800948
AUC: 0.919638
Avg Precision: 0.333246
Avg Recall: 1.000000
d_prime: 1.983632
train_loss: 0.038373
valid_loss: 1.008836
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002428605025360999
Epoch-3 lr: 0.002428605025360999
epoch 3 training time: 15.091
---------------
2023-09-11 16:40:57.826129
current #epochs=4, #steps=120
start validation
acc: 0.800948
AUC: 0.918400
Avg Precision: 0.355853
Avg Recall: 1.000000
d_prime: 1.971969
train_loss: 0.028871
valid_loss: 1.015693
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002428605025360999
Epoch-4 lr: 0.002428605025360999
epoch 4 training time: 15.102
---------------
2023-09-11 16:41:12.927909
current #epochs=5, #steps=160
start validation
acc: 0.838863
AUC: 0.928223
Avg Precision: 0.327569
Avg Recall: 1.000000
d_prime: 2.068542
train_loss: 0.059864
valid_loss: 0.977178
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002428605025360999
Epoch-5 lr: 0.002428605025360999
epoch 5 training time: 17.187
---------------
2023-09-11 16:41:30.114618
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03849	Per Sample Data Time 0.02868	Per Sample DNN Time 0.00981	Train Loss 0.0133	
start validation
acc: 0.848341
AUC: 0.926002
Avg Precision: 0.350647
Avg Recall: 1.000000
d_prime: 2.045864
train_loss: 0.048496
valid_loss: 0.988025
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.001994889233693642
Epoch-6 lr: 0.001994889233693642
epoch 6 training time: 17.123
---------------
2023-09-11 16:41:47.237682
current #epochs=7, #steps=240
start validation
acc: 0.810427
AUC: 0.917037
Avg Precision: 0.325240
Avg Recall: 1.000000
d_prime: 1.959271
train_loss: 0.038894
valid_loss: 1.027573
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.001994889233693642
Epoch-7 lr: 0.001994889233693642
epoch 7 training time: 15.619
---------------
2023-09-11 16:42:02.857161
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00553	Train Loss 0.0295	
start validation
acc: 0.829384
AUC: 0.925129
Avg Precision: 0.318797
Avg Recall: 1.000000
d_prime: 2.037093
train_loss: 0.023622
valid_loss: 1.008359
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001994889233693642
Epoch-8 lr: 0.001994889233693642
epoch 8 training time: 15.240
---------------
2023-09-11 16:42:18.097051
current #epochs=9, #steps=320
start validation
acc: 0.824645
AUC: 0.916652
Avg Precision: 0.336091
Avg Recall: 1.000000
d_prime: 1.955716
train_loss: 0.038566
valid_loss: 1.028734
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001994889233693642
Epoch-9 lr: 0.001994889233693642
epoch 9 training time: 15.172
---------------
2023-09-11 16:42:33.269097
current #epochs=10, #steps=360
start validation
acc: 0.829384
AUC: 0.928614
Avg Precision: 0.345093
Avg Recall: 1.000000
d_prime: 2.072594
train_loss: 0.035476
valid_loss: 1.010613
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001994889233693642
Epoch-10 lr: 0.001994889233693642
epoch 10 training time: 15.046
---------------
2023-09-11 16:42:48.315533
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03841	Per Sample Data Time 0.02884	Per Sample DNN Time 0.00957	Train Loss 0.0504	
start validation
acc: 0.857820
AUC: 0.933057
Avg Precision: 0.353788
Avg Recall: 1.000000
d_prime: 2.119837
train_loss: 0.039595
valid_loss: 0.996891
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001994889233693642
Epoch-11 lr: 0.001994889233693642
epoch 11 training time: 18.433
---------------
2023-09-11 16:43:06.748121
current #epochs=12, #steps=440
start validation
acc: 0.872038
AUC: 0.944829
Avg Precision: 0.361347
Avg Recall: 1.000000
d_prime: 2.258021
train_loss: 0.044232
valid_loss: 0.990263
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001994889233693642
Epoch-12 lr: 0.001994889233693642
epoch 12 training time: 17.233
---------------
2023-09-11 16:43:23.980925
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00561	Train Loss 0.0415	
start validation
acc: 0.872038
AUC: 0.944795
Avg Precision: 0.352783
Avg Recall: 1.000000
d_prime: 2.257590
train_loss: 0.044707
valid_loss: 0.974285
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.001994889233693642
Epoch-13 lr: 0.001994889233693642
epoch 13 training time: 15.186
---------------
2023-09-11 16:43:39.167093
current #epochs=14, #steps=520
start validation
acc: 0.857820
AUC: 0.947426
Avg Precision: 0.379631
Avg Recall: 1.000000
d_prime: 2.291576
train_loss: 0.035135
valid_loss: 0.980298
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.001994889233693642
Epoch-14 lr: 0.001994889233693642
epoch 14 training time: 15.235
---------------
2023-09-11 16:43:54.401893
current #epochs=15, #steps=560
start validation
acc: 0.829384
AUC: 0.939956
Avg Precision: 0.357070
Avg Recall: 1.000000
d_prime: 2.198262
train_loss: 0.041470
valid_loss: 1.011066
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.001994889233693642
Epoch-15 lr: 0.001994889233693642
epoch 15 training time: 15.030
---------------
2023-09-11 16:44:09.432156
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03465	Per Sample Data Time 0.02724	Per Sample DNN Time 0.00741	Train Loss 0.0650	
start validation
acc: 0.824645
AUC: 0.940543
Avg Precision: 0.387010
Avg Recall: 1.000000
d_prime: 2.205250
train_loss: 0.039799
valid_loss: 1.001674
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0016386291773052978
Epoch-16 lr: 0.0016386291773052978
epoch 16 training time: 14.985
---------------
2023-09-11 16:44:24.417164
current #epochs=17, #steps=640
start validation
acc: 0.843602
AUC: 0.941274
Avg Precision: 0.342797
Avg Recall: 1.000000
d_prime: 2.214034
train_loss: 0.034839
valid_loss: 0.981003
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0016386291773052978
Epoch-17 lr: 0.0016386291773052978
epoch 17 training time: 15.140
---------------
2023-09-11 16:44:39.556948
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00562	Train Loss 0.0249	
start validation
acc: 0.838863
AUC: 0.936365
Avg Precision: 0.370149
Avg Recall: 1.000000
d_prime: 2.156613
train_loss: 0.030183
valid_loss: 0.998055
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0016386291773052978
Epoch-18 lr: 0.0016386291773052978
epoch 18 training time: 15.096
---------------
2023-09-11 16:44:54.653194
current #epochs=19, #steps=720
start validation
acc: 0.843602
AUC: 0.939892
Avg Precision: 0.350103
Avg Recall: 1.000000
d_prime: 2.197503
train_loss: 0.035108
valid_loss: 0.981395
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0016386291773052978
Epoch-19 lr: 0.0016386291773052978
epoch 19 training time: 16.483
---------------
2023-09-11 16:45:11.135776
current #epochs=20, #steps=760
start validation
acc: 0.829384
AUC: 0.931008
Avg Precision: 0.375309
Avg Recall: 1.000000
d_prime: 2.097757
train_loss: 0.051532
valid_loss: 0.987646
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0016386291773052978
Epoch-20 lr: 0.0016386291773052978
epoch 20 training time: 15.943
---------------
2023-09-11 16:45:27.078792
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03999	Per Sample Data Time 0.03002	Per Sample DNN Time 0.00997	Train Loss 0.0221	
start validation
acc: 0.848341
AUC: 0.941026
Avg Precision: 0.381831
Avg Recall: 1.000000
d_prime: 2.211051
train_loss: 0.038530
valid_loss: 0.982280
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0016386291773052978
Epoch-21 lr: 0.0016386291773052978
epoch 21 training time: 15.126
---------------
2023-09-11 16:45:42.205020
current #epochs=22, #steps=840
start validation
acc: 0.843602
AUC: 0.934969
Avg Precision: 0.365902
Avg Recall: 1.000000
d_prime: 2.140914
train_loss: 0.032281
valid_loss: 1.002211
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0016386291773052978
Epoch-22 lr: 0.0016386291773052978
epoch 22 training time: 14.995
---------------
2023-09-11 16:45:57.200561
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00564	Train Loss 0.0239	
start validation
acc: 0.843602
AUC: 0.933290
Avg Precision: 0.355112
Avg Recall: 1.000000
d_prime: 2.122377
train_loss: 0.032567
valid_loss: 0.993604
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0016386291773052978
Epoch-23 lr: 0.0016386291773052978
epoch 23 training time: 14.970
---------------
2023-09-11 16:46:12.170156
current #epochs=24, #steps=920
start validation
acc: 0.829384
AUC: 0.928395
Avg Precision: 0.352934
Avg Recall: 1.000000
d_prime: 2.070324
train_loss: 0.028138
valid_loss: 0.993193
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0016386291773052978
Epoch-24 lr: 0.0016386291773052978
epoch 24 training time: 15.508
---------------
2023-09-11 16:46:27.678426
current #epochs=25, #steps=960
start validation
acc: 0.848341
AUC: 0.931462
Avg Precision: 0.345541
Avg Recall: 1.000000
d_prime: 2.102613
train_loss: 0.044891
valid_loss: 1.006192
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0016386291773052978
Epoch-25 lr: 0.0016386291773052978
epoch 25 training time: 15.125
---------------
2023-09-11 16:46:42.803407
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03565	Per Sample Data Time 0.02828	Per Sample DNN Time 0.00737	Train Loss 0.0083	
start validation
acc: 0.829384
AUC: 0.940884
Avg Precision: 0.361421
Avg Recall: 1.000000
d_prime: 2.209342
train_loss: 0.029441
valid_loss: 0.978754
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.001345992316447878
Epoch-26 lr: 0.001345992316447878
epoch 26 training time: 15.025
---------------
2023-09-11 16:46:57.828789
current #epochs=27, #steps=1040
start validation
acc: 0.819905
AUC: 0.931365
Avg Precision: 0.351184
Avg Recall: 1.000000
d_prime: 2.101573
train_loss: 0.029835
valid_loss: 0.991437
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.001345992316447878
Epoch-27 lr: 0.001345992316447878
epoch 27 training time: 15.239
---------------
2023-09-11 16:47:13.067406
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00559	Train Loss 0.0336	
start validation
acc: 0.848341
AUC: 0.940430
Avg Precision: 0.343131
Avg Recall: 1.000000
d_prime: 2.203902
train_loss: 0.033577
valid_loss: 0.991712
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.001345992316447878
Epoch-28 lr: 0.001345992316447878
epoch 28 training time: 14.996
---------------
2023-09-11 16:47:28.063657
current #epochs=29, #steps=1120
start validation
acc: 0.853081
AUC: 0.940589
Avg Precision: 0.348722
Avg Recall: 1.000000
d_prime: 2.205804
train_loss: 0.022594
valid_loss: 0.977156
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.001345992316447878
Epoch-29 lr: 0.001345992316447878
epoch 29 training time: 15.095
---------------
2023-09-11 16:47:43.159042
current #epochs=30, #steps=1160
start validation
acc: 0.848341
AUC: 0.945299
Avg Precision: 0.350097
Avg Recall: 1.000000
d_prime: 2.263990
train_loss: 0.024895
valid_loss: 0.978511
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.001345992316447878
Epoch-30 lr: 0.001345992316447878
epoch 30 training time: 15.076
---------------
2023-09-11 16:47:58.235007
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03660	Per Sample Data Time 0.02859	Per Sample DNN Time 0.00801	Train Loss 0.0273	
start validation
acc: 0.843602
AUC: 0.940483
Avg Precision: 0.346675
Avg Recall: 1.000000
d_prime: 2.204530
train_loss: 0.028895
valid_loss: 0.999177
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.001345992316447878
Epoch-31 lr: 0.001345992316447878
epoch 31 training time: 15.044
---------------
2023-09-11 16:48:13.278506
current #epochs=32, #steps=1240
start validation
acc: 0.834123
AUC: 0.939414
Avg Precision: 0.336844
Avg Recall: 1.000000
d_prime: 2.191849
train_loss: 0.025706
valid_loss: 0.985125
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.001345992316447878
Epoch-32 lr: 0.001345992316447878
epoch 32 training time: 15.336
---------------
2023-09-11 16:48:28.614317
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00570	Train Loss 0.0235	
start validation
acc: 0.848341
AUC: 0.929522
Avg Precision: 0.320227
Avg Recall: 1.000000
d_prime: 2.082063
train_loss: 0.029530
valid_loss: 0.988436
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.001345992316447878
Epoch-33 lr: 0.001345992316447878
epoch 33 training time: 15.163
---------------
2023-09-11 16:48:43.777047
current #epochs=34, #steps=1320
start validation
acc: 0.829384
AUC: 0.932351
Avg Precision: 0.315985
Avg Recall: 1.000000
d_prime: 2.112178
train_loss: 0.025758
valid_loss: 1.004820
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.001345992316447878
Epoch-34 lr: 0.001345992316447878
epoch 34 training time: 15.624
---------------
2023-09-11 16:48:59.401083
current #epochs=35, #steps=1360
start validation
acc: 0.848341
AUC: 0.928650
Avg Precision: 0.324274
Avg Recall: 1.000000
d_prime: 2.072964
train_loss: 0.036170
valid_loss: 1.000849
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.001345992316447878
Epoch-35 lr: 0.001345992316447878
epoch 35 training time: 16.297
---------------
2023-09-11 16:49:15.697732
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.04051	Per Sample Data Time 0.02964	Per Sample DNN Time 0.01086	Train Loss 0.0016	
start validation
acc: 0.848341
AUC: 0.932509
Avg Precision: 0.321488
Avg Recall: 1.000000
d_prime: 2.113888
train_loss: 0.028011
valid_loss: 0.978451
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0011056164146399684
Epoch-36 lr: 0.0011056164146399684
epoch 36 training time: 15.235
---------------
2023-09-11 16:49:30.933064
current #epochs=37, #steps=1440
start validation
acc: 0.834123
AUC: 0.931627
Avg Precision: 0.342294
Avg Recall: 1.000000
d_prime: 2.104375
train_loss: 0.021811
valid_loss: 0.990909
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0011056164146399684
Epoch-37 lr: 0.0011056164146399684
epoch 37 training time: 15.203
---------------
2023-09-11 16:49:46.136449
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00563	Train Loss 0.0276	
start validation
acc: 0.834123
AUC: 0.930212
Avg Precision: 0.324906
Avg Recall: 1.000000
d_prime: 2.089318
train_loss: 0.030060
valid_loss: 0.993253
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0011056164146399684
Epoch-38 lr: 0.0011056164146399684
epoch 38 training time: 16.694
---------------
2023-09-11 16:50:02.830641
current #epochs=39, #steps=1520
start validation
acc: 0.848341
AUC: 0.935134
Avg Precision: 0.311656
Avg Recall: 1.000000
d_prime: 2.142759
train_loss: 0.023217
valid_loss: 0.964231
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0011056164146399684
Epoch-39 lr: 0.0011056164146399684
epoch 39 training time: 15.193
---------------
2023-09-11 16:50:18.023254
current #epochs=40, #steps=1560
start validation
acc: 0.834123
AUC: 0.928991
Avg Precision: 0.313895
Avg Recall: 1.000000
d_prime: 2.076519
train_loss: 0.016997
valid_loss: 0.972770
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0011056164146399684
Epoch-40 lr: 0.0011056164146399684
epoch 40 training time: 16.179
---------------
2023-09-11 16:50:34.201973
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03564	Per Sample Data Time 0.02757	Per Sample DNN Time 0.00807	Train Loss 0.0001	
start validation
acc: 0.848341
AUC: 0.931028
Avg Precision: 0.309006
Avg Recall: 1.000000
d_prime: 2.097970
train_loss: 0.019632
valid_loss: 0.972331
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0011056164146399684
Epoch-41 lr: 0.0011056164146399684
epoch 41 training time: 15.015
---------------
2023-09-11 16:50:49.217259
current #epochs=42, #steps=1640
start validation
acc: 0.829384
AUC: 0.923691
Avg Precision: 0.302105
Avg Recall: 1.000000
d_prime: 2.022809
train_loss: 0.017403
valid_loss: 0.998161
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0011056164146399684
Epoch-42 lr: 0.0011056164146399684
epoch 42 training time: 15.030
---------------
2023-09-11 16:51:04.247440
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00564	Train Loss 0.0343	
start validation
acc: 0.819905
AUC: 0.920961
Avg Precision: 0.321770
Avg Recall: 1.000000
d_prime: 1.996257
train_loss: 0.033789
valid_loss: 0.989348
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0011056164146399684
Epoch-43 lr: 0.0011056164146399684
epoch 43 training time: 15.073
---------------
2023-09-11 16:51:19.320507
current #epochs=44, #steps=1720
start validation
acc: 0.796209
AUC: 0.934570
Avg Precision: 0.331256
Avg Recall: 1.000000
d_prime: 2.136481
train_loss: 0.028334
valid_loss: 0.983416
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0011056164146399684
Epoch-44 lr: 0.0011056164146399684
epoch 44 training time: 16.334
---------------
2023-09-11 16:51:35.654092
current #epochs=45, #steps=1760
start validation
acc: 0.819905
AUC: 0.923792
Avg Precision: 0.331922
Avg Recall: 1.000000
d_prime: 2.023810
train_loss: 0.021113
valid_loss: 0.996154
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0011056164146399684
Epoch-45 lr: 0.0011056164146399684
epoch 45 training time: 16.282
---------------
2023-09-11 16:51:51.936369
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03610	Per Sample Data Time 0.02878	Per Sample DNN Time 0.00731	Train Loss 0.0550	
start validation
acc: 0.834123
AUC: 0.925919
Avg Precision: 0.337188
Avg Recall: 1.000000
d_prime: 2.045030
train_loss: 0.023102
valid_loss: 0.996507
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.0009081683761369928
Epoch-46 lr: 0.0009081683761369928
epoch 46 training time: 15.048
---------------
2023-09-11 16:52:06.984075
current #epochs=47, #steps=1840
start validation
acc: 0.819905
AUC: 0.927650
Avg Precision: 0.331971
Avg Recall: 1.000000
d_prime: 2.062646
train_loss: 0.032768
valid_loss: 1.006148
validation finished
normal learning rate scheduler step
Epoch-47 lr: 0.0009081683761369928
Epoch-47 lr: 0.0009081683761369928
epoch 47 training time: 15.211
---------------
2023-09-11 16:52:22.195227
current #epochs=48, #steps=1880
Epoch: [48][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00563	Train Loss 0.0272	
start validation
acc: 0.824645
AUC: 0.932164
Avg Precision: 0.351595
Avg Recall: 1.000000
d_prime: 2.110152
train_loss: 0.022684
valid_loss: 0.990626
validation finished
normal learning rate scheduler step
Epoch-48 lr: 0.0009081683761369928
Epoch-48 lr: 0.0009081683761369928
epoch 48 training time: 15.067
---------------
2023-09-11 16:52:37.262178
current #epochs=49, #steps=1920
start validation
[I 2023-09-11 16:52:52,407] Trial 62 finished with value: 0.8720379146919431 and parameters: {'warmup': 'False', 'num_epochs': 49, 'batch_size': 61, 'lr-adaptschedule': 'True', 'lr': 0.002428605025360999, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.8214136151666377}. Best is trial 50 with value: 0.8815165876777251.
acc: 0.829384
AUC: 0.931683
Avg Precision: 0.329422
Avg Recall: 1.000000
d_prime: 2.104976
train_loss: 0.027843
valid_loss: 0.982581
validation finished
normal learning rate scheduler step
Epoch-49 lr: 0.0009081683761369928
Epoch-49 lr: 0.0009081683761369928
epoch 49 training time: 15.133
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863d9888b0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.837 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 16:52:52.447517
current #epochs=1, #steps=0
start validation
acc: 0.810427
AUC: 0.919525
Avg Precision: 0.346447
Avg Recall: 1.000000
d_prime: 1.982561
train_loss: 0.044160
valid_loss: 1.000161
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0021543838811847087
Epoch-1 lr: 0.0021543838811847087
epoch 1 training time: 17.868
---------------
2023-09-11 16:53:10.315761
current #epochs=2, #steps=40
start validation
acc: 0.810427
AUC: 0.937543
Avg Precision: 0.374182
Avg Recall: 1.000000
d_prime: 2.170066
train_loss: 0.046661
valid_loss: 1.009185
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0021543838811847087
Epoch-2 lr: 0.0021543838811847087
epoch 2 training time: 15.976
---------------
2023-09-11 16:53:26.291719
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00556	Train Loss 0.0510	
start validation
acc: 0.834123
AUC: 0.928074
Avg Precision: 0.334658
Avg Recall: 1.000000
d_prime: 2.067006
train_loss: 0.041749
valid_loss: 1.008654
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0021543838811847087
Epoch-3 lr: 0.0021543838811847087
epoch 3 training time: 18.816
---------------
2023-09-11 16:53:45.108051
current #epochs=4, #steps=120
start validation
acc: 0.848341
AUC: 0.948064
Avg Precision: 0.372713
Avg Recall: 1.000000
d_prime: 2.300028
train_loss: 0.032306
valid_loss: 0.977234
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0021543838811847087
Epoch-4 lr: 0.0021543838811847087
epoch 4 training time: 17.151
---------------
2023-09-11 16:54:02.258929
current #epochs=5, #steps=160
start validation
acc: 0.819905
AUC: 0.930806
Avg Precision: 0.336903
Avg Recall: 1.000000
d_prime: 2.095610
train_loss: 0.038520
valid_loss: 1.007997
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0021543838811847087
Epoch-5 lr: 0.0021543838811847087
epoch 5 training time: 15.160
---------------
2023-09-11 16:54:17.419035
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03845	Per Sample Data Time 0.02801	Per Sample DNN Time 0.01044	Train Loss 0.2173	
start validation
acc: 0.834123
AUC: 0.931775
Avg Precision: 0.343353
Avg Recall: 1.000000
d_prime: 2.105963
train_loss: 0.054440
valid_loss: 1.024241
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0018031099523687214
Epoch-6 lr: 0.0018031099523687214
epoch 6 training time: 15.077
---------------
2023-09-11 16:54:32.496625
current #epochs=7, #steps=240
start validation
acc: 0.829384
AUC: 0.926384
Avg Precision: 0.330519
Avg Recall: 1.000000
d_prime: 2.049732
train_loss: 0.043076
valid_loss: 1.027164
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0018031099523687214
Epoch-7 lr: 0.0018031099523687214
epoch 7 training time: 15.123
---------------
2023-09-11 16:54:47.619636
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00564	Train Loss 0.0316	
start validation
acc: 0.838863
AUC: 0.928971
Avg Precision: 0.348002
Avg Recall: 1.000000
d_prime: 2.076308
train_loss: 0.023319
valid_loss: 1.019768
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0018031099523687214
Epoch-8 lr: 0.0018031099523687214
epoch 8 training time: 15.837
---------------
2023-09-11 16:55:03.456554
current #epochs=9, #steps=320
start validation
acc: 0.824645
AUC: 0.922682
Avg Precision: 0.347458
Avg Recall: 1.000000
d_prime: 2.012916
train_loss: 0.026878
valid_loss: 1.026258
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0018031099523687214
Epoch-9 lr: 0.0018031099523687214
epoch 9 training time: 16.125
---------------
2023-09-11 16:55:19.581778
current #epochs=10, #steps=360
start validation
acc: 0.838863
AUC: 0.939278
Avg Precision: 0.332817
Avg Recall: 1.000000
d_prime: 2.190255
train_loss: 0.025711
valid_loss: 1.000494
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0018031099523687214
Epoch-10 lr: 0.0018031099523687214
epoch 10 training time: 15.107
---------------
2023-09-11 16:55:34.688324
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03641	Per Sample Data Time 0.02879	Per Sample DNN Time 0.00762	Train Loss 0.0251	
start validation
acc: 0.810427
AUC: 0.929260
Avg Precision: 0.322757
Avg Recall: 1.000000
d_prime: 2.079319
train_loss: 0.054150
valid_loss: 0.991667
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0018031099523687214
Epoch-11 lr: 0.0018031099523687214
epoch 11 training time: 16.118
---------------
2023-09-11 16:55:50.806238
current #epochs=12, #steps=440
start validation
acc: 0.800948
AUC: 0.929070
Avg Precision: 0.348449
Avg Recall: 1.000000
d_prime: 2.077335
train_loss: 0.033371
valid_loss: 0.997308
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0018031099523687214
Epoch-12 lr: 0.0018031099523687214
epoch 12 training time: 15.049
---------------
2023-09-11 16:56:05.855384
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00566	Train Loss 0.0296	
start validation
acc: 0.829384
AUC: 0.925651
Avg Precision: 0.345321
Avg Recall: 1.000000
d_prime: 2.042330
train_loss: 0.034400
valid_loss: 0.997079
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0018031099523687214
Epoch-13 lr: 0.0018031099523687214
epoch 13 training time: 15.244
---------------
2023-09-11 16:56:21.099134
current #epochs=14, #steps=520
start validation
acc: 0.819905
AUC: 0.924699
Avg Precision: 0.338694
Avg Recall: 1.000000
d_prime: 2.032804
train_loss: 0.031011
valid_loss: 1.003884
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0018031099523687214
Epoch-14 lr: 0.0018031099523687214
epoch 14 training time: 15.088
---------------
2023-09-11 16:56:36.187705
current #epochs=15, #steps=560
start validation
acc: 0.829384
AUC: 0.928260
Avg Precision: 0.341009
Avg Recall: 1.000000
d_prime: 2.068933
train_loss: 0.039128
valid_loss: 1.008161
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0018031099523687214
Epoch-15 lr: 0.0018031099523687214
epoch 15 training time: 15.939
---------------
2023-09-11 16:56:52.126692
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03860	Per Sample Data Time 0.02823	Per Sample DNN Time 0.01037	Train Loss 0.0119	
start validation
acc: 0.829384
AUC: 0.926903
Avg Precision: 0.349182
Avg Recall: 1.000000
d_prime: 2.055001
train_loss: 0.039726
valid_loss: 1.030493
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.001509111504558452
Epoch-16 lr: 0.001509111504558452
epoch 16 training time: 15.117
---------------
2023-09-11 16:57:07.243468
current #epochs=17, #steps=640
start validation
acc: 0.857820
AUC: 0.923076
Avg Precision: 0.324190
Avg Recall: 1.000000
d_prime: 2.016767
train_loss: 0.036658
valid_loss: 0.995076
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.001509111504558452
Epoch-17 lr: 0.001509111504558452
epoch 17 training time: 17.213
---------------
2023-09-11 16:57:24.456332
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00566	Train Loss 0.0228	
start validation
acc: 0.843602
AUC: 0.918299
Avg Precision: 0.324674
Avg Recall: 1.000000
d_prime: 1.971015
train_loss: 0.023607
valid_loss: 1.000097
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001509111504558452
Epoch-18 lr: 0.001509111504558452
epoch 18 training time: 14.918
---------------
2023-09-11 16:57:39.374701
current #epochs=19, #steps=720
start validation
acc: 0.834123
AUC: 0.928107
Avg Precision: 0.331431
Avg Recall: 1.000000
d_prime: 2.067347
train_loss: 0.034736
valid_loss: 0.996401
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.001509111504558452
Epoch-19 lr: 0.001509111504558452
epoch 19 training time: 14.889
---------------
2023-09-11 16:57:54.263567
current #epochs=20, #steps=760
start validation
acc: 0.815166
AUC: 0.929970
Avg Precision: 0.355555
Avg Recall: 1.000000
d_prime: 2.086763
train_loss: 0.034413
valid_loss: 1.011771
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.001509111504558452
Epoch-20 lr: 0.001509111504558452
epoch 20 training time: 15.452
---------------
2023-09-11 16:58:09.715711
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03871	Per Sample Data Time 0.02763	Per Sample DNN Time 0.01108	Train Loss 0.0316	
start validation
acc: 0.834123
AUC: 0.924990
Avg Precision: 0.344025
Avg Recall: 1.000000
d_prime: 2.035706
train_loss: 0.022676
valid_loss: 1.011025
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.001509111504558452
Epoch-21 lr: 0.001509111504558452
epoch 21 training time: 15.281
---------------
2023-09-11 16:58:24.997123
current #epochs=22, #steps=840
start validation
acc: 0.829384
AUC: 0.934749
Avg Precision: 0.366286
Avg Recall: 1.000000
d_prime: 2.138465
train_loss: 0.031799
valid_loss: 1.008045
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.001509111504558452
Epoch-22 lr: 0.001509111504558452
epoch 22 training time: 15.064
---------------
2023-09-11 16:58:40.061407
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00562	Train Loss 0.0184	
start validation
acc: 0.838863
AUC: 0.935478
Avg Precision: 0.342116
Avg Recall: 1.000000
d_prime: 2.146615
train_loss: 0.030928
valid_loss: 0.997500
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.001509111504558452
Epoch-23 lr: 0.001509111504558452
epoch 23 training time: 15.048
---------------
2023-09-11 16:58:55.109851
current #epochs=24, #steps=920
start validation
acc: 0.824645
AUC: 0.936495
Avg Precision: 0.351948
Avg Recall: 1.000000
d_prime: 2.158087
train_loss: 0.026712
valid_loss: 1.003793
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.001509111504558452
Epoch-24 lr: 0.001509111504558452
epoch 24 training time: 15.448
---------------
2023-09-11 16:59:10.558342
current #epochs=25, #steps=960
start validation
acc: 0.853081
AUC: 0.931331
Avg Precision: 0.340389
Avg Recall: 1.000000
d_prime: 2.101209
train_loss: 0.026945
valid_loss: 1.000537
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.001509111504558452
Epoch-25 lr: 0.001509111504558452
epoch 25 training time: 15.060
---------------
2023-09-11 16:59:25.618105
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03741	Per Sample Data Time 0.02964	Per Sample DNN Time 0.00777	Train Loss 0.0189	
start validation
acc: 0.857820
AUC: 0.936868
Avg Precision: 0.350445
Avg Recall: 1.000000
d_prime: 2.162333
train_loss: 0.022298
valid_loss: 1.009118
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0012630497270556694
Epoch-26 lr: 0.0012630497270556694
epoch 26 training time: 15.125
---------------
2023-09-11 16:59:40.743765
current #epochs=27, #steps=1040
start validation
acc: 0.819905
AUC: 0.937079
Avg Precision: 0.339562
Avg Recall: 1.000000
d_prime: 2.164746
train_loss: 0.026523
valid_loss: 0.994726
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0012630497270556694
Epoch-27 lr: 0.0012630497270556694
epoch 27 training time: 15.139
---------------
2023-09-11 16:59:55.882996
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00562	Train Loss 0.0404	
start validation
acc: 0.819905
AUC: 0.926263
Avg Precision: 0.337612
Avg Recall: 1.000000
d_prime: 2.048507
train_loss: 0.030671
valid_loss: 1.013045
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0012630497270556694
Epoch-28 lr: 0.0012630497270556694
epoch 28 training time: 15.149
---------------
2023-09-11 17:00:11.031798
current #epochs=29, #steps=1120
start validation
acc: 0.834123
AUC: 0.911152
Avg Precision: 0.330428
Avg Recall: 1.000000
d_prime: 1.906196
train_loss: 0.024013
valid_loss: 1.005425
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0012630497270556694
Epoch-29 lr: 0.0012630497270556694
epoch 29 training time: 15.513
---------------
2023-09-11 17:00:26.545344
current #epochs=30, #steps=1160
start validation
acc: 0.838863
AUC: 0.926468
Avg Precision: 0.332876
Avg Recall: 1.000000
d_prime: 2.050581
train_loss: 0.028700
valid_loss: 0.998721
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0012630497270556694
Epoch-30 lr: 0.0012630497270556694
epoch 30 training time: 15.641
---------------
2023-09-11 17:00:42.186598
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03688	Per Sample Data Time 0.02914	Per Sample DNN Time 0.00774	Train Loss 0.1041	
start validation
acc: 0.834123
AUC: 0.931541
Avg Precision: 0.340059
Avg Recall: 1.000000
d_prime: 2.103451
train_loss: 0.017339
valid_loss: 0.997871
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0012630497270556694
Epoch-31 lr: 0.0012630497270556694
epoch 31 training time: 16.306
---------------
2023-09-11 17:00:58.492223
current #epochs=32, #steps=1240
start validation
acc: 0.810427
AUC: 0.929385
Avg Precision: 0.337325
Avg Recall: 1.000000
d_prime: 2.080633
train_loss: 0.032431
valid_loss: 0.990887
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0012630497270556694
Epoch-32 lr: 0.0012630497270556694
epoch 32 training time: 15.058
---------------
2023-09-11 17:01:13.550068
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00566	Train Loss 0.0284	
start validation
acc: 0.843602
AUC: 0.931852
Avg Precision: 0.351217
Avg Recall: 1.000000
d_prime: 2.106787
train_loss: 0.030162
valid_loss: 0.986854
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0012630497270556694
Epoch-33 lr: 0.0012630497270556694
epoch 33 training time: 15.127
---------------
2023-09-11 17:01:28.677738
current #epochs=34, #steps=1320
start validation
acc: 0.829384
AUC: 0.936713
Avg Precision: 0.359781
Avg Recall: 1.000000
d_prime: 2.160571
train_loss: 0.027425
valid_loss: 1.001976
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0012630497270556694
Epoch-34 lr: 0.0012630497270556694
epoch 34 training time: 15.188
---------------
2023-09-11 17:01:43.865353
current #epochs=35, #steps=1360
start validation
acc: 0.815166
AUC: 0.928871
Avg Precision: 0.363850
Avg Recall: 1.000000
d_prime: 2.075266
train_loss: 0.027290
valid_loss: 1.009284
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0012630497270556694
Epoch-35 lr: 0.0012630497270556694
epoch 35 training time: 15.001
---------------
2023-09-11 17:01:58.866582
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03717	Per Sample Data Time 0.02778	Per Sample DNN Time 0.00939	Train Loss 0.0145	
start validation
acc: 0.853081
AUC: 0.939389
Avg Precision: 0.367732
Avg Recall: 1.000000
d_prime: 2.191560
train_loss: 0.039438
valid_loss: 0.979045
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.001057108509342499
Epoch-36 lr: 0.001057108509342499
epoch 36 training time: 15.080
---------------
2023-09-11 17:02:13.946605
current #epochs=37, #steps=1440
start validation
acc: 0.853081
AUC: 0.941481
Avg Precision: 0.360768
Avg Recall: 1.000000
d_prime: 2.216534
train_loss: 0.037546
valid_loss: 0.969621
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.001057108509342499
Epoch-37 lr: 0.001057108509342499
epoch 37 training time: 15.122
---------------
2023-09-11 17:02:29.068217
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00565	Train Loss 0.0342	
start validation
acc: 0.848341
AUC: 0.939465
Avg Precision: 0.369463
Avg Recall: 1.000000
d_prime: 2.192453
train_loss: 0.029373
valid_loss: 0.975947
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.001057108509342499
Epoch-38 lr: 0.001057108509342499
epoch 38 training time: 15.194
---------------
2023-09-11 17:02:44.262365
current #epochs=39, #steps=1520
start validation
acc: 0.848341
AUC: 0.939771
Avg Precision: 0.365183
Avg Recall: 1.000000
d_prime: 2.196063
train_loss: 0.017288
valid_loss: 0.973962
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.001057108509342499
Epoch-39 lr: 0.001057108509342499
epoch 39 training time: 15.063
---------------
2023-09-11 17:02:59.325457
current #epochs=40, #steps=1560
start validation
acc: 0.857820
AUC: 0.939232
Avg Precision: 0.362233
Avg Recall: 1.000000
d_prime: 2.189707
train_loss: 0.013477
valid_loss: 0.971142
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.001057108509342499
Epoch-40 lr: 0.001057108509342499
epoch 40 training time: 15.149
---------------
2023-09-11 17:03:14.473972
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03636	Per Sample Data Time 0.02868	Per Sample DNN Time 0.00768	Train Loss 0.0175	
start validation
acc: 0.848341
AUC: 0.933398
Avg Precision: 0.339181
Avg Recall: 1.000000
d_prime: 2.123566
train_loss: 0.032481
valid_loss: 1.003419
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.001057108509342499
Epoch-41 lr: 0.001057108509342499
epoch 41 training time: 15.112
---------------
2023-09-11 17:03:29.585589
current #epochs=42, #steps=1640
start validation
acc: 0.853081
AUC: 0.936098
Avg Precision: 0.336079
Avg Recall: 1.000000
d_prime: 2.153592
train_loss: 0.023845
valid_loss: 0.971693
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.001057108509342499
Epoch-42 lr: 0.001057108509342499
epoch 42 training time: 15.566
---------------
2023-09-11 17:03:45.151902
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00566	Train Loss 0.0198	
start validation
acc: 0.867299
AUC: 0.940305
Avg Precision: 0.324528
Avg Recall: 1.000000
d_prime: 2.202412
train_loss: 0.016775
valid_loss: 0.955151
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.001057108509342499
Epoch-43 lr: 0.001057108509342499
epoch 43 training time: 17.000
---------------
2023-09-11 17:04:02.151865
current #epochs=44, #steps=1720
start validation
acc: 0.834123
AUC: 0.944616
Avg Precision: 0.367616
Avg Recall: 1.000000
d_prime: 2.255324
train_loss: 0.016674
valid_loss: 0.966056
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.001057108509342499
Epoch-44 lr: 0.001057108509342499
epoch 44 training time: 15.886
---------------
2023-09-11 17:04:18.038500
current #epochs=45, #steps=1760
start validation
acc: 0.848341
AUC: 0.936249
Avg Precision: 0.359550
Avg Recall: 1.000000
d_prime: 2.155295
train_loss: 0.020382
valid_loss: 1.008276
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.001057108509342499
Epoch-45 lr: 0.001057108509342499
epoch 45 training time: 16.163
---------------
2023-09-11 17:04:34.201327
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03869	Per Sample Data Time 0.02808	Per Sample DNN Time 0.01061	Train Loss 0.0005	
start validation
acc: 0.824645
AUC: 0.921485
Avg Precision: 0.343665
Avg Recall: 1.000000
d_prime: 2.001295
train_loss: 0.036477
valid_loss: 1.018666
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.0008847461636600051
Epoch-46 lr: 0.0008847461636600051
epoch 46 training time: 15.154
---------------
2023-09-11 17:04:49.355661
current #epochs=47, #steps=1840
start validation
acc: 0.838863
AUC: 0.940257
Avg Precision: 0.345770
Avg Recall: 1.000000
d_prime: 2.201833
train_loss: 0.024944
valid_loss: 0.986329
validation finished
normal learning rate scheduler step
Epoch-47 lr: 0.0008847461636600051
Epoch-47 lr: 0.0008847461636600051
epoch 47 training time: 15.211
---------------
2023-09-11 17:05:04.567069
current #epochs=48, #steps=1880
Epoch: [48][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00562	Train Loss 0.0179	
start validation
[I 2023-09-11 17:05:19,644] Trial 63 finished with value: 0.8672985781990521 and parameters: {'warmup': 'False', 'num_epochs': 48, 'batch_size': 59, 'lr-adaptschedule': 'True', 'lr': 0.0021543838811847087, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.8369492401591774}. Best is trial 50 with value: 0.8815165876777251.
acc: 0.848341
AUC: 0.944535
Avg Precision: 0.348101
Avg Recall: 1.000000
d_prime: 2.254295
train_loss: 0.017599
valid_loss: 0.969025
validation finished
normal learning rate scheduler step
Epoch-48 lr: 0.0008847461636600051
Epoch-48 lr: 0.0008847461636600051
epoch 48 training time: 15.063
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f8667020af0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.821 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 17:05:19.681724
current #epochs=1, #steps=0
start validation
acc: 0.838863
AUC: 0.919637
Avg Precision: 0.336662
Avg Recall: 1.000000
d_prime: 1.983620
train_loss: 0.033454
valid_loss: 0.992275
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002061951042882386
Epoch-1 lr: 0.002061951042882386
epoch 1 training time: 19.096
---------------
2023-09-11 17:05:38.777966
current #epochs=2, #steps=40
start validation
acc: 0.857820
AUC: 0.925997
Avg Precision: 0.355082
Avg Recall: 1.000000
d_prime: 2.045819
train_loss: 0.031197
valid_loss: 1.024548
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002061951042882386
Epoch-2 lr: 0.002061951042882386
epoch 2 training time: 17.040
---------------
2023-09-11 17:05:55.818242
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00162	Per Sample DNN Time 0.00556	Train Loss 0.0320	
start validation
acc: 0.786730
AUC: 0.926958
Avg Precision: 0.366401
Avg Recall: 1.000000
d_prime: 2.055563
train_loss: 0.034987
valid_loss: 1.028413
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002061951042882386
Epoch-3 lr: 0.002061951042882386
epoch 3 training time: 15.394
---------------
2023-09-11 17:06:11.212102
current #epochs=4, #steps=120
start validation
acc: 0.819905
AUC: 0.908179
Avg Precision: 0.322512
Avg Recall: 1.000000
d_prime: 1.880370
train_loss: 0.038152
valid_loss: 1.040279
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002061951042882386
Epoch-4 lr: 0.002061951042882386
epoch 4 training time: 15.838
---------------
2023-09-11 17:06:27.050243
current #epochs=5, #steps=160
start validation
acc: 0.829384
AUC: 0.926271
Avg Precision: 0.350495
Avg Recall: 1.000000
d_prime: 2.048587
train_loss: 0.036722
valid_loss: 0.993175
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002061951042882386
Epoch-5 lr: 0.002061951042882386
epoch 5 training time: 15.116
---------------
2023-09-11 17:06:42.165910
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03754	Per Sample Data Time 0.03033	Per Sample DNN Time 0.00721	Train Loss 0.0221	
start validation
acc: 0.810427
AUC: 0.928247
Avg Precision: 0.358030
Avg Recall: 1.000000
d_prime: 2.068795
train_loss: 0.016811
valid_loss: 1.017279
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0016919936420949377
Epoch-6 lr: 0.0016919936420949377
epoch 6 training time: 15.187
---------------
2023-09-11 17:06:57.353167
current #epochs=7, #steps=240
start validation
acc: 0.824645
AUC: 0.930440
Avg Precision: 0.361687
Avg Recall: 1.000000
d_prime: 2.091733
train_loss: 0.023259
valid_loss: 0.984437
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0016919936420949377
Epoch-7 lr: 0.0016919936420949377
epoch 7 training time: 15.191
---------------
2023-09-11 17:07:12.544469
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00567	Train Loss 0.0400	
start validation
acc: 0.815166
AUC: 0.929476
Avg Precision: 0.343723
Avg Recall: 1.000000
d_prime: 2.081581
train_loss: 0.037104
valid_loss: 1.017529
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0016919936420949377
Epoch-8 lr: 0.0016919936420949377
epoch 8 training time: 15.631
---------------
2023-09-11 17:07:28.175110
current #epochs=9, #steps=320
start validation
acc: 0.824645
AUC: 0.928051
Avg Precision: 0.348955
Avg Recall: 1.000000
d_prime: 2.066775
train_loss: 0.028910
valid_loss: 1.017643
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0016919936420949377
Epoch-9 lr: 0.0016919936420949377
epoch 9 training time: 16.016
---------------
2023-09-11 17:07:44.191419
current #epochs=10, #steps=360
start validation
acc: 0.819905
AUC: 0.927636
Avg Precision: 0.335240
Avg Recall: 1.000000
d_prime: 2.062497
train_loss: 0.030251
valid_loss: 0.983665
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0016919936420949377
Epoch-10 lr: 0.0016919936420949377
epoch 10 training time: 15.043
---------------
2023-09-11 17:07:59.234444
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03779	Per Sample Data Time 0.02764	Per Sample DNN Time 0.01015	Train Loss 0.0402	
start validation
acc: 0.838863
AUC: 0.930359
Avg Precision: 0.373052
Avg Recall: 1.000000
d_prime: 2.090871
train_loss: 0.029911
valid_loss: 1.004595
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0016919936420949377
Epoch-11 lr: 0.0016919936420949377
epoch 11 training time: 18.078
---------------
2023-09-11 17:08:17.312194
current #epochs=12, #steps=440
start validation
acc: 0.810427
AUC: 0.912029
Avg Precision: 0.359971
Avg Recall: 1.000000
d_prime: 1.913936
train_loss: 0.031238
valid_loss: 1.024726
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0016919936420949377
Epoch-12 lr: 0.0016919936420949377
epoch 12 training time: 17.154
---------------
2023-09-11 17:08:34.465988
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00561	Train Loss 0.0430	
start validation
acc: 0.853081
AUC: 0.915336
Avg Precision: 0.334787
Avg Recall: 1.000000
d_prime: 1.943648
train_loss: 0.040313
valid_loss: 0.994652
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0016919936420949377
Epoch-13 lr: 0.0016919936420949377
epoch 13 training time: 15.083
---------------
2023-09-11 17:08:49.548888
current #epochs=14, #steps=520
start validation
acc: 0.843602
AUC: 0.919817
Avg Precision: 0.342133
Avg Recall: 1.000000
d_prime: 1.985330
train_loss: 0.025743
valid_loss: 0.985906
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0016919936420949377
Epoch-14 lr: 0.0016919936420949377
epoch 14 training time: 15.176
---------------
2023-09-11 17:09:04.724358
current #epochs=15, #steps=560
start validation
acc: 0.838863
AUC: 0.937751
Avg Precision: 0.373371
Avg Recall: 1.000000
d_prime: 2.172466
train_loss: 0.021718
valid_loss: 0.979482
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.001388414382956322
Epoch-15 lr: 0.001388414382956322
epoch 15 training time: 15.070
---------------
2023-09-11 17:09:19.794262
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03594	Per Sample Data Time 0.02823	Per Sample DNN Time 0.00771	Train Loss 0.1425	
start validation
acc: 0.838863
AUC: 0.919031
Avg Precision: 0.353366
Avg Recall: 1.000000
d_prime: 1.977896
train_loss: 0.026407
valid_loss: 1.007096
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.001388414382956322
Epoch-16 lr: 0.001388414382956322
epoch 16 training time: 15.951
---------------
2023-09-11 17:09:35.745605
current #epochs=17, #steps=640
start validation
acc: 0.829384
AUC: 0.923726
Avg Precision: 0.357428
Avg Recall: 1.000000
d_prime: 2.023163
train_loss: 0.027557
valid_loss: 1.015735
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.001388414382956322
Epoch-17 lr: 0.001388414382956322
epoch 17 training time: 16.936
---------------
2023-09-11 17:09:52.682076
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00563	Train Loss 0.0214	
start validation
acc: 0.824645
AUC: 0.921279
Avg Precision: 0.341070
Avg Recall: 1.000000
d_prime: 1.999312
train_loss: 0.019112
valid_loss: 1.005501
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001388414382956322
Epoch-18 lr: 0.001388414382956322
epoch 18 training time: 15.164
---------------
2023-09-11 17:10:07.845543
current #epochs=19, #steps=720
start validation
acc: 0.829384
AUC: 0.930914
Avg Precision: 0.366145
Avg Recall: 1.000000
d_prime: 2.096760
train_loss: 0.012599
valid_loss: 1.000006
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.001388414382956322
Epoch-19 lr: 0.001388414382956322
epoch 19 training time: 15.022
---------------
2023-09-11 17:10:22.868074
current #epochs=20, #steps=760
start validation
acc: 0.834123
AUC: 0.931510
Avg Precision: 0.347282
Avg Recall: 1.000000
d_prime: 2.103119
train_loss: 0.022799
valid_loss: 1.004281
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.001388414382956322
Epoch-20 lr: 0.001388414382956322
epoch 20 training time: 16.025
---------------
2023-09-11 17:10:38.893474
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03646	Per Sample Data Time 0.02836	Per Sample DNN Time 0.00810	Train Loss 0.0026	
start validation
acc: 0.834123
AUC: 0.934945
Avg Precision: 0.375136
Avg Recall: 1.000000
d_prime: 2.140649
train_loss: 0.025062
valid_loss: 0.991374
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.001388414382956322
Epoch-21 lr: 0.001388414382956322
epoch 21 training time: 15.134
---------------
2023-09-11 17:10:54.027563
current #epochs=22, #steps=840
start validation
acc: 0.824645
AUC: 0.917537
Avg Precision: 0.361445
Avg Recall: 1.000000
d_prime: 1.963911
train_loss: 0.028610
valid_loss: 1.002549
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.001388414382956322
Epoch-22 lr: 0.001388414382956322
epoch 22 training time: 16.676
---------------
2023-09-11 17:11:10.703371
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00732	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00575	Train Loss 0.0153	
start validation
acc: 0.829384
AUC: 0.918447
Avg Precision: 0.349245
Avg Recall: 1.000000
d_prime: 1.972406
train_loss: 0.027875
valid_loss: 0.983780
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.001388414382956322
Epoch-23 lr: 0.001388414382956322
epoch 23 training time: 15.256
---------------
2023-09-11 17:11:25.959193
current #epochs=24, #steps=920
start validation
acc: 0.838863
AUC: 0.927267
Avg Precision: 0.355234
Avg Recall: 1.000000
d_prime: 2.058717
train_loss: 0.018904
valid_loss: 0.984897
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00113930363025077
Epoch-24 lr: 0.00113930363025077
epoch 24 training time: 15.051
---------------
2023-09-11 17:11:41.009866
current #epochs=25, #steps=960
start validation
acc: 0.819905
AUC: 0.917005
Avg Precision: 0.351455
Avg Recall: 1.000000
d_prime: 1.958976
train_loss: 0.029187
valid_loss: 1.008106
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00113930363025077
Epoch-25 lr: 0.00113930363025077
epoch 25 training time: 15.061
---------------
2023-09-11 17:11:56.070543
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03982	Per Sample Data Time 0.02919	Per Sample DNN Time 0.01063	Train Loss 0.0531	
start validation
acc: 0.838863
AUC: 0.927704
Avg Precision: 0.346487
Avg Recall: 1.000000
d_prime: 2.063198
train_loss: 0.024437
valid_loss: 0.999738
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00113930363025077
Epoch-26 lr: 0.00113930363025077
epoch 26 training time: 15.238
---------------
2023-09-11 17:12:11.308265
current #epochs=27, #steps=1040
start validation
acc: 0.843602
AUC: 0.926447
Avg Precision: 0.338864
Avg Recall: 1.000000
d_prime: 2.050367
train_loss: 0.020180
valid_loss: 0.998677
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00113930363025077
Epoch-27 lr: 0.00113930363025077
epoch 27 training time: 15.074
---------------
2023-09-11 17:12:26.382253
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00559	Train Loss 0.0301	
start validation
acc: 0.848341
AUC: 0.931709
Avg Precision: 0.356509
Avg Recall: 1.000000
d_prime: 2.105254
train_loss: 0.027051
valid_loss: 1.004745
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00113930363025077
Epoch-28 lr: 0.00113930363025077
epoch 28 training time: 14.996
---------------
2023-09-11 17:12:41.378666
current #epochs=29, #steps=1120
start validation
acc: 0.829384
AUC: 0.932157
Avg Precision: 0.335423
Avg Recall: 1.000000
d_prime: 2.110076
train_loss: 0.021005
valid_loss: 0.990716
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00113930363025077
Epoch-29 lr: 0.00113930363025077
epoch 29 training time: 15.205
---------------
2023-09-11 17:12:56.583609
current #epochs=30, #steps=1160
start validation
acc: 0.815166
AUC: 0.910916
Avg Precision: 0.332560
Avg Recall: 1.000000
d_prime: 1.904121
train_loss: 0.026576
valid_loss: 1.017633
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00113930363025077
Epoch-30 lr: 0.00113930363025077
epoch 30 training time: 15.512
---------------
2023-09-11 17:13:12.095585
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03631	Per Sample Data Time 0.02854	Per Sample DNN Time 0.00777	Train Loss 0.0682	
start validation
acc: 0.815166
AUC: 0.910380
Avg Precision: 0.331959
Avg Recall: 1.000000
d_prime: 1.899424
train_loss: 0.024159
valid_loss: 1.024579
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.00113930363025077
Epoch-31 lr: 0.00113930363025077
epoch 31 training time: 15.056
---------------
2023-09-11 17:13:27.151473
current #epochs=32, #steps=1240
start validation
acc: 0.805687
AUC: 0.909679
Avg Precision: 0.312959
Avg Recall: 1.000000
d_prime: 1.893324
train_loss: 0.038656
valid_loss: 1.003943
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00113930363025077
Epoch-32 lr: 0.00113930363025077
epoch 32 training time: 15.132
---------------
2023-09-11 17:13:42.283731
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00566	Train Loss 0.0363	
start validation
acc: 0.843602
AUC: 0.911511
Avg Precision: 0.341633
Avg Recall: 1.000000
d_prime: 1.909358
train_loss: 0.035464
valid_loss: 1.002957
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0009348885879003581
Epoch-33 lr: 0.0009348885879003581
epoch 33 training time: 15.137
---------------
2023-09-11 17:13:57.420563
current #epochs=34, #steps=1320
start validation
acc: 0.829384
AUC: 0.910760
Avg Precision: 0.347467
Avg Recall: 1.000000
d_prime: 1.902754
train_loss: 0.022672
valid_loss: 0.996759
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0009348885879003581
Epoch-34 lr: 0.0009348885879003581
epoch 34 training time: 15.046
---------------
2023-09-11 17:14:12.466519
current #epochs=35, #steps=1360
start validation
acc: 0.829384
AUC: 0.915301
Avg Precision: 0.354501
Avg Recall: 1.000000
d_prime: 1.943329
train_loss: 0.036646
valid_loss: 1.006906
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0009348885879003581
Epoch-35 lr: 0.0009348885879003581
epoch 35 training time: 15.176
---------------
2023-09-11 17:14:27.642405
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03685	Per Sample Data Time 0.02862	Per Sample DNN Time 0.00822	Train Loss 0.0008	
start validation
acc: 0.829384
AUC: 0.912478
Avg Precision: 0.329872
Avg Recall: 1.000000
d_prime: 1.917919
train_loss: 0.020615
valid_loss: 1.012743
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0009348885879003581
Epoch-36 lr: 0.0009348885879003581
epoch 36 training time: 15.177
---------------
2023-09-11 17:14:42.819260
current #epochs=37, #steps=1440
start validation
acc: 0.829384
AUC: 0.914325
Avg Precision: 0.330461
Avg Recall: 1.000000
d_prime: 1.934469
train_loss: 0.020651
valid_loss: 1.012571
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0009348885879003581
Epoch-37 lr: 0.0009348885879003581
epoch 37 training time: 15.157
---------------
2023-09-11 17:14:57.975923
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00722	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00566	Train Loss 0.0070	
start validation
acc: 0.838863
AUC: 0.914300
Avg Precision: 0.329240
Avg Recall: 1.000000
d_prime: 1.934250
train_loss: 0.010494
valid_loss: 1.011503
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0009348885879003581
Epoch-38 lr: 0.0009348885879003581
epoch 38 training time: 15.286
---------------
2023-09-11 17:15:13.262196
current #epochs=39, #steps=1520
start validation
acc: 0.843602
AUC: 0.903453
Avg Precision: 0.330450
Avg Recall: 1.000000
d_prime: 1.840575
train_loss: 0.023381
valid_loss: 1.029708
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0009348885879003581
Epoch-39 lr: 0.0009348885879003581
epoch 39 training time: 15.103
---------------
2023-09-11 17:15:28.365337
current #epochs=40, #steps=1560
start validation
acc: 0.834123
AUC: 0.900127
Avg Precision: 0.328294
Avg Recall: 1.000000
d_prime: 1.813408
train_loss: 0.012928
valid_loss: 1.029778
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0009348885879003581
Epoch-40 lr: 0.0009348885879003581
epoch 40 training time: 15.796
---------------
2023-09-11 17:15:44.160962
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03907	Per Sample Data Time 0.02843	Per Sample DNN Time 0.01064	Train Loss 0.0149	
start validation
acc: 0.843602
AUC: 0.903409
Avg Precision: 0.320490
Avg Recall: 1.000000
d_prime: 1.840208
train_loss: 0.018425
valid_loss: 1.030384
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0009348885879003581
Epoch-41 lr: 0.0009348885879003581
epoch 41 training time: 15.289
---------------
2023-09-11 17:15:59.450016
current #epochs=42, #steps=1640
start validation
acc: 0.815166
AUC: 0.915285
Avg Precision: 0.336478
Avg Recall: 1.000000
d_prime: 1.943185
train_loss: 0.024651
valid_loss: 1.016645
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0007671499050643308
Epoch-42 lr: 0.0007671499050643308
epoch 42 training time: 15.108
---------------
2023-09-11 17:16:14.557428
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00142	Per Sample DNN Time 0.00565	Train Loss 0.0174	
start validation
acc: 0.819905
AUC: 0.912883
Avg Precision: 0.339037
Avg Recall: 1.000000
d_prime: 1.921524
train_loss: 0.020543
valid_loss: 1.006548
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0007671499050643308
Epoch-43 lr: 0.0007671499050643308
epoch 43 training time: 15.028
---------------
2023-09-11 17:16:29.585214
current #epochs=44, #steps=1720
start validation
acc: 0.824645
AUC: 0.914913
Avg Precision: 0.339186
Avg Recall: 1.000000
d_prime: 1.939799
train_loss: 0.017765
valid_loss: 1.012679
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0007671499050643308
Epoch-44 lr: 0.0007671499050643308
epoch 44 training time: 15.909
---------------
2023-09-11 17:16:45.494446
current #epochs=45, #steps=1760
start validation
acc: 0.834123
AUC: 0.916236
Avg Precision: 0.338715
Avg Recall: 1.000000
d_prime: 1.951885
train_loss: 0.015317
valid_loss: 1.002867
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0007671499050643308
Epoch-45 lr: 0.0007671499050643308
epoch 45 training time: 15.160
---------------
2023-09-11 17:17:00.654126
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03648	Per Sample Data Time 0.02824	Per Sample DNN Time 0.00825	Train Loss 0.0253	
start validation
[I 2023-09-11 17:17:15,712] Trial 64 finished with value: 0.8578199052132701 and parameters: {'warmup': 'False', 'num_epochs': 46, 'batch_size': 58, 'lr-adaptschedule': 'True', 'lr': 0.002061951042882386, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.8205789598814687}. Best is trial 50 with value: 0.8815165876777251.
acc: 0.819905
AUC: 0.917210
Avg Precision: 0.354264
Avg Recall: 1.000000
d_prime: 1.960874
train_loss: 0.016759
valid_loss: 1.009970
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.0007671499050643308
Epoch-46 lr: 0.0007671499050643308
epoch 46 training time: 15.045
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f86670742b0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.809 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 17:17:15.749758
current #epochs=1, #steps=0
start validation
acc: 0.810427
AUC: 0.918507
Avg Precision: 0.359274
Avg Recall: 1.000000
d_prime: 1.972967
train_loss: 0.047607
valid_loss: 0.997006
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002193871563700652
Epoch-1 lr: 0.002193871563700652
epoch 1 training time: 17.357
---------------
2023-09-11 17:17:33.107075
current #epochs=2, #steps=40
start validation
acc: 0.810427
AUC: 0.916875
Avg Precision: 0.335644
Avg Recall: 1.000000
d_prime: 1.957776
train_loss: 0.034215
valid_loss: 1.000513
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002193871563700652
Epoch-2 lr: 0.002193871563700652
epoch 2 training time: 15.120
---------------
2023-09-11 17:17:48.227406
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00559	Train Loss 0.0416	
start validation
acc: 0.834123
AUC: 0.923327
Avg Precision: 0.357308
Avg Recall: 1.000000
d_prime: 2.019226
train_loss: 0.034222
valid_loss: 0.974171
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002193871563700652
Epoch-3 lr: 0.002193871563700652
epoch 3 training time: 17.674
---------------
2023-09-11 17:18:05.900726
current #epochs=4, #steps=120
start validation
acc: 0.853081
AUC: 0.929279
Avg Precision: 0.371544
Avg Recall: 1.000000
d_prime: 2.079515
train_loss: 0.023042
valid_loss: 0.971228
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002193871563700652
Epoch-4 lr: 0.002193871563700652
epoch 4 training time: 17.464
---------------
2023-09-11 17:18:23.365105
current #epochs=5, #steps=160
start validation
acc: 0.838863
AUC: 0.932892
Avg Precision: 0.346540
Avg Recall: 1.000000
d_prime: 2.118041
train_loss: 0.026062
valid_loss: 0.968860
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002193871563700652
Epoch-5 lr: 0.002193871563700652
epoch 5 training time: 15.187
---------------
2023-09-11 17:18:38.551783
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03583	Per Sample Data Time 0.02819	Per Sample DNN Time 0.00765	Train Loss 0.0177	
start validation
acc: 0.829384
AUC: 0.915567
Avg Precision: 0.341705
Avg Recall: 1.000000
d_prime: 1.945753
train_loss: 0.033192
valid_loss: 0.992055
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0017743448693219007
Epoch-6 lr: 0.0017743448693219007
epoch 6 training time: 15.048
---------------
2023-09-11 17:18:53.599917
current #epochs=7, #steps=240
start validation
acc: 0.853081
AUC: 0.930198
Avg Precision: 0.340168
Avg Recall: 1.000000
d_prime: 2.089175
train_loss: 0.044681
valid_loss: 1.012216
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0017743448693219007
Epoch-7 lr: 0.0017743448693219007
epoch 7 training time: 15.302
---------------
2023-09-11 17:19:08.901978
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00562	Train Loss 0.0395	
start validation
acc: 0.876777
AUC: 0.932420
Avg Precision: 0.329551
Avg Recall: 1.000000
d_prime: 2.112921
train_loss: 0.031811
valid_loss: 0.981460
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0017743448693219007
Epoch-8 lr: 0.0017743448693219007
epoch 8 training time: 17.015
---------------
2023-09-11 17:19:25.916698
current #epochs=9, #steps=320
start validation
acc: 0.843602
AUC: 0.922178
Avg Precision: 0.324911
Avg Recall: 1.000000
d_prime: 2.008011
train_loss: 0.029269
valid_loss: 1.005188
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0017743448693219007
Epoch-9 lr: 0.0017743448693219007
epoch 9 training time: 15.216
---------------
2023-09-11 17:19:41.132729
current #epochs=10, #steps=360
start validation
acc: 0.838863
AUC: 0.921184
Avg Precision: 0.313177
Avg Recall: 1.000000
d_prime: 1.998398
train_loss: 0.020655
valid_loss: 1.002313
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0017743448693219007
Epoch-10 lr: 0.0017743448693219007
epoch 10 training time: 15.700
---------------
2023-09-11 17:19:56.832020
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03937	Per Sample Data Time 0.02814	Per Sample DNN Time 0.01123	Train Loss 0.0021	
start validation
acc: 0.843602
AUC: 0.916241
Avg Precision: 0.317637
Avg Recall: 1.000000
d_prime: 1.951933
train_loss: 0.019179
valid_loss: 0.996805
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0017743448693219007
Epoch-11 lr: 0.0017743448693219007
epoch 11 training time: 15.204
---------------
2023-09-11 17:20:12.035722
current #epochs=12, #steps=440
start validation
acc: 0.800948
AUC: 0.919361
Avg Precision: 0.306831
Avg Recall: 1.000000
d_prime: 1.981009
train_loss: 0.032730
valid_loss: 1.011025
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0017743448693219007
Epoch-12 lr: 0.0017743448693219007
epoch 12 training time: 15.091
---------------
2023-09-11 17:20:27.126547
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00561	Train Loss 0.0453	
start validation
acc: 0.791469
AUC: 0.910002
Avg Precision: 0.307010
Avg Recall: 1.000000
d_prime: 1.896131
train_loss: 0.049337
valid_loss: 1.006734
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0017743448693219007
Epoch-13 lr: 0.0017743448693219007
epoch 13 training time: 15.867
---------------
2023-09-11 17:20:42.993525
current #epochs=14, #steps=520
start validation
acc: 0.838863
AUC: 0.930657
Avg Precision: 0.338101
Avg Recall: 1.000000
d_prime: 2.094030
train_loss: 0.029386
valid_loss: 0.973578
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0017743448693219007
Epoch-14 lr: 0.0017743448693219007
epoch 14 training time: 15.195
---------------
2023-09-11 17:20:58.188367
current #epochs=15, #steps=560
start validation
acc: 0.824645
AUC: 0.926748
Avg Precision: 0.335435
Avg Recall: 1.000000
d_prime: 2.053427
train_loss: 0.035203
valid_loss: 0.988971
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0017743448693219007
Epoch-15 lr: 0.0017743448693219007
epoch 15 training time: 15.142
---------------
2023-09-11 17:21:13.329751
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03652	Per Sample Data Time 0.02915	Per Sample DNN Time 0.00737	Train Loss 0.0309	
start validation
acc: 0.819905
AUC: 0.926539
Avg Precision: 0.371272
Avg Recall: 1.000000
d_prime: 2.051305
train_loss: 0.025734
valid_loss: 0.989009
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0014350428563732138
Epoch-16 lr: 0.0014350428563732138
epoch 16 training time: 15.140
---------------
2023-09-11 17:21:28.470249
current #epochs=17, #steps=640
start validation
acc: 0.848341
AUC: 0.932512
Avg Precision: 0.344593
Avg Recall: 1.000000
d_prime: 2.113911
train_loss: 0.023310
valid_loss: 0.992911
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0014350428563732138
Epoch-17 lr: 0.0014350428563732138
epoch 17 training time: 15.035
---------------
2023-09-11 17:21:43.505263
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00565	Train Loss 0.0227	
start validation
acc: 0.829384
AUC: 0.926124
Avg Precision: 0.342438
Avg Recall: 1.000000
d_prime: 2.047101
train_loss: 0.025480
valid_loss: 0.998652
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0014350428563732138
Epoch-18 lr: 0.0014350428563732138
epoch 18 training time: 15.201
---------------
2023-09-11 17:21:58.706075
current #epochs=19, #steps=720
start validation
acc: 0.796209
AUC: 0.910602
Avg Precision: 0.311599
Avg Recall: 1.000000
d_prime: 1.901369
train_loss: 0.030279
valid_loss: 1.011399
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0014350428563732138
Epoch-19 lr: 0.0014350428563732138
epoch 19 training time: 15.177
---------------
2023-09-11 17:22:13.882595
current #epochs=20, #steps=760
start validation
acc: 0.824645
AUC: 0.919428
Avg Precision: 0.320192
Avg Recall: 1.000000
d_prime: 1.981641
train_loss: 0.029051
valid_loss: 0.988762
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0014350428563732138
Epoch-20 lr: 0.0014350428563732138
epoch 20 training time: 15.776
---------------
2023-09-11 17:22:29.658613
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03590	Per Sample Data Time 0.02806	Per Sample DNN Time 0.00784	Train Loss 0.0512	
start validation
acc: 0.843602
AUC: 0.920361
Avg Precision: 0.321865
Avg Recall: 1.000000
d_prime: 1.990508
train_loss: 0.032146
valid_loss: 0.981511
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0014350428563732138
Epoch-21 lr: 0.0014350428563732138
epoch 21 training time: 15.069
---------------
2023-09-11 17:22:44.727390
current #epochs=22, #steps=840
start validation
acc: 0.843602
AUC: 0.910509
Avg Precision: 0.315385
Avg Recall: 1.000000
d_prime: 1.900559
train_loss: 0.017499
valid_loss: 0.995510
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0014350428563732138
Epoch-22 lr: 0.0014350428563732138
epoch 22 training time: 15.071
---------------
2023-09-11 17:22:59.798425
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00561	Train Loss 0.0618	
start validation
acc: 0.800948
AUC: 0.909067
Avg Precision: 0.326010
Avg Recall: 1.000000
d_prime: 1.888018
train_loss: 0.043758
valid_loss: 1.014740
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0014350428563732138
Epoch-23 lr: 0.0014350428563732138
epoch 23 training time: 15.118
---------------
2023-09-11 17:23:14.916180
current #epochs=24, #steps=920
start validation
acc: 0.843602
AUC: 0.908227
Avg Precision: 0.320801
Avg Recall: 1.000000
d_prime: 1.880781
train_loss: 0.033631
valid_loss: 1.003424
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0014350428563732138
Epoch-24 lr: 0.0014350428563732138
epoch 24 training time: 15.177
---------------
2023-09-11 17:23:30.093180
current #epochs=25, #steps=960
start validation
acc: 0.843602
AUC: 0.912519
Avg Precision: 0.334097
Avg Recall: 1.000000
d_prime: 1.918282
train_loss: 0.031089
valid_loss: 1.007939
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0014350428563732138
Epoch-25 lr: 0.0014350428563732138
epoch 25 training time: 15.051
---------------
2023-09-11 17:23:45.143709
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03835	Per Sample Data Time 0.02867	Per Sample DNN Time 0.00968	Train Loss 0.0030	
start validation
acc: 0.824645
AUC: 0.925210
Avg Precision: 0.356509
Avg Recall: 1.000000
d_prime: 2.037905
train_loss: 0.039185
valid_loss: 0.999868
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0011606244283360826
Epoch-26 lr: 0.0011606244283360826
epoch 26 training time: 15.218
---------------
2023-09-11 17:24:00.362071
current #epochs=27, #steps=1040
start validation
acc: 0.848341
AUC: 0.920804
Avg Precision: 0.326073
Avg Recall: 1.000000
d_prime: 1.994745
train_loss: 0.025919
valid_loss: 0.991625
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0011606244283360826
Epoch-27 lr: 0.0011606244283360826
epoch 27 training time: 15.094
---------------
2023-09-11 17:24:15.456321
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00722	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00567	Train Loss 0.0302	
start validation
acc: 0.857820
AUC: 0.920390
Avg Precision: 0.318225
Avg Recall: 1.000000
d_prime: 1.990792
train_loss: 0.027691
valid_loss: 0.994967
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0011606244283360826
Epoch-28 lr: 0.0011606244283360826
epoch 28 training time: 15.131
---------------
2023-09-11 17:24:30.587068
current #epochs=29, #steps=1120
start validation
acc: 0.834123
AUC: 0.927900
Avg Precision: 0.321711
Avg Recall: 1.000000
d_prime: 2.065212
train_loss: 0.024193
valid_loss: 0.990001
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0011606244283360826
Epoch-29 lr: 0.0011606244283360826
epoch 29 training time: 15.610
---------------
2023-09-11 17:24:46.197334
current #epochs=30, #steps=1160
start validation
acc: 0.834123
AUC: 0.930653
Avg Precision: 0.322059
Avg Recall: 1.000000
d_prime: 2.093987
train_loss: 0.017773
valid_loss: 0.988282
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0011606244283360826
Epoch-30 lr: 0.0011606244283360826
epoch 30 training time: 15.089
---------------
2023-09-11 17:25:01.286716
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03703	Per Sample Data Time 0.02875	Per Sample DNN Time 0.00828	Train Loss 0.0073	
start validation
acc: 0.857820
AUC: 0.922650
Avg Precision: 0.310109
Avg Recall: 1.000000
d_prime: 2.012604
train_loss: 0.018775
valid_loss: 0.991445
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0011606244283360826
Epoch-31 lr: 0.0011606244283360826
epoch 31 training time: 15.100
---------------
2023-09-11 17:25:16.386626
current #epochs=32, #steps=1240
start validation
acc: 0.843602
AUC: 0.926323
Avg Precision: 0.312580
Avg Recall: 1.000000
d_prime: 2.049115
train_loss: 0.022331
valid_loss: 0.989864
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0011606244283360826
Epoch-32 lr: 0.0011606244283360826
epoch 32 training time: 15.103
---------------
2023-09-11 17:25:31.489723
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00560	Train Loss 0.0267	
start validation
acc: 0.834123
AUC: 0.917020
Avg Precision: 0.305734
Avg Recall: 1.000000
d_prime: 1.959116
train_loss: 0.023600
valid_loss: 0.989704
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0011606244283360826
Epoch-33 lr: 0.0011606244283360826
epoch 33 training time: 15.008
---------------
2023-09-11 17:25:46.497259
current #epochs=34, #steps=1320
start validation
acc: 0.838863
AUC: 0.925824
Avg Precision: 0.329776
Avg Recall: 1.000000
d_prime: 2.044071
train_loss: 0.019857
valid_loss: 0.988529
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0011606244283360826
Epoch-34 lr: 0.0011606244283360826
epoch 34 training time: 14.924
---------------
2023-09-11 17:26:01.421459
current #epochs=35, #steps=1360
start validation
acc: 0.857820
AUC: 0.930482
Avg Precision: 0.347110
Avg Recall: 1.000000
d_prime: 2.092171
train_loss: 0.022718
valid_loss: 0.987060
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0011606244283360826
Epoch-35 lr: 0.0011606244283360826
epoch 35 training time: 15.070
---------------
2023-09-11 17:26:16.491202
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03536	Per Sample Data Time 0.02697	Per Sample DNN Time 0.00839	Train Loss 0.0039	
start validation
acc: 0.843602
AUC: 0.928109
Avg Precision: 0.322630
Avg Recall: 1.000000
d_prime: 2.067370
train_loss: 0.019323
valid_loss: 0.994792
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0009386821150797252
Epoch-36 lr: 0.0009386821150797252
epoch 36 training time: 15.030
---------------
2023-09-11 17:26:31.521505
current #epochs=37, #steps=1440
start validation
acc: 0.848341
AUC: 0.933167
Avg Precision: 0.337216
Avg Recall: 1.000000
d_prime: 2.121037
train_loss: 0.017304
valid_loss: 0.991669
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0009386821150797252
Epoch-37 lr: 0.0009386821150797252
epoch 37 training time: 15.123
---------------
2023-09-11 17:26:46.644936
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00562	Train Loss 0.0144	
start validation
acc: 0.853081
AUC: 0.927358
Avg Precision: 0.323691
Avg Recall: 1.000000
d_prime: 2.059653
train_loss: 0.016827
valid_loss: 0.995241
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0009386821150797252
Epoch-38 lr: 0.0009386821150797252
epoch 38 training time: 15.070
---------------
2023-09-11 17:27:01.715527
current #epochs=39, #steps=1520
start validation
acc: 0.834123
AUC: 0.926756
Avg Precision: 0.310591
Avg Recall: 1.000000
d_prime: 2.053510
train_loss: 0.020304
valid_loss: 0.990509
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0009386821150797252
Epoch-39 lr: 0.0009386821150797252
epoch 39 training time: 15.117
---------------
2023-09-11 17:27:16.832362
current #epochs=40, #steps=1560
start validation
acc: 0.824645
AUC: 0.924486
Avg Precision: 0.330522
Avg Recall: 1.000000
d_prime: 2.030685
train_loss: 0.024080
valid_loss: 0.999780
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0009386821150797252
Epoch-40 lr: 0.0009386821150797252
epoch 40 training time: 15.087
---------------
2023-09-11 17:27:31.919595
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03890	Per Sample Data Time 0.02886	Per Sample DNN Time 0.01005	Train Loss 0.0252	
start validation
acc: 0.800948
AUC: 0.921316
Avg Precision: 0.318167
Avg Recall: 1.000000
d_prime: 1.999664
train_loss: 0.025860
valid_loss: 0.997274
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0009386821150797252
Epoch-41 lr: 0.0009386821150797252
epoch 41 training time: 15.190
---------------
2023-09-11 17:27:47.109710
current #epochs=42, #steps=1640
start validation
acc: 0.824645
AUC: 0.930892
Avg Precision: 0.331162
Avg Recall: 1.000000
d_prime: 2.096523
train_loss: 0.028898
valid_loss: 0.980249
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0009386821150797252
Epoch-42 lr: 0.0009386821150797252
epoch 42 training time: 15.020
---------------
2023-09-11 17:28:02.128937
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00159	Per Sample DNN Time 0.00560	Train Loss 0.0107	
start validation
acc: 0.815166
AUC: 0.933228
Avg Precision: 0.358497
Avg Recall: 1.000000
d_prime: 2.121705
train_loss: 0.018383
valid_loss: 0.992446
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0009386821150797252
Epoch-43 lr: 0.0009386821150797252
epoch 43 training time: 15.123
---------------
2023-09-11 17:28:17.251727
current #epochs=44, #steps=1720
start validation
acc: 0.815166
AUC: 0.933275
Avg Precision: 0.354906
Avg Recall: 1.000000
d_prime: 2.122222
train_loss: 0.025105
valid_loss: 0.992881
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0009386821150797252
Epoch-44 lr: 0.0009386821150797252
epoch 44 training time: 15.075
---------------
2023-09-11 17:28:32.326268
current #epochs=45, #steps=1760
start validation
acc: 0.824645
AUC: 0.931215
Avg Precision: 0.353230
Avg Recall: 1.000000
d_prime: 2.099968
train_loss: 0.018412
valid_loss: 0.981950
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0009386821150797252
Epoch-45 lr: 0.0009386821150797252
epoch 45 training time: 15.050
---------------
2023-09-11 17:28:47.376764
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03801	Per Sample Data Time 0.03021	Per Sample DNN Time 0.00780	Train Loss 0.0002	
start validation
acc: 0.819905
AUC: 0.927438
Avg Precision: 0.350159
Avg Recall: 1.000000
d_prime: 2.060475
train_loss: 0.019107
valid_loss: 0.996724
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.0007591810853350391
Epoch-46 lr: 0.0007591810853350391
epoch 46 training time: 15.096
---------------
2023-09-11 17:29:02.473457
current #epochs=47, #steps=1840
start validation
acc: 0.819905
AUC: 0.929445
Avg Precision: 0.360000
Avg Recall: 1.000000
d_prime: 2.081251
train_loss: 0.026855
valid_loss: 0.993463
validation finished
normal learning rate scheduler step
Epoch-47 lr: 0.0007591810853350391
Epoch-47 lr: 0.0007591810853350391
epoch 47 training time: 15.255
---------------
2023-09-11 17:29:17.728900
current #epochs=48, #steps=1880
Epoch: [48][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00161	Per Sample DNN Time 0.00560	Train Loss 0.0207	
start validation
[I 2023-09-11 17:29:32,859] Trial 65 finished with value: 0.8767772511848341 and parameters: {'warmup': 'False', 'num_epochs': 48, 'batch_size': 49, 'lr-adaptschedule': 'True', 'lr': 0.002193871563700652, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.8087733569639382}. Best is trial 50 with value: 0.8815165876777251.
acc: 0.810427
AUC: 0.929736
Avg Precision: 0.361078
Avg Recall: 1.000000
d_prime: 2.084303
train_loss: 0.017323
valid_loss: 1.001011
validation finished
normal learning rate scheduler step
Epoch-48 lr: 0.0007591810853350391
Epoch-48 lr: 0.0007591810853350391
epoch 48 training time: 15.119
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f86448d1df0>
The learning rate scheduler starts at 7 epoch with decay rate of 0.813 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 17:29:32.896299
current #epochs=1, #steps=0
start validation
acc: 0.796209
AUC: 0.926629
Avg Precision: 0.347286
Avg Recall: 1.000000
d_prime: 2.052220
train_loss: 0.027604
valid_loss: 0.989298
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002120525984249882
Epoch-1 lr: 0.002120525984249882
epoch 1 training time: 17.429
---------------
2023-09-11 17:29:50.326317
current #epochs=2, #steps=40
start validation
acc: 0.881517
AUC: 0.945861
Avg Precision: 0.404661
Avg Recall: 1.000000
d_prime: 2.271200
train_loss: 0.026799
valid_loss: 0.987762
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002120525984249882
Epoch-2 lr: 0.002120525984249882
epoch 2 training time: 17.124
---------------
2023-09-11 17:30:07.450976
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00563	Train Loss 0.0286	
start validation
acc: 0.815166
AUC: 0.932444
Avg Precision: 0.366509
Avg Recall: 1.000000
d_prime: 2.113175
train_loss: 0.033735
valid_loss: 1.000175
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002120525984249882
Epoch-3 lr: 0.002120525984249882
epoch 3 training time: 15.096
---------------
2023-09-11 17:30:22.547058
current #epochs=4, #steps=120
start validation
acc: 0.857820
AUC: 0.936616
Avg Precision: 0.349054
Avg Recall: 1.000000
d_prime: 2.159464
train_loss: 0.042970
valid_loss: 0.995316
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002120525984249882
Epoch-4 lr: 0.002120525984249882
epoch 4 training time: 15.222
---------------
2023-09-11 17:30:37.769031
current #epochs=5, #steps=160
start validation
acc: 0.824645
AUC: 0.925041
Avg Precision: 0.342568
Avg Recall: 1.000000
d_prime: 2.036215
train_loss: 0.029887
valid_loss: 0.998627
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002120525984249882
Epoch-5 lr: 0.002120525984249882
epoch 5 training time: 15.039
---------------
2023-09-11 17:30:52.808205
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03520	Per Sample Data Time 0.02755	Per Sample DNN Time 0.00764	Train Loss 0.0057	
start validation
acc: 0.838863
AUC: 0.931858
Avg Precision: 0.372055
Avg Recall: 1.000000
d_prime: 2.106854
train_loss: 0.045284
valid_loss: 0.998921
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002120525984249882
Epoch-6 lr: 0.002120525984249882
epoch 6 training time: 15.184
---------------
2023-09-11 17:31:07.992535
current #epochs=7, #steps=240
start validation
acc: 0.838863
AUC: 0.918135
Avg Precision: 0.343406
Avg Recall: 1.000000
d_prime: 1.969486
train_loss: 0.043339
valid_loss: 1.002791
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0017239034424368592
Epoch-7 lr: 0.0017239034424368592
epoch 7 training time: 15.057
---------------
2023-09-11 17:31:23.049786
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00563	Train Loss 0.0514	
start validation
acc: 0.867299
AUC: 0.932181
Avg Precision: 0.349115
Avg Recall: 1.000000
d_prime: 2.110342
train_loss: 0.048942
valid_loss: 0.978788
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0017239034424368592
Epoch-8 lr: 0.0017239034424368592
epoch 8 training time: 15.069
---------------
2023-09-11 17:31:38.119435
current #epochs=9, #steps=320
start validation
acc: 0.834123
AUC: 0.932092
Avg Precision: 0.362936
Avg Recall: 1.000000
d_prime: 2.109381
train_loss: 0.038587
valid_loss: 0.991865
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0017239034424368592
Epoch-9 lr: 0.0017239034424368592
epoch 9 training time: 16.040
---------------
2023-09-11 17:31:54.159475
current #epochs=10, #steps=360
start validation
acc: 0.857820
AUC: 0.932841
Avg Precision: 0.345702
Avg Recall: 1.000000
d_prime: 2.117483
train_loss: 0.024837
valid_loss: 0.963981
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0017239034424368592
Epoch-10 lr: 0.0017239034424368592
epoch 10 training time: 15.137
---------------
2023-09-11 17:32:09.296040
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03654	Per Sample Data Time 0.02837	Per Sample DNN Time 0.00817	Train Loss 0.0037	
start validation
acc: 0.848341
AUC: 0.943001
Avg Precision: 0.371965
Avg Recall: 1.000000
d_prime: 2.235133
train_loss: 0.026164
valid_loss: 0.965622
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0017239034424368592
Epoch-11 lr: 0.0017239034424368592
epoch 11 training time: 15.148
---------------
2023-09-11 17:32:24.443850
current #epochs=12, #steps=440
start validation
acc: 0.867299
AUC: 0.941269
Avg Precision: 0.361334
Avg Recall: 1.000000
d_prime: 2.213974
train_loss: 0.023631
valid_loss: 0.964453
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0017239034424368592
Epoch-12 lr: 0.0017239034424368592
epoch 12 training time: 15.010
---------------
2023-09-11 17:32:39.454139
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00563	Train Loss 0.0248	
start validation
acc: 0.853081
AUC: 0.933165
Avg Precision: 0.355682
Avg Recall: 1.000000
d_prime: 2.121018
train_loss: 0.025826
valid_loss: 0.972664
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0017239034424368592
Epoch-13 lr: 0.0017239034424368592
epoch 13 training time: 15.178
---------------
2023-09-11 17:32:54.631726
current #epochs=14, #steps=520
start validation
acc: 0.834123
AUC: 0.934375
Avg Precision: 0.351517
Avg Recall: 1.000000
d_prime: 2.134314
train_loss: 0.016934
valid_loss: 0.972837
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0017239034424368592
Epoch-14 lr: 0.0017239034424368592
epoch 14 training time: 15.530
---------------
2023-09-11 17:33:10.162156
current #epochs=15, #steps=560
start validation
acc: 0.834123
AUC: 0.929752
Avg Precision: 0.373882
Avg Recall: 1.000000
d_prime: 2.084476
train_loss: 0.027599
valid_loss: 0.982377
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0017239034424368592
Epoch-15 lr: 0.0017239034424368592
epoch 15 training time: 15.682
---------------
2023-09-11 17:33:25.844297
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03811	Per Sample Data Time 0.02971	Per Sample DNN Time 0.00840	Train Loss 0.0053	
start validation
acc: 0.829384
AUC: 0.935237
Avg Precision: 0.368288
Avg Recall: 1.000000
d_prime: 2.143908
train_loss: 0.026490
valid_loss: 0.989440
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0017239034424368592
Epoch-16 lr: 0.0017239034424368592
epoch 16 training time: 15.213
---------------
2023-09-11 17:33:41.057508
current #epochs=17, #steps=640
start validation
acc: 0.853081
AUC: 0.940367
Avg Precision: 0.345993
Avg Recall: 1.000000
d_prime: 2.203147
train_loss: 0.030572
valid_loss: 0.972872
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.001401465061460644
Epoch-17 lr: 0.001401465061460644
epoch 17 training time: 14.988
---------------
2023-09-11 17:33:56.045333
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00565	Train Loss 0.0297	
start validation
acc: 0.857820
AUC: 0.941927
Avg Precision: 0.364887
Avg Recall: 1.000000
d_prime: 2.221950
train_loss: 0.025748
valid_loss: 0.965106
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001401465061460644
Epoch-18 lr: 0.001401465061460644
epoch 18 training time: 15.207
---------------
2023-09-11 17:34:11.252924
current #epochs=19, #steps=720
start validation
acc: 0.867299
AUC: 0.936933
Avg Precision: 0.334887
Avg Recall: 1.000000
d_prime: 2.163079
train_loss: 0.027032
valid_loss: 0.963681
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.001401465061460644
Epoch-19 lr: 0.001401465061460644
epoch 19 training time: 15.076
---------------
2023-09-11 17:34:26.328401
current #epochs=20, #steps=760
start validation
acc: 0.848341
AUC: 0.930731
Avg Precision: 0.341553
Avg Recall: 1.000000
d_prime: 2.094815
train_loss: 0.021783
valid_loss: 0.987029
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.001401465061460644
Epoch-20 lr: 0.001401465061460644
epoch 20 training time: 15.054
---------------
2023-09-11 17:34:41.382943
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03632	Per Sample Data Time 0.02820	Per Sample DNN Time 0.00812	Train Loss 0.0407	
start validation
acc: 0.824645
AUC: 0.931868
Avg Precision: 0.336779
Avg Recall: 1.000000
d_prime: 2.106967
train_loss: 0.023765
valid_loss: 0.981414
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.001401465061460644
Epoch-21 lr: 0.001401465061460644
epoch 21 training time: 15.161
---------------
2023-09-11 17:34:56.543888
current #epochs=22, #steps=840
start validation
acc: 0.853081
AUC: 0.935603
Avg Precision: 0.363902
Avg Recall: 1.000000
d_prime: 2.148008
train_loss: 0.015702
valid_loss: 0.971868
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.001401465061460644
Epoch-22 lr: 0.001401465061460644
epoch 22 training time: 15.104
---------------
2023-09-11 17:35:11.648017
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00723	Per Sample Data Time 0.00159	Per Sample DNN Time 0.00564	Train Loss 0.0273	
start validation
acc: 0.834123
AUC: 0.931875
Avg Precision: 0.352139
Avg Recall: 1.000000
d_prime: 2.107037
train_loss: 0.023866
valid_loss: 0.995979
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.001401465061460644
Epoch-23 lr: 0.001401465061460644
epoch 23 training time: 15.169
---------------
2023-09-11 17:35:26.816704
current #epochs=24, #steps=920
start validation
acc: 0.834123
AUC: 0.927369
Avg Precision: 0.342599
Avg Recall: 1.000000
d_prime: 2.059761
train_loss: 0.025474
valid_loss: 1.010324
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.001401465061460644
Epoch-24 lr: 0.001401465061460644
epoch 24 training time: 15.157
---------------
2023-09-11 17:35:41.973607
current #epochs=25, #steps=960
start validation
acc: 0.848341
AUC: 0.936414
Avg Precision: 0.359211
Avg Recall: 1.000000
d_prime: 2.157174
train_loss: 0.036928
valid_loss: 0.963290
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.001401465061460644
Epoch-25 lr: 0.001401465061460644
epoch 25 training time: 15.092
---------------
2023-09-11 17:35:57.065363
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03744	Per Sample Data Time 0.02983	Per Sample DNN Time 0.00761	Train Loss 0.0713	
start validation
acc: 0.834123
AUC: 0.928168
Avg Precision: 0.368703
Avg Recall: 1.000000
d_prime: 2.067981
train_loss: 0.032811
valid_loss: 0.975704
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.001401465061460644
Epoch-26 lr: 0.001401465061460644
epoch 26 training time: 16.264
---------------
2023-09-11 17:36:13.329833
current #epochs=27, #steps=1040
start validation
acc: 0.819905
AUC: 0.923825
Avg Precision: 0.347890
Avg Recall: 1.000000
d_prime: 2.024135
train_loss: 0.022064
valid_loss: 0.976151
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0011393354582078488
Epoch-27 lr: 0.0011393354582078488
epoch 27 training time: 15.098
---------------
2023-09-11 17:36:28.428402
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00563	Train Loss 0.0225	
start validation
acc: 0.815166
AUC: 0.920148
Avg Precision: 0.336829
Avg Recall: 1.000000
d_prime: 1.988482
train_loss: 0.023881
valid_loss: 0.990476
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0011393354582078488
Epoch-28 lr: 0.0011393354582078488
epoch 28 training time: 15.189
---------------
2023-09-11 17:36:43.617464
current #epochs=29, #steps=1120
start validation
acc: 0.829384
AUC: 0.924652
Avg Precision: 0.352006
Avg Recall: 1.000000
d_prime: 2.032334
train_loss: 0.022059
valid_loss: 1.006538
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0011393354582078488
Epoch-29 lr: 0.0011393354582078488
epoch 29 training time: 15.060
---------------
2023-09-11 17:36:58.677155
current #epochs=30, #steps=1160
start validation
acc: 0.853081
AUC: 0.932322
Avg Precision: 0.353598
Avg Recall: 1.000000
d_prime: 2.111856
train_loss: 0.025377
valid_loss: 0.996178
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0011393354582078488
Epoch-30 lr: 0.0011393354582078488
epoch 30 training time: 15.067
---------------
2023-09-11 17:37:13.744123
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03597	Per Sample Data Time 0.02774	Per Sample DNN Time 0.00822	Train Loss 0.0813	
start validation
acc: 0.843602
AUC: 0.933532
Avg Precision: 0.342464
Avg Recall: 1.000000
d_prime: 2.125026
train_loss: 0.023470
valid_loss: 0.985958
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0011393354582078488
Epoch-31 lr: 0.0011393354582078488
epoch 31 training time: 15.092
---------------
2023-09-11 17:37:28.836547
current #epochs=32, #steps=1240
start validation
acc: 0.834123
AUC: 0.936261
Avg Precision: 0.340428
Avg Recall: 1.000000
d_prime: 2.155437
train_loss: 0.020683
valid_loss: 0.976519
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0011393354582078488
Epoch-32 lr: 0.0011393354582078488
epoch 32 training time: 15.077
---------------
2023-09-11 17:37:43.913471
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00562	Train Loss 0.0147	
start validation
acc: 0.862559
AUC: 0.936459
Avg Precision: 0.342358
Avg Recall: 1.000000
d_prime: 2.157680
train_loss: 0.018904
valid_loss: 0.980219
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0011393354582078488
Epoch-33 lr: 0.0011393354582078488
epoch 33 training time: 15.073
---------------
2023-09-11 17:37:58.986675
current #epochs=34, #steps=1320
start validation
acc: 0.857820
AUC: 0.932756
Avg Precision: 0.355530
Avg Recall: 1.000000
d_prime: 2.116563
train_loss: 0.021726
valid_loss: 0.976251
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0011393354582078488
Epoch-34 lr: 0.0011393354582078488
epoch 34 training time: 16.017
---------------
2023-09-11 17:38:15.003509
current #epochs=35, #steps=1360
start validation
acc: 0.834123
AUC: 0.933500
Avg Precision: 0.349373
Avg Recall: 1.000000
d_prime: 2.124679
train_loss: 0.017789
valid_loss: 0.988013
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0011393354582078488
Epoch-35 lr: 0.0011393354582078488
epoch 35 training time: 15.683
---------------
2023-09-11 17:38:30.687009
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03755	Per Sample Data Time 0.02968	Per Sample DNN Time 0.00787	Train Loss 0.0039	
start validation
acc: 0.848341
AUC: 0.931001
Avg Precision: 0.347355
Avg Recall: 1.000000
d_prime: 2.097681
train_loss: 0.019792
valid_loss: 0.989108
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0011393354582078488
Epoch-36 lr: 0.0011393354582078488
epoch 36 training time: 15.229
---------------
2023-09-11 17:38:45.916495
current #epochs=37, #steps=1440
start validation
acc: 0.843602
AUC: 0.928167
Avg Precision: 0.344687
Avg Recall: 1.000000
d_prime: 2.067971
train_loss: 0.029772
valid_loss: 0.996714
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0009262344970461053
Epoch-37 lr: 0.0009262344970461053
epoch 37 training time: 15.148
---------------
2023-09-11 17:39:01.064530
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00558	Train Loss 0.0194	
start validation
acc: 0.819905
AUC: 0.926787
Avg Precision: 0.360008
Avg Recall: 1.000000
d_prime: 2.053826
train_loss: 0.014966
valid_loss: 0.988150
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0009262344970461053
Epoch-38 lr: 0.0009262344970461053
epoch 38 training time: 15.044
---------------
2023-09-11 17:39:16.108279
current #epochs=39, #steps=1520
start validation
acc: 0.824645
AUC: 0.930017
Avg Precision: 0.341996
Avg Recall: 1.000000
d_prime: 2.087268
train_loss: 0.021597
valid_loss: 0.985117
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0009262344970461053
Epoch-39 lr: 0.0009262344970461053
epoch 39 training time: 16.595
---------------
2023-09-11 17:39:32.703793
current #epochs=40, #steps=1560
start validation
acc: 0.834123
AUC: 0.932101
Avg Precision: 0.362349
Avg Recall: 1.000000
d_prime: 2.109474
train_loss: 0.017538
valid_loss: 0.987105
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0009262344970461053
Epoch-40 lr: 0.0009262344970461053
epoch 40 training time: 15.240
---------------
2023-09-11 17:39:47.943874
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03709	Per Sample Data Time 0.03003	Per Sample DNN Time 0.00707	Train Loss 0.0765	
start validation
acc: 0.829384
AUC: 0.933238
Avg Precision: 0.361810
Avg Recall: 1.000000
d_prime: 2.121815
train_loss: 0.012853
valid_loss: 0.994643
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0009262344970461053
Epoch-41 lr: 0.0009262344970461053
epoch 41 training time: 15.941
---------------
2023-09-11 17:40:03.884966
current #epochs=42, #steps=1640
start validation
acc: 0.819905
AUC: 0.930861
Avg Precision: 0.370921
Avg Recall: 1.000000
d_prime: 2.096201
train_loss: 0.017541
valid_loss: 0.989801
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0009262344970461053
Epoch-42 lr: 0.0009262344970461053
epoch 42 training time: 15.089
---------------
2023-09-11 17:40:18.974418
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00563	Train Loss 0.0300	
start validation
acc: 0.805687
AUC: 0.932291
Avg Precision: 0.368308
Avg Recall: 1.000000
d_prime: 2.111524
train_loss: 0.023142
valid_loss: 0.981927
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0009262344970461053
Epoch-43 lr: 0.0009262344970461053
epoch 43 training time: 15.151
---------------
2023-09-11 17:40:34.125276
current #epochs=44, #steps=1720
start validation
acc: 0.824645
AUC: 0.936856
Avg Precision: 0.375362
Avg Recall: 1.000000
d_prime: 2.162202
train_loss: 0.019489
valid_loss: 0.984897
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0009262344970461053
Epoch-44 lr: 0.0009262344970461053
epoch 44 training time: 15.028
---------------
2023-09-11 17:40:49.153952
current #epochs=45, #steps=1760
start validation
acc: 0.834123
AUC: 0.935885
Avg Precision: 0.375818
Avg Recall: 1.000000
d_prime: 2.151185
train_loss: 0.022551
valid_loss: 0.999612
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0009262344970461053
Epoch-45 lr: 0.0009262344970461053
epoch 45 training time: 15.102
---------------
2023-09-11 17:41:04.256296
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03642	Per Sample Data Time 0.02868	Per Sample DNN Time 0.00774	Train Loss 0.0001	
start validation
acc: 0.815166
AUC: 0.925051
Avg Precision: 0.369092
Avg Recall: 1.000000
d_prime: 2.036310
train_loss: 0.017581
valid_loss: 1.001461
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.0009262344970461053
Epoch-46 lr: 0.0009262344970461053
epoch 46 training time: 15.158
---------------
2023-09-11 17:41:19.413718
current #epochs=47, #steps=1840
start validation
acc: 0.824645
AUC: 0.930063
Avg Precision: 0.374373
Avg Recall: 1.000000
d_prime: 2.087747
train_loss: 0.021745
valid_loss: 1.019681
validation finished
normal learning rate scheduler step
Epoch-47 lr: 0.0007529918755163883
Epoch-47 lr: 0.0007529918755163883
epoch 47 training time: 15.065
---------------
2023-09-11 17:41:34.478511
current #epochs=48, #steps=1880
Epoch: [48][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00562	Train Loss 0.0129	
start validation
[I 2023-09-11 17:41:49,633] Trial 66 finished with value: 0.8815165876777251 and parameters: {'warmup': 'False', 'num_epochs': 48, 'batch_size': 54, 'lr-adaptschedule': 'True', 'lr': 0.002120525984249882, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.8129603010012987}. Best is trial 50 with value: 0.8815165876777251.
acc: 0.824645
AUC: 0.933509
Avg Precision: 0.370067
Avg Recall: 1.000000
d_prime: 2.124776
train_loss: 0.011795
valid_loss: 0.995123
validation finished
normal learning rate scheduler step
Epoch-48 lr: 0.0007529918755163883
Epoch-48 lr: 0.0007529918755163883
epoch 48 training time: 15.141
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f8644818760>
The learning rate scheduler starts at 7 epoch with decay rate of 0.808 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 17:41:49.672694
current #epochs=1, #steps=0
start validation
acc: 0.824645
AUC: 0.931857
Avg Precision: 0.337177
Avg Recall: 1.000000
d_prime: 2.106845
train_loss: 0.037162
valid_loss: 0.987885
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002462099857697384
Epoch-1 lr: 0.002462099857697384
epoch 1 training time: 17.268
---------------
2023-09-11 17:42:06.940829
current #epochs=2, #steps=40
start validation
acc: 0.810427
AUC: 0.897456
Avg Precision: 0.340992
Avg Recall: 1.000000
d_prime: 1.792076
train_loss: 0.056645
valid_loss: 1.042143
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002462099857697384
Epoch-2 lr: 0.002462099857697384
epoch 2 training time: 15.180
---------------
2023-09-11 17:42:22.121317
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00160	Per Sample DNN Time 0.00556	Train Loss 0.0426	
start validation
acc: 0.824645
AUC: 0.914277
Avg Precision: 0.341780
Avg Recall: 1.000000
d_prime: 1.934043
train_loss: 0.044492
valid_loss: 1.000742
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002462099857697384
Epoch-3 lr: 0.002462099857697384
epoch 3 training time: 15.162
---------------
2023-09-11 17:42:37.283476
current #epochs=4, #steps=120
start validation
acc: 0.838863
AUC: 0.915573
Avg Precision: 0.325049
Avg Recall: 1.000000
d_prime: 1.945809
train_loss: 0.035506
valid_loss: 1.012856
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002462099857697384
Epoch-4 lr: 0.002462099857697384
epoch 4 training time: 17.218
---------------
2023-09-11 17:42:54.502078
current #epochs=5, #steps=160
start validation
acc: 0.810427
AUC: 0.915242
Avg Precision: 0.353635
Avg Recall: 1.000000
d_prime: 1.942788
train_loss: 0.029121
valid_loss: 1.011243
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002462099857697384
Epoch-5 lr: 0.002462099857697384
epoch 5 training time: 15.178
---------------
2023-09-11 17:43:09.679632
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03601	Per Sample Data Time 0.02809	Per Sample DNN Time 0.00792	Train Loss 0.0017	
start validation
acc: 0.838863
AUC: 0.933617
Avg Precision: 0.367714
Avg Recall: 1.000000
d_prime: 2.125960
train_loss: 0.029183
valid_loss: 0.979102
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002462099857697384
Epoch-6 lr: 0.002462099857697384
epoch 6 training time: 15.127
---------------
2023-09-11 17:43:24.806921
current #epochs=7, #steps=240
start validation
acc: 0.848341
AUC: 0.931727
Avg Precision: 0.341906
Avg Recall: 1.000000
d_prime: 2.105446
train_loss: 0.029933
valid_loss: 0.974488
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.001990460363768144
Epoch-7 lr: 0.001990460363768144
epoch 7 training time: 17.359
---------------
2023-09-11 17:43:42.166161
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00561	Train Loss 0.0135	
start validation
acc: 0.838863
AUC: 0.930848
Avg Precision: 0.327150
Avg Recall: 1.000000
d_prime: 2.096056
train_loss: 0.020552
valid_loss: 0.966133
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001990460363768144
Epoch-8 lr: 0.001990460363768144
epoch 8 training time: 15.124
---------------
2023-09-11 17:43:57.290069
current #epochs=9, #steps=320
start validation
acc: 0.834123
AUC: 0.923125
Avg Precision: 0.334780
Avg Recall: 1.000000
d_prime: 2.017247
train_loss: 0.026329
valid_loss: 0.994607
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001990460363768144
Epoch-9 lr: 0.001990460363768144
epoch 9 training time: 15.062
---------------
2023-09-11 17:44:12.352164
current #epochs=10, #steps=360
start validation
acc: 0.834123
AUC: 0.925672
Avg Precision: 0.327494
Avg Recall: 1.000000
d_prime: 2.042542
train_loss: 0.035747
valid_loss: 0.988220
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001990460363768144
Epoch-10 lr: 0.001990460363768144
epoch 10 training time: 15.147
---------------
2023-09-11 17:44:27.498897
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03748	Per Sample Data Time 0.02968	Per Sample DNN Time 0.00780	Train Loss 0.0539	
start validation
acc: 0.834123
AUC: 0.925701
Avg Precision: 0.367588
Avg Recall: 1.000000
d_prime: 2.042832
train_loss: 0.033279
valid_loss: 0.994596
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001990460363768144
Epoch-11 lr: 0.001990460363768144
epoch 11 training time: 15.451
---------------
2023-09-11 17:44:42.949702
current #epochs=12, #steps=440
start validation
acc: 0.838863
AUC: 0.932440
Avg Precision: 0.347972
Avg Recall: 1.000000
d_prime: 2.113133
train_loss: 0.033880
valid_loss: 0.993390
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001990460363768144
Epoch-12 lr: 0.001990460363768144
epoch 12 training time: 15.275
---------------
2023-09-11 17:44:58.224694
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00564	Train Loss 0.0218	
start validation
acc: 0.829384
AUC: 0.920715
Avg Precision: 0.343303
Avg Recall: 1.000000
d_prime: 1.993898
train_loss: 0.029278
valid_loss: 1.012637
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.001990460363768144
Epoch-13 lr: 0.001990460363768144
epoch 13 training time: 15.101
---------------
2023-09-11 17:45:13.325134
current #epochs=14, #steps=520
start validation
acc: 0.824645
AUC: 0.930920
Avg Precision: 0.364134
Avg Recall: 1.000000
d_prime: 2.096826
train_loss: 0.035038
valid_loss: 0.998625
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.001990460363768144
Epoch-14 lr: 0.001990460363768144
epoch 14 training time: 15.126
---------------
2023-09-11 17:45:28.451251
current #epochs=15, #steps=560
start validation
acc: 0.838863
AUC: 0.932933
Avg Precision: 0.360233
Avg Recall: 1.000000
d_prime: 2.118493
train_loss: 0.040904
valid_loss: 0.988290
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.001990460363768144
Epoch-15 lr: 0.001990460363768144
epoch 15 training time: 15.217
---------------
2023-09-11 17:45:43.668356
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03605	Per Sample Data Time 0.02802	Per Sample DNN Time 0.00803	Train Loss 0.0920	
start validation
acc: 0.829384
AUC: 0.919318
Avg Precision: 0.360998
Avg Recall: 1.000000
d_prime: 1.980604
train_loss: 0.050780
valid_loss: 0.993867
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.001990460363768144
Epoch-16 lr: 0.001990460363768144
epoch 16 training time: 15.503
---------------
2023-09-11 17:45:59.170946
current #epochs=17, #steps=640
start validation
acc: 0.834123
AUC: 0.933558
Avg Precision: 0.365930
Avg Recall: 1.000000
d_prime: 2.125313
train_loss: 0.079163
valid_loss: 0.987267
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0016091680633283929
Epoch-17 lr: 0.0016091680633283929
epoch 17 training time: 15.101
---------------
2023-09-11 17:46:14.271942
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00724	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00566	Train Loss 0.0441	
start validation
acc: 0.838863
AUC: 0.920255
Avg Precision: 0.335464
Avg Recall: 1.000000
d_prime: 1.989500
train_loss: 0.037077
valid_loss: 1.002932
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0016091680633283929
Epoch-18 lr: 0.0016091680633283929
epoch 18 training time: 15.981
---------------
2023-09-11 17:46:30.252941
current #epochs=19, #steps=720
start validation
acc: 0.848341
AUC: 0.925536
Avg Precision: 0.316445
Avg Recall: 1.000000
d_prime: 2.041174
train_loss: 0.017730
valid_loss: 0.994283
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0016091680633283929
Epoch-19 lr: 0.0016091680633283929
epoch 19 training time: 16.106
---------------
2023-09-11 17:46:46.358527
current #epochs=20, #steps=760
start validation
acc: 0.848341
AUC: 0.932758
Avg Precision: 0.336634
Avg Recall: 1.000000
d_prime: 2.116582
train_loss: 0.027583
valid_loss: 0.973755
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0016091680633283929
Epoch-20 lr: 0.0016091680633283929
epoch 20 training time: 15.467
---------------
2023-09-11 17:47:01.825278
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03856	Per Sample Data Time 0.03106	Per Sample DNN Time 0.00750	Train Loss 0.0228	
start validation
acc: 0.853081
AUC: 0.931560
Avg Precision: 0.331926
Avg Recall: 1.000000
d_prime: 2.103661
train_loss: 0.025155
valid_loss: 0.962002
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0016091680633283929
Epoch-21 lr: 0.0016091680633283929
epoch 21 training time: 17.222
---------------
2023-09-11 17:47:19.046857
current #epochs=22, #steps=840
start validation
acc: 0.834123
AUC: 0.922875
Avg Precision: 0.323132
Avg Recall: 1.000000
d_prime: 2.014802
train_loss: 0.013560
valid_loss: 0.984867
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0016091680633283929
Epoch-22 lr: 0.0016091680633283929
epoch 22 training time: 15.152
---------------
2023-09-11 17:47:34.198463
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00143	Per Sample DNN Time 0.00566	Train Loss 0.0235	
start validation
acc: 0.838863
AUC: 0.938462
Avg Precision: 0.353925
Avg Recall: 1.000000
d_prime: 2.180706
train_loss: 0.028497
valid_loss: 0.978112
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0016091680633283929
Epoch-23 lr: 0.0016091680633283929
epoch 23 training time: 17.533
---------------
2023-09-11 17:47:51.731571
current #epochs=24, #steps=920
start validation
acc: 0.862559
AUC: 0.939829
Avg Precision: 0.320104
Avg Recall: 1.000000
d_prime: 2.196755
train_loss: 0.031208
valid_loss: 0.960449
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0016091680633283929
Epoch-24 lr: 0.0016091680633283929
epoch 24 training time: 17.122
---------------
2023-09-11 17:48:08.853859
current #epochs=25, #steps=960
start validation
acc: 0.834123
AUC: 0.925780
Avg Precision: 0.337173
Avg Recall: 1.000000
d_prime: 2.043629
train_loss: 0.038075
valid_loss: 1.005758
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0016091680633283929
Epoch-25 lr: 0.0016091680633283929
epoch 25 training time: 18.502
---------------
2023-09-11 17:48:27.356018
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03961	Per Sample Data Time 0.02926	Per Sample DNN Time 0.01035	Train Loss 0.0452	
start validation
acc: 0.872038
AUC: 0.941487
Avg Precision: 0.321744
Avg Recall: 1.000000
d_prime: 2.216608
train_loss: 0.030165
valid_loss: 0.973502
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0016091680633283929
Epoch-26 lr: 0.0016091680633283929
epoch 26 training time: 17.251
---------------
2023-09-11 17:48:44.607385
current #epochs=27, #steps=1040
start validation
acc: 0.838863
AUC: 0.934012
Avg Precision: 0.332125
Avg Recall: 1.000000
d_prime: 2.130306
train_loss: 0.033888
valid_loss: 0.997192
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0013009160610131477
Epoch-27 lr: 0.0013009160610131477
epoch 27 training time: 15.249
---------------
2023-09-11 17:48:59.856649
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00701	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00553	Train Loss 0.0294	
start validation
acc: 0.848341
AUC: 0.935752
Avg Precision: 0.330880
Avg Recall: 1.000000
d_prime: 2.149686
train_loss: 0.029851
valid_loss: 0.976933
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0013009160610131477
Epoch-28 lr: 0.0013009160610131477
epoch 28 training time: 14.922
---------------
2023-09-11 17:49:14.778706
current #epochs=29, #steps=1120
start validation
acc: 0.853081
AUC: 0.936480
Avg Precision: 0.319293
Avg Recall: 1.000000
d_prime: 2.157914
train_loss: 0.017056
valid_loss: 0.975699
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0013009160610131477
Epoch-29 lr: 0.0013009160610131477
epoch 29 training time: 15.190
---------------
2023-09-11 17:49:29.968682
current #epochs=30, #steps=1160
start validation
acc: 0.848341
AUC: 0.934886
Avg Precision: 0.332480
Avg Recall: 1.000000
d_prime: 2.139997
train_loss: 0.017736
valid_loss: 0.977578
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0013009160610131477
Epoch-30 lr: 0.0013009160610131477
epoch 30 training time: 15.217
---------------
2023-09-11 17:49:45.186320
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03662	Per Sample Data Time 0.02860	Per Sample DNN Time 0.00802	Train Loss 0.1033	
start validation
acc: 0.848341
AUC: 0.926464
Avg Precision: 0.329855
Avg Recall: 1.000000
d_prime: 2.050540
train_loss: 0.023038
valid_loss: 0.990031
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0013009160610131477
Epoch-31 lr: 0.0013009160610131477
epoch 31 training time: 15.139
---------------
2023-09-11 17:50:00.324884
current #epochs=32, #steps=1240
start validation
acc: 0.838863
AUC: 0.923707
Avg Precision: 0.325355
Avg Recall: 1.000000
d_prime: 2.022970
train_loss: 0.017277
valid_loss: 1.013972
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0013009160610131477
Epoch-32 lr: 0.0013009160610131477
epoch 32 training time: 15.115
---------------
2023-09-11 17:50:15.439912
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00564	Train Loss 0.0232	
start validation
acc: 0.848341
AUC: 0.926599
Avg Precision: 0.316898
Avg Recall: 1.000000
d_prime: 2.051910
train_loss: 0.019883
valid_loss: 0.989660
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0013009160610131477
Epoch-33 lr: 0.0013009160610131477
epoch 33 training time: 15.134
---------------
2023-09-11 17:50:30.574061
current #epochs=34, #steps=1320
start validation
acc: 0.843602
AUC: 0.934800
Avg Precision: 0.337552
Avg Recall: 1.000000
d_prime: 2.139041
train_loss: 0.016832
valid_loss: 0.991428
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0013009160610131477
Epoch-34 lr: 0.0013009160610131477
epoch 34 training time: 15.878
---------------
2023-09-11 17:50:46.451776
current #epochs=35, #steps=1360
start validation
acc: 0.838863
AUC: 0.932225
Avg Precision: 0.335407
Avg Recall: 1.000000
d_prime: 2.110807
train_loss: 0.021219
valid_loss: 1.005556
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0013009160610131477
Epoch-35 lr: 0.0013009160610131477
epoch 35 training time: 15.100
---------------
2023-09-11 17:51:01.552094
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03820	Per Sample Data Time 0.02845	Per Sample DNN Time 0.00975	Train Loss 0.0002	
start validation
acc: 0.834123
AUC: 0.925465
Avg Precision: 0.339443
Avg Recall: 1.000000
d_prime: 2.040464
train_loss: 0.025610
valid_loss: 1.006071
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0013009160610131477
Epoch-36 lr: 0.0013009160610131477
epoch 36 training time: 15.123
---------------
2023-09-11 17:51:16.675209
current #epochs=37, #steps=1440
start validation
acc: 0.857820
AUC: 0.932096
Avg Precision: 0.346181
Avg Recall: 1.000000
d_prime: 2.109417
train_loss: 0.019122
valid_loss: 1.007929
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0010517127678394576
Epoch-37 lr: 0.0010517127678394576
epoch 37 training time: 15.121
---------------
2023-09-11 17:51:31.796428
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00157	Per Sample DNN Time 0.00562	Train Loss 0.0139	
start validation
acc: 0.843602
AUC: 0.934938
Avg Precision: 0.334663
Avg Recall: 1.000000
d_prime: 2.140572
train_loss: 0.016761
valid_loss: 0.989062
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0010517127678394576
Epoch-38 lr: 0.0010517127678394576
epoch 38 training time: 16.560
---------------
2023-09-11 17:51:48.356202
current #epochs=39, #steps=1520
start validation
acc: 0.843602
AUC: 0.930281
Avg Precision: 0.328873
Avg Recall: 1.000000
d_prime: 2.090048
train_loss: 0.012818
valid_loss: 0.977462
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0010517127678394576
Epoch-39 lr: 0.0010517127678394576
epoch 39 training time: 16.252
---------------
2023-09-11 17:52:04.608647
current #epochs=40, #steps=1560
start validation
acc: 0.843602
AUC: 0.929314
Avg Precision: 0.352187
Avg Recall: 1.000000
d_prime: 2.079885
train_loss: 0.021692
valid_loss: 0.987480
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0010517127678394576
Epoch-40 lr: 0.0010517127678394576
epoch 40 training time: 15.075
---------------
2023-09-11 17:52:19.684022
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03620	Per Sample Data Time 0.02800	Per Sample DNN Time 0.00820	Train Loss 0.0523	
start validation
acc: 0.848341
AUC: 0.930046
Avg Precision: 0.349326
Avg Recall: 1.000000
d_prime: 2.087572
train_loss: 0.018791
valid_loss: 0.979181
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0010517127678394576
Epoch-41 lr: 0.0010517127678394576
epoch 41 training time: 15.060
---------------
2023-09-11 17:52:34.744211
current #epochs=42, #steps=1640
start validation
acc: 0.834123
AUC: 0.929020
Avg Precision: 0.344906
Avg Recall: 1.000000
d_prime: 2.076815
train_loss: 0.021951
valid_loss: 1.011635
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0010517127678394576
Epoch-42 lr: 0.0010517127678394576
epoch 42 training time: 15.197
---------------
2023-09-11 17:52:49.940813
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00562	Train Loss 0.0198	
start validation
[I 2023-09-11 17:53:05,304] Trial 67 finished with value: 0.8720379146919431 and parameters: {'warmup': 'False', 'num_epochs': 43, 'batch_size': 50, 'lr-adaptschedule': 'True', 'lr': 0.002462099857697384, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.808440144109212}. Best is trial 50 with value: 0.8815165876777251.
acc: 0.838863
AUC: 0.926558
Avg Precision: 0.337798
Avg Recall: 1.000000
d_prime: 2.051498
train_loss: 0.019800
valid_loss: 0.978909
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0010517127678394576
Epoch-43 lr: 0.0010517127678394576
epoch 43 training time: 15.352
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f86670306a0>
The learning rate scheduler starts at 7 epoch with decay rate of 0.812 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 17:53:05.342914
current #epochs=1, #steps=0
start validation
acc: 0.815166
AUC: 0.916899
Avg Precision: 0.335434
Avg Recall: 1.000000
d_prime: 1.957996
train_loss: 0.051524
valid_loss: 1.011442
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002039316621424828
Epoch-1 lr: 0.002039316621424828
epoch 1 training time: 17.079
---------------
2023-09-11 17:53:22.421940
current #epochs=2, #steps=40
start validation
acc: 0.862559
AUC: 0.925884
Avg Precision: 0.329154
Avg Recall: 1.000000
d_prime: 2.044680
train_loss: 0.032841
valid_loss: 0.980449
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002039316621424828
Epoch-2 lr: 0.002039316621424828
epoch 2 training time: 17.315
---------------
2023-09-11 17:53:39.736407
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00559	Train Loss 0.0244	
start validation
acc: 0.834123
AUC: 0.914044
Avg Precision: 0.325642
Avg Recall: 1.000000
d_prime: 1.931937
train_loss: 0.024010
valid_loss: 0.998820
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002039316621424828
Epoch-3 lr: 0.002039316621424828
epoch 3 training time: 15.485
---------------
2023-09-11 17:53:55.221294
current #epochs=4, #steps=120
start validation
acc: 0.829384
AUC: 0.919705
Avg Precision: 0.326802
Avg Recall: 1.000000
d_prime: 1.984271
train_loss: 0.027190
valid_loss: 1.013433
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002039316621424828
Epoch-4 lr: 0.002039316621424828
epoch 4 training time: 15.116
---------------
2023-09-11 17:54:10.337378
current #epochs=5, #steps=160
start validation
acc: 0.843602
AUC: 0.935256
Avg Precision: 0.325134
Avg Recall: 1.000000
d_prime: 2.144125
train_loss: 0.022854
valid_loss: 0.974488
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002039316621424828
Epoch-5 lr: 0.002039316621424828
epoch 5 training time: 16.519
---------------
2023-09-11 17:54:26.856343
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03705	Per Sample Data Time 0.02867	Per Sample DNN Time 0.00838	Train Loss 0.0328	
start validation
acc: 0.834123
AUC: 0.926926
Avg Precision: 0.323850
Avg Recall: 1.000000
d_prime: 2.055235
train_loss: 0.033052
valid_loss: 0.993595
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002039316621424828
Epoch-6 lr: 0.002039316621424828
epoch 6 training time: 15.123
---------------
2023-09-11 17:54:41.979623
current #epochs=7, #steps=240
start validation
acc: 0.810427
AUC: 0.924071
Avg Precision: 0.337675
Avg Recall: 1.000000
d_prime: 2.026571
train_loss: 0.037742
valid_loss: 0.995689
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0016554551101149193
Epoch-7 lr: 0.0016554551101149193
epoch 7 training time: 15.174
---------------
2023-09-11 17:54:57.153862
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00563	Train Loss 0.0212	
start validation
acc: 0.843602
AUC: 0.920375
Avg Precision: 0.317704
Avg Recall: 1.000000
d_prime: 1.990648
train_loss: 0.020495
valid_loss: 1.003894
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0016554551101149193
Epoch-8 lr: 0.0016554551101149193
epoch 8 training time: 15.121
---------------
2023-09-11 17:55:12.274656
current #epochs=9, #steps=320
start validation
acc: 0.834123
AUC: 0.923673
Avg Precision: 0.328358
Avg Recall: 1.000000
d_prime: 2.022639
train_loss: 0.024765
valid_loss: 0.988557
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0016554551101149193
Epoch-9 lr: 0.0016554551101149193
epoch 9 training time: 16.228
---------------
2023-09-11 17:55:28.503059
current #epochs=10, #steps=360
start validation
acc: 0.853081
AUC: 0.925848
Avg Precision: 0.337100
Avg Recall: 1.000000
d_prime: 2.044318
train_loss: 0.038460
valid_loss: 1.001260
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0016554551101149193
Epoch-10 lr: 0.0016554551101149193
epoch 10 training time: 15.069
---------------
2023-09-11 17:55:43.572405
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03835	Per Sample Data Time 0.02862	Per Sample DNN Time 0.00973	Train Loss 0.0480	
start validation
acc: 0.824645
AUC: 0.922599
Avg Precision: 0.329389
Avg Recall: 1.000000
d_prime: 2.012104
train_loss: 0.030652
valid_loss: 1.013994
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0016554551101149193
Epoch-11 lr: 0.0016554551101149193
epoch 11 training time: 15.169
---------------
2023-09-11 17:55:58.741466
current #epochs=12, #steps=440
start validation
acc: 0.824645
AUC: 0.924526
Avg Precision: 0.332813
Avg Recall: 1.000000
d_prime: 2.031081
train_loss: 0.025186
valid_loss: 1.014637
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0016554551101149193
Epoch-12 lr: 0.0016554551101149193
epoch 12 training time: 16.447
---------------
2023-09-11 17:56:15.187996
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00566	Train Loss 0.0341	
start validation
acc: 0.829384
AUC: 0.923099
Avg Precision: 0.333763
Avg Recall: 1.000000
d_prime: 2.016989
train_loss: 0.032638
valid_loss: 1.014267
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0016554551101149193
Epoch-13 lr: 0.0016554551101149193
epoch 13 training time: 16.370
---------------
2023-09-11 17:56:31.557744
current #epochs=14, #steps=520
start validation
acc: 0.853081
AUC: 0.935308
Avg Precision: 0.373181
Avg Recall: 1.000000
d_prime: 2.144702
train_loss: 0.047782
valid_loss: 0.988838
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0016554551101149193
Epoch-14 lr: 0.0016554551101149193
epoch 14 training time: 15.228
---------------
2023-09-11 17:56:46.785724
current #epochs=15, #steps=560
start validation
acc: 0.829384
AUC: 0.936041
Avg Precision: 0.350107
Avg Recall: 1.000000
d_prime: 2.152950
train_loss: 0.027453
valid_loss: 0.987738
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0016554551101149193
Epoch-15 lr: 0.0016554551101149193
epoch 15 training time: 15.079
---------------
2023-09-11 17:57:01.864405
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03653	Per Sample Data Time 0.02808	Per Sample DNN Time 0.00846	Train Loss 0.0035	
start validation
acc: 0.829384
AUC: 0.934982
Avg Precision: 0.348270
Avg Recall: 1.000000
d_prime: 2.141066
train_loss: 0.030840
valid_loss: 1.008171
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0016554551101149193
Epoch-16 lr: 0.0016554551101149193
epoch 16 training time: 15.036
---------------
2023-09-11 17:57:16.900762
current #epochs=17, #steps=640
start validation
acc: 0.848341
AUC: 0.931324
Avg Precision: 0.336720
Avg Recall: 1.000000
d_prime: 2.101129
train_loss: 0.025445
valid_loss: 1.006393
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.001343848028704266
Epoch-17 lr: 0.001343848028704266
epoch 17 training time: 15.240
---------------
2023-09-11 17:57:32.140321
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00564	Train Loss 0.0247	
start validation
acc: 0.857820
AUC: 0.937592
Avg Precision: 0.353121
Avg Recall: 1.000000
d_prime: 2.170632
train_loss: 0.021137
valid_loss: 0.992816
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001343848028704266
Epoch-18 lr: 0.001343848028704266
epoch 18 training time: 15.064
---------------
2023-09-11 17:57:47.204579
current #epochs=19, #steps=720
start validation
acc: 0.857820
AUC: 0.936923
Avg Precision: 0.361257
Avg Recall: 1.000000
d_prime: 2.162962
train_loss: 0.024740
valid_loss: 1.007221
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.001343848028704266
Epoch-19 lr: 0.001343848028704266
epoch 19 training time: 15.803
---------------
2023-09-11 17:58:03.007071
current #epochs=20, #steps=760
start validation
acc: 0.843602
AUC: 0.939648
Avg Precision: 0.353379
Avg Recall: 1.000000
d_prime: 2.194607
train_loss: 0.022381
valid_loss: 0.999469
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.001343848028704266
Epoch-20 lr: 0.001343848028704266
epoch 20 training time: 15.737
---------------
2023-09-11 17:58:18.744493
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03677	Per Sample Data Time 0.02854	Per Sample DNN Time 0.00824	Train Loss 0.0120	
start validation
acc: 0.819905
AUC: 0.933315
Avg Precision: 0.353372
Avg Recall: 1.000000
d_prime: 2.122656
train_loss: 0.016638
valid_loss: 1.010469
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.001343848028704266
Epoch-21 lr: 0.001343848028704266
epoch 21 training time: 15.557
---------------
2023-09-11 17:58:34.302013
current #epochs=22, #steps=840
start validation
acc: 0.829384
AUC: 0.932764
Avg Precision: 0.363493
Avg Recall: 1.000000
d_prime: 2.116654
train_loss: 0.022040
valid_loss: 1.007437
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.001343848028704266
Epoch-22 lr: 0.001343848028704266
epoch 22 training time: 16.032
---------------
2023-09-11 17:58:50.333957
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00566	Train Loss 0.0280	
start validation
acc: 0.838863
AUC: 0.927643
Avg Precision: 0.339906
Avg Recall: 1.000000
d_prime: 2.062573
train_loss: 0.020838
valid_loss: 1.011215
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.001343848028704266
Epoch-23 lr: 0.001343848028704266
epoch 23 training time: 15.088
---------------
2023-09-11 17:59:05.422107
current #epochs=24, #steps=920
start validation
acc: 0.824645
AUC: 0.937178
Avg Precision: 0.372522
Avg Recall: 1.000000
d_prime: 2.165881
train_loss: 0.016212
valid_loss: 0.997475
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.001343848028704266
Epoch-24 lr: 0.001343848028704266
epoch 24 training time: 15.078
---------------
2023-09-11 17:59:20.500588
current #epochs=25, #steps=960
start validation
acc: 0.843602
AUC: 0.933698
Avg Precision: 0.367189
Avg Recall: 1.000000
d_prime: 2.126852
train_loss: 0.022583
valid_loss: 0.993084
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.001343848028704266
Epoch-25 lr: 0.001343848028704266
epoch 25 training time: 15.391
---------------
2023-09-11 17:59:35.891376
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03948	Per Sample Data Time 0.02823	Per Sample DNN Time 0.01125	Train Loss 0.0029	
start validation
acc: 0.829384
AUC: 0.942003
Avg Precision: 0.377954
Avg Recall: 1.000000
d_prime: 2.222882
train_loss: 0.022635
valid_loss: 0.986775
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.001343848028704266
Epoch-26 lr: 0.001343848028704266
epoch 26 training time: 15.144
---------------
2023-09-11 17:59:51.035078
current #epochs=27, #steps=1040
start validation
acc: 0.857820
AUC: 0.942332
Avg Precision: 0.366503
Avg Recall: 1.000000
d_prime: 2.226894
train_loss: 0.020458
valid_loss: 0.989648
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0010908948924184222
Epoch-27 lr: 0.0010908948924184222
epoch 27 training time: 15.037
---------------
2023-09-11 18:00:06.072021
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00564	Train Loss 0.0208	
start validation
acc: 0.843602
AUC: 0.942536
Avg Precision: 0.379707
Avg Recall: 1.000000
d_prime: 2.229406
train_loss: 0.024680
valid_loss: 0.990444
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0010908948924184222
Epoch-28 lr: 0.0010908948924184222
epoch 28 training time: 14.994
---------------
2023-09-11 18:00:21.066053
current #epochs=29, #steps=1120
start validation
acc: 0.838863
AUC: 0.939867
Avg Precision: 0.384402
Avg Recall: 1.000000
d_prime: 2.197203
train_loss: 0.022165
valid_loss: 0.995203
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0010908948924184222
Epoch-29 lr: 0.0010908948924184222
epoch 29 training time: 15.163
---------------
2023-09-11 18:00:36.228829
current #epochs=30, #steps=1160
start validation
acc: 0.838863
AUC: 0.937637
Avg Precision: 0.391531
Avg Recall: 1.000000
d_prime: 2.171155
train_loss: 0.024234
valid_loss: 1.002578
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0010908948924184222
Epoch-30 lr: 0.0010908948924184222
epoch 30 training time: 16.579
---------------
2023-09-11 18:00:52.807954
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03783	Per Sample Data Time 0.03023	Per Sample DNN Time 0.00761	Train Loss 0.0487	
start validation
acc: 0.843602
AUC: 0.934219
Avg Precision: 0.364380
Avg Recall: 1.000000
d_prime: 2.132594
train_loss: 0.023612
valid_loss: 0.985364
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0010908948924184222
Epoch-31 lr: 0.0010908948924184222
epoch 31 training time: 15.155
---------------
2023-09-11 18:01:07.963376
current #epochs=32, #steps=1240
start validation
acc: 0.829384
AUC: 0.930026
Avg Precision: 0.376820
Avg Recall: 1.000000
d_prime: 2.087360
train_loss: 0.024831
valid_loss: 0.995064
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0010908948924184222
Epoch-32 lr: 0.0010908948924184222
epoch 32 training time: 15.283
---------------
2023-09-11 18:01:23.246022
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00565	Train Loss 0.0248	
start validation
acc: 0.838863
AUC: 0.924823
Avg Precision: 0.377066
Avg Recall: 1.000000
d_prime: 2.034037
train_loss: 0.020428
valid_loss: 1.002346
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0010908948924184222
Epoch-33 lr: 0.0010908948924184222
epoch 33 training time: 15.120
---------------
2023-09-11 18:01:38.365804
current #epochs=34, #steps=1320
start validation
acc: 0.857820
AUC: 0.928677
Avg Precision: 0.357012
Avg Recall: 1.000000
d_prime: 2.073251
train_loss: 0.010368
valid_loss: 1.013424
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0010908948924184222
Epoch-34 lr: 0.0010908948924184222
epoch 34 training time: 15.082
---------------
2023-09-11 18:01:53.447858
current #epochs=35, #steps=1360
start validation
acc: 0.838863
AUC: 0.927764
Avg Precision: 0.361026
Avg Recall: 1.000000
d_prime: 2.063813
train_loss: 0.026106
valid_loss: 1.011932
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0010908948924184222
Epoch-35 lr: 0.0010908948924184222
epoch 35 training time: 15.066
---------------
2023-09-11 18:02:08.513755
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03647	Per Sample Data Time 0.02823	Per Sample DNN Time 0.00824	Train Loss 0.0104	
start validation
acc: 0.834123
AUC: 0.923704
Avg Precision: 0.331665
Avg Recall: 1.000000
d_prime: 2.022944
train_loss: 0.023716
valid_loss: 1.012742
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0010908948924184222
Epoch-36 lr: 0.0010908948924184222
epoch 36 training time: 15.142
---------------
2023-09-11 18:02:23.655456
current #epochs=37, #steps=1440
start validation
acc: 0.824645
AUC: 0.922266
Avg Precision: 0.330341
Avg Recall: 1.000000
d_prime: 2.008858
train_loss: 0.023356
valid_loss: 0.994254
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0008855552420254281
Epoch-37 lr: 0.0008855552420254281
epoch 37 training time: 15.168
---------------
2023-09-11 18:02:38.823601
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00571	Train Loss 0.0161	
start validation
acc: 0.834123
AUC: 0.921884
Avg Precision: 0.337900
Avg Recall: 1.000000
d_prime: 2.005158
train_loss: 0.019259
valid_loss: 0.996206
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0008855552420254281
Epoch-38 lr: 0.0008855552420254281
epoch 38 training time: 15.118
---------------
2023-09-11 18:02:53.941727
current #epochs=39, #steps=1520
start validation
acc: 0.829384
AUC: 0.929247
Avg Precision: 0.357215
Avg Recall: 1.000000
d_prime: 2.079189
train_loss: 0.023929
valid_loss: 0.992457
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0008855552420254281
Epoch-39 lr: 0.0008855552420254281
epoch 39 training time: 15.175
---------------
2023-09-11 18:03:09.116926
current #epochs=40, #steps=1560
start validation
[I 2023-09-11 18:03:24,260] Trial 68 finished with value: 0.8625592417061612 and parameters: {'warmup': 'False', 'num_epochs': 40, 'batch_size': 49, 'lr-adaptschedule': 'True', 'lr': 0.002039316621424828, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.8117695372669925}. Best is trial 50 with value: 0.8815165876777251.
acc: 0.843602
AUC: 0.929625
Avg Precision: 0.344985
Avg Recall: 1.000000
d_prime: 2.083140
train_loss: 0.022470
valid_loss: 0.992870
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0008855552420254281
Epoch-40 lr: 0.0008855552420254281
epoch 40 training time: 15.130
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f86448d1250>
The learning rate scheduler starts at 7 epoch with decay rate of 0.808 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 18:03:24.299861
current #epochs=1, #steps=0
start validation
acc: 0.829384
AUC: 0.920325
Avg Precision: 0.330593
Avg Recall: 1.000000
d_prime: 1.990163
train_loss: 0.027430
valid_loss: 1.012313
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.00243866073218836
Epoch-1 lr: 0.00243866073218836
epoch 1 training time: 18.290
---------------
2023-09-11 18:03:42.589999
current #epochs=2, #steps=40
start validation
acc: 0.824645
AUC: 0.901873
Avg Precision: 0.336901
Avg Recall: 1.000000
d_prime: 1.827586
train_loss: 0.071357
valid_loss: 1.026255
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.00243866073218836
Epoch-2 lr: 0.00243866073218836
epoch 2 training time: 15.298
---------------
2023-09-11 18:03:57.887979
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00160	Per Sample DNN Time 0.00556	Train Loss 0.0395	
start validation
acc: 0.815166
AUC: 0.929699
Avg Precision: 0.328993
Avg Recall: 1.000000
d_prime: 2.083920
train_loss: 0.041526
valid_loss: 0.975424
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.00243866073218836
Epoch-3 lr: 0.00243866073218836
epoch 3 training time: 16.269
---------------
2023-09-11 18:04:14.157079
current #epochs=4, #steps=120
start validation
acc: 0.843602
AUC: 0.919059
Avg Precision: 0.319318
Avg Recall: 1.000000
d_prime: 1.978156
train_loss: 0.039170
valid_loss: 1.003131
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00243866073218836
Epoch-4 lr: 0.00243866073218836
epoch 4 training time: 17.257
---------------
2023-09-11 18:04:31.414055
current #epochs=5, #steps=160
start validation
acc: 0.843602
AUC: 0.930669
Avg Precision: 0.337219
Avg Recall: 1.000000
d_prime: 2.094158
train_loss: 0.030199
valid_loss: 1.004341
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00243866073218836
Epoch-5 lr: 0.00243866073218836
epoch 5 training time: 15.266
---------------
2023-09-11 18:04:46.680428
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03635	Per Sample Data Time 0.02869	Per Sample DNN Time 0.00766	Train Loss 0.0042	
start validation
acc: 0.834123
AUC: 0.921885
Avg Precision: 0.340018
Avg Recall: 1.000000
d_prime: 2.005166
train_loss: 0.029266
valid_loss: 0.998293
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00243866073218836
Epoch-6 lr: 0.00243866073218836
epoch 6 training time: 16.832
---------------
2023-09-11 18:05:03.512329
current #epochs=7, #steps=240
start validation
acc: 0.838863
AUC: 0.932015
Avg Precision: 0.376160
Avg Recall: 1.000000
d_prime: 2.108547
train_loss: 0.016966
valid_loss: 0.990314
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0019704960169449532
Epoch-7 lr: 0.0019704960169449532
epoch 7 training time: 15.134
---------------
2023-09-11 18:05:18.646040
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00701	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00555	Train Loss 0.0159	
start validation
acc: 0.819905
AUC: 0.926194
Avg Precision: 0.347064
Avg Recall: 1.000000
d_prime: 2.047804
train_loss: 0.018555
valid_loss: 1.002723
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0019704960169449532
Epoch-8 lr: 0.0019704960169449532
epoch 8 training time: 14.976
---------------
2023-09-11 18:05:33.621937
current #epochs=9, #steps=320
start validation
acc: 0.838863
AUC: 0.924515
Avg Precision: 0.337180
Avg Recall: 1.000000
d_prime: 2.030968
train_loss: 0.034880
valid_loss: 1.014410
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0019704960169449532
Epoch-9 lr: 0.0019704960169449532
epoch 9 training time: 15.222
---------------
2023-09-11 18:05:48.844387
current #epochs=10, #steps=360
start validation
acc: 0.829384
AUC: 0.921055
Avg Precision: 0.325084
Avg Recall: 1.000000
d_prime: 1.997159
train_loss: 0.055159
valid_loss: 1.003654
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0019704960169449532
Epoch-10 lr: 0.0019704960169449532
epoch 10 training time: 15.189
---------------
2023-09-11 18:06:04.032926
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03553	Per Sample Data Time 0.02710	Per Sample DNN Time 0.00843	Train Loss 0.0031	
start validation
acc: 0.829384
AUC: 0.914710
Avg Precision: 0.331672
Avg Recall: 1.000000
d_prime: 1.937959
train_loss: 0.044753
valid_loss: 1.016407
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0019704960169449532
Epoch-11 lr: 0.0019704960169449532
epoch 11 training time: 15.057
---------------
2023-09-11 18:06:19.090151
current #epochs=12, #steps=440
start validation
acc: 0.838863
AUC: 0.928120
Avg Precision: 0.318407
Avg Recall: 1.000000
d_prime: 2.067485
train_loss: 0.036250
valid_loss: 1.011699
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0019704960169449532
Epoch-12 lr: 0.0019704960169449532
epoch 12 training time: 15.083
---------------
2023-09-11 18:06:34.172864
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00567	Train Loss 0.0525	
start validation
acc: 0.815166
AUC: 0.931855
Avg Precision: 0.337585
Avg Recall: 1.000000
d_prime: 2.106829
train_loss: 0.047552
valid_loss: 1.005729
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0019704960169449532
Epoch-13 lr: 0.0019704960169449532
epoch 13 training time: 15.251
---------------
2023-09-11 18:06:49.423899
current #epochs=14, #steps=520
start validation
acc: 0.848341
AUC: 0.937600
Avg Precision: 0.324679
Avg Recall: 1.000000
d_prime: 2.170719
train_loss: 0.035688
valid_loss: 0.985480
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0019704960169449532
Epoch-14 lr: 0.0019704960169449532
epoch 14 training time: 17.176
---------------
2023-09-11 18:07:06.600312
current #epochs=15, #steps=560
start validation
acc: 0.824645
AUC: 0.938102
Avg Precision: 0.351621
Avg Recall: 1.000000
d_prime: 2.176522
train_loss: 0.025926
valid_loss: 1.009756
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0019704960169449532
Epoch-15 lr: 0.0019704960169449532
epoch 15 training time: 15.145
---------------
2023-09-11 18:07:21.745462
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03761	Per Sample Data Time 0.02993	Per Sample DNN Time 0.00768	Train Loss 0.0252	
start validation
acc: 0.834123
AUC: 0.933161
Avg Precision: 0.324469
Avg Recall: 1.000000
d_prime: 2.120971
train_loss: 0.027532
valid_loss: 0.979038
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0015922077645099907
Epoch-16 lr: 0.0015922077645099907
epoch 16 training time: 15.044
---------------
2023-09-11 18:07:36.788861
current #epochs=17, #steps=640
start validation
acc: 0.829384
AUC: 0.929119
Avg Precision: 0.333421
Avg Recall: 1.000000
d_prime: 2.077853
train_loss: 0.031154
valid_loss: 0.994058
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0015922077645099907
Epoch-17 lr: 0.0015922077645099907
epoch 17 training time: 15.163
---------------
2023-09-11 18:07:51.951954
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00563	Train Loss 0.0203	
start validation
acc: 0.834123
AUC: 0.925150
Avg Precision: 0.314215
Avg Recall: 1.000000
d_prime: 2.037307
train_loss: 0.025007
valid_loss: 0.979943
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0015922077645099907
Epoch-18 lr: 0.0015922077645099907
epoch 18 training time: 15.064
---------------
2023-09-11 18:08:07.015919
current #epochs=19, #steps=720
start validation
acc: 0.796209
AUC: 0.924209
Avg Precision: 0.338933
Avg Recall: 1.000000
d_prime: 2.027932
train_loss: 0.026238
valid_loss: 1.011225
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0015922077645099907
Epoch-19 lr: 0.0015922077645099907
epoch 19 training time: 15.044
---------------
2023-09-11 18:08:22.059518
current #epochs=20, #steps=760
start validation
acc: 0.829384
AUC: 0.910812
Avg Precision: 0.317250
Avg Recall: 1.000000
d_prime: 1.903211
train_loss: 0.018423
valid_loss: 1.019508
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0015922077645099907
Epoch-20 lr: 0.0015922077645099907
epoch 20 training time: 14.975
---------------
2023-09-11 18:08:37.034482
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03889	Per Sample Data Time 0.02965	Per Sample DNN Time 0.00924	Train Loss 0.0045	
start validation
acc: 0.819905
AUC: 0.920649
Avg Precision: 0.317689
Avg Recall: 1.000000
d_prime: 1.993263
train_loss: 0.035099
valid_loss: 0.994925
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0015922077645099907
Epoch-21 lr: 0.0015922077645099907
epoch 21 training time: 16.400
---------------
2023-09-11 18:08:53.434136
current #epochs=22, #steps=840
start validation
acc: 0.815166
AUC: 0.922002
Avg Precision: 0.331163
Avg Recall: 1.000000
d_prime: 2.006301
train_loss: 0.024790
valid_loss: 1.016389
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0015922077645099907
Epoch-22 lr: 0.0015922077645099907
epoch 22 training time: 15.197
---------------
2023-09-11 18:09:08.631123
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00566	Train Loss 0.0327	
start validation
acc: 0.843602
AUC: 0.926186
Avg Precision: 0.332909
Avg Recall: 1.000000
d_prime: 2.047723
train_loss: 0.031036
valid_loss: 0.998092
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0015922077645099907
Epoch-23 lr: 0.0015922077645099907
epoch 23 training time: 15.428
---------------
2023-09-11 18:09:24.058827
current #epochs=24, #steps=920
start validation
acc: 0.853081
AUC: 0.926718
Avg Precision: 0.327729
Avg Recall: 1.000000
d_prime: 2.053125
train_loss: 0.023674
valid_loss: 0.992251
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0015922077645099907
Epoch-24 lr: 0.0015922077645099907
epoch 24 training time: 17.129
---------------
2023-09-11 18:09:41.187399
current #epochs=25, #steps=960
start validation
acc: 0.853081
AUC: 0.927192
Avg Precision: 0.335379
Avg Recall: 1.000000
d_prime: 2.057948
train_loss: 0.025063
valid_loss: 0.991945
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.001286541836961613
Epoch-25 lr: 0.001286541836961613
epoch 25 training time: 15.219
---------------
2023-09-11 18:09:56.406892
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03955	Per Sample Data Time 0.02874	Per Sample DNN Time 0.01081	Train Loss 0.0526	
start validation
acc: 0.824645
AUC: 0.917943
Avg Precision: 0.339401
Avg Recall: 1.000000
d_prime: 1.967694
train_loss: 0.024038
valid_loss: 0.993556
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.001286541836961613
Epoch-26 lr: 0.001286541836961613
epoch 26 training time: 15.804
---------------
2023-09-11 18:10:12.211165
current #epochs=27, #steps=1040
start validation
acc: 0.810427
AUC: 0.922193
Avg Precision: 0.352778
Avg Recall: 1.000000
d_prime: 2.008149
train_loss: 0.029388
valid_loss: 0.994515
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.001286541836961613
Epoch-27 lr: 0.001286541836961613
epoch 27 training time: 15.298
---------------
2023-09-11 18:10:27.508956
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00562	Train Loss 0.0287	
start validation
acc: 0.824645
AUC: 0.931969
Avg Precision: 0.333927
Avg Recall: 1.000000
d_prime: 2.108051
train_loss: 0.024677
valid_loss: 0.991413
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.001286541836961613
Epoch-28 lr: 0.001286541836961613
epoch 28 training time: 15.112
---------------
2023-09-11 18:10:42.621332
current #epochs=29, #steps=1120
start validation
acc: 0.824645
AUC: 0.920283
Avg Precision: 0.306613
Avg Recall: 1.000000
d_prime: 1.989770
train_loss: 0.034362
valid_loss: 0.982919
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.001286541836961613
Epoch-29 lr: 0.001286541836961613
epoch 29 training time: 15.268
---------------
2023-09-11 18:10:57.890026
current #epochs=30, #steps=1160
start validation
acc: 0.815166
AUC: 0.921788
Avg Precision: 0.335750
Avg Recall: 1.000000
d_prime: 2.004230
train_loss: 0.025546
valid_loss: 0.984722
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.001286541836961613
Epoch-30 lr: 0.001286541836961613
epoch 30 training time: 15.278
---------------
2023-09-11 18:11:13.168050
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03619	Per Sample Data Time 0.02801	Per Sample DNN Time 0.00818	Train Loss 0.0004	
start validation
acc: 0.800948
AUC: 0.918730
Avg Precision: 0.331403
Avg Recall: 1.000000
d_prime: 1.975063
train_loss: 0.030802
valid_loss: 1.011991
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.001286541836961613
Epoch-31 lr: 0.001286541836961613
epoch 31 training time: 15.599
---------------
2023-09-11 18:11:28.767344
current #epochs=32, #steps=1240
start validation
acc: 0.834123
AUC: 0.915657
Avg Precision: 0.344306
Avg Recall: 1.000000
d_prime: 1.946575
train_loss: 0.053177
valid_loss: 1.012894
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.001286541836961613
Epoch-32 lr: 0.001286541836961613
epoch 32 training time: 15.118
---------------
2023-09-11 18:11:43.885850
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00567	Train Loss 0.0254	
start validation
acc: 0.834123
AUC: 0.922380
Avg Precision: 0.349284
Avg Recall: 1.000000
d_prime: 2.009975
train_loss: 0.036937
valid_loss: 0.995129
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.001286541836961613
Epoch-33 lr: 0.001286541836961613
epoch 33 training time: 15.179
---------------
2023-09-11 18:11:59.064679
current #epochs=34, #steps=1320
start validation
acc: 0.834123
AUC: 0.924793
Avg Precision: 0.346649
Avg Recall: 1.000000
d_prime: 2.033742
train_loss: 0.023839
valid_loss: 0.997141
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0010395564794660791
Epoch-34 lr: 0.0010395564794660791
epoch 34 training time: 15.277
---------------
2023-09-11 18:12:14.341751
current #epochs=35, #steps=1360
start validation
acc: 0.810427
AUC: 0.920808
Avg Precision: 0.349820
Avg Recall: 1.000000
d_prime: 1.994788
train_loss: 0.017022
valid_loss: 0.993547
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0010395564794660791
Epoch-35 lr: 0.0010395564794660791
epoch 35 training time: 15.806
---------------
2023-09-11 18:12:30.147901
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03852	Per Sample Data Time 0.02754	Per Sample DNN Time 0.01098	Train Loss 0.0578	
start validation
acc: 0.829384
AUC: 0.924906
Avg Precision: 0.353473
Avg Recall: 1.000000
d_prime: 2.034869
train_loss: 0.028932
valid_loss: 0.999617
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0010395564794660791
Epoch-36 lr: 0.0010395564794660791
epoch 36 training time: 15.090
---------------
2023-09-11 18:12:45.237531
current #epochs=37, #steps=1440
start validation
acc: 0.853081
AUC: 0.930647
Avg Precision: 0.346222
Avg Recall: 1.000000
d_prime: 2.093925
train_loss: 0.016476
valid_loss: 0.983699
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0010395564794660791
Epoch-37 lr: 0.0010395564794660791
epoch 37 training time: 15.258
---------------
2023-09-11 18:13:00.495822
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00564	Train Loss 0.0269	
start validation
acc: 0.834123
AUC: 0.927856
Avg Precision: 0.369289
Avg Recall: 1.000000
d_prime: 2.064766
train_loss: 0.022944
valid_loss: 1.008656
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0010395564794660791
Epoch-38 lr: 0.0010395564794660791
epoch 38 training time: 15.065
---------------
2023-09-11 18:13:15.560968
current #epochs=39, #steps=1520
start validation
acc: 0.843602
AUC: 0.929045
Avg Precision: 0.369281
Avg Recall: 1.000000
d_prime: 2.077080
train_loss: 0.017347
valid_loss: 1.006642
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0010395564794660791
Epoch-39 lr: 0.0010395564794660791
epoch 39 training time: 15.254
---------------
2023-09-11 18:13:30.814652
current #epochs=40, #steps=1560
start validation
acc: 0.829384
AUC: 0.928223
Avg Precision: 0.359769
Avg Recall: 1.000000
d_prime: 2.068546
train_loss: 0.019548
valid_loss: 1.000998
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0010395564794660791
Epoch-40 lr: 0.0010395564794660791
epoch 40 training time: 15.143
---------------
2023-09-11 18:13:45.957225
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03696	Per Sample Data Time 0.02958	Per Sample DNN Time 0.00738	Train Loss 0.0211	
start validation
acc: 0.834123
AUC: 0.929175
Avg Precision: 0.353516
Avg Recall: 1.000000
d_prime: 2.078438
train_loss: 0.015707
valid_loss: 0.985480
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0010395564794660791
Epoch-41 lr: 0.0010395564794660791
epoch 41 training time: 15.409
---------------
2023-09-11 18:14:01.365738
current #epochs=42, #steps=1640
start validation
acc: 0.834123
AUC: 0.931871
Avg Precision: 0.350848
Avg Recall: 1.000000
d_prime: 2.106994
train_loss: 0.015349
valid_loss: 0.979228
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0010395564794660791
Epoch-42 lr: 0.0010395564794660791
epoch 42 training time: 15.210
---------------
2023-09-11 18:14:16.576541
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00142	Per Sample DNN Time 0.00568	Train Loss 0.0125	
start validation
[I 2023-09-11 18:14:31,618] Trial 69 finished with value: 0.8530805687203792 and parameters: {'warmup': 'False', 'num_epochs': 43, 'batch_size': 50, 'lr-adaptschedule': 'True', 'lr': 0.00243866073218836, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.808023843143079}. Best is trial 50 with value: 0.8815165876777251.
acc: 0.824645
AUC: 0.934760
Avg Precision: 0.367020
Avg Recall: 1.000000
d_prime: 2.138590
train_loss: 0.020131
valid_loss: 0.998694
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0008399864217024705
Epoch-43 lr: 0.0008399864217024705
epoch 43 training time: 15.030
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f866701ec40>
The learning rate scheduler starts at 7 epoch with decay rate of 0.822 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 18:14:31.657644
current #epochs=1, #steps=0
start validation
acc: 0.810427
AUC: 0.919991
Avg Precision: 0.347604
Avg Recall: 1.000000
d_prime: 1.986984
train_loss: 0.041350
valid_loss: 1.051946
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0022104004576567293
Epoch-1 lr: 0.004420800915313459
epoch 1 training time: 17.066
---------------
2023-09-11 18:14:48.724213
current #epochs=2, #steps=40
start validation
acc: 0.848341
AUC: 0.926456
Avg Precision: 0.317658
Avg Recall: 1.000000
d_prime: 2.050459
train_loss: 0.048034
valid_loss: 0.996696
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0022104004576567293
Epoch-2 lr: 0.004420800915313459
epoch 2 training time: 17.336
---------------
2023-09-11 18:15:06.060350
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00566	Train Loss 0.0427	
start validation
acc: 0.853081
AUC: 0.926998
Avg Precision: 0.328181
Avg Recall: 1.000000
d_prime: 2.055968
train_loss: 0.034737
valid_loss: 0.987670
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0022104004576567293
Epoch-3 lr: 0.004420800915313459
epoch 3 training time: 17.263
---------------
2023-09-11 18:15:23.322979
current #epochs=4, #steps=120
start validation
acc: 0.857820
AUC: 0.933859
Avg Precision: 0.343120
Avg Recall: 1.000000
d_prime: 2.128626
train_loss: 0.027334
valid_loss: 0.993912
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0022104004576567293
Epoch-4 lr: 0.004420800915313459
epoch 4 training time: 17.108
---------------
2023-09-11 18:15:40.431029
current #epochs=5, #steps=160
start validation
acc: 0.838863
AUC: 0.925398
Avg Precision: 0.314308
Avg Recall: 1.000000
d_prime: 2.039792
train_loss: 0.038209
valid_loss: 1.004907
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0022104004576567293
Epoch-5 lr: 0.004420800915313459
epoch 5 training time: 15.150
---------------
2023-09-11 18:15:55.580733
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03737	Per Sample Data Time 0.02925	Per Sample DNN Time 0.00812	Train Loss 0.0079	
start validation
acc: 0.838863
AUC: 0.914333
Avg Precision: 0.320945
Avg Recall: 1.000000
d_prime: 1.934546
train_loss: 0.026431
valid_loss: 1.002885
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0022104004576567293
Epoch-6 lr: 0.004420800915313459
epoch 6 training time: 15.215
---------------
2023-09-11 18:16:10.795923
current #epochs=7, #steps=240
start validation
acc: 0.848341
AUC: 0.908104
Avg Precision: 0.306635
Avg Recall: 1.000000
d_prime: 1.879734
train_loss: 0.028685
valid_loss: 1.011099
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.001816586423824916
Epoch-7 lr: 0.003633172847649832
epoch 7 training time: 15.088
---------------
2023-09-11 18:16:25.884139
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00556	Train Loss 0.0429	
start validation
acc: 0.834123
AUC: 0.923070
Avg Precision: 0.303844
Avg Recall: 1.000000
d_prime: 2.016711
train_loss: 0.039190
valid_loss: 0.993253
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001816586423824916
Epoch-8 lr: 0.003633172847649832
epoch 8 training time: 15.077
---------------
2023-09-11 18:16:40.961673
current #epochs=9, #steps=320
start validation
acc: 0.838863
AUC: 0.910123
Avg Precision: 0.326848
Avg Recall: 1.000000
d_prime: 1.897187
train_loss: 0.024442
valid_loss: 1.014133
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001816586423824916
Epoch-9 lr: 0.003633172847649832
epoch 9 training time: 15.097
---------------
2023-09-11 18:16:56.058679
current #epochs=10, #steps=360
start validation
acc: 0.815166
AUC: 0.905968
Avg Precision: 0.332717
Avg Recall: 1.000000
d_prime: 1.861573
train_loss: 0.019623
valid_loss: 1.016227
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001816586423824916
Epoch-10 lr: 0.003633172847649832
epoch 10 training time: 16.720
---------------
2023-09-11 18:17:12.778170
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03714	Per Sample Data Time 0.02889	Per Sample DNN Time 0.00825	Train Loss 0.0048	
start validation
acc: 0.843602
AUC: 0.926600
Avg Precision: 0.327507
Avg Recall: 1.000000
d_prime: 2.051925
train_loss: 0.030476
valid_loss: 0.990272
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001816586423824916
Epoch-11 lr: 0.003633172847649832
epoch 11 training time: 16.195
---------------
2023-09-11 18:17:28.972956
current #epochs=12, #steps=440
start validation
acc: 0.838863
AUC: 0.929506
Avg Precision: 0.374725
Avg Recall: 1.000000
d_prime: 2.081890
train_loss: 0.023412
valid_loss: 0.992156
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001816586423824916
Epoch-12 lr: 0.003633172847649832
epoch 12 training time: 15.126
---------------
2023-09-11 18:17:44.098732
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00566	Train Loss 0.0233	
start validation
acc: 0.829384
AUC: 0.922128
Avg Precision: 0.354247
Avg Recall: 1.000000
d_prime: 2.007524
train_loss: 0.022376
valid_loss: 1.023579
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.001816586423824916
Epoch-13 lr: 0.003633172847649832
epoch 13 training time: 15.129
---------------
2023-09-11 18:17:59.228238
current #epochs=14, #steps=520
start validation
acc: 0.829384
AUC: 0.923885
Avg Precision: 0.358888
Avg Recall: 1.000000
d_prime: 2.024729
train_loss: 0.033313
valid_loss: 1.003584
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.001816586423824916
Epoch-14 lr: 0.003633172847649832
epoch 14 training time: 15.078
---------------
2023-09-11 18:18:14.306373
current #epochs=15, #steps=560
start validation
acc: 0.829384
AUC: 0.934194
Avg Precision: 0.371124
Avg Recall: 1.000000
d_prime: 2.132314
train_loss: 0.031218
valid_loss: 1.023542
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.001816586423824916
Epoch-15 lr: 0.003633172847649832
epoch 15 training time: 15.164
---------------
2023-09-11 18:18:29.470500
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03666	Per Sample Data Time 0.02707	Per Sample DNN Time 0.00959	Train Loss 0.0455	
start validation
acc: 0.829384
AUC: 0.902980
Avg Precision: 0.320662
Avg Recall: 1.000000
d_prime: 1.836670
train_loss: 0.039124
valid_loss: 1.031883
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.001816586423824916
Epoch-16 lr: 0.003633172847649832
epoch 16 training time: 15.048
---------------
2023-09-11 18:18:44.517880
current #epochs=17, #steps=640
start validation
acc: 0.810427
AUC: 0.926675
Avg Precision: 0.350909
Avg Recall: 1.000000
d_prime: 2.052680
train_loss: 0.029003
valid_loss: 1.001149
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.001492935917468706
Epoch-17 lr: 0.002985871834937412
epoch 17 training time: 15.099
---------------
2023-09-11 18:18:59.617638
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00569	Train Loss 0.0371	
start validation
acc: 0.829384
AUC: 0.933886
Avg Precision: 0.352390
Avg Recall: 1.000000
d_prime: 2.128915
train_loss: 0.031461
valid_loss: 0.990987
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001492935917468706
Epoch-18 lr: 0.002985871834937412
epoch 18 training time: 15.452
---------------
2023-09-11 18:19:15.069554
current #epochs=19, #steps=720
start validation
acc: 0.857820
AUC: 0.931793
Avg Precision: 0.349075
Avg Recall: 1.000000
d_prime: 2.106161
train_loss: 0.026786
valid_loss: 0.989330
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.001492935917468706
Epoch-19 lr: 0.002985871834937412
epoch 19 training time: 15.206
---------------
2023-09-11 18:19:30.275704
current #epochs=20, #steps=760
start validation
acc: 0.853081
AUC: 0.930306
Avg Precision: 0.360130
Avg Recall: 1.000000
d_prime: 2.090311
train_loss: 0.032660
valid_loss: 0.999071
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.001492935917468706
Epoch-20 lr: 0.002985871834937412
epoch 20 training time: 15.295
---------------
2023-09-11 18:19:45.570991
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03648	Per Sample Data Time 0.02845	Per Sample DNN Time 0.00803	Train Loss 0.0455	
start validation
acc: 0.838863
AUC: 0.931690
Avg Precision: 0.369257
Avg Recall: 1.000000
d_prime: 2.105057
train_loss: 0.020325
valid_loss: 1.014753
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.001492935917468706
Epoch-21 lr: 0.002985871834937412
epoch 21 training time: 15.157
---------------
2023-09-11 18:20:00.728249
current #epochs=22, #steps=840
start validation
acc: 0.834123
AUC: 0.926382
Avg Precision: 0.344292
Avg Recall: 1.000000
d_prime: 2.049713
train_loss: 0.024396
valid_loss: 1.002085
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.001492935917468706
Epoch-22 lr: 0.002985871834937412
epoch 22 training time: 15.134
---------------
2023-09-11 18:20:15.862148
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00560	Train Loss 0.0238	
start validation
acc: 0.838863
AUC: 0.917181
Avg Precision: 0.335690
Avg Recall: 1.000000
d_prime: 1.960606
train_loss: 0.016145
valid_loss: 0.993114
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.001492935917468706
Epoch-23 lr: 0.002985871834937412
epoch 23 training time: 15.187
---------------
2023-09-11 18:20:31.048680
current #epochs=24, #steps=920
start validation
acc: 0.824645
AUC: 0.911820
Avg Precision: 0.326341
Avg Recall: 1.000000
d_prime: 1.912081
train_loss: 0.018803
valid_loss: 1.011287
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.001492935917468706
Epoch-24 lr: 0.002985871834937412
epoch 24 training time: 15.044
---------------
2023-09-11 18:20:46.092659
current #epochs=25, #steps=960
start validation
acc: 0.848341
AUC: 0.926227
Avg Precision: 0.321252
Avg Recall: 1.000000
d_prime: 2.048140
train_loss: 0.029392
valid_loss: 1.003563
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.001492935917468706
Epoch-25 lr: 0.002985871834937412
epoch 25 training time: 15.099
---------------
2023-09-11 18:21:01.191431
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03746	Per Sample Data Time 0.02980	Per Sample DNN Time 0.00765	Train Loss 0.0733	
start validation
acc: 0.843602
AUC: 0.930877
Avg Precision: 0.338228
Avg Recall: 1.000000
d_prime: 2.096370
train_loss: 0.033376
valid_loss: 1.006420
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.001492935917468706
Epoch-26 lr: 0.002985871834937412
epoch 26 training time: 15.169
---------------
2023-09-11 18:21:16.360632
current #epochs=27, #steps=1040
start validation
acc: 0.857820
AUC: 0.931658
Avg Precision: 0.349782
Avg Recall: 1.000000
d_prime: 2.104713
train_loss: 0.026697
valid_loss: 1.001699
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0012269483160482686
Epoch-27 lr: 0.002453896632096537
epoch 27 training time: 14.954
---------------
2023-09-11 18:21:31.315118
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00730	Per Sample Data Time 0.00159	Per Sample DNN Time 0.00571	Train Loss 0.0237	
start validation
acc: 0.838863
AUC: 0.927091
Avg Precision: 0.336681
Avg Recall: 1.000000
d_prime: 2.056922
train_loss: 0.018604
valid_loss: 1.007784
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0012269483160482686
Epoch-28 lr: 0.002453896632096537
epoch 28 training time: 15.292
---------------
2023-09-11 18:21:46.606852
current #epochs=29, #steps=1120
start validation
acc: 0.853081
AUC: 0.914393
Avg Precision: 0.337285
Avg Recall: 1.000000
d_prime: 1.935087
train_loss: 0.017160
valid_loss: 1.008055
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0012269483160482686
Epoch-29 lr: 0.002453896632096537
epoch 29 training time: 15.063
---------------
2023-09-11 18:22:01.670182
current #epochs=30, #steps=1160
start validation
acc: 0.843602
AUC: 0.914750
Avg Precision: 0.345176
Avg Recall: 1.000000
d_prime: 1.938318
train_loss: 0.024585
valid_loss: 1.005680
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0012269483160482686
Epoch-30 lr: 0.002453896632096537
epoch 30 training time: 16.035
---------------
2023-09-11 18:22:17.704809
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03832	Per Sample Data Time 0.02865	Per Sample DNN Time 0.00968	Train Loss 0.0410	
start validation
acc: 0.834123
AUC: 0.926011
Avg Precision: 0.345082
Avg Recall: 1.000000
d_prime: 2.045957
train_loss: 0.014095
valid_loss: 1.004061
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0012269483160482686
Epoch-31 lr: 0.002453896632096537
epoch 31 training time: 16.215
---------------
2023-09-11 18:22:33.919902
current #epochs=32, #steps=1240
start validation
acc: 0.829384
AUC: 0.924254
Avg Precision: 0.332856
Avg Recall: 1.000000
d_prime: 2.028376
train_loss: 0.019233
valid_loss: 1.007520
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0012269483160482686
Epoch-32 lr: 0.002453896632096537
epoch 32 training time: 15.112
---------------
2023-09-11 18:22:49.031547
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00567	Train Loss 0.0197	
start validation
acc: 0.834123
AUC: 0.931698
Avg Precision: 0.329282
Avg Recall: 1.000000
d_prime: 2.105140
train_loss: 0.017065
valid_loss: 0.995417
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0012269483160482686
Epoch-33 lr: 0.002453896632096537
epoch 33 training time: 15.099
---------------
2023-09-11 18:23:04.130189
current #epochs=34, #steps=1320
start validation
acc: 0.838863
AUC: 0.933544
Avg Precision: 0.363981
Avg Recall: 1.000000
d_prime: 2.125167
train_loss: 0.021468
valid_loss: 1.001932
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0012269483160482686
Epoch-34 lr: 0.002453896632096537
epoch 34 training time: 15.066
---------------
2023-09-11 18:23:19.196069
current #epochs=35, #steps=1360
start validation
acc: 0.862559
AUC: 0.926041
Avg Precision: 0.350313
Avg Recall: 1.000000
d_prime: 2.046260
train_loss: 0.024812
valid_loss: 1.012594
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0012269483160482686
Epoch-35 lr: 0.002453896632096537
epoch 35 training time: 17.122
---------------
2023-09-11 18:23:36.318492
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03823	Per Sample Data Time 0.03042	Per Sample DNN Time 0.00781	Train Loss 0.0654	
start validation
acc: 0.853081
AUC: 0.926187
Avg Precision: 0.346523
Avg Recall: 1.000000
d_prime: 2.047731
train_loss: 0.021047
valid_loss: 1.017327
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0012269483160482686
Epoch-36 lr: 0.002453896632096537
epoch 36 training time: 15.106
---------------
2023-09-11 18:23:51.423894
current #epochs=37, #steps=1440
start validation
acc: 0.843602
AUC: 0.921259
Avg Precision: 0.347408
Avg Recall: 1.000000
d_prime: 1.999119
train_loss: 0.016539
valid_loss: 1.012157
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.001008350159333103
Epoch-37 lr: 0.002016700318666206
epoch 37 training time: 15.121
---------------
2023-09-11 18:24:06.545434
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00570	Train Loss 0.0250	
start validation
acc: 0.843602
AUC: 0.915703
Avg Precision: 0.345774
Avg Recall: 1.000000
d_prime: 1.947002
train_loss: 0.021466
valid_loss: 1.010035
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.001008350159333103
Epoch-38 lr: 0.002016700318666206
epoch 38 training time: 15.090
---------------
2023-09-11 18:24:21.635165
current #epochs=39, #steps=1520
start validation
acc: 0.843602
AUC: 0.919242
Avg Precision: 0.340488
Avg Recall: 1.000000
d_prime: 1.979884
train_loss: 0.026730
valid_loss: 1.006787
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.001008350159333103
Epoch-39 lr: 0.002016700318666206
epoch 39 training time: 15.198
---------------
2023-09-11 18:24:36.833468
current #epochs=40, #steps=1560
start validation
acc: 0.819905
AUC: 0.920145
Avg Precision: 0.336419
Avg Recall: 1.000000
d_prime: 1.988454
train_loss: 0.033756
valid_loss: 1.020268
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.001008350159333103
Epoch-40 lr: 0.002016700318666206
epoch 40 training time: 15.908
---------------
2023-09-11 18:24:52.741408
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03712	Per Sample Data Time 0.02933	Per Sample DNN Time 0.00779	Train Loss 0.0065	
start validation
acc: 0.819905
AUC: 0.927719
Avg Precision: 0.353101
Avg Recall: 1.000000
d_prime: 2.063355
train_loss: 0.035069
valid_loss: 0.993712
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.001008350159333103
Epoch-41 lr: 0.002016700318666206
epoch 41 training time: 15.056
---------------
2023-09-11 18:25:07.797445
current #epochs=42, #steps=1640
start validation
acc: 0.829384
AUC: 0.926254
Avg Precision: 0.358695
Avg Recall: 1.000000
d_prime: 2.048412
train_loss: 0.022741
valid_loss: 0.999049
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.001008350159333103
Epoch-42 lr: 0.002016700318666206
epoch 42 training time: 15.137
---------------
2023-09-11 18:25:22.934355
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00567	Train Loss 0.0176	
start validation
acc: 0.810427
AUC: 0.920368
Avg Precision: 0.355193
Avg Recall: 1.000000
d_prime: 1.990574
train_loss: 0.019949
valid_loss: 1.005033
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.001008350159333103
Epoch-43 lr: 0.002016700318666206
epoch 43 training time: 15.135
---------------
2023-09-11 18:25:38.069568
current #epochs=44, #steps=1720
start validation
acc: 0.824645
AUC: 0.929130
Avg Precision: 0.372951
Avg Recall: 1.000000
d_prime: 2.077962
train_loss: 0.020897
valid_loss: 0.994814
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.001008350159333103
Epoch-44 lr: 0.002016700318666206
epoch 44 training time: 16.928
---------------
2023-09-11 18:25:54.997701
current #epochs=45, #steps=1760
start validation
acc: 0.829384
AUC: 0.929058
Avg Precision: 0.361312
Avg Recall: 1.000000
d_prime: 2.077211
train_loss: 0.016643
valid_loss: 0.993949
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.001008350159333103
Epoch-45 lr: 0.002016700318666206
epoch 45 training time: 15.227
---------------
2023-09-11 18:26:10.224512
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03628	Per Sample Data Time 0.02853	Per Sample DNN Time 0.00775	Train Loss 0.0020	
start validation
acc: 0.819905
AUC: 0.923074
Avg Precision: 0.358416
Avg Recall: 1.000000
d_prime: 2.016745
train_loss: 0.014278
valid_loss: 1.002558
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.001008350159333103
Epoch-46 lr: 0.002016700318666206
epoch 46 training time: 15.200
---------------
2023-09-11 18:26:25.423761
current #epochs=47, #steps=1840
start validation
acc: 0.843602
AUC: 0.917899
Avg Precision: 0.352769
Avg Recall: 1.000000
d_prime: 1.967281
train_loss: 0.016860
valid_loss: 1.003407
validation finished
normal learning rate scheduler step
Epoch-47 lr: 0.0008286983490077948
Epoch-47 lr: 0.0016573966980155896
epoch 47 training time: 15.230
---------------
2023-09-11 18:26:40.654161
current #epochs=48, #steps=1880
Epoch: [48][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00569	Train Loss 0.0074	
start validation
[I 2023-09-11 18:26:55,840] Trial 70 finished with value: 0.8625592417061612 and parameters: {'warmup': 'False', 'num_epochs': 48, 'batch_size': 54, 'lr-adaptschedule': 'True', 'lr': 0.0022104004576567293, 'head-lr': 2, 'lr-scheduler-start': 7, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.8218358883940423}. Best is trial 50 with value: 0.8815165876777251.
acc: 0.824645
AUC: 0.915515
Avg Precision: 0.342869
Avg Recall: 1.000000
d_prime: 1.945284
train_loss: 0.010184
valid_loss: 1.017912
validation finished
normal learning rate scheduler step
Epoch-48 lr: 0.0008286983490077948
Epoch-48 lr: 0.0016573966980155896
epoch 48 training time: 15.172
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f86448d1f10>
The learning rate scheduler starts at 6 epoch with decay rate of 0.800 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 18:26:55.878841
current #epochs=1, #steps=0
start validation
acc: 0.805687
AUC: 0.906934
Avg Precision: 0.326587
Avg Recall: 1.000000
d_prime: 1.869747
train_loss: 0.041237
valid_loss: 1.046258
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0024884029099515458
Epoch-1 lr: 0.0024884029099515458
epoch 1 training time: 17.086
---------------
2023-09-11 18:27:12.965420
current #epochs=2, #steps=40
start validation
acc: 0.824645
AUC: 0.928806
Avg Precision: 0.335194
Avg Recall: 1.000000
d_prime: 2.074589
train_loss: 0.043846
valid_loss: 1.009338
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0024884029099515458
Epoch-2 lr: 0.0024884029099515458
epoch 2 training time: 17.077
---------------
2023-09-11 18:27:30.042165
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00729	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00575	Train Loss 0.0352	
start validation
acc: 0.824645
AUC: 0.913227
Avg Precision: 0.338776
Avg Recall: 1.000000
d_prime: 1.924600
train_loss: 0.032801
valid_loss: 1.036545
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0024884029099515458
Epoch-3 lr: 0.0024884029099515458
epoch 3 training time: 15.230
---------------
2023-09-11 18:27:45.272365
current #epochs=4, #steps=120
start validation
acc: 0.810427
AUC: 0.889187
Avg Precision: 0.318379
Avg Recall: 1.000000
d_prime: 1.728472
train_loss: 0.048856
valid_loss: 1.036095
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0024884029099515458
Epoch-4 lr: 0.0024884029099515458
epoch 4 training time: 15.197
---------------
2023-09-11 18:28:00.469188
current #epochs=5, #steps=160
start validation
acc: 0.838863
AUC: 0.916305
Avg Precision: 0.334131
Avg Recall: 1.000000
d_prime: 1.952517
train_loss: 0.044614
valid_loss: 1.030278
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0024884029099515458
Epoch-5 lr: 0.0024884029099515458
epoch 5 training time: 17.821
---------------
2023-09-11 18:28:18.290410
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03861	Per Sample Data Time 0.02868	Per Sample DNN Time 0.00993	Train Loss 0.0164	
start validation
acc: 0.805687
AUC: 0.913088
Avg Precision: 0.339926
Avg Recall: 1.000000
d_prime: 1.923360
train_loss: 0.040185
valid_loss: 1.014201
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0019902612950896442
Epoch-6 lr: 0.0019902612950896442
epoch 6 training time: 15.158
---------------
2023-09-11 18:28:33.447902
current #epochs=7, #steps=240
start validation
acc: 0.810427
AUC: 0.917014
Avg Precision: 0.337686
Avg Recall: 1.000000
d_prime: 1.959055
train_loss: 0.025976
valid_loss: 1.005708
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0019902612950896442
Epoch-7 lr: 0.0019902612950896442
epoch 7 training time: 15.234
---------------
2023-09-11 18:28:48.681786
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00566	Train Loss 0.0170	
start validation
acc: 0.834123
AUC: 0.918705
Avg Precision: 0.319331
Avg Recall: 1.000000
d_prime: 1.974829
train_loss: 0.021580
valid_loss: 1.009872
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0019902612950896442
Epoch-8 lr: 0.0019902612950896442
epoch 8 training time: 15.444
---------------
2023-09-11 18:29:04.125684
current #epochs=9, #steps=320
start validation
acc: 0.824645
AUC: 0.921211
Avg Precision: 0.317402
Avg Recall: 1.000000
d_prime: 1.998656
train_loss: 0.030509
valid_loss: 1.008158
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0019902612950896442
Epoch-9 lr: 0.0019902612950896442
epoch 9 training time: 15.252
---------------
2023-09-11 18:29:19.377779
current #epochs=10, #steps=360
start validation
acc: 0.848341
AUC: 0.928468
Avg Precision: 0.332245
Avg Recall: 1.000000
d_prime: 2.071082
train_loss: 0.024607
valid_loss: 0.994488
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0019902612950896442
Epoch-10 lr: 0.0019902612950896442
epoch 10 training time: 17.118
---------------
2023-09-11 18:29:36.496069
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03983	Per Sample Data Time 0.02883	Per Sample DNN Time 0.01100	Train Loss 0.0046	
start validation
acc: 0.791469
AUC: 0.913892
Avg Precision: 0.313011
Avg Recall: 1.000000
d_prime: 1.930567
train_loss: 0.033621
valid_loss: 1.005024
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0019902612950896442
Epoch-11 lr: 0.0019902612950896442
epoch 11 training time: 15.740
---------------
2023-09-11 18:29:52.236015
current #epochs=12, #steps=440
start validation
acc: 0.843602
AUC: 0.927063
Avg Precision: 0.318440
Avg Recall: 1.000000
d_prime: 2.056638
train_loss: 0.024133
valid_loss: 1.004117
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0019902612950896442
Epoch-12 lr: 0.0019902612950896442
epoch 12 training time: 16.593
---------------
2023-09-11 18:30:08.828831
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00573	Train Loss 0.0336	
start validation
acc: 0.838863
AUC: 0.924839
Avg Precision: 0.320493
Avg Recall: 1.000000
d_prime: 2.034199
train_loss: 0.036157
valid_loss: 1.003657
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0019902612950896442
Epoch-13 lr: 0.0019902612950896442
epoch 13 training time: 15.654
---------------
2023-09-11 18:30:24.483020
current #epochs=14, #steps=520
start validation
acc: 0.838863
AUC: 0.923429
Avg Precision: 0.320402
Avg Recall: 1.000000
d_prime: 2.020229
train_loss: 0.021902
valid_loss: 1.003349
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0019902612950896442
Epoch-14 lr: 0.0019902612950896442
epoch 14 training time: 15.136
---------------
2023-09-11 18:30:39.618881
current #epochs=15, #steps=560
start validation
acc: 0.843602
AUC: 0.922773
Avg Precision: 0.319446
Avg Recall: 1.000000
d_prime: 2.013798
train_loss: 0.031153
valid_loss: 0.996895
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0019902612950896442
Epoch-15 lr: 0.0019902612950896442
epoch 15 training time: 15.138
---------------
2023-09-11 18:30:54.756884
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03721	Per Sample Data Time 0.02916	Per Sample DNN Time 0.00805	Train Loss 0.0783	
start validation
acc: 0.834123
AUC: 0.931720
Avg Precision: 0.349290
Avg Recall: 1.000000
d_prime: 2.105372
train_loss: 0.035315
valid_loss: 1.014070
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0015918402951911994
Epoch-16 lr: 0.0015918402951911994
epoch 16 training time: 15.305
---------------
2023-09-11 18:31:10.062236
current #epochs=17, #steps=640
start validation
acc: 0.824645
AUC: 0.921313
Avg Precision: 0.311753
Avg Recall: 1.000000
d_prime: 1.999644
train_loss: 0.031828
valid_loss: 1.002557
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0015918402951911994
Epoch-17 lr: 0.0015918402951911994
epoch 17 training time: 16.256
---------------
2023-09-11 18:31:26.318520
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00571	Train Loss 0.0292	
start validation
acc: 0.829384
AUC: 0.934843
Avg Precision: 0.345210
Avg Recall: 1.000000
d_prime: 2.139515
train_loss: 0.025024
valid_loss: 1.013810
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0015918402951911994
Epoch-18 lr: 0.0015918402951911994
epoch 18 training time: 15.664
---------------
2023-09-11 18:31:41.982823
current #epochs=19, #steps=720
start validation
acc: 0.829384
AUC: 0.931748
Avg Precision: 0.364121
Avg Recall: 1.000000
d_prime: 2.105674
train_loss: 0.031607
valid_loss: 1.023572
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0015918402951911994
Epoch-19 lr: 0.0015918402951911994
epoch 19 training time: 16.179
---------------
2023-09-11 18:31:58.161538
current #epochs=20, #steps=760
start validation
acc: 0.829384
AUC: 0.929717
Avg Precision: 0.333398
Avg Recall: 1.000000
d_prime: 2.084112
train_loss: 0.026745
valid_loss: 1.002871
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0015918402951911994
Epoch-20 lr: 0.0015918402951911994
epoch 20 training time: 15.237
---------------
2023-09-11 18:32:13.398904
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03647	Per Sample Data Time 0.02834	Per Sample DNN Time 0.00813	Train Loss 0.0318	
start validation
acc: 0.829384
AUC: 0.938771
Avg Precision: 0.344400
Avg Recall: 1.000000
d_prime: 2.184311
train_loss: 0.026736
valid_loss: 0.970851
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0015918402951911994
Epoch-21 lr: 0.0015918402951911994
epoch 21 training time: 15.050
---------------
2023-09-11 18:32:28.448947
current #epochs=22, #steps=840
start validation
acc: 0.829384
AUC: 0.929095
Avg Precision: 0.338075
Avg Recall: 1.000000
d_prime: 2.077596
train_loss: 0.022429
valid_loss: 0.975741
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0015918402951911994
Epoch-22 lr: 0.0015918402951911994
epoch 22 training time: 15.592
---------------
2023-09-11 18:32:44.041199
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00566	Train Loss 0.0212	
start validation
acc: 0.824645
AUC: 0.919375
Avg Precision: 0.340077
Avg Recall: 1.000000
d_prime: 1.981140
train_loss: 0.029222
valid_loss: 1.004779
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0015918402951911994
Epoch-23 lr: 0.0015918402951911994
epoch 23 training time: 15.144
---------------
2023-09-11 18:32:59.185599
current #epochs=24, #steps=920
start validation
acc: 0.819905
AUC: 0.923377
Avg Precision: 0.334561
Avg Recall: 1.000000
d_prime: 2.019719
train_loss: 0.022180
valid_loss: 1.018619
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0015918402951911994
Epoch-24 lr: 0.0015918402951911994
epoch 24 training time: 15.178
---------------
2023-09-11 18:33:14.363517
current #epochs=25, #steps=960
start validation
acc: 0.829384
AUC: 0.930023
Avg Precision: 0.349228
Avg Recall: 1.000000
d_prime: 2.087324
train_loss: 0.026480
valid_loss: 0.998448
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0015918402951911994
Epoch-25 lr: 0.0015918402951911994
epoch 25 training time: 15.132
---------------
2023-09-11 18:33:29.495290
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03744	Per Sample Data Time 0.02795	Per Sample DNN Time 0.00949	Train Loss 0.0343	
start validation
acc: 0.829384
AUC: 0.924684
Avg Precision: 0.330981
Avg Recall: 1.000000
d_prime: 2.032654
train_loss: 0.021641
valid_loss: 1.000551
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0012731773117661276
Epoch-26 lr: 0.0012731773117661276
epoch 26 training time: 16.062
---------------
2023-09-11 18:33:45.557659
current #epochs=27, #steps=1040
start validation
acc: 0.824645
AUC: 0.922918
Avg Precision: 0.318291
Avg Recall: 1.000000
d_prime: 2.015224
train_loss: 0.019820
valid_loss: 1.021903
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0012731773117661276
Epoch-27 lr: 0.0012731773117661276
epoch 27 training time: 15.493
---------------
2023-09-11 18:34:01.050811
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00563	Train Loss 0.0224	
start validation
acc: 0.819905
AUC: 0.929724
Avg Precision: 0.356051
Avg Recall: 1.000000
d_prime: 2.084185
train_loss: 0.023281
valid_loss: 1.000030
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0012731773117661276
Epoch-28 lr: 0.0012731773117661276
epoch 28 training time: 15.139
---------------
2023-09-11 18:34:16.190304
current #epochs=29, #steps=1120
start validation
acc: 0.829384
AUC: 0.927866
Avg Precision: 0.363417
Avg Recall: 1.000000
d_prime: 2.064860
train_loss: 0.045544
valid_loss: 1.006979
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0012731773117661276
Epoch-29 lr: 0.0012731773117661276
epoch 29 training time: 15.126
---------------
2023-09-11 18:34:31.316240
current #epochs=30, #steps=1160
start validation
acc: 0.829384
AUC: 0.924599
Avg Precision: 0.340168
Avg Recall: 1.000000
d_prime: 2.031811
train_loss: 0.026069
valid_loss: 1.019794
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0012731773117661276
Epoch-30 lr: 0.0012731773117661276
epoch 30 training time: 16.052
---------------
2023-09-11 18:34:47.368840
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03778	Per Sample Data Time 0.02899	Per Sample DNN Time 0.00879	Train Loss 0.0803	
start validation
acc: 0.805687
AUC: 0.928918
Avg Precision: 0.339606
Avg Recall: 1.000000
d_prime: 2.075753
train_loss: 0.031536
valid_loss: 1.016391
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0012731773117661276
Epoch-31 lr: 0.0012731773117661276
epoch 31 training time: 15.191
---------------
2023-09-11 18:35:02.560057
current #epochs=32, #steps=1240
start validation
acc: 0.819905
AUC: 0.926877
Avg Precision: 0.338950
Avg Recall: 1.000000
d_prime: 2.054734
train_loss: 0.016132
valid_loss: 1.020374
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0012731773117661276
Epoch-32 lr: 0.0012731773117661276
epoch 32 training time: 15.275
---------------
2023-09-11 18:35:17.835048
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00562	Train Loss 0.0282	
start validation
acc: 0.819905
AUC: 0.928296
Avg Precision: 0.341511
Avg Recall: 1.000000
d_prime: 2.069301
train_loss: 0.030052
valid_loss: 1.006474
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0012731773117661276
Epoch-33 lr: 0.0012731773117661276
epoch 33 training time: 15.081
---------------
2023-09-11 18:35:32.915964
current #epochs=34, #steps=1320
start validation
acc: 0.834123
AUC: 0.931524
Avg Precision: 0.340275
Avg Recall: 1.000000
d_prime: 2.103267
train_loss: 0.017980
valid_loss: 1.006901
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0012731773117661276
Epoch-34 lr: 0.0012731773117661276
epoch 34 training time: 15.116
---------------
2023-09-11 18:35:48.031986
current #epochs=35, #steps=1360
start validation
acc: 0.829384
AUC: 0.933244
Avg Precision: 0.336543
Avg Recall: 1.000000
d_prime: 2.121881
train_loss: 0.020823
valid_loss: 0.995171
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0012731773117661276
Epoch-35 lr: 0.0012731773117661276
epoch 35 training time: 15.167
---------------
2023-09-11 18:36:03.199052
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03591	Per Sample Data Time 0.02784	Per Sample DNN Time 0.00807	Train Loss 0.0087	
start validation
acc: 0.848341
AUC: 0.936735
Avg Precision: 0.344563
Avg Recall: 1.000000
d_prime: 2.160821
train_loss: 0.017564
valid_loss: 0.981226
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.001018305964544844
Epoch-36 lr: 0.001018305964544844
epoch 36 training time: 15.128
---------------
2023-09-11 18:36:18.327247
current #epochs=37, #steps=1440
start validation
acc: 0.824645
AUC: 0.929069
Avg Precision: 0.328607
Avg Recall: 1.000000
d_prime: 2.077332
train_loss: 0.016280
valid_loss: 1.008663
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.001018305964544844
Epoch-37 lr: 0.001018305964544844
epoch 37 training time: 15.209
---------------
2023-09-11 18:36:33.536676
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00560	Train Loss 0.0230	
start validation
acc: 0.810427
AUC: 0.928318
Avg Precision: 0.330473
Avg Recall: 1.000000
d_prime: 2.069527
train_loss: 0.022162
valid_loss: 1.016130
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.001018305964544844
Epoch-38 lr: 0.001018305964544844
epoch 38 training time: 15.188
---------------
2023-09-11 18:36:48.724869
current #epochs=39, #steps=1520
start validation
acc: 0.819905
AUC: 0.927504
Avg Precision: 0.334774
Avg Recall: 1.000000
d_prime: 2.061146
train_loss: 0.014124
valid_loss: 1.011287
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.001018305964544844
Epoch-39 lr: 0.001018305964544844
epoch 39 training time: 15.096
---------------
2023-09-11 18:37:03.821193
current #epochs=40, #steps=1560
start validation
acc: 0.815166
AUC: 0.928477
Avg Precision: 0.351112
Avg Recall: 1.000000
d_prime: 2.071177
train_loss: 0.009749
valid_loss: 0.992433
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.001018305964544844
Epoch-40 lr: 0.001018305964544844
epoch 40 training time: 15.061
---------------
2023-09-11 18:37:18.882375
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03769	Per Sample Data Time 0.02696	Per Sample DNN Time 0.01073	Train Loss 0.0007	
start validation
acc: 0.838863
AUC: 0.927633
Avg Precision: 0.345619
Avg Recall: 1.000000
d_prime: 2.062468
train_loss: 0.015125
valid_loss: 0.997668
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.001018305964544844
Epoch-41 lr: 0.001018305964544844
epoch 41 training time: 15.129
---------------
2023-09-11 18:37:34.012114
current #epochs=42, #steps=1640
start validation
acc: 0.829384
AUC: 0.926976
Avg Precision: 0.345100
Avg Recall: 1.000000
d_prime: 2.055746
train_loss: 0.022711
valid_loss: 1.000815
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.001018305964544844
Epoch-42 lr: 0.001018305964544844
epoch 42 training time: 15.118
---------------
2023-09-11 18:37:49.129973
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00567	Train Loss 0.0140	
start validation
acc: 0.815166
AUC: 0.929606
Avg Precision: 0.314020
Avg Recall: 1.000000
d_prime: 2.082945
train_loss: 0.015841
valid_loss: 0.981041
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.001018305964544844
Epoch-43 lr: 0.001018305964544844
epoch 43 training time: 15.130
---------------
2023-09-11 18:38:04.260502
current #epochs=44, #steps=1720
start validation
acc: 0.796209
AUC: 0.925944
Avg Precision: 0.339397
Avg Recall: 1.000000
d_prime: 2.045279
train_loss: 0.022554
valid_loss: 1.000717
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.001018305964544844
Epoch-44 lr: 0.001018305964544844
epoch 44 training time: 15.109
---------------
2023-09-11 18:38:19.369589
current #epochs=45, #steps=1760
start validation
acc: 0.829384
AUC: 0.933365
Avg Precision: 0.345453
Avg Recall: 1.000000
d_prime: 2.123203
train_loss: 0.023142
valid_loss: 0.996151
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.001018305964544844
Epoch-45 lr: 0.001018305964544844
epoch 45 training time: 15.292
---------------
2023-09-11 18:38:34.662102
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03678	Per Sample Data Time 0.02909	Per Sample DNN Time 0.00770	Train Loss 0.0078	
start validation
[I 2023-09-11 18:38:49,824] Trial 71 finished with value: 0.8483412322274881 and parameters: {'warmup': 'False', 'num_epochs': 46, 'batch_size': 56, 'lr-adaptschedule': 'True', 'lr': 0.0024884029099515458, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.7998147274021629}. Best is trial 50 with value: 0.8815165876777251.
acc: 0.824645
AUC: 0.931666
Avg Precision: 0.343973
Avg Recall: 1.000000
d_prime: 2.104790
train_loss: 0.030251
valid_loss: 1.002591
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.0008144561074444308
Epoch-46 lr: 0.0008144561074444308
epoch 46 training time: 15.149
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863efaa7f0>
The learning rate scheduler starts at 7 epoch with decay rate of 0.809 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 18:38:49.863687
current #epochs=1, #steps=0
start validation
acc: 0.819905
AUC: 0.943041
Avg Precision: 0.351105
Avg Recall: 1.000000
d_prime: 2.235620
train_loss: 0.037361
valid_loss: 0.994134
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.001960640960624206
Epoch-1 lr: 0.001960640960624206
epoch 1 training time: 18.378
---------------
2023-09-11 18:39:08.241951
current #epochs=2, #steps=40
start validation
acc: 0.805687
AUC: 0.937955
Avg Precision: 0.350979
Avg Recall: 1.000000
d_prime: 2.174821
train_loss: 0.043985
valid_loss: 0.982758
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.001960640960624206
Epoch-2 lr: 0.001960640960624206
epoch 2 training time: 15.198
---------------
2023-09-11 18:39:23.440578
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00559	Train Loss 0.0182	
start validation
acc: 0.829384
AUC: 0.940165
Avg Precision: 0.379497
Avg Recall: 1.000000
d_prime: 2.200741
train_loss: 0.021358
valid_loss: 1.015089
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.001960640960624206
Epoch-3 lr: 0.001960640960624206
epoch 3 training time: 18.021
---------------
2023-09-11 18:39:41.461567
current #epochs=4, #steps=120
start validation
acc: 0.838863
AUC: 0.933582
Avg Precision: 0.384806
Avg Recall: 1.000000
d_prime: 2.125579
train_loss: 0.026280
valid_loss: 1.011919
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.001960640960624206
Epoch-4 lr: 0.001960640960624206
epoch 4 training time: 17.541
---------------
2023-09-11 18:39:59.002592
current #epochs=5, #steps=160
start validation
acc: 0.838863
AUC: 0.941091
Avg Precision: 0.391620
Avg Recall: 1.000000
d_prime: 2.211826
train_loss: 0.020703
valid_loss: 1.002433
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.001960640960624206
Epoch-5 lr: 0.001960640960624206
epoch 5 training time: 16.080
---------------
2023-09-11 18:40:15.082480
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03667	Per Sample Data Time 0.02842	Per Sample DNN Time 0.00825	Train Loss 0.1577	
start validation
acc: 0.838863
AUC: 0.941711
Avg Precision: 0.358229
Avg Recall: 1.000000
d_prime: 2.219322
train_loss: 0.027985
valid_loss: 1.003281
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.001960640960624206
Epoch-6 lr: 0.001960640960624206
epoch 6 training time: 15.910
---------------
2023-09-11 18:40:30.992629
current #epochs=7, #steps=240
start validation
acc: 0.848341
AUC: 0.944616
Avg Precision: 0.367278
Avg Recall: 1.000000
d_prime: 2.255317
train_loss: 0.025722
valid_loss: 1.013255
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0015863056366490654
Epoch-7 lr: 0.0015863056366490654
epoch 7 training time: 17.277
---------------
2023-09-11 18:40:48.269712
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00728	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00573	Train Loss 0.0299	
start validation
acc: 0.843602
AUC: 0.947667
Avg Precision: 0.368289
Avg Recall: 1.000000
d_prime: 2.294767
train_loss: 0.024249
valid_loss: 0.997103
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0015863056366490654
Epoch-8 lr: 0.0015863056366490654
epoch 8 training time: 15.358
---------------
2023-09-11 18:41:03.627605
current #epochs=9, #steps=320
start validation
acc: 0.829384
AUC: 0.942852
Avg Precision: 0.367893
Avg Recall: 1.000000
d_prime: 2.233295
train_loss: 0.023821
valid_loss: 1.013439
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0015863056366490654
Epoch-9 lr: 0.0015863056366490654
epoch 9 training time: 15.080
---------------
2023-09-11 18:41:18.707744
current #epochs=10, #steps=360
start validation
acc: 0.824645
AUC: 0.933107
Avg Precision: 0.388268
Avg Recall: 1.000000
d_prime: 2.120380
train_loss: 0.028911
valid_loss: 1.018617
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0015863056366490654
Epoch-10 lr: 0.0015863056366490654
epoch 10 training time: 16.279
---------------
2023-09-11 18:41:34.987012
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03931	Per Sample Data Time 0.02804	Per Sample DNN Time 0.01127	Train Loss 0.0015	
start validation
acc: 0.834123
AUC: 0.935511
Avg Precision: 0.373606
Avg Recall: 1.000000
d_prime: 2.146976
train_loss: 0.019832
valid_loss: 1.015002
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0015863056366490654
Epoch-11 lr: 0.0015863056366490654
epoch 11 training time: 15.189
---------------
2023-09-11 18:41:50.176029
current #epochs=12, #steps=440
start validation
acc: 0.843602
AUC: 0.921796
Avg Precision: 0.346523
Avg Recall: 1.000000
d_prime: 2.004305
train_loss: 0.033715
valid_loss: 1.022463
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0015863056366490654
Epoch-12 lr: 0.0015863056366490654
epoch 12 training time: 16.259
---------------
2023-09-11 18:42:06.434932
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00560	Train Loss 0.0398	
start validation
acc: 0.819905
AUC: 0.925769
Avg Precision: 0.321770
Avg Recall: 1.000000
d_prime: 2.043520
train_loss: 0.028999
valid_loss: 1.012607
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0015863056366490654
Epoch-13 lr: 0.0015863056366490654
epoch 13 training time: 14.990
---------------
2023-09-11 18:42:21.424585
current #epochs=14, #steps=520
start validation
acc: 0.834123
AUC: 0.928144
Avg Precision: 0.345440
Avg Recall: 1.000000
d_prime: 2.067731
train_loss: 0.027665
valid_loss: 1.022640
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0015863056366490654
Epoch-14 lr: 0.0015863056366490654
epoch 14 training time: 15.225
---------------
2023-09-11 18:42:36.649668
current #epochs=15, #steps=560
start validation
acc: 0.838863
AUC: 0.927166
Avg Precision: 0.345135
Avg Recall: 1.000000
d_prime: 2.057684
train_loss: 0.028219
valid_loss: 1.012558
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0015863056366490654
Epoch-15 lr: 0.0015863056366490654
epoch 15 training time: 15.226
---------------
2023-09-11 18:42:51.875692
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03678	Per Sample Data Time 0.02858	Per Sample DNN Time 0.00820	Train Loss 0.0588	
start validation
acc: 0.824645
AUC: 0.937515
Avg Precision: 0.363506
Avg Recall: 1.000000
d_prime: 2.169742
train_loss: 0.025926
valid_loss: 0.993123
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0015863056366490654
Epoch-16 lr: 0.0015863056366490654
epoch 16 training time: 15.692
---------------
2023-09-11 18:43:07.568164
current #epochs=17, #steps=640
start validation
acc: 0.829384
AUC: 0.938904
Avg Precision: 0.374786
Avg Recall: 1.000000
d_prime: 2.185865
train_loss: 0.014219
valid_loss: 1.008768
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0012834402745842183
Epoch-17 lr: 0.0012834402745842183
epoch 17 training time: 15.249
---------------
2023-09-11 18:43:22.817450
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00141	Per Sample DNN Time 0.00567	Train Loss 0.0320	
start validation
acc: 0.848341
AUC: 0.935079
Avg Precision: 0.332135
Avg Recall: 1.000000
d_prime: 2.142145
train_loss: 0.026964
valid_loss: 0.995195
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0012834402745842183
Epoch-18 lr: 0.0012834402745842183
epoch 18 training time: 19.164
---------------
2023-09-11 18:43:41.981804
current #epochs=19, #steps=720
start validation
acc: 0.824645
AUC: 0.925172
Avg Precision: 0.340938
Avg Recall: 1.000000
d_prime: 2.037526
train_loss: 0.025313
valid_loss: 1.023326
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0012834402745842183
Epoch-19 lr: 0.0012834402745842183
epoch 19 training time: 15.856
---------------
2023-09-11 18:43:57.837966
current #epochs=20, #steps=760
start validation
acc: 0.834123
AUC: 0.929663
Avg Precision: 0.340777
Avg Recall: 1.000000
d_prime: 2.083536
train_loss: 0.021774
valid_loss: 1.005411
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0012834402745842183
Epoch-20 lr: 0.0012834402745842183
epoch 20 training time: 16.176
---------------
2023-09-11 18:44:14.014067
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03629	Per Sample Data Time 0.02903	Per Sample DNN Time 0.00726	Train Loss 0.0254	
start validation
acc: 0.848341
AUC: 0.931148
Avg Precision: 0.350389
Avg Recall: 1.000000
d_prime: 2.099249
train_loss: 0.024406
valid_loss: 1.011693
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0012834402745842183
Epoch-21 lr: 0.0012834402745842183
epoch 21 training time: 17.650
---------------
2023-09-11 18:44:31.664666
current #epochs=22, #steps=840
start validation
acc: 0.838863
AUC: 0.934764
Avg Precision: 0.351545
Avg Recall: 1.000000
d_prime: 2.138637
train_loss: 0.020454
valid_loss: 1.002337
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0012834402745842183
Epoch-22 lr: 0.0012834402745842183
epoch 22 training time: 15.193
---------------
2023-09-11 18:44:46.857280
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00570	Train Loss 0.0190	
start validation
acc: 0.848341
AUC: 0.939853
Avg Precision: 0.363459
Avg Recall: 1.000000
d_prime: 2.197036
train_loss: 0.017913
valid_loss: 0.966725
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0012834402745842183
Epoch-23 lr: 0.0012834402745842183
epoch 23 training time: 15.112
---------------
2023-09-11 18:45:01.969012
current #epochs=24, #steps=920
start validation
acc: 0.848341
AUC: 0.937298
Avg Precision: 0.351561
Avg Recall: 1.000000
d_prime: 2.167250
train_loss: 0.015110
valid_loss: 0.992409
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0012834402745842183
Epoch-24 lr: 0.0012834402745842183
epoch 24 training time: 16.674
---------------
2023-09-11 18:45:18.642873
current #epochs=25, #steps=960
start validation
acc: 0.838863
AUC: 0.936616
Avg Precision: 0.352686
Avg Recall: 1.000000
d_prime: 2.159463
train_loss: 0.024302
valid_loss: 0.985857
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0012834402745842183
Epoch-25 lr: 0.0012834402745842183
epoch 25 training time: 15.191
---------------
2023-09-11 18:45:33.833878
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03744	Per Sample Data Time 0.02793	Per Sample DNN Time 0.00952	Train Loss 0.0073	
start validation
acc: 0.843602
AUC: 0.935243
Avg Precision: 0.344644
Avg Recall: 1.000000
d_prime: 2.143980
train_loss: 0.027177
valid_loss: 0.973985
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0012834402745842183
Epoch-26 lr: 0.0012834402745842183
epoch 26 training time: 15.065
---------------
2023-09-11 18:45:48.899428
current #epochs=27, #steps=1040
start validation
acc: 0.838863
AUC: 0.928104
Avg Precision: 0.349748
Avg Recall: 1.000000
d_prime: 2.067318
train_loss: 0.020963
valid_loss: 1.006204
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0010383994738267603
Epoch-27 lr: 0.0010383994738267603
epoch 27 training time: 15.066
---------------
2023-09-11 18:46:03.965510
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00565	Train Loss 0.0253	
start validation
acc: 0.838863
AUC: 0.924271
Avg Precision: 0.371727
Avg Recall: 1.000000
d_prime: 2.028552
train_loss: 0.022404
valid_loss: 1.021978
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0010383994738267603
Epoch-28 lr: 0.0010383994738267603
epoch 28 training time: 15.067
---------------
2023-09-11 18:46:19.032034
current #epochs=29, #steps=1120
start validation
acc: 0.829384
AUC: 0.936145
Avg Precision: 0.360982
Avg Recall: 1.000000
d_prime: 2.154127
train_loss: 0.015395
valid_loss: 1.007130
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0010383994738267603
Epoch-29 lr: 0.0010383994738267603
epoch 29 training time: 15.385
---------------
2023-09-11 18:46:34.417052
current #epochs=30, #steps=1160
start validation
acc: 0.853081
AUC: 0.934668
Avg Precision: 0.373690
Avg Recall: 1.000000
d_prime: 2.137564
train_loss: 0.022590
valid_loss: 1.006928
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0010383994738267603
Epoch-30 lr: 0.0010383994738267603
epoch 30 training time: 17.853
---------------
2023-09-11 18:46:52.270239
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03821	Per Sample Data Time 0.02911	Per Sample DNN Time 0.00910	Train Loss 0.0079	
start validation
acc: 0.857820
AUC: 0.937393
Avg Precision: 0.358060
Avg Recall: 1.000000
d_prime: 2.168343
train_loss: 0.018151
valid_loss: 0.998395
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0010383994738267603
Epoch-31 lr: 0.0010383994738267603
epoch 31 training time: 17.938
---------------
2023-09-11 18:47:10.208299
current #epochs=32, #steps=1240
start validation
acc: 0.862559
AUC: 0.942030
Avg Precision: 0.369559
Avg Recall: 1.000000
d_prime: 2.223207
train_loss: 0.021283
valid_loss: 0.965901
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0010383994738267603
Epoch-32 lr: 0.0010383994738267603
epoch 32 training time: 17.440
---------------
2023-09-11 18:47:27.648760
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00727	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00574	Train Loss 0.0142	
start validation
acc: 0.862559
AUC: 0.941225
Avg Precision: 0.374685
Avg Recall: 1.000000
d_prime: 2.213444
train_loss: 0.015210
valid_loss: 0.969667
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0010383994738267603
Epoch-33 lr: 0.0010383994738267603
epoch 33 training time: 15.190
---------------
2023-09-11 18:47:42.838159
current #epochs=34, #steps=1320
start validation
acc: 0.834123
AUC: 0.934882
Avg Precision: 0.373609
Avg Recall: 1.000000
d_prime: 2.139949
train_loss: 0.019908
valid_loss: 0.983287
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0010383994738267603
Epoch-34 lr: 0.0010383994738267603
epoch 34 training time: 15.005
---------------
2023-09-11 18:47:57.843652
current #epochs=35, #steps=1360
start validation
acc: 0.838863
AUC: 0.930773
Avg Precision: 0.361066
Avg Recall: 1.000000
d_prime: 2.095258
train_loss: 0.018069
valid_loss: 0.992282
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0010383994738267603
Epoch-35 lr: 0.0010383994738267603
epoch 35 training time: 15.145
---------------
2023-09-11 18:48:12.988642
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03792	Per Sample Data Time 0.02874	Per Sample DNN Time 0.00918	Train Loss 0.0067	
start validation
acc: 0.843602
AUC: 0.930043
Avg Precision: 0.349588
Avg Recall: 1.000000
d_prime: 2.087539
train_loss: 0.028225
valid_loss: 1.012025
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0010383994738267603
Epoch-36 lr: 0.0010383994738267603
epoch 36 training time: 15.111
---------------
2023-09-11 18:48:28.099778
current #epochs=37, #steps=1440
start validation
acc: 0.848341
AUC: 0.930312
Avg Precision: 0.356554
Avg Recall: 1.000000
d_prime: 2.090381
train_loss: 0.025519
valid_loss: 1.005417
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0008401430815259471
Epoch-37 lr: 0.0008401430815259471
epoch 37 training time: 15.189
---------------
2023-09-11 18:48:43.289352
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00566	Train Loss 0.0116	
start validation
acc: 0.834123
AUC: 0.931197
Avg Precision: 0.367604
Avg Recall: 1.000000
d_prime: 2.099771
train_loss: 0.015585
valid_loss: 1.005327
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0008401430815259471
Epoch-38 lr: 0.0008401430815259471
epoch 38 training time: 15.071
---------------
2023-09-11 18:48:58.360551
current #epochs=39, #steps=1520
start validation
acc: 0.815166
AUC: 0.931901
Avg Precision: 0.369226
Avg Recall: 1.000000
d_prime: 2.107318
train_loss: 0.024446
valid_loss: 1.014216
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0008401430815259471
Epoch-39 lr: 0.0008401430815259471
epoch 39 training time: 15.152
---------------
2023-09-11 18:49:13.512211
current #epochs=40, #steps=1560
start validation
acc: 0.815166
AUC: 0.932315
Avg Precision: 0.376385
Avg Recall: 1.000000
d_prime: 2.111785
train_loss: 0.020150
valid_loss: 1.008631
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0008401430815259471
Epoch-40 lr: 0.0008401430815259471
epoch 40 training time: 15.241
---------------
2023-09-11 18:49:28.753411
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03632	Per Sample Data Time 0.02812	Per Sample DNN Time 0.00820	Train Loss 0.0152	
start validation
acc: 0.829384
AUC: 0.933639
Avg Precision: 0.371176
Avg Recall: 1.000000
d_prime: 2.126201
train_loss: 0.018704
valid_loss: 0.981444
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0008401430815259471
Epoch-41 lr: 0.0008401430815259471
epoch 41 training time: 15.140
---------------
2023-09-11 18:49:43.893529
current #epochs=42, #steps=1640
start validation
acc: 0.853081
AUC: 0.931065
Avg Precision: 0.367379
Avg Recall: 1.000000
d_prime: 2.098365
train_loss: 0.022904
valid_loss: 0.997118
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0008401430815259471
Epoch-42 lr: 0.0008401430815259471
epoch 42 training time: 15.239
---------------
2023-09-11 18:49:59.132428
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00562	Train Loss 0.0167	
start validation
acc: 0.819905
AUC: 0.928064
Avg Precision: 0.364955
Avg Recall: 1.000000
d_prime: 2.066908
train_loss: 0.019701
valid_loss: 0.997372
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0008401430815259471
Epoch-43 lr: 0.0008401430815259471
epoch 43 training time: 15.155
---------------
2023-09-11 18:50:14.287668
current #epochs=44, #steps=1720
start validation
acc: 0.824645
AUC: 0.926059
Avg Precision: 0.381122
Avg Recall: 1.000000
d_prime: 2.046440
train_loss: 0.024129
valid_loss: 1.005146
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0008401430815259471
Epoch-44 lr: 0.0008401430815259471
epoch 44 training time: 16.281
---------------
2023-09-11 18:50:30.568488
current #epochs=45, #steps=1760
start validation
acc: 0.810427
AUC: 0.931062
Avg Precision: 0.379586
Avg Recall: 1.000000
d_prime: 2.098333
train_loss: 0.017714
valid_loss: 1.017147
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0008401430815259471
Epoch-45 lr: 0.0008401430815259471
epoch 45 training time: 15.051
---------------
2023-09-11 18:50:45.619371
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03622	Per Sample Data Time 0.02762	Per Sample DNN Time 0.00860	Train Loss 0.0027	
start validation
acc: 0.853081
AUC: 0.936443
Avg Precision: 0.362545
Avg Recall: 1.000000
d_prime: 2.157498
train_loss: 0.013775
valid_loss: 1.011183
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.0008401430815259471
Epoch-46 lr: 0.0008401430815259471
epoch 46 training time: 16.455
---------------
2023-09-11 18:51:02.074746
current #epochs=47, #steps=1840
start validation
acc: 0.848341
AUC: 0.940305
Avg Precision: 0.367582
Avg Recall: 1.000000
d_prime: 2.202404
train_loss: 0.015379
valid_loss: 1.008299
validation finished
normal learning rate scheduler step
Epoch-47 lr: 0.0006797387857244542
Epoch-47 lr: 0.0006797387857244542
epoch 47 training time: 16.608
---------------
2023-09-11 18:51:18.682527
current #epochs=48, #steps=1880
Epoch: [48][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00567	Train Loss 0.0090	
start validation
[I 2023-09-11 18:51:33,828] Trial 72 finished with value: 0.8625592417061612 and parameters: {'warmup': 'False', 'num_epochs': 48, 'batch_size': 44, 'lr-adaptschedule': 'True', 'lr': 0.001960640960624206, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.8090750262322561}. Best is trial 50 with value: 0.8815165876777251.
acc: 0.838863
AUC: 0.940221
Avg Precision: 0.372163
Avg Recall: 1.000000
d_prime: 2.201413
train_loss: 0.010074
valid_loss: 1.009908
validation finished
normal learning rate scheduler step
Epoch-48 lr: 0.0006797387857244542
Epoch-48 lr: 0.0006797387857244542
epoch 48 training time: 15.131
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f8667062ca0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.844 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 18:51:33.867693
current #epochs=1, #steps=0
start validation
acc: 0.829384
AUC: 0.910192
Avg Precision: 0.316459
Avg Recall: 1.000000
d_prime: 1.897791
train_loss: 0.027424
valid_loss: 1.038064
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0021404635588375834
Epoch-1 lr: 0.0021404635588375834
epoch 1 training time: 17.259
---------------
2023-09-11 18:51:51.127480
current #epochs=2, #steps=40
start validation
acc: 0.853081
AUC: 0.935043
Avg Precision: 0.355747
Avg Recall: 1.000000
d_prime: 2.141748
train_loss: 0.035445
valid_loss: 0.978735
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0021404635588375834
Epoch-2 lr: 0.0021404635588375834
epoch 2 training time: 17.090
---------------
2023-09-11 18:52:08.217264
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00727	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00575	Train Loss 0.0435	
start validation
acc: 0.848341
AUC: 0.928599
Avg Precision: 0.372476
Avg Recall: 1.000000
d_prime: 2.072437
train_loss: 0.039074
valid_loss: 0.999695
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0021404635588375834
Epoch-3 lr: 0.0021404635588375834
epoch 3 training time: 15.247
---------------
2023-09-11 18:52:23.464640
current #epochs=4, #steps=120
start validation
acc: 0.824645
AUC: 0.917494
Avg Precision: 0.327291
Avg Recall: 1.000000
d_prime: 1.963508
train_loss: 0.062067
valid_loss: 1.035563
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0021404635588375834
Epoch-4 lr: 0.0021404635588375834
epoch 4 training time: 15.185
---------------
2023-09-11 18:52:38.650185
current #epochs=5, #steps=160
start validation
acc: 0.843602
AUC: 0.942771
Avg Precision: 0.374276
Avg Recall: 1.000000
d_prime: 2.232286
train_loss: 0.031830
valid_loss: 0.996687
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0021404635588375834
Epoch-5 lr: 0.0021404635588375834
epoch 5 training time: 16.333
---------------
2023-09-11 18:52:54.983556
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03749	Per Sample Data Time 0.02879	Per Sample DNN Time 0.00870	Train Loss 0.0130	
start validation
acc: 0.824645
AUC: 0.929005
Avg Precision: 0.364216
Avg Recall: 1.000000
d_prime: 2.076662
train_loss: 0.042312
valid_loss: 1.033752
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0018074048723671493
Epoch-6 lr: 0.0018074048723671493
epoch 6 training time: 15.195
---------------
2023-09-11 18:53:10.178582
current #epochs=7, #steps=240
start validation
acc: 0.848341
AUC: 0.927961
Avg Precision: 0.344608
Avg Recall: 1.000000
d_prime: 2.065839
train_loss: 0.040143
valid_loss: 1.029645
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0018074048723671493
Epoch-7 lr: 0.0018074048723671493
epoch 7 training time: 15.697
---------------
2023-09-11 18:53:25.875775
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00566	Train Loss 0.0336	
start validation
acc: 0.843602
AUC: 0.937583
Avg Precision: 0.404376
Avg Recall: 1.000000
d_prime: 2.170525
train_loss: 0.029722
valid_loss: 1.036310
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0018074048723671493
Epoch-8 lr: 0.0018074048723671493
epoch 8 training time: 15.208
---------------
2023-09-11 18:53:41.083442
current #epochs=9, #steps=320
start validation
acc: 0.843602
AUC: 0.940545
Avg Precision: 0.395317
Avg Recall: 1.000000
d_prime: 2.205270
train_loss: 0.022821
valid_loss: 1.001022
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0018074048723671493
Epoch-9 lr: 0.0018074048723671493
epoch 9 training time: 15.078
---------------
2023-09-11 18:53:56.161650
current #epochs=10, #steps=360
start validation
acc: 0.829384
AUC: 0.935483
Avg Precision: 0.376742
Avg Recall: 1.000000
d_prime: 2.146665
train_loss: 0.019142
valid_loss: 1.020080
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0018074048723671493
Epoch-10 lr: 0.0018074048723671493
epoch 10 training time: 15.112
---------------
2023-09-11 18:54:11.273943
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03851	Per Sample Data Time 0.02802	Per Sample DNN Time 0.01048	Train Loss 0.0112	
start validation
acc: 0.815166
AUC: 0.937795
Avg Precision: 0.370464
Avg Recall: 1.000000
d_prime: 2.172973
train_loss: 0.029821
valid_loss: 1.011009
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0018074048723671493
Epoch-11 lr: 0.0018074048723671493
epoch 11 training time: 15.125
---------------
2023-09-11 18:54:26.398361
current #epochs=12, #steps=440
start validation
acc: 0.829384
AUC: 0.936454
Avg Precision: 0.368454
Avg Recall: 1.000000
d_prime: 2.157628
train_loss: 0.022324
valid_loss: 1.005266
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0018074048723671493
Epoch-12 lr: 0.0018074048723671493
epoch 12 training time: 15.195
---------------
2023-09-11 18:54:41.593214
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00562	Train Loss 0.0187	
start validation
acc: 0.819905
AUC: 0.931998
Avg Precision: 0.359780
Avg Recall: 1.000000
d_prime: 2.108367
train_loss: 0.021742
valid_loss: 1.025548
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0018074048723671493
Epoch-13 lr: 0.0018074048723671493
epoch 13 training time: 15.165
---------------
2023-09-11 18:54:56.758424
current #epochs=14, #steps=520
start validation
acc: 0.834123
AUC: 0.930207
Avg Precision: 0.381026
Avg Recall: 1.000000
d_prime: 2.089268
train_loss: 0.024082
valid_loss: 1.014075
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0018074048723671493
Epoch-14 lr: 0.0018074048723671493
epoch 14 training time: 15.226
---------------
2023-09-11 18:55:11.984631
current #epochs=15, #steps=560
start validation
acc: 0.805687
AUC: 0.925100
Avg Precision: 0.362467
Avg Recall: 1.000000
d_prime: 2.036801
train_loss: 0.024631
valid_loss: 1.005674
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0018074048723671493
Epoch-15 lr: 0.0018074048723671493
epoch 15 training time: 15.167
---------------
2023-09-11 18:55:27.151270
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03660	Per Sample Data Time 0.02853	Per Sample DNN Time 0.00806	Train Loss 0.0076	
start validation
acc: 0.824645
AUC: 0.924459
Avg Precision: 0.353639
Avg Recall: 1.000000
d_prime: 2.030415
train_loss: 0.021700
valid_loss: 1.029853
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0015261705153394704
Epoch-16 lr: 0.0015261705153394704
epoch 16 training time: 15.719
---------------
2023-09-11 18:55:42.870701
current #epochs=17, #steps=640
start validation
acc: 0.848341
AUC: 0.933753
Avg Precision: 0.364179
Avg Recall: 1.000000
d_prime: 2.127454
train_loss: 0.024891
valid_loss: 1.018827
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0015261705153394704
Epoch-17 lr: 0.0015261705153394704
epoch 17 training time: 15.251
---------------
2023-09-11 18:55:58.121724
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00562	Train Loss 0.0138	
start validation
acc: 0.824645
AUC: 0.937458
Avg Precision: 0.359741
Avg Recall: 1.000000
d_prime: 2.169087
train_loss: 0.019382
valid_loss: 1.039405
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0015261705153394704
Epoch-18 lr: 0.0015261705153394704
epoch 18 training time: 15.094
---------------
2023-09-11 18:56:13.216027
current #epochs=19, #steps=720
start validation
acc: 0.815166
AUC: 0.933335
Avg Precision: 0.358156
Avg Recall: 1.000000
d_prime: 2.122869
train_loss: 0.034880
valid_loss: 1.017293
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0015261705153394704
Epoch-19 lr: 0.0015261705153394704
epoch 19 training time: 16.253
---------------
2023-09-11 18:56:29.468648
current #epochs=20, #steps=760
start validation
acc: 0.843602
AUC: 0.925779
Avg Precision: 0.352012
Avg Recall: 1.000000
d_prime: 2.043621
train_loss: 0.024336
valid_loss: 0.996861
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0015261705153394704
Epoch-20 lr: 0.0015261705153394704
epoch 20 training time: 17.645
---------------
2023-09-11 18:56:47.113167
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03601	Per Sample Data Time 0.02849	Per Sample DNN Time 0.00752	Train Loss 0.0434	
start validation
acc: 0.829384
AUC: 0.928252
Avg Precision: 0.328236
Avg Recall: 1.000000
d_prime: 2.068848
train_loss: 0.022798
valid_loss: 0.991804
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0015261705153394704
Epoch-21 lr: 0.0015261705153394704
epoch 21 training time: 15.101
---------------
2023-09-11 18:57:02.214043
current #epochs=22, #steps=840
start validation
acc: 0.824645
AUC: 0.929254
Avg Precision: 0.331416
Avg Recall: 1.000000
d_prime: 2.079261
train_loss: 0.024995
valid_loss: 0.995407
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0015261705153394704
Epoch-22 lr: 0.0015261705153394704
epoch 22 training time: 15.071
---------------
2023-09-11 18:57:17.284927
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00569	Train Loss 0.0235	
start validation
acc: 0.834123
AUC: 0.936509
Avg Precision: 0.366179
Avg Recall: 1.000000
d_prime: 2.158247
train_loss: 0.024025
valid_loss: 1.008127
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0015261705153394704
Epoch-23 lr: 0.0015261705153394704
epoch 23 training time: 16.838
---------------
2023-09-11 18:57:34.122823
current #epochs=24, #steps=920
start validation
acc: 0.834123
AUC: 0.938270
Avg Precision: 0.360232
Avg Recall: 1.000000
d_prime: 2.178472
train_loss: 0.025554
valid_loss: 0.982474
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0015261705153394704
Epoch-24 lr: 0.0015261705153394704
epoch 24 training time: 16.218
---------------
2023-09-11 18:57:50.340789
current #epochs=25, #steps=960
start validation
acc: 0.838863
AUC: 0.935927
Avg Precision: 0.352003
Avg Recall: 1.000000
d_prime: 2.151660
train_loss: 0.033556
valid_loss: 1.005062
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0015261705153394704
Epoch-25 lr: 0.0015261705153394704
epoch 25 training time: 15.067
---------------
2023-09-11 18:58:05.407548
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03904	Per Sample Data Time 0.02818	Per Sample DNN Time 0.01086	Train Loss 0.0009	
start validation
acc: 0.824645
AUC: 0.936212
Avg Precision: 0.341139
Avg Recall: 1.000000
d_prime: 2.154881
train_loss: 0.022373
valid_loss: 0.967451
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0012886965601907488
Epoch-26 lr: 0.0012886965601907488
epoch 26 training time: 15.540
---------------
2023-09-11 18:58:20.947115
current #epochs=27, #steps=1040
start validation
acc: 0.805687
AUC: 0.938746
Avg Precision: 0.366677
Avg Recall: 1.000000
d_prime: 2.184014
train_loss: 0.024915
valid_loss: 0.995832
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0012886965601907488
Epoch-27 lr: 0.0012886965601907488
epoch 27 training time: 15.871
---------------
2023-09-11 18:58:36.818300
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00564	Train Loss 0.0191	
start validation
acc: 0.815166
AUC: 0.936805
Avg Precision: 0.327473
Avg Recall: 1.000000
d_prime: 2.161614
train_loss: 0.020349
valid_loss: 0.985339
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0012886965601907488
Epoch-28 lr: 0.0012886965601907488
epoch 28 training time: 15.075
---------------
2023-09-11 18:58:51.892882
current #epochs=29, #steps=1120
start validation
acc: 0.834123
AUC: 0.931561
Avg Precision: 0.342453
Avg Recall: 1.000000
d_prime: 2.103667
train_loss: 0.013303
valid_loss: 1.004952
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0012886965601907488
Epoch-29 lr: 0.0012886965601907488
epoch 29 training time: 16.291
---------------
2023-09-11 18:59:08.184395
current #epochs=30, #steps=1160
start validation
acc: 0.824645
AUC: 0.922812
Avg Precision: 0.333181
Avg Recall: 1.000000
d_prime: 2.014186
train_loss: 0.027445
valid_loss: 1.007153
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0012886965601907488
Epoch-30 lr: 0.0012886965601907488
epoch 30 training time: 15.253
---------------
2023-09-11 18:59:23.437518
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03638	Per Sample Data Time 0.02879	Per Sample DNN Time 0.00759	Train Loss 0.0040	
start validation
acc: 0.815166
AUC: 0.932070
Avg Precision: 0.331073
Avg Recall: 1.000000
d_prime: 2.109143
train_loss: 0.029964
valid_loss: 1.000162
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0012886965601907488
Epoch-31 lr: 0.0012886965601907488
epoch 31 training time: 15.173
---------------
2023-09-11 18:59:38.610460
current #epochs=32, #steps=1240
start validation
acc: 0.848341
AUC: 0.930352
Avg Precision: 0.336651
Avg Recall: 1.000000
d_prime: 2.090802
train_loss: 0.031627
valid_loss: 0.984613
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0012886965601907488
Epoch-32 lr: 0.0012886965601907488
epoch 32 training time: 15.151
---------------
2023-09-11 18:59:53.761507
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00567	Train Loss 0.0249	
start validation
acc: 0.829384
AUC: 0.930822
Avg Precision: 0.352086
Avg Recall: 1.000000
d_prime: 2.095778
train_loss: 0.023050
valid_loss: 0.975570
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0012886965601907488
Epoch-33 lr: 0.0012886965601907488
epoch 33 training time: 15.060
---------------
2023-09-11 19:00:08.821009
current #epochs=34, #steps=1320
start validation
acc: 0.815166
AUC: 0.934898
Avg Precision: 0.327533
Avg Recall: 1.000000
d_prime: 2.140130
train_loss: 0.021786
valid_loss: 0.985903
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0012886965601907488
Epoch-34 lr: 0.0012886965601907488
epoch 34 training time: 15.387
---------------
2023-09-11 19:00:24.207724
current #epochs=35, #steps=1360
start validation
acc: 0.810427
AUC: 0.931495
Avg Precision: 0.333870
Avg Recall: 1.000000
d_prime: 2.102960
train_loss: 0.025840
valid_loss: 0.993376
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0012886965601907488
Epoch-35 lr: 0.0012886965601907488
epoch 35 training time: 15.102
---------------
2023-09-11 19:00:39.310566
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03525	Per Sample Data Time 0.02795	Per Sample DNN Time 0.00730	Train Loss 0.0349	
start validation
acc: 0.829384
AUC: 0.930068
Avg Precision: 0.331543
Avg Recall: 1.000000
d_prime: 2.087797
train_loss: 0.017805
valid_loss: 0.996597
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0010881738361182174
Epoch-36 lr: 0.0010881738361182174
epoch 36 training time: 15.990
---------------
2023-09-11 19:00:55.300991
current #epochs=37, #steps=1440
start validation
acc: 0.819905
AUC: 0.940439
Avg Precision: 0.358425
Avg Recall: 1.000000
d_prime: 2.204010
train_loss: 0.027159
valid_loss: 0.989353
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0010881738361182174
Epoch-37 lr: 0.0010881738361182174
epoch 37 training time: 15.165
---------------
2023-09-11 19:01:10.465388
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00570	Train Loss 0.0301	
start validation
acc: 0.829384
AUC: 0.938072
Avg Precision: 0.360565
Avg Recall: 1.000000
d_prime: 2.176178
train_loss: 0.029096
valid_loss: 0.986393
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0010881738361182174
Epoch-38 lr: 0.0010881738361182174
epoch 38 training time: 15.212
---------------
2023-09-11 19:01:25.677541
current #epochs=39, #steps=1520
start validation
acc: 0.829384
AUC: 0.932720
Avg Precision: 0.342676
Avg Recall: 1.000000
d_prime: 2.116170
train_loss: 0.014561
valid_loss: 0.996258
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0010881738361182174
Epoch-39 lr: 0.0010881738361182174
epoch 39 training time: 16.203
---------------
2023-09-11 19:01:41.880494
current #epochs=40, #steps=1560
start validation
acc: 0.838863
AUC: 0.933601
Avg Precision: 0.350066
Avg Recall: 1.000000
d_prime: 2.125790
train_loss: 0.019098
valid_loss: 1.004123
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0010881738361182174
Epoch-40 lr: 0.0010881738361182174
epoch 40 training time: 15.112
---------------
2023-09-11 19:01:56.993114
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.04138	Per Sample Data Time 0.03052	Per Sample DNN Time 0.01086	Train Loss 0.0238	
start validation
acc: 0.848341
AUC: 0.933642
Avg Precision: 0.323959
Avg Recall: 1.000000
d_prime: 2.126242
train_loss: 0.027057
valid_loss: 0.992999
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0010881738361182174
Epoch-41 lr: 0.0010881738361182174
epoch 41 training time: 15.270
---------------
2023-09-11 19:02:12.262367
current #epochs=42, #steps=1640
start validation
acc: 0.824645
AUC: 0.938547
Avg Precision: 0.346687
Avg Recall: 1.000000
d_prime: 2.181690
train_loss: 0.020062
valid_loss: 0.988094
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0010881738361182174
Epoch-42 lr: 0.0010881738361182174
epoch 42 training time: 15.187
---------------
2023-09-11 19:02:27.450007
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00566	Train Loss 0.0165	
start validation
acc: 0.819905
AUC: 0.940234
Avg Precision: 0.336096
Avg Recall: 1.000000
d_prime: 2.201559
train_loss: 0.022149
valid_loss: 0.977690
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0010881738361182174
Epoch-43 lr: 0.0010881738361182174
epoch 43 training time: 15.158
---------------
2023-09-11 19:02:42.607622
current #epochs=44, #steps=1720
start validation
[I 2023-09-11 19:02:57,715] Trial 73 finished with value: 0.8530805687203792 and parameters: {'warmup': 'False', 'num_epochs': 44, 'batch_size': 53, 'lr-adaptschedule': 'True', 'lr': 0.0021404635588375834, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.8443988055319627}. Best is trial 50 with value: 0.8815165876777251.
acc: 0.834123
AUC: 0.940811
Avg Precision: 0.341435
Avg Recall: 1.000000
d_prime: 2.208463
train_loss: 0.015470
valid_loss: 0.999503
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0010881738361182174
Epoch-44 lr: 0.0010881738361182174
epoch 44 training time: 15.093
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f86670acaf0>
The learning rate scheduler starts at 7 epoch with decay rate of 0.827 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 19:02:57.754479
current #epochs=1, #steps=0
start validation
acc: 0.824645
AUC: 0.925784
Avg Precision: 0.298312
Avg Recall: 1.000000
d_prime: 2.043667
train_loss: 0.030784
valid_loss: 0.982019
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0024831012029706695
Epoch-1 lr: 0.0024831012029706695
epoch 1 training time: 17.170
---------------
2023-09-11 19:03:14.924392
current #epochs=2, #steps=40
start validation
acc: 0.838863
AUC: 0.935917
Avg Precision: 0.349258
Avg Recall: 1.000000
d_prime: 2.151545
train_loss: 0.043290
valid_loss: 0.975399
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0024831012029706695
Epoch-2 lr: 0.0024831012029706695
epoch 2 training time: 17.756
---------------
2023-09-11 19:03:32.680847
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00567	Train Loss 0.0417	
start validation
acc: 0.838863
AUC: 0.926329
Avg Precision: 0.352299
Avg Recall: 1.000000
d_prime: 2.049176
train_loss: 0.040573
valid_loss: 0.996692
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0024831012029706695
Epoch-3 lr: 0.0024831012029706695
epoch 3 training time: 16.135
---------------
2023-09-11 19:03:48.816267
current #epochs=4, #steps=120
start validation
acc: 0.867299
AUC: 0.952564
Avg Precision: 0.380475
Avg Recall: 1.000000
d_prime: 2.362071
train_loss: 0.034810
valid_loss: 0.980836
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0024831012029706695
Epoch-4 lr: 0.0024831012029706695
epoch 4 training time: 17.053
---------------
2023-09-11 19:04:05.869742
current #epochs=5, #steps=160
start validation
acc: 0.857820
AUC: 0.954703
Avg Precision: 0.387350
Avg Recall: 1.000000
d_prime: 2.393240
train_loss: 0.034174
valid_loss: 0.935524
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0024831012029706695
Epoch-5 lr: 0.0024831012029706695
epoch 5 training time: 15.486
---------------
2023-09-11 19:04:21.355468
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03593	Per Sample Data Time 0.02886	Per Sample DNN Time 0.00706	Train Loss 0.0272	
start validation
acc: 0.853081
AUC: 0.933235
Avg Precision: 0.323605
Avg Recall: 1.000000
d_prime: 2.121782
train_loss: 0.040394
valid_loss: 0.992479
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0024831012029706695
Epoch-6 lr: 0.0024831012029706695
epoch 6 training time: 15.076
---------------
2023-09-11 19:04:36.432242
current #epochs=7, #steps=240
start validation
acc: 0.810427
AUC: 0.930855
Avg Precision: 0.335056
Avg Recall: 1.000000
d_prime: 2.096132
train_loss: 0.056871
valid_loss: 1.032840
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0020526362928514246
Epoch-7 lr: 0.0020526362928514246
epoch 7 training time: 15.174
---------------
2023-09-11 19:04:51.606258
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00724	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00568	Train Loss 0.0528	
start validation
acc: 0.829384
AUC: 0.930194
Avg Precision: 0.355486
Avg Recall: 1.000000
d_prime: 2.089133
train_loss: 0.043536
valid_loss: 0.991199
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0020526362928514246
Epoch-8 lr: 0.0020526362928514246
epoch 8 training time: 15.238
---------------
2023-09-11 19:05:06.844661
current #epochs=9, #steps=320
start validation
acc: 0.829384
AUC: 0.923736
Avg Precision: 0.353083
Avg Recall: 1.000000
d_prime: 2.023257
train_loss: 0.034181
valid_loss: 1.010364
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0020526362928514246
Epoch-9 lr: 0.0020526362928514246
epoch 9 training time: 15.190
---------------
2023-09-11 19:05:22.034683
current #epochs=10, #steps=360
start validation
acc: 0.838863
AUC: 0.918376
Avg Precision: 0.342979
Avg Recall: 1.000000
d_prime: 1.971743
train_loss: 0.045962
valid_loss: 0.997072
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0020526362928514246
Epoch-10 lr: 0.0020526362928514246
epoch 10 training time: 15.056
---------------
2023-09-11 19:05:37.091040
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03978	Per Sample Data Time 0.02950	Per Sample DNN Time 0.01028	Train Loss 0.0026	
start validation
acc: 0.829384
AUC: 0.923530
Avg Precision: 0.317189
Avg Recall: 1.000000
d_prime: 2.021222
train_loss: 0.031410
valid_loss: 1.008493
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0020526362928514246
Epoch-11 lr: 0.0020526362928514246
epoch 11 training time: 15.134
---------------
2023-09-11 19:05:52.225001
current #epochs=12, #steps=440
start validation
acc: 0.819905
AUC: 0.915274
Avg Precision: 0.333789
Avg Recall: 1.000000
d_prime: 1.943079
train_loss: 0.018175
valid_loss: 1.019623
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0020526362928514246
Epoch-12 lr: 0.0020526362928514246
epoch 12 training time: 15.175
---------------
2023-09-11 19:06:07.400232
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00568	Train Loss 0.0203	
start validation
acc: 0.829384
AUC: 0.921804
Avg Precision: 0.336550
Avg Recall: 1.000000
d_prime: 2.004377
train_loss: 0.024913
valid_loss: 1.005576
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0020526362928514246
Epoch-13 lr: 0.0020526362928514246
epoch 13 training time: 15.129
---------------
2023-09-11 19:06:22.529402
current #epochs=14, #steps=520
start validation
acc: 0.834123
AUC: 0.930830
Avg Precision: 0.353149
Avg Recall: 1.000000
d_prime: 2.095870
train_loss: 0.025396
valid_loss: 0.999814
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0020526362928514246
Epoch-14 lr: 0.0020526362928514246
epoch 14 training time: 15.979
---------------
2023-09-11 19:06:38.508377
current #epochs=15, #steps=560
start validation
acc: 0.843602
AUC: 0.931313
Avg Precision: 0.350495
Avg Recall: 1.000000
d_prime: 2.101019
train_loss: 0.023061
valid_loss: 0.995547
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0020526362928514246
Epoch-15 lr: 0.0020526362928514246
epoch 15 training time: 15.104
---------------
2023-09-11 19:06:53.612702
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03677	Per Sample Data Time 0.02864	Per Sample DNN Time 0.00813	Train Loss 0.0237	
start validation
acc: 0.815166
AUC: 0.937200
Avg Precision: 0.362644
Avg Recall: 1.000000
d_prime: 2.166132
train_loss: 0.023910
valid_loss: 0.987375
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0016967958235815034
Epoch-16 lr: 0.0016967958235815034
epoch 16 training time: 15.129
---------------
2023-09-11 19:07:08.741658
current #epochs=17, #steps=640
start validation
acc: 0.829384
AUC: 0.931237
Avg Precision: 0.357329
Avg Recall: 1.000000
d_prime: 2.100197
train_loss: 0.028300
valid_loss: 0.997493
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0016967958235815034
Epoch-17 lr: 0.0016967958235815034
epoch 17 training time: 15.310
---------------
2023-09-11 19:07:24.051288
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00565	Train Loss 0.0190	
start validation
acc: 0.805687
AUC: 0.923245
Avg Precision: 0.360469
Avg Recall: 1.000000
d_prime: 2.018428
train_loss: 0.021089
valid_loss: 1.038231
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0016967958235815034
Epoch-18 lr: 0.0016967958235815034
epoch 18 training time: 15.154
---------------
2023-09-11 19:07:39.205439
current #epochs=19, #steps=720
start validation
acc: 0.829384
AUC: 0.931496
Avg Precision: 0.356866
Avg Recall: 1.000000
d_prime: 2.102967
train_loss: 0.018784
valid_loss: 1.010061
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0016967958235815034
Epoch-19 lr: 0.0016967958235815034
epoch 19 training time: 15.062
---------------
2023-09-11 19:07:54.267588
current #epochs=20, #steps=760
start validation
acc: 0.848341
AUC: 0.929209
Avg Precision: 0.327380
Avg Recall: 1.000000
d_prime: 2.078791
train_loss: 0.023868
valid_loss: 1.000929
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0016967958235815034
Epoch-20 lr: 0.0016967958235815034
epoch 20 training time: 15.087
---------------
2023-09-11 19:08:09.354815
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03659	Per Sample Data Time 0.02862	Per Sample DNN Time 0.00797	Train Loss 0.0253	
start validation
acc: 0.829384
AUC: 0.940871
Avg Precision: 0.337932
Avg Recall: 1.000000
d_prime: 2.209185
train_loss: 0.019825
valid_loss: 0.982411
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0016967958235815034
Epoch-21 lr: 0.0016967958235815034
epoch 21 training time: 15.202
---------------
2023-09-11 19:08:24.556331
current #epochs=22, #steps=840
start validation
acc: 0.843602
AUC: 0.922326
Avg Precision: 0.337230
Avg Recall: 1.000000
d_prime: 2.009450
train_loss: 0.021710
valid_loss: 0.998340
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0016967958235815034
Epoch-22 lr: 0.0016967958235815034
epoch 22 training time: 15.120
---------------
2023-09-11 19:08:39.676349
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00571	Train Loss 0.0168	
start validation
acc: 0.824645
AUC: 0.923599
Avg Precision: 0.353361
Avg Recall: 1.000000
d_prime: 2.021903
train_loss: 0.021331
valid_loss: 1.016843
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0016967958235815034
Epoch-23 lr: 0.0016967958235815034
epoch 23 training time: 15.233
---------------
2023-09-11 19:08:54.909485
current #epochs=24, #steps=920
start validation
acc: 0.843602
AUC: 0.925927
Avg Precision: 0.353154
Avg Recall: 1.000000
d_prime: 2.045115
train_loss: 0.016104
valid_loss: 1.003994
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0016967958235815034
Epoch-24 lr: 0.0016967958235815034
epoch 24 training time: 15.166
---------------
2023-09-11 19:09:10.075926
current #epochs=25, #steps=960
start validation
acc: 0.834123
AUC: 0.930760
Avg Precision: 0.350426
Avg Recall: 1.000000
d_prime: 2.095126
train_loss: 0.035797
valid_loss: 0.991275
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0014026430678199214
Epoch-25 lr: 0.0014026430678199214
epoch 25 training time: 15.178
---------------
2023-09-11 19:09:25.254070
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03973	Per Sample Data Time 0.02819	Per Sample DNN Time 0.01153	Train Loss 0.0284	
start validation
acc: 0.843602
AUC: 0.933116
Avg Precision: 0.356452
Avg Recall: 1.000000
d_prime: 2.120483
train_loss: 0.025711
valid_loss: 0.985984
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0014026430678199214
Epoch-26 lr: 0.0014026430678199214
epoch 26 training time: 15.241
---------------
2023-09-11 19:09:40.495072
current #epochs=27, #steps=1040
start validation
acc: 0.857820
AUC: 0.938227
Avg Precision: 0.347822
Avg Recall: 1.000000
d_prime: 2.177975
train_loss: 0.024903
valid_loss: 0.997829
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0014026430678199214
Epoch-27 lr: 0.0014026430678199214
epoch 27 training time: 15.144
---------------
2023-09-11 19:09:55.638991
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00732	Per Sample Data Time 0.00167	Per Sample DNN Time 0.00564	Train Loss 0.0228	
start validation
acc: 0.848341
AUC: 0.940410
Avg Precision: 0.345305
Avg Recall: 1.000000
d_prime: 2.203659
train_loss: 0.025772
valid_loss: 0.982984
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0014026430678199214
Epoch-28 lr: 0.0014026430678199214
epoch 28 training time: 15.248
---------------
2023-09-11 19:10:10.887191
current #epochs=29, #steps=1120
start validation
acc: 0.834123
AUC: 0.938675
Avg Precision: 0.343908
Avg Recall: 1.000000
d_prime: 2.183182
train_loss: 0.019909
valid_loss: 0.973808
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0014026430678199214
Epoch-29 lr: 0.0014026430678199214
epoch 29 training time: 15.116
---------------
2023-09-11 19:10:26.003660
current #epochs=30, #steps=1160
start validation
acc: 0.843602
AUC: 0.926251
Avg Precision: 0.353318
Avg Recall: 1.000000
d_prime: 2.048385
train_loss: 0.018630
valid_loss: 0.997138
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0014026430678199214
Epoch-30 lr: 0.0014026430678199214
epoch 30 training time: 15.201
---------------
2023-09-11 19:10:41.204234
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03711	Per Sample Data Time 0.02921	Per Sample DNN Time 0.00791	Train Loss 0.0005	
start validation
acc: 0.843602
AUC: 0.926036
Avg Precision: 0.349738
Avg Recall: 1.000000
d_prime: 2.046212
train_loss: 0.015240
valid_loss: 0.990291
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0014026430678199214
Epoch-31 lr: 0.0014026430678199214
epoch 31 training time: 15.109
---------------
2023-09-11 19:10:56.313508
current #epochs=32, #steps=1240
start validation
acc: 0.824645
AUC: 0.935765
Avg Precision: 0.337472
Avg Recall: 1.000000
d_prime: 2.149831
train_loss: 0.023904
valid_loss: 0.983902
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0014026430678199214
Epoch-32 lr: 0.0014026430678199214
epoch 32 training time: 15.086
---------------
2023-09-11 19:11:11.399294
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00566	Train Loss 0.0200	
start validation
acc: 0.843602
AUC: 0.928772
Avg Precision: 0.347546
Avg Recall: 1.000000
d_prime: 2.074235
train_loss: 0.020301
valid_loss: 0.982947
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0014026430678199214
Epoch-33 lr: 0.0014026430678199214
epoch 33 training time: 15.114
---------------
2023-09-11 19:11:26.512997
current #epochs=34, #steps=1320
start validation
acc: 0.834123
AUC: 0.914119
Avg Precision: 0.350194
Avg Recall: 1.000000
d_prime: 1.932617
train_loss: 0.042455
valid_loss: 1.011344
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0011594839805478686
Epoch-34 lr: 0.0011594839805478686
epoch 34 training time: 15.100
---------------
2023-09-11 19:11:41.613056
current #epochs=35, #steps=1360
start validation
acc: 0.843602
AUC: 0.917274
Avg Precision: 0.324188
Avg Recall: 1.000000
d_prime: 1.961470
train_loss: 0.034968
valid_loss: 0.993690
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0011594839805478686
Epoch-35 lr: 0.0011594839805478686
epoch 35 training time: 15.219
---------------
2023-09-11 19:11:56.831719
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03611	Per Sample Data Time 0.02766	Per Sample DNN Time 0.00845	Train Loss 0.0025	
start validation
acc: 0.810427
AUC: 0.925265
Avg Precision: 0.349636
Avg Recall: 1.000000
d_prime: 2.038458
train_loss: 0.026272
valid_loss: 0.977411
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0011594839805478686
Epoch-36 lr: 0.0011594839805478686
epoch 36 training time: 15.089
---------------
2023-09-11 19:12:11.920838
current #epochs=37, #steps=1440
start validation
acc: 0.824645
AUC: 0.927010
Avg Precision: 0.338632
Avg Recall: 1.000000
d_prime: 2.056097
train_loss: 0.019762
valid_loss: 0.994266
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0011594839805478686
Epoch-37 lr: 0.0011594839805478686
epoch 37 training time: 15.107
---------------
2023-09-11 19:12:27.027625
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00157	Per Sample DNN Time 0.00564	Train Loss 0.0221	
start validation
acc: 0.848341
AUC: 0.927745
Avg Precision: 0.325547
Avg Recall: 1.000000
d_prime: 2.063616
train_loss: 0.017501
valid_loss: 0.980716
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0011594839805478686
Epoch-38 lr: 0.0011594839805478686
epoch 38 training time: 15.026
---------------
2023-09-11 19:12:42.053918
current #epochs=39, #steps=1520
start validation
acc: 0.834123
AUC: 0.927978
Avg Precision: 0.339219
Avg Recall: 1.000000
d_prime: 2.066021
train_loss: 0.011602
valid_loss: 0.967544
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0011594839805478686
Epoch-39 lr: 0.0011594839805478686
epoch 39 training time: 15.133
---------------
2023-09-11 19:12:57.186726
current #epochs=40, #steps=1560
start validation
acc: 0.843602
AUC: 0.934450
Avg Precision: 0.334521
Avg Recall: 1.000000
d_prime: 2.135154
train_loss: 0.025770
valid_loss: 0.986791
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0011594839805478686
Epoch-40 lr: 0.0011594839805478686
epoch 40 training time: 14.975
---------------
2023-09-11 19:13:12.162168
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03908	Per Sample Data Time 0.02928	Per Sample DNN Time 0.00981	Train Loss 0.0061	
start validation
acc: 0.824645
AUC: 0.921560
Avg Precision: 0.314787
Avg Recall: 1.000000
d_prime: 2.002018
train_loss: 0.031771
valid_loss: 0.993295
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0011594839805478686
Epoch-41 lr: 0.0011594839805478686
epoch 41 training time: 15.199
---------------
2023-09-11 19:13:27.361528
current #epochs=42, #steps=1640
start validation
acc: 0.843602
AUC: 0.925909
Avg Precision: 0.343298
Avg Recall: 1.000000
d_prime: 2.044930
train_loss: 0.017645
valid_loss: 1.001597
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0011594839805478686
Epoch-42 lr: 0.0011594839805478686
epoch 42 training time: 15.173
---------------
2023-09-11 19:13:42.534808
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00566	Train Loss 0.0303	
start validation
acc: 0.829384
AUC: 0.929445
Avg Precision: 0.365867
Avg Recall: 1.000000
d_prime: 2.081258
train_loss: 0.031212
valid_loss: 1.005565
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0009584784126418479
Epoch-43 lr: 0.0009584784126418479
epoch 43 training time: 15.123
---------------
2023-09-11 19:13:57.657665
current #epochs=44, #steps=1720
start validation
acc: 0.834123
AUC: 0.925857
Avg Precision: 0.337051
Avg Recall: 1.000000
d_prime: 2.044404
train_loss: 0.025509
valid_loss: 0.977383
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0009584784126418479
Epoch-44 lr: 0.0009584784126418479
epoch 44 training time: 15.162
---------------
2023-09-11 19:14:12.819074
current #epochs=45, #steps=1760
start validation
acc: 0.834123
AUC: 0.927109
Avg Precision: 0.335396
Avg Recall: 1.000000
d_prime: 2.057101
train_loss: 0.025135
valid_loss: 0.981878
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0009584784126418479
Epoch-45 lr: 0.0009584784126418479
epoch 45 training time: 15.092
---------------
2023-09-11 19:14:27.911196
current #epochs=46, #steps=1800
Epoch: [46][0/40]	Per Sample Total Time 0.03657	Per Sample Data Time 0.02917	Per Sample DNN Time 0.00740	Train Loss 0.0057	
start validation
acc: 0.843602
AUC: 0.928756
Avg Precision: 0.342799
Avg Recall: 1.000000
d_prime: 2.074072
train_loss: 0.028798
valid_loss: 0.987357
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.0009584784126418479
Epoch-46 lr: 0.0009584784126418479
epoch 46 training time: 15.023
---------------
2023-09-11 19:14:42.934344
current #epochs=47, #steps=1840
start validation
acc: 0.867299
AUC: 0.930817
Avg Precision: 0.339668
Avg Recall: 1.000000
d_prime: 2.095733
train_loss: 0.014569
valid_loss: 0.992081
validation finished
normal learning rate scheduler step
Epoch-47 lr: 0.0009584784126418479
Epoch-47 lr: 0.0009584784126418479
epoch 47 training time: 15.163
---------------
2023-09-11 19:14:58.097500
current #epochs=48, #steps=1880
Epoch: [48][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00566	Train Loss 0.0222	
start validation
acc: 0.838863
AUC: 0.931104
Avg Precision: 0.344794
Avg Recall: 1.000000
d_prime: 2.098784
train_loss: 0.023502
valid_loss: 0.969746
validation finished
normal learning rate scheduler step
Epoch-48 lr: 0.0009584784126418479
Epoch-48 lr: 0.0009584784126418479
epoch 48 training time: 15.227
---------------
2023-09-11 19:15:13.324020
current #epochs=49, #steps=1920
start validation
[I 2023-09-11 19:15:28,511] Trial 74 finished with value: 0.8672985781990521 and parameters: {'warmup': 'False', 'num_epochs': 49, 'batch_size': 47, 'lr-adaptschedule': 'True', 'lr': 0.0024831012029706695, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.8266422207825214}. Best is trial 50 with value: 0.8815165876777251.
acc: 0.848341
AUC: 0.929590
Avg Precision: 0.339605
Avg Recall: 1.000000
d_prime: 2.082778
train_loss: 0.018599
valid_loss: 0.981214
validation finished
normal learning rate scheduler step
Epoch-49 lr: 0.0009584784126418479
Epoch-49 lr: 0.0009584784126418479
epoch 49 training time: 15.175
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f8667030490>
The learning rate scheduler starts at 6 epoch with decay rate of 0.863 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 19:15:28.551893
current #epochs=1, #steps=0
start validation
acc: 0.834123
AUC: 0.906923
Avg Precision: 0.339225
Avg Recall: 1.000000
d_prime: 1.869652
train_loss: 0.052524
valid_loss: 1.005064
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0028995169012271268
Epoch-1 lr: 0.0028995169012271268
epoch 1 training time: 17.181
---------------
2023-09-11 19:15:45.732894
current #epochs=2, #steps=40
start validation
acc: 0.853081
AUC: 0.926743
Avg Precision: 0.369169
Avg Recall: 1.000000
d_prime: 2.053378
train_loss: 0.037372
valid_loss: 0.987577
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0028995169012271268
Epoch-2 lr: 0.0028995169012271268
epoch 2 training time: 17.347
---------------
2023-09-11 19:16:03.079930
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00566	Train Loss 0.0335	
start validation
acc: 0.829384
AUC: 0.921848
Avg Precision: 0.351782
Avg Recall: 1.000000
d_prime: 2.004806
train_loss: 0.050045
valid_loss: 0.995150
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0028995169012271268
Epoch-3 lr: 0.0028995169012271268
epoch 3 training time: 15.148
---------------
2023-09-11 19:16:18.227506
current #epochs=4, #steps=120
start validation
acc: 0.829384
AUC: 0.927312
Avg Precision: 0.371154
Avg Recall: 1.000000
d_prime: 2.059181
train_loss: 0.044616
valid_loss: 0.988797
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0028995169012271268
Epoch-4 lr: 0.0028995169012271268
epoch 4 training time: 15.189
---------------
2023-09-11 19:16:33.416532
current #epochs=5, #steps=160
start validation
acc: 0.843602
AUC: 0.928849
Avg Precision: 0.358373
Avg Recall: 1.000000
d_prime: 2.075036
train_loss: 0.030765
valid_loss: 0.978896
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0028995169012271268
Epoch-5 lr: 0.0028995169012271268
epoch 5 training time: 15.154
---------------
2023-09-11 19:16:48.570479
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03959	Per Sample Data Time 0.02879	Per Sample DNN Time 0.01080	Train Loss 0.0459	
start validation
acc: 0.829384
AUC: 0.919673
Avg Precision: 0.357644
Avg Recall: 1.000000
d_prime: 1.983961
train_loss: 0.036079
valid_loss: 1.017796
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0025019816163147613
Epoch-6 lr: 0.0025019816163147613
epoch 6 training time: 15.254
---------------
2023-09-11 19:17:03.823877
current #epochs=7, #steps=240
start validation
acc: 0.853081
AUC: 0.940715
Avg Precision: 0.382967
Avg Recall: 1.000000
d_prime: 2.207304
train_loss: 0.048117
valid_loss: 1.005462
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0025019816163147613
Epoch-7 lr: 0.0025019816163147613
epoch 7 training time: 15.086
---------------
2023-09-11 19:17:18.909780
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00565	Train Loss 0.0480	
start validation
acc: 0.886256
AUC: 0.944218
Avg Precision: 0.362825
Avg Recall: 1.000000
d_prime: 2.250296
train_loss: 0.044263
valid_loss: 0.981987
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0025019816163147613
Epoch-8 lr: 0.0025019816163147613
epoch 8 training time: 17.171
---------------
2023-09-11 19:17:36.080721
current #epochs=9, #steps=320
start validation
acc: 0.872038
AUC: 0.933204
Avg Precision: 0.357871
Avg Recall: 1.000000
d_prime: 2.121442
train_loss: 0.029133
valid_loss: 0.974911
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0025019816163147613
Epoch-9 lr: 0.0025019816163147613
epoch 9 training time: 15.381
---------------
2023-09-11 19:17:51.462088
current #epochs=10, #steps=360
start validation
acc: 0.867299
AUC: 0.932721
Avg Precision: 0.358696
Avg Recall: 1.000000
d_prime: 2.116184
train_loss: 0.028965
valid_loss: 1.003504
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0025019816163147613
Epoch-10 lr: 0.0025019816163147613
epoch 10 training time: 15.155
---------------
2023-09-11 19:18:06.616882
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03549	Per Sample Data Time 0.02730	Per Sample DNN Time 0.00819	Train Loss 0.0054	
start validation
acc: 0.829384
AUC: 0.922346
Avg Precision: 0.330350
Avg Recall: 1.000000
d_prime: 2.009637
train_loss: 0.028485
valid_loss: 0.988305
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0025019816163147613
Epoch-11 lr: 0.0025019816163147613
epoch 11 training time: 15.152
---------------
2023-09-11 19:18:21.769017
current #epochs=12, #steps=440
start validation
acc: 0.834123
AUC: 0.925922
Avg Precision: 0.335776
Avg Recall: 1.000000
d_prime: 2.045055
train_loss: 0.034125
valid_loss: 0.997938
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0025019816163147613
Epoch-12 lr: 0.0025019816163147613
epoch 12 training time: 15.153
---------------
2023-09-11 19:18:36.921869
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00702	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00556	Train Loss 0.0317	
start validation
acc: 0.862559
AUC: 0.923709
Avg Precision: 0.361012
Avg Recall: 1.000000
d_prime: 2.022993
train_loss: 0.036846
valid_loss: 0.981741
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0025019816163147613
Epoch-13 lr: 0.0025019816163147613
epoch 13 training time: 15.308
---------------
2023-09-11 19:18:52.230148
current #epochs=14, #steps=520
start validation
acc: 0.848341
AUC: 0.925409
Avg Precision: 0.354894
Avg Recall: 1.000000
d_prime: 2.039901
train_loss: 0.032871
valid_loss: 1.003947
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0025019816163147613
Epoch-14 lr: 0.0025019816163147613
epoch 14 training time: 15.108
---------------
2023-09-11 19:19:07.338154
current #epochs=15, #steps=560
start validation
acc: 0.838863
AUC: 0.923586
Avg Precision: 0.345606
Avg Recall: 1.000000
d_prime: 2.021783
train_loss: 0.044782
valid_loss: 0.998098
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0025019816163147613
Epoch-15 lr: 0.0025019816163147613
epoch 15 training time: 15.151
---------------
2023-09-11 19:19:22.489613
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03606	Per Sample Data Time 0.02778	Per Sample DNN Time 0.00827	Train Loss 0.0061	
start validation
acc: 0.838863
AUC: 0.914740
Avg Precision: 0.352750
Avg Recall: 1.000000
d_prime: 1.938226
train_loss: 0.028010
valid_loss: 0.997483
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.002158949998093724
Epoch-16 lr: 0.002158949998093724
epoch 16 training time: 15.166
---------------
2023-09-11 19:19:37.655507
current #epochs=17, #steps=640
start validation
acc: 0.819905
AUC: 0.928299
Avg Precision: 0.373454
Avg Recall: 1.000000
d_prime: 2.069332
train_loss: 0.021050
valid_loss: 0.985019
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.002158949998093724
Epoch-17 lr: 0.002158949998093724
epoch 17 training time: 15.161
---------------
2023-09-11 19:19:52.816998
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00564	Train Loss 0.0389	
start validation
acc: 0.848341
AUC: 0.930494
Avg Precision: 0.331739
Avg Recall: 1.000000
d_prime: 2.092297
train_loss: 0.032019
valid_loss: 0.989463
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.002158949998093724
Epoch-18 lr: 0.002158949998093724
epoch 18 training time: 15.129
---------------
2023-09-11 19:20:07.946560
current #epochs=19, #steps=720
start validation
acc: 0.838863
AUC: 0.925836
Avg Precision: 0.358576
Avg Recall: 1.000000
d_prime: 2.044197
train_loss: 0.031911
valid_loss: 1.024446
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.002158949998093724
Epoch-19 lr: 0.002158949998093724
epoch 19 training time: 15.112
---------------
2023-09-11 19:20:23.058560
current #epochs=20, #steps=760
start validation
acc: 0.824645
AUC: 0.924040
Avg Precision: 0.357544
Avg Recall: 1.000000
d_prime: 2.026261
train_loss: 0.044729
valid_loss: 1.007682
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.002158949998093724
Epoch-20 lr: 0.002158949998093724
epoch 20 training time: 15.059
---------------
2023-09-11 19:20:38.117706
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03939	Per Sample Data Time 0.02845	Per Sample DNN Time 0.01094	Train Loss 0.0086	
start validation
acc: 0.853081
AUC: 0.934558
Avg Precision: 0.365484
Avg Recall: 1.000000
d_prime: 2.136349
train_loss: 0.043729
valid_loss: 1.008555
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.002158949998093724
Epoch-21 lr: 0.002158949998093724
epoch 21 training time: 15.228
---------------
2023-09-11 19:20:53.346640
current #epochs=22, #steps=840
start validation
acc: 0.853081
AUC: 0.941692
Avg Precision: 0.367992
Avg Recall: 1.000000
d_prime: 2.219091
train_loss: 0.044078
valid_loss: 0.990298
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.002158949998093724
Epoch-22 lr: 0.002158949998093724
epoch 22 training time: 14.970
---------------
2023-09-11 19:21:08.316640
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00560	Train Loss 0.0441	
start validation
acc: 0.853081
AUC: 0.922755
Avg Precision: 0.347570
Avg Recall: 1.000000
d_prime: 2.013632
train_loss: 0.038455
valid_loss: 1.014900
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.002158949998093724
Epoch-23 lr: 0.002158949998093724
epoch 23 training time: 15.079
---------------
2023-09-11 19:21:23.396017
current #epochs=24, #steps=920
start validation
acc: 0.848341
AUC: 0.927420
Avg Precision: 0.369812
Avg Recall: 1.000000
d_prime: 2.060288
train_loss: 0.022277
valid_loss: 1.002687
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.002158949998093724
Epoch-24 lr: 0.002158949998093724
epoch 24 training time: 15.208
---------------
2023-09-11 19:21:38.604839
current #epochs=25, #steps=960
start validation
acc: 0.867299
AUC: 0.926474
Avg Precision: 0.361002
Avg Recall: 1.000000
d_prime: 2.050646
train_loss: 0.032460
valid_loss: 0.997492
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.002158949998093724
Epoch-25 lr: 0.002158949998093724
epoch 25 training time: 15.721
---------------
2023-09-11 19:21:54.325872
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03650	Per Sample Data Time 0.02854	Per Sample DNN Time 0.00795	Train Loss 0.0395	
start validation
acc: 0.838863
AUC: 0.929748
Avg Precision: 0.391657
Avg Recall: 1.000000
d_prime: 2.084434
train_loss: 0.033393
valid_loss: 0.975517
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0018629493773556591
Epoch-26 lr: 0.0018629493773556591
epoch 26 training time: 15.046
---------------
2023-09-11 19:22:09.371187
current #epochs=27, #steps=1040
start validation
acc: 0.838863
AUC: 0.926940
Avg Precision: 0.353793
Avg Recall: 1.000000
d_prime: 2.055382
train_loss: 0.025398
valid_loss: 0.988042
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0018629493773556591
Epoch-27 lr: 0.0018629493773556591
epoch 27 training time: 15.158
---------------
2023-09-11 19:22:24.529410
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00565	Train Loss 0.0204	
start validation
acc: 0.848341
AUC: 0.926080
Avg Precision: 0.352884
Avg Recall: 1.000000
d_prime: 2.046651
train_loss: 0.020115
valid_loss: 0.987191
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0018629493773556591
Epoch-28 lr: 0.0018629493773556591
epoch 28 training time: 15.118
---------------
2023-09-11 19:22:39.647694
current #epochs=29, #steps=1120
start validation
acc: 0.819905
AUC: 0.919547
Avg Precision: 0.336535
Avg Recall: 1.000000
d_prime: 1.982769
train_loss: 0.019628
valid_loss: 1.006114
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0018629493773556591
Epoch-29 lr: 0.0018629493773556591
epoch 29 training time: 15.123
---------------
2023-09-11 19:22:54.771459
current #epochs=30, #steps=1160
start validation
acc: 0.857820
AUC: 0.922605
Avg Precision: 0.333842
Avg Recall: 1.000000
d_prime: 2.012162
train_loss: 0.034597
valid_loss: 0.990593
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0018629493773556591
Epoch-30 lr: 0.0018629493773556591
epoch 30 training time: 15.229
---------------
2023-09-11 19:23:09.999991
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03653	Per Sample Data Time 0.02901	Per Sample DNN Time 0.00752	Train Loss 0.0087	
start validation
acc: 0.843602
AUC: 0.923543
Avg Precision: 0.346267
Avg Recall: 1.000000
d_prime: 2.021359
train_loss: 0.026098
valid_loss: 1.006827
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0018629493773556591
Epoch-31 lr: 0.0018629493773556591
epoch 31 training time: 15.055
---------------
2023-09-11 19:23:25.054695
current #epochs=32, #steps=1240
start validation
acc: 0.838863
AUC: 0.928697
Avg Precision: 0.324842
Avg Recall: 1.000000
d_prime: 2.073460
train_loss: 0.035214
valid_loss: 1.001657
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0018629493773556591
Epoch-32 lr: 0.0018629493773556591
epoch 32 training time: 15.138
---------------
2023-09-11 19:23:40.192996
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00569	Train Loss 0.0277	
start validation
acc: 0.848341
AUC: 0.913938
Avg Precision: 0.342258
Avg Recall: 1.000000
d_prime: 1.930985
train_loss: 0.027748
valid_loss: 1.000907
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0018629493773556591
Epoch-33 lr: 0.0018629493773556591
epoch 33 training time: 15.106
---------------
2023-09-11 19:23:55.298433
current #epochs=34, #steps=1320
start validation
acc: 0.834123
AUC: 0.929887
Avg Precision: 0.370718
Avg Recall: 1.000000
d_prime: 2.085894
train_loss: 0.030509
valid_loss: 0.992879
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0018629493773556591
Epoch-34 lr: 0.0018629493773556591
epoch 34 training time: 15.063
---------------
2023-09-11 19:24:10.361603
current #epochs=35, #steps=1360
start validation
acc: 0.843602
AUC: 0.933919
Avg Precision: 0.338763
Avg Recall: 1.000000
d_prime: 2.129285
train_loss: 0.026287
valid_loss: 0.987758
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0018629493773556591
Epoch-35 lr: 0.0018629493773556591
epoch 35 training time: 15.034
---------------
2023-09-11 19:24:25.395809
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03887	Per Sample Data Time 0.02905	Per Sample DNN Time 0.00982	Train Loss 0.0008	
start validation
acc: 0.819905
AUC: 0.920111
Avg Precision: 0.331266
Avg Recall: 1.000000
d_prime: 1.988130
train_loss: 0.024954
valid_loss: 0.986954
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0016075316175243692
Epoch-36 lr: 0.0016075316175243692
epoch 36 training time: 15.128
---------------
2023-09-11 19:24:40.523487
current #epochs=37, #steps=1440
start validation
acc: 0.848341
AUC: 0.927859
Avg Precision: 0.356681
Avg Recall: 1.000000
d_prime: 2.064793
train_loss: 0.049092
valid_loss: 0.977942
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0016075316175243692
Epoch-37 lr: 0.0016075316175243692
epoch 37 training time: 15.157
---------------
2023-09-11 19:24:55.680304
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00724	Per Sample Data Time 0.00160	Per Sample DNN Time 0.00564	Train Loss 0.0398	
start validation
acc: 0.848341
AUC: 0.932225
Avg Precision: 0.358656
Avg Recall: 1.000000
d_prime: 2.110809
train_loss: 0.033216
valid_loss: 0.964582
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0016075316175243692
Epoch-38 lr: 0.0016075316175243692
epoch 38 training time: 15.228
---------------
2023-09-11 19:25:10.908581
current #epochs=39, #steps=1520
start validation
acc: 0.848341
AUC: 0.928375
Avg Precision: 0.347103
Avg Recall: 1.000000
d_prime: 2.070120
train_loss: 0.023439
valid_loss: 0.972269
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0016075316175243692
Epoch-39 lr: 0.0016075316175243692
epoch 39 training time: 15.095
---------------
2023-09-11 19:25:26.003931
current #epochs=40, #steps=1560
start validation
acc: 0.848341
AUC: 0.930337
Avg Precision: 0.327594
Avg Recall: 1.000000
d_prime: 2.090645
train_loss: 0.023056
valid_loss: 0.974027
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0016075316175243692
Epoch-40 lr: 0.0016075316175243692
epoch 40 training time: 15.136
---------------
2023-09-11 19:25:41.139773
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03852	Per Sample Data Time 0.03043	Per Sample DNN Time 0.00809	Train Loss 0.0012	
start validation
acc: 0.848341
AUC: 0.924821
Avg Precision: 0.326758
Avg Recall: 1.000000
d_prime: 2.034023
train_loss: 0.021425
valid_loss: 1.001853
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0016075316175243692
Epoch-41 lr: 0.0016075316175243692
epoch 41 training time: 15.207
---------------
2023-09-11 19:25:56.347096
current #epochs=42, #steps=1640
start validation
[I 2023-09-11 19:26:11,578] Trial 75 finished with value: 0.8862559241706162 and parameters: {'warmup': 'False', 'num_epochs': 42, 'batch_size': 51, 'lr-adaptschedule': 'True', 'lr': 0.0028995169012271268, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.8628960276989172}. Best is trial 75 with value: 0.8862559241706162.
acc: 0.857820
AUC: 0.928776
Avg Precision: 0.330426
Avg Recall: 1.000000
d_prime: 2.074274
train_loss: 0.021920
valid_loss: 0.967103
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0016075316175243692
Epoch-42 lr: 0.0016075316175243692
epoch 42 training time: 15.217
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f86448d12b0>
The learning rate scheduler starts at 8 epoch with decay rate of 0.865 every 8 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 19:26:11.616781
current #epochs=1, #steps=0
start validation
acc: 0.834123
AUC: 0.929242
Avg Precision: 0.321298
Avg Recall: 1.000000
d_prime: 2.079129
train_loss: 0.039490
valid_loss: 0.974509
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0023091012547549607
Epoch-1 lr: 0.0023091012547549607
epoch 1 training time: 17.024
---------------
2023-09-11 19:26:28.640669
current #epochs=2, #steps=40
start validation
acc: 0.819905
AUC: 0.917067
Avg Precision: 0.332570
Avg Recall: 1.000000
d_prime: 1.959548
train_loss: 0.044508
valid_loss: 1.005644
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0023091012547549607
Epoch-2 lr: 0.0023091012547549607
epoch 2 training time: 15.014
---------------
2023-09-11 19:26:43.655012
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00564	Train Loss 0.0308	
start validation
acc: 0.862559
AUC: 0.916458
Avg Precision: 0.343388
Avg Recall: 1.000000
d_prime: 1.953922
train_loss: 0.030142
valid_loss: 0.997737
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0023091012547549607
Epoch-3 lr: 0.0023091012547549607
epoch 3 training time: 17.159
---------------
2023-09-11 19:27:00.814024
current #epochs=4, #steps=120
start validation
acc: 0.853081
AUC: 0.918823
Avg Precision: 0.327505
Avg Recall: 1.000000
d_prime: 1.975937
train_loss: 0.026340
valid_loss: 0.991112
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0023091012547549607
Epoch-4 lr: 0.0023091012547549607
epoch 4 training time: 15.134
---------------
2023-09-11 19:27:15.948008
current #epochs=5, #steps=160
start validation
acc: 0.848341
AUC: 0.925256
Avg Precision: 0.349924
Avg Recall: 1.000000
d_prime: 2.038367
train_loss: 0.025075
valid_loss: 0.997880
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0023091012547549607
Epoch-5 lr: 0.0023091012547549607
epoch 5 training time: 15.129
---------------
2023-09-11 19:27:31.077165
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.04124	Per Sample Data Time 0.03145	Per Sample DNN Time 0.00980	Train Loss 0.0688	
start validation
acc: 0.838863
AUC: 0.915853
Avg Precision: 0.328612
Avg Recall: 1.000000
d_prime: 1.948375
train_loss: 0.025798
valid_loss: 0.990582
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0023091012547549607
Epoch-6 lr: 0.0023091012547549607
epoch 6 training time: 15.683
---------------
2023-09-11 19:27:46.759466
current #epochs=7, #steps=240
start validation
acc: 0.853081
AUC: 0.905054
Avg Precision: 0.333740
Avg Recall: 1.000000
d_prime: 1.853888
train_loss: 0.023017
valid_loss: 0.989542
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0023091012547549607
Epoch-7 lr: 0.0023091012547549607
epoch 7 training time: 15.194
---------------
2023-09-11 19:28:01.953334
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00722	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00569	Train Loss 0.0243	
start validation
acc: 0.853081
AUC: 0.918985
Avg Precision: 0.313740
Avg Recall: 1.000000
d_prime: 1.977462
train_loss: 0.021815
valid_loss: 1.004585
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001996559764471426
Epoch-8 lr: 0.001996559764471426
epoch 8 training time: 15.208
---------------
2023-09-11 19:28:17.161033
current #epochs=9, #steps=320
start validation
acc: 0.848341
AUC: 0.916627
Avg Precision: 0.331838
Avg Recall: 1.000000
d_prime: 1.955481
train_loss: 0.027462
valid_loss: 0.985294
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001996559764471426
Epoch-9 lr: 0.001996559764471426
epoch 9 training time: 15.131
---------------
2023-09-11 19:28:32.292521
current #epochs=10, #steps=360
start validation
acc: 0.848341
AUC: 0.922505
Avg Precision: 0.329633
Avg Recall: 1.000000
d_prime: 2.011187
train_loss: 0.027132
valid_loss: 0.991056
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001996559764471426
Epoch-10 lr: 0.001996559764471426
epoch 10 training time: 16.596
---------------
2023-09-11 19:28:48.888878
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03655	Per Sample Data Time 0.02808	Per Sample DNN Time 0.00847	Train Loss 0.0552	
start validation
acc: 0.867299
AUC: 0.931315
Avg Precision: 0.381051
Avg Recall: 1.000000
d_prime: 2.101035
train_loss: 0.027885
valid_loss: 0.967316
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001996559764471426
Epoch-11 lr: 0.001996559764471426
epoch 11 training time: 17.233
---------------
2023-09-11 19:29:06.121805
current #epochs=12, #steps=440
start validation
acc: 0.867299
AUC: 0.929856
Avg Precision: 0.339774
Avg Recall: 1.000000
d_prime: 2.085564
train_loss: 0.027242
valid_loss: 1.003927
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001996559764471426
Epoch-12 lr: 0.001996559764471426
epoch 12 training time: 15.059
---------------
2023-09-11 19:29:21.181155
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00568	Train Loss 0.0134	
start validation
acc: 0.848341
AUC: 0.930046
Avg Precision: 0.350777
Avg Recall: 1.000000
d_prime: 2.087566
train_loss: 0.023081
valid_loss: 0.976088
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.001996559764471426
Epoch-13 lr: 0.001996559764471426
epoch 13 training time: 15.129
---------------
2023-09-11 19:29:36.309726
current #epochs=14, #steps=520
start validation
acc: 0.824645
AUC: 0.939379
Avg Precision: 0.347582
Avg Recall: 1.000000
d_prime: 2.191434
train_loss: 0.036085
valid_loss: 0.976351
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.001996559764471426
Epoch-14 lr: 0.001996559764471426
epoch 14 training time: 15.171
---------------
2023-09-11 19:29:51.480923
current #epochs=15, #steps=560
start validation
acc: 0.848341
AUC: 0.924629
Avg Precision: 0.354300
Avg Recall: 1.000000
d_prime: 2.032103
train_loss: 0.022334
valid_loss: 0.988056
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.001996559764471426
Epoch-15 lr: 0.001996559764471426
epoch 15 training time: 15.057
---------------
2023-09-11 19:30:06.537643
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03724	Per Sample Data Time 0.02953	Per Sample DNN Time 0.00771	Train Loss 0.0485	
start validation
acc: 0.876777
AUC: 0.926195
Avg Precision: 0.349792
Avg Recall: 1.000000
d_prime: 2.047814
train_loss: 0.037640
valid_loss: 1.002520
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0017263213923155627
Epoch-16 lr: 0.0017263213923155627
epoch 16 training time: 17.248
---------------
2023-09-11 19:30:23.785695
current #epochs=17, #steps=640
start validation
acc: 0.857820
AUC: 0.929983
Avg Precision: 0.315770
Avg Recall: 1.000000
d_prime: 2.086905
train_loss: 0.028370
valid_loss: 1.021158
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0017263213923155627
Epoch-17 lr: 0.0017263213923155627
epoch 17 training time: 15.116
---------------
2023-09-11 19:30:38.901499
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00564	Train Loss 0.0286	
start validation
acc: 0.862559
AUC: 0.929777
Avg Precision: 0.370235
Avg Recall: 1.000000
d_prime: 2.084742
train_loss: 0.033171
valid_loss: 0.994886
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0017263213923155627
Epoch-18 lr: 0.0017263213923155627
epoch 18 training time: 15.129
---------------
2023-09-11 19:30:54.030193
current #epochs=19, #steps=720
start validation
acc: 0.843602
AUC: 0.928152
Avg Precision: 0.318396
Avg Recall: 1.000000
d_prime: 2.067811
train_loss: 0.033761
valid_loss: 0.981080
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0017263213923155627
Epoch-19 lr: 0.0017263213923155627
epoch 19 training time: 15.123
---------------
2023-09-11 19:31:09.153198
current #epochs=20, #steps=760
start validation
acc: 0.838863
AUC: 0.927376
Avg Precision: 0.375597
Avg Recall: 1.000000
d_prime: 2.059832
train_loss: 0.044936
valid_loss: 0.999751
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0017263213923155627
Epoch-20 lr: 0.0017263213923155627
epoch 20 training time: 15.167
---------------
2023-09-11 19:31:24.320731
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03664	Per Sample Data Time 0.02887	Per Sample DNN Time 0.00776	Train Loss 0.1259	
start validation
acc: 0.848341
AUC: 0.931288
Avg Precision: 0.361359
Avg Recall: 1.000000
d_prime: 2.100752
train_loss: 0.033481
valid_loss: 0.988510
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0017263213923155627
Epoch-21 lr: 0.0017263213923155627
epoch 21 training time: 15.126
---------------
2023-09-11 19:31:39.446602
current #epochs=22, #steps=840
start validation
acc: 0.862559
AUC: 0.929924
Avg Precision: 0.356921
Avg Recall: 1.000000
d_prime: 2.086281
train_loss: 0.010414
valid_loss: 0.993449
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0017263213923155627
Epoch-22 lr: 0.0017263213923155627
epoch 22 training time: 15.214
---------------
2023-09-11 19:31:54.660437
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00725	Per Sample Data Time 0.00160	Per Sample DNN Time 0.00564	Train Loss 0.0241	
start validation
acc: 0.834123
AUC: 0.926281
Avg Precision: 0.363045
Avg Recall: 1.000000
d_prime: 2.048685
train_loss: 0.026148
valid_loss: 1.006278
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0017263213923155627
Epoch-23 lr: 0.0017263213923155627
epoch 23 training time: 15.275
---------------
2023-09-11 19:32:09.935843
current #epochs=24, #steps=920
start validation
acc: 0.848341
AUC: 0.931505
Avg Precision: 0.366603
Avg Recall: 1.000000
d_prime: 2.103069
train_loss: 0.025622
valid_loss: 0.999863
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0014926603263265322
Epoch-24 lr: 0.0014926603263265322
epoch 24 training time: 15.091
---------------
2023-09-11 19:32:25.026912
current #epochs=25, #steps=960
start validation
acc: 0.815166
AUC: 0.927884
Avg Precision: 0.366157
Avg Recall: 1.000000
d_prime: 2.065046
train_loss: 0.021658
valid_loss: 1.005878
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0014926603263265322
Epoch-25 lr: 0.0014926603263265322
epoch 25 training time: 15.226
---------------
2023-09-11 19:32:40.252739
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.04029	Per Sample Data Time 0.03035	Per Sample DNN Time 0.00994	Train Loss 0.0501	
start validation
acc: 0.848341
AUC: 0.924870
Avg Precision: 0.348912
Avg Recall: 1.000000
d_prime: 2.034504
train_loss: 0.029678
valid_loss: 1.004475
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0014926603263265322
Epoch-26 lr: 0.0014926603263265322
epoch 26 training time: 15.164
---------------
2023-09-11 19:32:55.416478
current #epochs=27, #steps=1040
start validation
acc: 0.829384
AUC: 0.925116
Avg Precision: 0.354998
Avg Recall: 1.000000
d_prime: 2.036965
train_loss: 0.024230
valid_loss: 1.003034
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0014926603263265322
Epoch-27 lr: 0.0014926603263265322
epoch 27 training time: 15.076
---------------
2023-09-11 19:33:10.492545
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00565	Train Loss 0.0341	
start validation
acc: 0.857820
AUC: 0.937951
Avg Precision: 0.366516
Avg Recall: 1.000000
d_prime: 2.174780
train_loss: 0.029556
valid_loss: 1.004541
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0014926603263265322
Epoch-28 lr: 0.0014926603263265322
epoch 28 training time: 15.091
---------------
2023-09-11 19:33:25.583068
current #epochs=29, #steps=1120
start validation
acc: 0.843602
AUC: 0.932897
Avg Precision: 0.348517
Avg Recall: 1.000000
d_prime: 2.118101
train_loss: 0.031700
valid_loss: 0.999476
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0014926603263265322
Epoch-29 lr: 0.0014926603263265322
epoch 29 training time: 16.054
---------------
2023-09-11 19:33:41.636966
current #epochs=30, #steps=1160
start validation
acc: 0.853081
AUC: 0.936591
Avg Precision: 0.341777
Avg Recall: 1.000000
d_prime: 2.159182
train_loss: 0.019679
valid_loss: 0.985962
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0014926603263265322
Epoch-30 lr: 0.0014926603263265322
epoch 30 training time: 15.289
---------------
2023-09-11 19:33:56.926310
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03746	Per Sample Data Time 0.02989	Per Sample DNN Time 0.00757	Train Loss 0.0515	
start validation
acc: 0.848341
AUC: 0.937799
Avg Precision: 0.349545
Avg Recall: 1.000000
d_prime: 2.173023
train_loss: 0.016234
valid_loss: 0.994347
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0014926603263265322
Epoch-31 lr: 0.0014926603263265322
epoch 31 training time: 15.068
---------------
2023-09-11 19:34:11.994106
current #epochs=32, #steps=1240
start validation
acc: 0.853081
AUC: 0.936278
Avg Precision: 0.369388
Avg Recall: 1.000000
d_prime: 2.155623
train_loss: 0.019446
valid_loss: 0.995212
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0012906257546867936
Epoch-32 lr: 0.0012906257546867936
epoch 32 training time: 15.114
---------------
2023-09-11 19:34:27.107637
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00564	Train Loss 0.0194	
start validation
acc: 0.857820
AUC: 0.931750
Avg Precision: 0.326280
Avg Recall: 1.000000
d_prime: 2.105698
train_loss: 0.024114
valid_loss: 0.968910
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0012906257546867936
Epoch-33 lr: 0.0012906257546867936
epoch 33 training time: 15.122
---------------
2023-09-11 19:34:42.229300
current #epochs=34, #steps=1320
start validation
acc: 0.857820
AUC: 0.941274
Avg Precision: 0.342932
Avg Recall: 1.000000
d_prime: 2.214037
train_loss: 0.022600
valid_loss: 0.960983
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0012906257546867936
Epoch-34 lr: 0.0012906257546867936
epoch 34 training time: 15.047
---------------
2023-09-11 19:34:57.276870
current #epochs=35, #steps=1360
start validation
acc: 0.862559
AUC: 0.944458
Avg Precision: 0.349500
Avg Recall: 1.000000
d_prime: 2.253326
train_loss: 0.012822
valid_loss: 0.993281
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0012906257546867936
Epoch-35 lr: 0.0012906257546867936
epoch 35 training time: 15.279
---------------
2023-09-11 19:35:12.555435
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03711	Per Sample Data Time 0.02956	Per Sample DNN Time 0.00755	Train Loss 0.0349	
start validation
acc: 0.853081
AUC: 0.942799
Avg Precision: 0.347176
Avg Recall: 1.000000
d_prime: 2.232641
train_loss: 0.019895
valid_loss: 0.975836
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0012906257546867936
Epoch-36 lr: 0.0012906257546867936
epoch 36 training time: 15.180
---------------
2023-09-11 19:35:27.735641
current #epochs=37, #steps=1440
start validation
acc: 0.853081
AUC: 0.941452
Avg Precision: 0.329561
Avg Recall: 1.000000
d_prime: 2.216191
train_loss: 0.027042
valid_loss: 0.974569
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0012906257546867936
Epoch-37 lr: 0.0012906257546867936
epoch 37 training time: 15.211
---------------
2023-09-11 19:35:42.946780
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00725	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00567	Train Loss 0.0248	
start validation
acc: 0.862559
AUC: 0.936620
Avg Precision: 0.348615
Avg Recall: 1.000000
d_prime: 2.159515
train_loss: 0.022399
valid_loss: 1.006278
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0012906257546867936
Epoch-38 lr: 0.0012906257546867936
epoch 38 training time: 15.272
---------------
2023-09-11 19:35:58.218731
current #epochs=39, #steps=1520
start validation
acc: 0.848341
AUC: 0.938245
Avg Precision: 0.357587
Avg Recall: 1.000000
d_prime: 2.178182
train_loss: 0.012771
valid_loss: 0.997108
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0012906257546867936
Epoch-39 lr: 0.0012906257546867936
epoch 39 training time: 15.111
---------------
2023-09-11 19:36:13.330450
current #epochs=40, #steps=1560
start validation
acc: 0.867299
AUC: 0.935455
Avg Precision: 0.336242
Avg Recall: 1.000000
d_prime: 2.146354
train_loss: 0.020871
valid_loss: 0.995608
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0011159369678969187
Epoch-40 lr: 0.0011159369678969187
epoch 40 training time: 15.142
---------------
2023-09-11 19:36:28.472233
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03846	Per Sample Data Time 0.02797	Per Sample DNN Time 0.01049	Train Loss 0.0031	
start validation
acc: 0.872038
AUC: 0.936466
Avg Precision: 0.329109
Avg Recall: 1.000000
d_prime: 2.157761
train_loss: 0.013947
valid_loss: 0.985410
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0011159369678969187
Epoch-41 lr: 0.0011159369678969187
epoch 41 training time: 15.246
---------------
2023-09-11 19:36:43.718554
current #epochs=42, #steps=1640
start validation
[I 2023-09-11 19:37:01,405] Trial 76 finished with value: 0.8815165876777251 and parameters: {'warmup': 'False', 'num_epochs': 42, 'batch_size': 51, 'lr-adaptschedule': 'True', 'lr': 0.0023091012547549607, 'head-lr': 1, 'lr-scheduler-start': 8, 'lr-scheduler-step': 8, 'lr-scheduler-decay': 0.8646479925295866}. Best is trial 75 with value: 0.8862559241706162.
acc: 0.881517
AUC: 0.932770
Avg Precision: 0.346487
Avg Recall: 1.000000
d_prime: 2.116717
train_loss: 0.015935
valid_loss: 0.990843
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0011159369678969187
Epoch-42 lr: 0.0011159369678969187
epoch 42 training time: 17.673
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f86448d1e80>
The learning rate scheduler starts at 8 epoch with decay rate of 0.865 every 8 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 19:37:01.445009
current #epochs=1, #steps=0
start validation
acc: 0.843602
AUC: 0.919928
Avg Precision: 0.349873
Avg Recall: 1.000000
d_prime: 1.986390
train_loss: 0.041654
valid_loss: 1.027079
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0022250688728196904
Epoch-1 lr: 0.0022250688728196904
epoch 1 training time: 17.339
---------------
2023-09-11 19:37:18.784275
current #epochs=2, #steps=40
start validation
acc: 0.862559
AUC: 0.938645
Avg Precision: 0.361331
Avg Recall: 1.000000
d_prime: 2.182831
train_loss: 0.039832
valid_loss: 0.976863
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0022250688728196904
Epoch-2 lr: 0.0022250688728196904
epoch 2 training time: 17.637
---------------
2023-09-11 19:37:36.421001
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00571	Train Loss 0.0213	
start validation
acc: 0.848341
AUC: 0.937103
Avg Precision: 0.384019
Avg Recall: 1.000000
d_prime: 2.165021
train_loss: 0.025498
valid_loss: 0.992414
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0022250688728196904
Epoch-3 lr: 0.0022250688728196904
epoch 3 training time: 15.026
---------------
2023-09-11 19:37:51.446840
current #epochs=4, #steps=120
start validation
acc: 0.848341
AUC: 0.927709
Avg Precision: 0.346568
Avg Recall: 1.000000
d_prime: 2.063251
train_loss: 0.022355
valid_loss: 0.994515
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0022250688728196904
Epoch-4 lr: 0.0022250688728196904
epoch 4 training time: 15.166
---------------
2023-09-11 19:38:06.612912
current #epochs=5, #steps=160
start validation
acc: 0.834123
AUC: 0.926237
Avg Precision: 0.324411
Avg Recall: 1.000000
d_prime: 2.048241
train_loss: 0.025393
valid_loss: 1.011845
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0022250688728196904
Epoch-5 lr: 0.0022250688728196904
epoch 5 training time: 15.070
---------------
2023-09-11 19:38:21.682560
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03988	Per Sample Data Time 0.02880	Per Sample DNN Time 0.01108	Train Loss 0.0022	
start validation
acc: 0.843602
AUC: 0.916134
Avg Precision: 0.326970
Avg Recall: 1.000000
d_prime: 1.950943
train_loss: 0.041853
valid_loss: 1.009015
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0022250688728196904
Epoch-6 lr: 0.0022250688728196904
epoch 6 training time: 15.153
---------------
2023-09-11 19:38:36.836036
current #epochs=7, #steps=240
start validation
acc: 0.834123
AUC: 0.934287
Avg Precision: 0.352172
Avg Recall: 1.000000
d_prime: 2.133340
train_loss: 0.034373
valid_loss: 1.003443
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0022250688728196904
Epoch-7 lr: 0.0022250688728196904
epoch 7 training time: 15.914
---------------
2023-09-11 19:38:52.749467
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00569	Train Loss 0.0345	
start validation
acc: 0.843602
AUC: 0.935024
Avg Precision: 0.356643
Avg Recall: 1.000000
d_prime: 2.141527
train_loss: 0.027066
valid_loss: 0.975351
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001923925893977998
Epoch-8 lr: 0.001923925893977998
epoch 8 training time: 15.135
---------------
2023-09-11 19:39:07.883982
current #epochs=9, #steps=320
start validation
acc: 0.838863
AUC: 0.941573
Avg Precision: 0.365529
Avg Recall: 1.000000
d_prime: 2.217650
train_loss: 0.035459
valid_loss: 0.995614
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001923925893977998
Epoch-9 lr: 0.001923925893977998
epoch 9 training time: 15.220
---------------
2023-09-11 19:39:23.103901
current #epochs=10, #steps=360
start validation
acc: 0.867299
AUC: 0.920396
Avg Precision: 0.328513
Avg Recall: 1.000000
d_prime: 1.990845
train_loss: 0.031676
valid_loss: 0.992165
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001923925893977998
Epoch-10 lr: 0.001923925893977998
epoch 10 training time: 17.346
---------------
2023-09-11 19:39:40.449690
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03729	Per Sample Data Time 0.02824	Per Sample DNN Time 0.00905	Train Loss 0.0036	
start validation
acc: 0.857820
AUC: 0.936695
Avg Precision: 0.334564
Avg Recall: 1.000000
d_prime: 2.160363
train_loss: 0.020074
valid_loss: 0.972918
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001923925893977998
Epoch-11 lr: 0.001923925893977998
epoch 11 training time: 16.613
---------------
2023-09-11 19:39:57.062301
current #epochs=12, #steps=440
start validation
acc: 0.834123
AUC: 0.927684
Avg Precision: 0.349385
Avg Recall: 1.000000
d_prime: 2.062997
train_loss: 0.042416
valid_loss: 1.011866
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001923925893977998
Epoch-12 lr: 0.001923925893977998
epoch 12 training time: 15.736
---------------
2023-09-11 19:40:12.798588
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00722	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00572	Train Loss 0.0611	
start validation
acc: 0.857820
AUC: 0.927714
Avg Precision: 0.326621
Avg Recall: 1.000000
d_prime: 2.063304
train_loss: 0.050135
valid_loss: 0.975235
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.001923925893977998
Epoch-13 lr: 0.001923925893977998
epoch 13 training time: 15.200
---------------
2023-09-11 19:40:27.998020
current #epochs=14, #steps=520
start validation
acc: 0.862559
AUC: 0.935350
Avg Precision: 0.381451
Avg Recall: 1.000000
d_prime: 2.145170
train_loss: 0.026604
valid_loss: 0.982876
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.001923925893977998
Epoch-14 lr: 0.001923925893977998
epoch 14 training time: 15.197
---------------
2023-09-11 19:40:43.195228
current #epochs=15, #steps=560
start validation
acc: 0.867299
AUC: 0.931509
Avg Precision: 0.343848
Avg Recall: 1.000000
d_prime: 2.103115
train_loss: 0.035631
valid_loss: 0.981293
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.001923925893977998
Epoch-15 lr: 0.001923925893977998
epoch 15 training time: 15.007
---------------
2023-09-11 19:40:58.201995
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03626	Per Sample Data Time 0.02851	Per Sample DNN Time 0.00775	Train Loss 0.0016	
start validation
acc: 0.867299
AUC: 0.933227
Avg Precision: 0.354839
Avg Recall: 1.000000
d_prime: 2.121698
train_loss: 0.030299
valid_loss: 0.978614
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0016635398979036415
Epoch-16 lr: 0.0016635398979036415
epoch 16 training time: 15.857
---------------
2023-09-11 19:41:14.058786
current #epochs=17, #steps=640
start validation
acc: 0.848341
AUC: 0.929186
Avg Precision: 0.335283
Avg Recall: 1.000000
d_prime: 2.078552
train_loss: 0.031539
valid_loss: 0.985196
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0016635398979036415
Epoch-17 lr: 0.0016635398979036415
epoch 17 training time: 15.092
---------------
2023-09-11 19:41:29.151186
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00562	Train Loss 0.0117	
start validation
acc: 0.857820
AUC: 0.933269
Avg Precision: 0.343501
Avg Recall: 1.000000
d_prime: 2.122152
train_loss: 0.019056
valid_loss: 0.980903
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0016635398979036415
Epoch-18 lr: 0.0016635398979036415
epoch 18 training time: 15.140
---------------
2023-09-11 19:41:44.291235
current #epochs=19, #steps=720
start validation
acc: 0.838863
AUC: 0.935765
Avg Precision: 0.346718
Avg Recall: 1.000000
d_prime: 2.149833
train_loss: 0.032055
valid_loss: 0.981890
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0016635398979036415
Epoch-19 lr: 0.0016635398979036415
epoch 19 training time: 15.124
---------------
2023-09-11 19:41:59.415173
current #epochs=20, #steps=760
start validation
acc: 0.848341
AUC: 0.933490
Avg Precision: 0.348577
Avg Recall: 1.000000
d_prime: 2.124571
train_loss: 0.033180
valid_loss: 0.992683
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0016635398979036415
Epoch-20 lr: 0.0016635398979036415
epoch 20 training time: 15.170
---------------
2023-09-11 19:42:14.584910
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03844	Per Sample Data Time 0.02921	Per Sample DNN Time 0.00923	Train Loss 0.0469	
start validation
acc: 0.843602
AUC: 0.921872
Avg Precision: 0.337459
Avg Recall: 1.000000
d_prime: 2.005036
train_loss: 0.023878
valid_loss: 1.015640
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0016635398979036415
Epoch-21 lr: 0.0016635398979036415
epoch 21 training time: 15.193
---------------
2023-09-11 19:42:29.777724
current #epochs=22, #steps=840
start validation
acc: 0.853081
AUC: 0.924888
Avg Precision: 0.336590
Avg Recall: 1.000000
d_prime: 2.034690
train_loss: 0.034112
valid_loss: 0.992682
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0016635398979036415
Epoch-22 lr: 0.0016635398979036415
epoch 22 training time: 15.199
---------------
2023-09-11 19:42:44.976105
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00724	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00572	Train Loss 0.0273	
start validation
acc: 0.848341
AUC: 0.929620
Avg Precision: 0.355538
Avg Recall: 1.000000
d_prime: 2.083088
train_loss: 0.026980
valid_loss: 0.990924
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0016635398979036415
Epoch-23 lr: 0.0016635398979036415
epoch 23 training time: 16.784
---------------
2023-09-11 19:43:01.759857
current #epochs=24, #steps=920
start validation
acc: 0.843602
AUC: 0.927970
Avg Precision: 0.342808
Avg Recall: 1.000000
d_prime: 2.065935
train_loss: 0.021904
valid_loss: 0.987006
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0014383947950278515
Epoch-24 lr: 0.0014383947950278515
epoch 24 training time: 16.996
---------------
2023-09-11 19:43:18.755860
current #epochs=25, #steps=960
start validation
acc: 0.838863
AUC: 0.922910
Avg Precision: 0.340714
Avg Recall: 1.000000
d_prime: 2.015144
train_loss: 0.022918
valid_loss: 0.992564
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0014383947950278515
Epoch-25 lr: 0.0014383947950278515
epoch 25 training time: 15.204
---------------
2023-09-11 19:43:33.959736
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03974	Per Sample Data Time 0.02883	Per Sample DNN Time 0.01091	Train Loss 0.0031	
start validation
acc: 0.824645
AUC: 0.922137
Avg Precision: 0.357698
Avg Recall: 1.000000
d_prime: 2.007609
train_loss: 0.027306
valid_loss: 1.009215
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0014383947950278515
Epoch-26 lr: 0.0014383947950278515
epoch 26 training time: 15.214
---------------
2023-09-11 19:43:49.173870
current #epochs=27, #steps=1040
start validation
acc: 0.838863
AUC: 0.930278
Avg Precision: 0.368598
Avg Recall: 1.000000
d_prime: 2.090019
train_loss: 0.025046
valid_loss: 1.010155
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0014383947950278515
Epoch-27 lr: 0.0014383947950278515
epoch 27 training time: 15.211
---------------
2023-09-11 19:44:04.384385
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00562	Train Loss 0.0188	
start validation
acc: 0.834123
AUC: 0.930858
Avg Precision: 0.338979
Avg Recall: 1.000000
d_prime: 2.096166
train_loss: 0.020440
valid_loss: 1.021064
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0014383947950278515
Epoch-28 lr: 0.0014383947950278515
epoch 28 training time: 15.027
---------------
2023-09-11 19:44:19.410833
current #epochs=29, #steps=1120
start validation
acc: 0.829384
AUC: 0.927378
Avg Precision: 0.356440
Avg Recall: 1.000000
d_prime: 2.059851
train_loss: 0.018249
valid_loss: 1.008867
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0014383947950278515
Epoch-29 lr: 0.0014383947950278515
epoch 29 training time: 15.259
---------------
2023-09-11 19:44:34.670427
current #epochs=30, #steps=1160
start validation
acc: 0.838863
AUC: 0.932086
Avg Precision: 0.379710
Avg Recall: 1.000000
d_prime: 2.109310
train_loss: 0.025587
valid_loss: 0.997502
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0014383947950278515
Epoch-30 lr: 0.0014383947950278515
epoch 30 training time: 15.574
---------------
2023-09-11 19:44:50.243770
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03627	Per Sample Data Time 0.02857	Per Sample DNN Time 0.00769	Train Loss 0.0015	
start validation
acc: 0.810427
AUC: 0.935102
Avg Precision: 0.365997
Avg Recall: 1.000000
d_prime: 2.142407
train_loss: 0.021056
valid_loss: 0.982699
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0014383947950278515
Epoch-31 lr: 0.0014383947950278515
epoch 31 training time: 15.978
---------------
2023-09-11 19:45:06.222114
current #epochs=32, #steps=1240
start validation
acc: 0.843602
AUC: 0.934303
Avg Precision: 0.357807
Avg Recall: 1.000000
d_prime: 2.133523
train_loss: 0.022565
valid_loss: 0.998693
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0012437210486929107
Epoch-32 lr: 0.0012437210486929107
epoch 32 training time: 15.193
---------------
2023-09-11 19:45:21.415018
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00725	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00571	Train Loss 0.0360	
start validation
acc: 0.857820
AUC: 0.929329
Avg Precision: 0.339227
Avg Recall: 1.000000
d_prime: 2.080044
train_loss: 0.023051
valid_loss: 0.995773
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0012437210486929107
Epoch-33 lr: 0.0012437210486929107
epoch 33 training time: 15.191
---------------
2023-09-11 19:45:36.606172
current #epochs=34, #steps=1320
start validation
acc: 0.848341
AUC: 0.931150
Avg Precision: 0.338691
Avg Recall: 1.000000
d_prime: 2.099275
train_loss: 0.010837
valid_loss: 0.989562
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0012437210486929107
Epoch-34 lr: 0.0012437210486929107
epoch 34 training time: 15.030
---------------
2023-09-11 19:45:51.636007
current #epochs=35, #steps=1360
start validation
acc: 0.848341
AUC: 0.938222
Avg Precision: 0.354832
Avg Recall: 1.000000
d_prime: 2.177911
train_loss: 0.021212
valid_loss: 0.976604
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0012437210486929107
Epoch-35 lr: 0.0012437210486929107
epoch 35 training time: 15.184
---------------
2023-09-11 19:46:06.819963
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03649	Per Sample Data Time 0.02900	Per Sample DNN Time 0.00748	Train Loss 0.0044	
start validation
acc: 0.867299
AUC: 0.937738
Avg Precision: 0.346589
Avg Recall: 1.000000
d_prime: 2.172316
train_loss: 0.013746
valid_loss: 0.970254
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0012437210486929107
Epoch-36 lr: 0.0012437210486929107
epoch 36 training time: 15.077
---------------
2023-09-11 19:46:21.896679
current #epochs=37, #steps=1440
start validation
[I 2023-09-11 19:46:37,021] Trial 77 finished with value: 0.8672985781990521 and parameters: {'warmup': 'False', 'num_epochs': 37, 'batch_size': 48, 'lr-adaptschedule': 'True', 'lr': 0.0022250688728196904, 'head-lr': 1, 'lr-scheduler-start': 8, 'lr-scheduler-step': 8, 'lr-scheduler-decay': 0.864659030324723}. Best is trial 75 with value: 0.8862559241706162.
acc: 0.857820
AUC: 0.930020
Avg Precision: 0.338887
Avg Recall: 1.000000
d_prime: 2.087294
train_loss: 0.026412
valid_loss: 0.996057
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0012437210486929107
Epoch-37 lr: 0.0012437210486929107
epoch 37 training time: 15.111
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f866701e1c0>
The learning rate scheduler starts at 8 epoch with decay rate of 0.850 every 8 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 19:46:37.059349
current #epochs=1, #steps=0
start validation
acc: 0.857820
AUC: 0.927059
Avg Precision: 0.322360
Avg Recall: 1.000000
d_prime: 2.056591
train_loss: 0.022057
valid_loss: 0.992609
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0017146336642954586
Epoch-1 lr: 0.0034292673285909172
epoch 1 training time: 17.338
---------------
2023-09-11 19:46:54.397711
current #epochs=2, #steps=40
start validation
acc: 0.834123
AUC: 0.922572
Avg Precision: 0.329881
Avg Recall: 1.000000
d_prime: 2.011844
train_loss: 0.034160
valid_loss: 1.012951
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0017146336642954586
Epoch-2 lr: 0.0034292673285909172
epoch 2 training time: 15.184
---------------
2023-09-11 19:47:09.582109
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00704	Per Sample Data Time 0.00143	Per Sample DNN Time 0.00561	Train Loss 0.0202	
start validation
acc: 0.857820
AUC: 0.926350
Avg Precision: 0.333686
Avg Recall: 1.000000
d_prime: 2.049388
train_loss: 0.030950
valid_loss: 0.971171
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0017146336642954586
Epoch-3 lr: 0.0034292673285909172
epoch 3 training time: 15.076
---------------
2023-09-11 19:47:24.658265
current #epochs=4, #steps=120
start validation
acc: 0.834123
AUC: 0.922462
Avg Precision: 0.329532
Avg Recall: 1.000000
d_prime: 2.010766
train_loss: 0.031852
valid_loss: 1.000206
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0017146336642954586
Epoch-4 lr: 0.0034292673285909172
epoch 4 training time: 15.167
---------------
2023-09-11 19:47:39.825189
current #epochs=5, #steps=160
start validation
acc: 0.834123
AUC: 0.918500
Avg Precision: 0.324230
Avg Recall: 1.000000
d_prime: 1.972906
train_loss: 0.018311
valid_loss: 0.992400
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0017146336642954586
Epoch-5 lr: 0.0034292673285909172
epoch 5 training time: 15.069
---------------
2023-09-11 19:47:54.893916
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03944	Per Sample Data Time 0.02924	Per Sample DNN Time 0.01020	Train Loss 0.0005	
start validation
acc: 0.843602
AUC: 0.927887
Avg Precision: 0.336902
Avg Recall: 1.000000
d_prime: 2.065079
train_loss: 0.021419
valid_loss: 0.986247
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0017146336642954586
Epoch-6 lr: 0.0034292673285909172
epoch 6 training time: 15.299
---------------
2023-09-11 19:48:10.193438
current #epochs=7, #steps=240
start validation
acc: 0.857820
AUC: 0.939000
Avg Precision: 0.330470
Avg Recall: 1.000000
d_prime: 2.186983
train_loss: 0.025790
valid_loss: 0.988761
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0017146336642954586
Epoch-7 lr: 0.0034292673285909172
epoch 7 training time: 15.176
---------------
2023-09-11 19:48:25.369379
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00566	Train Loss 0.0403	
start validation
acc: 0.857820
AUC: 0.940787
Avg Precision: 0.340963
Avg Recall: 1.000000
d_prime: 2.208177
train_loss: 0.046296
valid_loss: 0.986629
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0014578158087872242
Epoch-8 lr: 0.0029156316175744483
epoch 8 training time: 15.135
---------------
2023-09-11 19:48:40.504610
current #epochs=9, #steps=320
start validation
acc: 0.853081
AUC: 0.939658
Avg Precision: 0.343447
Avg Recall: 1.000000
d_prime: 2.194732
train_loss: 0.021640
valid_loss: 0.994849
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0014578158087872242
Epoch-9 lr: 0.0029156316175744483
epoch 9 training time: 15.482
---------------
2023-09-11 19:48:55.986383
current #epochs=10, #steps=360
start validation
acc: 0.853081
AUC: 0.927584
Avg Precision: 0.332970
Avg Recall: 1.000000
d_prime: 2.061970
train_loss: 0.018107
valid_loss: 0.970193
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0014578158087872242
Epoch-10 lr: 0.0029156316175744483
epoch 10 training time: 15.187
---------------
2023-09-11 19:49:11.173955
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03814	Per Sample Data Time 0.03110	Per Sample DNN Time 0.00704	Train Loss 0.0055	
start validation
acc: 0.857820
AUC: 0.940592
Avg Precision: 0.346929
Avg Recall: 1.000000
d_prime: 2.205838
train_loss: 0.020315
valid_loss: 0.983513
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0014578158087872242
Epoch-11 lr: 0.0029156316175744483
epoch 11 training time: 15.204
---------------
2023-09-11 19:49:26.377829
current #epochs=12, #steps=440
start validation
acc: 0.872038
AUC: 0.941813
Avg Precision: 0.349733
Avg Recall: 1.000000
d_prime: 2.220569
train_loss: 0.018008
valid_loss: 0.957269
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0014578158087872242
Epoch-12 lr: 0.0029156316175744483
epoch 12 training time: 17.058
---------------
2023-09-11 19:49:43.436642
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00570	Train Loss 0.0148	
start validation
acc: 0.857820
AUC: 0.938211
Avg Precision: 0.372087
Avg Recall: 1.000000
d_prime: 2.177784
train_loss: 0.014118
valid_loss: 0.984535
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0014578158087872242
Epoch-13 lr: 0.0029156316175744483
epoch 13 training time: 15.205
---------------
2023-09-11 19:49:58.641549
current #epochs=14, #steps=520
start validation
acc: 0.848341
AUC: 0.933342
Avg Precision: 0.326173
Avg Recall: 1.000000
d_prime: 2.122948
train_loss: 0.019896
valid_loss: 0.988090
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0014578158087872242
Epoch-14 lr: 0.0029156316175744483
epoch 14 training time: 15.365
---------------
2023-09-11 19:50:14.006959
current #epochs=15, #steps=560
start validation
acc: 0.853081
AUC: 0.935313
Avg Precision: 0.321470
Avg Recall: 1.000000
d_prime: 2.144760
train_loss: 0.024298
valid_loss: 0.976701
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0014578158087872242
Epoch-15 lr: 0.0029156316175744483
epoch 15 training time: 16.152
---------------
2023-09-11 19:50:30.159237
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.04045	Per Sample Data Time 0.02912	Per Sample DNN Time 0.01133	Train Loss 0.0345	
start validation
acc: 0.862559
AUC: 0.936689
Avg Precision: 0.347674
Avg Recall: 1.000000
d_prime: 2.160298
train_loss: 0.016663
valid_loss: 0.995019
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.001239464135461963
Epoch-16 lr: 0.002478928270923926
epoch 16 training time: 15.292
---------------
2023-09-11 19:50:45.451156
current #epochs=17, #steps=640
start validation
acc: 0.853081
AUC: 0.932594
Avg Precision: 0.335052
Avg Recall: 1.000000
d_prime: 2.114804
train_loss: 0.023543
valid_loss: 0.985188
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.001239464135461963
Epoch-17 lr: 0.002478928270923926
epoch 17 training time: 15.188
---------------
2023-09-11 19:51:00.639290
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00563	Train Loss 0.0188	
start validation
acc: 0.848341
AUC: 0.932737
Avg Precision: 0.328325
Avg Recall: 1.000000
d_prime: 2.116360
train_loss: 0.024101
valid_loss: 0.980312
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001239464135461963
Epoch-18 lr: 0.002478928270923926
epoch 18 training time: 15.200
---------------
2023-09-11 19:51:15.839206
current #epochs=19, #steps=720
start validation
acc: 0.829384
AUC: 0.930647
Avg Precision: 0.323832
Avg Recall: 1.000000
d_prime: 2.093920
train_loss: 0.012606
valid_loss: 0.994312
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.001239464135461963
Epoch-19 lr: 0.002478928270923926
epoch 19 training time: 15.182
---------------
2023-09-11 19:51:31.021560
current #epochs=20, #steps=760
start validation
acc: 0.848341
AUC: 0.929060
Avg Precision: 0.321474
Avg Recall: 1.000000
d_prime: 2.077238
train_loss: 0.025217
valid_loss: 0.988426
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.001239464135461963
Epoch-20 lr: 0.002478928270923926
epoch 20 training time: 15.045
---------------
2023-09-11 19:51:46.065999
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03788	Per Sample Data Time 0.03048	Per Sample DNN Time 0.00740	Train Loss 0.0519	
start validation
acc: 0.848341
AUC: 0.927176
Avg Precision: 0.343724
Avg Recall: 1.000000
d_prime: 2.057789
train_loss: 0.014505
valid_loss: 1.002056
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.001239464135461963
Epoch-21 lr: 0.002478928270923926
epoch 21 training time: 15.203
---------------
2023-09-11 19:52:01.269684
current #epochs=22, #steps=840
start validation
acc: 0.848341
AUC: 0.932291
Avg Precision: 0.347712
Avg Recall: 1.000000
d_prime: 2.111524
train_loss: 0.017459
valid_loss: 0.984931
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.001239464135461963
Epoch-22 lr: 0.002478928270923926
epoch 22 training time: 15.205
---------------
2023-09-11 19:52:16.474387
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00563	Train Loss 0.0172	
start validation
acc: 0.857820
AUC: 0.934524
Avg Precision: 0.366737
Avg Recall: 1.000000
d_prime: 2.135970
train_loss: 0.014294
valid_loss: 0.992280
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.001239464135461963
Epoch-23 lr: 0.002478928270923926
epoch 23 training time: 15.132
---------------
2023-09-11 19:52:31.606253
current #epochs=24, #steps=920
start validation
acc: 0.824645
AUC: 0.940238
Avg Precision: 0.352284
Avg Recall: 1.000000
d_prime: 2.201607
train_loss: 0.017428
valid_loss: 0.982747
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0010538171789853997
Epoch-24 lr: 0.0021076343579707994
epoch 24 training time: 15.115
---------------
2023-09-11 19:52:46.721535
current #epochs=25, #steps=960
start validation
acc: 0.843602
AUC: 0.933462
Avg Precision: 0.355322
Avg Recall: 1.000000
d_prime: 2.124261
train_loss: 0.020519
valid_loss: 0.990562
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0010538171789853997
Epoch-25 lr: 0.0021076343579707994
epoch 25 training time: 15.263
---------------
2023-09-11 19:53:01.984406
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03673	Per Sample Data Time 0.02868	Per Sample DNN Time 0.00805	Train Loss 0.0027	
start validation
acc: 0.853081
AUC: 0.930799
Avg Precision: 0.323161
Avg Recall: 1.000000
d_prime: 2.095535
train_loss: 0.028152
valid_loss: 0.990014
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0010538171789853997
Epoch-26 lr: 0.0021076343579707994
epoch 26 training time: 15.098
---------------
2023-09-11 19:53:17.082368
current #epochs=27, #steps=1040
start validation
acc: 0.838863
AUC: 0.931660
Avg Precision: 0.310799
Avg Recall: 1.000000
d_prime: 2.104732
train_loss: 0.022625
valid_loss: 0.983668
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0010538171789853997
Epoch-27 lr: 0.0021076343579707994
epoch 27 training time: 15.086
---------------
2023-09-11 19:53:32.167784
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00725	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00572	Train Loss 0.0215	
start validation
acc: 0.857820
AUC: 0.926886
Avg Precision: 0.302185
Avg Recall: 1.000000
d_prime: 2.054826
train_loss: 0.022588
valid_loss: 0.992648
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0010538171789853997
Epoch-28 lr: 0.0021076343579707994
epoch 28 training time: 16.451
---------------
2023-09-11 19:53:48.618584
current #epochs=29, #steps=1120
start validation
acc: 0.872038
AUC: 0.927890
Avg Precision: 0.337163
Avg Recall: 1.000000
d_prime: 2.065115
train_loss: 0.017410
valid_loss: 0.989144
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0010538171789853997
Epoch-29 lr: 0.0021076343579707994
epoch 29 training time: 15.183
---------------
2023-09-11 19:54:03.802204
current #epochs=30, #steps=1160
start validation
acc: 0.857820
AUC: 0.926638
Avg Precision: 0.328253
Avg Recall: 1.000000
d_prime: 2.052312
train_loss: 0.013657
valid_loss: 1.008932
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0010538171789853997
Epoch-30 lr: 0.0021076343579707994
epoch 30 training time: 15.090
---------------
2023-09-11 19:54:18.891862
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03887	Per Sample Data Time 0.02775	Per Sample DNN Time 0.01112	Train Loss 0.0012	
start validation
acc: 0.848341
AUC: 0.926868
Avg Precision: 0.342565
Avg Recall: 1.000000
d_prime: 2.054651
train_loss: 0.015233
valid_loss: 1.006554
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0010538171789853997
Epoch-31 lr: 0.0021076343579707994
epoch 31 training time: 15.175
---------------
2023-09-11 19:54:34.067205
current #epochs=32, #steps=1240
start validation
acc: 0.829384
AUC: 0.923754
Avg Precision: 0.360195
Avg Recall: 1.000000
d_prime: 2.023431
train_loss: 0.024483
valid_loss: 1.006120
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0008959764263859382
Epoch-32 lr: 0.0017919528527718764
epoch 32 training time: 16.142
---------------
2023-09-11 19:54:50.208953
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00569	Train Loss 0.0135	
start validation
acc: 0.834123
AUC: 0.928649
Avg Precision: 0.347694
Avg Recall: 1.000000
d_prime: 2.072959
train_loss: 0.018777
valid_loss: 1.008499
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0008959764263859382
Epoch-33 lr: 0.0017919528527718764
epoch 33 training time: 16.884
---------------
2023-09-11 19:55:07.093096
current #epochs=34, #steps=1320
start validation
acc: 0.834123
AUC: 0.931218
Avg Precision: 0.347365
Avg Recall: 1.000000
d_prime: 2.100004
train_loss: 0.010643
valid_loss: 1.002978
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0008959764263859382
Epoch-34 lr: 0.0017919528527718764
epoch 34 training time: 16.696
---------------
2023-09-11 19:55:23.789295
current #epochs=35, #steps=1360
start validation
acc: 0.838863
AUC: 0.930523
Avg Precision: 0.353966
Avg Recall: 1.000000
d_prime: 2.092613
train_loss: 0.018083
valid_loss: 1.004075
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0008959764263859382
Epoch-35 lr: 0.0017919528527718764
epoch 35 training time: 15.164
---------------
2023-09-11 19:55:38.953497
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03700	Per Sample Data Time 0.02916	Per Sample DNN Time 0.00784	Train Loss 0.0183	
start validation
acc: 0.848341
AUC: 0.929079
Avg Precision: 0.344894
Avg Recall: 1.000000
d_prime: 2.077436
train_loss: 0.013957
valid_loss: 1.006212
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0008959764263859382
Epoch-36 lr: 0.0017919528527718764
epoch 36 training time: 15.191
---------------
2023-09-11 19:55:54.144095
current #epochs=37, #steps=1440
start validation
acc: 0.838863
AUC: 0.931027
Avg Precision: 0.349002
Avg Recall: 1.000000
d_prime: 2.097967
train_loss: 0.021793
valid_loss: 0.992034
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0008959764263859382
Epoch-37 lr: 0.0017919528527718764
epoch 37 training time: 16.580
---------------
2023-09-11 19:56:10.724457
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00563	Train Loss 0.0138	
start validation
acc: 0.857820
AUC: 0.923548
Avg Precision: 0.321825
Avg Recall: 1.000000
d_prime: 2.021405
train_loss: 0.012073
valid_loss: 0.979393
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0008959764263859382
Epoch-38 lr: 0.0017919528527718764
epoch 38 training time: 16.099
---------------
2023-09-11 19:56:26.823363
current #epochs=39, #steps=1520
start validation
acc: 0.834123
AUC: 0.923669
Avg Precision: 0.331318
Avg Recall: 1.000000
d_prime: 2.022595
train_loss: 0.019630
valid_loss: 0.993475
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0008959764263859382
Epoch-39 lr: 0.0017919528527718764
epoch 39 training time: 15.020
---------------
2023-09-11 19:56:41.843432
current #epochs=40, #steps=1560
start validation
[I 2023-09-11 19:56:57,107] Trial 78 finished with value: 0.8720379146919431 and parameters: {'warmup': 'False', 'num_epochs': 40, 'batch_size': 51, 'lr-adaptschedule': 'True', 'lr': 0.0017146336642954586, 'head-lr': 2, 'lr-scheduler-start': 8, 'lr-scheduler-step': 8, 'lr-scheduler-decay': 0.8502199852621226}. Best is trial 75 with value: 0.8862559241706162.
acc: 0.838863
AUC: 0.921047
Avg Precision: 0.327911
Avg Recall: 1.000000
d_prime: 1.997077
train_loss: 0.015242
valid_loss: 1.003378
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0007617770640370616
Epoch-40 lr: 0.0015235541280741232
epoch 40 training time: 15.251
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f8667030220>
The learning rate scheduler starts at 8 epoch with decay rate of 0.858 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 19:56:57.147059
current #epochs=1, #steps=0
start validation
acc: 0.815166
AUC: 0.919030
Avg Precision: 0.333905
Avg Recall: 1.000000
d_prime: 1.977889
train_loss: 0.015265
valid_loss: 0.988567
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.001687384668725483
Epoch-1 lr: 0.003374769337450966
epoch 1 training time: 18.128
---------------
2023-09-11 19:57:15.275477
current #epochs=2, #steps=40
start validation
acc: 0.834123
AUC: 0.917972
Avg Precision: 0.360728
Avg Recall: 1.000000
d_prime: 1.967964
train_loss: 0.027203
valid_loss: 1.002147
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.001687384668725483
Epoch-2 lr: 0.003374769337450966
epoch 2 training time: 17.064
---------------
2023-09-11 19:57:32.339620
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00572	Train Loss 0.0288	
start validation
acc: 0.824645
AUC: 0.925996
Avg Precision: 0.337893
Avg Recall: 1.000000
d_prime: 2.045808
train_loss: 0.025517
valid_loss: 0.985985
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.001687384668725483
Epoch-3 lr: 0.003374769337450966
epoch 3 training time: 15.099
---------------
2023-09-11 19:57:47.438920
current #epochs=4, #steps=120
start validation
acc: 0.843602
AUC: 0.931533
Avg Precision: 0.371562
Avg Recall: 1.000000
d_prime: 2.103371
train_loss: 0.031884
valid_loss: 0.980598
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.001687384668725483
Epoch-4 lr: 0.003374769337450966
epoch 4 training time: 17.221
---------------
2023-09-11 19:58:04.659374
current #epochs=5, #steps=160
start validation
acc: 0.810427
AUC: 0.934086
Avg Precision: 0.367541
Avg Recall: 1.000000
d_prime: 2.131120
train_loss: 0.029199
valid_loss: 0.999747
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.001687384668725483
Epoch-5 lr: 0.003374769337450966
epoch 5 training time: 15.289
---------------
2023-09-11 19:58:19.948219
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03653	Per Sample Data Time 0.02804	Per Sample DNN Time 0.00849	Train Loss 0.0201	
start validation
acc: 0.815166
AUC: 0.913860
Avg Precision: 0.351530
Avg Recall: 1.000000
d_prime: 1.930278
train_loss: 0.031732
valid_loss: 1.030245
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.001687384668725483
Epoch-6 lr: 0.003374769337450966
epoch 6 training time: 15.064
---------------
2023-09-11 19:58:35.012060
current #epochs=7, #steps=240
start validation
acc: 0.857820
AUC: 0.936565
Avg Precision: 0.355393
Avg Recall: 1.000000
d_prime: 2.158890
train_loss: 0.026439
valid_loss: 0.999862
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.001687384668725483
Epoch-7 lr: 0.003374769337450966
epoch 7 training time: 17.197
---------------
2023-09-11 19:58:52.208784
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00730	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00576	Train Loss 0.0269	
start validation
acc: 0.834123
AUC: 0.923563
Avg Precision: 0.353998
Avg Recall: 1.000000
d_prime: 2.021554
train_loss: 0.029645
valid_loss: 1.000900
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0014471608387576133
Epoch-8 lr: 0.0028943216775152267
epoch 8 training time: 15.299
---------------
2023-09-11 19:59:07.508013
current #epochs=9, #steps=320
start validation
acc: 0.843602
AUC: 0.924194
Avg Precision: 0.346375
Avg Recall: 1.000000
d_prime: 2.027781
train_loss: 0.020529
valid_loss: 1.011778
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0014471608387576133
Epoch-9 lr: 0.0028943216775152267
epoch 9 training time: 15.198
---------------
2023-09-11 19:59:22.706203
current #epochs=10, #steps=360
start validation
acc: 0.834123
AUC: 0.921072
Avg Precision: 0.316443
Avg Recall: 1.000000
d_prime: 1.997317
train_loss: 0.017200
valid_loss: 1.007981
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0014471608387576133
Epoch-10 lr: 0.0028943216775152267
epoch 10 training time: 15.167
---------------
2023-09-11 19:59:37.873755
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.04127	Per Sample Data Time 0.03021	Per Sample DNN Time 0.01105	Train Loss 0.0073	
start validation
acc: 0.843602
AUC: 0.921298
Avg Precision: 0.325263
Avg Recall: 1.000000
d_prime: 1.999497
train_loss: 0.014963
valid_loss: 1.012366
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0014471608387576133
Epoch-11 lr: 0.0028943216775152267
epoch 11 training time: 15.270
---------------
2023-09-11 19:59:53.143446
current #epochs=12, #steps=440
start validation
acc: 0.843602
AUC: 0.911469
Avg Precision: 0.320961
Avg Recall: 1.000000
d_prime: 1.908990
train_loss: 0.016368
valid_loss: 1.015371
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0014471608387576133
Epoch-12 lr: 0.0028943216775152267
epoch 12 training time: 15.089
---------------
2023-09-11 20:00:08.232202
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00563	Train Loss 0.0265	
start validation
acc: 0.876777
AUC: 0.923477
Avg Precision: 0.353994
Avg Recall: 1.000000
d_prime: 2.020707
train_loss: 0.021188
valid_loss: 0.977774
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0014471608387576133
Epoch-13 lr: 0.0028943216775152267
epoch 13 training time: 17.058
---------------
2023-09-11 20:00:25.290105
current #epochs=14, #steps=520
start validation
acc: 0.834123
AUC: 0.917677
Avg Precision: 0.337821
Avg Recall: 1.000000
d_prime: 1.965209
train_loss: 0.018800
valid_loss: 1.016732
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0014471608387576133
Epoch-14 lr: 0.0028943216775152267
epoch 14 training time: 15.372
---------------
2023-09-11 20:00:40.662347
current #epochs=15, #steps=560
start validation
acc: 0.838863
AUC: 0.923406
Avg Precision: 0.354773
Avg Recall: 1.000000
d_prime: 2.020009
train_loss: 0.018657
valid_loss: 1.012789
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0014471608387576133
Epoch-15 lr: 0.0028943216775152267
epoch 15 training time: 14.961
---------------
2023-09-11 20:00:55.623334
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03899	Per Sample Data Time 0.02977	Per Sample DNN Time 0.00922	Train Loss 0.0041	
start validation
acc: 0.829384
AUC: 0.918333
Avg Precision: 0.348291
Avg Recall: 1.000000
d_prime: 1.971340
train_loss: 0.030726
valid_loss: 1.009330
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0014471608387576133
Epoch-16 lr: 0.0028943216775152267
epoch 16 training time: 15.221
---------------
2023-09-11 20:01:10.844705
current #epochs=17, #steps=640
start validation
acc: 0.810427
AUC: 0.916427
Avg Precision: 0.357835
Avg Recall: 1.000000
d_prime: 1.953639
train_loss: 0.028427
valid_loss: 1.001158
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0012411363763400126
Epoch-17 lr: 0.0024822727526800253
epoch 17 training time: 15.027
---------------
2023-09-11 20:01:25.871874
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00565	Train Loss 0.0374	
start validation
acc: 0.829384
AUC: 0.916727
Avg Precision: 0.331608
Avg Recall: 1.000000
d_prime: 1.956402
train_loss: 0.036451
valid_loss: 0.999136
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0012411363763400126
Epoch-18 lr: 0.0024822727526800253
epoch 18 training time: 15.126
---------------
2023-09-11 20:01:40.997683
current #epochs=19, #steps=720
start validation
acc: 0.843602
AUC: 0.930828
Avg Precision: 0.328107
Avg Recall: 1.000000
d_prime: 2.095848
train_loss: 0.021050
valid_loss: 0.972745
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0012411363763400126
Epoch-19 lr: 0.0024822727526800253
epoch 19 training time: 15.044
---------------
2023-09-11 20:01:56.041023
current #epochs=20, #steps=760
start validation
acc: 0.843602
AUC: 0.930928
Avg Precision: 0.337913
Avg Recall: 1.000000
d_prime: 2.096909
train_loss: 0.020690
valid_loss: 0.973599
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0012411363763400126
Epoch-20 lr: 0.0024822727526800253
epoch 20 training time: 15.209
---------------
2023-09-11 20:02:11.250173
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03736	Per Sample Data Time 0.03006	Per Sample DNN Time 0.00729	Train Loss 0.0208	
start validation
acc: 0.810427
AUC: 0.920307
Avg Precision: 0.331162
Avg Recall: 1.000000
d_prime: 1.989999
train_loss: 0.019510
valid_loss: 0.999938
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0012411363763400126
Epoch-21 lr: 0.0024822727526800253
epoch 21 training time: 15.009
---------------
2023-09-11 20:02:26.259634
current #epochs=22, #steps=840
start validation
acc: 0.819905
AUC: 0.924014
Avg Precision: 0.354386
Avg Recall: 1.000000
d_prime: 2.026002
train_loss: 0.014834
valid_loss: 1.014646
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0012411363763400126
Epoch-22 lr: 0.0024822727526800253
epoch 22 training time: 15.102
---------------
2023-09-11 20:02:41.362026
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00727	Per Sample Data Time 0.00157	Per Sample DNN Time 0.00570	Train Loss 0.0187	
start validation
acc: 0.819905
AUC: 0.927791
Avg Precision: 0.365420
Avg Recall: 1.000000
d_prime: 2.064099
train_loss: 0.020235
valid_loss: 1.017889
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0012411363763400126
Epoch-23 lr: 0.0024822727526800253
epoch 23 training time: 15.282
---------------
2023-09-11 20:02:56.644208
current #epochs=24, #steps=920
start validation
acc: 0.815166
AUC: 0.923729
Avg Precision: 0.344043
Avg Recall: 1.000000
d_prime: 2.023185
train_loss: 0.030569
valid_loss: 0.996754
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0012411363763400126
Epoch-24 lr: 0.0024822727526800253
epoch 24 training time: 15.177
---------------
2023-09-11 20:03:11.820729
current #epochs=25, #steps=960
start validation
acc: 0.834123
AUC: 0.922331
Avg Precision: 0.363105
Avg Recall: 1.000000
d_prime: 2.009491
train_loss: 0.020328
valid_loss: 1.017757
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0012411363763400126
Epoch-25 lr: 0.0024822727526800253
epoch 25 training time: 15.763
---------------
2023-09-11 20:03:27.583857
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03948	Per Sample Data Time 0.02861	Per Sample DNN Time 0.01088	Train Loss 0.0487	
start validation
acc: 0.819905
AUC: 0.919674
Avg Precision: 0.335595
Avg Recall: 1.000000
d_prime: 1.983978
train_loss: 0.014298
valid_loss: 1.017592
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0010644425024635593
Epoch-26 lr: 0.0021288850049271187
epoch 26 training time: 15.076
---------------
2023-09-11 20:03:42.659582
current #epochs=27, #steps=1040
start validation
acc: 0.834123
AUC: 0.928020
Avg Precision: 0.353465
Avg Recall: 1.000000
d_prime: 2.066455
train_loss: 0.019139
valid_loss: 0.995277
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0010644425024635593
Epoch-27 lr: 0.0021288850049271187
epoch 27 training time: 15.854
---------------
2023-09-11 20:03:58.513783
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00563	Train Loss 0.0170	
start validation
acc: 0.834123
AUC: 0.931797
Avg Precision: 0.366890
Avg Recall: 1.000000
d_prime: 2.106206
train_loss: 0.012427
valid_loss: 0.999131
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0010644425024635593
Epoch-28 lr: 0.0021288850049271187
epoch 28 training time: 15.142
---------------
2023-09-11 20:04:13.656371
current #epochs=29, #steps=1120
start validation
acc: 0.819905
AUC: 0.932158
Avg Precision: 0.364633
Avg Recall: 1.000000
d_prime: 2.110084
train_loss: 0.011203
valid_loss: 0.980497
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0010644425024635593
Epoch-29 lr: 0.0021288850049271187
epoch 29 training time: 15.305
---------------
2023-09-11 20:04:28.961067
current #epochs=30, #steps=1160
start validation
acc: 0.796209
AUC: 0.931165
Avg Precision: 0.377795
Avg Recall: 1.000000
d_prime: 2.099432
train_loss: 0.016748
valid_loss: 0.979175
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0010644425024635593
Epoch-30 lr: 0.0021288850049271187
epoch 30 training time: 15.097
---------------
2023-09-11 20:04:44.058113
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03594	Per Sample Data Time 0.02875	Per Sample DNN Time 0.00719	Train Loss 0.0112	
start validation
acc: 0.824645
AUC: 0.936504
Avg Precision: 0.369163
Avg Recall: 1.000000
d_prime: 2.158186
train_loss: 0.016018
valid_loss: 0.995252
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0010644425024635593
Epoch-31 lr: 0.0021288850049271187
epoch 31 training time: 15.081
---------------
2023-09-11 20:04:59.139273
current #epochs=32, #steps=1240
start validation
acc: 0.834123
AUC: 0.938804
Avg Precision: 0.379183
Avg Recall: 1.000000
d_prime: 2.184694
train_loss: 0.017919
valid_loss: 0.989005
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0010644425024635593
Epoch-32 lr: 0.0021288850049271187
epoch 32 training time: 15.228
---------------
2023-09-11 20:05:14.367049
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00567	Train Loss 0.0178	
start validation
acc: 0.800948
AUC: 0.928695
Avg Precision: 0.369957
Avg Recall: 1.000000
d_prime: 2.073435
train_loss: 0.017936
valid_loss: 0.992273
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0010644425024635593
Epoch-33 lr: 0.0021288850049271187
epoch 33 training time: 15.112
---------------
2023-09-11 20:05:29.478749
current #epochs=34, #steps=1320
start validation
acc: 0.824645
AUC: 0.934943
Avg Precision: 0.360222
Avg Recall: 1.000000
d_prime: 2.140631
train_loss: 0.017995
valid_loss: 0.978074
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0010644425024635593
Epoch-34 lr: 0.0021288850049271187
epoch 34 training time: 16.932
---------------
2023-09-11 20:05:46.411144
current #epochs=35, #steps=1360
start validation
acc: 0.838863
AUC: 0.934927
Avg Precision: 0.360344
Avg Recall: 1.000000
d_prime: 2.140455
train_loss: 0.022738
valid_loss: 0.970497
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0009129035798564701
Epoch-35 lr: 0.0018258071597129402
epoch 35 training time: 15.193
---------------
2023-09-11 20:06:01.604097
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03686	Per Sample Data Time 0.02841	Per Sample DNN Time 0.00845	Train Loss 0.0178	
start validation
acc: 0.819905
AUC: 0.930789
Avg Precision: 0.362538
Avg Recall: 1.000000
d_prime: 2.095433
train_loss: 0.018348
valid_loss: 0.981158
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0009129035798564701
Epoch-36 lr: 0.0018258071597129402
epoch 36 training time: 15.214
---------------
2023-09-11 20:06:16.818574
current #epochs=37, #steps=1440
start validation
acc: 0.824645
AUC: 0.919790
Avg Precision: 0.335093
Avg Recall: 1.000000
d_prime: 1.985071
train_loss: 0.018440
valid_loss: 0.979575
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0009129035798564701
Epoch-37 lr: 0.0018258071597129402
epoch 37 training time: 15.099
---------------
2023-09-11 20:06:31.917279
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00722	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00571	Train Loss 0.0314	
start validation
acc: 0.819905
AUC: 0.913280
Avg Precision: 0.304204
Avg Recall: 1.000000
d_prime: 1.925077
train_loss: 0.018165
valid_loss: 0.997445
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0009129035798564701
Epoch-38 lr: 0.0018258071597129402
epoch 38 training time: 15.120
---------------
2023-09-11 20:06:47.037980
current #epochs=39, #steps=1520
start validation
acc: 0.829384
AUC: 0.907842
Avg Precision: 0.350532
Avg Recall: 1.000000
d_prime: 1.877483
train_loss: 0.028678
valid_loss: 1.025689
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0009129035798564701
Epoch-39 lr: 0.0018258071597129402
epoch 39 training time: 15.132
---------------
2023-09-11 20:07:02.169305
current #epochs=40, #steps=1560
start validation
[I 2023-09-11 20:07:17,222] Trial 79 finished with value: 0.8767772511848341 and parameters: {'warmup': 'False', 'num_epochs': 40, 'batch_size': 51, 'lr-adaptschedule': 'True', 'lr': 0.001687384668725483, 'head-lr': 2, 'lr-scheduler-start': 8, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.8576354079657984}. Best is trial 75 with value: 0.8862559241706162.
acc: 0.819905
AUC: 0.916606
Avg Precision: 0.355049
Avg Recall: 1.000000
d_prime: 1.955291
train_loss: 0.014466
valid_loss: 1.016453
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0009129035798564701
Epoch-40 lr: 0.0018258071597129402
epoch 40 training time: 15.038
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f85b4070190>
The learning rate scheduler starts at 8 epoch with decay rate of 0.867 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 20:07:17.261955
current #epochs=1, #steps=0
start validation
acc: 0.838863
AUC: 0.918095
Avg Precision: 0.346618
Avg Recall: 1.000000
d_prime: 1.969114
train_loss: 0.026212
valid_loss: 1.014477
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0019096691484100964
Epoch-1 lr: 0.003819338296820193
epoch 1 training time: 17.578
---------------
2023-09-11 20:07:34.840590
current #epochs=2, #steps=40
start validation
acc: 0.834123
AUC: 0.916797
Avg Precision: 0.345420
Avg Recall: 1.000000
d_prime: 1.957054
train_loss: 0.020591
valid_loss: 0.993855
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0019096691484100964
Epoch-2 lr: 0.003819338296820193
epoch 2 training time: 15.368
---------------
2023-09-11 20:07:50.209182
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00704	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00555	Train Loss 0.0170	
start validation
acc: 0.853081
AUC: 0.927111
Avg Precision: 0.356830
Avg Recall: 1.000000
d_prime: 2.057123
train_loss: 0.013505
valid_loss: 0.979900
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0019096691484100964
Epoch-3 lr: 0.003819338296820193
epoch 3 training time: 17.089
---------------
2023-09-11 20:08:07.298393
current #epochs=4, #steps=120
start validation
acc: 0.838863
AUC: 0.924601
Avg Precision: 0.339324
Avg Recall: 1.000000
d_prime: 2.031824
train_loss: 0.018169
valid_loss: 0.983493
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0019096691484100964
Epoch-4 lr: 0.003819338296820193
epoch 4 training time: 15.068
---------------
2023-09-11 20:08:22.365913
current #epochs=5, #steps=160
start validation
acc: 0.824645
AUC: 0.924025
Avg Precision: 0.340449
Avg Recall: 1.000000
d_prime: 2.026110
train_loss: 0.034735
valid_loss: 1.006726
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0019096691484100964
Epoch-5 lr: 0.003819338296820193
epoch 5 training time: 15.527
---------------
2023-09-11 20:08:37.893275
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03820	Per Sample Data Time 0.02866	Per Sample DNN Time 0.00953	Train Loss 0.0026	
start validation
acc: 0.819905
AUC: 0.929875
Avg Precision: 0.368692
Avg Recall: 1.000000
d_prime: 2.085769
train_loss: 0.030126
valid_loss: 0.998182
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0019096691484100964
Epoch-6 lr: 0.003819338296820193
epoch 6 training time: 15.081
---------------
2023-09-11 20:08:52.974595
current #epochs=7, #steps=240
start validation
acc: 0.834123
AUC: 0.922394
Avg Precision: 0.371100
Avg Recall: 1.000000
d_prime: 2.010107
train_loss: 0.026370
valid_loss: 1.006249
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0019096691484100964
Epoch-7 lr: 0.003819338296820193
epoch 7 training time: 15.183
---------------
2023-09-11 20:09:08.157269
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00566	Train Loss 0.0207	
start validation
acc: 0.810427
AUC: 0.924570
Avg Precision: 0.347803
Avg Recall: 1.000000
d_prime: 2.031523
train_loss: 0.025952
valid_loss: 1.003556
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0016551594165320625
Epoch-8 lr: 0.003310318833064125
epoch 8 training time: 15.157
---------------
2023-09-11 20:09:23.314683
current #epochs=9, #steps=320
start validation
acc: 0.815166
AUC: 0.921107
Avg Precision: 0.358061
Avg Recall: 1.000000
d_prime: 1.997658
train_loss: 0.012806
valid_loss: 1.007194
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0016551594165320625
Epoch-9 lr: 0.003310318833064125
epoch 9 training time: 15.265
---------------
2023-09-11 20:09:38.579597
current #epochs=10, #steps=360
start validation
acc: 0.848341
AUC: 0.920835
Avg Precision: 0.339231
Avg Recall: 1.000000
d_prime: 1.995049
train_loss: 0.028891
valid_loss: 1.008001
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0016551594165320625
Epoch-10 lr: 0.003310318833064125
epoch 10 training time: 16.340
---------------
2023-09-11 20:09:54.919936
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03707	Per Sample Data Time 0.02807	Per Sample DNN Time 0.00899	Train Loss 0.0115	
start validation
acc: 0.829384
AUC: 0.921027
Avg Precision: 0.333710
Avg Recall: 1.000000
d_prime: 1.996890
train_loss: 0.021205
valid_loss: 1.002465
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0016551594165320625
Epoch-11 lr: 0.003310318833064125
epoch 11 training time: 15.158
---------------
2023-09-11 20:10:10.077898
current #epochs=12, #steps=440
start validation
acc: 0.853081
AUC: 0.923146
Avg Precision: 0.331489
Avg Recall: 1.000000
d_prime: 2.017450
train_loss: 0.021984
valid_loss: 1.011793
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0016551594165320625
Epoch-12 lr: 0.003310318833064125
epoch 12 training time: 15.128
---------------
2023-09-11 20:10:25.206043
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00567	Train Loss 0.0135	
start validation
acc: 0.819905
AUC: 0.920795
Avg Precision: 0.342540
Avg Recall: 1.000000
d_prime: 1.994663
train_loss: 0.013970
valid_loss: 1.015434
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0016551594165320625
Epoch-13 lr: 0.003310318833064125
epoch 13 training time: 15.244
---------------
2023-09-11 20:10:40.450350
current #epochs=14, #steps=520
start validation
acc: 0.838863
AUC: 0.914020
Avg Precision: 0.323430
Avg Recall: 1.000000
d_prime: 1.931720
train_loss: 0.024346
valid_loss: 1.024090
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0016551594165320625
Epoch-14 lr: 0.003310318833064125
epoch 14 training time: 15.057
---------------
2023-09-11 20:10:55.507759
current #epochs=15, #steps=560
start validation
acc: 0.824645
AUC: 0.923531
Avg Precision: 0.343598
Avg Recall: 1.000000
d_prime: 2.021237
train_loss: 0.026225
valid_loss: 1.013978
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0016551594165320625
Epoch-15 lr: 0.003310318833064125
epoch 15 training time: 15.414
---------------
2023-09-11 20:11:10.921216
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03819	Per Sample Data Time 0.03011	Per Sample DNN Time 0.00808	Train Loss 0.0042	
start validation
acc: 0.819905
AUC: 0.932893
Avg Precision: 0.330460
Avg Recall: 1.000000
d_prime: 2.118047
train_loss: 0.031418
valid_loss: 0.996677
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0016551594165320625
Epoch-16 lr: 0.003310318833064125
epoch 16 training time: 15.214
---------------
2023-09-11 20:11:26.135064
current #epochs=17, #steps=640
start validation
acc: 0.819905
AUC: 0.922891
Avg Precision: 0.346873
Avg Recall: 1.000000
d_prime: 2.014955
train_loss: 0.021645
valid_loss: 0.999665
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0014345692794040185
Epoch-17 lr: 0.002869138558808037
epoch 17 training time: 16.307
---------------
2023-09-11 20:11:42.441718
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00569	Train Loss 0.0462	
start validation
acc: 0.796209
AUC: 0.923906
Avg Precision: 0.353401
Avg Recall: 1.000000
d_prime: 2.024932
train_loss: 0.035900
valid_loss: 0.997648
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0014345692794040185
Epoch-18 lr: 0.002869138558808037
epoch 18 training time: 15.840
---------------
2023-09-11 20:11:58.281656
current #epochs=19, #steps=720
start validation
acc: 0.829384
AUC: 0.931525
Avg Precision: 0.361481
Avg Recall: 1.000000
d_prime: 2.103287
train_loss: 0.022101
valid_loss: 0.997110
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0014345692794040185
Epoch-19 lr: 0.002869138558808037
epoch 19 training time: 15.211
---------------
2023-09-11 20:12:13.492923
current #epochs=20, #steps=760
start validation
acc: 0.819905
AUC: 0.928797
Avg Precision: 0.344300
Avg Recall: 1.000000
d_prime: 2.074492
train_loss: 0.016614
valid_loss: 0.988262
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0014345692794040185
Epoch-20 lr: 0.002869138558808037
epoch 20 training time: 15.050
---------------
2023-09-11 20:12:28.542722
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03896	Per Sample Data Time 0.02979	Per Sample DNN Time 0.00917	Train Loss 0.0313	
start validation
acc: 0.829384
AUC: 0.927464
Avg Precision: 0.338669
Avg Recall: 1.000000
d_prime: 2.060733
train_loss: 0.021930
valid_loss: 0.985636
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0014345692794040185
Epoch-21 lr: 0.002869138558808037
epoch 21 training time: 15.169
---------------
2023-09-11 20:12:43.712071
current #epochs=22, #steps=840
start validation
acc: 0.834123
AUC: 0.928666
Avg Precision: 0.337954
Avg Recall: 1.000000
d_prime: 2.073133
train_loss: 0.024399
valid_loss: 0.993940
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0014345692794040185
Epoch-22 lr: 0.002869138558808037
epoch 22 training time: 15.086
---------------
2023-09-11 20:12:58.797937
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00565	Train Loss 0.0317	
start validation
acc: 0.862559
AUC: 0.935860
Avg Precision: 0.351068
Avg Recall: 1.000000
d_prime: 2.150900
train_loss: 0.030032
valid_loss: 0.974362
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0014345692794040185
Epoch-23 lr: 0.002869138558808037
epoch 23 training time: 17.106
---------------
2023-09-11 20:13:15.904279
current #epochs=24, #steps=920
start validation
acc: 0.819905
AUC: 0.936282
Avg Precision: 0.348965
Avg Recall: 1.000000
d_prime: 2.155673
train_loss: 0.018862
valid_loss: 0.985059
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0014345692794040185
Epoch-24 lr: 0.002869138558808037
epoch 24 training time: 15.372
---------------
2023-09-11 20:13:31.276613
current #epochs=25, #steps=960
start validation
acc: 0.848341
AUC: 0.932274
Avg Precision: 0.353080
Avg Recall: 1.000000
d_prime: 2.111337
train_loss: 0.016830
valid_loss: 0.989172
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0014345692794040185
Epoch-25 lr: 0.002869138558808037
epoch 25 training time: 15.236
---------------
2023-09-11 20:13:46.512333
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03827	Per Sample Data Time 0.02737	Per Sample DNN Time 0.01090	Train Loss 0.0240	
start validation
acc: 0.857820
AUC: 0.929943
Avg Precision: 0.351044
Avg Recall: 1.000000
d_prime: 2.086480
train_loss: 0.024928
valid_loss: 0.994207
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.001243378128326589
Epoch-26 lr: 0.002486756256653178
epoch 26 training time: 15.201
---------------
2023-09-11 20:14:01.713289
current #epochs=27, #steps=1040
start validation
acc: 0.834123
AUC: 0.927261
Avg Precision: 0.330237
Avg Recall: 1.000000
d_prime: 2.058663
train_loss: 0.018720
valid_loss: 0.988214
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.001243378128326589
Epoch-27 lr: 0.002486756256653178
epoch 27 training time: 15.207
---------------
2023-09-11 20:14:16.920396
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00566	Train Loss 0.0143	
start validation
acc: 0.848341
AUC: 0.931256
Avg Precision: 0.354166
Avg Recall: 1.000000
d_prime: 2.100410
train_loss: 0.019146
valid_loss: 1.000493
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.001243378128326589
Epoch-28 lr: 0.002486756256653178
epoch 28 training time: 15.811
---------------
2023-09-11 20:14:32.731831
current #epochs=29, #steps=1120
start validation
acc: 0.834123
AUC: 0.927873
Avg Precision: 0.344245
Avg Recall: 1.000000
d_prime: 2.064938
train_loss: 0.018570
valid_loss: 1.001654
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.001243378128326589
Epoch-29 lr: 0.002486756256653178
epoch 29 training time: 15.149
---------------
2023-09-11 20:14:47.880566
current #epochs=30, #steps=1160
start validation
acc: 0.838863
AUC: 0.925449
Avg Precision: 0.356953
Avg Recall: 1.000000
d_prime: 2.040304
train_loss: 0.017827
valid_loss: 1.003511
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.001243378128326589
Epoch-30 lr: 0.002486756256653178
epoch 30 training time: 16.604
---------------
2023-09-11 20:15:04.484904
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03597	Per Sample Data Time 0.02757	Per Sample DNN Time 0.00840	Train Loss 0.0051	
start validation
acc: 0.834123
AUC: 0.925078
Avg Precision: 0.356613
Avg Recall: 1.000000
d_prime: 2.036581
train_loss: 0.016824
valid_loss: 1.007272
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.001243378128326589
Epoch-31 lr: 0.002486756256653178
epoch 31 training time: 15.144
---------------
2023-09-11 20:15:19.628491
current #epochs=32, #steps=1240
start validation
acc: 0.829384
AUC: 0.923198
Avg Precision: 0.339152
Avg Recall: 1.000000
d_prime: 2.017964
train_loss: 0.022270
valid_loss: 0.992133
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.001243378128326589
Epoch-32 lr: 0.002486756256653178
epoch 32 training time: 15.092
---------------
2023-09-11 20:15:34.720776
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00566	Train Loss 0.0244	
start validation
acc: 0.829384
AUC: 0.920972
Avg Precision: 0.341981
Avg Recall: 1.000000
d_prime: 1.996362
train_loss: 0.020903
valid_loss: 1.018080
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.001243378128326589
Epoch-33 lr: 0.002486756256653178
epoch 33 training time: 15.242
---------------
2023-09-11 20:15:49.962330
current #epochs=34, #steps=1320
start validation
acc: 0.853081
AUC: 0.917337
Avg Precision: 0.369126
Avg Recall: 1.000000
d_prime: 1.962054
train_loss: 0.017763
valid_loss: 1.021570
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.001243378128326589
Epoch-34 lr: 0.002486756256653178
epoch 34 training time: 15.136
---------------
2023-09-11 20:16:05.098273
current #epochs=35, #steps=1360
start validation
acc: 0.824645
AUC: 0.926505
Avg Precision: 0.364612
Avg Recall: 1.000000
d_prime: 2.050957
train_loss: 0.014308
valid_loss: 0.995818
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.001077667835354178
Epoch-35 lr: 0.002155335670708356
epoch 35 training time: 15.129
---------------
2023-09-11 20:16:20.227605
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.04041	Per Sample Data Time 0.03012	Per Sample DNN Time 0.01029	Train Loss 0.0976	
start validation
[I 2023-09-11 20:16:35,779] Trial 80 finished with value: 0.8625592417061612 and parameters: {'warmup': 'False', 'num_epochs': 36, 'batch_size': 45, 'lr-adaptschedule': 'True', 'lr': 0.0019096691484100964, 'head-lr': 2, 'lr-scheduler-start': 8, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.8667257456141411}. Best is trial 75 with value: 0.8862559241706162.
acc: 0.819905
AUC: 0.930696
Avg Precision: 0.355388
Avg Recall: 1.000000
d_prime: 2.094444
train_loss: 0.027308
valid_loss: 0.997528
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.001077667835354178
Epoch-36 lr: 0.002155335670708356
epoch 36 training time: 15.537
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f86670c0be0>
The learning rate scheduler starts at 8 epoch with decay rate of 0.855 every 8 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 20:16:35.820227
current #epochs=1, #steps=0
start validation
acc: 0.805687
AUC: 0.918647
Avg Precision: 0.353275
Avg Recall: 1.000000
d_prime: 1.974283
train_loss: 0.017172
valid_loss: 1.017520
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0017340174930738424
Epoch-1 lr: 0.0052020524792215275
epoch 1 training time: 18.234
---------------
2023-09-11 20:16:54.054242
current #epochs=2, #steps=40
start validation
acc: 0.834123
AUC: 0.921436
Avg Precision: 0.338538
Avg Recall: 1.000000
d_prime: 2.000826
train_loss: 0.032125
valid_loss: 1.017161
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0017340174930738424
Epoch-2 lr: 0.0052020524792215275
epoch 2 training time: 17.024
---------------
2023-09-11 20:17:11.078763
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00728	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00574	Train Loss 0.0231	
start validation
acc: 0.819905
AUC: 0.930990
Avg Precision: 0.367390
Avg Recall: 1.000000
d_prime: 2.097571
train_loss: 0.025471
valid_loss: 1.015696
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0017340174930738424
Epoch-3 lr: 0.0052020524792215275
epoch 3 training time: 15.811
---------------
2023-09-11 20:17:26.890044
current #epochs=4, #steps=120
start validation
acc: 0.819905
AUC: 0.933279
Avg Precision: 0.351202
Avg Recall: 1.000000
d_prime: 2.122264
train_loss: 0.033902
valid_loss: 1.023010
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0017340174930738424
Epoch-4 lr: 0.0052020524792215275
epoch 4 training time: 15.197
---------------
2023-09-11 20:17:42.087516
current #epochs=5, #steps=160
start validation
acc: 0.848341
AUC: 0.933134
Avg Precision: 0.334306
Avg Recall: 1.000000
d_prime: 2.120681
train_loss: 0.024565
valid_loss: 0.984952
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0017340174930738424
Epoch-5 lr: 0.0052020524792215275
epoch 5 training time: 17.133
---------------
2023-09-11 20:17:59.220019
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03945	Per Sample Data Time 0.02918	Per Sample DNN Time 0.01028	Train Loss 0.0581	
start validation
acc: 0.848341
AUC: 0.941135
Avg Precision: 0.394424
Avg Recall: 1.000000
d_prime: 2.212357
train_loss: 0.031848
valid_loss: 0.990555
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0017340174930738424
Epoch-6 lr: 0.0052020524792215275
epoch 6 training time: 15.197
---------------
2023-09-11 20:18:14.417340
current #epochs=7, #steps=240
start validation
acc: 0.815166
AUC: 0.917818
Avg Precision: 0.348459
Avg Recall: 1.000000
d_prime: 1.966524
train_loss: 0.014153
valid_loss: 1.006597
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0017340174930738424
Epoch-7 lr: 0.0052020524792215275
epoch 7 training time: 15.179
---------------
2023-09-11 20:18:29.596749
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00571	Train Loss 0.0300	
start validation
acc: 0.819905
AUC: 0.922302
Avg Precision: 0.359966
Avg Recall: 1.000000
d_prime: 2.009213
train_loss: 0.028604
valid_loss: 1.007193
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0014823483924405194
Epoch-8 lr: 0.004447045177321559
epoch 8 training time: 15.232
---------------
2023-09-11 20:18:44.829368
current #epochs=9, #steps=320
start validation
acc: 0.853081
AUC: 0.928374
Avg Precision: 0.366419
Avg Recall: 1.000000
d_prime: 2.070104
train_loss: 0.024684
valid_loss: 1.002033
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0014823483924405194
Epoch-9 lr: 0.004447045177321559
epoch 9 training time: 18.034
---------------
2023-09-11 20:19:02.862825
current #epochs=10, #steps=360
start validation
acc: 0.824645
AUC: 0.926987
Avg Precision: 0.367363
Avg Recall: 1.000000
d_prime: 2.055860
train_loss: 0.023812
valid_loss: 0.992002
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0014823483924405194
Epoch-10 lr: 0.004447045177321559
epoch 10 training time: 15.072
---------------
2023-09-11 20:19:17.934702
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03636	Per Sample Data Time 0.02800	Per Sample DNN Time 0.00836	Train Loss 0.0058	
start validation
acc: 0.819905
AUC: 0.929197
Avg Precision: 0.371209
Avg Recall: 1.000000
d_prime: 2.078661
train_loss: 0.026973
valid_loss: 0.993374
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0014823483924405194
Epoch-11 lr: 0.004447045177321559
epoch 11 training time: 15.118
---------------
2023-09-11 20:19:33.052083
current #epochs=12, #steps=440
start validation
acc: 0.838863
AUC: 0.932676
Avg Precision: 0.378455
Avg Recall: 1.000000
d_prime: 2.115697
train_loss: 0.017190
valid_loss: 0.991251
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0014823483924405194
Epoch-12 lr: 0.004447045177321559
epoch 12 training time: 15.873
---------------
2023-09-11 20:19:48.925412
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00565	Train Loss 0.0232	
start validation
acc: 0.834123
AUC: 0.924355
Avg Precision: 0.370670
Avg Recall: 1.000000
d_prime: 2.029378
train_loss: 0.023201
valid_loss: 0.987692
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0014823483924405194
Epoch-13 lr: 0.004447045177321559
epoch 13 training time: 16.561
---------------
2023-09-11 20:20:05.485942
current #epochs=14, #steps=520
start validation
acc: 0.834123
AUC: 0.930179
Avg Precision: 0.369783
Avg Recall: 1.000000
d_prime: 2.088973
train_loss: 0.016630
valid_loss: 1.004533
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0014823483924405194
Epoch-14 lr: 0.004447045177321559
epoch 14 training time: 15.183
---------------
2023-09-11 20:20:20.669022
current #epochs=15, #steps=560
start validation
acc: 0.862559
AUC: 0.930034
Avg Precision: 0.358391
Avg Recall: 1.000000
d_prime: 2.087446
train_loss: 0.017035
valid_loss: 1.001313
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0014823483924405194
Epoch-15 lr: 0.004447045177321559
epoch 15 training time: 17.143
---------------
2023-09-11 20:20:37.812049
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.04133	Per Sample Data Time 0.02970	Per Sample DNN Time 0.01163	Train Loss 0.0029	
start validation
acc: 0.857820
AUC: 0.937990
Avg Precision: 0.367531
Avg Recall: 1.000000
d_prime: 2.175229
train_loss: 0.016794
valid_loss: 0.998360
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0012672056454723544
Epoch-16 lr: 0.0038016169364170635
epoch 16 training time: 15.409
---------------
2023-09-11 20:20:53.220965
current #epochs=17, #steps=640
start validation
acc: 0.834123
AUC: 0.937433
Avg Precision: 0.372636
Avg Recall: 1.000000
d_prime: 2.168800
train_loss: 0.020722
valid_loss: 0.993628
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0012672056454723544
Epoch-17 lr: 0.0038016169364170635
epoch 17 training time: 15.223
---------------
2023-09-11 20:21:08.443522
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00722	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00573	Train Loss 0.0139	
start validation
acc: 0.848341
AUC: 0.928132
Avg Precision: 0.339848
Avg Recall: 1.000000
d_prime: 2.067612
train_loss: 0.011297
valid_loss: 0.990099
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0012672056454723544
Epoch-18 lr: 0.0038016169364170635
epoch 18 training time: 16.191
---------------
2023-09-11 20:21:24.634247
current #epochs=19, #steps=720
start validation
acc: 0.848341
AUC: 0.925432
Avg Precision: 0.330686
Avg Recall: 1.000000
d_prime: 2.040128
train_loss: 0.014031
valid_loss: 0.986269
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0012672056454723544
Epoch-19 lr: 0.0038016169364170635
epoch 19 training time: 15.207
---------------
2023-09-11 20:21:39.841048
current #epochs=20, #steps=760
start validation
acc: 0.853081
AUC: 0.929775
Avg Precision: 0.335985
Avg Recall: 1.000000
d_prime: 2.084716
train_loss: 0.016558
valid_loss: 0.991781
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0012672056454723544
Epoch-20 lr: 0.0038016169364170635
epoch 20 training time: 15.181
---------------
2023-09-11 20:21:55.022022
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03653	Per Sample Data Time 0.02873	Per Sample DNN Time 0.00780	Train Loss 0.0005	
start validation
acc: 0.824645
AUC: 0.920968
Avg Precision: 0.328817
Avg Recall: 1.000000
d_prime: 1.996327
train_loss: 0.016952
valid_loss: 1.020426
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0012672056454723544
Epoch-21 lr: 0.0038016169364170635
epoch 21 training time: 16.159
---------------
2023-09-11 20:22:11.181369
current #epochs=22, #steps=840
start validation
acc: 0.834123
AUC: 0.926141
Avg Precision: 0.340724
Avg Recall: 1.000000
d_prime: 2.047266
train_loss: 0.019698
valid_loss: 0.990270
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0012672056454723544
Epoch-22 lr: 0.0038016169364170635
epoch 22 training time: 15.160
---------------
2023-09-11 20:22:26.340914
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00565	Train Loss 0.0331	
start validation
acc: 0.829384
AUC: 0.921205
Avg Precision: 0.357008
Avg Recall: 1.000000
d_prime: 1.998597
train_loss: 0.028962
valid_loss: 1.004042
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0012672056454723544
Epoch-23 lr: 0.0038016169364170635
epoch 23 training time: 15.084
---------------
2023-09-11 20:22:41.424992
current #epochs=24, #steps=920
start validation
acc: 0.838863
AUC: 0.928868
Avg Precision: 0.340534
Avg Recall: 1.000000
d_prime: 2.075235
train_loss: 0.026777
valid_loss: 1.002997
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0010832879477632252
Epoch-24 lr: 0.003249863843289676
epoch 24 training time: 15.104
---------------
2023-09-11 20:22:56.529616
current #epochs=25, #steps=960
start validation
acc: 0.834123
AUC: 0.929647
Avg Precision: 0.343744
Avg Recall: 1.000000
d_prime: 2.083370
train_loss: 0.015744
valid_loss: 0.984829
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0010832879477632252
Epoch-25 lr: 0.003249863843289676
epoch 25 training time: 15.231
---------------
2023-09-11 20:23:11.760075
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03784	Per Sample Data Time 0.02997	Per Sample DNN Time 0.00788	Train Loss 0.0477	
start validation
acc: 0.834123
AUC: 0.932699
Avg Precision: 0.346082
Avg Recall: 1.000000
d_prime: 2.115943
train_loss: 0.010612
valid_loss: 0.990942
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0010832879477632252
Epoch-26 lr: 0.003249863843289676
epoch 26 training time: 15.191
---------------
2023-09-11 20:23:26.951216
current #epochs=27, #steps=1040
start validation
acc: 0.810427
AUC: 0.920062
Avg Precision: 0.333395
Avg Recall: 1.000000
d_prime: 1.987660
train_loss: 0.025337
valid_loss: 0.984034
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0010832879477632252
Epoch-27 lr: 0.003249863843289676
epoch 27 training time: 15.070
---------------
2023-09-11 20:23:42.021377
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00722	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00571	Train Loss 0.0230	
start validation
acc: 0.857820
AUC: 0.929810
Avg Precision: 0.329467
Avg Recall: 1.000000
d_prime: 2.085089
train_loss: 0.021133
valid_loss: 0.962910
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0010832879477632252
Epoch-28 lr: 0.003249863843289676
epoch 28 training time: 15.250
---------------
2023-09-11 20:23:57.271609
current #epochs=29, #steps=1120
start validation
acc: 0.857820
AUC: 0.932043
Avg Precision: 0.336314
Avg Recall: 1.000000
d_prime: 2.108850
train_loss: 0.013414
valid_loss: 0.959084
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0010832879477632252
Epoch-29 lr: 0.003249863843289676
epoch 29 training time: 16.581
---------------
2023-09-11 20:24:13.852504
current #epochs=30, #steps=1160
start validation
acc: 0.853081
AUC: 0.931765
Avg Precision: 0.329212
Avg Recall: 1.000000
d_prime: 2.105861
train_loss: 0.012441
valid_loss: 0.967979
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0010832879477632252
Epoch-30 lr: 0.003249863843289676
epoch 30 training time: 16.217
---------------
2023-09-11 20:24:30.069908
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03903	Per Sample Data Time 0.02929	Per Sample DNN Time 0.00974	Train Loss 0.0006	
start validation
acc: 0.857820
AUC: 0.931853
Avg Precision: 0.329348
Avg Recall: 1.000000
d_prime: 2.106801
train_loss: 0.016331
valid_loss: 0.954196
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0010832879477632252
Epoch-31 lr: 0.003249863843289676
epoch 31 training time: 15.217
---------------
2023-09-11 20:24:45.286950
current #epochs=32, #steps=1240
start validation
acc: 0.853081
AUC: 0.928970
Avg Precision: 0.333928
Avg Recall: 1.000000
d_prime: 2.076297
train_loss: 0.018577
valid_loss: 0.960093
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0009260634072788004
Epoch-32 lr: 0.0027781902218364015
epoch 32 training time: 15.180
---------------
2023-09-11 20:25:00.466745
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00561	Train Loss 0.0172	
start validation
acc: 0.829384
AUC: 0.928956
Avg Precision: 0.334373
Avg Recall: 1.000000
d_prime: 2.076151
train_loss: 0.020941
valid_loss: 0.979159
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0009260634072788004
Epoch-33 lr: 0.0027781902218364015
epoch 33 training time: 17.026
---------------
2023-09-11 20:25:17.492628
current #epochs=34, #steps=1320
start validation
acc: 0.824645
AUC: 0.934347
Avg Precision: 0.346985
Avg Recall: 1.000000
d_prime: 2.134004
train_loss: 0.013055
valid_loss: 0.969854
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0009260634072788004
Epoch-34 lr: 0.0027781902218364015
epoch 34 training time: 15.196
---------------
2023-09-11 20:25:32.688873
current #epochs=35, #steps=1360
start validation
acc: 0.862559
AUC: 0.930726
Avg Precision: 0.328544
Avg Recall: 1.000000
d_prime: 2.094761
train_loss: 0.013601
valid_loss: 0.952537
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0009260634072788004
Epoch-35 lr: 0.0027781902218364015
epoch 35 training time: 15.249
---------------
2023-09-11 20:25:47.938062
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03641	Per Sample Data Time 0.02822	Per Sample DNN Time 0.00820	Train Loss 0.0092	
start validation
acc: 0.838863
AUC: 0.923603
Avg Precision: 0.324963
Avg Recall: 1.000000
d_prime: 2.021949
train_loss: 0.018778
valid_loss: 0.983200
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0009260634072788004
Epoch-36 lr: 0.0027781902218364015
epoch 36 training time: 15.028
---------------
2023-09-11 20:26:02.965745
current #epochs=37, #steps=1440
start validation
acc: 0.872038
AUC: 0.924986
Avg Precision: 0.327337
Avg Recall: 1.000000
d_prime: 2.035661
train_loss: 0.025251
valid_loss: 0.961767
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0009260634072788004
Epoch-37 lr: 0.0027781902218364015
epoch 37 training time: 17.266
---------------
2023-09-11 20:26:20.231858
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00730	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00572	Train Loss 0.0096	
start validation
acc: 0.838863
AUC: 0.924108
Avg Precision: 0.338090
Avg Recall: 1.000000
d_prime: 2.026932
train_loss: 0.012888
valid_loss: 0.981180
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0009260634072788004
Epoch-38 lr: 0.0027781902218364015
epoch 38 training time: 15.287
---------------
2023-09-11 20:26:35.518475
current #epochs=39, #steps=1520
start validation
[I 2023-09-11 20:26:50,760] Trial 81 finished with value: 0.8720379146919431 and parameters: {'warmup': 'False', 'num_epochs': 39, 'batch_size': 50, 'lr-adaptschedule': 'True', 'lr': 0.0017340174930738424, 'head-lr': 3, 'lr-scheduler-start': 8, 'lr-scheduler-step': 8, 'lr-scheduler-decay': 0.8548635745379959}. Best is trial 75 with value: 0.8862559241706162.
acc: 0.848341
AUC: 0.925833
Avg Precision: 0.327370
Avg Recall: 1.000000
d_prime: 2.044159
train_loss: 0.022278
valid_loss: 0.966651
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0009260634072788004
Epoch-39 lr: 0.0027781902218364015
epoch 39 training time: 15.228
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863d981a30>
The learning rate scheduler starts at 8 epoch with decay rate of 0.857 every 8 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 20:26:50.799637
current #epochs=1, #steps=0
start validation
acc: 0.843602
AUC: 0.915040
Avg Precision: 0.298235
Avg Recall: 1.000000
d_prime: 1.940953
train_loss: 0.018508
valid_loss: 0.961432
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0015118417411934095
Epoch-1 lr: 0.003023683482386819
epoch 1 training time: 19.639
---------------
2023-09-11 20:27:10.438885
current #epochs=2, #steps=40
start validation
acc: 0.834123
AUC: 0.923639
Avg Precision: 0.323961
Avg Recall: 1.000000
d_prime: 2.022304
train_loss: 0.027166
valid_loss: 0.966553
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0015118417411934095
Epoch-2 lr: 0.003023683482386819
epoch 2 training time: 15.325
---------------
2023-09-11 20:27:25.763497
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00559	Train Loss 0.0118	
start validation
acc: 0.838863
AUC: 0.927986
Avg Precision: 0.341794
Avg Recall: 1.000000
d_prime: 2.066106
train_loss: 0.017499
valid_loss: 0.976474
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0015118417411934095
Epoch-3 lr: 0.003023683482386819
epoch 3 training time: 16.000
---------------
2023-09-11 20:27:41.763875
current #epochs=4, #steps=120
start validation
acc: 0.838863
AUC: 0.916322
Avg Precision: 0.335691
Avg Recall: 1.000000
d_prime: 1.952675
train_loss: 0.017856
valid_loss: 0.995802
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0015118417411934095
Epoch-4 lr: 0.003023683482386819
epoch 4 training time: 15.963
---------------
2023-09-11 20:27:57.726644
current #epochs=5, #steps=160
start validation
acc: 0.834123
AUC: 0.920023
Avg Precision: 0.349580
Avg Recall: 1.000000
d_prime: 1.987286
train_loss: 0.025784
valid_loss: 0.971846
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0015118417411934095
Epoch-5 lr: 0.003023683482386819
epoch 5 training time: 15.116
---------------
2023-09-11 20:28:12.842404
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03888	Per Sample Data Time 0.02947	Per Sample DNN Time 0.00941	Train Loss 0.0006	
start validation
acc: 0.834123
AUC: 0.922785
Avg Precision: 0.363196
Avg Recall: 1.000000
d_prime: 2.013916
train_loss: 0.022829
valid_loss: 0.976966
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0015118417411934095
Epoch-6 lr: 0.003023683482386819
epoch 6 training time: 15.154
---------------
2023-09-11 20:28:27.996095
current #epochs=7, #steps=240
start validation
acc: 0.843602
AUC: 0.928848
Avg Precision: 0.340902
Avg Recall: 1.000000
d_prime: 2.075030
train_loss: 0.027397
valid_loss: 0.979074
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0015118417411934095
Epoch-7 lr: 0.003023683482386819
epoch 7 training time: 15.243
---------------
2023-09-11 20:28:43.239272
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00567	Train Loss 0.0252	
start validation
acc: 0.843602
AUC: 0.923127
Avg Precision: 0.346458
Avg Recall: 1.000000
d_prime: 2.017269
train_loss: 0.021821
valid_loss: 0.982420
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00129597584563136
Epoch-8 lr: 0.00259195169126272
epoch 8 training time: 15.968
---------------
2023-09-11 20:28:59.207693
current #epochs=9, #steps=320
start validation
acc: 0.843602
AUC: 0.928080
Avg Precision: 0.340524
Avg Recall: 1.000000
d_prime: 2.067068
train_loss: 0.021257
valid_loss: 0.968102
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00129597584563136
Epoch-9 lr: 0.00259195169126272
epoch 9 training time: 15.145
---------------
2023-09-11 20:29:14.352447
current #epochs=10, #steps=360
start validation
acc: 0.843602
AUC: 0.923481
Avg Precision: 0.337848
Avg Recall: 1.000000
d_prime: 2.020744
train_loss: 0.021703
valid_loss: 0.962219
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00129597584563136
Epoch-10 lr: 0.00259195169126272
epoch 10 training time: 15.210
---------------
2023-09-11 20:29:29.562044
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03647	Per Sample Data Time 0.02826	Per Sample DNN Time 0.00821	Train Loss 0.0084	
start validation
acc: 0.829384
AUC: 0.923762
Avg Precision: 0.320944
Avg Recall: 1.000000
d_prime: 2.023513
train_loss: 0.047579
valid_loss: 0.982549
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00129597584563136
Epoch-11 lr: 0.00259195169126272
epoch 11 training time: 16.355
---------------
2023-09-11 20:29:45.916743
current #epochs=12, #steps=440
start validation
acc: 0.848341
AUC: 0.926453
Avg Precision: 0.317907
Avg Recall: 1.000000
d_prime: 2.050431
train_loss: 0.020357
valid_loss: 0.976111
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00129597584563136
Epoch-12 lr: 0.00259195169126272
epoch 12 training time: 17.792
---------------
2023-09-11 20:30:03.708819
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00725	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00574	Train Loss 0.0108	
start validation
acc: 0.862559
AUC: 0.926093
Avg Precision: 0.325027
Avg Recall: 1.000000
d_prime: 2.046790
train_loss: 0.010521
valid_loss: 0.978359
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00129597584563136
Epoch-13 lr: 0.00259195169126272
epoch 13 training time: 17.253
---------------
2023-09-11 20:30:20.961670
current #epochs=14, #steps=520
start validation
acc: 0.843602
AUC: 0.922368
Avg Precision: 0.326476
Avg Recall: 1.000000
d_prime: 2.009855
train_loss: 0.012988
valid_loss: 0.977042
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.00129597584563136
Epoch-14 lr: 0.00259195169126272
epoch 14 training time: 15.269
---------------
2023-09-11 20:30:36.230758
current #epochs=15, #steps=560
start validation
acc: 0.848341
AUC: 0.923425
Avg Precision: 0.351079
Avg Recall: 1.000000
d_prime: 2.020196
train_loss: 0.010886
valid_loss: 0.976482
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.00129597584563136
Epoch-15 lr: 0.00259195169126272
epoch 15 training time: 15.754
---------------
2023-09-11 20:30:51.984525
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03761	Per Sample Data Time 0.02992	Per Sample DNN Time 0.00769	Train Loss 0.0524	
start validation
acc: 0.838863
AUC: 0.924552
Avg Precision: 0.345569
Avg Recall: 1.000000
d_prime: 2.031336
train_loss: 0.019496
valid_loss: 0.976592
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.00111093201536698
Epoch-16 lr: 0.00222186403073396
epoch 16 training time: 15.163
---------------
2023-09-11 20:31:07.147958
current #epochs=17, #steps=640
start validation
acc: 0.853081
AUC: 0.926514
Avg Precision: 0.344751
Avg Recall: 1.000000
d_prime: 2.051044
train_loss: 0.016692
valid_loss: 0.980066
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.00111093201536698
Epoch-17 lr: 0.00222186403073396
epoch 17 training time: 14.899
---------------
2023-09-11 20:31:22.047490
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00734	Per Sample Data Time 0.00160	Per Sample DNN Time 0.00574	Train Loss 0.0225	
start validation
acc: 0.848341
AUC: 0.937225
Avg Precision: 0.359331
Avg Recall: 1.000000
d_prime: 2.166412
train_loss: 0.027352
valid_loss: 0.983123
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00111093201536698
Epoch-18 lr: 0.00222186403073396
epoch 18 training time: 15.238
---------------
2023-09-11 20:31:37.284801
current #epochs=19, #steps=720
start validation
acc: 0.838863
AUC: 0.918045
Avg Precision: 0.318929
Avg Recall: 1.000000
d_prime: 1.968648
train_loss: 0.025326
valid_loss: 1.009559
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00111093201536698
Epoch-19 lr: 0.00222186403073396
epoch 19 training time: 15.214
---------------
2023-09-11 20:31:52.499085
current #epochs=20, #steps=760
start validation
acc: 0.857820
AUC: 0.924134
Avg Precision: 0.319684
Avg Recall: 1.000000
d_prime: 2.027189
train_loss: 0.015603
valid_loss: 0.979186
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00111093201536698
Epoch-20 lr: 0.00222186403073396
epoch 20 training time: 15.183
---------------
2023-09-11 20:32:07.682354
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03885	Per Sample Data Time 0.03054	Per Sample DNN Time 0.00831	Train Loss 0.0726	
start validation
acc: 0.853081
AUC: 0.923626
Avg Precision: 0.331641
Avg Recall: 1.000000
d_prime: 2.022170
train_loss: 0.016490
valid_loss: 1.002348
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00111093201536698
Epoch-21 lr: 0.00222186403073396
epoch 21 training time: 15.794
---------------
2023-09-11 20:32:23.476757
current #epochs=22, #steps=840
start validation
acc: 0.848341
AUC: 0.919780
Avg Precision: 0.341402
Avg Recall: 1.000000
d_prime: 1.984980
train_loss: 0.011688
valid_loss: 1.004412
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00111093201536698
Epoch-22 lr: 0.00222186403073396
epoch 22 training time: 15.258
---------------
2023-09-11 20:32:38.734825
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00567	Train Loss 0.0141	
start validation
acc: 0.838863
AUC: 0.915761
Avg Precision: 0.340431
Avg Recall: 1.000000
d_prime: 1.947531
train_loss: 0.011263
valid_loss: 0.999901
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00111093201536698
Epoch-23 lr: 0.00222186403073396
epoch 23 training time: 15.076
---------------
2023-09-11 20:32:53.810845
current #epochs=24, #steps=920
start validation
acc: 0.853081
AUC: 0.915903
Avg Precision: 0.335983
Avg Recall: 1.000000
d_prime: 1.948831
train_loss: 0.015130
valid_loss: 0.996685
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0009523093712954889
Epoch-24 lr: 0.0019046187425909777
epoch 24 training time: 15.181
---------------
2023-09-11 20:33:08.991687
current #epochs=25, #steps=960
start validation
acc: 0.848341
AUC: 0.918113
Avg Precision: 0.326697
Avg Recall: 1.000000
d_prime: 1.969278
train_loss: 0.011431
valid_loss: 0.992792
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0009523093712954889
Epoch-25 lr: 0.0019046187425909777
epoch 25 training time: 15.188
---------------
2023-09-11 20:33:24.179291
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03608	Per Sample Data Time 0.02782	Per Sample DNN Time 0.00827	Train Loss 0.0022	
start validation
acc: 0.853081
AUC: 0.922127
Avg Precision: 0.331858
Avg Recall: 1.000000
d_prime: 2.007509
train_loss: 0.028307
valid_loss: 0.978359
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0009523093712954889
Epoch-26 lr: 0.0019046187425909777
epoch 26 training time: 15.205
---------------
2023-09-11 20:33:39.383816
current #epochs=27, #steps=1040
start validation
acc: 0.862559
AUC: 0.926612
Avg Precision: 0.332095
Avg Recall: 1.000000
d_prime: 2.052039
train_loss: 0.005782
valid_loss: 0.997400
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0009523093712954889
Epoch-27 lr: 0.0019046187425909777
epoch 27 training time: 15.152
---------------
2023-09-11 20:33:54.536312
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00724	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00572	Train Loss 0.0191	
start validation
acc: 0.848341
AUC: 0.923598
Avg Precision: 0.337553
Avg Recall: 1.000000
d_prime: 2.021896
train_loss: 0.012943
valid_loss: 0.980287
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0009523093712954889
Epoch-28 lr: 0.0019046187425909777
epoch 28 training time: 15.246
---------------
2023-09-11 20:34:09.782730
current #epochs=29, #steps=1120
start validation
acc: 0.843602
AUC: 0.922916
Avg Precision: 0.330576
Avg Recall: 1.000000
d_prime: 2.015204
train_loss: 0.017888
valid_loss: 0.979250
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0009523093712954889
Epoch-29 lr: 0.0019046187425909777
epoch 29 training time: 16.121
---------------
2023-09-11 20:34:25.903281
current #epochs=30, #steps=1160
start validation
acc: 0.848341
AUC: 0.923278
Avg Precision: 0.352658
Avg Recall: 1.000000
d_prime: 2.018754
train_loss: 0.020866
valid_loss: 0.976293
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0009523093712954889
Epoch-30 lr: 0.0019046187425909777
epoch 30 training time: 15.064
---------------
2023-09-11 20:34:40.967170
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03962	Per Sample Data Time 0.02922	Per Sample DNN Time 0.01040	Train Loss 0.0765	
start validation
acc: 0.848341
AUC: 0.919934
Avg Precision: 0.347132
Avg Recall: 1.000000
d_prime: 1.986441
train_loss: 0.008855
valid_loss: 0.980316
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0009523093712954889
Epoch-31 lr: 0.0019046187425909777
epoch 31 training time: 15.188
---------------
2023-09-11 20:34:56.155821
current #epochs=32, #steps=1240
start validation
acc: 0.857820
AUC: 0.920387
Avg Precision: 0.342815
Avg Recall: 1.000000
d_prime: 1.990761
train_loss: 0.011785
valid_loss: 0.975053
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0008163354067689106
Epoch-32 lr: 0.0016326708135378212
epoch 32 training time: 15.118
---------------
2023-09-11 20:35:11.273480
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00565	Train Loss 0.0132	
start validation
acc: 0.853081
AUC: 0.924943
Avg Precision: 0.338920
Avg Recall: 1.000000
d_prime: 2.035234
train_loss: 0.014361
valid_loss: 0.967120
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0008163354067689106
Epoch-33 lr: 0.0016326708135378212
epoch 33 training time: 15.155
---------------
2023-09-11 20:35:26.428544
current #epochs=34, #steps=1320
start validation
acc: 0.848341
AUC: 0.922611
Avg Precision: 0.341829
Avg Recall: 1.000000
d_prime: 2.012224
train_loss: 0.018403
valid_loss: 0.977215
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0008163354067689106
Epoch-34 lr: 0.0016326708135378212
epoch 34 training time: 15.195
---------------
2023-09-11 20:35:41.623729
current #epochs=35, #steps=1360
start validation
acc: 0.848341
AUC: 0.922927
Avg Precision: 0.330753
Avg Recall: 1.000000
d_prime: 2.015311
train_loss: 0.011280
valid_loss: 0.969704
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0008163354067689106
Epoch-35 lr: 0.0016326708135378212
epoch 35 training time: 15.176
---------------
2023-09-11 20:35:56.799679
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03514	Per Sample Data Time 0.02763	Per Sample DNN Time 0.00752	Train Loss 0.0039	
start validation
acc: 0.848341
AUC: 0.916848
Avg Precision: 0.346887
Avg Recall: 1.000000
d_prime: 1.957527
train_loss: 0.011279
valid_loss: 0.991147
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0008163354067689106
Epoch-36 lr: 0.0016326708135378212
epoch 36 training time: 15.017
---------------
2023-09-11 20:36:11.816958
current #epochs=37, #steps=1440
start validation
acc: 0.843602
AUC: 0.929220
Avg Precision: 0.344602
Avg Recall: 1.000000
d_prime: 2.078901
train_loss: 0.014307
valid_loss: 0.983753
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0008163354067689106
Epoch-37 lr: 0.0016326708135378212
epoch 37 training time: 15.330
---------------
2023-09-11 20:36:27.147126
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00567	Train Loss 0.0105	
start validation
acc: 0.853081
AUC: 0.929200
Avg Precision: 0.337767
Avg Recall: 1.000000
d_prime: 2.078691
train_loss: 0.012966
valid_loss: 0.977993
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0008163354067689106
Epoch-38 lr: 0.0016326708135378212
epoch 38 training time: 15.232
---------------
2023-09-11 20:36:42.378975
current #epochs=39, #steps=1520
start validation
acc: 0.857820
AUC: 0.924938
Avg Precision: 0.350195
Avg Recall: 1.000000
d_prime: 2.035183
train_loss: 0.023306
valid_loss: 0.981090
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0008163354067689106
Epoch-39 lr: 0.0016326708135378212
epoch 39 training time: 15.134
---------------
2023-09-11 20:36:57.512946
current #epochs=40, #steps=1560
start validation
acc: 0.857820
AUC: 0.923482
Avg Precision: 0.358363
Avg Recall: 1.000000
d_prime: 2.020750
train_loss: 0.017488
valid_loss: 0.980515
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0006997762664437612
Epoch-40 lr: 0.0013995525328875224
epoch 40 training time: 15.289
---------------
2023-09-11 20:37:12.802023
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03669	Per Sample Data Time 0.02818	Per Sample DNN Time 0.00851	Train Loss 0.0117	
start validation
[I 2023-09-11 20:37:30,085] Trial 82 finished with value: 0.8672985781990521 and parameters: {'warmup': 'False', 'num_epochs': 41, 'batch_size': 50, 'lr-adaptschedule': 'True', 'lr': 0.0015118417411934095, 'head-lr': 2, 'lr-scheduler-start': 8, 'lr-scheduler-step': 8, 'lr-scheduler-decay': 0.8572166056272197}. Best is trial 75 with value: 0.8862559241706162.
acc: 0.867299
AUC: 0.919766
Avg Precision: 0.348181
Avg Recall: 1.000000
d_prime: 1.984848
train_loss: 0.015193
valid_loss: 0.971469
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0006997762664437612
Epoch-41 lr: 0.0013995525328875224
epoch 41 training time: 17.268
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863d992220>
The learning rate scheduler starts at 8 epoch with decay rate of 0.844 every 8 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 20:37:30.124601
current #epochs=1, #steps=0
start validation
acc: 0.857820
AUC: 0.909696
Avg Precision: 0.337388
Avg Recall: 1.000000
d_prime: 1.893470
train_loss: 0.022079
valid_loss: 0.985127
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0015933495152554132
Epoch-1 lr: 0.00478004854576624
epoch 1 training time: 17.104
---------------
2023-09-11 20:37:47.228832
current #epochs=2, #steps=40
start validation
acc: 0.853081
AUC: 0.915474
Avg Precision: 0.319242
Avg Recall: 1.000000
d_prime: 1.944905
train_loss: 0.017513
valid_loss: 0.980352
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0015933495152554132
Epoch-2 lr: 0.00478004854576624
epoch 2 training time: 15.210
---------------
2023-09-11 20:38:02.439126
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00575	Train Loss 0.0212	
start validation
acc: 0.834123
AUC: 0.907725
Avg Precision: 0.343396
Avg Recall: 1.000000
d_prime: 1.876485
train_loss: 0.020941
valid_loss: 0.992716
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0015933495152554132
Epoch-3 lr: 0.00478004854576624
epoch 3 training time: 15.227
---------------
2023-09-11 20:38:17.666638
current #epochs=4, #steps=120
start validation
acc: 0.819905
AUC: 0.908996
Avg Precision: 0.334794
Avg Recall: 1.000000
d_prime: 1.887410
train_loss: 0.023281
valid_loss: 0.976614
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0015933495152554132
Epoch-4 lr: 0.00478004854576624
epoch 4 training time: 15.325
---------------
2023-09-11 20:38:32.991761
current #epochs=5, #steps=160
start validation
acc: 0.829384
AUC: 0.928039
Avg Precision: 0.343874
Avg Recall: 1.000000
d_prime: 2.066651
train_loss: 0.028117
valid_loss: 0.992800
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0015933495152554132
Epoch-5 lr: 0.00478004854576624
epoch 5 training time: 15.026
---------------
2023-09-11 20:38:48.016922
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03596	Per Sample Data Time 0.02798	Per Sample DNN Time 0.00798	Train Loss 0.0382	
start validation
acc: 0.824645
AUC: 0.904111
Avg Precision: 0.320139
Avg Recall: 1.000000
d_prime: 1.846023
train_loss: 0.031457
valid_loss: 1.014421
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0015933495152554132
Epoch-6 lr: 0.00478004854576624
epoch 6 training time: 15.055
---------------
2023-09-11 20:39:03.072435
current #epochs=7, #steps=240
start validation
acc: 0.824645
AUC: 0.924519
Avg Precision: 0.369809
Avg Recall: 1.000000
d_prime: 2.031015
train_loss: 0.051880
valid_loss: 0.996394
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0015933495152554132
Epoch-7 lr: 0.00478004854576624
epoch 7 training time: 16.134
---------------
2023-09-11 20:39:19.206798
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00724	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00572	Train Loss 0.0199	
start validation
acc: 0.843602
AUC: 0.925817
Avg Precision: 0.371261
Avg Recall: 1.000000
d_prime: 2.044006
train_loss: 0.024321
valid_loss: 0.977941
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0013450766545387836
Epoch-8 lr: 0.00403522996361635
epoch 8 training time: 15.213
---------------
2023-09-11 20:39:34.419453
current #epochs=9, #steps=320
start validation
acc: 0.834123
AUC: 0.934419
Avg Precision: 0.362503
Avg Recall: 1.000000
d_prime: 2.134807
train_loss: 0.031762
valid_loss: 0.973675
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0013450766545387836
Epoch-9 lr: 0.00403522996361635
epoch 9 training time: 15.010
---------------
2023-09-11 20:39:49.429411
current #epochs=10, #steps=360
start validation
acc: 0.843602
AUC: 0.926641
Avg Precision: 0.368340
Avg Recall: 1.000000
d_prime: 2.052337
train_loss: 0.021396
valid_loss: 0.991346
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0013450766545387836
Epoch-10 lr: 0.00403522996361635
epoch 10 training time: 15.187
---------------
2023-09-11 20:40:04.616460
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03504	Per Sample Data Time 0.02684	Per Sample DNN Time 0.00820	Train Loss 0.0092	
start validation
acc: 0.843602
AUC: 0.923372
Avg Precision: 0.351311
Avg Recall: 1.000000
d_prime: 2.019676
train_loss: 0.016848
valid_loss: 0.997100
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0013450766545387836
Epoch-11 lr: 0.00403522996361635
epoch 11 training time: 15.112
---------------
2023-09-11 20:40:19.728694
current #epochs=12, #steps=440
start validation
acc: 0.829384
AUC: 0.923721
Avg Precision: 0.355899
Avg Recall: 1.000000
d_prime: 2.023108
train_loss: 0.018378
valid_loss: 0.995704
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0013450766545387836
Epoch-12 lr: 0.00403522996361635
epoch 12 training time: 15.073
---------------
2023-09-11 20:40:34.801893
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00569	Train Loss 0.0299	
start validation
acc: 0.848341
AUC: 0.922863
Avg Precision: 0.349041
Avg Recall: 1.000000
d_prime: 2.014684
train_loss: 0.026876
valid_loss: 0.990491
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0013450766545387836
Epoch-13 lr: 0.00403522996361635
epoch 13 training time: 15.289
---------------
2023-09-11 20:40:50.091092
current #epochs=14, #steps=520
start validation
acc: 0.843602
AUC: 0.931310
Avg Precision: 0.367294
Avg Recall: 1.000000
d_prime: 2.100986
train_loss: 0.011281
valid_loss: 0.993815
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0013450766545387836
Epoch-14 lr: 0.00403522996361635
epoch 14 training time: 15.121
---------------
2023-09-11 20:41:05.212333
current #epochs=15, #steps=560
start validation
acc: 0.867299
AUC: 0.925578
Avg Precision: 0.340914
Avg Recall: 1.000000
d_prime: 2.041593
train_loss: 0.014956
valid_loss: 0.970098
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0013450766545387836
Epoch-15 lr: 0.00403522996361635
epoch 15 training time: 17.120
---------------
2023-09-11 20:41:22.332603
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03861	Per Sample Data Time 0.02707	Per Sample DNN Time 0.01154	Train Loss 0.0059	
start validation
acc: 0.853081
AUC: 0.923438
Avg Precision: 0.332172
Avg Recall: 1.000000
d_prime: 2.020320
train_loss: 0.017864
valid_loss: 0.977804
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0011354892252220174
Epoch-16 lr: 0.0034064676756660516
epoch 16 training time: 15.304
---------------
2023-09-11 20:41:37.636624
current #epochs=17, #steps=640
start validation
acc: 0.838863
AUC: 0.920053
Avg Precision: 0.345614
Avg Recall: 1.000000
d_prime: 1.987574
train_loss: 0.018423
valid_loss: 0.972890
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0011354892252220174
Epoch-17 lr: 0.0034064676756660516
epoch 17 training time: 15.019
---------------
2023-09-11 20:41:52.655683
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00560	Train Loss 0.0289	
start validation
acc: 0.848341
AUC: 0.923598
Avg Precision: 0.359739
Avg Recall: 1.000000
d_prime: 2.021893
train_loss: 0.023437
valid_loss: 0.980011
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0011354892252220174
Epoch-18 lr: 0.0034064676756660516
epoch 18 training time: 15.153
---------------
2023-09-11 20:42:07.809192
current #epochs=19, #steps=720
start validation
acc: 0.857820
AUC: 0.929660
Avg Precision: 0.363574
Avg Recall: 1.000000
d_prime: 2.083505
train_loss: 0.021670
valid_loss: 0.985075
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0011354892252220174
Epoch-19 lr: 0.0034064676756660516
epoch 19 training time: 15.240
---------------
2023-09-11 20:42:23.049118
current #epochs=20, #steps=760
start validation
acc: 0.867299
AUC: 0.928869
Avg Precision: 0.363534
Avg Recall: 1.000000
d_prime: 2.075245
train_loss: 0.017700
valid_loss: 0.971924
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0011354892252220174
Epoch-20 lr: 0.0034064676756660516
epoch 20 training time: 15.156
---------------
2023-09-11 20:42:38.204834
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03991	Per Sample Data Time 0.02873	Per Sample DNN Time 0.01117	Train Loss 0.0008	
start validation
acc: 0.848341
AUC: 0.924037
Avg Precision: 0.377971
Avg Recall: 1.000000
d_prime: 2.026228
train_loss: 0.009088
valid_loss: 0.988952
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0011354892252220174
Epoch-21 lr: 0.0034064676756660516
epoch 21 training time: 15.223
---------------
2023-09-11 20:42:53.427683
current #epochs=22, #steps=840
start validation
acc: 0.853081
AUC: 0.930118
Avg Precision: 0.378216
Avg Recall: 1.000000
d_prime: 2.088329
train_loss: 0.014279
valid_loss: 0.983785
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0011354892252220174
Epoch-22 lr: 0.0034064676756660516
epoch 22 training time: 15.177
---------------
2023-09-11 20:43:08.605313
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00564	Train Loss 0.0144	
start validation
acc: 0.857820
AUC: 0.931635
Avg Precision: 0.380906
Avg Recall: 1.000000
d_prime: 2.104457
train_loss: 0.012805
valid_loss: 0.983558
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0011354892252220174
Epoch-23 lr: 0.0034064676756660516
epoch 23 training time: 15.106
---------------
2023-09-11 20:43:23.710669
current #epochs=24, #steps=920
start validation
acc: 0.853081
AUC: 0.933698
Avg Precision: 0.361889
Avg Recall: 1.000000
d_prime: 2.126848
train_loss: 0.021048
valid_loss: 0.985221
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0009585593328414436
Epoch-24 lr: 0.00287567799852433
epoch 24 training time: 15.127
---------------
2023-09-11 20:43:38.837366
current #epochs=25, #steps=960
start validation
acc: 0.853081
AUC: 0.938377
Avg Precision: 0.348656
Avg Recall: 1.000000
d_prime: 2.179719
train_loss: 0.021662
valid_loss: 0.977419
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0009585593328414436
Epoch-25 lr: 0.00287567799852433
epoch 25 training time: 15.118
---------------
2023-09-11 20:43:53.955569
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03765	Per Sample Data Time 0.02969	Per Sample DNN Time 0.00796	Train Loss 0.0100	
start validation
acc: 0.867299
AUC: 0.935425
Avg Precision: 0.357571
Avg Recall: 1.000000
d_prime: 2.146015
train_loss: 0.019020
valid_loss: 0.980679
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0009585593328414436
Epoch-26 lr: 0.00287567799852433
epoch 26 training time: 15.217
---------------
2023-09-11 20:44:09.172846
current #epochs=27, #steps=1040
start validation
acc: 0.843602
AUC: 0.932762
Avg Precision: 0.373003
Avg Recall: 1.000000
d_prime: 2.116623
train_loss: 0.021275
valid_loss: 0.992959
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0009585593328414436
Epoch-27 lr: 0.00287567799852433
epoch 27 training time: 15.087
---------------
2023-09-11 20:44:24.260204
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00572	Train Loss 0.0074	
start validation
acc: 0.843602
AUC: 0.934842
Avg Precision: 0.381945
Avg Recall: 1.000000
d_prime: 2.139500
train_loss: 0.012843
valid_loss: 0.991117
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0009585593328414436
Epoch-28 lr: 0.00287567799852433
epoch 28 training time: 15.179
---------------
2023-09-11 20:44:39.438950
current #epochs=29, #steps=1120
start validation
acc: 0.843602
AUC: 0.934147
Avg Precision: 0.371097
Avg Recall: 1.000000
d_prime: 2.131796
train_loss: 0.020071
valid_loss: 0.980121
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0009585593328414436
Epoch-29 lr: 0.00287567799852433
epoch 29 training time: 15.238
---------------
2023-09-11 20:44:54.676843
current #epochs=30, #steps=1160
start validation
acc: 0.843602
AUC: 0.933652
Avg Precision: 0.362264
Avg Recall: 1.000000
d_prime: 2.126353
train_loss: 0.013890
valid_loss: 0.984276
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0009585593328414436
Epoch-30 lr: 0.00287567799852433
epoch 30 training time: 15.199
---------------
2023-09-11 20:45:09.875452
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.04016	Per Sample Data Time 0.02978	Per Sample DNN Time 0.01038	Train Loss 0.0466	
start validation
acc: 0.853081
AUC: 0.934791
Avg Precision: 0.348754
Avg Recall: 1.000000
d_prime: 2.138932
train_loss: 0.011808
valid_loss: 0.987280
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0009585593328414436
Epoch-31 lr: 0.00287567799852433
epoch 31 training time: 15.289
---------------
2023-09-11 20:45:25.164517
current #epochs=32, #steps=1240
start validation
acc: 0.862559
AUC: 0.932731
Avg Precision: 0.350316
Avg Recall: 1.000000
d_prime: 2.116287
train_loss: 0.008886
valid_loss: 0.989522
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0008091983386260467
Epoch-32 lr: 0.0024275950158781394
epoch 32 training time: 15.327
---------------
2023-09-11 20:45:40.491902
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00565	Train Loss 0.0151	
start validation
acc: 0.838863
AUC: 0.930361
Avg Precision: 0.356259
Avg Recall: 1.000000
d_prime: 2.090890
train_loss: 0.013341
valid_loss: 0.992941
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0008091983386260467
Epoch-33 lr: 0.0024275950158781394
epoch 33 training time: 15.316
---------------
2023-09-11 20:45:55.808086
current #epochs=34, #steps=1320
start validation
[I 2023-09-11 20:46:10,955] Trial 83 finished with value: 0.8672985781990521 and parameters: {'warmup': 'False', 'num_epochs': 34, 'batch_size': 51, 'lr-adaptschedule': 'True', 'lr': 0.0015933495152554132, 'head-lr': 3, 'lr-scheduler-start': 8, 'lr-scheduler-step': 8, 'lr-scheduler-decay': 0.8441817954318506}. Best is trial 75 with value: 0.8862559241706162.
acc: 0.829384
AUC: 0.923756
Avg Precision: 0.360909
Avg Recall: 1.000000
d_prime: 2.023457
train_loss: 0.015333
valid_loss: 1.000234
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0008091983386260467
Epoch-34 lr: 0.0024275950158781394
epoch 34 training time: 15.135
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863d9889d0>
The learning rate scheduler starts at 3 epoch with decay rate of 0.875 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 20:46:10.997080
current #epochs=1, #steps=0
start validation
acc: 0.862559
AUC: 0.921749
Avg Precision: 0.373983
Avg Recall: 1.000000
d_prime: 2.003847
train_loss: 0.016438
valid_loss: 0.994835
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0017938551147302644
Epoch-1 lr: 0.0017938551147302644
epoch 1 training time: 17.095
---------------
2023-09-11 20:46:28.092551
current #epochs=2, #steps=40
start validation
acc: 0.872038
AUC: 0.939470
Avg Precision: 0.345705
Avg Recall: 1.000000
d_prime: 2.192515
train_loss: 0.027211
valid_loss: 0.965648
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0017938551147302644
Epoch-2 lr: 0.0017938551147302644
epoch 2 training time: 16.896
---------------
2023-09-11 20:46:44.989041
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00732	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00577	Train Loss 0.0272	
start validation
acc: 0.848341
AUC: 0.937634
Avg Precision: 0.316348
Avg Recall: 1.000000
d_prime: 2.171116
train_loss: 0.033746
valid_loss: 0.965741
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0015694125787886176
Epoch-3 lr: 0.0015694125787886176
epoch 3 training time: 15.313
---------------
2023-09-11 20:47:00.301602
current #epochs=4, #steps=120
start validation
acc: 0.857820
AUC: 0.929562
Avg Precision: 0.352024
Avg Recall: 1.000000
d_prime: 2.082483
train_loss: 0.039722
valid_loss: 0.960230
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0015694125787886176
Epoch-4 lr: 0.0015694125787886176
epoch 4 training time: 15.238
---------------
2023-09-11 20:47:15.539654
current #epochs=5, #steps=160
start validation
acc: 0.862559
AUC: 0.935336
Avg Precision: 0.351172
Avg Recall: 1.000000
d_prime: 2.145019
train_loss: 0.022032
valid_loss: 0.978842
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0015694125787886176
Epoch-5 lr: 0.0015694125787886176
epoch 5 training time: 15.172
---------------
2023-09-11 20:47:30.711528
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03731	Per Sample Data Time 0.02892	Per Sample DNN Time 0.00840	Train Loss 0.0229	
start validation
acc: 0.857820
AUC: 0.934179
Avg Precision: 0.365622
Avg Recall: 1.000000
d_prime: 2.132154
train_loss: 0.016970
valid_loss: 0.985053
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0015694125787886176
Epoch-6 lr: 0.0015694125787886176
epoch 6 training time: 15.170
---------------
2023-09-11 20:47:45.881230
current #epochs=7, #steps=240
start validation
acc: 0.815166
AUC: 0.919925
Avg Precision: 0.359840
Avg Recall: 1.000000
d_prime: 1.986356
train_loss: 0.023530
valid_loss: 1.005626
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0015694125787886176
Epoch-7 lr: 0.0015694125787886176
epoch 7 training time: 16.059
---------------
2023-09-11 20:48:01.940581
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00728	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00573	Train Loss 0.0308	
start validation
acc: 0.853081
AUC: 0.927905
Avg Precision: 0.340150
Avg Recall: 1.000000
d_prime: 2.065263
train_loss: 0.041505
valid_loss: 0.999748
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0015694125787886176
Epoch-8 lr: 0.0015694125787886176
epoch 8 training time: 15.227
---------------
2023-09-11 20:48:17.167866
current #epochs=9, #steps=320
start validation
acc: 0.876777
AUC: 0.931242
Avg Precision: 0.346718
Avg Recall: 1.000000
d_prime: 2.100258
train_loss: 0.033035
valid_loss: 0.981780
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0015694125787886176
Epoch-9 lr: 0.0015694125787886176
epoch 9 training time: 17.181
---------------
2023-09-11 20:48:34.348865
current #epochs=10, #steps=360
start validation
acc: 0.881517
AUC: 0.932801
Avg Precision: 0.328045
Avg Recall: 1.000000
d_prime: 2.117049
train_loss: 0.021775
valid_loss: 0.976960
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0015694125787886176
Epoch-10 lr: 0.0015694125787886176
epoch 10 training time: 17.051
---------------
2023-09-11 20:48:51.399447
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.04026	Per Sample Data Time 0.02922	Per Sample DNN Time 0.01104	Train Loss 0.0618	
start validation
acc: 0.881517
AUC: 0.929099
Avg Precision: 0.329550
Avg Recall: 1.000000
d_prime: 2.077640
train_loss: 0.023092
valid_loss: 0.966669
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0015694125787886176
Epoch-11 lr: 0.0015694125787886176
epoch 11 training time: 15.234
---------------
2023-09-11 20:49:06.633157
current #epochs=12, #steps=440
start validation
acc: 0.881517
AUC: 0.927289
Avg Precision: 0.365286
Avg Recall: 1.000000
d_prime: 2.058940
train_loss: 0.016622
valid_loss: 0.970506
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0013730517154002706
Epoch-12 lr: 0.0013730517154002706
epoch 12 training time: 15.172
---------------
2023-09-11 20:49:21.805018
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00723	Per Sample Data Time 0.00157	Per Sample DNN Time 0.00565	Train Loss 0.0213	
start validation
acc: 0.857820
AUC: 0.923707
Avg Precision: 0.337557
Avg Recall: 1.000000
d_prime: 2.022973
train_loss: 0.029559
valid_loss: 0.983878
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0013730517154002706
Epoch-13 lr: 0.0013730517154002706
epoch 13 training time: 15.319
---------------
2023-09-11 20:49:37.124480
current #epochs=14, #steps=520
start validation
acc: 0.862559
AUC: 0.918592
Avg Precision: 0.324717
Avg Recall: 1.000000
d_prime: 1.973767
train_loss: 0.024543
valid_loss: 0.998558
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0013730517154002706
Epoch-14 lr: 0.0013730517154002706
epoch 14 training time: 15.142
---------------
2023-09-11 20:49:52.266342
current #epochs=15, #steps=560
start validation
acc: 0.881517
AUC: 0.928274
Avg Precision: 0.338691
Avg Recall: 1.000000
d_prime: 2.069075
train_loss: 0.016891
valid_loss: 0.950552
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0013730517154002706
Epoch-15 lr: 0.0013730517154002706
epoch 15 training time: 15.138
---------------
2023-09-11 20:50:07.403897
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03887	Per Sample Data Time 0.02785	Per Sample DNN Time 0.01102	Train Loss 0.0003	
start validation
acc: 0.881517
AUC: 0.917639
Avg Precision: 0.358859
Avg Recall: 1.000000
d_prime: 1.964854
train_loss: 0.026415
valid_loss: 0.978155
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0013730517154002706
Epoch-16 lr: 0.0013730517154002706
epoch 16 training time: 15.151
---------------
2023-09-11 20:50:22.554523
current #epochs=17, #steps=640
start validation
acc: 0.848341
AUC: 0.923622
Avg Precision: 0.343952
Avg Recall: 1.000000
d_prime: 2.022138
train_loss: 0.020488
valid_loss: 0.965500
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0013730517154002706
Epoch-17 lr: 0.0013730517154002706
epoch 17 training time: 15.098
---------------
2023-09-11 20:50:37.652425
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00568	Train Loss 0.0157	
start validation
acc: 0.829384
AUC: 0.921444
Avg Precision: 0.306372
Avg Recall: 1.000000
d_prime: 2.000907
train_loss: 0.020639
valid_loss: 0.975409
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0013730517154002706
Epoch-18 lr: 0.0013730517154002706
epoch 18 training time: 15.060
---------------
2023-09-11 20:50:52.712780
current #epochs=19, #steps=720
start validation
acc: 0.857820
AUC: 0.924672
Avg Precision: 0.333922
Avg Recall: 1.000000
d_prime: 2.032536
train_loss: 0.025434
valid_loss: 0.981879
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0013730517154002706
Epoch-19 lr: 0.0013730517154002706
epoch 19 training time: 15.228
---------------
2023-09-11 20:51:07.940659
current #epochs=20, #steps=760
start validation
acc: 0.838863
AUC: 0.919475
Avg Precision: 0.322228
Avg Recall: 1.000000
d_prime: 1.982086
train_loss: 0.020142
valid_loss: 0.976686
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0013730517154002706
Epoch-20 lr: 0.0013730517154002706
epoch 20 training time: 15.841
---------------
2023-09-11 20:51:23.781196
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03760	Per Sample Data Time 0.02967	Per Sample DNN Time 0.00793	Train Loss 0.0211	
start validation
acc: 0.834123
AUC: 0.909914
Avg Precision: 0.331622
Avg Recall: 1.000000
d_prime: 1.895369
train_loss: 0.017994
valid_loss: 0.999248
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0012012590179561386
Epoch-21 lr: 0.0012012590179561386
epoch 21 training time: 15.170
---------------
2023-09-11 20:51:38.950976
current #epochs=22, #steps=840
start validation
acc: 0.819905
AUC: 0.917896
Avg Precision: 0.313486
Avg Recall: 1.000000
d_prime: 1.967252
train_loss: 0.014759
valid_loss: 0.989883
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0012012590179561386
Epoch-22 lr: 0.0012012590179561386
epoch 22 training time: 15.206
---------------
2023-09-11 20:51:54.157362
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00562	Train Loss 0.0206	
start validation
acc: 0.838863
AUC: 0.914177
Avg Precision: 0.305110
Avg Recall: 1.000000
d_prime: 1.933136
train_loss: 0.020074
valid_loss: 0.981373
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0012012590179561386
Epoch-23 lr: 0.0012012590179561386
epoch 23 training time: 15.059
---------------
2023-09-11 20:52:09.216214
current #epochs=24, #steps=920
start validation
acc: 0.857820
AUC: 0.914838
Avg Precision: 0.325942
Avg Recall: 1.000000
d_prime: 1.939115
train_loss: 0.011810
valid_loss: 0.997436
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0012012590179561386
Epoch-24 lr: 0.0012012590179561386
epoch 24 training time: 15.166
---------------
2023-09-11 20:52:24.381819
current #epochs=25, #steps=960
start validation
acc: 0.862559
AUC: 0.911112
Avg Precision: 0.330594
Avg Recall: 1.000000
d_prime: 1.905839
train_loss: 0.013010
valid_loss: 1.003516
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0012012590179561386
Epoch-25 lr: 0.0012012590179561386
epoch 25 training time: 15.153
---------------
2023-09-11 20:52:39.535244
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03616	Per Sample Data Time 0.02790	Per Sample DNN Time 0.00826	Train Loss 0.0001	
start validation
acc: 0.838863
AUC: 0.913507
Avg Precision: 0.326367
Avg Recall: 1.000000
d_prime: 1.927105
train_loss: 0.014671
valid_loss: 1.003939
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0012012590179561386
Epoch-26 lr: 0.0012012590179561386
epoch 26 training time: 15.101
---------------
2023-09-11 20:52:54.636307
current #epochs=27, #steps=1040
start validation
acc: 0.838863
AUC: 0.916471
Avg Precision: 0.337780
Avg Recall: 1.000000
d_prime: 1.954048
train_loss: 0.014884
valid_loss: 1.010709
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0012012590179561386
Epoch-27 lr: 0.0012012590179561386
epoch 27 training time: 15.054
---------------
2023-09-11 20:53:09.690182
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00570	Train Loss 0.0174	
start validation
acc: 0.829384
AUC: 0.919475
Avg Precision: 0.352914
Avg Recall: 1.000000
d_prime: 1.982086
train_loss: 0.019665
valid_loss: 0.999221
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0012012590179561386
Epoch-28 lr: 0.0012012590179561386
epoch 28 training time: 15.277
---------------
2023-09-11 20:53:24.967179
current #epochs=29, #steps=1120
start validation
acc: 0.834123
AUC: 0.912480
Avg Precision: 0.365500
Avg Recall: 1.000000
d_prime: 1.917939
train_loss: 0.021932
valid_loss: 0.992381
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0012012590179561386
Epoch-29 lr: 0.0012012590179561386
epoch 29 training time: 15.259
---------------
2023-09-11 20:53:40.226572
current #epochs=30, #steps=1160
start validation
acc: 0.853081
AUC: 0.914369
Avg Precision: 0.349007
Avg Recall: 1.000000
d_prime: 1.934870
train_loss: 0.019531
valid_loss: 1.002036
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.001050960580752982
Epoch-30 lr: 0.001050960580752982
epoch 30 training time: 15.066
---------------
2023-09-11 20:53:55.292372
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03982	Per Sample Data Time 0.03054	Per Sample DNN Time 0.00928	Train Loss 0.0350	
start validation
acc: 0.834123
AUC: 0.913826
Avg Precision: 0.335384
Avg Recall: 1.000000
d_prime: 1.929979
train_loss: 0.011447
valid_loss: 0.998909
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.001050960580752982
Epoch-31 lr: 0.001050960580752982
epoch 31 training time: 15.252
---------------
2023-09-11 20:54:10.544210
current #epochs=32, #steps=1240
start validation
acc: 0.829384
AUC: 0.915991
Avg Precision: 0.348525
Avg Recall: 1.000000
d_prime: 1.949639
train_loss: 0.014415
valid_loss: 1.004803
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.001050960580752982
Epoch-32 lr: 0.001050960580752982
epoch 32 training time: 15.153
---------------
2023-09-11 20:54:25.697485
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00565	Train Loss 0.0149	
start validation
acc: 0.838863
AUC: 0.917265
Avg Precision: 0.333863
Avg Recall: 1.000000
d_prime: 1.961380
train_loss: 0.011572
valid_loss: 0.991939
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.001050960580752982
Epoch-33 lr: 0.001050960580752982
epoch 33 training time: 15.865
---------------
2023-09-11 20:54:41.562734
current #epochs=34, #steps=1320
start validation
acc: 0.829384
AUC: 0.914667
Avg Precision: 0.330478
Avg Recall: 1.000000
d_prime: 1.937563
train_loss: 0.013110
valid_loss: 0.997981
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.001050960580752982
Epoch-34 lr: 0.001050960580752982
epoch 34 training time: 15.161
---------------
2023-09-11 20:54:56.723395
current #epochs=35, #steps=1360
start validation
acc: 0.853081
AUC: 0.913365
Avg Precision: 0.333668
Avg Recall: 1.000000
d_prime: 1.925835
train_loss: 0.013856
valid_loss: 0.989297
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.001050960580752982
Epoch-35 lr: 0.001050960580752982
epoch 35 training time: 15.165
---------------
2023-09-11 20:55:11.888740
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03665	Per Sample Data Time 0.02866	Per Sample DNN Time 0.00798	Train Loss 0.0011	
start validation
acc: 0.843602
AUC: 0.923440
Avg Precision: 0.315595
Avg Recall: 1.000000
d_prime: 2.020341
train_loss: 0.017846
valid_loss: 0.983589
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.001050960580752982
Epoch-36 lr: 0.001050960580752982
epoch 36 training time: 15.034
---------------
2023-09-11 20:55:26.923062
current #epochs=37, #steps=1440
start validation
acc: 0.829384
AUC: 0.927520
Avg Precision: 0.312542
Avg Recall: 1.000000
d_prime: 2.061306
train_loss: 0.010001
valid_loss: 0.986288
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.001050960580752982
Epoch-37 lr: 0.001050960580752982
epoch 37 training time: 15.227
---------------
2023-09-11 20:55:42.150113
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00563	Train Loss 0.0084	
start validation
acc: 0.829384
AUC: 0.927397
Avg Precision: 0.309386
Avg Recall: 1.000000
d_prime: 2.060048
train_loss: 0.013522
valid_loss: 0.999901
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.001050960580752982
Epoch-38 lr: 0.001050960580752982
epoch 38 training time: 15.195
---------------
2023-09-11 20:55:57.345545
current #epochs=39, #steps=1520
start validation
acc: 0.838863
AUC: 0.925220
Avg Precision: 0.309633
Avg Recall: 1.000000
d_prime: 2.038005
train_loss: 0.017171
valid_loss: 1.006276
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0009194670972592643
Epoch-39 lr: 0.0009194670972592643
epoch 39 training time: 15.131
---------------
2023-09-11 20:56:12.477021
current #epochs=40, #steps=1560
start validation
acc: 0.843602
AUC: 0.919779
Avg Precision: 0.320377
Avg Recall: 1.000000
d_prime: 1.984970
train_loss: 0.009826
valid_loss: 1.008687
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0009194670972592643
Epoch-40 lr: 0.0009194670972592643
epoch 40 training time: 15.152
---------------
2023-09-11 20:56:27.628972
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03698	Per Sample Data Time 0.02892	Per Sample DNN Time 0.00806	Train Loss 0.0389	
start validation
acc: 0.824645
AUC: 0.916844
Avg Precision: 0.305126
Avg Recall: 1.000000
d_prime: 1.957491
train_loss: 0.014416
valid_loss: 1.013573
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0009194670972592643
Epoch-41 lr: 0.0009194670972592643
epoch 41 training time: 15.214
---------------
2023-09-11 20:56:42.842450
current #epochs=42, #steps=1640
start validation
[I 2023-09-11 20:56:57,869] Trial 84 finished with value: 0.8815165876777251 and parameters: {'warmup': 'False', 'num_epochs': 42, 'batch_size': 39, 'lr-adaptschedule': 'True', 'lr': 0.0017938551147302644, 'head-lr': 1, 'lr-scheduler-start': 3, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.8748825732364705}. Best is trial 75 with value: 0.8862559241706162.
acc: 0.824645
AUC: 0.920267
Avg Precision: 0.303571
Avg Recall: 1.000000
d_prime: 1.989619
train_loss: 0.015989
valid_loss: 0.990142
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0009194670972592643
Epoch-42 lr: 0.0009194670972592643
epoch 42 training time: 15.013
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f859ea60760>
The learning rate scheduler starts at 3 epoch with decay rate of 0.875 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 20:56:57.909826
current #epochs=1, #steps=0
start validation
acc: 0.857820
AUC: 0.921158
Avg Precision: 0.309583
Avg Recall: 1.000000
d_prime: 1.998144
train_loss: 0.025196
valid_loss: 1.002220
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0018540270229964566
Epoch-1 lr: 0.0018540270229964566
epoch 1 training time: 17.469
---------------
2023-09-11 20:57:15.378691
current #epochs=2, #steps=40
start validation
acc: 0.843602
AUC: 0.920274
Avg Precision: 0.309767
Avg Recall: 1.000000
d_prime: 1.989684
train_loss: 0.026559
valid_loss: 0.988483
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0018540270229964566
Epoch-2 lr: 0.0018540270229964566
epoch 2 training time: 15.297
---------------
2023-09-11 20:57:30.675611
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00560	Train Loss 0.0127	
start validation
acc: 0.829384
AUC: 0.916435
Avg Precision: 0.313164
Avg Recall: 1.000000
d_prime: 1.953716
train_loss: 0.017854
valid_loss: 0.997498
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0016223448666847285
Epoch-3 lr: 0.0016223448666847285
epoch 3 training time: 15.097
---------------
2023-09-11 20:57:45.772636
current #epochs=4, #steps=120
start validation
acc: 0.834123
AUC: 0.922673
Avg Precision: 0.317529
Avg Recall: 1.000000
d_prime: 2.012826
train_loss: 0.024323
valid_loss: 0.989517
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0016223448666847285
Epoch-4 lr: 0.0016223448666847285
epoch 4 training time: 15.219
---------------
2023-09-11 20:58:00.991220
current #epochs=5, #steps=160
start validation
acc: 0.843602
AUC: 0.918210
Avg Precision: 0.337600
Avg Recall: 1.000000
d_prime: 1.970188
train_loss: 0.022719
valid_loss: 0.995771
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0016223448666847285
Epoch-5 lr: 0.0016223448666847285
epoch 5 training time: 15.052
---------------
2023-09-11 20:58:16.042966
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03996	Per Sample Data Time 0.03002	Per Sample DNN Time 0.00995	Train Loss 0.0131	
start validation
acc: 0.838863
AUC: 0.939977
Avg Precision: 0.376054
Avg Recall: 1.000000
d_prime: 2.198505
train_loss: 0.028794
valid_loss: 0.988642
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0016223448666847285
Epoch-6 lr: 0.0016223448666847285
epoch 6 training time: 15.235
---------------
2023-09-11 20:58:31.278274
current #epochs=7, #steps=240
start validation
acc: 0.848341
AUC: 0.933966
Avg Precision: 0.362982
Avg Recall: 1.000000
d_prime: 2.129804
train_loss: 0.017594
valid_loss: 0.992157
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0016223448666847285
Epoch-7 lr: 0.0016223448666847285
epoch 7 training time: 15.247
---------------
2023-09-11 20:58:46.524917
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00564	Train Loss 0.0251	
start validation
acc: 0.867299
AUC: 0.928101
Avg Precision: 0.367972
Avg Recall: 1.000000
d_prime: 2.067291
train_loss: 0.027495
valid_loss: 0.989170
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0016223448666847285
Epoch-8 lr: 0.0016223448666847285
epoch 8 training time: 17.180
---------------
2023-09-11 20:59:03.705334
current #epochs=9, #steps=320
start validation
acc: 0.848341
AUC: 0.932700
Avg Precision: 0.362373
Avg Recall: 1.000000
d_prime: 2.115951
train_loss: 0.029218
valid_loss: 1.008949
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0016223448666847285
Epoch-9 lr: 0.0016223448666847285
epoch 9 training time: 15.033
---------------
2023-09-11 20:59:18.738865
current #epochs=10, #steps=360
start validation
acc: 0.838863
AUC: 0.929347
Avg Precision: 0.341149
Avg Recall: 1.000000
d_prime: 2.080231
train_loss: 0.031843
valid_loss: 0.984071
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0016223448666847285
Epoch-10 lr: 0.0016223448666847285
epoch 10 training time: 14.984
---------------
2023-09-11 20:59:33.722659
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03989	Per Sample Data Time 0.02992	Per Sample DNN Time 0.00997	Train Loss 0.0014	
start validation
acc: 0.848341
AUC: 0.931851
Avg Precision: 0.369806
Avg Recall: 1.000000
d_prime: 2.106778
train_loss: 0.032031
valid_loss: 0.987140
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0016223448666847285
Epoch-11 lr: 0.0016223448666847285
epoch 11 training time: 15.184
---------------
2023-09-11 20:59:48.906661
current #epochs=12, #steps=440
start validation
acc: 0.791469
AUC: 0.927777
Avg Precision: 0.326029
Avg Recall: 1.000000
d_prime: 2.063948
train_loss: 0.037837
valid_loss: 1.007748
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001419614079952555
Epoch-12 lr: 0.001419614079952555
epoch 12 training time: 16.546
---------------
2023-09-11 21:00:05.452950
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00722	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00569	Train Loss 0.0340	
start validation
acc: 0.857820
AUC: 0.930717
Avg Precision: 0.348369
Avg Recall: 1.000000
d_prime: 2.094662
train_loss: 0.029016
valid_loss: 0.972410
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.001419614079952555
Epoch-13 lr: 0.001419614079952555
epoch 13 training time: 16.603
---------------
2023-09-11 21:00:22.056047
current #epochs=14, #steps=520
start validation
acc: 0.853081
AUC: 0.919995
Avg Precision: 0.367205
Avg Recall: 1.000000
d_prime: 1.987024
train_loss: 0.018961
valid_loss: 1.009496
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.001419614079952555
Epoch-14 lr: 0.001419614079952555
epoch 14 training time: 15.181
---------------
2023-09-11 21:00:37.237283
current #epochs=15, #steps=560
start validation
acc: 0.824645
AUC: 0.916322
Avg Precision: 0.350736
Avg Recall: 1.000000
d_prime: 1.952679
train_loss: 0.024681
valid_loss: 1.003869
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.001419614079952555
Epoch-15 lr: 0.001419614079952555
epoch 15 training time: 15.119
---------------
2023-09-11 21:00:52.356664
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03850	Per Sample Data Time 0.03008	Per Sample DNN Time 0.00842	Train Loss 0.0116	
start validation
acc: 0.834123
AUC: 0.929804
Avg Precision: 0.363700
Avg Recall: 1.000000
d_prime: 2.085018
train_loss: 0.018249
valid_loss: 0.996531
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.001419614079952555
Epoch-16 lr: 0.001419614079952555
epoch 16 training time: 15.338
---------------
2023-09-11 21:01:07.694992
current #epochs=17, #steps=640
start validation
acc: 0.857820
AUC: 0.927444
Avg Precision: 0.359212
Avg Recall: 1.000000
d_prime: 2.060532
train_loss: 0.013590
valid_loss: 0.985402
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.001419614079952555
Epoch-17 lr: 0.001419614079952555
epoch 17 training time: 15.587
---------------
2023-09-11 21:01:23.281864
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00571	Train Loss 0.0142	
start validation
acc: 0.853081
AUC: 0.922398
Avg Precision: 0.368743
Avg Recall: 1.000000
d_prime: 2.010148
train_loss: 0.022440
valid_loss: 0.989412
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001419614079952555
Epoch-18 lr: 0.001419614079952555
epoch 18 training time: 15.135
---------------
2023-09-11 21:01:38.416619
current #epochs=19, #steps=720
start validation
acc: 0.867299
AUC: 0.930112
Avg Precision: 0.374104
Avg Recall: 1.000000
d_prime: 2.088261
train_loss: 0.026743
valid_loss: 0.991120
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.001419614079952555
Epoch-19 lr: 0.001419614079952555
epoch 19 training time: 15.242
---------------
2023-09-11 21:01:53.659199
current #epochs=20, #steps=760
start validation
acc: 0.834123
AUC: 0.931951
Avg Precision: 0.348479
Avg Recall: 1.000000
d_prime: 2.107859
train_loss: 0.022731
valid_loss: 0.983555
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.001419614079952555
Epoch-20 lr: 0.001419614079952555
epoch 20 training time: 16.041
---------------
2023-09-11 21:02:09.699765
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03940	Per Sample Data Time 0.02879	Per Sample DNN Time 0.01062	Train Loss 0.0102	
start validation
acc: 0.829384
AUC: 0.924469
Avg Precision: 0.382145
Avg Recall: 1.000000
d_prime: 2.030515
train_loss: 0.026749
valid_loss: 1.006075
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0012422168537555307
Epoch-21 lr: 0.0012422168537555307
epoch 21 training time: 15.218
---------------
2023-09-11 21:02:24.917836
current #epochs=22, #steps=840
start validation
acc: 0.848341
AUC: 0.929922
Avg Precision: 0.389485
Avg Recall: 1.000000
d_prime: 2.086263
train_loss: 0.021275
valid_loss: 1.004182
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0012422168537555307
Epoch-22 lr: 0.0012422168537555307
epoch 22 training time: 15.199
---------------
2023-09-11 21:02:40.117092
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00565	Train Loss 0.0130	
start validation
acc: 0.843602
AUC: 0.932216
Avg Precision: 0.393288
Avg Recall: 1.000000
d_prime: 2.110719
train_loss: 0.011412
valid_loss: 0.988702
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0012422168537555307
Epoch-23 lr: 0.0012422168537555307
epoch 23 training time: 15.142
---------------
2023-09-11 21:02:55.259308
current #epochs=24, #steps=920
start validation
acc: 0.834123
AUC: 0.924589
Avg Precision: 0.366938
Avg Recall: 1.000000
d_prime: 2.031705
train_loss: 0.013718
valid_loss: 0.995212
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0012422168537555307
Epoch-24 lr: 0.0012422168537555307
epoch 24 training time: 15.290
---------------
2023-09-11 21:03:10.548915
current #epochs=25, #steps=960
start validation
acc: 0.834123
AUC: 0.928132
Avg Precision: 0.325717
Avg Recall: 1.000000
d_prime: 2.067607
train_loss: 0.021046
valid_loss: 0.995608
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0012422168537555307
Epoch-25 lr: 0.0012422168537555307
epoch 25 training time: 15.150
---------------
2023-09-11 21:03:25.699091
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03779	Per Sample Data Time 0.03000	Per Sample DNN Time 0.00779	Train Loss 0.0388	
start validation
acc: 0.838863
AUC: 0.930200
Avg Precision: 0.359602
Avg Recall: 1.000000
d_prime: 2.089196
train_loss: 0.009961
valid_loss: 0.997207
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0012422168537555307
Epoch-26 lr: 0.0012422168537555307
epoch 26 training time: 15.200
---------------
2023-09-11 21:03:40.899066
current #epochs=27, #steps=1040
start validation
acc: 0.853081
AUC: 0.936813
Avg Precision: 0.383767
Avg Recall: 1.000000
d_prime: 2.161710
train_loss: 0.014466
valid_loss: 0.974257
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0012422168537555307
Epoch-27 lr: 0.0012422168537555307
epoch 27 training time: 15.038
---------------
2023-09-11 21:03:55.937693
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00723	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00569	Train Loss 0.0205	
start validation
acc: 0.867299
AUC: 0.935014
Avg Precision: 0.368888
Avg Recall: 1.000000
d_prime: 2.141414
train_loss: 0.025292
valid_loss: 0.996626
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0012422168537555307
Epoch-28 lr: 0.0012422168537555307
epoch 28 training time: 15.137
---------------
2023-09-11 21:04:11.074938
current #epochs=29, #steps=1120
start validation
acc: 0.853081
AUC: 0.930479
Avg Precision: 0.354776
Avg Recall: 1.000000
d_prime: 2.092145
train_loss: 0.028096
valid_loss: 0.983639
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0012422168537555307
Epoch-29 lr: 0.0012422168537555307
epoch 29 training time: 15.068
---------------
2023-09-11 21:04:26.143023
current #epochs=30, #steps=1160
start validation
acc: 0.843602
AUC: 0.935519
Avg Precision: 0.372762
Avg Recall: 1.000000
d_prime: 2.147070
train_loss: 0.007699
valid_loss: 0.987193
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0010869874662033936
Epoch-30 lr: 0.0010869874662033936
epoch 30 training time: 15.182
---------------
2023-09-11 21:04:41.324413
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03759	Per Sample Data Time 0.02982	Per Sample DNN Time 0.00776	Train Loss 0.0009	
start validation
acc: 0.843602
AUC: 0.928888
Avg Precision: 0.341500
Avg Recall: 1.000000
d_prime: 2.075440
train_loss: 0.017161
valid_loss: 0.994505
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0010869874662033936
Epoch-31 lr: 0.0010869874662033936
epoch 31 training time: 15.224
---------------
2023-09-11 21:04:56.548836
current #epochs=32, #steps=1240
start validation
acc: 0.848341
AUC: 0.924721
Avg Precision: 0.344117
Avg Recall: 1.000000
d_prime: 2.033026
train_loss: 0.019972
valid_loss: 1.000616
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0010869874662033936
Epoch-32 lr: 0.0010869874662033936
epoch 32 training time: 15.101
---------------
2023-09-11 21:05:11.649956
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00565	Train Loss 0.0205	
start validation
acc: 0.848341
AUC: 0.930241
Avg Precision: 0.384327
Avg Recall: 1.000000
d_prime: 2.089630
train_loss: 0.017208
valid_loss: 1.000172
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0010869874662033936
Epoch-33 lr: 0.0010869874662033936
epoch 33 training time: 15.168
---------------
2023-09-11 21:05:26.818143
current #epochs=34, #steps=1320
start validation
acc: 0.862559
AUC: 0.934837
Avg Precision: 0.372991
Avg Recall: 1.000000
d_prime: 2.139445
train_loss: 0.014666
valid_loss: 0.998683
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0010869874662033936
Epoch-34 lr: 0.0010869874662033936
epoch 34 training time: 15.169
---------------
2023-09-11 21:05:41.987470
current #epochs=35, #steps=1360
start validation
acc: 0.867299
AUC: 0.932803
Avg Precision: 0.375891
Avg Recall: 1.000000
d_prime: 2.117075
train_loss: 0.012713
valid_loss: 0.988321
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0010869874662033936
Epoch-35 lr: 0.0010869874662033936
epoch 35 training time: 15.097
---------------
2023-09-11 21:05:57.083991
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.04069	Per Sample Data Time 0.03034	Per Sample DNN Time 0.01034	Train Loss 0.0078	
start validation
acc: 0.876777
AUC: 0.934165
Avg Precision: 0.377753
Avg Recall: 1.000000
d_prime: 2.131995
train_loss: 0.013771
valid_loss: 0.979472
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0010869874662033936
Epoch-36 lr: 0.0010869874662033936
epoch 36 training time: 17.189
---------------
2023-09-11 21:06:14.273039
current #epochs=37, #steps=1440
start validation
acc: 0.872038
AUC: 0.933848
Avg Precision: 0.369033
Avg Recall: 1.000000
d_prime: 2.128501
train_loss: 0.011716
valid_loss: 0.972131
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0010869874662033936
Epoch-37 lr: 0.0010869874662033936
epoch 37 training time: 15.254
---------------
2023-09-11 21:06:29.526791
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00729	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00573	Train Loss 0.0154	
start validation
acc: 0.862559
AUC: 0.930567
Avg Precision: 0.360485
Avg Recall: 1.000000
d_prime: 2.093073
train_loss: 0.016475
valid_loss: 0.971595
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0010869874662033936
Epoch-38 lr: 0.0010869874662033936
epoch 38 training time: 15.120
---------------
2023-09-11 21:06:44.646841
current #epochs=39, #steps=1520
start validation
acc: 0.853081
AUC: 0.928964
Avg Precision: 0.352111
Avg Recall: 1.000000
d_prime: 2.076229
train_loss: 0.011494
valid_loss: 0.984375
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0009511557890324696
Epoch-39 lr: 0.0009511557890324696
epoch 39 training time: 15.270
---------------
2023-09-11 21:06:59.916864
current #epochs=40, #steps=1560
start validation
acc: 0.862559
AUC: 0.934154
Avg Precision: 0.343019
Avg Recall: 1.000000
d_prime: 2.131878
train_loss: 0.010839
valid_loss: 0.971229
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0009511557890324696
Epoch-40 lr: 0.0009511557890324696
epoch 40 training time: 15.177
---------------
2023-09-11 21:07:15.094232
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03644	Per Sample Data Time 0.02842	Per Sample DNN Time 0.00802	Train Loss 0.0227	
start validation
acc: 0.853081
AUC: 0.934661
Avg Precision: 0.359474
Avg Recall: 1.000000
d_prime: 2.137487
train_loss: 0.015857
valid_loss: 0.988900
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0009511557890324696
Epoch-41 lr: 0.0009511557890324696
epoch 41 training time: 15.104
---------------
2023-09-11 21:07:30.198549
current #epochs=42, #steps=1640
start validation
[I 2023-09-11 21:07:45,416] Trial 85 finished with value: 0.8767772511848341 and parameters: {'warmup': 'False', 'num_epochs': 42, 'batch_size': 42, 'lr-adaptschedule': 'True', 'lr': 0.0018540270229964566, 'head-lr': 1, 'lr-scheduler-start': 3, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.8750384145225207}. Best is trial 75 with value: 0.8862559241706162.
acc: 0.857820
AUC: 0.933692
Avg Precision: 0.361036
Avg Recall: 1.000000
d_prime: 2.126789
train_loss: 0.021242
valid_loss: 0.998461
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0009511557890324696
Epoch-42 lr: 0.0009511557890324696
epoch 42 training time: 15.202
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f8667020fa0>
The learning rate scheduler starts at 3 epoch with decay rate of 0.874 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 21:07:45.459500
current #epochs=1, #steps=0
start validation
acc: 0.824645
AUC: 0.927054
Avg Precision: 0.329717
Avg Recall: 1.000000
d_prime: 2.056541
train_loss: 0.019590
valid_loss: 1.000736
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0018052868599712708
Epoch-1 lr: 0.0018052868599712708
epoch 1 training time: 18.891
---------------
2023-09-11 21:08:04.350859
current #epochs=2, #steps=40
start validation
acc: 0.834123
AUC: 0.912112
Avg Precision: 0.348020
Avg Recall: 1.000000
d_prime: 1.914667
train_loss: 0.029773
valid_loss: 0.999655
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0018052868599712708
Epoch-2 lr: 0.0018052868599712708
epoch 2 training time: 17.158
---------------
2023-09-11 21:08:21.509040
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00729	Per Sample Data Time 0.00157	Per Sample DNN Time 0.00572	Train Loss 0.0298	
start validation
acc: 0.838863
AUC: 0.907601
Avg Precision: 0.317297
Avg Recall: 1.000000
d_prime: 1.875421
train_loss: 0.026157
valid_loss: 1.011507
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0015776867270521106
Epoch-3 lr: 0.0015776867270521106
epoch 3 training time: 19.047
---------------
2023-09-11 21:08:40.556317
current #epochs=4, #steps=120
start validation
acc: 0.838863
AUC: 0.917896
Avg Precision: 0.341235
Avg Recall: 1.000000
d_prime: 1.967256
train_loss: 0.018956
valid_loss: 1.010457
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0015776867270521106
Epoch-4 lr: 0.0015776867270521106
epoch 4 training time: 15.626
---------------
2023-09-11 21:08:56.182773
current #epochs=5, #steps=160
start validation
acc: 0.819905
AUC: 0.908182
Avg Precision: 0.362439
Avg Recall: 1.000000
d_prime: 1.880402
train_loss: 0.019766
valid_loss: 1.018035
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0015776867270521106
Epoch-5 lr: 0.0015776867270521106
epoch 5 training time: 15.122
---------------
2023-09-11 21:09:11.304429
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03997	Per Sample Data Time 0.02923	Per Sample DNN Time 0.01073	Train Loss 0.0341	
start validation
acc: 0.819905
AUC: 0.913601
Avg Precision: 0.353154
Avg Recall: 1.000000
d_prime: 1.927952
train_loss: 0.023576
valid_loss: 1.004577
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0015776867270521106
Epoch-6 lr: 0.0015776867270521106
epoch 6 training time: 15.810
---------------
2023-09-11 21:09:27.113946
current #epochs=7, #steps=240
start validation
acc: 0.843602
AUC: 0.912966
Avg Precision: 0.339791
Avg Recall: 1.000000
d_prime: 1.922271
train_loss: 0.022440
valid_loss: 0.987310
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0015776867270521106
Epoch-7 lr: 0.0015776867270521106
epoch 7 training time: 17.340
---------------
2023-09-11 21:09:44.453936
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00728	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00578	Train Loss 0.0191	
start validation
acc: 0.834123
AUC: 0.909542
Avg Precision: 0.349044
Avg Recall: 1.000000
d_prime: 1.892129
train_loss: 0.018702
valid_loss: 1.010495
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0015776867270521106
Epoch-8 lr: 0.0015776867270521106
epoch 8 training time: 15.343
---------------
2023-09-11 21:09:59.797299
current #epochs=9, #steps=320
start validation
acc: 0.848341
AUC: 0.917728
Avg Precision: 0.343757
Avg Recall: 1.000000
d_prime: 1.965686
train_loss: 0.022737
valid_loss: 0.979241
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0015776867270521106
Epoch-9 lr: 0.0015776867270521106
epoch 9 training time: 17.174
---------------
2023-09-11 21:10:16.971777
current #epochs=10, #steps=360
start validation
acc: 0.848341
AUC: 0.924953
Avg Precision: 0.317874
Avg Recall: 1.000000
d_prime: 2.035340
train_loss: 0.020109
valid_loss: 0.971197
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0015776867270521106
Epoch-10 lr: 0.0015776867270521106
epoch 10 training time: 15.438
---------------
2023-09-11 21:10:32.409769
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03657	Per Sample Data Time 0.02799	Per Sample DNN Time 0.00857	Train Loss 0.0138	
start validation
acc: 0.853081
AUC: 0.922448
Avg Precision: 0.346102
Avg Recall: 1.000000
d_prime: 2.010634
train_loss: 0.028892
valid_loss: 0.963086
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0015776867270521106
Epoch-11 lr: 0.0015776867270521106
epoch 11 training time: 17.909
---------------
2023-09-11 21:10:50.318342
current #epochs=12, #steps=440
start validation
acc: 0.853081
AUC: 0.914163
Avg Precision: 0.307747
Avg Recall: 1.000000
d_prime: 1.933014
train_loss: 0.016985
valid_loss: 0.979627
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0013787811033843188
Epoch-12 lr: 0.0013787811033843188
epoch 12 training time: 15.364
---------------
2023-09-11 21:11:05.682010
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00565	Train Loss 0.0230	
start validation
acc: 0.848341
AUC: 0.918233
Avg Precision: 0.311205
Avg Recall: 1.000000
d_prime: 1.970402
train_loss: 0.021978
valid_loss: 0.974333
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0013787811033843188
Epoch-13 lr: 0.0013787811033843188
epoch 13 training time: 15.272
---------------
2023-09-11 21:11:20.954110
current #epochs=14, #steps=520
start validation
acc: 0.843602
AUC: 0.917997
Avg Precision: 0.318609
Avg Recall: 1.000000
d_prime: 1.968195
train_loss: 0.025286
valid_loss: 0.992334
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0013787811033843188
Epoch-14 lr: 0.0013787811033843188
epoch 14 training time: 15.211
---------------
2023-09-11 21:11:36.164844
current #epochs=15, #steps=560
start validation
acc: 0.815166
AUC: 0.917874
Avg Precision: 0.343352
Avg Recall: 1.000000
d_prime: 1.967044
train_loss: 0.022893
valid_loss: 0.990032
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0013787811033843188
Epoch-15 lr: 0.0013787811033843188
epoch 15 training time: 15.391
---------------
2023-09-11 21:11:51.556191
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03713	Per Sample Data Time 0.02934	Per Sample DNN Time 0.00779	Train Loss 0.0022	
start validation
acc: 0.819905
AUC: 0.931724
Avg Precision: 0.380971
Avg Recall: 1.000000
d_prime: 2.105421
train_loss: 0.022490
valid_loss: 1.004734
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0013787811033843188
Epoch-16 lr: 0.0013787811033843188
epoch 16 training time: 15.199
---------------
2023-09-11 21:12:06.755142
current #epochs=17, #steps=640
start validation
acc: 0.824645
AUC: 0.922663
Avg Precision: 0.351804
Avg Recall: 1.000000
d_prime: 2.012727
train_loss: 0.017606
valid_loss: 1.016447
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0013787811033843188
Epoch-17 lr: 0.0013787811033843188
epoch 17 training time: 15.028
---------------
2023-09-11 21:12:21.783267
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00724	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00573	Train Loss 0.0237	
start validation
acc: 0.848341
AUC: 0.918096
Avg Precision: 0.340814
Avg Recall: 1.000000
d_prime: 1.969120
train_loss: 0.022959
valid_loss: 1.004867
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0013787811033843188
Epoch-18 lr: 0.0013787811033843188
epoch 18 training time: 15.313
---------------
2023-09-11 21:12:37.095873
current #epochs=19, #steps=720
start validation
acc: 0.834123
AUC: 0.916238
Avg Precision: 0.347044
Avg Recall: 1.000000
d_prime: 1.951899
train_loss: 0.021973
valid_loss: 0.993367
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0013787811033843188
Epoch-19 lr: 0.0013787811033843188
epoch 19 training time: 15.183
---------------
2023-09-11 21:12:52.279056
current #epochs=20, #steps=760
start validation
acc: 0.848341
AUC: 0.935753
Avg Precision: 0.347329
Avg Recall: 1.000000
d_prime: 2.149700
train_loss: 0.029454
valid_loss: 0.979405
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0013787811033843188
Epoch-20 lr: 0.0013787811033843188
epoch 20 training time: 15.291
---------------
2023-09-11 21:13:07.569996
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03878	Per Sample Data Time 0.02874	Per Sample DNN Time 0.01005	Train Loss 0.0022	
start validation
acc: 0.867299
AUC: 0.932535
Avg Precision: 0.358582
Avg Recall: 1.000000
d_prime: 2.114170
train_loss: 0.019356
valid_loss: 0.966593
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0012049523510930119
Epoch-21 lr: 0.0012049523510930119
epoch 21 training time: 18.189
---------------
2023-09-11 21:13:25.758833
current #epochs=22, #steps=840
start validation
acc: 0.843602
AUC: 0.934644
Avg Precision: 0.365088
Avg Recall: 1.000000
d_prime: 2.137300
train_loss: 0.019404
valid_loss: 0.977277
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0012049523510930119
Epoch-22 lr: 0.0012049523510930119
epoch 22 training time: 15.289
---------------
2023-09-11 21:13:41.047876
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00726	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00572	Train Loss 0.0103	
start validation
acc: 0.848341
AUC: 0.933728
Avg Precision: 0.340906
Avg Recall: 1.000000
d_prime: 2.127179
train_loss: 0.010959
valid_loss: 0.968701
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0012049523510930119
Epoch-23 lr: 0.0012049523510930119
epoch 23 training time: 15.796
---------------
2023-09-11 21:13:56.843567
current #epochs=24, #steps=920
start validation
acc: 0.848341
AUC: 0.930292
Avg Precision: 0.355926
Avg Recall: 1.000000
d_prime: 2.090160
train_loss: 0.014481
valid_loss: 0.988667
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0012049523510930119
Epoch-24 lr: 0.0012049523510930119
epoch 24 training time: 16.363
---------------
2023-09-11 21:14:13.206851
current #epochs=25, #steps=960
start validation
acc: 0.853081
AUC: 0.938049
Avg Precision: 0.359644
Avg Recall: 1.000000
d_prime: 2.175911
train_loss: 0.009273
valid_loss: 0.957627
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0012049523510930119
Epoch-25 lr: 0.0012049523510930119
epoch 25 training time: 15.584
---------------
2023-09-11 21:14:28.790823
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03591	Per Sample Data Time 0.02807	Per Sample DNN Time 0.00784	Train Loss 0.0177	
start validation
acc: 0.853081
AUC: 0.935171
Avg Precision: 0.366895
Avg Recall: 1.000000
d_prime: 2.143169
train_loss: 0.019094
valid_loss: 0.969568
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0012049523510930119
Epoch-26 lr: 0.0012049523510930119
epoch 26 training time: 14.986
---------------
2023-09-11 21:14:43.776779
current #epochs=27, #steps=1040
start validation
acc: 0.834123
AUC: 0.942841
Avg Precision: 0.362057
Avg Recall: 1.000000
d_prime: 2.233151
train_loss: 0.021612
valid_loss: 0.976498
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0012049523510930119
Epoch-27 lr: 0.0012049523510930119
epoch 27 training time: 15.151
---------------
2023-09-11 21:14:58.928469
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00722	Per Sample Data Time 0.00157	Per Sample DNN Time 0.00566	Train Loss 0.0210	
start validation
acc: 0.853081
AUC: 0.943354
Avg Precision: 0.353758
Avg Recall: 1.000000
d_prime: 2.239508
train_loss: 0.018877
valid_loss: 0.978177
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0012049523510930119
Epoch-28 lr: 0.0012049523510930119
epoch 28 training time: 15.362
---------------
2023-09-11 21:15:14.290674
current #epochs=29, #steps=1120
start validation
acc: 0.838863
AUC: 0.935155
Avg Precision: 0.353917
Avg Recall: 1.000000
d_prime: 2.142989
train_loss: 0.019711
valid_loss: 0.980226
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0012049523510930119
Epoch-29 lr: 0.0012049523510930119
epoch 29 training time: 15.503
---------------
2023-09-11 21:15:29.793839
current #epochs=30, #steps=1160
start validation
acc: 0.853081
AUC: 0.936679
Avg Precision: 0.349939
Avg Recall: 1.000000
d_prime: 2.160180
train_loss: 0.018378
valid_loss: 0.974688
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0010530389231769696
Epoch-30 lr: 0.0010530389231769696
epoch 30 training time: 15.282
---------------
2023-09-11 21:15:45.075605
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03693	Per Sample Data Time 0.02863	Per Sample DNN Time 0.00830	Train Loss 0.0073	
start validation
acc: 0.862559
AUC: 0.933593
Avg Precision: 0.355370
Avg Recall: 1.000000
d_prime: 2.125700
train_loss: 0.012262
valid_loss: 0.982343
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0010530389231769696
Epoch-31 lr: 0.0010530389231769696
epoch 31 training time: 16.395
---------------
2023-09-11 21:16:01.470798
current #epochs=32, #steps=1240
start validation
acc: 0.848341
AUC: 0.933788
Avg Precision: 0.351367
Avg Recall: 1.000000
d_prime: 2.127846
train_loss: 0.013922
valid_loss: 0.981467
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0010530389231769696
Epoch-32 lr: 0.0010530389231769696
epoch 32 training time: 15.137
---------------
2023-09-11 21:16:16.607616
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00565	Train Loss 0.0202	
start validation
acc: 0.838863
AUC: 0.930160
Avg Precision: 0.343253
Avg Recall: 1.000000
d_prime: 2.088765
train_loss: 0.015027
valid_loss: 1.002220
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0010530389231769696
Epoch-33 lr: 0.0010530389231769696
epoch 33 training time: 15.162
---------------
2023-09-11 21:16:31.769855
current #epochs=34, #steps=1320
start validation
acc: 0.838863
AUC: 0.928994
Avg Precision: 0.400662
Avg Recall: 1.000000
d_prime: 2.076545
train_loss: 0.017572
valid_loss: 1.003668
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0010530389231769696
Epoch-34 lr: 0.0010530389231769696
epoch 34 training time: 15.104
---------------
2023-09-11 21:16:46.874169
current #epochs=35, #steps=1360
start validation
acc: 0.848341
AUC: 0.930948
Avg Precision: 0.370568
Avg Recall: 1.000000
d_prime: 2.097117
train_loss: 0.018995
valid_loss: 1.008798
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0010530389231769696
Epoch-35 lr: 0.0010530389231769696
epoch 35 training time: 15.135
---------------
2023-09-11 21:17:02.008837
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03892	Per Sample Data Time 0.02817	Per Sample DNN Time 0.01075	Train Loss 0.0041	
start validation
acc: 0.843602
AUC: 0.932786
Avg Precision: 0.353876
Avg Recall: 1.000000
d_prime: 2.116886
train_loss: 0.020283
valid_loss: 0.985937
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0010530389231769696
Epoch-36 lr: 0.0010530389231769696
epoch 36 training time: 15.466
---------------
2023-09-11 21:17:17.474654
current #epochs=37, #steps=1440
start validation
acc: 0.838863
AUC: 0.918435
Avg Precision: 0.327603
Avg Recall: 1.000000
d_prime: 1.972291
train_loss: 0.019711
valid_loss: 1.010928
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0010530389231769696
Epoch-37 lr: 0.0010530389231769696
epoch 37 training time: 15.246
---------------
2023-09-11 21:17:32.720322
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00726	Per Sample Data Time 0.00162	Per Sample DNN Time 0.00564	Train Loss 0.0129	
start validation
acc: 0.805687
AUC: 0.919556
Avg Precision: 0.346052
Avg Recall: 1.000000
d_prime: 1.982860
train_loss: 0.015820
valid_loss: 1.016832
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0010530389231769696
Epoch-38 lr: 0.0010530389231769696
epoch 38 training time: 17.602
---------------
2023-09-11 21:17:50.322590
current #epochs=39, #steps=1520
start validation
acc: 0.838863
AUC: 0.923231
Avg Precision: 0.367018
Avg Recall: 1.000000
d_prime: 2.018284
train_loss: 0.009271
valid_loss: 0.995829
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0009202778622074449
Epoch-39 lr: 0.0009202778622074449
epoch 39 training time: 15.225
---------------
2023-09-11 21:18:05.547506
current #epochs=40, #steps=1560
start validation
acc: 0.848341
AUC: 0.912941
Avg Precision: 0.364898
Avg Recall: 1.000000
d_prime: 1.922041
train_loss: 0.016353
valid_loss: 1.015001
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0009202778622074449
Epoch-40 lr: 0.0009202778622074449
epoch 40 training time: 15.262
---------------
2023-09-11 21:18:20.809596
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03838	Per Sample Data Time 0.02915	Per Sample DNN Time 0.00923	Train Loss 0.0963	
start validation
acc: 0.848341
AUC: 0.916648
Avg Precision: 0.347321
Avg Recall: 1.000000
d_prime: 1.955680
train_loss: 0.017170
valid_loss: 1.026707
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0009202778622074449
Epoch-41 lr: 0.0009202778622074449
epoch 41 training time: 16.600
---------------
2023-09-11 21:18:37.409213
current #epochs=42, #steps=1640
start validation
[I 2023-09-11 21:18:52,631] Trial 86 finished with value: 0.8672985781990521 and parameters: {'warmup': 'False', 'num_epochs': 42, 'batch_size': 38, 'lr-adaptschedule': 'True', 'lr': 0.0018052868599712708, 'head-lr': 1, 'lr-scheduler-start': 3, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.873925779904706}. Best is trial 75 with value: 0.8862559241706162.
acc: 0.838863
AUC: 0.926807
Avg Precision: 0.346058
Avg Recall: 1.000000
d_prime: 2.054025
train_loss: 0.012386
valid_loss: 0.996149
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0009202778622074449
Epoch-42 lr: 0.0009202778622074449
epoch 42 training time: 15.207
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863d988370>
The learning rate scheduler starts at 3 epoch with decay rate of 0.892 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 21:18:52.671492
current #epochs=1, #steps=0
start validation
acc: 0.843602
AUC: 0.926306
Avg Precision: 0.331172
Avg Recall: 1.000000
d_prime: 2.048942
train_loss: 0.028826
valid_loss: 1.018643
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0019618578920170375
Epoch-1 lr: 0.0019618578920170375
epoch 1 training time: 17.026
---------------
2023-09-11 21:19:09.698054
current #epochs=2, #steps=40
start validation
acc: 0.853081
AUC: 0.931369
Avg Precision: 0.356156
Avg Recall: 1.000000
d_prime: 2.101615
train_loss: 0.027311
valid_loss: 0.977199
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0019618578920170375
Epoch-2 lr: 0.0019618578920170375
epoch 2 training time: 17.316
---------------
2023-09-11 21:19:27.014154
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00727	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00570	Train Loss 0.0198	
start validation
acc: 0.857820
AUC: 0.943257
Avg Precision: 0.394036
Avg Recall: 1.000000
d_prime: 2.238297
train_loss: 0.018653
valid_loss: 0.971778
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0017498011832972526
Epoch-3 lr: 0.0017498011832972526
epoch 3 training time: 19.661
---------------
2023-09-11 21:19:46.675787
current #epochs=4, #steps=120
start validation
acc: 0.881517
AUC: 0.944404
Avg Precision: 0.364028
Avg Recall: 1.000000
d_prime: 2.252646
train_loss: 0.015835
valid_loss: 0.952418
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0017498011832972526
Epoch-4 lr: 0.0017498011832972526
epoch 4 training time: 17.279
---------------
2023-09-11 21:20:03.954166
current #epochs=5, #steps=160
start validation
acc: 0.843602
AUC: 0.938168
Avg Precision: 0.370907
Avg Recall: 1.000000
d_prime: 2.177285
train_loss: 0.023535
valid_loss: 0.986009
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0017498011832972526
Epoch-5 lr: 0.0017498011832972526
epoch 5 training time: 15.194
---------------
2023-09-11 21:20:19.148413
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03917	Per Sample Data Time 0.02824	Per Sample DNN Time 0.01093	Train Loss 0.0282	
start validation
acc: 0.853081
AUC: 0.942655
Avg Precision: 0.391861
Avg Recall: 1.000000
d_prime: 2.230869
train_loss: 0.014776
valid_loss: 0.976722
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0017498011832972526
Epoch-6 lr: 0.0017498011832972526
epoch 6 training time: 15.185
---------------
2023-09-11 21:20:34.333329
current #epochs=7, #steps=240
start validation
acc: 0.834123
AUC: 0.940826
Avg Precision: 0.395557
Avg Recall: 1.000000
d_prime: 2.208646
train_loss: 0.015695
valid_loss: 0.967979
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0017498011832972526
Epoch-7 lr: 0.0017498011832972526
epoch 7 training time: 16.610
---------------
2023-09-11 21:20:50.943358
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00564	Train Loss 0.0210	
start validation
acc: 0.838863
AUC: 0.935352
Avg Precision: 0.345193
Avg Recall: 1.000000
d_prime: 2.145199
train_loss: 0.030270
valid_loss: 0.975236
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0017498011832972526
Epoch-8 lr: 0.0017498011832972526
epoch 8 training time: 15.166
---------------
2023-09-11 21:21:06.109546
current #epochs=9, #steps=320
start validation
acc: 0.853081
AUC: 0.925517
Avg Precision: 0.321396
Avg Recall: 1.000000
d_prime: 2.040985
train_loss: 0.037165
valid_loss: 1.003935
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0017498011832972526
Epoch-9 lr: 0.0017498011832972526
epoch 9 training time: 15.191
---------------
2023-09-11 21:21:21.300825
current #epochs=10, #steps=360
start validation
acc: 0.848341
AUC: 0.925448
Avg Precision: 0.355512
Avg Recall: 1.000000
d_prime: 2.040286
train_loss: 0.027120
valid_loss: 1.013917
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0017498011832972526
Epoch-10 lr: 0.0017498011832972526
epoch 10 training time: 15.163
---------------
2023-09-11 21:21:36.463903
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03714	Per Sample Data Time 0.02927	Per Sample DNN Time 0.00787	Train Loss 0.0259	
start validation
acc: 0.853081
AUC: 0.931900
Avg Precision: 0.332825
Avg Recall: 1.000000
d_prime: 2.107311
train_loss: 0.020423
valid_loss: 0.985423
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0017498011832972526
Epoch-11 lr: 0.0017498011832972526
epoch 11 training time: 15.240
---------------
2023-09-11 21:21:51.703813
current #epochs=12, #steps=440
start validation
acc: 0.834123
AUC: 0.931063
Avg Precision: 0.380531
Avg Recall: 1.000000
d_prime: 2.098342
train_loss: 0.017470
valid_loss: 0.993427
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0015606656290076874
Epoch-12 lr: 0.0015606656290076874
epoch 12 training time: 15.103
---------------
2023-09-11 21:22:06.806670
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00727	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00574	Train Loss 0.0181	
start validation
acc: 0.853081
AUC: 0.930260
Avg Precision: 0.345090
Avg Recall: 1.000000
d_prime: 2.089826
train_loss: 0.023820
valid_loss: 0.989262
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0015606656290076874
Epoch-13 lr: 0.0015606656290076874
epoch 13 training time: 15.225
---------------
2023-09-11 21:22:22.032101
current #epochs=14, #steps=520
start validation
acc: 0.843602
AUC: 0.915835
Avg Precision: 0.327615
Avg Recall: 1.000000
d_prime: 1.948211
train_loss: 0.019083
valid_loss: 1.012855
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0015606656290076874
Epoch-14 lr: 0.0015606656290076874
epoch 14 training time: 15.154
---------------
2023-09-11 21:22:37.185771
current #epochs=15, #steps=560
start validation
acc: 0.824645
AUC: 0.924659
Avg Precision: 0.359891
Avg Recall: 1.000000
d_prime: 2.032406
train_loss: 0.030285
valid_loss: 1.005162
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0015606656290076874
Epoch-15 lr: 0.0015606656290076874
epoch 15 training time: 15.885
---------------
2023-09-11 21:22:53.071090
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03784	Per Sample Data Time 0.02796	Per Sample DNN Time 0.00988	Train Loss 0.0802	
start validation
acc: 0.838863
AUC: 0.919222
Avg Precision: 0.348571
Avg Recall: 1.000000
d_prime: 1.979697
train_loss: 0.023254
valid_loss: 0.995372
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0015606656290076874
Epoch-16 lr: 0.0015606656290076874
epoch 16 training time: 16.533
---------------
2023-09-11 21:23:09.604015
current #epochs=17, #steps=640
start validation
acc: 0.834123
AUC: 0.922796
Avg Precision: 0.358732
Avg Recall: 1.000000
d_prime: 2.014029
train_loss: 0.015758
valid_loss: 0.995900
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0015606656290076874
Epoch-17 lr: 0.0015606656290076874
epoch 17 training time: 16.394
---------------
2023-09-11 21:23:25.998101
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00563	Train Loss 0.0222	
start validation
acc: 0.853081
AUC: 0.931173
Avg Precision: 0.380097
Avg Recall: 1.000000
d_prime: 2.099523
train_loss: 0.018764
valid_loss: 0.996768
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0015606656290076874
Epoch-18 lr: 0.0015606656290076874
epoch 18 training time: 15.334
---------------
2023-09-11 21:23:41.332079
current #epochs=19, #steps=720
start validation
acc: 0.848341
AUC: 0.929172
Avg Precision: 0.358311
Avg Recall: 1.000000
d_prime: 2.078406
train_loss: 0.026821
valid_loss: 0.998963
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0015606656290076874
Epoch-19 lr: 0.0015606656290076874
epoch 19 training time: 16.217
---------------
2023-09-11 21:23:57.549324
current #epochs=20, #steps=760
start validation
acc: 0.881517
AUC: 0.930170
Avg Precision: 0.360279
Avg Recall: 1.000000
d_prime: 2.088875
train_loss: 0.015821
valid_loss: 0.988263
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0015606656290076874
Epoch-20 lr: 0.0015606656290076874
epoch 20 training time: 15.165
---------------
2023-09-11 21:24:12.714664
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03623	Per Sample Data Time 0.02786	Per Sample DNN Time 0.00837	Train Loss 0.0000	
start validation
acc: 0.843602
AUC: 0.931449
Avg Precision: 0.367055
Avg Recall: 1.000000
d_prime: 2.102469
train_loss: 0.018412
valid_loss: 0.976646
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.001391973687534187
Epoch-21 lr: 0.001391973687534187
epoch 21 training time: 15.306
---------------
2023-09-11 21:24:28.019784
current #epochs=22, #steps=840
start validation
acc: 0.853081
AUC: 0.935446
Avg Precision: 0.375303
Avg Recall: 1.000000
d_prime: 2.146250
train_loss: 0.019410
valid_loss: 0.971163
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.001391973687534187
Epoch-22 lr: 0.001391973687534187
epoch 22 training time: 15.166
---------------
2023-09-11 21:24:43.185595
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00567	Train Loss 0.0108	
start validation
acc: 0.838863
AUC: 0.931323
Avg Precision: 0.379363
Avg Recall: 1.000000
d_prime: 2.101117
train_loss: 0.014347
valid_loss: 0.980324
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.001391973687534187
Epoch-23 lr: 0.001391973687534187
epoch 23 training time: 15.204
---------------
2023-09-11 21:24:58.389628
current #epochs=24, #steps=920
start validation
acc: 0.824645
AUC: 0.931975
Avg Precision: 0.357183
Avg Recall: 1.000000
d_prime: 2.108113
train_loss: 0.025098
valid_loss: 0.995078
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.001391973687534187
Epoch-24 lr: 0.001391973687534187
epoch 24 training time: 15.157
---------------
2023-09-11 21:25:13.547116
current #epochs=25, #steps=960
start validation
acc: 0.829384
AUC: 0.933691
Avg Precision: 0.350844
Avg Recall: 1.000000
d_prime: 2.126778
train_loss: 0.022231
valid_loss: 0.981489
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.001391973687534187
Epoch-25 lr: 0.001391973687534187
epoch 25 training time: 15.351
---------------
2023-09-11 21:25:28.898419
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03704	Per Sample Data Time 0.02920	Per Sample DNN Time 0.00784	Train Loss 0.0251	
start validation
acc: 0.843602
AUC: 0.933501
Avg Precision: 0.372015
Avg Recall: 1.000000
d_prime: 2.124689
train_loss: 0.022055
valid_loss: 0.994270
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.001391973687534187
Epoch-26 lr: 0.001391973687534187
epoch 26 training time: 15.245
---------------
2023-09-11 21:25:44.143105
current #epochs=27, #steps=1040
start validation
acc: 0.829384
AUC: 0.928342
Avg Precision: 0.359287
Avg Recall: 1.000000
d_prime: 2.069772
train_loss: 0.014117
valid_loss: 0.990135
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.001391973687534187
Epoch-27 lr: 0.001391973687534187
epoch 27 training time: 15.095
---------------
2023-09-11 21:25:59.238142
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00571	Train Loss 0.0089	
start validation
acc: 0.838863
AUC: 0.926293
Avg Precision: 0.343504
Avg Recall: 1.000000
d_prime: 2.048810
train_loss: 0.012500
valid_loss: 0.981871
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.001391973687534187
Epoch-28 lr: 0.001391973687534187
epoch 28 training time: 15.282
---------------
2023-09-11 21:26:14.519723
current #epochs=29, #steps=1120
start validation
acc: 0.848341
AUC: 0.937187
Avg Precision: 0.362974
Avg Recall: 1.000000
d_prime: 2.165981
train_loss: 0.015228
valid_loss: 0.968825
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.001391973687534187
Epoch-29 lr: 0.001391973687534187
epoch 29 training time: 15.345
---------------
2023-09-11 21:26:29.864525
current #epochs=30, #steps=1160
start validation
acc: 0.838863
AUC: 0.930724
Avg Precision: 0.358688
Avg Recall: 1.000000
d_prime: 2.094745
train_loss: 0.018418
valid_loss: 0.981546
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0012415156140905687
Epoch-30 lr: 0.0012415156140905687
epoch 30 training time: 15.212
---------------
2023-09-11 21:26:45.076649
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.04077	Per Sample Data Time 0.02944	Per Sample DNN Time 0.01133	Train Loss 0.0049	
start validation
acc: 0.843602
AUC: 0.930711
Avg Precision: 0.354476
Avg Recall: 1.000000
d_prime: 2.094604
train_loss: 0.013179
valid_loss: 0.985075
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0012415156140905687
Epoch-31 lr: 0.0012415156140905687
epoch 31 training time: 15.282
---------------
2023-09-11 21:27:00.358427
current #epochs=32, #steps=1240
start validation
acc: 0.853081
AUC: 0.924505
Avg Precision: 0.343026
Avg Recall: 1.000000
d_prime: 2.030870
train_loss: 0.017597
valid_loss: 0.991227
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0012415156140905687
Epoch-32 lr: 0.0012415156140905687
epoch 32 training time: 15.110
---------------
2023-09-11 21:27:15.468952
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00567	Train Loss 0.0172	
start validation
acc: 0.843602
AUC: 0.931942
Avg Precision: 0.339664
Avg Recall: 1.000000
d_prime: 2.107757
train_loss: 0.017671
valid_loss: 0.982378
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0012415156140905687
Epoch-33 lr: 0.0012415156140905687
epoch 33 training time: 15.158
---------------
2023-09-11 21:27:30.626691
current #epochs=34, #steps=1320
start validation
acc: 0.824645
AUC: 0.934372
Avg Precision: 0.340670
Avg Recall: 1.000000
d_prime: 2.134288
train_loss: 0.021919
valid_loss: 0.967350
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0012415156140905687
Epoch-34 lr: 0.0012415156140905687
epoch 34 training time: 15.151
---------------
2023-09-11 21:27:45.777473
current #epochs=35, #steps=1360
start validation
acc: 0.838863
AUC: 0.936618
Avg Precision: 0.349207
Avg Recall: 1.000000
d_prime: 2.159490
train_loss: 0.020412
valid_loss: 0.989183
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0012415156140905687
Epoch-35 lr: 0.0012415156140905687
epoch 35 training time: 15.225
---------------
2023-09-11 21:28:01.002276
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03739	Per Sample Data Time 0.03002	Per Sample DNN Time 0.00737	Train Loss 0.0227	
start validation
acc: 0.867299
AUC: 0.938446
Avg Precision: 0.350428
Avg Recall: 1.000000
d_prime: 2.180515
train_loss: 0.013719
valid_loss: 0.975105
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0012415156140905687
Epoch-36 lr: 0.0012415156140905687
epoch 36 training time: 16.537
---------------
2023-09-11 21:28:17.538983
current #epochs=37, #steps=1440
start validation
acc: 0.862559
AUC: 0.940877
Avg Precision: 0.341937
Avg Recall: 1.000000
d_prime: 2.209251
train_loss: 0.020937
valid_loss: 0.959393
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0012415156140905687
Epoch-37 lr: 0.0012415156140905687
epoch 37 training time: 15.281
---------------
2023-09-11 21:28:32.820368
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00569	Train Loss 0.0068	
start validation
acc: 0.857820
AUC: 0.938558
Avg Precision: 0.342415
Avg Recall: 1.000000
d_prime: 2.181827
train_loss: 0.011967
valid_loss: 0.951595
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0012415156140905687
Epoch-38 lr: 0.0012415156140905687
epoch 38 training time: 15.174
---------------
2023-09-11 21:28:47.994921
current #epochs=39, #steps=1520
start validation
[I 2023-09-11 21:29:03,102] Trial 87 finished with value: 0.8815165876777251 and parameters: {'warmup': 'False', 'num_epochs': 39, 'batch_size': 42, 'lr-adaptschedule': 'True', 'lr': 0.0019618578920170375, 'head-lr': 1, 'lr-scheduler-start': 3, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.8919102603798873}. Best is trial 75 with value: 0.8862559241706162.
acc: 0.862559
AUC: 0.936790
Avg Precision: 0.338009
Avg Recall: 1.000000
d_prime: 2.161451
train_loss: 0.014384
valid_loss: 0.985548
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0011073205146292149
Epoch-39 lr: 0.0011073205146292149
epoch 39 training time: 15.092
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863efae2b0>
The learning rate scheduler starts at 3 epoch with decay rate of 0.882 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 21:29:03.143091
current #epochs=1, #steps=0
start validation
acc: 0.838863
AUC: 0.932697
Avg Precision: 0.346614
Avg Recall: 1.000000
d_prime: 2.115921
train_loss: 0.024452
valid_loss: 0.971913
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0019147977372857476
Epoch-1 lr: 0.0019147977372857476
epoch 1 training time: 17.962
---------------
2023-09-11 21:29:21.105000
current #epochs=2, #steps=40
start validation
acc: 0.867299
AUC: 0.930348
Avg Precision: 0.374671
Avg Recall: 1.000000
d_prime: 2.090753
train_loss: 0.034053
valid_loss: 0.999086
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0019147977372857476
Epoch-2 lr: 0.0019147977372857476
epoch 2 training time: 17.219
---------------
2023-09-11 21:29:38.324557
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00566	Train Loss 0.0311	
start validation
acc: 0.862559
AUC: 0.925098
Avg Precision: 0.338158
Avg Recall: 1.000000
d_prime: 2.036786
train_loss: 0.025994
valid_loss: 0.979199
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0016881486137075446
Epoch-3 lr: 0.0016881486137075446
epoch 3 training time: 15.247
---------------
2023-09-11 21:29:53.571716
current #epochs=4, #steps=120
start validation
acc: 0.838863
AUC: 0.923582
Avg Precision: 0.358594
Avg Recall: 1.000000
d_prime: 2.021737
train_loss: 0.021675
valid_loss: 1.022847
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0016881486137075446
Epoch-4 lr: 0.0016881486137075446
epoch 4 training time: 17.911
---------------
2023-09-11 21:30:11.482925
current #epochs=5, #steps=160
start validation
acc: 0.853081
AUC: 0.927827
Avg Precision: 0.359389
Avg Recall: 1.000000
d_prime: 2.064469
train_loss: 0.023843
valid_loss: 0.992285
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0016881486137075446
Epoch-5 lr: 0.0016881486137075446
epoch 5 training time: 15.194
---------------
2023-09-11 21:30:26.676517
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03869	Per Sample Data Time 0.02786	Per Sample DNN Time 0.01083	Train Loss 0.0088	
start validation
acc: 0.853081
AUC: 0.930000
Avg Precision: 0.335271
Avg Recall: 1.000000
d_prime: 2.087083
train_loss: 0.025820
valid_loss: 0.982567
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0016881486137075446
Epoch-6 lr: 0.0016881486137075446
epoch 6 training time: 15.286
---------------
2023-09-11 21:30:41.963237
current #epochs=7, #steps=240
start validation
acc: 0.857820
AUC: 0.932372
Avg Precision: 0.333027
Avg Recall: 1.000000
d_prime: 2.112399
train_loss: 0.018374
valid_loss: 0.994271
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0016881486137075446
Epoch-7 lr: 0.0016881486137075446
epoch 7 training time: 15.167
---------------
2023-09-11 21:30:57.130270
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00564	Train Loss 0.0162	
start validation
acc: 0.838863
AUC: 0.934571
Avg Precision: 0.356648
Avg Recall: 1.000000
d_prime: 2.136493
train_loss: 0.020437
valid_loss: 0.987305
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0016881486137075446
Epoch-8 lr: 0.0016881486137075446
epoch 8 training time: 15.111
---------------
2023-09-11 21:31:12.241391
current #epochs=9, #steps=320
start validation
acc: 0.853081
AUC: 0.934235
Avg Precision: 0.381843
Avg Recall: 1.000000
d_prime: 2.132767
train_loss: 0.019412
valid_loss: 0.990578
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0016881486137075446
Epoch-9 lr: 0.0016881486137075446
epoch 9 training time: 15.253
---------------
2023-09-11 21:31:27.494602
current #epochs=10, #steps=360
start validation
acc: 0.853081
AUC: 0.926423
Avg Precision: 0.388183
Avg Recall: 1.000000
d_prime: 2.050130
train_loss: 0.017084
valid_loss: 0.980950
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0016881486137075446
Epoch-10 lr: 0.0016881486137075446
epoch 10 training time: 15.131
---------------
2023-09-11 21:31:42.625610
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03705	Per Sample Data Time 0.02909	Per Sample DNN Time 0.00796	Train Loss 0.0017	
start validation
acc: 0.872038
AUC: 0.929103
Avg Precision: 0.368656
Avg Recall: 1.000000
d_prime: 2.077684
train_loss: 0.020158
valid_loss: 0.991592
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0016881486137075446
Epoch-11 lr: 0.0016881486137075446
epoch 11 training time: 19.640
---------------
2023-09-11 21:32:02.265273
current #epochs=12, #steps=440
start validation
acc: 0.853081
AUC: 0.936415
Avg Precision: 0.369829
Avg Recall: 1.000000
d_prime: 2.157181
train_loss: 0.016060
valid_loss: 0.997606
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0014883272976927583
Epoch-12 lr: 0.0014883272976927583
epoch 12 training time: 15.333
---------------
2023-09-11 21:32:17.598537
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00557	Train Loss 0.0200	
start validation
acc: 0.843602
AUC: 0.937665
Avg Precision: 0.382065
Avg Recall: 1.000000
d_prime: 2.171477
train_loss: 0.020206
valid_loss: 0.973386
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0014883272976927583
Epoch-13 lr: 0.0014883272976927583
epoch 13 training time: 15.082
---------------
2023-09-11 21:32:32.680979
current #epochs=14, #steps=520
start validation
acc: 0.838863
AUC: 0.936311
Avg Precision: 0.367961
Avg Recall: 1.000000
d_prime: 2.156002
train_loss: 0.029835
valid_loss: 0.981023
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0014883272976927583
Epoch-14 lr: 0.0014883272976927583
epoch 14 training time: 15.211
---------------
2023-09-11 21:32:47.891847
current #epochs=15, #steps=560
start validation
acc: 0.824645
AUC: 0.928976
Avg Precision: 0.362682
Avg Recall: 1.000000
d_prime: 2.076353
train_loss: 0.016205
valid_loss: 0.985545
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0014883272976927583
Epoch-15 lr: 0.0014883272976927583
epoch 15 training time: 15.352
---------------
2023-09-11 21:33:03.243776
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03673	Per Sample Data Time 0.02901	Per Sample DNN Time 0.00772	Train Loss 0.0022	
start validation
acc: 0.829384
AUC: 0.930497
Avg Precision: 0.380152
Avg Recall: 1.000000
d_prime: 2.092329
train_loss: 0.025135
valid_loss: 0.987619
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0014883272976927583
Epoch-16 lr: 0.0014883272976927583
epoch 16 training time: 15.170
---------------
2023-09-11 21:33:18.413193
current #epochs=17, #steps=640
start validation
acc: 0.857820
AUC: 0.935615
Avg Precision: 0.375190
Avg Recall: 1.000000
d_prime: 2.148147
train_loss: 0.026761
valid_loss: 1.000077
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0014883272976927583
Epoch-17 lr: 0.0014883272976927583
epoch 17 training time: 15.137
---------------
2023-09-11 21:33:33.550628
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00726	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00571	Train Loss 0.0252	
start validation
acc: 0.843602
AUC: 0.934959
Avg Precision: 0.383493
Avg Recall: 1.000000
d_prime: 2.140806
train_loss: 0.025889
valid_loss: 0.981508
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0014883272976927583
Epoch-18 lr: 0.0014883272976927583
epoch 18 training time: 15.279
---------------
2023-09-11 21:33:48.829698
current #epochs=19, #steps=720
start validation
acc: 0.862559
AUC: 0.932055
Avg Precision: 0.342824
Avg Recall: 1.000000
d_prime: 2.108976
train_loss: 0.031492
valid_loss: 0.954191
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0014883272976927583
Epoch-19 lr: 0.0014883272976927583
epoch 19 training time: 15.118
---------------
2023-09-11 21:34:03.948223
current #epochs=20, #steps=760
start validation
acc: 0.834123
AUC: 0.936729
Avg Precision: 0.407330
Avg Recall: 1.000000
d_prime: 2.160755
train_loss: 0.028342
valid_loss: 0.980823
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0014883272976927583
Epoch-20 lr: 0.0014883272976927583
epoch 20 training time: 15.008
---------------
2023-09-11 21:34:18.955507
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03789	Per Sample Data Time 0.02679	Per Sample DNN Time 0.01109	Train Loss 0.0035	
start validation
acc: 0.853081
AUC: 0.930102
Avg Precision: 0.347971
Avg Recall: 1.000000
d_prime: 2.088162
train_loss: 0.021782
valid_loss: 0.975780
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0013121582585034043
Epoch-21 lr: 0.0013121582585034043
epoch 21 training time: 15.138
---------------
2023-09-11 21:34:34.093408
current #epochs=22, #steps=840
start validation
acc: 0.857820
AUC: 0.926354
Avg Precision: 0.357028
Avg Recall: 1.000000
d_prime: 2.049422
train_loss: 0.013159
valid_loss: 0.977864
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0013121582585034043
Epoch-22 lr: 0.0013121582585034043
epoch 22 training time: 16.063
---------------
2023-09-11 21:34:50.156889
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00565	Train Loss 0.0170	
start validation
acc: 0.848341
AUC: 0.934219
Avg Precision: 0.348945
Avg Recall: 1.000000
d_prime: 2.132596
train_loss: 0.020832
valid_loss: 0.972104
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0013121582585034043
Epoch-23 lr: 0.0013121582585034043
epoch 23 training time: 18.069
---------------
2023-09-11 21:35:08.225750
current #epochs=24, #steps=920
start validation
acc: 0.848341
AUC: 0.934401
Avg Precision: 0.348755
Avg Recall: 1.000000
d_prime: 2.134607
train_loss: 0.022397
valid_loss: 0.995592
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0013121582585034043
Epoch-24 lr: 0.0013121582585034043
epoch 24 training time: 16.924
---------------
2023-09-11 21:35:25.149593
current #epochs=25, #steps=960
start validation
acc: 0.862559
AUC: 0.934050
Avg Precision: 0.354726
Avg Recall: 1.000000
d_prime: 2.130730
train_loss: 0.018553
valid_loss: 0.975373
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0013121582585034043
Epoch-25 lr: 0.0013121582585034043
epoch 25 training time: 15.357
---------------
2023-09-11 21:35:40.507074
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03722	Per Sample Data Time 0.02930	Per Sample DNN Time 0.00793	Train Loss 0.0008	
start validation
acc: 0.857820
AUC: 0.934726
Avg Precision: 0.363675
Avg Recall: 1.000000
d_prime: 2.138209
train_loss: 0.015388
valid_loss: 0.978507
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0013121582585034043
Epoch-26 lr: 0.0013121582585034043
epoch 26 training time: 16.906
---------------
2023-09-11 21:35:57.413459
current #epochs=27, #steps=1040
start validation
acc: 0.857820
AUC: 0.930332
Avg Precision: 0.345363
Avg Recall: 1.000000
d_prime: 2.090588
train_loss: 0.012891
valid_loss: 0.977135
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0013121582585034043
Epoch-27 lr: 0.0013121582585034043
epoch 27 training time: 16.642
---------------
2023-09-11 21:36:14.054965
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00567	Train Loss 0.0166	
start validation
acc: 0.867299
AUC: 0.938895
Avg Precision: 0.372845
Avg Recall: 1.000000
d_prime: 2.185752
train_loss: 0.013682
valid_loss: 0.967335
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0013121582585034043
Epoch-28 lr: 0.0013121582585034043
epoch 28 training time: 15.716
---------------
2023-09-11 21:36:29.771243
current #epochs=29, #steps=1120
start validation
acc: 0.843602
AUC: 0.929469
Avg Precision: 0.351359
Avg Recall: 1.000000
d_prime: 2.081502
train_loss: 0.010002
valid_loss: 0.973444
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0013121582585034043
Epoch-29 lr: 0.0013121582585034043
epoch 29 training time: 15.074
---------------
2023-09-11 21:36:44.844817
current #epochs=30, #steps=1160
start validation
acc: 0.848341
AUC: 0.932826
Avg Precision: 0.366801
Avg Recall: 1.000000
d_prime: 2.117320
train_loss: 0.011071
valid_loss: 0.968876
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0011568418438792332
Epoch-30 lr: 0.0011568418438792332
epoch 30 training time: 15.261
---------------
2023-09-11 21:37:00.105680
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03581	Per Sample Data Time 0.02743	Per Sample DNN Time 0.00838	Train Loss 0.0029	
start validation
acc: 0.853081
AUC: 0.927918
Avg Precision: 0.356315
Avg Recall: 1.000000
d_prime: 2.065397
train_loss: 0.018896
valid_loss: 0.971225
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0011568418438792332
Epoch-31 lr: 0.0011568418438792332
epoch 31 training time: 15.161
---------------
2023-09-11 21:37:15.266779
current #epochs=32, #steps=1240
start validation
acc: 0.876777
AUC: 0.924923
Avg Precision: 0.334839
Avg Recall: 1.000000
d_prime: 2.035036
train_loss: 0.023512
valid_loss: 0.976602
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0011568418438792332
Epoch-32 lr: 0.0011568418438792332
epoch 32 training time: 19.353
---------------
2023-09-11 21:37:34.619951
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00726	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00572	Train Loss 0.0293	
start validation
acc: 0.853081
AUC: 0.931867
Avg Precision: 0.320645
Avg Recall: 1.000000
d_prime: 2.106958
train_loss: 0.024321
valid_loss: 0.974239
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0011568418438792332
Epoch-33 lr: 0.0011568418438792332
epoch 33 training time: 15.300
---------------
2023-09-11 21:37:49.920352
current #epochs=34, #steps=1320
start validation
acc: 0.872038
AUC: 0.944051
Avg Precision: 0.351920
Avg Recall: 1.000000
d_prime: 2.248209
train_loss: 0.019382
valid_loss: 0.962294
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0011568418438792332
Epoch-34 lr: 0.0011568418438792332
epoch 34 training time: 15.063
---------------
2023-09-11 21:38:04.982749
current #epochs=35, #steps=1360
start validation
acc: 0.853081
AUC: 0.938605
Avg Precision: 0.366197
Avg Recall: 1.000000
d_prime: 2.182368
train_loss: 0.014133
valid_loss: 0.962027
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0011568418438792332
Epoch-35 lr: 0.0011568418438792332
epoch 35 training time: 15.145
---------------
2023-09-11 21:38:20.127883
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.04053	Per Sample Data Time 0.02928	Per Sample DNN Time 0.01125	Train Loss 0.0013	
start validation
acc: 0.862559
AUC: 0.930368
Avg Precision: 0.370024
Avg Recall: 1.000000
d_prime: 2.090972
train_loss: 0.016887
valid_loss: 0.973030
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0011568418438792332
Epoch-36 lr: 0.0011568418438792332
epoch 36 training time: 15.299
---------------
2023-09-11 21:38:35.427043
current #epochs=37, #steps=1440
start validation
acc: 0.867299
AUC: 0.932907
Avg Precision: 0.361793
Avg Recall: 1.000000
d_prime: 2.118200
train_loss: 0.016571
valid_loss: 0.983159
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0011568418438792332
Epoch-37 lr: 0.0011568418438792332
epoch 37 training time: 15.090
---------------
2023-09-11 21:38:50.517386
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00566	Train Loss 0.0363	
start validation
acc: 0.848341
AUC: 0.927687
Avg Precision: 0.359795
Avg Recall: 1.000000
d_prime: 2.063025
train_loss: 0.031944
valid_loss: 0.982910
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0011568418438792332
Epoch-38 lr: 0.0011568418438792332
epoch 38 training time: 15.082
---------------
2023-09-11 21:39:05.599120
current #epochs=39, #steps=1520
start validation
[I 2023-09-11 21:39:20,789] Trial 88 finished with value: 0.8767772511848341 and parameters: {'warmup': 'False', 'num_epochs': 39, 'batch_size': 34, 'lr-adaptschedule': 'True', 'lr': 0.0019147977372857476, 'head-lr': 1, 'lr-scheduler-start': 3, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.8816328643152246}. Best is trial 75 with value: 0.8862559241706162.
acc: 0.857820
AUC: 0.928423
Avg Precision: 0.363017
Avg Recall: 1.000000
d_prime: 2.070611
train_loss: 0.014941
valid_loss: 0.994848
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0010199097883789542
Epoch-39 lr: 0.0010199097883789542
epoch 39 training time: 15.176
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863d981280>
The learning rate scheduler starts at 3 epoch with decay rate of 0.892 every 8 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 21:39:20.829124
current #epochs=1, #steps=0
start validation
acc: 0.862559
AUC: 0.948004
Avg Precision: 0.390631
Avg Recall: 1.000000
d_prime: 2.299228
train_loss: 0.021036
valid_loss: 0.969492
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0016272131804724755
Epoch-1 lr: 0.0016272131804724755
epoch 1 training time: 17.468
---------------
2023-09-11 21:39:38.297148
current #epochs=2, #steps=40
start validation
acc: 0.857820
AUC: 0.943633
Avg Precision: 0.364195
Avg Recall: 1.000000
d_prime: 2.242977
train_loss: 0.028494
valid_loss: 0.964557
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0016272131804724755
Epoch-2 lr: 0.0016272131804724755
epoch 2 training time: 15.174
---------------
2023-09-11 21:39:53.471657
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00567	Train Loss 0.0193	
start validation
acc: 0.853081
AUC: 0.938651
Avg Precision: 0.367304
Avg Recall: 1.000000
d_prime: 2.182906
train_loss: 0.019757
valid_loss: 0.973904
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0014509987892009984
Epoch-3 lr: 0.0014509987892009984
epoch 3 training time: 16.302
---------------
2023-09-11 21:40:09.774230
current #epochs=4, #steps=120
start validation
acc: 0.848341
AUC: 0.931348
Avg Precision: 0.325104
Avg Recall: 1.000000
d_prime: 2.101394
train_loss: 0.034488
valid_loss: 0.972644
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0014509987892009984
Epoch-4 lr: 0.0014509987892009984
epoch 4 training time: 15.288
---------------
2023-09-11 21:40:25.061975
current #epochs=5, #steps=160
start validation
acc: 0.857820
AUC: 0.933265
Avg Precision: 0.359463
Avg Recall: 1.000000
d_prime: 2.122113
train_loss: 0.019749
valid_loss: 0.964996
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0014509987892009984
Epoch-5 lr: 0.0014509987892009984
epoch 5 training time: 15.667
---------------
2023-09-11 21:40:40.728465
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03622	Per Sample Data Time 0.02858	Per Sample DNN Time 0.00763	Train Loss 0.0224	
start validation
acc: 0.867299
AUC: 0.937000
Avg Precision: 0.360110
Avg Recall: 1.000000
d_prime: 2.163845
train_loss: 0.017048
valid_loss: 0.963061
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0014509987892009984
Epoch-6 lr: 0.0014509987892009984
epoch 6 training time: 17.180
---------------
2023-09-11 21:40:57.908745
current #epochs=7, #steps=240
start validation
acc: 0.867299
AUC: 0.938733
Avg Precision: 0.376453
Avg Recall: 1.000000
d_prime: 2.183869
train_loss: 0.009693
valid_loss: 0.958769
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0014509987892009984
Epoch-7 lr: 0.0014509987892009984
epoch 7 training time: 15.101
---------------
2023-09-11 21:41:13.009752
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00566	Train Loss 0.0216	
start validation
acc: 0.857820
AUC: 0.934679
Avg Precision: 0.363367
Avg Recall: 1.000000
d_prime: 2.137692
train_loss: 0.017825
valid_loss: 0.969135
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0014509987892009984
Epoch-8 lr: 0.0014509987892009984
epoch 8 training time: 17.023
---------------
2023-09-11 21:41:30.032353
current #epochs=9, #steps=320
start validation
acc: 0.834123
AUC: 0.938403
Avg Precision: 0.364328
Avg Recall: 1.000000
d_prime: 2.180022
train_loss: 0.018166
valid_loss: 0.974664
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0014509987892009984
Epoch-9 lr: 0.0014509987892009984
epoch 9 training time: 15.109
---------------
2023-09-11 21:41:45.141543
current #epochs=10, #steps=360
start validation
acc: 0.853081
AUC: 0.933248
Avg Precision: 0.347761
Avg Recall: 1.000000
d_prime: 2.121927
train_loss: 0.017428
valid_loss: 0.971733
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0014509987892009984
Epoch-10 lr: 0.0014509987892009984
epoch 10 training time: 15.301
---------------
2023-09-11 21:42:00.442642
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03610	Per Sample Data Time 0.02796	Per Sample DNN Time 0.00814	Train Loss 0.0501	
start validation
acc: 0.829384
AUC: 0.921183
Avg Precision: 0.363963
Avg Recall: 1.000000
d_prime: 1.998390
train_loss: 0.031913
valid_loss: 0.989215
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0012938670307792387
Epoch-11 lr: 0.0012938670307792387
epoch 11 training time: 15.185
---------------
2023-09-11 21:42:15.627706
current #epochs=12, #steps=440
start validation
acc: 0.838863
AUC: 0.928611
Avg Precision: 0.315179
Avg Recall: 1.000000
d_prime: 2.072568
train_loss: 0.015101
valid_loss: 0.992125
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0012938670307792387
Epoch-12 lr: 0.0012938670307792387
epoch 12 training time: 15.096
---------------
2023-09-11 21:42:30.723621
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00566	Train Loss 0.0083	
start validation
acc: 0.805687
AUC: 0.936400
Avg Precision: 0.358008
Avg Recall: 1.000000
d_prime: 2.157011
train_loss: 0.010809
valid_loss: 0.977109
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0012938670307792387
Epoch-13 lr: 0.0012938670307792387
epoch 13 training time: 15.156
---------------
2023-09-11 21:42:45.879676
current #epochs=14, #steps=520
start validation
acc: 0.834123
AUC: 0.936408
Avg Precision: 0.365985
Avg Recall: 1.000000
d_prime: 2.157107
train_loss: 0.018095
valid_loss: 0.993059
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0012938670307792387
Epoch-14 lr: 0.0012938670307792387
epoch 14 training time: 15.163
---------------
2023-09-11 21:43:01.042749
current #epochs=15, #steps=560
start validation
acc: 0.824645
AUC: 0.929783
Avg Precision: 0.376754
Avg Recall: 1.000000
d_prime: 2.084805
train_loss: 0.017881
valid_loss: 1.000098
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0012938670307792387
Epoch-15 lr: 0.0012938670307792387
epoch 15 training time: 15.069
---------------
2023-09-11 21:43:16.111755
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.04060	Per Sample Data Time 0.03025	Per Sample DNN Time 0.01034	Train Loss 0.0307	
start validation
acc: 0.819905
AUC: 0.934729
Avg Precision: 0.394832
Avg Recall: 1.000000
d_prime: 2.138247
train_loss: 0.021278
valid_loss: 1.000111
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0012938670307792387
Epoch-16 lr: 0.0012938670307792387
epoch 16 training time: 15.225
---------------
2023-09-11 21:43:31.336915
current #epochs=17, #steps=640
start validation
acc: 0.834123
AUC: 0.939507
Avg Precision: 0.416375
Avg Recall: 1.000000
d_prime: 2.192948
train_loss: 0.031607
valid_loss: 0.985664
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0012938670307792387
Epoch-17 lr: 0.0012938670307792387
epoch 17 training time: 16.632
---------------
2023-09-11 21:43:47.968717
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00569	Train Loss 0.0142	
start validation
acc: 0.838863
AUC: 0.939709
Avg Precision: 0.331802
Avg Recall: 1.000000
d_prime: 2.195337
train_loss: 0.016339
valid_loss: 0.966873
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0012938670307792387
Epoch-18 lr: 0.0012938670307792387
epoch 18 training time: 15.155
---------------
2023-09-11 21:44:03.123320
current #epochs=19, #steps=720
start validation
acc: 0.843602
AUC: 0.933633
Avg Precision: 0.324064
Avg Recall: 1.000000
d_prime: 2.126138
train_loss: 0.014552
valid_loss: 0.985714
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0011537514061326906
Epoch-19 lr: 0.0011537514061326906
epoch 19 training time: 15.137
---------------
2023-09-11 21:44:18.260010
current #epochs=20, #steps=760
start validation
acc: 0.834123
AUC: 0.931665
Avg Precision: 0.323005
Avg Recall: 1.000000
d_prime: 2.104781
train_loss: 0.016542
valid_loss: 0.984108
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0011537514061326906
Epoch-20 lr: 0.0011537514061326906
epoch 20 training time: 16.540
---------------
2023-09-11 21:44:34.800366
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03634	Per Sample Data Time 0.02835	Per Sample DNN Time 0.00799	Train Loss 0.0317	
start validation
acc: 0.843602
AUC: 0.927287
Avg Precision: 0.311559
Avg Recall: 1.000000
d_prime: 2.058921
train_loss: 0.017648
valid_loss: 0.970441
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0011537514061326906
Epoch-21 lr: 0.0011537514061326906
epoch 21 training time: 15.081
---------------
2023-09-11 21:44:49.881264
current #epochs=22, #steps=840
start validation
acc: 0.838863
AUC: 0.928179
Avg Precision: 0.323235
Avg Recall: 1.000000
d_prime: 2.068096
train_loss: 0.017577
valid_loss: 0.964501
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0011537514061326906
Epoch-22 lr: 0.0011537514061326906
epoch 22 training time: 16.405
---------------
2023-09-11 21:45:06.286846
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00724	Per Sample Data Time 0.00160	Per Sample DNN Time 0.00564	Train Loss 0.0128	
start validation
acc: 0.824645
AUC: 0.933693
Avg Precision: 0.353266
Avg Recall: 1.000000
d_prime: 2.126800
train_loss: 0.016339
valid_loss: 0.981690
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0011537514061326906
Epoch-23 lr: 0.0011537514061326906
epoch 23 training time: 15.236
---------------
2023-09-11 21:45:21.522951
current #epochs=24, #steps=920
start validation
acc: 0.834123
AUC: 0.927942
Avg Precision: 0.307292
Avg Recall: 1.000000
d_prime: 2.065646
train_loss: 0.017595
valid_loss: 0.965974
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0011537514061326906
Epoch-24 lr: 0.0011537514061326906
epoch 24 training time: 15.236
---------------
2023-09-11 21:45:36.758426
current #epochs=25, #steps=960
start validation
acc: 0.815166
AUC: 0.928441
Avg Precision: 0.318364
Avg Recall: 1.000000
d_prime: 2.070798
train_loss: 0.022459
valid_loss: 0.982632
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0011537514061326906
Epoch-25 lr: 0.0011537514061326906
epoch 25 training time: 15.655
---------------
2023-09-11 21:45:52.413526
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03715	Per Sample Data Time 0.02890	Per Sample DNN Time 0.00825	Train Loss 0.0178	
start validation
acc: 0.834123
AUC: 0.919231
Avg Precision: 0.313637
Avg Recall: 1.000000
d_prime: 1.979779
train_loss: 0.030204
valid_loss: 0.980300
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0011537514061326906
Epoch-26 lr: 0.0011537514061326906
epoch 26 training time: 15.190
---------------
2023-09-11 21:46:07.603062
current #epochs=27, #steps=1040
start validation
acc: 0.819905
AUC: 0.925058
Avg Precision: 0.328770
Avg Recall: 1.000000
d_prime: 2.036389
train_loss: 0.020535
valid_loss: 0.988666
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0010288092017859615
Epoch-27 lr: 0.0010288092017859615
epoch 27 training time: 15.082
---------------
2023-09-11 21:46:22.684520
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00565	Train Loss 0.0229	
start validation
acc: 0.824645
AUC: 0.930798
Avg Precision: 0.372523
Avg Recall: 1.000000
d_prime: 2.095528
train_loss: 0.022016
valid_loss: 0.996296
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0010288092017859615
Epoch-28 lr: 0.0010288092017859615
epoch 28 training time: 15.192
---------------
2023-09-11 21:46:37.876698
current #epochs=29, #steps=1120
start validation
acc: 0.843602
AUC: 0.935268
Avg Precision: 0.359991
Avg Recall: 1.000000
d_prime: 2.144255
train_loss: 0.017855
valid_loss: 0.977127
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0010288092017859615
Epoch-29 lr: 0.0010288092017859615
epoch 29 training time: 15.152
---------------
2023-09-11 21:46:53.029130
current #epochs=30, #steps=1160
start validation
acc: 0.853081
AUC: 0.931519
Avg Precision: 0.348061
Avg Recall: 1.000000
d_prime: 2.103218
train_loss: 0.023324
valid_loss: 0.968366
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0010288092017859615
Epoch-30 lr: 0.0010288092017859615
epoch 30 training time: 16.651
---------------
2023-09-11 21:47:09.680167
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03795	Per Sample Data Time 0.02802	Per Sample DNN Time 0.00994	Train Loss 0.0012	
start validation
acc: 0.838863
AUC: 0.926931
Avg Precision: 0.355665
Avg Recall: 1.000000
d_prime: 2.055292
train_loss: 0.017405
valid_loss: 0.979409
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0010288092017859615
Epoch-31 lr: 0.0010288092017859615
epoch 31 training time: 15.490
---------------
2023-09-11 21:47:25.170038
current #epochs=32, #steps=1240
start validation
acc: 0.848341
AUC: 0.919769
Avg Precision: 0.344185
Avg Recall: 1.000000
d_prime: 1.984875
train_loss: 0.020267
valid_loss: 0.993704
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0010288092017859615
Epoch-32 lr: 0.0010288092017859615
epoch 32 training time: 15.643
---------------
2023-09-11 21:47:40.812988
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00563	Train Loss 0.0139	
start validation
acc: 0.829384
AUC: 0.928934
Avg Precision: 0.350568
Avg Recall: 1.000000
d_prime: 2.075918
train_loss: 0.014783
valid_loss: 0.978125
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0010288092017859615
Epoch-33 lr: 0.0010288092017859615
epoch 33 training time: 15.093
---------------
2023-09-11 21:47:55.906688
current #epochs=34, #steps=1320
start validation
[I 2023-09-11 21:48:11,047] Trial 89 finished with value: 0.8672985781990521 and parameters: {'warmup': 'False', 'num_epochs': 34, 'batch_size': 39, 'lr-adaptschedule': 'True', 'lr': 0.0016272131804724755, 'head-lr': 1, 'lr-scheduler-start': 3, 'lr-scheduler-step': 8, 'lr-scheduler-decay': 0.8917078638581875}. Best is trial 75 with value: 0.8862559241706162.
acc: 0.857820
AUC: 0.934561
Avg Precision: 0.377688
Avg Recall: 1.000000
d_prime: 2.136381
train_loss: 0.019587
valid_loss: 0.972899
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0010288092017859615
Epoch-34 lr: 0.0010288092017859615
epoch 34 training time: 15.125
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f8667020370>
The learning rate scheduler starts at 3 epoch with decay rate of 0.872 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 21:48:11.087375
current #epochs=1, #steps=0
start validation
acc: 0.810427
AUC: 0.923491
Avg Precision: 0.348463
Avg Recall: 1.000000
d_prime: 2.020843
train_loss: 0.033643
valid_loss: 1.006493
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002056987094328106
Epoch-1 lr: 0.002056987094328106
epoch 1 training time: 17.290
---------------
2023-09-11 21:48:28.377240
current #epochs=2, #steps=40
start validation
acc: 0.834123
AUC: 0.931433
Avg Precision: 0.332586
Avg Recall: 1.000000
d_prime: 2.102297
train_loss: 0.025063
valid_loss: 0.985948
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002056987094328106
Epoch-2 lr: 0.002056987094328106
epoch 2 training time: 17.276
---------------
2023-09-11 21:48:45.652974
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00723	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00571	Train Loss 0.0296	
start validation
acc: 0.805687
AUC: 0.924100
Avg Precision: 0.337277
Avg Recall: 1.000000
d_prime: 2.026858
train_loss: 0.029726
valid_loss: 0.990952
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0017935621559414818
Epoch-3 lr: 0.0017935621559414818
epoch 3 training time: 15.406
---------------
2023-09-11 21:49:01.059348
current #epochs=4, #steps=120
start validation
acc: 0.824645
AUC: 0.933216
Avg Precision: 0.353419
Avg Recall: 1.000000
d_prime: 2.121575
train_loss: 0.017571
valid_loss: 0.995901
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0017935621559414818
Epoch-4 lr: 0.0017935621559414818
epoch 4 training time: 15.208
---------------
2023-09-11 21:49:16.267525
current #epochs=5, #steps=160
start validation
acc: 0.810427
AUC: 0.922620
Avg Precision: 0.350687
Avg Recall: 1.000000
d_prime: 2.012307
train_loss: 0.034653
valid_loss: 0.996653
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0017935621559414818
Epoch-5 lr: 0.0017935621559414818
epoch 5 training time: 15.103
---------------
2023-09-11 21:49:31.370823
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03712	Per Sample Data Time 0.02882	Per Sample DNN Time 0.00830	Train Loss 0.0095	
start validation
acc: 0.848341
AUC: 0.936957
Avg Precision: 0.359993
Avg Recall: 1.000000
d_prime: 2.163345
train_loss: 0.018755
valid_loss: 0.991574
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0017935621559414818
Epoch-6 lr: 0.0017935621559414818
epoch 6 training time: 17.227
---------------
2023-09-11 21:49:48.598287
current #epochs=7, #steps=240
start validation
acc: 0.848341
AUC: 0.930584
Avg Precision: 0.350663
Avg Recall: 1.000000
d_prime: 2.093257
train_loss: 0.017258
valid_loss: 0.973219
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0017935621559414818
Epoch-7 lr: 0.0017935621559414818
epoch 7 training time: 15.114
---------------
2023-09-11 21:50:03.712344
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00568	Train Loss 0.0164	
start validation
acc: 0.829384
AUC: 0.927353
Avg Precision: 0.331654
Avg Recall: 1.000000
d_prime: 2.059604
train_loss: 0.017930
valid_loss: 0.986529
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0017935621559414818
Epoch-8 lr: 0.0017935621559414818
epoch 8 training time: 15.067
---------------
2023-09-11 21:50:18.779653
current #epochs=9, #steps=320
start validation
acc: 0.834123
AUC: 0.929381
Avg Precision: 0.334819
Avg Recall: 1.000000
d_prime: 2.080586
train_loss: 0.025286
valid_loss: 0.987666
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0017935621559414818
Epoch-9 lr: 0.0017935621559414818
epoch 9 training time: 18.781
---------------
2023-09-11 21:50:37.560616
current #epochs=10, #steps=360
start validation
acc: 0.819905
AUC: 0.925057
Avg Precision: 0.323847
Avg Recall: 1.000000
d_prime: 2.036379
train_loss: 0.018798
valid_loss: 0.999396
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0017935621559414818
Epoch-10 lr: 0.0017935621559414818
epoch 10 training time: 15.144
---------------
2023-09-11 21:50:52.704839
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03688	Per Sample Data Time 0.02963	Per Sample DNN Time 0.00725	Train Loss 0.0005	
start validation
acc: 0.834123
AUC: 0.925836
Avg Precision: 0.362467
Avg Recall: 1.000000
d_prime: 2.044189
train_loss: 0.028466
valid_loss: 0.984846
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0017935621559414818
Epoch-11 lr: 0.0017935621559414818
epoch 11 training time: 15.256
---------------
2023-09-11 21:51:07.961176
current #epochs=12, #steps=440
start validation
acc: 0.853081
AUC: 0.928441
Avg Precision: 0.344288
Avg Recall: 1.000000
d_prime: 2.070800
train_loss: 0.017339
valid_loss: 0.982217
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0015638723335190457
Epoch-12 lr: 0.0015638723335190457
epoch 12 training time: 17.027
---------------
2023-09-11 21:51:24.988108
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00725	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00577	Train Loss 0.0288	
start validation
acc: 0.829384
AUC: 0.911992
Avg Precision: 0.335775
Avg Recall: 1.000000
d_prime: 1.913603
train_loss: 0.024492
valid_loss: 1.011377
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0015638723335190457
Epoch-13 lr: 0.0015638723335190457
epoch 13 training time: 15.337
---------------
2023-09-11 21:51:40.324864
current #epochs=14, #steps=520
start validation
acc: 0.834123
AUC: 0.934462
Avg Precision: 0.404427
Avg Recall: 1.000000
d_prime: 2.135279
train_loss: 0.029284
valid_loss: 0.991913
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0015638723335190457
Epoch-14 lr: 0.0015638723335190457
epoch 14 training time: 15.111
---------------
2023-09-11 21:51:55.435916
current #epochs=15, #steps=560
start validation
acc: 0.838863
AUC: 0.942792
Avg Precision: 0.413355
Avg Recall: 1.000000
d_prime: 2.232551
train_loss: 0.027271
valid_loss: 0.966769
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0015638723335190457
Epoch-15 lr: 0.0015638723335190457
epoch 15 training time: 15.568
---------------
2023-09-11 21:52:11.004261
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03960	Per Sample Data Time 0.02840	Per Sample DNN Time 0.01120	Train Loss 0.1347	
start validation
acc: 0.829384
AUC: 0.939005
Avg Precision: 0.410561
Avg Recall: 1.000000
d_prime: 2.187048
train_loss: 0.025813
valid_loss: 0.975704
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0015638723335190457
Epoch-16 lr: 0.0015638723335190457
epoch 16 training time: 17.848
---------------
2023-09-11 21:52:28.851888
current #epochs=17, #steps=640
start validation
acc: 0.843602
AUC: 0.936904
Avg Precision: 0.403408
Avg Recall: 1.000000
d_prime: 2.162749
train_loss: 0.022119
valid_loss: 0.968389
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0015638723335190457
Epoch-17 lr: 0.0015638723335190457
epoch 17 training time: 15.184
---------------
2023-09-11 21:52:44.035778
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00569	Train Loss 0.0242	
start validation
acc: 0.838863
AUC: 0.940671
Avg Precision: 0.393524
Avg Recall: 1.000000
d_prime: 2.206785
train_loss: 0.028262
valid_loss: 0.978952
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0015638723335190457
Epoch-18 lr: 0.0015638723335190457
epoch 18 training time: 18.201
---------------
2023-09-11 21:53:02.237256
current #epochs=19, #steps=720
start validation
acc: 0.819905
AUC: 0.927085
Avg Precision: 0.376634
Avg Recall: 1.000000
d_prime: 2.056858
train_loss: 0.014129
valid_loss: 0.982968
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0015638723335190457
Epoch-19 lr: 0.0015638723335190457
epoch 19 training time: 17.014
---------------
2023-09-11 21:53:19.250865
current #epochs=20, #steps=760
start validation
acc: 0.829384
AUC: 0.939242
Avg Precision: 0.390086
Avg Recall: 1.000000
d_prime: 2.189830
train_loss: 0.021749
valid_loss: 0.972798
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0015638723335190457
Epoch-20 lr: 0.0015638723335190457
epoch 20 training time: 15.042
---------------
2023-09-11 21:53:34.292834
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03783	Per Sample Data Time 0.02921	Per Sample DNN Time 0.00861	Train Loss 0.0005	
start validation
acc: 0.848341
AUC: 0.943975
Avg Precision: 0.385159
Avg Recall: 1.000000
d_prime: 2.247256
train_loss: 0.013072
valid_loss: 0.961059
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.001363597390502758
Epoch-21 lr: 0.001363597390502758
epoch 21 training time: 15.986
---------------
2023-09-11 21:53:50.278853
current #epochs=22, #steps=840
start validation
acc: 0.843602
AUC: 0.943063
Avg Precision: 0.376107
Avg Recall: 1.000000
d_prime: 2.235897
train_loss: 0.013453
valid_loss: 0.984669
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.001363597390502758
Epoch-22 lr: 0.001363597390502758
epoch 22 training time: 17.787
---------------
2023-09-11 21:54:08.066062
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00566	Train Loss 0.0216	
start validation
acc: 0.843602
AUC: 0.941672
Avg Precision: 0.365570
Avg Recall: 1.000000
d_prime: 2.218847
train_loss: 0.022768
valid_loss: 0.973253
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.001363597390502758
Epoch-23 lr: 0.001363597390502758
epoch 23 training time: 16.629
---------------
2023-09-11 21:54:24.695239
current #epochs=24, #steps=920
start validation
acc: 0.862559
AUC: 0.939819
Avg Precision: 0.375377
Avg Recall: 1.000000
d_prime: 2.196636
train_loss: 0.018521
valid_loss: 0.958943
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.001363597390502758
Epoch-24 lr: 0.001363597390502758
epoch 24 training time: 18.461
---------------
2023-09-11 21:54:43.155823
current #epochs=25, #steps=960
start validation
acc: 0.848341
AUC: 0.932241
Avg Precision: 0.358161
Avg Recall: 1.000000
d_prime: 2.110989
train_loss: 0.023264
valid_loss: 0.968532
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.001363597390502758
Epoch-25 lr: 0.001363597390502758
epoch 25 training time: 17.535
---------------
2023-09-11 21:55:00.691153
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03732	Per Sample Data Time 0.02911	Per Sample DNN Time 0.00821	Train Loss 0.0318	
start validation
acc: 0.862559
AUC: 0.941802
Avg Precision: 0.373210
Avg Recall: 1.000000
d_prime: 2.220432
train_loss: 0.019611
valid_loss: 0.961378
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.001363597390502758
Epoch-26 lr: 0.001363597390502758
epoch 26 training time: 15.184
---------------
2023-09-11 21:55:15.876092
current #epochs=27, #steps=1040
start validation
acc: 0.857820
AUC: 0.941710
Avg Precision: 0.363728
Avg Recall: 1.000000
d_prime: 2.219312
train_loss: 0.015730
valid_loss: 0.959276
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.001363597390502758
Epoch-27 lr: 0.001363597390502758
epoch 27 training time: 15.236
---------------
2023-09-11 21:55:31.111501
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00567	Train Loss 0.0124	
start validation
acc: 0.876777
AUC: 0.945091
Avg Precision: 0.373616
Avg Recall: 1.000000
d_prime: 2.261342
train_loss: 0.011520
valid_loss: 0.954075
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.001363597390502758
Epoch-28 lr: 0.001363597390502758
epoch 28 training time: 17.251
---------------
2023-09-11 21:55:48.362642
current #epochs=29, #steps=1120
start validation
acc: 0.848341
AUC: 0.938599
Avg Precision: 0.364986
Avg Recall: 1.000000
d_prime: 2.182298
train_loss: 0.014595
valid_loss: 0.958075
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.001363597390502758
Epoch-29 lr: 0.001363597390502758
epoch 29 training time: 17.110
---------------
2023-09-11 21:56:05.472917
current #epochs=30, #steps=1160
start validation
acc: 0.876777
AUC: 0.940806
Avg Precision: 0.357736
Avg Recall: 1.000000
d_prime: 2.208406
train_loss: 0.014843
valid_loss: 0.949006
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0011889703548894493
Epoch-30 lr: 0.0011889703548894493
epoch 30 training time: 15.229
---------------
2023-09-11 21:56:20.701767
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03880	Per Sample Data Time 0.02847	Per Sample DNN Time 0.01033	Train Loss 0.0032	
start validation
acc: 0.862559
AUC: 0.938550
Avg Precision: 0.364283
Avg Recall: 1.000000
d_prime: 2.181723
train_loss: 0.032117
valid_loss: 0.972729
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0011889703548894493
Epoch-31 lr: 0.0011889703548894493
epoch 31 training time: 15.234
---------------
2023-09-11 21:56:35.935266
current #epochs=32, #steps=1240
start validation
acc: 0.862559
AUC: 0.939408
Avg Precision: 0.352743
Avg Recall: 1.000000
d_prime: 2.191779
train_loss: 0.013218
valid_loss: 0.965069
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0011889703548894493
Epoch-32 lr: 0.0011889703548894493
epoch 32 training time: 15.093
---------------
2023-09-11 21:56:51.028697
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00565	Train Loss 0.0186	
start validation
acc: 0.843602
AUC: 0.937769
Avg Precision: 0.343864
Avg Recall: 1.000000
d_prime: 2.172669
train_loss: 0.024381
valid_loss: 0.959368
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0011889703548894493
Epoch-33 lr: 0.0011889703548894493
epoch 33 training time: 15.106
---------------
2023-09-11 21:57:06.134390
current #epochs=34, #steps=1320
start validation
acc: 0.838863
AUC: 0.937971
Avg Precision: 0.343136
Avg Recall: 1.000000
d_prime: 2.175005
train_loss: 0.011212
valid_loss: 0.965382
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0011889703548894493
Epoch-34 lr: 0.0011889703548894493
epoch 34 training time: 15.217
---------------
2023-09-11 21:57:21.351473
current #epochs=35, #steps=1360
start validation
acc: 0.853081
AUC: 0.938200
Avg Precision: 0.342070
Avg Recall: 1.000000
d_prime: 2.177657
train_loss: 0.010869
valid_loss: 0.966362
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0011889703548894493
Epoch-35 lr: 0.0011889703548894493
epoch 35 training time: 15.166
---------------
2023-09-11 21:57:36.517484
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03563	Per Sample Data Time 0.02745	Per Sample DNN Time 0.00818	Train Loss 0.0012	
start validation
acc: 0.867299
AUC: 0.940504
Avg Precision: 0.339656
Avg Recall: 1.000000
d_prime: 2.204780
train_loss: 0.010741
valid_loss: 0.948818
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0011889703548894493
Epoch-36 lr: 0.0011889703548894493
epoch 36 training time: 15.973
---------------
2023-09-11 21:57:52.490567
current #epochs=37, #steps=1440
start validation
acc: 0.867299
AUC: 0.942029
Avg Precision: 0.400956
Avg Recall: 1.000000
d_prime: 2.223200
train_loss: 0.023229
valid_loss: 0.973027
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0011889703548894493
Epoch-37 lr: 0.0011889703548894493
epoch 37 training time: 15.235
---------------
2023-09-11 21:58:07.725930
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00565	Train Loss 0.0309	
start validation
acc: 0.848341
AUC: 0.933025
Avg Precision: 0.372041
Avg Recall: 1.000000
d_prime: 2.119487
train_loss: 0.023524
valid_loss: 0.998783
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0011889703548894493
Epoch-38 lr: 0.0011889703548894493
epoch 38 training time: 15.184
---------------
2023-09-11 21:58:22.909543
current #epochs=39, #steps=1520
start validation
acc: 0.853081
AUC: 0.932285
Avg Precision: 0.359374
Avg Recall: 1.000000
d_prime: 2.111458
train_loss: 0.026606
valid_loss: 0.990401
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.001036706666243128
Epoch-39 lr: 0.001036706666243128
epoch 39 training time: 15.109
---------------
2023-09-11 21:58:38.018514
current #epochs=40, #steps=1560
start validation
acc: 0.843602
AUC: 0.935851
Avg Precision: 0.349865
Avg Recall: 1.000000
d_prime: 2.150805
train_loss: 0.021518
valid_loss: 0.988795
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.001036706666243128
Epoch-40 lr: 0.001036706666243128
epoch 40 training time: 15.191
---------------
2023-09-11 21:58:53.209757
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03711	Per Sample Data Time 0.02876	Per Sample DNN Time 0.00835	Train Loss 0.0153	
start validation
acc: 0.857820
AUC: 0.935730
Avg Precision: 0.365982
Avg Recall: 1.000000
d_prime: 2.149439
train_loss: 0.015783
valid_loss: 0.973334
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.001036706666243128
Epoch-41 lr: 0.001036706666243128
epoch 41 training time: 15.132
---------------
2023-09-11 21:59:08.341655
current #epochs=42, #steps=1640
start validation
[I 2023-09-11 21:59:24,755] Trial 90 finished with value: 0.8767772511848341 and parameters: {'warmup': 'False', 'num_epochs': 42, 'batch_size': 42, 'lr-adaptschedule': 'True', 'lr': 0.002056987094328106, 'head-lr': 1, 'lr-scheduler-start': 3, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.8719365137909778}. Best is trial 75 with value: 0.8862559241706162.
acc: 0.838863
AUC: 0.927180
Avg Precision: 0.355762
Avg Recall: 1.000000
d_prime: 2.057833
train_loss: 0.018450
valid_loss: 0.999591
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.001036706666243128
Epoch-42 lr: 0.001036706666243128
epoch 42 training time: 16.399
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f86670c04c0>
The learning rate scheduler starts at 3 epoch with decay rate of 0.886 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 21:59:24.795597
current #epochs=1, #steps=0
start validation
acc: 0.824645
AUC: 0.921192
Avg Precision: 0.356952
Avg Recall: 1.000000
d_prime: 1.998478
train_loss: 0.028390
valid_loss: 0.999241
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0018585189009364548
Epoch-1 lr: 0.0018585189009364548
epoch 1 training time: 18.518
---------------
2023-09-11 21:59:43.313704
current #epochs=2, #steps=40
start validation
acc: 0.829384
AUC: 0.933101
Avg Precision: 0.376521
Avg Recall: 1.000000
d_prime: 2.120323
train_loss: 0.031339
valid_loss: 1.000036
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0018585189009364548
Epoch-2 lr: 0.0018585189009364548
epoch 2 training time: 17.287
---------------
2023-09-11 22:00:00.600520
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00570	Train Loss 0.0326	
start validation
acc: 0.848341
AUC: 0.940699
Avg Precision: 0.362399
Avg Recall: 1.000000
d_prime: 2.207123
train_loss: 0.031774
valid_loss: 0.984356
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0016459672404349032
Epoch-3 lr: 0.0016459672404349032
epoch 3 training time: 18.172
---------------
2023-09-11 22:00:18.772441
current #epochs=4, #steps=120
start validation
acc: 0.848341
AUC: 0.935677
Avg Precision: 0.380149
Avg Recall: 1.000000
d_prime: 2.148840
train_loss: 0.026502
valid_loss: 0.992471
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0016459672404349032
Epoch-4 lr: 0.0016459672404349032
epoch 4 training time: 16.519
---------------
2023-09-11 22:00:35.291646
current #epochs=5, #steps=160
start validation
acc: 0.819905
AUC: 0.935813
Avg Precision: 0.393528
Avg Recall: 1.000000
d_prime: 2.150373
train_loss: 0.024925
valid_loss: 0.993239
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0016459672404349032
Epoch-5 lr: 0.0016459672404349032
epoch 5 training time: 15.263
---------------
2023-09-11 22:00:50.554714
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03603	Per Sample Data Time 0.02774	Per Sample DNN Time 0.00829	Train Loss 0.0115	
start validation
acc: 0.843602
AUC: 0.932765
Avg Precision: 0.371275
Avg Recall: 1.000000
d_prime: 2.116659
train_loss: 0.023569
valid_loss: 0.977320
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0016459672404349032
Epoch-6 lr: 0.0016459672404349032
epoch 6 training time: 15.142
---------------
2023-09-11 22:01:05.696815
current #epochs=7, #steps=240
start validation
acc: 0.857820
AUC: 0.938230
Avg Precision: 0.377455
Avg Recall: 1.000000
d_prime: 2.178003
train_loss: 0.027936
valid_loss: 0.955907
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0016459672404349032
Epoch-7 lr: 0.0016459672404349032
epoch 7 training time: 17.163
---------------
2023-09-11 22:01:22.859997
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00575	Train Loss 0.0158	
start validation
acc: 0.848341
AUC: 0.938209
Avg Precision: 0.386394
Avg Recall: 1.000000
d_prime: 2.177760
train_loss: 0.019231
valid_loss: 0.967277
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0016459672404349032
Epoch-8 lr: 0.0016459672404349032
epoch 8 training time: 15.085
---------------
2023-09-11 22:01:37.945388
current #epochs=9, #steps=320
start validation
acc: 0.843602
AUC: 0.939500
Avg Precision: 0.393316
Avg Recall: 1.000000
d_prime: 2.192870
train_loss: 0.022824
valid_loss: 0.968702
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0016459672404349032
Epoch-9 lr: 0.0016459672404349032
epoch 9 training time: 15.469
---------------
2023-09-11 22:01:53.414281
current #epochs=10, #steps=360
start validation
acc: 0.867299
AUC: 0.942077
Avg Precision: 0.359592
Avg Recall: 1.000000
d_prime: 2.223780
train_loss: 0.014685
valid_loss: 0.975552
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0016459672404349032
Epoch-10 lr: 0.0016459672404349032
epoch 10 training time: 17.051
---------------
2023-09-11 22:02:10.465807
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03814	Per Sample Data Time 0.02772	Per Sample DNN Time 0.01043	Train Loss 0.0065	
start validation
acc: 0.843602
AUC: 0.940087
Avg Precision: 0.405365
Avg Recall: 1.000000
d_prime: 2.199810
train_loss: 0.015819
valid_loss: 0.980152
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0016459672404349032
Epoch-11 lr: 0.0016459672404349032
epoch 11 training time: 16.516
---------------
2023-09-11 22:02:26.982144
current #epochs=12, #steps=440
start validation
acc: 0.843602
AUC: 0.943439
Avg Precision: 0.413890
Avg Recall: 1.000000
d_prime: 2.240557
train_loss: 0.016184
valid_loss: 0.963298
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0014577242960616638
Epoch-12 lr: 0.0014577242960616638
epoch 12 training time: 15.136
---------------
2023-09-11 22:02:42.118213
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00570	Train Loss 0.0207	
start validation
acc: 0.853081
AUC: 0.949335
Avg Precision: 0.397595
Avg Recall: 1.000000
d_prime: 2.317098
train_loss: 0.016076
valid_loss: 0.982180
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0014577242960616638
Epoch-13 lr: 0.0014577242960616638
epoch 13 training time: 15.662
---------------
2023-09-11 22:02:57.780516
current #epochs=14, #steps=520
start validation
acc: 0.848341
AUC: 0.950713
Avg Precision: 0.386938
Avg Recall: 1.000000
d_prime: 2.336004
train_loss: 0.013893
valid_loss: 0.969676
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0014577242960616638
Epoch-14 lr: 0.0014577242960616638
epoch 14 training time: 16.009
---------------
2023-09-11 22:03:13.789688
current #epochs=15, #steps=560
start validation
acc: 0.838863
AUC: 0.943382
Avg Precision: 0.375591
Avg Recall: 1.000000
d_prime: 2.239852
train_loss: 0.021548
valid_loss: 0.986965
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0014577242960616638
Epoch-15 lr: 0.0014577242960616638
epoch 15 training time: 15.061
---------------
2023-09-11 22:03:28.850427
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03712	Per Sample Data Time 0.02896	Per Sample DNN Time 0.00816	Train Loss 0.0019	
start validation
acc: 0.843602
AUC: 0.941747
Avg Precision: 0.365420
Avg Recall: 1.000000
d_prime: 2.219761
train_loss: 0.013557
valid_loss: 0.976113
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0014577242960616638
Epoch-16 lr: 0.0014577242960616638
epoch 16 training time: 16.270
---------------
2023-09-11 22:03:45.120692
current #epochs=17, #steps=640
start validation
acc: 0.853081
AUC: 0.942923
Avg Precision: 0.376274
Avg Recall: 1.000000
d_prime: 2.234171
train_loss: 0.021101
valid_loss: 0.979281
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0014577242960616638
Epoch-17 lr: 0.0014577242960616638
epoch 17 training time: 15.308
---------------
2023-09-11 22:04:00.429053
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00565	Train Loss 0.0341	
start validation
acc: 0.824645
AUC: 0.929817
Avg Precision: 0.386791
Avg Recall: 1.000000
d_prime: 2.085155
train_loss: 0.040486
valid_loss: 1.008821
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0014577242960616638
Epoch-18 lr: 0.0014577242960616638
epoch 18 training time: 15.176
---------------
2023-09-11 22:04:15.604473
current #epochs=19, #steps=720
start validation
acc: 0.824645
AUC: 0.928151
Avg Precision: 0.336901
Avg Recall: 1.000000
d_prime: 2.067805
train_loss: 0.040257
valid_loss: 0.992548
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0014577242960616638
Epoch-19 lr: 0.0014577242960616638
epoch 19 training time: 14.986
---------------
2023-09-11 22:04:30.590253
current #epochs=20, #steps=760
start validation
acc: 0.824645
AUC: 0.922198
Avg Precision: 0.329994
Avg Recall: 1.000000
d_prime: 2.008202
train_loss: 0.039926
valid_loss: 1.003647
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0014577242960616638
Epoch-20 lr: 0.0014577242960616638
epoch 20 training time: 15.143
---------------
2023-09-11 22:04:45.732853
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03820	Per Sample Data Time 0.03004	Per Sample DNN Time 0.00816	Train Loss 0.0073	
start validation
acc: 0.853081
AUC: 0.924209
Avg Precision: 0.324305
Avg Recall: 1.000000
d_prime: 2.027930
train_loss: 0.038902
valid_loss: 0.994420
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0012910099734226841
Epoch-21 lr: 0.0012910099734226841
epoch 21 training time: 18.611
---------------
2023-09-11 22:05:04.343938
current #epochs=22, #steps=840
start validation
acc: 0.829384
AUC: 0.934182
Avg Precision: 0.362559
Avg Recall: 1.000000
d_prime: 2.132179
train_loss: 0.027873
valid_loss: 0.992552
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0012910099734226841
Epoch-22 lr: 0.0012910099734226841
epoch 22 training time: 15.135
---------------
2023-09-11 22:05:19.478736
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00567	Train Loss 0.0224	
start validation
acc: 0.838863
AUC: 0.933684
Avg Precision: 0.357895
Avg Recall: 1.000000
d_prime: 2.126705
train_loss: 0.022719
valid_loss: 0.991928
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0012910099734226841
Epoch-23 lr: 0.0012910099734226841
epoch 23 training time: 15.138
---------------
2023-09-11 22:05:34.617093
current #epochs=24, #steps=920
start validation
acc: 0.838863
AUC: 0.933626
Avg Precision: 0.356615
Avg Recall: 1.000000
d_prime: 2.126061
train_loss: 0.026414
valid_loss: 0.993008
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0012910099734226841
Epoch-24 lr: 0.0012910099734226841
epoch 24 training time: 16.701
---------------
2023-09-11 22:05:51.318623
current #epochs=25, #steps=960
start validation
acc: 0.838863
AUC: 0.937517
Avg Precision: 0.390088
Avg Recall: 1.000000
d_prime: 2.169768
train_loss: 0.022308
valid_loss: 0.994586
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0012910099734226841
Epoch-25 lr: 0.0012910099734226841
epoch 25 training time: 17.208
---------------
2023-09-11 22:06:08.526808
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03939	Per Sample Data Time 0.03019	Per Sample DNN Time 0.00920	Train Loss 0.0047	
start validation
acc: 0.848341
AUC: 0.930773
Avg Precision: 0.335049
Avg Recall: 1.000000
d_prime: 2.095257
train_loss: 0.020119
valid_loss: 0.983692
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0012910099734226841
Epoch-26 lr: 0.0012910099734226841
epoch 26 training time: 16.512
---------------
2023-09-11 22:06:25.038709
current #epochs=27, #steps=1040
start validation
acc: 0.843602
AUC: 0.933929
Avg Precision: 0.335379
Avg Recall: 1.000000
d_prime: 2.129394
train_loss: 0.019435
valid_loss: 0.984254
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0012910099734226841
Epoch-27 lr: 0.0012910099734226841
epoch 27 training time: 15.277
---------------
2023-09-11 22:06:40.316001
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00568	Train Loss 0.0162	
start validation
acc: 0.838863
AUC: 0.938786
Avg Precision: 0.351542
Avg Recall: 1.000000
d_prime: 2.184477
train_loss: 0.012426
valid_loss: 0.975154
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0012910099734226841
Epoch-28 lr: 0.0012910099734226841
epoch 28 training time: 14.957
---------------
2023-09-11 22:06:55.273097
current #epochs=29, #steps=1120
start validation
acc: 0.838863
AUC: 0.933594
Avg Precision: 0.343246
Avg Recall: 1.000000
d_prime: 2.125716
train_loss: 0.025931
valid_loss: 0.985974
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0012910099734226841
Epoch-29 lr: 0.0012910099734226841
epoch 29 training time: 15.196
---------------
2023-09-11 22:07:10.469459
current #epochs=30, #steps=1160
start validation
acc: 0.848341
AUC: 0.933855
Avg Precision: 0.344415
Avg Recall: 1.000000
d_prime: 2.128583
train_loss: 0.015857
valid_loss: 0.983169
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0011433621268300076
Epoch-30 lr: 0.0011433621268300076
epoch 30 training time: 17.693
---------------
2023-09-11 22:07:28.162649
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03726	Per Sample Data Time 0.02852	Per Sample DNN Time 0.00874	Train Loss 0.0041	
start validation
acc: 0.848341
AUC: 0.927601
Avg Precision: 0.342006
Avg Recall: 1.000000
d_prime: 2.062140
train_loss: 0.019323
valid_loss: 0.991059
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0011433621268300076
Epoch-31 lr: 0.0011433621268300076
epoch 31 training time: 15.167
---------------
2023-09-11 22:07:43.329031
current #epochs=32, #steps=1240
start validation
acc: 0.838863
AUC: 0.930079
Avg Precision: 0.360052
Avg Recall: 1.000000
d_prime: 2.087914
train_loss: 0.014885
valid_loss: 0.989086
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0011433621268300076
Epoch-32 lr: 0.0011433621268300076
epoch 32 training time: 15.127
---------------
2023-09-11 22:07:58.456198
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00723	Per Sample Data Time 0.00161	Per Sample DNN Time 0.00563	Train Loss 0.0108	
start validation
acc: 0.843602
AUC: 0.930219
Avg Precision: 0.362772
Avg Recall: 1.000000
d_prime: 2.089390
train_loss: 0.011482
valid_loss: 0.984846
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0011433621268300076
Epoch-33 lr: 0.0011433621268300076
epoch 33 training time: 16.692
---------------
2023-09-11 22:08:15.148326
current #epochs=34, #steps=1320
start validation
acc: 0.862559
AUC: 0.934343
Avg Precision: 0.350293
Avg Recall: 1.000000
d_prime: 2.133962
train_loss: 0.017468
valid_loss: 0.979086
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0011433621268300076
Epoch-34 lr: 0.0011433621268300076
epoch 34 training time: 15.128
---------------
2023-09-11 22:08:30.275882
current #epochs=35, #steps=1360
start validation
acc: 0.862559
AUC: 0.933662
Avg Precision: 0.339350
Avg Recall: 1.000000
d_prime: 2.126459
train_loss: 0.014609
valid_loss: 0.981445
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0011433621268300076
Epoch-35 lr: 0.0011433621268300076
epoch 35 training time: 15.126
---------------
2023-09-11 22:08:45.401428
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03722	Per Sample Data Time 0.02848	Per Sample DNN Time 0.00874	Train Loss 0.0002	
start validation
acc: 0.872038
AUC: 0.940482
Avg Precision: 0.356225
Avg Recall: 1.000000
d_prime: 2.204518
train_loss: 0.019893
valid_loss: 0.971775
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0011433621268300076
Epoch-36 lr: 0.0011433621268300076
epoch 36 training time: 17.300
---------------
2023-09-11 22:09:02.701093
current #epochs=37, #steps=1440
start validation
acc: 0.857820
AUC: 0.935938
Avg Precision: 0.352328
Avg Recall: 1.000000
d_prime: 2.151784
train_loss: 0.016818
valid_loss: 0.971555
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0011433621268300076
Epoch-37 lr: 0.0011433621268300076
epoch 37 training time: 15.273
---------------
2023-09-11 22:09:17.974618
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00567	Train Loss 0.0139	
start validation
[I 2023-09-11 22:09:35,301] Trial 91 finished with value: 0.8720379146919431 and parameters: {'warmup': 'False', 'num_epochs': 38, 'batch_size': 35, 'lr-adaptschedule': 'True', 'lr': 0.0018585189009364548, 'head-lr': 1, 'lr-scheduler-start': 3, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.8856338451040489}. Best is trial 75 with value: 0.8862559241706162.
acc: 0.857820
AUC: 0.937617
Avg Precision: 0.355745
Avg Recall: 1.000000
d_prime: 2.170917
train_loss: 0.013728
valid_loss: 0.979623
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0011433621268300076
Epoch-38 lr: 0.0011433621268300076
epoch 38 training time: 17.312
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f859ea51a00>
The learning rate scheduler starts at 3 epoch with decay rate of 0.880 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 22:09:35.342355
current #epochs=1, #steps=0
start validation
acc: 0.857820
AUC: 0.922792
Avg Precision: 0.337266
Avg Recall: 1.000000
d_prime: 2.013985
train_loss: 0.020611
valid_loss: 0.990239
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.001972258020589905
Epoch-1 lr: 0.001972258020589905
epoch 1 training time: 17.295
---------------
2023-09-11 22:09:52.637630
current #epochs=2, #steps=40
start validation
acc: 0.867299
AUC: 0.924503
Avg Precision: 0.340120
Avg Recall: 1.000000
d_prime: 2.030855
train_loss: 0.036865
valid_loss: 0.982645
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.001972258020589905
Epoch-2 lr: 0.001972258020589905
epoch 2 training time: 17.512
---------------
2023-09-11 22:10:10.149543
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00564	Train Loss 0.0356	
start validation
acc: 0.805687
AUC: 0.920004
Avg Precision: 0.360804
Avg Recall: 1.000000
d_prime: 1.987105
train_loss: 0.029537
valid_loss: 1.004748
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0017352940724305959
Epoch-3 lr: 0.0017352940724305959
epoch 3 training time: 16.989
---------------
2023-09-11 22:10:27.138899
current #epochs=4, #steps=120
start validation
acc: 0.838863
AUC: 0.922308
Avg Precision: 0.355141
Avg Recall: 1.000000
d_prime: 2.009275
train_loss: 0.020507
valid_loss: 0.983430
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0017352940724305959
Epoch-4 lr: 0.0017352940724305959
epoch 4 training time: 15.134
---------------
2023-09-11 22:10:42.272766
current #epochs=5, #steps=160
start validation
acc: 0.819905
AUC: 0.930715
Avg Precision: 0.386456
Avg Recall: 1.000000
d_prime: 2.094645
train_loss: 0.019577
valid_loss: 0.989280
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0017352940724305959
Epoch-5 lr: 0.0017352940724305959
epoch 5 training time: 16.557
---------------
2023-09-11 22:10:58.830104
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03772	Per Sample Data Time 0.02912	Per Sample DNN Time 0.00860	Train Loss 0.0018	
start validation
acc: 0.848341
AUC: 0.932836
Avg Precision: 0.390596
Avg Recall: 1.000000
d_prime: 2.117431
train_loss: 0.019809
valid_loss: 0.990344
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0017352940724305959
Epoch-6 lr: 0.0017352940724305959
epoch 6 training time: 15.185
---------------
2023-09-11 22:11:14.015252
current #epochs=7, #steps=240
start validation
acc: 0.848341
AUC: 0.932112
Avg Precision: 0.366003
Avg Recall: 1.000000
d_prime: 2.109592
train_loss: 0.018243
valid_loss: 0.964105
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0017352940724305959
Epoch-7 lr: 0.0017352940724305959
epoch 7 training time: 15.236
---------------
2023-09-11 22:11:29.251106
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00564	Train Loss 0.0348	
start validation
acc: 0.843602
AUC: 0.940991
Avg Precision: 0.330872
Avg Recall: 1.000000
d_prime: 2.210624
train_loss: 0.031424
valid_loss: 0.972864
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0017352940724305959
Epoch-8 lr: 0.0017352940724305959
epoch 8 training time: 15.092
---------------
2023-09-11 22:11:44.343348
current #epochs=9, #steps=320
start validation
acc: 0.843602
AUC: 0.936951
Avg Precision: 0.363408
Avg Recall: 1.000000
d_prime: 2.163286
train_loss: 0.023521
valid_loss: 0.999822
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0017352940724305959
Epoch-9 lr: 0.0017352940724305959
epoch 9 training time: 15.931
---------------
2023-09-11 22:12:00.274120
current #epochs=10, #steps=360
start validation
acc: 0.834123
AUC: 0.936776
Avg Precision: 0.367956
Avg Recall: 1.000000
d_prime: 2.161288
train_loss: 0.022777
valid_loss: 0.994351
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0017352940724305959
Epoch-10 lr: 0.0017352940724305959
epoch 10 training time: 16.386
---------------
2023-09-11 22:12:16.660068
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03606	Per Sample Data Time 0.02777	Per Sample DNN Time 0.00829	Train Loss 0.0006	
start validation
acc: 0.819905
AUC: 0.934823
Avg Precision: 0.346406
Avg Recall: 1.000000
d_prime: 2.139294
train_loss: 0.021055
valid_loss: 0.983174
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0017352940724305959
Epoch-11 lr: 0.0017352940724305959
epoch 11 training time: 16.353
---------------
2023-09-11 22:12:33.013190
current #epochs=12, #steps=440
start validation
acc: 0.857820
AUC: 0.928668
Avg Precision: 0.371690
Avg Recall: 1.000000
d_prime: 2.073157
train_loss: 0.015426
valid_loss: 0.978107
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0015268009998570546
Epoch-12 lr: 0.0015268009998570546
epoch 12 training time: 15.183
---------------
2023-09-11 22:12:48.196126
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00157	Per Sample DNN Time 0.00563	Train Loss 0.0387	
start validation
acc: 0.853081
AUC: 0.939626
Avg Precision: 0.343664
Avg Recall: 1.000000
d_prime: 2.194355
train_loss: 0.029975
valid_loss: 0.982633
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0015268009998570546
Epoch-13 lr: 0.0015268009998570546
epoch 13 training time: 16.107
---------------
2023-09-11 22:13:04.302834
current #epochs=14, #steps=520
start validation
acc: 0.838863
AUC: 0.939732
Avg Precision: 0.340388
Avg Recall: 1.000000
d_prime: 2.195603
train_loss: 0.032732
valid_loss: 0.968240
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0015268009998570546
Epoch-14 lr: 0.0015268009998570546
epoch 14 training time: 15.176
---------------
2023-09-11 22:13:19.478673
current #epochs=15, #steps=560
start validation
acc: 0.843602
AUC: 0.931723
Avg Precision: 0.326772
Avg Recall: 1.000000
d_prime: 2.105403
train_loss: 0.014467
valid_loss: 0.972836
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0015268009998570546
Epoch-15 lr: 0.0015268009998570546
epoch 15 training time: 15.440
---------------
2023-09-11 22:13:34.918566
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03679	Per Sample Data Time 0.02832	Per Sample DNN Time 0.00847	Train Loss 0.0356	
start validation
acc: 0.843602
AUC: 0.933945
Avg Precision: 0.351019
Avg Recall: 1.000000
d_prime: 2.129569
train_loss: 0.021065
valid_loss: 0.975843
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0015268009998570546
Epoch-16 lr: 0.0015268009998570546
epoch 16 training time: 15.174
---------------
2023-09-11 22:13:50.092570
current #epochs=17, #steps=640
start validation
acc: 0.843602
AUC: 0.939646
Avg Precision: 0.339247
Avg Recall: 1.000000
d_prime: 2.194585
train_loss: 0.020138
valid_loss: 0.985431
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0015268009998570546
Epoch-17 lr: 0.0015268009998570546
epoch 17 training time: 16.446
---------------
2023-09-11 22:14:06.538040
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00564	Train Loss 0.0158	
start validation
acc: 0.824645
AUC: 0.936898
Avg Precision: 0.386251
Avg Recall: 1.000000
d_prime: 2.162675
train_loss: 0.018898
valid_loss: 0.992862
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0015268009998570546
Epoch-18 lr: 0.0015268009998570546
epoch 18 training time: 15.200
---------------
2023-09-11 22:14:21.737600
current #epochs=19, #steps=720
start validation
acc: 0.834123
AUC: 0.930054
Avg Precision: 0.322107
Avg Recall: 1.000000
d_prime: 2.087652
train_loss: 0.035103
valid_loss: 0.988627
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0015268009998570546
Epoch-19 lr: 0.0015268009998570546
epoch 19 training time: 15.221
---------------
2023-09-11 22:14:36.958781
current #epochs=20, #steps=760
start validation
acc: 0.834123
AUC: 0.926055
Avg Precision: 0.368398
Avg Recall: 1.000000
d_prime: 2.046401
train_loss: 0.031800
valid_loss: 1.005304
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0015268009998570546
Epoch-20 lr: 0.0015268009998570546
epoch 20 training time: 15.677
---------------
2023-09-11 22:14:52.635914
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03632	Per Sample Data Time 0.02835	Per Sample DNN Time 0.00796	Train Loss 0.0264	
start validation
acc: 0.872038
AUC: 0.933162
Avg Precision: 0.390379
Avg Recall: 1.000000
d_prime: 2.120983
train_loss: 0.018060
valid_loss: 0.971273
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0013433580683528418
Epoch-21 lr: 0.0013433580683528418
epoch 21 training time: 18.828
---------------
2023-09-11 22:15:11.463873
current #epochs=22, #steps=840
start validation
acc: 0.848341
AUC: 0.932907
Avg Precision: 0.369555
Avg Recall: 1.000000
d_prime: 2.118200
train_loss: 0.017423
valid_loss: 0.965878
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0013433580683528418
Epoch-22 lr: 0.0013433580683528418
epoch 22 training time: 16.241
---------------
2023-09-11 22:15:27.704919
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00724	Per Sample Data Time 0.00161	Per Sample DNN Time 0.00563	Train Loss 0.0182	
start validation
acc: 0.867299
AUC: 0.930445
Avg Precision: 0.357463
Avg Recall: 1.000000
d_prime: 2.091781
train_loss: 0.020335
valid_loss: 0.972218
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0013433580683528418
Epoch-23 lr: 0.0013433580683528418
epoch 23 training time: 15.223
---------------
2023-09-11 22:15:42.928140
current #epochs=24, #steps=920
start validation
acc: 0.843602
AUC: 0.929384
Avg Precision: 0.366587
Avg Recall: 1.000000
d_prime: 2.080618
train_loss: 0.028266
valid_loss: 0.999251
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0013433580683528418
Epoch-24 lr: 0.0013433580683528418
epoch 24 training time: 15.143
---------------
2023-09-11 22:15:58.070944
current #epochs=25, #steps=960
start validation
acc: 0.838863
AUC: 0.932041
Avg Precision: 0.357577
Avg Recall: 1.000000
d_prime: 2.108831
train_loss: 0.011541
valid_loss: 0.971294
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0013433580683528418
Epoch-25 lr: 0.0013433580683528418
epoch 25 training time: 16.148
---------------
2023-09-11 22:16:14.218700
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03739	Per Sample Data Time 0.02855	Per Sample DNN Time 0.00884	Train Loss 0.0041	
start validation
acc: 0.843602
AUC: 0.937078
Avg Precision: 0.350392
Avg Recall: 1.000000
d_prime: 2.164737
train_loss: 0.012803
valid_loss: 0.971809
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0013433580683528418
Epoch-26 lr: 0.0013433580683528418
epoch 26 training time: 15.147
---------------
2023-09-11 22:16:29.366167
current #epochs=27, #steps=1040
start validation
acc: 0.838863
AUC: 0.934076
Avg Precision: 0.349270
Avg Recall: 1.000000
d_prime: 2.131011
train_loss: 0.011590
valid_loss: 0.978923
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0013433580683528418
Epoch-27 lr: 0.0013433580683528418
epoch 27 training time: 15.156
---------------
2023-09-11 22:16:44.522359
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00571	Train Loss 0.0046	
start validation
acc: 0.838863
AUC: 0.934513
Avg Precision: 0.361499
Avg Recall: 1.000000
d_prime: 2.135852
train_loss: 0.010626
valid_loss: 0.973766
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0013433580683528418
Epoch-28 lr: 0.0013433580683528418
epoch 28 training time: 16.586
---------------
2023-09-11 22:17:01.109151
current #epochs=29, #steps=1120
start validation
acc: 0.843602
AUC: 0.932802
Avg Precision: 0.358689
Avg Recall: 1.000000
d_prime: 2.117058
train_loss: 0.014478
valid_loss: 0.969579
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0013433580683528418
Epoch-29 lr: 0.0013433580683528418
epoch 29 training time: 15.149
---------------
2023-09-11 22:17:16.258348
current #epochs=30, #steps=1160
start validation
acc: 0.815166
AUC: 0.929178
Avg Precision: 0.352171
Avg Recall: 1.000000
d_prime: 2.078460
train_loss: 0.024603
valid_loss: 0.985729
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0011819555397053275
Epoch-30 lr: 0.0011819555397053275
epoch 30 training time: 15.176
---------------
2023-09-11 22:17:31.434151
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.04017	Per Sample Data Time 0.02910	Per Sample DNN Time 0.01107	Train Loss 0.0032	
start validation
acc: 0.838863
AUC: 0.938071
Avg Precision: 0.368608
Avg Recall: 1.000000
d_prime: 2.176158
train_loss: 0.018860
valid_loss: 0.970070
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0011819555397053275
Epoch-31 lr: 0.0011819555397053275
epoch 31 training time: 15.225
---------------
2023-09-11 22:17:46.659019
current #epochs=32, #steps=1240
start validation
acc: 0.848341
AUC: 0.935560
Avg Precision: 0.363235
Avg Recall: 1.000000
d_prime: 2.147532
train_loss: 0.016869
valid_loss: 0.959410
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0011819555397053275
Epoch-32 lr: 0.0011819555397053275
epoch 32 training time: 15.588
---------------
2023-09-11 22:18:02.247186
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00568	Train Loss 0.0125	
start validation
acc: 0.857820
AUC: 0.929690
Avg Precision: 0.350636
Avg Recall: 1.000000
d_prime: 2.083820
train_loss: 0.015323
valid_loss: 0.970119
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0011819555397053275
Epoch-33 lr: 0.0011819555397053275
epoch 33 training time: 16.790
---------------
2023-09-11 22:18:19.036871
current #epochs=34, #steps=1320
start validation
acc: 0.824645
AUC: 0.939237
Avg Precision: 0.384439
Avg Recall: 1.000000
d_prime: 2.189774
train_loss: 0.017197
valid_loss: 0.989370
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0011819555397053275
Epoch-34 lr: 0.0011819555397053275
epoch 34 training time: 15.790
---------------
2023-09-11 22:18:34.827347
current #epochs=35, #steps=1360
start validation
acc: 0.834123
AUC: 0.944226
Avg Precision: 0.386672
Avg Recall: 1.000000
d_prime: 2.250398
train_loss: 0.012233
valid_loss: 0.973721
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0011819555397053275
Epoch-35 lr: 0.0011819555397053275
epoch 35 training time: 15.140
---------------
2023-09-11 22:18:49.967252
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03679	Per Sample Data Time 0.02856	Per Sample DNN Time 0.00824	Train Loss 0.0171	
start validation
acc: 0.838863
AUC: 0.928037
Avg Precision: 0.364905
Avg Recall: 1.000000
d_prime: 2.066629
train_loss: 0.018195
valid_loss: 0.993055
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0011819555397053275
Epoch-36 lr: 0.0011819555397053275
epoch 36 training time: 15.023
---------------
2023-09-11 22:19:04.990824
current #epochs=37, #steps=1440
start validation
acc: 0.829384
AUC: 0.931482
Avg Precision: 0.367618
Avg Recall: 1.000000
d_prime: 2.102818
train_loss: 0.022550
valid_loss: 1.002702
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0011819555397053275
Epoch-37 lr: 0.0011819555397053275
epoch 37 training time: 15.309
---------------
2023-09-11 22:19:20.299720
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00566	Train Loss 0.0169	
start validation
[I 2023-09-11 22:19:35,419] Trial 92 finished with value: 0.8720379146919431 and parameters: {'warmup': 'False', 'num_epochs': 38, 'batch_size': 34, 'lr-adaptschedule': 'True', 'lr': 0.001972258020589905, 'head-lr': 1, 'lr-scheduler-start': 3, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.8798514465726788}. Best is trial 75 with value: 0.8862559241706162.
acc: 0.843602
AUC: 0.935917
Avg Precision: 0.325009
Avg Recall: 1.000000
d_prime: 2.151546
train_loss: 0.012677
valid_loss: 0.963581
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0011819555397053275
Epoch-38 lr: 0.0011819555397053275
epoch 38 training time: 15.104
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863d9a00a0>
The learning rate scheduler starts at 3 epoch with decay rate of 0.870 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 22:19:35.460758
current #epochs=1, #steps=0
start validation
acc: 0.824645
AUC: 0.929707
Avg Precision: 0.349281
Avg Recall: 1.000000
d_prime: 2.084005
train_loss: 0.022276
valid_loss: 0.998861
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0022647192464469402
Epoch-1 lr: 0.0022647192464469402
epoch 1 training time: 17.103
---------------
2023-09-11 22:19:52.564060
current #epochs=2, #steps=40
start validation
acc: 0.862559
AUC: 0.940652
Avg Precision: 0.381420
Avg Recall: 1.000000
d_prime: 2.206561
train_loss: 0.023047
valid_loss: 0.989144
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0022647192464469402
Epoch-2 lr: 0.0022647192464469402
epoch 2 training time: 17.352
---------------
2023-09-11 22:20:09.916340
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00562	Train Loss 0.0204	
start validation
acc: 0.838863
AUC: 0.930729
Avg Precision: 0.379276
Avg Recall: 1.000000
d_prime: 2.094793
train_loss: 0.027412
valid_loss: 0.990614
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0019698530010081408
Epoch-3 lr: 0.0019698530010081408
epoch 3 training time: 16.630
---------------
2023-09-11 22:20:26.546424
current #epochs=4, #steps=120
start validation
acc: 0.838863
AUC: 0.925898
Avg Precision: 0.342683
Avg Recall: 1.000000
d_prime: 2.044820
train_loss: 0.032363
valid_loss: 0.984962
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0019698530010081408
Epoch-4 lr: 0.0019698530010081408
epoch 4 training time: 15.087
---------------
2023-09-11 22:20:41.633519
current #epochs=5, #steps=160
start validation
acc: 0.848341
AUC: 0.931156
Avg Precision: 0.342144
Avg Recall: 1.000000
d_prime: 2.099336
train_loss: 0.028441
valid_loss: 0.973156
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0019698530010081408
Epoch-5 lr: 0.0019698530010081408
epoch 5 training time: 16.142
---------------
2023-09-11 22:20:57.775217
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03724	Per Sample Data Time 0.02906	Per Sample DNN Time 0.00819	Train Loss 0.0509	
start validation
acc: 0.834123
AUC: 0.921498
Avg Precision: 0.306070
Avg Recall: 1.000000
d_prime: 2.001419
train_loss: 0.026529
valid_loss: 0.987321
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0019698530010081408
Epoch-6 lr: 0.0019698530010081408
epoch 6 training time: 16.078
---------------
2023-09-11 22:21:13.852953
current #epochs=7, #steps=240
start validation
acc: 0.815166
AUC: 0.921908
Avg Precision: 0.326824
Avg Recall: 1.000000
d_prime: 2.005387
train_loss: 0.027377
valid_loss: 0.989315
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0019698530010081408
Epoch-7 lr: 0.0019698530010081408
epoch 7 training time: 16.575
---------------
2023-09-11 22:21:30.428499
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00564	Train Loss 0.0294	
start validation
acc: 0.843602
AUC: 0.919085
Avg Precision: 0.307439
Avg Recall: 1.000000
d_prime: 1.978406
train_loss: 0.023191
valid_loss: 0.984298
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0019698530010081408
Epoch-8 lr: 0.0019698530010081408
epoch 8 training time: 15.240
---------------
2023-09-11 22:21:45.668462
current #epochs=9, #steps=320
start validation
acc: 0.805687
AUC: 0.923291
Avg Precision: 0.322797
Avg Recall: 1.000000
d_prime: 2.018881
train_loss: 0.021938
valid_loss: 0.985950
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0019698530010081408
Epoch-9 lr: 0.0019698530010081408
epoch 9 training time: 17.189
---------------
2023-09-11 22:22:02.857035
current #epochs=10, #steps=360
start validation
acc: 0.843602
AUC: 0.932845
Avg Precision: 0.328645
Avg Recall: 1.000000
d_prime: 2.117526
train_loss: 0.023843
valid_loss: 0.970145
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0019698530010081408
Epoch-10 lr: 0.0019698530010081408
epoch 10 training time: 15.144
---------------
2023-09-11 22:22:18.000931
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03937	Per Sample Data Time 0.02942	Per Sample DNN Time 0.00995	Train Loss 0.0003	
start validation
acc: 0.819905
AUC: 0.925733
Avg Precision: 0.322259
Avg Recall: 1.000000
d_prime: 2.043154
train_loss: 0.022226
valid_loss: 0.988117
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0019698530010081408
Epoch-11 lr: 0.0019698530010081408
epoch 11 training time: 15.186
---------------
2023-09-11 22:22:33.187448
current #epochs=12, #steps=440
start validation
acc: 0.843602
AUC: 0.919122
Avg Precision: 0.359245
Avg Recall: 1.000000
d_prime: 1.978752
train_loss: 0.031772
valid_loss: 1.002002
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0017133783146270841
Epoch-12 lr: 0.0017133783146270841
epoch 12 training time: 15.264
---------------
2023-09-11 22:22:48.451853
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00561	Train Loss 0.0178	
start validation
acc: 0.834123
AUC: 0.927507
Avg Precision: 0.339798
Avg Recall: 1.000000
d_prime: 2.061174
train_loss: 0.021053
valid_loss: 1.000218
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0017133783146270841
Epoch-13 lr: 0.0017133783146270841
epoch 13 training time: 15.112
---------------
2023-09-11 22:23:03.564347
current #epochs=14, #steps=520
start validation
acc: 0.838863
AUC: 0.927622
Avg Precision: 0.355028
Avg Recall: 1.000000
d_prime: 2.062356
train_loss: 0.026871
valid_loss: 0.985804
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0017133783146270841
Epoch-14 lr: 0.0017133783146270841
epoch 14 training time: 15.220
---------------
2023-09-11 22:23:18.784331
current #epochs=15, #steps=560
start validation
acc: 0.834123
AUC: 0.923666
Avg Precision: 0.325400
Avg Recall: 1.000000
d_prime: 2.022562
train_loss: 0.015022
valid_loss: 0.996771
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0017133783146270841
Epoch-15 lr: 0.0017133783146270841
epoch 15 training time: 15.213
---------------
2023-09-11 22:23:33.997748
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03645	Per Sample Data Time 0.02819	Per Sample DNN Time 0.00826	Train Loss 0.0240	
start validation
acc: 0.810427
AUC: 0.929503
Avg Precision: 0.338580
Avg Recall: 1.000000
d_prime: 2.081866
train_loss: 0.025717
valid_loss: 0.988146
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0017133783146270841
Epoch-16 lr: 0.0017133783146270841
epoch 16 training time: 15.122
---------------
2023-09-11 22:23:49.119680
current #epochs=17, #steps=640
start validation
acc: 0.838863
AUC: 0.926875
Avg Precision: 0.333798
Avg Recall: 1.000000
d_prime: 2.054722
train_loss: 0.018816
valid_loss: 0.991162
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0017133783146270841
Epoch-17 lr: 0.0017133783146270841
epoch 17 training time: 15.740
---------------
2023-09-11 22:24:04.859644
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00571	Train Loss 0.0266	
start validation
acc: 0.843602
AUC: 0.921382
Avg Precision: 0.341069
Avg Recall: 1.000000
d_prime: 2.000303
train_loss: 0.029053
valid_loss: 1.005094
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0017133783146270841
Epoch-18 lr: 0.0017133783146270841
epoch 18 training time: 15.242
---------------
2023-09-11 22:24:20.101910
current #epochs=19, #steps=720
start validation
acc: 0.843602
AUC: 0.937104
Avg Precision: 0.353655
Avg Recall: 1.000000
d_prime: 2.165028
train_loss: 0.035795
valid_loss: 0.981418
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0017133783146270841
Epoch-19 lr: 0.0017133783146270841
epoch 19 training time: 16.373
---------------
2023-09-11 22:24:36.474870
current #epochs=20, #steps=760
start validation
acc: 0.824645
AUC: 0.921598
Avg Precision: 0.359865
Avg Recall: 1.000000
d_prime: 2.002392
train_loss: 0.039223
valid_loss: 1.017009
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0017133783146270841
Epoch-20 lr: 0.0017133783146270841
epoch 20 training time: 15.186
---------------
2023-09-11 22:24:51.661567
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03970	Per Sample Data Time 0.03116	Per Sample DNN Time 0.00854	Train Loss 0.0397	
start validation
acc: 0.838863
AUC: 0.929539
Avg Precision: 0.348360
Avg Recall: 1.000000
d_prime: 2.082243
train_loss: 0.022738
valid_loss: 0.976636
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00149029660971246
Epoch-21 lr: 0.00149029660971246
epoch 21 training time: 15.259
---------------
2023-09-11 22:25:06.920713
current #epochs=22, #steps=840
start validation
acc: 0.853081
AUC: 0.927821
Avg Precision: 0.367773
Avg Recall: 1.000000
d_prime: 2.064399
train_loss: 0.015342
valid_loss: 1.008463
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00149029660971246
Epoch-22 lr: 0.00149029660971246
epoch 22 training time: 15.055
---------------
2023-09-11 22:25:21.975651
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00566	Train Loss 0.0178	
start validation
acc: 0.843602
AUC: 0.928935
Avg Precision: 0.359573
Avg Recall: 1.000000
d_prime: 2.075936
train_loss: 0.023854
valid_loss: 0.997583
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00149029660971246
Epoch-23 lr: 0.00149029660971246
epoch 23 training time: 16.060
---------------
2023-09-11 22:25:38.035737
current #epochs=24, #steps=920
start validation
acc: 0.843602
AUC: 0.931423
Avg Precision: 0.369683
Avg Recall: 1.000000
d_prime: 2.102193
train_loss: 0.019411
valid_loss: 0.996974
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00149029660971246
Epoch-24 lr: 0.00149029660971246
epoch 24 training time: 15.187
---------------
2023-09-11 22:25:53.222765
current #epochs=25, #steps=960
start validation
acc: 0.824645
AUC: 0.920631
Avg Precision: 0.359336
Avg Recall: 1.000000
d_prime: 1.993096
train_loss: 0.031159
valid_loss: 1.019737
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00149029660971246
Epoch-25 lr: 0.00149029660971246
epoch 25 training time: 15.165
---------------
2023-09-11 22:26:08.387048
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03965	Per Sample Data Time 0.02812	Per Sample DNN Time 0.01153	Train Loss 0.0030	
start validation
acc: 0.843602
AUC: 0.928030
Avg Precision: 0.345138
Avg Recall: 1.000000
d_prime: 2.066553
train_loss: 0.030721
valid_loss: 1.003844
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00149029660971246
Epoch-26 lr: 0.00149029660971246
epoch 26 training time: 16.422
---------------
2023-09-11 22:26:24.808774
current #epochs=27, #steps=1040
start validation
acc: 0.829384
AUC: 0.928954
Avg Precision: 0.344453
Avg Recall: 1.000000
d_prime: 2.076127
train_loss: 0.019117
valid_loss: 0.988239
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00149029660971246
Epoch-27 lr: 0.00149029660971246
epoch 27 training time: 15.253
---------------
2023-09-11 22:26:40.062098
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00566	Train Loss 0.0201	
start validation
acc: 0.829384
AUC: 0.922261
Avg Precision: 0.332623
Avg Recall: 1.000000
d_prime: 2.008815
train_loss: 0.021792
valid_loss: 0.987050
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00149029660971246
Epoch-28 lr: 0.00149029660971246
epoch 28 training time: 15.189
---------------
2023-09-11 22:26:55.251430
current #epochs=29, #steps=1120
start validation
acc: 0.853081
AUC: 0.926038
Avg Precision: 0.354676
Avg Recall: 1.000000
d_prime: 2.046228
train_loss: 0.026674
valid_loss: 0.995780
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00149029660971246
Epoch-29 lr: 0.00149029660971246
epoch 29 training time: 15.545
---------------
2023-09-11 22:27:10.796705
current #epochs=30, #steps=1160
start validation
acc: 0.857820
AUC: 0.931385
Avg Precision: 0.360646
Avg Recall: 1.000000
d_prime: 2.101785
train_loss: 0.016439
valid_loss: 0.973718
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0012962601230329265
Epoch-30 lr: 0.0012962601230329265
epoch 30 training time: 15.265
---------------
2023-09-11 22:27:26.061725
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03738	Per Sample Data Time 0.02969	Per Sample DNN Time 0.00769	Train Loss 0.0020	
start validation
acc: 0.857820
AUC: 0.925717
Avg Precision: 0.350352
Avg Recall: 1.000000
d_prime: 2.042998
train_loss: 0.016771
valid_loss: 0.975893
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0012962601230329265
Epoch-31 lr: 0.0012962601230329265
epoch 31 training time: 15.159
---------------
2023-09-11 22:27:41.220875
current #epochs=32, #steps=1240
start validation
acc: 0.838863
AUC: 0.926361
Avg Precision: 0.337464
Avg Recall: 1.000000
d_prime: 2.049494
train_loss: 0.013815
valid_loss: 1.010042
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0012962601230329265
Epoch-32 lr: 0.0012962601230329265
epoch 32 training time: 15.261
---------------
2023-09-11 22:27:56.481627
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00564	Train Loss 0.0149	
start validation
acc: 0.857820
AUC: 0.926873
Avg Precision: 0.364264
Avg Recall: 1.000000
d_prime: 2.054700
train_loss: 0.014622
valid_loss: 0.970082
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0012962601230329265
Epoch-33 lr: 0.0012962601230329265
epoch 33 training time: 15.145
---------------
2023-09-11 22:28:11.626776
current #epochs=34, #steps=1320
start validation
acc: 0.829384
AUC: 0.929576
Avg Precision: 0.349025
Avg Recall: 1.000000
d_prime: 2.082630
train_loss: 0.018271
valid_loss: 0.976475
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0012962601230329265
Epoch-34 lr: 0.0012962601230329265
epoch 34 training time: 15.463
---------------
2023-09-11 22:28:27.089688
current #epochs=35, #steps=1360
start validation
acc: 0.857820
AUC: 0.935733
Avg Precision: 0.374656
Avg Recall: 1.000000
d_prime: 2.149472
train_loss: 0.013940
valid_loss: 0.968404
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0012962601230329265
Epoch-35 lr: 0.0012962601230329265
epoch 35 training time: 15.016
---------------
2023-09-11 22:28:42.105664
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03707	Per Sample Data Time 0.02929	Per Sample DNN Time 0.00778	Train Loss 0.0002	
start validation
[I 2023-09-11 22:28:57,305] Trial 93 finished with value: 0.8625592417061612 and parameters: {'warmup': 'False', 'num_epochs': 36, 'batch_size': 28, 'lr-adaptschedule': 'True', 'lr': 0.0022647192464469402, 'head-lr': 1, 'lr-scheduler-start': 3, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.8698000885092457}. Best is trial 75 with value: 0.8862559241706162.
acc: 0.829384
AUC: 0.909663
Avg Precision: 0.318713
Avg Recall: 1.000000
d_prime: 1.893179
train_loss: 0.030621
valid_loss: 1.018398
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0012962601230329265
Epoch-36 lr: 0.0012962601230329265
epoch 36 training time: 15.185
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863efaa250>
The learning rate scheduler starts at 4 epoch with decay rate of 0.862 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 22:28:57.346942
current #epochs=1, #steps=0
start validation
acc: 0.867299
AUC: 0.927840
Avg Precision: 0.312014
Avg Recall: 1.000000
d_prime: 2.064596
train_loss: 0.021981
valid_loss: 0.990598
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0014365428916965422
Epoch-1 lr: 0.0014365428916965422
epoch 1 training time: 17.074
---------------
2023-09-11 22:29:14.421175
current #epochs=2, #steps=40
start validation
acc: 0.867299
AUC: 0.934806
Avg Precision: 0.337464
Avg Recall: 1.000000
d_prime: 2.139099
train_loss: 0.016334
valid_loss: 0.961153
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0014365428916965422
Epoch-2 lr: 0.0014365428916965422
epoch 2 training time: 16.352
---------------
2023-09-11 22:29:30.772880
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00556	Train Loss 0.0186	
start validation
acc: 0.853081
AUC: 0.936056
Avg Precision: 0.325004
Avg Recall: 1.000000
d_prime: 2.153115
train_loss: 0.019148
valid_loss: 0.964225
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0014365428916965422
Epoch-3 lr: 0.0014365428916965422
epoch 3 training time: 15.041
---------------
2023-09-11 22:29:45.813610
current #epochs=4, #steps=120
start validation
acc: 0.848341
AUC: 0.936838
Avg Precision: 0.356491
Avg Recall: 1.000000
d_prime: 2.161995
train_loss: 0.029034
valid_loss: 0.961357
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0012378117662693359
Epoch-4 lr: 0.0012378117662693359
epoch 4 training time: 16.801
---------------
2023-09-11 22:30:02.614678
current #epochs=5, #steps=160
start validation
acc: 0.843602
AUC: 0.926768
Avg Precision: 0.354095
Avg Recall: 1.000000
d_prime: 2.053633
train_loss: 0.021672
valid_loss: 0.973499
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0012378117662693359
Epoch-5 lr: 0.0012378117662693359
epoch 5 training time: 15.168
---------------
2023-09-11 22:30:17.782965
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03696	Per Sample Data Time 0.02914	Per Sample DNN Time 0.00782	Train Loss 0.0188	
start validation
acc: 0.862559
AUC: 0.924349
Avg Precision: 0.332654
Avg Recall: 1.000000
d_prime: 2.029322
train_loss: 0.020949
valid_loss: 0.972780
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0012378117662693359
Epoch-6 lr: 0.0012378117662693359
epoch 6 training time: 15.087
---------------
2023-09-11 22:30:32.870067
current #epochs=7, #steps=240
start validation
acc: 0.848341
AUC: 0.932243
Avg Precision: 0.357298
Avg Recall: 1.000000
d_prime: 2.111007
train_loss: 0.014114
valid_loss: 0.976677
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.001066573074546578
Epoch-7 lr: 0.001066573074546578
epoch 7 training time: 15.153
---------------
2023-09-11 22:30:48.023655
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00722	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00568	Train Loss 0.0110	
start validation
acc: 0.843602
AUC: 0.932246
Avg Precision: 0.366980
Avg Recall: 1.000000
d_prime: 2.111038
train_loss: 0.010166
valid_loss: 0.972462
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001066573074546578
Epoch-8 lr: 0.001066573074546578
epoch 8 training time: 15.430
---------------
2023-09-11 22:31:03.453502
current #epochs=9, #steps=320
start validation
acc: 0.857820
AUC: 0.932012
Avg Precision: 0.355665
Avg Recall: 1.000000
d_prime: 2.108512
train_loss: 0.015833
valid_loss: 0.979011
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001066573074546578
Epoch-9 lr: 0.001066573074546578
epoch 9 training time: 15.200
---------------
2023-09-11 22:31:18.653957
current #epochs=10, #steps=360
start validation
acc: 0.857820
AUC: 0.932304
Avg Precision: 0.347598
Avg Recall: 1.000000
d_prime: 2.111665
train_loss: 0.016154
valid_loss: 0.960608
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0009190235174256813
Epoch-10 lr: 0.0009190235174256813
epoch 10 training time: 15.153
---------------
2023-09-11 22:31:33.807467
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.04050	Per Sample Data Time 0.02930	Per Sample DNN Time 0.01120	Train Loss 0.0170	
start validation
acc: 0.853081
AUC: 0.929279
Avg Precision: 0.366183
Avg Recall: 1.000000
d_prime: 2.079516
train_loss: 0.021374
valid_loss: 0.973569
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0009190235174256813
Epoch-11 lr: 0.0009190235174256813
epoch 11 training time: 15.305
---------------
2023-09-11 22:31:49.112521
current #epochs=12, #steps=440
start validation
acc: 0.848341
AUC: 0.931360
Avg Precision: 0.351609
Avg Recall: 1.000000
d_prime: 2.101516
train_loss: 0.027099
valid_loss: 0.978758
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0009190235174256813
Epoch-12 lr: 0.0009190235174256813
epoch 12 training time: 15.231
---------------
2023-09-11 22:32:04.343146
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00572	Train Loss 0.0177	
start validation
acc: 0.834123
AUC: 0.931904
Avg Precision: 0.347686
Avg Recall: 1.000000
d_prime: 2.107357
train_loss: 0.012341
valid_loss: 0.977157
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.000791885943624191
Epoch-13 lr: 0.000791885943624191
epoch 13 training time: 16.391
---------------
2023-09-11 22:32:20.734504
current #epochs=14, #steps=520
start validation
acc: 0.848341
AUC: 0.932925
Avg Precision: 0.328075
Avg Recall: 1.000000
d_prime: 2.118405
train_loss: 0.009609
valid_loss: 0.966868
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.000791885943624191
Epoch-14 lr: 0.000791885943624191
epoch 14 training time: 15.194
---------------
2023-09-11 22:32:35.929078
current #epochs=15, #steps=560
start validation
acc: 0.853081
AUC: 0.932736
Avg Precision: 0.347976
Avg Recall: 1.000000
d_prime: 2.116344
train_loss: 0.019206
valid_loss: 0.968417
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.000791885943624191
Epoch-15 lr: 0.000791885943624191
epoch 15 training time: 15.179
---------------
2023-09-11 22:32:51.108356
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03714	Per Sample Data Time 0.02859	Per Sample DNN Time 0.00855	Train Loss 0.0069	
start validation
acc: 0.843602
AUC: 0.928615
Avg Precision: 0.373900
Avg Recall: 1.000000
d_prime: 2.072607
train_loss: 0.014629
valid_loss: 0.980757
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0006823365624702698
Epoch-16 lr: 0.0006823365624702698
epoch 16 training time: 15.130
---------------
2023-09-11 22:33:06.238372
current #epochs=17, #steps=640
start validation
acc: 0.843602
AUC: 0.930858
Avg Precision: 0.370221
Avg Recall: 1.000000
d_prime: 2.096166
train_loss: 0.012899
valid_loss: 0.974445
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0006823365624702698
Epoch-17 lr: 0.0006823365624702698
epoch 17 training time: 15.177
---------------
2023-09-11 22:33:21.415625
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00566	Train Loss 0.0155	
start validation
acc: 0.853081
AUC: 0.933753
Avg Precision: 0.354182
Avg Recall: 1.000000
d_prime: 2.127455
train_loss: 0.018748
valid_loss: 0.981952
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0006823365624702698
Epoch-18 lr: 0.0006823365624702698
epoch 18 training time: 16.327
---------------
2023-09-11 22:33:37.742638
current #epochs=19, #steps=720
start validation
acc: 0.843602
AUC: 0.936310
Avg Precision: 0.335887
Avg Recall: 1.000000
d_prime: 2.155994
train_loss: 0.010968
valid_loss: 0.971222
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0005879422260646898
Epoch-19 lr: 0.0005879422260646898
epoch 19 training time: 16.655
---------------
2023-09-11 22:33:54.397974
current #epochs=20, #steps=760
start validation
acc: 0.848341
AUC: 0.937110
Avg Precision: 0.338072
Avg Recall: 1.000000
d_prime: 2.165097
train_loss: 0.016044
valid_loss: 0.976769
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0005879422260646898
Epoch-20 lr: 0.0005879422260646898
epoch 20 training time: 15.198
---------------
2023-09-11 22:34:09.596316
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03763	Per Sample Data Time 0.02962	Per Sample DNN Time 0.00802	Train Loss 0.0166	
start validation
acc: 0.853081
AUC: 0.936770
Avg Precision: 0.338659
Avg Recall: 1.000000
d_prime: 2.161223
train_loss: 0.011314
valid_loss: 0.974290
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0005879422260646898
Epoch-21 lr: 0.0005879422260646898
epoch 21 training time: 15.306
---------------
2023-09-11 22:34:24.902471
current #epochs=22, #steps=840
start validation
acc: 0.838863
AUC: 0.928819
Avg Precision: 0.345233
Avg Recall: 1.000000
d_prime: 2.074721
train_loss: 0.018800
valid_loss: 0.987502
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0005066063878190088
Epoch-22 lr: 0.0005066063878190088
epoch 22 training time: 15.156
---------------
2023-09-11 22:34:40.058359
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00570	Train Loss 0.0219	
start validation
acc: 0.857820
AUC: 0.926555
Avg Precision: 0.342837
Avg Recall: 1.000000
d_prime: 2.051467
train_loss: 0.017356
valid_loss: 1.004708
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0005066063878190088
Epoch-23 lr: 0.0005066063878190088
epoch 23 training time: 15.186
---------------
2023-09-11 22:34:55.243941
current #epochs=24, #steps=920
start validation
acc: 0.843602
AUC: 0.928324
Avg Precision: 0.346086
Avg Recall: 1.000000
d_prime: 2.069589
train_loss: 0.014440
valid_loss: 0.996949
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0005066063878190088
Epoch-24 lr: 0.0005066063878190088
epoch 24 training time: 16.282
---------------
2023-09-11 22:35:11.525763
current #epochs=25, #steps=960
start validation
acc: 0.848341
AUC: 0.931567
Avg Precision: 0.352601
Avg Recall: 1.000000
d_prime: 2.103733
train_loss: 0.006259
valid_loss: 0.990825
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00043652253708136523
Epoch-25 lr: 0.00043652253708136523
epoch 25 training time: 15.211
---------------
2023-09-11 22:35:26.736366
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.04045	Per Sample Data Time 0.02957	Per Sample DNN Time 0.01089	Train Loss 0.0001	
start validation
acc: 0.848341
AUC: 0.931764
Avg Precision: 0.343436
Avg Recall: 1.000000
d_prime: 2.105847
train_loss: 0.013090
valid_loss: 0.992000
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00043652253708136523
Epoch-26 lr: 0.00043652253708136523
epoch 26 training time: 15.315
---------------
2023-09-11 22:35:42.051666
current #epochs=27, #steps=1040
start validation
acc: 0.867299
AUC: 0.930528
Avg Precision: 0.342205
Avg Recall: 1.000000
d_prime: 2.092660
train_loss: 0.015541
valid_loss: 0.992167
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00043652253708136523
Epoch-27 lr: 0.00043652253708136523
epoch 27 training time: 15.059
---------------
2023-09-11 22:35:57.110536
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00566	Train Loss 0.0079	
start validation
acc: 0.872038
AUC: 0.933005
Avg Precision: 0.353992
Avg Recall: 1.000000
d_prime: 2.119271
train_loss: 0.008612
valid_loss: 0.994683
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00037613407560906797
Epoch-28 lr: 0.00037613407560906797
epoch 28 training time: 17.240
---------------
2023-09-11 22:36:14.350524
current #epochs=29, #steps=1120
start validation
acc: 0.862559
AUC: 0.935089
Avg Precision: 0.357240
Avg Recall: 1.000000
d_prime: 2.142252
train_loss: 0.007512
valid_loss: 0.989316
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00037613407560906797
Epoch-29 lr: 0.00037613407560906797
epoch 29 training time: 17.374
---------------
2023-09-11 22:36:31.724040
current #epochs=30, #steps=1160
start validation
acc: 0.857820
AUC: 0.934848
Avg Precision: 0.364607
Avg Recall: 1.000000
d_prime: 2.139569
train_loss: 0.008673
valid_loss: 0.995902
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00037613407560906797
Epoch-30 lr: 0.00037613407560906797
epoch 30 training time: 15.090
---------------
2023-09-11 22:36:46.813996
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03915	Per Sample Data Time 0.02794	Per Sample DNN Time 0.01121	Train Loss 0.0272	
start validation
acc: 0.857820
AUC: 0.937847
Avg Precision: 0.365397
Avg Recall: 1.000000
d_prime: 2.173578
train_loss: 0.008511
valid_loss: 0.990455
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0003240997447238735
Epoch-31 lr: 0.0003240997447238735
epoch 31 training time: 15.216
---------------
2023-09-11 22:37:02.029885
current #epochs=32, #steps=1240
start validation
acc: 0.853081
AUC: 0.938138
Avg Precision: 0.358560
Avg Recall: 1.000000
d_prime: 2.176943
train_loss: 0.008794
valid_loss: 0.982456
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0003240997447238735
Epoch-32 lr: 0.0003240997447238735
epoch 32 training time: 15.396
---------------
2023-09-11 22:37:17.425533
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00561	Train Loss 0.0132	
start validation
acc: 0.848341
AUC: 0.936355
Avg Precision: 0.354738
Avg Recall: 1.000000
d_prime: 2.156506
train_loss: 0.009364
valid_loss: 0.985235
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0003240997447238735
Epoch-33 lr: 0.0003240997447238735
epoch 33 training time: 15.044
---------------
2023-09-11 22:37:32.469358
current #epochs=34, #steps=1320
start validation
acc: 0.848341
AUC: 0.936984
Avg Precision: 0.346731
Avg Recall: 1.000000
d_prime: 2.163659
train_loss: 0.013178
valid_loss: 0.981658
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0002792638352693499
Epoch-34 lr: 0.0002792638352693499
epoch 34 training time: 15.030
---------------
2023-09-11 22:37:47.498868
current #epochs=35, #steps=1360
start validation
acc: 0.867299
AUC: 0.936867
Avg Precision: 0.342829
Avg Recall: 1.000000
d_prime: 2.162324
train_loss: 0.008189
valid_loss: 0.974051
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0002792638352693499
Epoch-35 lr: 0.0002792638352693499
epoch 35 training time: 15.174
---------------
2023-09-11 22:38:02.672532
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03649	Per Sample Data Time 0.02763	Per Sample DNN Time 0.00886	Train Loss 0.0002	
start validation
acc: 0.862559
AUC: 0.937164
Avg Precision: 0.350771
Avg Recall: 1.000000
d_prime: 2.165714
train_loss: 0.020421
valid_loss: 0.966345
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0002792638352693499
Epoch-36 lr: 0.0002792638352693499
epoch 36 training time: 15.101
---------------
2023-09-11 22:38:17.773555
current #epochs=37, #steps=1440
start validation
acc: 0.867299
AUC: 0.935121
Avg Precision: 0.371133
Avg Recall: 1.000000
d_prime: 2.142611
train_loss: 0.008920
valid_loss: 0.968163
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.00024063051871821457
Epoch-37 lr: 0.00024063051871821457
epoch 37 training time: 15.146
---------------
2023-09-11 22:38:32.919787
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00722	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00572	Train Loss 0.0111	
start validation
acc: 0.862559
AUC: 0.935066
Avg Precision: 0.373547
Avg Recall: 1.000000
d_prime: 2.142000
train_loss: 0.013302
valid_loss: 0.972434
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.00024063051871821457
Epoch-38 lr: 0.00024063051871821457
epoch 38 training time: 15.188
---------------
2023-09-11 22:38:48.108221
current #epochs=39, #steps=1520
start validation
[I 2023-09-11 22:39:03,336] Trial 94 finished with value: 0.8720379146919431 and parameters: {'warmup': 'False', 'num_epochs': 39, 'batch_size': 41, 'lr-adaptschedule': 'True', 'lr': 0.0014365428916965422, 'head-lr': 1, 'lr-scheduler-start': 4, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.8616601518994627}. Best is trial 75 with value: 0.8862559241706162.
acc: 0.857820
AUC: 0.935926
Avg Precision: 0.374479
Avg Recall: 1.000000
d_prime: 2.151644
train_loss: 0.007206
valid_loss: 0.974924
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.00024063051871821457
Epoch-39 lr: 0.00024063051871821457
epoch 39 training time: 15.212
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863d97d760>
The learning rate scheduler starts at 4 epoch with decay rate of 0.891 every 8 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 22:39:03.378237
current #epochs=1, #steps=0
start validation
acc: 0.834123
AUC: 0.919209
Avg Precision: 0.333344
Avg Recall: 1.000000
d_prime: 1.979571
train_loss: 0.014744
valid_loss: 0.994017
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0018904317193289592
Epoch-1 lr: 0.0018904317193289592
epoch 1 training time: 17.182
---------------
2023-09-11 22:39:20.560974
current #epochs=2, #steps=40
start validation
acc: 0.853081
AUC: 0.938953
Avg Precision: 0.357463
Avg Recall: 1.000000
d_prime: 2.186433
train_loss: 0.040390
valid_loss: 0.996471
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0018904317193289592
Epoch-2 lr: 0.0018904317193289592
epoch 2 training time: 17.379
---------------
2023-09-11 22:39:37.940008
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00566	Train Loss 0.0216	
start validation
acc: 0.824645
AUC: 0.932149
Avg Precision: 0.363502
Avg Recall: 1.000000
d_prime: 2.109991
train_loss: 0.032960
valid_loss: 0.987306
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0018904317193289592
Epoch-3 lr: 0.0018904317193289592
epoch 3 training time: 15.644
---------------
2023-09-11 22:39:53.583918
current #epochs=4, #steps=120
start validation
acc: 0.838863
AUC: 0.936508
Avg Precision: 0.355966
Avg Recall: 1.000000
d_prime: 2.158242
train_loss: 0.027809
valid_loss: 0.974488
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0016848157054799996
Epoch-4 lr: 0.0016848157054799996
epoch 4 training time: 15.284
---------------
2023-09-11 22:40:08.868395
current #epochs=5, #steps=160
start validation
acc: 0.848341
AUC: 0.936501
Avg Precision: 0.377084
Avg Recall: 1.000000
d_prime: 2.158155
train_loss: 0.017794
valid_loss: 0.992159
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0016848157054799996
Epoch-5 lr: 0.0016848157054799996
epoch 5 training time: 15.175
---------------
2023-09-11 22:40:24.042934
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03613	Per Sample Data Time 0.02779	Per Sample DNN Time 0.00834	Train Loss 0.0013	
start validation
acc: 0.848341
AUC: 0.937904
Avg Precision: 0.367428
Avg Recall: 1.000000
d_prime: 2.174230
train_loss: 0.016354
valid_loss: 0.967275
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0016848157054799996
Epoch-6 lr: 0.0016848157054799996
epoch 6 training time: 15.097
---------------
2023-09-11 22:40:39.140266
current #epochs=7, #steps=240
start validation
acc: 0.862559
AUC: 0.935997
Avg Precision: 0.394947
Avg Recall: 1.000000
d_prime: 2.152448
train_loss: 0.012251
valid_loss: 0.959548
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0016848157054799996
Epoch-7 lr: 0.0016848157054799996
epoch 7 training time: 17.372
---------------
2023-09-11 22:40:56.512505
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00726	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00572	Train Loss 0.0276	
start validation
acc: 0.853081
AUC: 0.941170
Avg Precision: 0.356945
Avg Recall: 1.000000
d_prime: 2.212781
train_loss: 0.021132
valid_loss: 0.952670
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0016848157054799996
Epoch-8 lr: 0.0016848157054799996
epoch 8 training time: 15.306
---------------
2023-09-11 22:41:11.819044
current #epochs=9, #steps=320
start validation
acc: 0.857820
AUC: 0.936739
Avg Precision: 0.365045
Avg Recall: 1.000000
d_prime: 2.160869
train_loss: 0.018522
valid_loss: 0.972795
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0016848157054799996
Epoch-9 lr: 0.0016848157054799996
epoch 9 training time: 15.156
---------------
2023-09-11 22:41:26.975083
current #epochs=10, #steps=360
start validation
acc: 0.862559
AUC: 0.936486
Avg Precision: 0.346213
Avg Recall: 1.000000
d_prime: 2.157986
train_loss: 0.018650
valid_loss: 0.952753
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0016848157054799996
Epoch-10 lr: 0.0016848157054799996
epoch 10 training time: 15.179
---------------
2023-09-11 22:41:42.154282
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.04046	Per Sample Data Time 0.02935	Per Sample DNN Time 0.01112	Train Loss 0.0187	
start validation
acc: 0.843602
AUC: 0.938333
Avg Precision: 0.352650
Avg Recall: 1.000000
d_prime: 2.179202
train_loss: 0.025871
valid_loss: 0.956642
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0016848157054799996
Epoch-11 lr: 0.0016848157054799996
epoch 11 training time: 15.181
---------------
2023-09-11 22:41:57.335591
current #epochs=12, #steps=440
start validation
acc: 0.853081
AUC: 0.937349
Avg Precision: 0.367597
Avg Recall: 1.000000
d_prime: 2.167843
train_loss: 0.021065
valid_loss: 0.979806
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00150156386628959
Epoch-12 lr: 0.00150156386628959
epoch 12 training time: 15.186
---------------
2023-09-11 22:42:12.521548
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00573	Train Loss 0.0208	
start validation
acc: 0.843602
AUC: 0.930943
Avg Precision: 0.346625
Avg Recall: 1.000000
d_prime: 2.097066
train_loss: 0.024010
valid_loss: 0.973776
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00150156386628959
Epoch-13 lr: 0.00150156386628959
epoch 13 training time: 15.182
---------------
2023-09-11 22:42:27.703318
current #epochs=14, #steps=520
start validation
acc: 0.867299
AUC: 0.926294
Avg Precision: 0.371297
Avg Recall: 1.000000
d_prime: 2.048816
train_loss: 0.018269
valid_loss: 0.993249
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.00150156386628959
Epoch-14 lr: 0.00150156386628959
epoch 14 training time: 17.352
---------------
2023-09-11 22:42:45.055396
current #epochs=15, #steps=560
start validation
acc: 0.824645
AUC: 0.929774
Avg Precision: 0.343623
Avg Recall: 1.000000
d_prime: 2.084707
train_loss: 0.047908
valid_loss: 0.988644
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.00150156386628959
Epoch-15 lr: 0.00150156386628959
epoch 15 training time: 15.193
---------------
2023-09-11 22:43:00.248498
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03771	Per Sample Data Time 0.02761	Per Sample DNN Time 0.01010	Train Loss 0.0027	
start validation
acc: 0.843602
AUC: 0.929396
Avg Precision: 0.357703
Avg Recall: 1.000000
d_prime: 2.080741
train_loss: 0.031436
valid_loss: 0.984937
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.00150156386628959
Epoch-16 lr: 0.00150156386628959
epoch 16 training time: 15.164
---------------
2023-09-11 22:43:15.412930
current #epochs=17, #steps=640
start validation
acc: 0.829384
AUC: 0.934947
Avg Precision: 0.353866
Avg Recall: 1.000000
d_prime: 2.140675
train_loss: 0.037651
valid_loss: 0.986072
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.00150156386628959
Epoch-17 lr: 0.00150156386628959
epoch 17 training time: 15.253
---------------
2023-09-11 22:43:30.665769
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00567	Train Loss 0.0154	
start validation
acc: 0.834123
AUC: 0.932057
Avg Precision: 0.335018
Avg Recall: 1.000000
d_prime: 2.108999
train_loss: 0.017899
valid_loss: 0.993573
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00150156386628959
Epoch-18 lr: 0.00150156386628959
epoch 18 training time: 15.107
---------------
2023-09-11 22:43:45.773268
current #epochs=19, #steps=720
start validation
acc: 0.853081
AUC: 0.935473
Avg Precision: 0.349064
Avg Recall: 1.000000
d_prime: 2.146558
train_loss: 0.026326
valid_loss: 0.967514
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00150156386628959
Epoch-19 lr: 0.00150156386628959
epoch 19 training time: 15.132
---------------
2023-09-11 22:44:00.905571
current #epochs=20, #steps=760
start validation
acc: 0.862559
AUC: 0.932264
Avg Precision: 0.357807
Avg Recall: 1.000000
d_prime: 2.111232
train_loss: 0.017632
valid_loss: 0.968006
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0013382437243509581
Epoch-20 lr: 0.0013382437243509581
epoch 20 training time: 15.184
---------------
2023-09-11 22:44:16.089981
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03993	Per Sample Data Time 0.03156	Per Sample DNN Time 0.00837	Train Loss 0.0770	
start validation
acc: 0.829384
AUC: 0.926753
Avg Precision: 0.337090
Avg Recall: 1.000000
d_prime: 2.053479
train_loss: 0.016200
valid_loss: 0.999075
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0013382437243509581
Epoch-21 lr: 0.0013382437243509581
epoch 21 training time: 15.305
---------------
2023-09-11 22:44:31.394576
current #epochs=22, #steps=840
start validation
acc: 0.843602
AUC: 0.929030
Avg Precision: 0.331306
Avg Recall: 1.000000
d_prime: 2.076919
train_loss: 0.013610
valid_loss: 0.975046
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0013382437243509581
Epoch-22 lr: 0.0013382437243509581
epoch 22 training time: 15.134
---------------
2023-09-11 22:44:46.528579
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00723	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00567	Train Loss 0.0083	
start validation
acc: 0.853081
AUC: 0.929564
Avg Precision: 0.359080
Avg Recall: 1.000000
d_prime: 2.082502
train_loss: 0.011410
valid_loss: 0.977921
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0013382437243509581
Epoch-23 lr: 0.0013382437243509581
epoch 23 training time: 15.299
---------------
2023-09-11 22:45:01.827439
current #epochs=24, #steps=920
start validation
acc: 0.843602
AUC: 0.926022
Avg Precision: 0.341644
Avg Recall: 1.000000
d_prime: 2.046070
train_loss: 0.015970
valid_loss: 0.977733
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0013382437243509581
Epoch-24 lr: 0.0013382437243509581
epoch 24 training time: 15.091
---------------
2023-09-11 22:45:16.918049
current #epochs=25, #steps=960
start validation
acc: 0.853081
AUC: 0.930665
Avg Precision: 0.352322
Avg Recall: 1.000000
d_prime: 2.094109
train_loss: 0.021068
valid_loss: 0.983132
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0013382437243509581
Epoch-25 lr: 0.0013382437243509581
epoch 25 training time: 14.971
---------------
2023-09-11 22:45:31.889587
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03891	Per Sample Data Time 0.02902	Per Sample DNN Time 0.00990	Train Loss 0.0067	
start validation
acc: 0.843602
AUC: 0.931731
Avg Precision: 0.352257
Avg Recall: 1.000000
d_prime: 2.105495
train_loss: 0.018761
valid_loss: 0.970847
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0013382437243509581
Epoch-26 lr: 0.0013382437243509581
epoch 26 training time: 15.200
---------------
2023-09-11 22:45:47.089704
current #epochs=27, #steps=1040
start validation
acc: 0.843602
AUC: 0.939312
Avg Precision: 0.358315
Avg Recall: 1.000000
d_prime: 2.190650
train_loss: 0.023573
valid_loss: 0.971159
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0013382437243509581
Epoch-27 lr: 0.0013382437243509581
epoch 27 training time: 15.240
---------------
2023-09-11 22:46:02.329983
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00568	Train Loss 0.0245	
start validation
acc: 0.862559
AUC: 0.932086
Avg Precision: 0.337437
Avg Recall: 1.000000
d_prime: 2.109309
train_loss: 0.022440
valid_loss: 0.943672
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0011926873747901796
Epoch-28 lr: 0.0011926873747901796
epoch 28 training time: 15.160
---------------
2023-09-11 22:46:17.490035
current #epochs=29, #steps=1120
start validation
acc: 0.848341
AUC: 0.933693
Avg Precision: 0.356207
Avg Recall: 1.000000
d_prime: 2.126798
train_loss: 0.024536
valid_loss: 0.954299
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0011926873747901796
Epoch-29 lr: 0.0011926873747901796
epoch 29 training time: 15.146
---------------
2023-09-11 22:46:32.636195
current #epochs=30, #steps=1160
start validation
acc: 0.857820
AUC: 0.938451
Avg Precision: 0.366523
Avg Recall: 1.000000
d_prime: 2.180572
train_loss: 0.015368
valid_loss: 0.973483
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0011926873747901796
Epoch-30 lr: 0.0011926873747901796
epoch 30 training time: 15.355
---------------
2023-09-11 22:46:47.991513
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03751	Per Sample Data Time 0.02892	Per Sample DNN Time 0.00859	Train Loss 0.0147	
start validation
acc: 0.857820
AUC: 0.929342
Avg Precision: 0.342697
Avg Recall: 1.000000
d_prime: 2.080179
train_loss: 0.017625
valid_loss: 0.962412
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0011926873747901796
Epoch-31 lr: 0.0011926873747901796
epoch 31 training time: 15.217
---------------
2023-09-11 22:47:03.208567
current #epochs=32, #steps=1240
start validation
acc: 0.843602
AUC: 0.931367
Avg Precision: 0.369431
Avg Recall: 1.000000
d_prime: 2.101591
train_loss: 0.020016
valid_loss: 0.959419
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0011926873747901796
Epoch-32 lr: 0.0011926873747901796
epoch 32 training time: 15.181
---------------
2023-09-11 22:47:18.389724
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00565	Train Loss 0.0086	
start validation
acc: 0.843602
AUC: 0.933094
Avg Precision: 0.376018
Avg Recall: 1.000000
d_prime: 2.120239
train_loss: 0.010879
valid_loss: 0.972942
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0011926873747901796
Epoch-33 lr: 0.0011926873747901796
epoch 33 training time: 15.079
---------------
2023-09-11 22:47:33.468889
current #epochs=34, #steps=1320
start validation
acc: 0.843602
AUC: 0.934322
Avg Precision: 0.339060
Avg Recall: 1.000000
d_prime: 2.133733
train_loss: 0.018192
valid_loss: 0.977693
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0011926873747901796
Epoch-34 lr: 0.0011926873747901796
epoch 34 training time: 15.197
---------------
2023-09-11 22:47:48.665195
current #epochs=35, #steps=1360
start validation
acc: 0.829384
AUC: 0.935203
Avg Precision: 0.362146
Avg Recall: 1.000000
d_prime: 2.143528
train_loss: 0.015396
valid_loss: 0.971488
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0011926873747901796
Epoch-35 lr: 0.0011926873747901796
epoch 35 training time: 15.663
---------------
2023-09-11 22:48:04.327904
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03866	Per Sample Data Time 0.03021	Per Sample DNN Time 0.00845	Train Loss 0.0212	
start validation
acc: 0.829384
AUC: 0.935399
Avg Precision: 0.378628
Avg Recall: 1.000000
d_prime: 2.145722
train_loss: 0.012185
valid_loss: 0.977169
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0010629627085856855
Epoch-36 lr: 0.0010629627085856855
epoch 36 training time: 15.152
---------------
2023-09-11 22:48:19.479802
current #epochs=37, #steps=1440
start validation
acc: 0.838863
AUC: 0.932795
Avg Precision: 0.364711
Avg Recall: 1.000000
d_prime: 2.116988
train_loss: 0.012202
valid_loss: 0.995454
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0010629627085856855
Epoch-37 lr: 0.0010629627085856855
epoch 37 training time: 15.162
---------------
2023-09-11 22:48:34.642035
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00566	Train Loss 0.0129	
start validation
acc: 0.853081
AUC: 0.936323
Avg Precision: 0.363193
Avg Recall: 1.000000
d_prime: 2.156138
train_loss: 0.013799
valid_loss: 0.976548
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0010629627085856855
Epoch-38 lr: 0.0010629627085856855
epoch 38 training time: 15.139
---------------
2023-09-11 22:48:49.780931
current #epochs=39, #steps=1520
start validation
acc: 0.838863
AUC: 0.935929
Avg Precision: 0.365523
Avg Recall: 1.000000
d_prime: 2.151688
train_loss: 0.012401
valid_loss: 0.970813
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0010629627085856855
Epoch-39 lr: 0.0010629627085856855
epoch 39 training time: 15.175
---------------
2023-09-11 22:49:04.956636
current #epochs=40, #steps=1560
start validation
acc: 0.843602
AUC: 0.935624
Avg Precision: 0.375425
Avg Recall: 1.000000
d_prime: 2.148247
train_loss: 0.012064
valid_loss: 0.979879
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0010629627085856855
Epoch-40 lr: 0.0010629627085856855
epoch 40 training time: 16.395
---------------
2023-09-11 22:49:21.351667
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.04107	Per Sample Data Time 0.02960	Per Sample DNN Time 0.01147	Train Loss 0.0003	
start validation
[I 2023-09-11 22:49:36,670] Trial 95 finished with value: 0.8672985781990521 and parameters: {'warmup': 'False', 'num_epochs': 41, 'batch_size': 38, 'lr-adaptschedule': 'True', 'lr': 0.0018904317193289592, 'head-lr': 1, 'lr-scheduler-start': 4, 'lr-scheduler-step': 8, 'lr-scheduler-decay': 0.8912333030880658}. Best is trial 75 with value: 0.8862559241706162.
acc: 0.829384
AUC: 0.930203
Avg Precision: 0.355686
Avg Recall: 1.000000
d_prime: 2.089221
train_loss: 0.018850
valid_loss: 0.976149
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0010629627085856855
Epoch-41 lr: 0.0010629627085856855
epoch 41 training time: 15.304
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f86448d1490>
The learning rate scheduler starts at 3 epoch with decay rate of 0.900 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 22:49:36.711495
current #epochs=1, #steps=0
start validation
acc: 0.834123
AUC: 0.935104
Avg Precision: 0.353071
Avg Recall: 1.000000
d_prime: 2.142419
train_loss: 0.012598
valid_loss: 0.956414
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0017427257983172538
Epoch-1 lr: 0.0017427257983172538
epoch 1 training time: 18.404
---------------
2023-09-11 22:49:55.115980
current #epochs=2, #steps=40
start validation
acc: 0.876777
AUC: 0.940972
Avg Precision: 0.366407
Avg Recall: 1.000000
d_prime: 2.210389
train_loss: 0.056156
valid_loss: 0.964836
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0017427257983172538
Epoch-2 lr: 0.0017427257983172538
epoch 2 training time: 17.044
---------------
2023-09-11 22:50:12.159789
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00728	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00576	Train Loss 0.0245	
start validation
acc: 0.853081
AUC: 0.928761
Avg Precision: 0.344180
Avg Recall: 1.000000
d_prime: 2.074124
train_loss: 0.024740
valid_loss: 0.971995
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0015681999221747024
Epoch-3 lr: 0.0015681999221747024
epoch 3 training time: 15.243
---------------
2023-09-11 22:50:27.402698
current #epochs=4, #steps=120
start validation
acc: 0.867299
AUC: 0.929943
Avg Precision: 0.331132
Avg Recall: 1.000000
d_prime: 2.086488
train_loss: 0.023115
valid_loss: 0.980961
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0015681999221747024
Epoch-4 lr: 0.0015681999221747024
epoch 4 training time: 15.188
---------------
2023-09-11 22:50:42.591258
current #epochs=5, #steps=160
start validation
acc: 0.872038
AUC: 0.932727
Avg Precision: 0.327573
Avg Recall: 1.000000
d_prime: 2.116252
train_loss: 0.016793
valid_loss: 0.970133
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0015681999221747024
Epoch-5 lr: 0.0015681999221747024
epoch 5 training time: 15.167
---------------
2023-09-11 22:50:57.758193
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03739	Per Sample Data Time 0.02936	Per Sample DNN Time 0.00803	Train Loss 0.0089	
start validation
acc: 0.872038
AUC: 0.938308
Avg Precision: 0.334267
Avg Recall: 1.000000
d_prime: 2.178912
train_loss: 0.016646
valid_loss: 0.969842
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0015681999221747024
Epoch-6 lr: 0.0015681999221747024
epoch 6 training time: 15.116
---------------
2023-09-11 22:51:12.874288
current #epochs=7, #steps=240
start validation
acc: 0.862559
AUC: 0.935519
Avg Precision: 0.345974
Avg Recall: 1.000000
d_prime: 2.147067
train_loss: 0.021784
valid_loss: 0.956340
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0015681999221747024
Epoch-7 lr: 0.0015681999221747024
epoch 7 training time: 17.605
---------------
2023-09-11 22:51:30.478784
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00573	Train Loss 0.0085	
start validation
acc: 0.853081
AUC: 0.928436
Avg Precision: 0.347787
Avg Recall: 1.000000
d_prime: 2.070749
train_loss: 0.011131
valid_loss: 0.968846
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0015681999221747024
Epoch-8 lr: 0.0015681999221747024
epoch 8 training time: 15.242
---------------
2023-09-11 22:51:45.720712
current #epochs=9, #steps=320
start validation
acc: 0.853081
AUC: 0.933022
Avg Precision: 0.342477
Avg Recall: 1.000000
d_prime: 2.119461
train_loss: 0.025517
valid_loss: 0.972648
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0015681999221747024
Epoch-9 lr: 0.0015681999221747024
epoch 9 training time: 15.274
---------------
2023-09-11 22:52:00.995238
current #epochs=10, #steps=360
start validation
acc: 0.843602
AUC: 0.922360
Avg Precision: 0.319162
Avg Recall: 1.000000
d_prime: 2.009776
train_loss: 0.028091
valid_loss: 0.981717
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0015681999221747024
Epoch-10 lr: 0.0015681999221747024
epoch 10 training time: 15.223
---------------
2023-09-11 22:52:16.218435
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03825	Per Sample Data Time 0.02810	Per Sample DNN Time 0.01015	Train Loss 0.0364	
start validation
acc: 0.843602
AUC: 0.919569
Avg Precision: 0.335298
Avg Recall: 1.000000
d_prime: 1.982984
train_loss: 0.022676
valid_loss: 0.983093
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0015681999221747024
Epoch-11 lr: 0.0015681999221747024
epoch 11 training time: 15.124
---------------
2023-09-11 22:52:31.343222
current #epochs=12, #steps=440
start validation
acc: 0.857820
AUC: 0.923668
Avg Precision: 0.308826
Avg Recall: 1.000000
d_prime: 2.022587
train_loss: 0.024771
valid_loss: 0.968743
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0014111520000928163
Epoch-12 lr: 0.0014111520000928163
epoch 12 training time: 15.146
---------------
2023-09-11 22:52:46.489478
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00570	Train Loss 0.0139	
start validation
acc: 0.838863
AUC: 0.920314
Avg Precision: 0.329601
Avg Recall: 1.000000
d_prime: 1.990064
train_loss: 0.020359
valid_loss: 0.987864
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0014111520000928163
Epoch-13 lr: 0.0014111520000928163
epoch 13 training time: 15.095
---------------
2023-09-11 22:53:01.584889
current #epochs=14, #steps=520
start validation
acc: 0.862559
AUC: 0.922303
Avg Precision: 0.341714
Avg Recall: 1.000000
d_prime: 2.009225
train_loss: 0.006863
valid_loss: 0.979076
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0014111520000928163
Epoch-14 lr: 0.0014111520000928163
epoch 14 training time: 15.181
---------------
2023-09-11 22:53:16.765302
current #epochs=15, #steps=560
start validation
acc: 0.886256
AUC: 0.926697
Avg Precision: 0.362921
Avg Recall: 1.000000
d_prime: 2.052910
train_loss: 0.012486
valid_loss: 0.965847
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0014111520000928163
Epoch-15 lr: 0.0014111520000928163
epoch 15 training time: 17.049
---------------
2023-09-11 22:53:33.814049
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03755	Per Sample Data Time 0.02874	Per Sample DNN Time 0.00880	Train Loss 0.0660	
start validation
acc: 0.857820
AUC: 0.927500
Avg Precision: 0.337707
Avg Recall: 1.000000
d_prime: 2.061107
train_loss: 0.014566
valid_loss: 0.956672
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0014111520000928163
Epoch-16 lr: 0.0014111520000928163
epoch 16 training time: 16.011
---------------
2023-09-11 22:53:49.824891
current #epochs=17, #steps=640
start validation
acc: 0.848341
AUC: 0.923647
Avg Precision: 0.314782
Avg Recall: 1.000000
d_prime: 2.022383
train_loss: 0.013528
valid_loss: 0.969331
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0014111520000928163
Epoch-17 lr: 0.0014111520000928163
epoch 17 training time: 15.754
---------------
2023-09-11 22:54:05.579523
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00724	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00570	Train Loss 0.0096	
start validation
acc: 0.862559
AUC: 0.934630
Avg Precision: 0.321074
Avg Recall: 1.000000
d_prime: 2.137149
train_loss: 0.015867
valid_loss: 0.956538
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0014111520000928163
Epoch-18 lr: 0.0014111520000928163
epoch 18 training time: 15.250
---------------
2023-09-11 22:54:20.829255
current #epochs=19, #steps=720
start validation
acc: 0.848341
AUC: 0.941378
Avg Precision: 0.329612
Avg Recall: 1.000000
d_prime: 2.215289
train_loss: 0.017747
valid_loss: 0.961985
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0014111520000928163
Epoch-19 lr: 0.0014111520000928163
epoch 19 training time: 15.128
---------------
2023-09-11 22:54:35.957022
current #epochs=20, #steps=760
start validation
acc: 0.853081
AUC: 0.940416
Avg Precision: 0.335531
Avg Recall: 1.000000
d_prime: 2.203730
train_loss: 0.016969
valid_loss: 0.983508
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0014111520000928163
Epoch-20 lr: 0.0014111520000928163
epoch 20 training time: 15.214
---------------
2023-09-11 22:54:51.170887
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03781	Per Sample Data Time 0.02945	Per Sample DNN Time 0.00837	Train Loss 0.0417	
start validation
acc: 0.838863
AUC: 0.927399
Avg Precision: 0.357521
Avg Recall: 1.000000
d_prime: 2.060067
train_loss: 0.023611
valid_loss: 0.980628
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0012698316963340043
Epoch-21 lr: 0.0012698316963340043
epoch 21 training time: 16.681
---------------
2023-09-11 22:55:07.852275
current #epochs=22, #steps=840
start validation
acc: 0.853081
AUC: 0.935004
Avg Precision: 0.321935
Avg Recall: 1.000000
d_prime: 2.141308
train_loss: 0.017951
valid_loss: 0.967283
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0012698316963340043
Epoch-22 lr: 0.0012698316963340043
epoch 22 training time: 16.645
---------------
2023-09-11 22:55:24.497655
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00567	Train Loss 0.0140	
start validation
acc: 0.843602
AUC: 0.929756
Avg Precision: 0.340456
Avg Recall: 1.000000
d_prime: 2.084518
train_loss: 0.014979
valid_loss: 0.998463
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0012698316963340043
Epoch-23 lr: 0.0012698316963340043
epoch 23 training time: 15.182
---------------
2023-09-11 22:55:39.680667
current #epochs=24, #steps=920
start validation
acc: 0.848341
AUC: 0.922509
Avg Precision: 0.343223
Avg Recall: 1.000000
d_prime: 2.011225
train_loss: 0.018331
valid_loss: 0.992798
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0012698316963340043
Epoch-24 lr: 0.0012698316963340043
epoch 24 training time: 15.188
---------------
2023-09-11 22:55:54.867986
current #epochs=25, #steps=960
start validation
acc: 0.838863
AUC: 0.928950
Avg Precision: 0.346407
Avg Recall: 1.000000
d_prime: 2.076092
train_loss: 0.012142
valid_loss: 0.961999
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0012698316963340043
Epoch-25 lr: 0.0012698316963340043
epoch 25 training time: 15.166
---------------
2023-09-11 22:56:10.034148
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03501	Per Sample Data Time 0.02722	Per Sample DNN Time 0.00780	Train Loss 0.0346	
start validation
acc: 0.848341
AUC: 0.921493
Avg Precision: 0.361501
Avg Recall: 1.000000
d_prime: 2.001371
train_loss: 0.017889
valid_loss: 0.964978
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0012698316963340043
Epoch-26 lr: 0.0012698316963340043
epoch 26 training time: 15.172
---------------
2023-09-11 22:56:25.205961
current #epochs=27, #steps=1040
start validation
acc: 0.848341
AUC: 0.921787
Avg Precision: 0.338798
Avg Recall: 1.000000
d_prime: 2.004215
train_loss: 0.016499
valid_loss: 0.974541
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0012698316963340043
Epoch-27 lr: 0.0012698316963340043
epoch 27 training time: 15.080
---------------
2023-09-11 22:56:40.286365
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00566	Train Loss 0.0104	
start validation
acc: 0.838863
AUC: 0.924565
Avg Precision: 0.347483
Avg Recall: 1.000000
d_prime: 2.031466
train_loss: 0.013644
valid_loss: 0.981873
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0012698316963340043
Epoch-28 lr: 0.0012698316963340043
epoch 28 training time: 16.076
---------------
2023-09-11 22:56:56.362657
current #epochs=29, #steps=1120
start validation
acc: 0.824645
AUC: 0.926536
Avg Precision: 0.356565
Avg Recall: 1.000000
d_prime: 2.051275
train_loss: 0.020882
valid_loss: 0.985418
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0012698316963340043
Epoch-29 lr: 0.0012698316963340043
epoch 29 training time: 15.170
---------------
2023-09-11 22:57:11.532266
current #epochs=30, #steps=1160
start validation
acc: 0.834123
AUC: 0.930767
Avg Precision: 0.347582
Avg Recall: 1.000000
d_prime: 2.095191
train_loss: 0.009647
valid_loss: 0.990843
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.001142663963136811
Epoch-30 lr: 0.001142663963136811
epoch 30 training time: 15.137
---------------
2023-09-11 22:57:26.669642
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03982	Per Sample Data Time 0.02947	Per Sample DNN Time 0.01035	Train Loss 0.0025	
start validation
acc: 0.843602
AUC: 0.926359
Avg Precision: 0.327278
Avg Recall: 1.000000
d_prime: 2.049475
train_loss: 0.010897
valid_loss: 0.985654
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.001142663963136811
Epoch-31 lr: 0.001142663963136811
epoch 31 training time: 15.185
---------------
2023-09-11 22:57:41.854441
current #epochs=32, #steps=1240
start validation
acc: 0.834123
AUC: 0.930292
Avg Precision: 0.337536
Avg Recall: 1.000000
d_prime: 2.090163
train_loss: 0.023511
valid_loss: 1.009558
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.001142663963136811
Epoch-32 lr: 0.001142663963136811
epoch 32 training time: 15.180
---------------
2023-09-11 22:57:57.035038
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00564	Train Loss 0.0089	
start validation
acc: 0.853081
AUC: 0.934881
Avg Precision: 0.359025
Avg Recall: 1.000000
d_prime: 2.139942
train_loss: 0.012763
valid_loss: 0.978346
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.001142663963136811
Epoch-33 lr: 0.001142663963136811
epoch 33 training time: 16.279
---------------
2023-09-11 22:58:13.313661
current #epochs=34, #steps=1320
start validation
acc: 0.834123
AUC: 0.931970
Avg Precision: 0.369966
Avg Recall: 1.000000
d_prime: 2.108065
train_loss: 0.015642
valid_loss: 0.972193
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.001142663963136811
Epoch-34 lr: 0.001142663963136811
epoch 34 training time: 16.063
---------------
2023-09-11 22:58:29.377028
current #epochs=35, #steps=1360
start validation
acc: 0.838863
AUC: 0.929734
Avg Precision: 0.345647
Avg Recall: 1.000000
d_prime: 2.084282
train_loss: 0.019658
valid_loss: 0.978606
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.001142663963136811
Epoch-35 lr: 0.001142663963136811
epoch 35 training time: 15.962
---------------
2023-09-11 22:58:45.339187
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03840	Per Sample Data Time 0.03001	Per Sample DNN Time 0.00839	Train Loss 0.0005	
start validation
acc: 0.834123
AUC: 0.934911
Avg Precision: 0.335313
Avg Recall: 1.000000
d_prime: 2.140268
train_loss: 0.018312
valid_loss: 0.952194
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.001142663963136811
Epoch-36 lr: 0.001142663963136811
epoch 36 training time: 15.180
---------------
2023-09-11 22:59:00.519243
current #epochs=37, #steps=1440
start validation
acc: 0.853081
AUC: 0.932220
Avg Precision: 0.354070
Avg Recall: 1.000000
d_prime: 2.110761
train_loss: 0.026364
valid_loss: 0.974270
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.001142663963136811
Epoch-37 lr: 0.001142663963136811
epoch 37 training time: 15.228
---------------
2023-09-11 22:59:15.747229
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00723	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00565	Train Loss 0.0164	
start validation
acc: 0.824645
AUC: 0.910387
Avg Precision: 0.327579
Avg Recall: 1.000000
d_prime: 1.899491
train_loss: 0.018711
valid_loss: 0.997145
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.001142663963136811
Epoch-38 lr: 0.001142663963136811
epoch 38 training time: 15.236
---------------
2023-09-11 22:59:30.983242
current #epochs=39, #steps=1520
start validation
acc: 0.829384
AUC: 0.920120
Avg Precision: 0.316183
Avg Recall: 1.000000
d_prime: 1.988210
train_loss: 0.020295
valid_loss: 0.978574
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0010282314864410893
Epoch-39 lr: 0.0010282314864410893
epoch 39 training time: 15.045
---------------
2023-09-11 22:59:46.028604
current #epochs=40, #steps=1560
start validation
acc: 0.843602
AUC: 0.921000
Avg Precision: 0.319423
Avg Recall: 1.000000
d_prime: 1.996628
train_loss: 0.043255
valid_loss: 0.984259
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0010282314864410893
Epoch-40 lr: 0.0010282314864410893
epoch 40 training time: 15.209
---------------
2023-09-11 23:00:01.237906
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03781	Per Sample Data Time 0.02987	Per Sample DNN Time 0.00794	Train Loss 0.0007	
start validation
acc: 0.853081
AUC: 0.925318
Avg Precision: 0.327004
Avg Recall: 1.000000
d_prime: 2.038990
train_loss: 0.017619
valid_loss: 0.984186
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0010282314864410893
Epoch-41 lr: 0.0010282314864410893
epoch 41 training time: 15.227
---------------
2023-09-11 23:00:16.464938
current #epochs=42, #steps=1640
start validation
acc: 0.838863
AUC: 0.927088
Avg Precision: 0.323140
Avg Recall: 1.000000
d_prime: 2.056891
train_loss: 0.022166
valid_loss: 0.998701
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0010282314864410893
Epoch-42 lr: 0.0010282314864410893
epoch 42 training time: 15.168
---------------
2023-09-11 23:00:31.632952
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00722	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00570	Train Loss 0.0227	
start validation
acc: 0.862559
AUC: 0.931357
Avg Precision: 0.338699
Avg Recall: 1.000000
d_prime: 2.101481
train_loss: 0.019712
valid_loss: 0.986253
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0010282314864410893
Epoch-43 lr: 0.0010282314864410893
epoch 43 training time: 15.335
---------------
2023-09-11 23:00:46.967916
current #epochs=44, #steps=1720
start validation
[I 2023-09-11 23:01:02,272] Trial 96 finished with value: 0.8862559241706162 and parameters: {'warmup': 'False', 'num_epochs': 44, 'batch_size': 33, 'lr-adaptschedule': 'True', 'lr': 0.0017427257983172538, 'head-lr': 1, 'lr-scheduler-start': 3, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.899854655097738}. Best is trial 75 with value: 0.8862559241706162.
acc: 0.867299
AUC: 0.933314
Avg Precision: 0.342727
Avg Recall: 1.000000
d_prime: 2.122650
train_loss: 0.014211
valid_loss: 0.983220
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0010282314864410893
Epoch-44 lr: 0.0010282314864410893
epoch 44 training time: 15.290
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f8667042af0>
The learning rate scheduler starts at 3 epoch with decay rate of 0.899 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 23:01:02.313685
current #epochs=1, #steps=0
start validation
acc: 0.843602
AUC: 0.929095
Avg Precision: 0.336072
Avg Recall: 1.000000
d_prime: 2.077596
train_loss: 0.023744
valid_loss: 0.981896
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.001732639335266933
Epoch-1 lr: 0.001732639335266933
epoch 1 training time: 17.091
---------------
2023-09-11 23:01:19.405051
current #epochs=2, #steps=40
start validation
acc: 0.867299
AUC: 0.931107
Avg Precision: 0.332186
Avg Recall: 1.000000
d_prime: 2.098810
train_loss: 0.025840
valid_loss: 0.972025
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.001732639335266933
Epoch-2 lr: 0.001732639335266933
epoch 2 training time: 17.212
---------------
2023-09-11 23:01:36.616847
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00566	Train Loss 0.0125	
start validation
acc: 0.862559
AUC: 0.929096
Avg Precision: 0.332871
Avg Recall: 1.000000
d_prime: 2.077609
train_loss: 0.014814
valid_loss: 0.966541
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0015574403987788398
Epoch-3 lr: 0.0015574403987788398
epoch 3 training time: 15.273
---------------
2023-09-11 23:01:51.889553
current #epochs=4, #steps=120
start validation
acc: 0.848341
AUC: 0.926765
Avg Precision: 0.347875
Avg Recall: 1.000000
d_prime: 2.053595
train_loss: 0.028291
valid_loss: 0.983494
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0015574403987788398
Epoch-4 lr: 0.0015574403987788398
epoch 4 training time: 15.240
---------------
2023-09-11 23:02:07.129325
current #epochs=5, #steps=160
start validation
acc: 0.838863
AUC: 0.923961
Avg Precision: 0.323229
Avg Recall: 1.000000
d_prime: 2.025479
train_loss: 0.018742
valid_loss: 0.965635
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0015574403987788398
Epoch-5 lr: 0.0015574403987788398
epoch 5 training time: 15.197
---------------
2023-09-11 23:02:22.326862
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03626	Per Sample Data Time 0.02768	Per Sample DNN Time 0.00858	Train Loss 0.0884	
start validation
acc: 0.857820
AUC: 0.939740
Avg Precision: 0.316459
Avg Recall: 1.000000
d_prime: 2.195699
train_loss: 0.021191
valid_loss: 0.959226
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0015574403987788398
Epoch-6 lr: 0.0015574403987788398
epoch 6 training time: 15.133
---------------
2023-09-11 23:02:37.459900
current #epochs=7, #steps=240
start validation
acc: 0.843602
AUC: 0.933162
Avg Precision: 0.330125
Avg Recall: 1.000000
d_prime: 2.120980
train_loss: 0.017317
valid_loss: 0.965995
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0015574403987788398
Epoch-7 lr: 0.0015574403987788398
epoch 7 training time: 15.103
---------------
2023-09-11 23:02:52.562302
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00728	Per Sample Data Time 0.00157	Per Sample DNN Time 0.00571	Train Loss 0.0172	
start validation
acc: 0.834123
AUC: 0.936333
Avg Precision: 0.327806
Avg Recall: 1.000000
d_prime: 2.156253
train_loss: 0.022989
valid_loss: 0.991680
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0015574403987788398
Epoch-8 lr: 0.0015574403987788398
epoch 8 training time: 15.303
---------------
2023-09-11 23:03:07.865573
current #epochs=9, #steps=320
start validation
acc: 0.862559
AUC: 0.928145
Avg Precision: 0.308185
Avg Recall: 1.000000
d_prime: 2.067739
train_loss: 0.038666
valid_loss: 0.972163
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0015574403987788398
Epoch-9 lr: 0.0015574403987788398
epoch 9 training time: 15.264
---------------
2023-09-11 23:03:23.129659
current #epochs=10, #steps=360
start validation
acc: 0.848341
AUC: 0.924947
Avg Precision: 0.347141
Avg Recall: 1.000000
d_prime: 2.035278
train_loss: 0.019007
valid_loss: 0.977836
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0015574403987788398
Epoch-10 lr: 0.0015574403987788398
epoch 10 training time: 15.150
---------------
2023-09-11 23:03:38.279869
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.04110	Per Sample Data Time 0.02955	Per Sample DNN Time 0.01155	Train Loss 0.0010	
start validation
acc: 0.862559
AUC: 0.924163
Avg Precision: 0.342728
Avg Recall: 1.000000
d_prime: 2.027475
train_loss: 0.024978
valid_loss: 0.978422
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0015574403987788398
Epoch-11 lr: 0.0015574403987788398
epoch 11 training time: 15.266
---------------
2023-09-11 23:03:53.546038
current #epochs=12, #steps=440
start validation
acc: 0.810427
AUC: 0.925833
Avg Precision: 0.329456
Avg Recall: 1.000000
d_prime: 2.044164
train_loss: 0.036014
valid_loss: 0.980334
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0013999570172373449
Epoch-12 lr: 0.0013999570172373449
epoch 12 training time: 15.158
---------------
2023-09-11 23:04:08.703855
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00723	Per Sample Data Time 0.00157	Per Sample DNN Time 0.00566	Train Loss 0.0220	
start validation
acc: 0.853081
AUC: 0.927997
Avg Precision: 0.321997
Avg Recall: 1.000000
d_prime: 2.066218
train_loss: 0.026071
valid_loss: 0.970676
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0013999570172373449
Epoch-13 lr: 0.0013999570172373449
epoch 13 training time: 15.301
---------------
2023-09-11 23:04:24.004867
current #epochs=14, #steps=520
start validation
acc: 0.819905
AUC: 0.926865
Avg Precision: 0.335870
Avg Recall: 1.000000
d_prime: 2.054620
train_loss: 0.023326
valid_loss: 0.970303
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0013999570172373449
Epoch-14 lr: 0.0013999570172373449
epoch 14 training time: 15.238
---------------
2023-09-11 23:04:39.242968
current #epochs=15, #steps=560
start validation
acc: 0.824645
AUC: 0.922507
Avg Precision: 0.348665
Avg Recall: 1.000000
d_prime: 2.011210
train_loss: 0.019624
valid_loss: 0.990077
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0013999570172373449
Epoch-15 lr: 0.0013999570172373449
epoch 15 training time: 15.219
---------------
2023-09-11 23:04:54.461910
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03678	Per Sample Data Time 0.02924	Per Sample DNN Time 0.00754	Train Loss 0.0122	
start validation
acc: 0.824645
AUC: 0.920063
Avg Precision: 0.334744
Avg Recall: 1.000000
d_prime: 1.987670
train_loss: 0.018592
valid_loss: 0.979540
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0013999570172373449
Epoch-16 lr: 0.0013999570172373449
epoch 16 training time: 15.098
---------------
2023-09-11 23:05:09.560603
current #epochs=17, #steps=640
start validation
acc: 0.843602
AUC: 0.927363
Avg Precision: 0.330207
Avg Recall: 1.000000
d_prime: 2.059701
train_loss: 0.013740
valid_loss: 0.962232
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0013999570172373449
Epoch-17 lr: 0.0013999570172373449
epoch 17 training time: 15.205
---------------
2023-09-11 23:05:24.765174
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00565	Train Loss 0.0198	
start validation
acc: 0.810427
AUC: 0.926153
Avg Precision: 0.343427
Avg Recall: 1.000000
d_prime: 2.047397
train_loss: 0.016446
valid_loss: 1.002657
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0013999570172373449
Epoch-18 lr: 0.0013999570172373449
epoch 18 training time: 15.144
---------------
2023-09-11 23:05:39.909650
current #epochs=19, #steps=720
start validation
acc: 0.819905
AUC: 0.918028
Avg Precision: 0.324180
Avg Recall: 1.000000
d_prime: 1.968488
train_loss: 0.013956
valid_loss: 0.988600
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0013999570172373449
Epoch-19 lr: 0.0013999570172373449
epoch 19 training time: 15.234
---------------
2023-09-11 23:05:55.144398
current #epochs=20, #steps=760
start validation
acc: 0.829384
AUC: 0.924191
Avg Precision: 0.343182
Avg Recall: 1.000000
d_prime: 2.027755
train_loss: 0.011620
valid_loss: 1.000653
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0013999570172373449
Epoch-20 lr: 0.0013999570172373449
epoch 20 training time: 15.355
---------------
2023-09-11 23:06:10.498928
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03744	Per Sample Data Time 0.02876	Per Sample DNN Time 0.00867	Train Loss 0.0000	
start validation
acc: 0.834123
AUC: 0.925500
Avg Precision: 0.332586
Avg Recall: 1.000000
d_prime: 2.040812
train_loss: 0.013043
valid_loss: 0.985007
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0012583978505044488
Epoch-21 lr: 0.0012583978505044488
epoch 21 training time: 15.158
---------------
2023-09-11 23:06:25.657209
current #epochs=22, #steps=840
start validation
acc: 0.848341
AUC: 0.932661
Avg Precision: 0.330502
Avg Recall: 1.000000
d_prime: 2.115531
train_loss: 0.020591
valid_loss: 0.986840
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0012583978505044488
Epoch-22 lr: 0.0012583978505044488
epoch 22 training time: 15.117
---------------
2023-09-11 23:06:40.774084
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00568	Train Loss 0.0182	
start validation
acc: 0.838863
AUC: 0.927016
Avg Precision: 0.320928
Avg Recall: 1.000000
d_prime: 2.056152
train_loss: 0.015450
valid_loss: 0.973936
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0012583978505044488
Epoch-23 lr: 0.0012583978505044488
epoch 23 training time: 15.242
---------------
2023-09-11 23:06:56.016081
current #epochs=24, #steps=920
start validation
acc: 0.829384
AUC: 0.917128
Avg Precision: 0.335465
Avg Recall: 1.000000
d_prime: 1.960118
train_loss: 0.012132
valid_loss: 0.986483
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0012583978505044488
Epoch-24 lr: 0.0012583978505044488
epoch 24 training time: 15.278
---------------
2023-09-11 23:07:11.294645
current #epochs=25, #steps=960
start validation
acc: 0.805687
AUC: 0.912405
Avg Precision: 0.337714
Avg Recall: 1.000000
d_prime: 1.917267
train_loss: 0.013639
valid_loss: 1.020708
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0012583978505044488
Epoch-25 lr: 0.0012583978505044488
epoch 25 training time: 16.242
---------------
2023-09-11 23:07:27.536606
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03873	Per Sample Data Time 0.02817	Per Sample DNN Time 0.01056	Train Loss 0.0031	
start validation
acc: 0.824645
AUC: 0.902988
Avg Precision: 0.336187
Avg Recall: 1.000000
d_prime: 1.836735
train_loss: 0.017314
valid_loss: 1.012571
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0012583978505044488
Epoch-26 lr: 0.0012583978505044488
epoch 26 training time: 15.207
---------------
2023-09-11 23:07:42.744061
current #epochs=27, #steps=1040
start validation
acc: 0.829384
AUC: 0.917368
Avg Precision: 0.338853
Avg Recall: 1.000000
d_prime: 1.962337
train_loss: 0.019151
valid_loss: 0.994187
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0012583978505044488
Epoch-27 lr: 0.0012583978505044488
epoch 27 training time: 15.107
---------------
2023-09-11 23:07:57.851317
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00568	Train Loss 0.0228	
start validation
acc: 0.819905
AUC: 0.906939
Avg Precision: 0.325762
Avg Recall: 1.000000
d_prime: 1.869787
train_loss: 0.019485
valid_loss: 1.014771
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0012583978505044488
Epoch-28 lr: 0.0012583978505044488
epoch 28 training time: 15.241
---------------
2023-09-11 23:08:13.092284
current #epochs=29, #steps=1120
start validation
acc: 0.829384
AUC: 0.914633
Avg Precision: 0.324892
Avg Recall: 1.000000
d_prime: 1.937261
train_loss: 0.016048
valid_loss: 0.992319
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0012583978505044488
Epoch-29 lr: 0.0012583978505044488
epoch 29 training time: 15.171
---------------
2023-09-11 23:08:28.262944
current #epochs=30, #steps=1160
start validation
acc: 0.815166
AUC: 0.924001
Avg Precision: 0.358601
Avg Recall: 1.000000
d_prime: 2.025871
train_loss: 0.018838
valid_loss: 0.994539
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.001131152693015677
Epoch-30 lr: 0.001131152693015677
epoch 30 training time: 15.123
---------------
2023-09-11 23:08:43.386228
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03728	Per Sample Data Time 0.02913	Per Sample DNN Time 0.00815	Train Loss 0.0002	
start validation
acc: 0.848341
AUC: 0.926777
Avg Precision: 0.329770
Avg Recall: 1.000000
d_prime: 2.053718
train_loss: 0.008429
valid_loss: 0.968537
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.001131152693015677
Epoch-31 lr: 0.001131152693015677
epoch 31 training time: 15.147
---------------
2023-09-11 23:08:58.532819
current #epochs=32, #steps=1240
start validation
acc: 0.843602
AUC: 0.929064
Avg Precision: 0.350758
Avg Recall: 1.000000
d_prime: 2.077276
train_loss: 0.013551
valid_loss: 0.977746
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.001131152693015677
Epoch-32 lr: 0.001131152693015677
epoch 32 training time: 16.722
---------------
2023-09-11 23:09:15.254782
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00571	Train Loss 0.0133	
start validation
acc: 0.853081
AUC: 0.926984
Avg Precision: 0.338907
Avg Recall: 1.000000
d_prime: 2.055825
train_loss: 0.018334
valid_loss: 0.982980
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.001131152693015677
Epoch-33 lr: 0.001131152693015677
epoch 33 training time: 15.158
---------------
2023-09-11 23:09:30.412773
current #epochs=34, #steps=1320
start validation
acc: 0.843602
AUC: 0.922946
Avg Precision: 0.349950
Avg Recall: 1.000000
d_prime: 2.015495
train_loss: 0.024581
valid_loss: 0.992348
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.001131152693015677
Epoch-34 lr: 0.001131152693015677
epoch 34 training time: 15.128
---------------
2023-09-11 23:09:45.540648
current #epochs=35, #steps=1360
start validation
acc: 0.834123
AUC: 0.922712
Avg Precision: 0.337941
Avg Recall: 1.000000
d_prime: 2.013211
train_loss: 0.012160
valid_loss: 0.971887
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.001131152693015677
Epoch-35 lr: 0.001131152693015677
epoch 35 training time: 16.754
---------------
2023-09-11 23:10:02.295425
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03746	Per Sample Data Time 0.02946	Per Sample DNN Time 0.00800	Train Loss 0.0539	
start validation
acc: 0.834123
AUC: 0.929349
Avg Precision: 0.348122
Avg Recall: 1.000000
d_prime: 2.080247
train_loss: 0.014111
valid_loss: 0.998060
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.001131152693015677
Epoch-36 lr: 0.001131152693015677
epoch 36 training time: 15.326
---------------
2023-09-11 23:10:17.620937
current #epochs=37, #steps=1440
start validation
acc: 0.843602
AUC: 0.925946
Avg Precision: 0.351480
Avg Recall: 1.000000
d_prime: 2.045305
train_loss: 0.016905
valid_loss: 0.998558
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.001131152693015677
Epoch-37 lr: 0.001131152693015677
epoch 37 training time: 15.175
---------------
2023-09-11 23:10:32.795947
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00728	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00576	Train Loss 0.0057	
start validation
acc: 0.853081
AUC: 0.925594
Avg Precision: 0.332319
Avg Recall: 1.000000
d_prime: 2.041757
train_loss: 0.007112
valid_loss: 0.994464
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.001131152693015677
Epoch-38 lr: 0.001131152693015677
epoch 38 training time: 15.427
---------------
2023-09-11 23:10:48.223498
current #epochs=39, #steps=1520
start validation
acc: 0.834123
AUC: 0.923577
Avg Precision: 0.330397
Avg Recall: 1.000000
d_prime: 2.021693
train_loss: 0.015268
valid_loss: 0.996473
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0010167741580325395
Epoch-39 lr: 0.0010167741580325395
epoch 39 training time: 15.198
---------------
2023-09-11 23:11:03.420867
current #epochs=40, #steps=1560
start validation
acc: 0.829384
AUC: 0.927530
Avg Precision: 0.361009
Avg Recall: 1.000000
d_prime: 2.061414
train_loss: 0.018330
valid_loss: 0.992378
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0010167741580325395
Epoch-40 lr: 0.0010167741580325395
epoch 40 training time: 15.822
---------------
2023-09-11 23:11:19.243202
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.04005	Per Sample Data Time 0.02822	Per Sample DNN Time 0.01184	Train Loss 0.0716	
start validation
acc: 0.848341
AUC: 0.931755
Avg Precision: 0.361172
Avg Recall: 1.000000
d_prime: 2.105745
train_loss: 0.027919
valid_loss: 0.983873
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0010167741580325395
Epoch-41 lr: 0.0010167741580325395
epoch 41 training time: 15.175
---------------
2023-09-11 23:11:34.417946
current #epochs=42, #steps=1640
start validation
acc: 0.881517
AUC: 0.939318
Avg Precision: 0.368337
Avg Recall: 1.000000
d_prime: 2.190725
train_loss: 0.032444
valid_loss: 0.965813
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0010167741580325395
Epoch-42 lr: 0.0010167741580325395
epoch 42 training time: 17.223
---------------
2023-09-11 23:11:51.640751
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00722	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00568	Train Loss 0.0235	
start validation
acc: 0.867299
AUC: 0.931925
Avg Precision: 0.372298
Avg Recall: 1.000000
d_prime: 2.107581
train_loss: 0.026759
valid_loss: 0.971994
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0010167741580325395
Epoch-43 lr: 0.0010167741580325395
epoch 43 training time: 15.193
---------------
2023-09-11 23:12:06.833256
current #epochs=44, #steps=1720
start validation
[I 2023-09-11 23:12:21,869] Trial 97 finished with value: 0.8815165876777251 and parameters: {'warmup': 'False', 'num_epochs': 44, 'batch_size': 30, 'lr-adaptschedule': 'True', 'lr': 0.001732639335266933, 'head-lr': 1, 'lr-scheduler-start': 3, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.8988832049913598}. Best is trial 75 with value: 0.8862559241706162.
acc: 0.876777
AUC: 0.934335
Avg Precision: 0.366357
Avg Recall: 1.000000
d_prime: 2.133877
train_loss: 0.016353
valid_loss: 0.964633
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0010167741580325395
Epoch-44 lr: 0.0010167741580325395
epoch 44 training time: 15.020
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f859ea51910>
The learning rate scheduler starts at 3 epoch with decay rate of 0.902 every 8 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 23:12:21.910836
current #epochs=1, #steps=0
start validation
acc: 0.853081
AUC: 0.935067
Avg Precision: 0.361523
Avg Recall: 1.000000
d_prime: 2.142012
train_loss: 0.023778
valid_loss: 0.970701
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0017251296020317666
Epoch-1 lr: 0.0034502592040635332
epoch 1 training time: 17.144
---------------
2023-09-11 23:12:39.055346
current #epochs=2, #steps=40
start validation
acc: 0.881517
AUC: 0.931321
Avg Precision: 0.378081
Avg Recall: 1.000000
d_prime: 2.101096
train_loss: 0.014940
valid_loss: 0.963964
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0017251296020317666
Epoch-2 lr: 0.0034502592040635332
epoch 2 training time: 17.252
---------------
2023-09-11 23:12:56.307939
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00567	Train Loss 0.0234	
start validation
acc: 0.853081
AUC: 0.936852
Avg Precision: 0.343534
Avg Recall: 1.000000
d_prime: 2.162150
train_loss: 0.030254
valid_loss: 0.974946
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.001555534932852034
Epoch-3 lr: 0.003111069865704068
epoch 3 training time: 15.140
---------------
2023-09-11 23:13:11.447551
current #epochs=4, #steps=120
start validation
acc: 0.848341
AUC: 0.928858
Avg Precision: 0.351960
Avg Recall: 1.000000
d_prime: 2.075126
train_loss: 0.031973
valid_loss: 0.975392
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.001555534932852034
Epoch-4 lr: 0.003111069865704068
epoch 4 training time: 15.207
---------------
2023-09-11 23:13:26.654236
current #epochs=5, #steps=160
start validation
acc: 0.843602
AUC: 0.927093
Avg Precision: 0.359999
Avg Recall: 1.000000
d_prime: 2.056945
train_loss: 0.026164
valid_loss: 0.979943
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.001555534932852034
Epoch-5 lr: 0.003111069865704068
epoch 5 training time: 15.150
---------------
2023-09-11 23:13:41.804490
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03789	Per Sample Data Time 0.02977	Per Sample DNN Time 0.00812	Train Loss 0.0249	
start validation
acc: 0.829384
AUC: 0.926562
Avg Precision: 0.354636
Avg Recall: 1.000000
d_prime: 2.051538
train_loss: 0.024969
valid_loss: 0.995658
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.001555534932852034
Epoch-6 lr: 0.003111069865704068
epoch 6 training time: 15.124
---------------
2023-09-11 23:13:56.928577
current #epochs=7, #steps=240
start validation
acc: 0.819905
AUC: 0.932997
Avg Precision: 0.369247
Avg Recall: 1.000000
d_prime: 2.119187
train_loss: 0.030619
valid_loss: 0.998489
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.001555534932852034
Epoch-7 lr: 0.003111069865704068
epoch 7 training time: 15.216
---------------
2023-09-11 23:14:12.144819
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00727	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00568	Train Loss 0.0237	
start validation
acc: 0.819905
AUC: 0.921596
Avg Precision: 0.347378
Avg Recall: 1.000000
d_prime: 2.002372
train_loss: 0.021785
valid_loss: 1.010132
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001555534932852034
Epoch-8 lr: 0.003111069865704068
epoch 8 training time: 15.339
---------------
2023-09-11 23:14:27.484003
current #epochs=9, #steps=320
start validation
acc: 0.815166
AUC: 0.919281
Avg Precision: 0.344047
Avg Recall: 1.000000
d_prime: 1.980253
train_loss: 0.016722
valid_loss: 1.009645
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001555534932852034
Epoch-9 lr: 0.003111069865704068
epoch 9 training time: 15.609
---------------
2023-09-11 23:14:43.092808
current #epochs=10, #steps=360
start validation
acc: 0.834123
AUC: 0.923112
Avg Precision: 0.332879
Avg Recall: 1.000000
d_prime: 2.017117
train_loss: 0.025134
valid_loss: 0.995229
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001555534932852034
Epoch-10 lr: 0.003111069865704068
epoch 10 training time: 16.244
---------------
2023-09-11 23:14:59.337444
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03902	Per Sample Data Time 0.02930	Per Sample DNN Time 0.00972	Train Loss 0.0134	
start validation
acc: 0.843602
AUC: 0.924392
Avg Precision: 0.329555
Avg Recall: 1.000000
d_prime: 2.029751
train_loss: 0.014647
valid_loss: 0.983307
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0014026128381735496
Epoch-11 lr: 0.002805225676347099
epoch 11 training time: 15.171
---------------
2023-09-11 23:15:14.508123
current #epochs=12, #steps=440
start validation
acc: 0.848341
AUC: 0.927508
Avg Precision: 0.352573
Avg Recall: 1.000000
d_prime: 2.061192
train_loss: 0.014599
valid_loss: 0.976678
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0014026128381735496
Epoch-12 lr: 0.002805225676347099
epoch 12 training time: 15.182
---------------
2023-09-11 23:15:29.690489
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00567	Train Loss 0.0171	
start validation
acc: 0.838863
AUC: 0.924684
Avg Precision: 0.335099
Avg Recall: 1.000000
d_prime: 2.032656
train_loss: 0.014780
valid_loss: 0.986922
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0014026128381735496
Epoch-13 lr: 0.002805225676347099
epoch 13 training time: 15.040
---------------
2023-09-11 23:15:44.730690
current #epochs=14, #steps=520
start validation
acc: 0.843602
AUC: 0.924553
Avg Precision: 0.322056
Avg Recall: 1.000000
d_prime: 2.031353
train_loss: 0.018113
valid_loss: 0.972678
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0014026128381735496
Epoch-14 lr: 0.002805225676347099
epoch 14 training time: 15.124
---------------
2023-09-11 23:15:59.854581
current #epochs=15, #steps=560
start validation
acc: 0.810427
AUC: 0.931625
Avg Precision: 0.335260
Avg Recall: 1.000000
d_prime: 2.104355
train_loss: 0.014073
valid_loss: 0.985379
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0014026128381735496
Epoch-15 lr: 0.002805225676347099
epoch 15 training time: 15.188
---------------
2023-09-11 23:16:15.041957
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03815	Per Sample Data Time 0.03017	Per Sample DNN Time 0.00798	Train Loss 0.0000	
start validation
acc: 0.824645
AUC: 0.923071
Avg Precision: 0.342391
Avg Recall: 1.000000
d_prime: 2.016723
train_loss: 0.014598
valid_loss: 0.995791
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0014026128381735496
Epoch-16 lr: 0.002805225676347099
epoch 16 training time: 15.255
---------------
2023-09-11 23:16:30.296937
current #epochs=17, #steps=640
start validation
acc: 0.815166
AUC: 0.915334
Avg Precision: 0.322898
Avg Recall: 1.000000
d_prime: 1.943631
train_loss: 0.012898
valid_loss: 0.988933
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0014026128381735496
Epoch-17 lr: 0.002805225676347099
epoch 17 training time: 15.158
---------------
2023-09-11 23:16:45.455049
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00568	Train Loss 0.0301	
start validation
acc: 0.796209
AUC: 0.914657
Avg Precision: 0.349829
Avg Recall: 1.000000
d_prime: 1.937478
train_loss: 0.023425
valid_loss: 1.017170
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0014026128381735496
Epoch-18 lr: 0.002805225676347099
epoch 18 training time: 15.249
---------------
2023-09-11 23:17:00.704455
current #epochs=19, #steps=720
start validation
acc: 0.824645
AUC: 0.916727
Avg Precision: 0.345436
Avg Recall: 1.000000
d_prime: 1.956403
train_loss: 0.024405
valid_loss: 0.997546
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.001264724264470373
Epoch-19 lr: 0.002529448528940746
epoch 19 training time: 15.140
---------------
2023-09-11 23:17:15.844539
current #epochs=20, #steps=760
start validation
acc: 0.857820
AUC: 0.911939
Avg Precision: 0.331189
Avg Recall: 1.000000
d_prime: 1.913139
train_loss: 0.014633
valid_loss: 0.983294
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.001264724264470373
Epoch-20 lr: 0.002529448528940746
epoch 20 training time: 15.236
---------------
2023-09-11 23:17:31.080340
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03500	Per Sample Data Time 0.02702	Per Sample DNN Time 0.00798	Train Loss 0.0037	
start validation
acc: 0.834123
AUC: 0.915479
Avg Precision: 0.349777
Avg Recall: 1.000000
d_prime: 1.944950
train_loss: 0.016435
valid_loss: 0.988425
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.001264724264470373
Epoch-21 lr: 0.002529448528940746
epoch 21 training time: 15.099
---------------
2023-09-11 23:17:46.178943
current #epochs=22, #steps=840
start validation
acc: 0.834123
AUC: 0.911320
Avg Precision: 0.353441
Avg Recall: 1.000000
d_prime: 1.907677
train_loss: 0.016982
valid_loss: 1.016926
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.001264724264470373
Epoch-22 lr: 0.002529448528940746
epoch 22 training time: 15.126
---------------
2023-09-11 23:18:01.305112
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00724	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00571	Train Loss 0.0167	
start validation
acc: 0.834123
AUC: 0.908806
Avg Precision: 0.348980
Avg Recall: 1.000000
d_prime: 1.885770
train_loss: 0.012373
valid_loss: 1.009786
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.001264724264470373
Epoch-23 lr: 0.002529448528940746
epoch 23 training time: 15.298
---------------
2023-09-11 23:18:16.602654
current #epochs=24, #steps=920
start validation
acc: 0.824645
AUC: 0.911552
Avg Precision: 0.347037
Avg Recall: 1.000000
d_prime: 1.909719
train_loss: 0.015915
valid_loss: 1.002608
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.001264724264470373
Epoch-24 lr: 0.002529448528940746
epoch 24 training time: 15.158
---------------
2023-09-11 23:18:31.760962
current #epochs=25, #steps=960
start validation
acc: 0.829384
AUC: 0.918206
Avg Precision: 0.353360
Avg Recall: 1.000000
d_prime: 1.970150
train_loss: 0.015845
valid_loss: 0.994882
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.001264724264470373
Epoch-25 lr: 0.002529448528940746
epoch 25 training time: 15.087
---------------
2023-09-11 23:18:46.848003
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03957	Per Sample Data Time 0.02789	Per Sample DNN Time 0.01168	Train Loss 0.0001	
start validation
acc: 0.815166
AUC: 0.920470
Avg Precision: 0.365218
Avg Recall: 1.000000
d_prime: 1.991547
train_loss: 0.020654
valid_loss: 1.020982
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.001264724264470373
Epoch-26 lr: 0.002529448528940746
epoch 26 training time: 15.284
---------------
2023-09-11 23:19:02.131477
current #epochs=27, #steps=1040
start validation
acc: 0.819905
AUC: 0.912899
Avg Precision: 0.345112
Avg Recall: 1.000000
d_prime: 1.921668
train_loss: 0.015918
valid_loss: 1.016296
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0011403912908875082
Epoch-27 lr: 0.0022807825817750165
epoch 27 training time: 15.137
---------------
2023-09-11 23:19:17.268630
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00722	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00567	Train Loss 0.0247	
start validation
acc: 0.834123
AUC: 0.911648
Avg Precision: 0.363343
Avg Recall: 1.000000
d_prime: 1.910560
train_loss: 0.024785
valid_loss: 1.004816
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0011403912908875082
Epoch-28 lr: 0.0022807825817750165
epoch 28 training time: 15.262
---------------
2023-09-11 23:19:32.530554
current #epochs=29, #steps=1120
start validation
acc: 0.829384
AUC: 0.911771
Avg Precision: 0.363798
Avg Recall: 1.000000
d_prime: 1.911650
train_loss: 0.020719
valid_loss: 1.002920
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0011403912908875082
Epoch-29 lr: 0.0022807825817750165
epoch 29 training time: 15.209
---------------
2023-09-11 23:19:47.740009
current #epochs=30, #steps=1160
start validation
acc: 0.857820
AUC: 0.920920
Avg Precision: 0.323146
Avg Recall: 1.000000
d_prime: 1.995859
train_loss: 0.019328
valid_loss: 0.993706
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0011403912908875082
Epoch-30 lr: 0.0022807825817750165
epoch 30 training time: 15.222
---------------
2023-09-11 23:20:02.961559
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03729	Per Sample Data Time 0.03007	Per Sample DNN Time 0.00722	Train Loss 0.0060	
start validation
acc: 0.834123
AUC: 0.915155
Avg Precision: 0.311884
Avg Recall: 1.000000
d_prime: 1.941997
train_loss: 0.016583
valid_loss: 1.007548
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0011403912908875082
Epoch-31 lr: 0.0022807825817750165
epoch 31 training time: 15.191
---------------
2023-09-11 23:20:18.152207
current #epochs=32, #steps=1240
start validation
acc: 0.843602
AUC: 0.922594
Avg Precision: 0.318523
Avg Recall: 1.000000
d_prime: 2.012051
train_loss: 0.013831
valid_loss: 0.975567
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0011403912908875082
Epoch-32 lr: 0.0022807825817750165
epoch 32 training time: 16.640
---------------
2023-09-11 23:20:34.792108
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00723	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00570	Train Loss 0.0242	
start validation
acc: 0.805687
AUC: 0.914265
Avg Precision: 0.333730
Avg Recall: 1.000000
d_prime: 1.933928
train_loss: 0.021259
valid_loss: 1.000197
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0011403912908875082
Epoch-33 lr: 0.0022807825817750165
epoch 33 training time: 15.410
---------------
2023-09-11 23:20:50.202117
current #epochs=34, #steps=1320
start validation
acc: 0.843602
AUC: 0.921288
Avg Precision: 0.349265
Avg Recall: 1.000000
d_prime: 1.999399
train_loss: 0.013911
valid_loss: 0.995102
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0011403912908875082
Epoch-34 lr: 0.0022807825817750165
epoch 34 training time: 15.427
---------------
2023-09-11 23:21:05.628929
current #epochs=35, #steps=1360
start validation
acc: 0.848341
AUC: 0.928851
Avg Precision: 0.350325
Avg Recall: 1.000000
d_prime: 2.075060
train_loss: 0.016546
valid_loss: 0.990387
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0010282812885516063
Epoch-35 lr: 0.0020565625771032125
epoch 35 training time: 15.264
---------------
2023-09-11 23:21:20.893265
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03825	Per Sample Data Time 0.03076	Per Sample DNN Time 0.00749	Train Loss 0.0057	
start validation
acc: 0.843602
AUC: 0.920354
Avg Precision: 0.333839
Avg Recall: 1.000000
d_prime: 1.990445
train_loss: 0.027565
valid_loss: 0.992404
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0010282812885516063
Epoch-36 lr: 0.0020565625771032125
epoch 36 training time: 15.247
---------------
2023-09-11 23:21:36.139794
current #epochs=37, #steps=1440
start validation
acc: 0.819905
AUC: 0.921862
Avg Precision: 0.342943
Avg Recall: 1.000000
d_prime: 2.004942
train_loss: 0.019938
valid_loss: 1.000989
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0010282812885516063
Epoch-37 lr: 0.0020565625771032125
epoch 37 training time: 15.147
---------------
2023-09-11 23:21:51.286762
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00726	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00575	Train Loss 0.0224	
start validation
acc: 0.824645
AUC: 0.918695
Avg Precision: 0.334959
Avg Recall: 1.000000
d_prime: 1.974731
train_loss: 0.017336
valid_loss: 0.996862
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0010282812885516063
Epoch-38 lr: 0.0020565625771032125
epoch 38 training time: 15.304
---------------
2023-09-11 23:22:06.590169
current #epochs=39, #steps=1520
start validation
acc: 0.829384
AUC: 0.919208
Avg Precision: 0.334243
Avg Recall: 1.000000
d_prime: 1.979561
train_loss: 0.010183
valid_loss: 0.988675
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0010282812885516063
Epoch-39 lr: 0.0020565625771032125
epoch 39 training time: 15.184
---------------
2023-09-11 23:22:21.774686
current #epochs=40, #steps=1560
start validation
acc: 0.819905
AUC: 0.922587
Avg Precision: 0.363553
Avg Recall: 1.000000
d_prime: 2.011986
train_loss: 0.022409
valid_loss: 1.004707
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0010282812885516063
Epoch-40 lr: 0.0020565625771032125
epoch 40 training time: 15.093
---------------
2023-09-11 23:22:36.867625
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03990	Per Sample Data Time 0.02881	Per Sample DNN Time 0.01109	Train Loss 0.0569	
start validation
acc: 0.843602
AUC: 0.929847
Avg Precision: 0.343331
Avg Recall: 1.000000
d_prime: 2.085473
train_loss: 0.015774
valid_loss: 0.991871
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0010282812885516063
Epoch-41 lr: 0.0020565625771032125
epoch 41 training time: 15.208
---------------
2023-09-11 23:22:52.075947
current #epochs=42, #steps=1640
start validation
acc: 0.857820
AUC: 0.929840
Avg Precision: 0.335091
Avg Recall: 1.000000
d_prime: 2.085400
train_loss: 0.009229
valid_loss: 0.985484
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0010282812885516063
Epoch-42 lr: 0.0020565625771032125
epoch 42 training time: 15.293
---------------
2023-09-11 23:23:07.368815
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00568	Train Loss 0.0251	
start validation
acc: 0.819905
AUC: 0.925148
Avg Precision: 0.336064
Avg Recall: 1.000000
d_prime: 2.037280
train_loss: 0.020078
valid_loss: 0.988267
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0009271926371539199
Epoch-43 lr: 0.0018543852743078397
epoch 43 training time: 15.115
---------------
2023-09-11 23:23:22.483327
current #epochs=44, #steps=1720
start validation
[I 2023-09-11 23:23:37,600] Trial 98 finished with value: 0.8815165876777251 and parameters: {'warmup': 'False', 'num_epochs': 44, 'batch_size': 32, 'lr-adaptschedule': 'True', 'lr': 0.0017251296020317666, 'head-lr': 2, 'lr-scheduler-start': 3, 'lr-scheduler-step': 8, 'lr-scheduler-decay': 0.9016916358168147}. Best is trial 75 with value: 0.8862559241706162.
acc: 0.824645
AUC: 0.922688
Avg Precision: 0.355892
Avg Recall: 1.000000
d_prime: 2.012971
train_loss: 0.015479
valid_loss: 1.010284
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0009271926371539199
Epoch-44 lr: 0.0018543852743078397
epoch 44 training time: 15.102
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f863efc0910>
The learning rate scheduler starts at 3 epoch with decay rate of 0.905 every 8 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-11 23:23:37.642814
current #epochs=1, #steps=0
start validation
acc: 0.867299
AUC: 0.928034
Avg Precision: 0.339430
Avg Recall: 1.000000
d_prime: 2.066595
train_loss: 0.013355
valid_loss: 1.002833
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0013330871793377776
Epoch-1 lr: 0.0013330871793377776
epoch 1 training time: 17.680
---------------
2023-09-11 23:23:55.322718
current #epochs=2, #steps=40
start validation
acc: 0.848341
AUC: 0.924231
Avg Precision: 0.339571
Avg Recall: 1.000000
d_prime: 2.028154
train_loss: 0.020048
valid_loss: 1.006476
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0013330871793377776
Epoch-2 lr: 0.0013330871793377776
epoch 2 training time: 15.054
---------------
2023-09-11 23:24:10.376611
current #epochs=3, #steps=80
Epoch: [3][20/40]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00567	Train Loss 0.0125	
start validation
acc: 0.857820
AUC: 0.919154
Avg Precision: 0.345222
Avg Recall: 1.000000
d_prime: 1.979053
train_loss: 0.012762
valid_loss: 0.997350
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0012060408059575822
Epoch-3 lr: 0.0012060408059575822
epoch 3 training time: 15.095
---------------
2023-09-11 23:24:25.471647
current #epochs=4, #steps=120
start validation
acc: 0.838863
AUC: 0.920348
Avg Precision: 0.347599
Avg Recall: 1.000000
d_prime: 1.990385
train_loss: 0.012968
valid_loss: 1.002725
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0012060408059575822
Epoch-4 lr: 0.0012060408059575822
epoch 4 training time: 15.357
---------------
2023-09-11 23:24:40.828942
current #epochs=5, #steps=160
start validation
acc: 0.872038
AUC: 0.927673
Avg Precision: 0.305413
Avg Recall: 1.000000
d_prime: 2.062886
train_loss: 0.018792
valid_loss: 0.979873
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0012060408059575822
Epoch-5 lr: 0.0012060408059575822
epoch 5 training time: 17.897
---------------
2023-09-11 23:24:58.726232
current #epochs=6, #steps=200
Epoch: [6][0/40]	Per Sample Total Time 0.03958	Per Sample Data Time 0.02813	Per Sample DNN Time 0.01145	Train Loss 0.0011	
start validation
acc: 0.862559
AUC: 0.923336
Avg Precision: 0.308608
Avg Recall: 1.000000
d_prime: 2.019315
train_loss: 0.015973
valid_loss: 0.989845
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0012060408059575822
Epoch-6 lr: 0.0012060408059575822
epoch 6 training time: 15.311
---------------
2023-09-11 23:25:14.037070
current #epochs=7, #steps=240
start validation
acc: 0.853081
AUC: 0.918935
Avg Precision: 0.319220
Avg Recall: 1.000000
d_prime: 1.976992
train_loss: 0.012098
valid_loss: 0.993706
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0012060408059575822
Epoch-7 lr: 0.0012060408059575822
epoch 7 training time: 15.229
---------------
2023-09-11 23:25:29.265882
current #epochs=8, #steps=280
Epoch: [8][20/40]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00565	Train Loss 0.0082	
start validation
acc: 0.857820
AUC: 0.919866
Avg Precision: 0.329115
Avg Recall: 1.000000
d_prime: 1.985796
train_loss: 0.007239
valid_loss: 0.987958
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0012060408059575822
Epoch-8 lr: 0.0012060408059575822
epoch 8 training time: 15.186
---------------
2023-09-11 23:25:44.452119
current #epochs=9, #steps=320
start validation
acc: 0.867299
AUC: 0.926024
Avg Precision: 0.318281
Avg Recall: 1.000000
d_prime: 2.046092
train_loss: 0.012874
valid_loss: 0.974011
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0012060408059575822
Epoch-9 lr: 0.0012060408059575822
epoch 9 training time: 15.154
---------------
2023-09-11 23:25:59.606079
current #epochs=10, #steps=360
start validation
acc: 0.838863
AUC: 0.931478
Avg Precision: 0.316297
Avg Recall: 1.000000
d_prime: 2.102776
train_loss: 0.028966
valid_loss: 0.999982
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0012060408059575822
Epoch-10 lr: 0.0012060408059575822
epoch 10 training time: 15.013
---------------
2023-09-11 23:26:14.619871
current #epochs=11, #steps=400
Epoch: [11][0/40]	Per Sample Total Time 0.03855	Per Sample Data Time 0.02880	Per Sample DNN Time 0.00975	Train Loss 0.0002	
start validation
acc: 0.857820
AUC: 0.928980
Avg Precision: 0.350258
Avg Recall: 1.000000
d_prime: 2.076400
train_loss: 0.037950
valid_loss: 0.994851
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0010911022536105753
Epoch-11 lr: 0.0010911022536105753
epoch 11 training time: 15.101
---------------
2023-09-11 23:26:29.720941
current #epochs=12, #steps=440
start validation
acc: 0.834123
AUC: 0.918676
Avg Precision: 0.343964
Avg Recall: 1.000000
d_prime: 1.974556
train_loss: 0.010449
valid_loss: 1.002965
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0010911022536105753
Epoch-12 lr: 0.0010911022536105753
epoch 12 training time: 15.218
---------------
2023-09-11 23:26:44.939308
current #epochs=13, #steps=480
Epoch: [13][20/40]	Per Sample Total Time 0.00722	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00566	Train Loss 0.0159	
start validation
acc: 0.843602
AUC: 0.920646
Avg Precision: 0.331678
Avg Recall: 1.000000
d_prime: 1.993232
train_loss: 0.016239
valid_loss: 1.003730
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0010911022536105753
Epoch-13 lr: 0.0010911022536105753
epoch 13 training time: 15.217
---------------
2023-09-11 23:27:00.156584
current #epochs=14, #steps=520
start validation
acc: 0.848341
AUC: 0.926654
Avg Precision: 0.324453
Avg Recall: 1.000000
d_prime: 2.052468
train_loss: 0.011161
valid_loss: 0.990386
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0010911022536105753
Epoch-14 lr: 0.0010911022536105753
epoch 14 training time: 15.220
---------------
2023-09-11 23:27:15.376658
current #epochs=15, #steps=560
start validation
acc: 0.857820
AUC: 0.936749
Avg Precision: 0.329959
Avg Recall: 1.000000
d_prime: 2.160979
train_loss: 0.007924
valid_loss: 0.975790
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0010911022536105753
Epoch-15 lr: 0.0010911022536105753
epoch 15 training time: 15.226
---------------
2023-09-11 23:27:30.602791
current #epochs=16, #steps=600
Epoch: [16][0/40]	Per Sample Total Time 0.03738	Per Sample Data Time 0.02900	Per Sample DNN Time 0.00838	Train Loss 0.0061	
start validation
acc: 0.853081
AUC: 0.934692
Avg Precision: 0.323117
Avg Recall: 1.000000
d_prime: 2.137831
train_loss: 0.009315
valid_loss: 0.995740
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0010911022536105753
Epoch-16 lr: 0.0010911022536105753
epoch 16 training time: 15.687
---------------
2023-09-11 23:27:46.289617
current #epochs=17, #steps=640
start validation
acc: 0.862559
AUC: 0.923767
Avg Precision: 0.325080
Avg Recall: 1.000000
d_prime: 2.023566
train_loss: 0.017853
valid_loss: 0.987112
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0010911022536105753
Epoch-17 lr: 0.0010911022536105753
epoch 17 training time: 16.175
---------------
2023-09-11 23:28:02.464207
current #epochs=18, #steps=680
Epoch: [18][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00563	Train Loss 0.0095	
start validation
acc: 0.867299
AUC: 0.933776
Avg Precision: 0.312647
Avg Recall: 1.000000
d_prime: 2.127707
train_loss: 0.013391
valid_loss: 0.971586
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0010911022536105753
Epoch-18 lr: 0.0010911022536105753
epoch 18 training time: 15.181
---------------
2023-09-11 23:28:17.645348
current #epochs=19, #steps=720
start validation
acc: 0.843602
AUC: 0.926667
Avg Precision: 0.323587
Avg Recall: 1.000000
d_prime: 2.052597
train_loss: 0.009152
valid_loss: 0.986630
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0009871176182043276
Epoch-19 lr: 0.0009871176182043276
epoch 19 training time: 15.222
---------------
2023-09-11 23:28:32.867475
current #epochs=20, #steps=760
start validation
acc: 0.848341
AUC: 0.924943
Avg Precision: 0.329035
Avg Recall: 1.000000
d_prime: 2.035235
train_loss: 0.015005
valid_loss: 0.993042
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0009871176182043276
Epoch-20 lr: 0.0009871176182043276
epoch 20 training time: 15.143
---------------
2023-09-11 23:28:48.010801
current #epochs=21, #steps=800
Epoch: [21][0/40]	Per Sample Total Time 0.03764	Per Sample Data Time 0.02946	Per Sample DNN Time 0.00818	Train Loss 0.0014	
start validation
acc: 0.857820
AUC: 0.925612
Avg Precision: 0.321357
Avg Recall: 1.000000
d_prime: 2.041936
train_loss: 0.013055
valid_loss: 0.990679
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0009871176182043276
Epoch-21 lr: 0.0009871176182043276
epoch 21 training time: 16.219
---------------
2023-09-11 23:29:04.229410
current #epochs=22, #steps=840
start validation
acc: 0.857820
AUC: 0.926810
Avg Precision: 0.322110
Avg Recall: 1.000000
d_prime: 2.054054
train_loss: 0.013573
valid_loss: 0.994664
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0009871176182043276
Epoch-22 lr: 0.0009871176182043276
epoch 22 training time: 15.049
---------------
2023-09-11 23:29:19.278366
current #epochs=23, #steps=880
Epoch: [23][20/40]	Per Sample Total Time 0.00723	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00571	Train Loss 0.0167	
start validation
acc: 0.872038
AUC: 0.929395
Avg Precision: 0.331413
Avg Recall: 1.000000
d_prime: 2.080731
train_loss: 0.017207
valid_loss: 0.985918
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0009871176182043276
Epoch-23 lr: 0.0009871176182043276
epoch 23 training time: 15.213
---------------
2023-09-11 23:29:34.491256
current #epochs=24, #steps=920
start validation
acc: 0.857820
AUC: 0.919345
Avg Precision: 0.307187
Avg Recall: 1.000000
d_prime: 1.980858
train_loss: 0.010557
valid_loss: 0.975887
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0009871176182043276
Epoch-24 lr: 0.0009871176182043276
epoch 24 training time: 15.244
---------------
2023-09-11 23:29:49.734558
current #epochs=25, #steps=960
start validation
acc: 0.848341
AUC: 0.930686
Avg Precision: 0.326714
Avg Recall: 1.000000
d_prime: 2.094341
train_loss: 0.013449
valid_loss: 0.971887
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0009871176182043276
Epoch-25 lr: 0.0009871176182043276
epoch 25 training time: 15.118
---------------
2023-09-11 23:30:04.852829
current #epochs=26, #steps=1000
Epoch: [26][0/40]	Per Sample Total Time 0.03924	Per Sample Data Time 0.02910	Per Sample DNN Time 0.01015	Train Loss 0.0446	
start validation
acc: 0.848341
AUC: 0.937633
Avg Precision: 0.338686
Avg Recall: 1.000000
d_prime: 2.171104
train_loss: 0.013746
valid_loss: 0.987586
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0009871176182043276
Epoch-26 lr: 0.0009871176182043276
epoch 26 training time: 15.217
---------------
2023-09-11 23:30:20.069871
current #epochs=27, #steps=1040
start validation
acc: 0.843602
AUC: 0.929006
Avg Precision: 0.309094
Avg Recall: 1.000000
d_prime: 2.076669
train_loss: 0.010102
valid_loss: 1.011377
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0008930429654461678
Epoch-27 lr: 0.0008930429654461678
epoch 27 training time: 15.096
---------------
2023-09-11 23:30:35.165677
current #epochs=28, #steps=1080
Epoch: [28][20/40]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00567	Train Loss 0.0105	
start validation
acc: 0.843602
AUC: 0.925393
Avg Precision: 0.299915
Avg Recall: 1.000000
d_prime: 2.039737
train_loss: 0.014983
valid_loss: 0.989870
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0008930429654461678
Epoch-28 lr: 0.0008930429654461678
epoch 28 training time: 15.170
---------------
2023-09-11 23:30:50.335697
current #epochs=29, #steps=1120
start validation
acc: 0.838863
AUC: 0.920189
Avg Precision: 0.319467
Avg Recall: 1.000000
d_prime: 1.988867
train_loss: 0.016461
valid_loss: 0.998081
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0008930429654461678
Epoch-29 lr: 0.0008930429654461678
epoch 29 training time: 15.244
---------------
2023-09-11 23:31:05.580126
current #epochs=30, #steps=1160
start validation
acc: 0.843602
AUC: 0.919945
Avg Precision: 0.321190
Avg Recall: 1.000000
d_prime: 1.986547
train_loss: 0.017571
valid_loss: 0.971274
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0008930429654461678
Epoch-30 lr: 0.0008930429654461678
epoch 30 training time: 16.303
---------------
2023-09-11 23:31:21.883133
current #epochs=31, #steps=1200
Epoch: [31][0/40]	Per Sample Total Time 0.03786	Per Sample Data Time 0.02990	Per Sample DNN Time 0.00796	Train Loss 0.0033	
start validation
acc: 0.838863
AUC: 0.923373
Avg Precision: 0.325835
Avg Recall: 1.000000
d_prime: 2.019680
train_loss: 0.017282
valid_loss: 1.003233
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0008930429654461678
Epoch-31 lr: 0.0008930429654461678
epoch 31 training time: 15.170
---------------
2023-09-11 23:31:37.053513
current #epochs=32, #steps=1240
start validation
acc: 0.848341
AUC: 0.921921
Avg Precision: 0.318801
Avg Recall: 1.000000
d_prime: 2.005517
train_loss: 0.010976
valid_loss: 1.005475
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0008930429654461678
Epoch-32 lr: 0.0008930429654461678
epoch 32 training time: 15.200
---------------
2023-09-11 23:31:52.253749
current #epochs=33, #steps=1280
Epoch: [33][20/40]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00564	Train Loss 0.0130	
start validation
acc: 0.853081
AUC: 0.920622
Avg Precision: 0.336953
Avg Recall: 1.000000
d_prime: 1.993001
train_loss: 0.013138
valid_loss: 0.994150
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0008930429654461678
Epoch-33 lr: 0.0008930429654461678
epoch 33 training time: 15.130
---------------
2023-09-11 23:32:07.383801
current #epochs=34, #steps=1320
start validation
acc: 0.843602
AUC: 0.915478
Avg Precision: 0.339945
Avg Recall: 1.000000
d_prime: 1.944946
train_loss: 0.014919
valid_loss: 0.980510
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0008930429654461678
Epoch-34 lr: 0.0008930429654461678
epoch 34 training time: 15.824
---------------
2023-09-11 23:32:23.207719
current #epochs=35, #steps=1360
start validation
acc: 0.824645
AUC: 0.912637
Avg Precision: 0.323993
Avg Recall: 1.000000
d_prime: 1.919333
train_loss: 0.015105
valid_loss: 1.002176
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0008079338504601607
Epoch-35 lr: 0.0008079338504601607
epoch 35 training time: 15.140
---------------
2023-09-11 23:32:38.347378
current #epochs=36, #steps=1400
Epoch: [36][0/40]	Per Sample Total Time 0.03804	Per Sample Data Time 0.03030	Per Sample DNN Time 0.00774	Train Loss 0.0198	
start validation
acc: 0.834123
AUC: 0.916880
Avg Precision: 0.331311
Avg Recall: 1.000000
d_prime: 1.957821
train_loss: 0.012035
valid_loss: 0.982851
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0008079338504601607
Epoch-36 lr: 0.0008079338504601607
epoch 36 training time: 15.177
---------------
2023-09-11 23:32:53.524024
current #epochs=37, #steps=1440
start validation
acc: 0.843602
AUC: 0.922789
Avg Precision: 0.342080
Avg Recall: 1.000000
d_prime: 2.013960
train_loss: 0.013512
valid_loss: 0.991881
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0008079338504601607
Epoch-37 lr: 0.0008079338504601607
epoch 37 training time: 15.073
---------------
2023-09-11 23:33:08.596859
current #epochs=38, #steps=1480
Epoch: [38][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00567	Train Loss 0.0120	
start validation
acc: 0.834123
AUC: 0.929053
Avg Precision: 0.339429
Avg Recall: 1.000000
d_prime: 2.077156
train_loss: 0.012121
valid_loss: 1.006051
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0008079338504601607
Epoch-38 lr: 0.0008079338504601607
epoch 38 training time: 15.203
---------------
2023-09-11 23:33:23.800250
current #epochs=39, #steps=1520
start validation
acc: 0.848341
AUC: 0.925594
Avg Precision: 0.340602
Avg Recall: 1.000000
d_prime: 2.041755
train_loss: 0.010026
valid_loss: 1.005043
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0008079338504601607
Epoch-39 lr: 0.0008079338504601607
epoch 39 training time: 15.136
---------------
2023-09-11 23:33:38.935836
current #epochs=40, #steps=1560
start validation
acc: 0.838863
AUC: 0.926640
Avg Precision: 0.353431
Avg Recall: 1.000000
d_prime: 2.052330
train_loss: 0.007734
valid_loss: 1.005713
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0008079338504601607
Epoch-40 lr: 0.0008079338504601607
epoch 40 training time: 15.137
---------------
2023-09-11 23:33:54.072889
current #epochs=41, #steps=1600
Epoch: [41][0/40]	Per Sample Total Time 0.03913	Per Sample Data Time 0.02818	Per Sample DNN Time 0.01095	Train Loss 0.0011	
start validation
acc: 0.824645
AUC: 0.924770
Avg Precision: 0.357885
Avg Recall: 1.000000
d_prime: 2.033511
train_loss: 0.013326
valid_loss: 0.993575
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0008079338504601607
Epoch-41 lr: 0.0008079338504601607
epoch 41 training time: 15.168
---------------
2023-09-11 23:34:09.241364
current #epochs=42, #steps=1640
start validation
acc: 0.843602
AUC: 0.918073
Avg Precision: 0.328593
Avg Recall: 1.000000
d_prime: 1.968903
train_loss: 0.009648
valid_loss: 0.981464
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0008079338504601607
Epoch-42 lr: 0.0008079338504601607
epoch 42 training time: 15.190
---------------
2023-09-11 23:34:24.431335
current #epochs=43, #steps=1680
Epoch: [43][20/40]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00568	Train Loss 0.0156	
start validation
acc: 0.843602
AUC: 0.931296
Avg Precision: 0.347673
Avg Recall: 1.000000
d_prime: 2.100830
train_loss: 0.018107
valid_loss: 0.997364
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.000730935836209472
Epoch-43 lr: 0.000730935836209472
epoch 43 training time: 15.042
---------------
2023-09-11 23:34:39.473049
current #epochs=44, #steps=1720
start validation
[I 2023-09-11 23:34:54,546] Trial 99 finished with value: 0.8720379146919431 and parameters: {'warmup': 'False', 'num_epochs': 44, 'batch_size': 30, 'lr-adaptschedule': 'True', 'lr': 0.0013330871793377776, 'head-lr': 1, 'lr-scheduler-start': 3, 'lr-scheduler-step': 8, 'lr-scheduler-decay': 0.9046976256696829}. Best is trial 75 with value: 0.8862559241706162.
acc: 0.834123
AUC: 0.927685
Avg Precision: 0.343921
Avg Recall: 1.000000
d_prime: 2.063005
train_loss: 0.013611
valid_loss: 1.000655
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.000730935836209472
Epoch-44 lr: 0.000730935836209472
epoch 44 training time: 15.058
Best hyperparameters: {'warmup': 'False', 'num_epochs': 42, 'batch_size': 51, 'lr-adaptschedule': 'True', 'lr': 0.0028995169012271268, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.8628960276989172}
