/usr/local/lib/python3.8/dist-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
[I 2023-09-12 06:51:43,505] A new study created in memory with name: no-name-13911528-e4d6-460f-9019-8bb469894944
I am process 3679003, running on amorgenstern-titanx8-25nlt: starting (Tue Sep 12 06:51:38 2023)
balanced sampler is not used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process ours
use dataset mean -0.023 and std 0.413 to normalize the input.
number of classes is 4
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process ours
use dataset mean -0.023 and std 0.413 to normalize the input.
number of classes is 4
Now train with ours with 420 training samples, evaluate with 44 samples
now load a SSL pretrained models from SSAST-Base-Patch-400.pth
pretraining patch split stride: frequency=16, time=16
pretraining patch shape: frequency=16, time=16
pretraining patch array dimension: frequency=8, time=64
pretraining number of patches=512
fine-tuning patch split stride: frequncey=16, time=16
fine-tuning number of patches=256

Creating experiment directory: hyperparameter_search_balanced_data
Now starting fine-tuning for 50 epochs
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f953c187880>
The learning rate scheduler starts at 8 epoch with decay rate of 0.612 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 06:51:43.587690
current #epochs=1, #steps=0
[1694501518.478227] [amorgenstern-titanx8-25nlt:3679003:f]        vfs_fuse.c:281  UCX  ERROR inotify_add_watch(/tmp) failed: No space left on device
start validation
acc: 0.250000
AUC: 0.576102
Avg Precision: 0.289152
Avg Recall: 1.000000
d_prime: 0.271432
train_loss: 2.450635
valid_loss: 1.398703
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.000973189487702161
Epoch-1 lr: 0.000973189487702161
epoch 1 training time: 23.066
---------------
2023-09-12 06:52:06.654233
current #epochs=2, #steps=8
start validation
acc: 0.250000
AUC: 0.603994
Avg Precision: 0.265895
Avg Recall: 1.000000
d_prime: 0.372928
train_loss: 1.483968
valid_loss: 1.393788
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.000973189487702161
Epoch-2 lr: 0.000973189487702161
epoch 2 training time: 7.965
---------------
2023-09-12 06:52:14.619269
current #epochs=3, #steps=16
start validation
acc: 0.250000
AUC: 0.601240
Avg Precision: 0.264801
Avg Recall: 1.000000
d_prime: 0.362827
train_loss: 1.486309
valid_loss: 1.388133
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.000973189487702161
Epoch-3 lr: 0.000973189487702161
epoch 3 training time: 6.172
---------------
2023-09-12 06:52:20.791160
current #epochs=4, #steps=24
start validation
acc: 0.250000
AUC: 0.605028
Avg Precision: 0.266254
Avg Recall: 1.000000
d_prime: 0.376721
train_loss: 1.426055
valid_loss: 1.386494
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.000973189487702161
Epoch-4 lr: 0.000973189487702161
epoch 4 training time: 6.278
---------------
2023-09-12 06:52:27.069001
current #epochs=5, #steps=32
start validation
acc: 0.250000
AUC: 0.609160
Avg Precision: 0.266254
Avg Recall: 1.000000
d_prime: 0.391921
train_loss: 1.408358
valid_loss: 1.387077
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.000973189487702161
Epoch-5 lr: 0.000973189487702161
epoch 5 training time: 6.843
---------------
2023-09-12 06:52:33.912030
current #epochs=6, #steps=40
start validation
acc: 0.250000
AUC: 0.611570
Avg Precision: 0.267707
Avg Recall: 1.000000
d_prime: 0.400808
train_loss: 1.401358
valid_loss: 1.386761
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.000973189487702161
Epoch-6 lr: 0.000973189487702161
epoch 6 training time: 6.165
---------------
2023-09-12 06:52:40.076726
current #epochs=7, #steps=48
start validation
acc: 0.250000
AUC: 0.621901
Avg Precision: 0.286159
Avg Recall: 1.000000
d_prime: 0.439081
train_loss: 1.398435
valid_loss: 1.386295
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.000973189487702161
Epoch-7 lr: 0.000973189487702161
epoch 7 training time: 6.099
---------------
2023-09-12 06:52:46.176192
current #epochs=8, #steps=56
start validation
acc: 0.250000
AUC: 0.633264
Avg Precision: 0.286602
Avg Recall: 1.000000
d_prime: 0.481557
train_loss: 1.406042
valid_loss: 1.386708
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0005952939428997523
Epoch-8 lr: 0.0005952939428997523
epoch 8 training time: 6.177
---------------
2023-09-12 06:52:52.353482
current #epochs=9, #steps=64
start validation
acc: 0.272727
AUC: 0.643251
Avg Precision: 0.288558
Avg Recall: 1.000000
d_prime: 0.519245
train_loss: 1.405349
valid_loss: 1.386768
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0005952939428997523
Epoch-9 lr: 0.0005952939428997523
epoch 9 training time: 8.688
---------------
2023-09-12 06:53:01.041389
current #epochs=10, #steps=72
start validation
acc: 0.250000
AUC: 0.646006
Avg Precision: 0.283310
Avg Recall: 1.000000
d_prime: 0.529705
train_loss: 1.399541
valid_loss: 1.387377
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0005952939428997523
Epoch-10 lr: 0.0005952939428997523
epoch 10 training time: 6.191
---------------
2023-09-12 06:53:07.232354
current #epochs=11, #steps=80
start validation
acc: 0.250000
AUC: 0.651171
Avg Precision: 0.295304
Avg Recall: 1.000000
d_prime: 0.549398
train_loss: 1.401713
valid_loss: 1.386827
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0005952939428997523
Epoch-11 lr: 0.0005952939428997523
epoch 11 training time: 7.285
---------------
2023-09-12 06:53:14.516877
current #epochs=12, #steps=88
start validation
acc: 0.250000
AUC: 0.646006
Avg Precision: 0.295304
Avg Recall: 1.000000
d_prime: 0.529705
train_loss: 1.393943
valid_loss: 1.386181
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0005952939428997523
Epoch-12 lr: 0.0005952939428997523
epoch 12 training time: 6.142
---------------
2023-09-12 06:53:20.659084
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01158	Per Sample Data Time 0.00584	Per Sample DNN Time 0.00574	Train Loss 1.3898	
start validation
acc: 0.250000
AUC: 0.647383
Avg Precision: 0.301422
Avg Recall: 1.000000
d_prime: 0.534947
train_loss: 1.396429
valid_loss: 1.386385
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0003641375938922883
Epoch-13 lr: 0.0003641375938922883
epoch 13 training time: 6.226
---------------
2023-09-12 06:53:26.884495
current #epochs=14, #steps=104
start validation
acc: 0.250000
AUC: 0.649449
Avg Precision: 0.308446
Avg Recall: 1.000000
d_prime: 0.542822
train_loss: 1.393151
valid_loss: 1.386234
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0003641375938922883
Epoch-14 lr: 0.0003641375938922883
epoch 14 training time: 6.127
---------------
2023-09-12 06:53:33.011937
current #epochs=15, #steps=112
start validation
acc: 0.250000
AUC: 0.651515
Avg Precision: 0.303151
Avg Recall: 1.000000
d_prime: 0.550715
train_loss: 1.389400
valid_loss: 1.386413
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0003641375938922883
Epoch-15 lr: 0.0003641375938922883
epoch 15 training time: 6.315
---------------
2023-09-12 06:53:39.327110
current #epochs=16, #steps=120
start validation
acc: 0.250000
AUC: 0.654614
Avg Precision: 0.308446
Avg Recall: 1.000000
d_prime: 0.562586
train_loss: 1.389447
valid_loss: 1.386178
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0003641375938922883
Epoch-16 lr: 0.0003641375938922883
epoch 16 training time: 9.694
---------------
2023-09-12 06:53:49.020918
current #epochs=17, #steps=128
start validation
acc: 0.250000
AUC: 0.654270
Avg Precision: 0.308745
Avg Recall: 1.000000
d_prime: 0.561265
train_loss: 1.389033
valid_loss: 1.386276
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0003641375938922883
Epoch-17 lr: 0.0003641375938922883
epoch 17 training time: 7.160
---------------
2023-09-12 06:53:56.181963
current #epochs=18, #steps=136
start validation
acc: 0.250000
AUC: 0.658402
Avg Precision: 0.310209
Avg Recall: 1.000000
d_prime: 0.577150
train_loss: 1.389591
valid_loss: 1.386132
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00022274069620089234
Epoch-18 lr: 0.00022274069620089234
epoch 18 training time: 6.237
---------------
2023-09-12 06:54:02.418875
current #epochs=19, #steps=144
start validation
acc: 0.250000
AUC: 0.659091
Avg Precision: 0.312065
Avg Recall: 1.000000
d_prime: 0.579804
train_loss: 1.393853
valid_loss: 1.386138
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00022274069620089234
Epoch-19 lr: 0.00022274069620089234
epoch 19 training time: 6.295
---------------
2023-09-12 06:54:08.713578
current #epochs=20, #steps=152
start validation
acc: 0.250000
AUC: 0.662534
Avg Precision: 0.314021
Avg Recall: 1.000000
d_prime: 0.593107
train_loss: 1.386814
valid_loss: 1.386089
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00022274069620089234
Epoch-20 lr: 0.00022274069620089234
epoch 20 training time: 6.083
---------------
2023-09-12 06:54:14.796203
current #epochs=21, #steps=160
start validation
acc: 0.250000
AUC: 0.663912
Avg Precision: 0.315982
Avg Recall: 1.000000
d_prime: 0.598443
train_loss: 1.386768
valid_loss: 1.386168
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00022274069620089234
Epoch-21 lr: 0.00022274069620089234
epoch 21 training time: 6.073
---------------
2023-09-12 06:54:20.868741
current #epochs=22, #steps=168
start validation
acc: 0.250000
AUC: 0.667355
Avg Precision: 0.318357
Avg Recall: 1.000000
d_prime: 0.611820
train_loss: 1.391197
valid_loss: 1.386161
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00022274069620089234
Epoch-22 lr: 0.00022274069620089234
epoch 22 training time: 6.072
---------------
2023-09-12 06:54:26.940593
current #epochs=23, #steps=176
start validation
acc: 0.250000
AUC: 0.663912
Avg Precision: 0.316083
Avg Recall: 1.000000
d_prime: 0.598443
train_loss: 1.392775
valid_loss: 1.386178
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.000136249095331623
Epoch-23 lr: 0.000136249095331623
epoch 23 training time: 6.186
---------------
2023-09-12 06:54:33.126423
current #epochs=24, #steps=184
start validation
acc: 0.250000
AUC: 0.668733
Avg Precision: 0.322641
Avg Recall: 1.000000
d_prime: 0.617186
train_loss: 1.390688
valid_loss: 1.386232
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.000136249095331623
Epoch-24 lr: 0.000136249095331623
epoch 24 training time: 8.546
---------------
2023-09-12 06:54:41.672032
current #epochs=25, #steps=192
start validation
acc: 0.250000
AUC: 0.665289
Avg Precision: 0.318357
Avg Recall: 1.000000
d_prime: 0.603787
train_loss: 1.390178
valid_loss: 1.386146
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.000136249095331623
Epoch-25 lr: 0.000136249095331623
epoch 25 training time: 6.275
---------------
2023-09-12 06:54:47.947274
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03550	Per Sample Data Time 0.02999	Per Sample DNN Time 0.00551	Train Loss 1.3852	
start validation
acc: 0.250000
AUC: 0.669421
Avg Precision: 0.303185
Avg Recall: 1.000000
d_prime: 0.619873
train_loss: 1.387838
valid_loss: 1.386001
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.000136249095331623
Epoch-26 lr: 0.000136249095331623
epoch 26 training time: 6.204
---------------
2023-09-12 06:54:54.151683
current #epochs=27, #steps=208
start validation
acc: 0.250000
AUC: 0.665978
Avg Precision: 0.303378
Avg Recall: 1.000000
d_prime: 0.606463
train_loss: 1.390283
valid_loss: 1.386010
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.000136249095331623
Epoch-27 lr: 0.000136249095331623
epoch 27 training time: 6.391
---------------
2023-09-12 06:55:00.542131
current #epochs=28, #steps=216
start validation
acc: 0.250000
AUC: 0.661846
Avg Precision: 0.310402
Avg Recall: 1.000000
d_prime: 0.590442
train_loss: 1.385389
valid_loss: 1.385957
validation finished
normal learning rate scheduler step
Epoch-28 lr: 8.334272225647882e-05
Epoch-28 lr: 8.334272225647882e-05
epoch 28 training time: 6.123
---------------
2023-09-12 06:55:06.664779
current #epochs=29, #steps=224
start validation
[I 2023-09-12 06:55:14,156] Trial 0 finished with value: 0.2727272727272727 and parameters: {'warmup': 'False', 'num_epochs': 29, 'batch_size': 18, 'lr-adaptschedule': 'False', 'lr': 0.000973189487702161, 'head-lr': 1, 'lr-scheduler-start': 8, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.6116937661393427}. Best is trial 0 with value: 0.2727272727272727.
acc: 0.250000
AUC: 0.663912
Avg Precision: 0.314320
Avg Recall: 1.000000
d_prime: 0.598443
train_loss: 1.386528
valid_loss: 1.385973
validation finished
normal learning rate scheduler step
Epoch-29 lr: 8.334272225647882e-05
Epoch-29 lr: 8.334272225647882e-05
epoch 29 training time: 7.487
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8e36460>
The learning rate scheduler starts at 8 epoch with decay rate of 0.739 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 06:55:14.162547
current #epochs=1, #steps=0
start validation
acc: 0.250000
AUC: 0.450413
Avg Precision: 0.287538
Avg Recall: 1.000000
d_prime: -0.176236
train_loss: 3.091722
valid_loss: 1.387168
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002030960742856134
Epoch-1 lr: 0.01015480371428067
epoch 1 training time: 8.884
---------------
2023-09-12 06:55:23.047257
current #epochs=2, #steps=8
start validation
acc: 0.250000
AUC: 0.624656
Avg Precision: 0.271190
Avg Recall: 1.000000
d_prime: 0.449340
train_loss: 1.484569
valid_loss: 1.391615
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002030960742856134
Epoch-2 lr: 0.01015480371428067
epoch 2 training time: 7.815
---------------
2023-09-12 06:55:30.861873
current #epochs=3, #steps=16
start validation
acc: 0.250000
AUC: 0.636364
Avg Precision: 0.273146
Avg Recall: 1.000000
d_prime: 0.493215
train_loss: 1.627272
valid_loss: 1.389078
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002030960742856134
Epoch-3 lr: 0.01015480371428067
epoch 3 training time: 6.812
---------------
2023-09-12 06:55:37.674418
current #epochs=4, #steps=24
start validation
acc: 0.250000
AUC: 0.659780
Avg Precision: 0.312032
Avg Recall: 1.000000
d_prime: 0.582460
train_loss: 1.614776
valid_loss: 1.388951
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002030960742856134
Epoch-4 lr: 0.01015480371428067
epoch 4 training time: 6.412
---------------
2023-09-12 06:55:44.086034
current #epochs=5, #steps=32
start validation
acc: 0.250000
AUC: 0.634986
Avg Precision: 0.298223
Avg Recall: 1.000000
d_prime: 0.488029
train_loss: 1.520178
valid_loss: 1.391084
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002030960742856134
Epoch-5 lr: 0.01015480371428067
epoch 5 training time: 6.475
---------------
2023-09-12 06:55:50.561193
current #epochs=6, #steps=40
start validation
acc: 0.250000
AUC: 0.637052
Avg Precision: 0.293465
Avg Recall: 1.000000
d_prime: 0.495810
train_loss: 1.457555
valid_loss: 1.386537
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002030960742856134
Epoch-6 lr: 0.01015480371428067
epoch 6 training time: 6.239
---------------
2023-09-12 06:55:56.800098
current #epochs=7, #steps=48
start validation
acc: 0.250000
AUC: 0.621212
Avg Precision: 0.283551
Avg Recall: 1.000000
d_prime: 0.436519
train_loss: 1.476064
valid_loss: 1.385838
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002030960742856134
Epoch-7 lr: 0.01015480371428067
epoch 7 training time: 7.283
---------------
2023-09-12 06:56:04.083215
current #epochs=8, #steps=56
start validation
acc: 0.250000
AUC: 0.577824
Avg Precision: 0.281368
Avg Recall: 1.000000
d_prime: 0.277651
train_loss: 1.457234
valid_loss: 1.388217
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001501838926610166
Epoch-8 lr: 0.00750919463305083
epoch 8 training time: 6.301
---------------
2023-09-12 06:56:10.384613
current #epochs=9, #steps=64
start validation
acc: 0.250000
AUC: 0.564050
Avg Precision: 0.276942
Avg Recall: 1.000000
d_prime: 0.228034
train_loss: 1.450261
valid_loss: 1.387978
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001501838926610166
Epoch-9 lr: 0.00750919463305083
epoch 9 training time: 6.218
---------------
2023-09-12 06:56:16.602359
current #epochs=10, #steps=72
start validation
acc: 0.250000
AUC: 0.559229
Avg Precision: 0.271646
Avg Recall: 1.000000
d_prime: 0.210737
train_loss: 1.474734
valid_loss: 1.387675
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0011105680744521158
Epoch-10 lr: 0.005552840372260579
epoch 10 training time: 6.317
---------------
2023-09-12 06:56:22.919402
current #epochs=11, #steps=80
start validation
acc: 0.272727
AUC: 0.570248
Avg Precision: 0.273409
Avg Recall: 1.000000
d_prime: 0.250323
train_loss: 1.439343
valid_loss: 1.388355
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0011105680744521158
Epoch-11 lr: 0.005552840372260579
epoch 11 training time: 8.769
---------------
2023-09-12 06:56:31.688562
current #epochs=12, #steps=88
start validation
acc: 0.250000
AUC: 0.566804
Avg Precision: 0.273409
Avg Recall: 1.000000
d_prime: 0.237933
train_loss: 1.432976
valid_loss: 1.387245
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0008212341724129683
Epoch-12 lr: 0.0041061708620648415
epoch 12 training time: 6.307
---------------
2023-09-12 06:56:37.995545
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01189	Per Sample Data Time 0.00611	Per Sample DNN Time 0.00578	Train Loss 1.4489	
start validation
acc: 0.250000
AUC: 0.576446
Avg Precision: 0.273409
Avg Recall: 1.000000
d_prime: 0.272675
train_loss: 1.438638
valid_loss: 1.385000
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0008212341724129683
Epoch-13 lr: 0.0041061708620648415
epoch 13 training time: 6.400
---------------
2023-09-12 06:56:44.395752
current #epochs=14, #steps=104
start validation
acc: 0.295455
AUC: 0.580579
Avg Precision: 0.275086
Avg Recall: 1.000000
d_prime: 0.287614
train_loss: 1.387809
valid_loss: 1.384819
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0006072798070226645
Epoch-14 lr: 0.0030363990351133224
epoch 14 training time: 9.597
---------------
2023-09-12 06:56:53.992969
current #epochs=15, #steps=112
start validation
acc: 0.272727
AUC: 0.577824
Avg Precision: 0.275265
Avg Recall: 1.000000
d_prime: 0.277651
train_loss: 1.384069
valid_loss: 1.383123
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0006072798070226645
Epoch-15 lr: 0.0030363990351133224
epoch 15 training time: 6.231
---------------
2023-09-12 06:57:00.223372
current #epochs=16, #steps=120
start validation
acc: 0.340909
AUC: 0.573691
Avg Precision: 0.277028
Avg Recall: 1.000000
d_prime: 0.262733
train_loss: 1.358298
valid_loss: 1.381736
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.00044906651038874985
Epoch-16 lr: 0.002245332551943749
epoch 16 training time: 8.565
---------------
2023-09-12 06:57:08.788472
current #epochs=17, #steps=128
start validation
acc: 0.409091
AUC: 0.588154
Avg Precision: 0.293600
Avg Recall: 1.000000
d_prime: 0.315086
train_loss: 1.344754
valid_loss: 1.378664
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.00044906651038874985
Epoch-17 lr: 0.002245332551943749
epoch 17 training time: 8.653
---------------
2023-09-12 06:57:17.442027
current #epochs=18, #steps=136
start validation
acc: 0.272727
AUC: 0.613636
Avg Precision: 0.300966
Avg Recall: 1.000000
d_prime: 0.408438
train_loss: 1.316740
valid_loss: 1.373496
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00033207218224728973
Epoch-18 lr: 0.0016603609112364483
epoch 18 training time: 6.271
---------------
2023-09-12 06:57:23.712649
current #epochs=19, #steps=144
start validation
acc: 0.250000
AUC: 0.621901
Avg Precision: 0.305642
Avg Recall: 1.000000
d_prime: 0.439081
train_loss: 1.295028
valid_loss: 1.367961
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00033207218224728973
Epoch-19 lr: 0.0016603609112364483
epoch 19 training time: 6.273
---------------
2023-09-12 06:57:29.985148
current #epochs=20, #steps=152
start validation
acc: 0.340909
AUC: 0.635675
Avg Precision: 0.319134
Avg Recall: 1.000000
d_prime: 0.490621
train_loss: 1.290223
valid_loss: 1.363945
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0002455581337539878
Epoch-20 lr: 0.0012277906687699388
epoch 20 training time: 6.138
---------------
2023-09-12 06:57:36.123149
current #epochs=21, #steps=160
start validation
acc: 0.363636
AUC: 0.660468
Avg Precision: 0.319134
Avg Recall: 1.000000
d_prime: 0.585119
train_loss: 1.316392
valid_loss: 1.364645
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0002455581337539878
Epoch-21 lr: 0.0012277906687699388
epoch 21 training time: 6.134
---------------
2023-09-12 06:57:42.257070
current #epochs=22, #steps=168
start validation
acc: 0.386364
AUC: 0.676309
Avg Precision: 0.322573
Avg Recall: 1.000000
d_prime: 0.646863
train_loss: 1.258713
valid_loss: 1.355960
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00018158340347773443
Epoch-22 lr: 0.0009079170173886719
epoch 22 training time: 6.363
---------------
2023-09-12 06:57:48.620420
current #epochs=23, #steps=176
start validation
acc: 0.363636
AUC: 0.679752
Avg Precision: 0.317424
Avg Recall: 1.000000
d_prime: 0.660446
train_loss: 1.233397
valid_loss: 1.347434
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00018158340347773443
Epoch-23 lr: 0.0009079170173886719
epoch 23 training time: 6.142
---------------
2023-09-12 06:57:54.762399
current #epochs=24, #steps=184
start validation
acc: 0.318182
AUC: 0.688017
Avg Precision: 0.337179
Avg Recall: 1.000000
d_prime: 0.693298
train_loss: 1.210713
valid_loss: 1.338926
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00013427587151965896
Epoch-24 lr: 0.0006713793575982947
epoch 24 training time: 6.947
---------------
2023-09-12 06:58:01.709622
current #epochs=25, #steps=192
start validation
acc: 0.386364
AUC: 0.690083
Avg Precision: 0.335200
Avg Recall: 1.000000
d_prime: 0.701570
train_loss: 1.194060
valid_loss: 1.335282
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00013427587151965896
Epoch-25 lr: 0.0006713793575982947
epoch 25 training time: 6.972
---------------
2023-09-12 06:58:08.681640
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03629	Per Sample Data Time 0.03036	Per Sample DNN Time 0.00593	Train Loss 1.2451	
start validation
acc: 0.386364
AUC: 0.696281
Avg Precision: 0.335200
Avg Recall: 1.000000
d_prime: 0.726530
train_loss: 1.187274
valid_loss: 1.326021
validation finished
normal learning rate scheduler step
Epoch-26 lr: 9.929326869663383e-05
Epoch-26 lr: 0.0004964663434831691
epoch 26 training time: 6.234
---------------
2023-09-12 06:58:14.916087
current #epochs=27, #steps=208
start validation
acc: 0.409091
AUC: 0.696970
Avg Precision: 0.339784
Avg Recall: 1.000000
d_prime: 0.729317
train_loss: 1.164783
valid_loss: 1.323067
validation finished
normal learning rate scheduler step
Epoch-27 lr: 9.929326869663383e-05
Epoch-27 lr: 0.0004964663434831691
epoch 27 training time: 6.204
---------------
2023-09-12 06:58:21.120547
current #epochs=28, #steps=216
start validation
acc: 0.363636
AUC: 0.702479
Avg Precision: 0.336215
Avg Recall: 1.000000
d_prime: 0.751718
train_loss: 1.163410
valid_loss: 1.320519
validation finished
normal learning rate scheduler step
Epoch-28 lr: 7.342460783818836e-05
Epoch-28 lr: 0.00036712303919094174
epoch 28 training time: 7.098
---------------
2023-09-12 06:58:28.218212
current #epochs=29, #steps=224
start validation
acc: 0.454545
AUC: 0.712121
Avg Precision: 0.327571
Avg Recall: 1.000000
d_prime: 0.791383
train_loss: 1.168432
valid_loss: 1.315848
validation finished
normal learning rate scheduler step
Epoch-29 lr: 7.342460783818836e-05
Epoch-29 lr: 0.00036712303919094174
epoch 29 training time: 8.856
---------------
2023-09-12 06:58:37.074710
current #epochs=30, #steps=232
start validation
acc: 0.409091
AUC: 0.706612
Avg Precision: 0.318591
Avg Recall: 1.000000
d_prime: 0.768643
train_loss: 1.173682
valid_loss: 1.317635
validation finished
normal learning rate scheduler step
Epoch-30 lr: 5.429545332688317e-05
Epoch-30 lr: 0.0002714772666344158
epoch 30 training time: 6.099
---------------
2023-09-12 06:58:43.174373
current #epochs=31, #steps=240
start validation
acc: 0.363636
AUC: 0.702479
Avg Precision: 0.316736
Avg Recall: 1.000000
d_prime: 0.751718
train_loss: 1.150610
valid_loss: 1.319636
validation finished
normal learning rate scheduler step
Epoch-31 lr: 5.429545332688317e-05
Epoch-31 lr: 0.0002714772666344158
epoch 31 training time: 6.254
---------------
2023-09-12 06:58:49.427793
current #epochs=32, #steps=248
start validation
acc: 0.386364
AUC: 0.703168
Avg Precision: 0.307824
Avg Recall: 1.000000
d_prime: 0.754531
train_loss: 1.170477
valid_loss: 1.318797
validation finished
normal learning rate scheduler step
Epoch-32 lr: 4.0149976128827024e-05
Epoch-32 lr: 0.00020074988064413507
epoch 32 training time: 6.830
---------------
2023-09-12 06:58:56.258058
current #epochs=33, #steps=256
start validation
acc: 0.431818
AUC: 0.713499
Avg Precision: 0.329597
Avg Recall: 1.000000
d_prime: 0.797100
train_loss: 1.153961
valid_loss: 1.316063
validation finished
normal learning rate scheduler step
Epoch-33 lr: 4.0149976128827024e-05
Epoch-33 lr: 0.00020074988064413507
epoch 33 training time: 7.089
---------------
2023-09-12 06:59:03.347588
current #epochs=34, #steps=264
start validation
acc: 0.409091
AUC: 0.716253
Avg Precision: 0.331489
Avg Recall: 1.000000
d_prime: 0.808573
train_loss: 1.130332
valid_loss: 1.313058
validation finished
normal learning rate scheduler step
Epoch-34 lr: 2.9689789556416216e-05
Epoch-34 lr: 0.00014844894778208103
epoch 34 training time: 6.270
---------------
2023-09-12 06:59:09.617477
current #epochs=35, #steps=272
start validation
acc: 0.477273
AUC: 0.718320
Avg Precision: 0.329533
Avg Recall: 1.000000
d_prime: 0.817213
train_loss: 1.148974
valid_loss: 1.310323
validation finished
normal learning rate scheduler step
Epoch-35 lr: 2.9689789556416216e-05
Epoch-35 lr: 0.00014844894778208103
epoch 35 training time: 8.978
---------------
2023-09-12 06:59:18.595972
current #epochs=36, #steps=280
start validation
acc: 0.386364
AUC: 0.716942
Avg Precision: 0.333764
Avg Recall: 1.000000
d_prime: 0.811450
train_loss: 1.144584
valid_loss: 1.314438
validation finished
normal learning rate scheduler step
Epoch-36 lr: 2.1954772801754932e-05
Epoch-36 lr: 0.00010977386400877464
epoch 36 training time: 7.108
---------------
2023-09-12 06:59:25.704292
current #epochs=37, #steps=288
start validation
acc: 0.477273
AUC: 0.717631
Avg Precision: 0.336491
Avg Recall: 1.000000
d_prime: 0.814329
train_loss: 1.139545
valid_loss: 1.311344
validation finished
normal learning rate scheduler step
Epoch-37 lr: 2.1954772801754932e-05
Epoch-37 lr: 0.00010977386400877464
epoch 37 training time: 6.340
---------------
2023-09-12 06:59:32.044264
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01139	Per Sample Data Time 0.00592	Per Sample DNN Time 0.00547	Train Loss 1.1662	
start validation
acc: 0.409091
AUC: 0.710744
Avg Precision: 0.336491
Avg Recall: 1.000000
d_prime: 0.785679
train_loss: 1.140215
valid_loss: 1.311791
validation finished
normal learning rate scheduler step
Epoch-38 lr: 1.623494325753856e-05
Epoch-38 lr: 8.117471628769277e-05
epoch 38 training time: 7.165
---------------
2023-09-12 06:59:39.209204
current #epochs=39, #steps=304
start validation
acc: 0.431818
AUC: 0.709366
Avg Precision: 0.336491
Avg Recall: 1.000000
d_prime: 0.779988
train_loss: 1.108666
valid_loss: 1.311522
validation finished
normal learning rate scheduler step
Epoch-39 lr: 1.623494325753856e-05
Epoch-39 lr: 8.117471628769277e-05
epoch 39 training time: 6.405
---------------
2023-09-12 06:59:45.613976
current #epochs=40, #steps=312
start validation
acc: 0.409091
AUC: 0.707300
Avg Precision: 0.336491
Avg Recall: 1.000000
d_prime: 0.771475
train_loss: 1.122465
valid_loss: 1.310721
validation finished
normal learning rate scheduler step
Epoch-40 lr: 1.2005288551855486e-05
Epoch-40 lr: 6.002644275927741e-05
epoch 40 training time: 6.138
---------------
2023-09-12 06:59:51.751799
current #epochs=41, #steps=320
start validation
acc: 0.363636
AUC: 0.708678
Avg Precision: 0.334180
Avg Recall: 1.000000
d_prime: 0.777147
train_loss: 1.135732
valid_loss: 1.311243
validation finished
normal learning rate scheduler step
Epoch-41 lr: 1.2005288551855486e-05
Epoch-41 lr: 6.002644275927741e-05
epoch 41 training time: 6.269
---------------
2023-09-12 06:59:58.020120
current #epochs=42, #steps=328
start validation
acc: 0.363636
AUC: 0.707300
Avg Precision: 0.336491
Avg Recall: 1.000000
d_prime: 0.771475
train_loss: 1.139676
valid_loss: 1.310817
validation finished
normal learning rate scheduler step
Epoch-42 lr: 8.87757665222441e-06
Epoch-42 lr: 4.438788326112203e-05
epoch 42 training time: 6.311
---------------
2023-09-12 07:00:04.331342
current #epochs=43, #steps=336
start validation
acc: 0.409091
AUC: 0.703168
Avg Precision: 0.325914
Avg Recall: 1.000000
d_prime: 0.754531
train_loss: 1.112216
valid_loss: 1.310736
validation finished
normal learning rate scheduler step
Epoch-43 lr: 8.87757665222441e-06
Epoch-43 lr: 4.438788326112203e-05
epoch 43 training time: 6.186
---------------
2023-09-12 07:00:10.517270
current #epochs=44, #steps=344
start validation
acc: 0.431818
AUC: 0.705234
Avg Precision: 0.325914
Avg Recall: 1.000000
d_prime: 0.762989
train_loss: 1.128476
valid_loss: 1.310344
validation finished
normal learning rate scheduler step
Epoch-44 lr: 6.564720779155217e-06
Epoch-44 lr: 3.282360389577607e-05
epoch 44 training time: 6.200
---------------
2023-09-12 07:00:16.717268
current #epochs=45, #steps=352
start validation
acc: 0.409091
AUC: 0.704545
Avg Precision: 0.325914
Avg Recall: 1.000000
d_prime: 0.760167
train_loss: 1.116474
valid_loss: 1.309936
validation finished
normal learning rate scheduler step
Epoch-45 lr: 6.564720779155217e-06
Epoch-45 lr: 3.282360389577607e-05
epoch 45 training time: 6.228
---------------
2023-09-12 07:00:22.945571
current #epochs=46, #steps=360
start validation
acc: 0.363636
AUC: 0.707300
Avg Precision: 0.327677
Avg Recall: 1.000000
d_prime: 0.771475
train_loss: 1.134896
valid_loss: 1.309977
validation finished
normal learning rate scheduler step
Epoch-46 lr: 4.854428251821858e-06
Epoch-46 lr: 2.427214125910928e-05
epoch 46 training time: 6.360
---------------
2023-09-12 07:00:29.305682
current #epochs=47, #steps=368
start validation
acc: 0.363636
AUC: 0.706612
Avg Precision: 0.327677
Avg Recall: 1.000000
d_prime: 0.768643
train_loss: 1.095994
valid_loss: 1.309538
validation finished
normal learning rate scheduler step
Epoch-47 lr: 4.854428251821858e-06
Epoch-47 lr: 2.427214125910928e-05
epoch 47 training time: 6.589
---------------
2023-09-12 07:00:35.894345
current #epochs=48, #steps=376
start validation
[I 2023-09-12 07:00:42,175] Trial 1 finished with value: 0.4772727272727273 and parameters: {'warmup': 'True', 'num_epochs': 48, 'batch_size': 48, 'lr-adaptschedule': 'False', 'lr': 0.002030960742856134, 'head-lr': 5, 'lr-scheduler-start': 8, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.7394721596135504}. Best is trial 1 with value: 0.4772727272727273.
acc: 0.363636
AUC: 0.705923
Avg Precision: 0.327677
Avg Recall: 1.000000
d_prime: 0.765815
train_loss: 1.120340
valid_loss: 1.309153
validation finished
normal learning rate scheduler step
Epoch-48 lr: 3.5897145430637414e-06
Epoch-48 lr: 1.79485727153187e-05
epoch 48 training time: 6.277
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95372adc40>
The learning rate scheduler starts at 8 epoch with decay rate of 0.713 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 07:00:42.181551
current #epochs=1, #steps=0
start validation
acc: 0.250000
AUC: 0.539945
Avg Precision: 0.267239
Avg Recall: 1.000000
d_prime: 0.141838
train_loss: 1.673544
valid_loss: 1.388952
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.001985385932172841
Epoch-1 lr: 0.005956157796518523
epoch 1 training time: 8.894
---------------
2023-09-12 07:00:51.076104
current #epochs=2, #steps=8
start validation
acc: 0.250000
AUC: 0.599174
Avg Precision: 0.276734
Avg Recall: 1.000000
d_prime: 0.355263
train_loss: 1.484137
valid_loss: 1.390965
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.001985385932172841
Epoch-2 lr: 0.005956157796518523
epoch 2 training time: 6.345
---------------
2023-09-12 07:00:57.420574
current #epochs=3, #steps=16
start validation
acc: 0.295455
AUC: 0.590909
Avg Precision: 0.282645
Avg Recall: 1.000000
d_prime: 0.325105
train_loss: 1.454618
valid_loss: 1.384243
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.001985385932172841
Epoch-3 lr: 0.005956157796518523
epoch 3 training time: 9.581
---------------
2023-09-12 07:01:07.001585
current #epochs=4, #steps=24
start validation
acc: 0.363636
AUC: 0.610193
Avg Precision: 0.325275
Avg Recall: 1.000000
d_prime: 0.395728
train_loss: 1.366615
valid_loss: 1.367983
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.001985385932172841
Epoch-4 lr: 0.005956157796518523
epoch 4 training time: 8.809
---------------
2023-09-12 07:01:15.810633
current #epochs=5, #steps=32
start validation
acc: 0.272727
AUC: 0.603994
Avg Precision: 0.328216
Avg Recall: 1.000000
d_prime: 0.372928
train_loss: 1.359180
valid_loss: 1.376252
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.001985385932172841
Epoch-5 lr: 0.005956157796518523
epoch 5 training time: 6.181
---------------
2023-09-12 07:01:21.991381
current #epochs=6, #steps=40
start validation
acc: 0.386364
AUC: 0.626722
Avg Precision: 0.357517
Avg Recall: 1.000000
d_prime: 0.457050
train_loss: 1.330412
valid_loss: 1.361270
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.001985385932172841
Epoch-6 lr: 0.005956157796518523
epoch 6 training time: 8.907
---------------
2023-09-12 07:01:30.898449
current #epochs=7, #steps=48
start validation
acc: 0.386364
AUC: 0.581267
Avg Precision: 0.307549
Avg Recall: 1.000000
d_prime: 0.290107
train_loss: 1.262274
valid_loss: 1.357409
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.001985385932172841
Epoch-7 lr: 0.005956157796518523
epoch 7 training time: 6.367
---------------
2023-09-12 07:01:37.265406
current #epochs=8, #steps=56
start validation
acc: 0.250000
AUC: 0.549587
Avg Precision: 0.285913
Avg Recall: 1.000000
d_prime: 0.176236
train_loss: 1.300841
valid_loss: 1.371278
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0014151830283427574
Epoch-8 lr: 0.004245549085028272
epoch 8 training time: 6.263
---------------
2023-09-12 07:01:43.528623
current #epochs=9, #steps=64
start validation
acc: 0.363636
AUC: 0.592975
Avg Precision: 0.313593
Avg Recall: 1.000000
d_prime: 0.332630
train_loss: 1.279577
valid_loss: 1.357453
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0014151830283427574
Epoch-9 lr: 0.004245549085028272
epoch 9 training time: 6.176
---------------
2023-09-12 07:01:49.705033
current #epochs=10, #steps=72
start validation
acc: 0.363636
AUC: 0.626033
Avg Precision: 0.330773
Avg Recall: 1.000000
d_prime: 0.454479
train_loss: 1.263120
valid_loss: 1.350661
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0010087424169050803
Epoch-10 lr: 0.003026227250715241
epoch 10 training time: 6.114
---------------
2023-09-12 07:01:55.819201
current #epochs=11, #steps=80
start validation
acc: 0.340909
AUC: 0.617080
Avg Precision: 0.335981
Avg Recall: 1.000000
d_prime: 0.421182
train_loss: 1.278427
valid_loss: 1.355117
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0010087424169050803
Epoch-11 lr: 0.003026227250715241
epoch 11 training time: 6.263
---------------
2023-09-12 07:02:02.082150
current #epochs=12, #steps=88
start validation
acc: 0.340909
AUC: 0.601928
Avg Precision: 0.338038
Avg Recall: 1.000000
d_prime: 0.365350
train_loss: 1.252471
valid_loss: 1.354107
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.000719031562196667
Epoch-12 lr: 0.002157094686590001
epoch 12 training time: 6.296
---------------
2023-09-12 07:02:08.377978
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01195	Per Sample Data Time 0.00646	Per Sample DNN Time 0.00549	Train Loss 1.2563	
start validation
acc: 0.340909
AUC: 0.617080
Avg Precision: 0.310039
Avg Recall: 1.000000
d_prime: 0.421182
train_loss: 1.266352
valid_loss: 1.351658
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.000719031562196667
Epoch-13 lr: 0.002157094686590001
epoch 13 training time: 6.345
---------------
2023-09-12 07:02:14.723127
current #epochs=14, #steps=104
start validation
acc: 0.318182
AUC: 0.612259
Avg Precision: 0.295116
Avg Recall: 1.000000
d_prime: 0.403350
train_loss: 1.202921
valid_loss: 1.352828
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0005125256743155554
Epoch-14 lr: 0.001537577022946666
epoch 14 training time: 6.253
---------------
2023-09-12 07:02:20.976366
current #epochs=15, #steps=112
start validation
acc: 0.318182
AUC: 0.608815
Avg Precision: 0.281513
Avg Recall: 1.000000
d_prime: 0.390652
train_loss: 1.210277
valid_loss: 1.348357
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0005125256743155554
Epoch-15 lr: 0.001537577022946666
epoch 15 training time: 6.322
---------------
2023-09-12 07:02:27.298328
current #epochs=16, #steps=120
start validation
acc: 0.340909
AUC: 0.595730
Avg Precision: 0.273552
Avg Recall: 1.000000
d_prime: 0.342678
train_loss: 1.212999
valid_loss: 1.348213
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.00036532828410217516
Epoch-16 lr: 0.0010959848523065252
epoch 16 training time: 6.210
---------------
2023-09-12 07:02:33.508694
current #epochs=17, #steps=128
start validation
acc: 0.295455
AUC: 0.586777
Avg Precision: 0.269916
Avg Recall: 1.000000
d_prime: 0.310083
train_loss: 1.215534
valid_loss: 1.357573
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.00036532828410217516
Epoch-17 lr: 0.0010959848523065252
epoch 17 training time: 6.299
---------------
2023-09-12 07:02:39.808027
current #epochs=18, #steps=136
start validation
acc: 0.340909
AUC: 0.577135
Avg Precision: 0.269916
Avg Recall: 1.000000
d_prime: 0.275163
train_loss: 1.197320
valid_loss: 1.356074
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00026040598911122463
Epoch-18 lr: 0.0007812179673336737
epoch 18 training time: 6.313
---------------
2023-09-12 07:02:46.121194
current #epochs=19, #steps=144
start validation
acc: 0.363636
AUC: 0.577135
Avg Precision: 0.268319
Avg Recall: 1.000000
d_prime: 0.275163
train_loss: 1.236636
valid_loss: 1.354885
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00026040598911122463
Epoch-19 lr: 0.0007812179673336737
epoch 19 training time: 6.698
---------------
2023-09-12 07:02:52.819175
current #epochs=20, #steps=152
start validation
[I 2023-09-12 07:02:59,825] Trial 2 finished with value: 0.38636363636363635 and parameters: {'warmup': 'False', 'num_epochs': 20, 'batch_size': 19, 'lr-adaptschedule': 'False', 'lr': 0.001985385932172841, 'head-lr': 3, 'lr-scheduler-start': 8, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.7127999677090269}. Best is trial 1 with value: 0.4772727272727273.
acc: 0.340909
AUC: 0.577824
Avg Precision: 0.268319
Avg Recall: 1.000000
d_prime: 0.277651
train_loss: 1.213112
valid_loss: 1.355117
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00018561738062971813
Epoch-20 lr: 0.0005568521418891542
epoch 20 training time: 7.001
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f953c185190>
The learning rate scheduler starts at 9 epoch with decay rate of 0.906 every 6 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 07:02:59.830802
current #epochs=1, #steps=0
start validation
acc: 0.272727
AUC: 0.522727
Avg Precision: 0.279836
Avg Recall: 1.000000
d_prime: 0.080610
train_loss: 2.332447
valid_loss: 1.405866
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003977998423875725
Epoch-1 lr: 0.019889992119378627
epoch 1 training time: 9.193
---------------
2023-09-12 07:03:09.024692
current #epochs=2, #steps=8
start validation
acc: 0.250000
AUC: 0.603306
Avg Precision: 0.278983
Avg Recall: 1.000000
d_prime: 0.370401
train_loss: 1.598287
valid_loss: 1.389477
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003977998423875725
Epoch-2 lr: 0.019889992119378627
epoch 2 training time: 6.307
---------------
2023-09-12 07:03:15.331228
current #epochs=3, #steps=16
start validation
acc: 0.250000
AUC: 0.611570
Avg Precision: 0.309164
Avg Recall: 1.000000
d_prime: 0.400808
train_loss: 1.488510
valid_loss: 1.395113
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003977998423875725
Epoch-3 lr: 0.019889992119378627
epoch 3 training time: 6.437
---------------
2023-09-12 07:03:21.768286
current #epochs=4, #steps=24
start validation
acc: 0.250000
AUC: 0.617080
Avg Precision: 0.282795
Avg Recall: 1.000000
d_prime: 0.421182
train_loss: 1.509978
valid_loss: 1.386529
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003977998423875725
Epoch-4 lr: 0.019889992119378627
epoch 4 training time: 6.265
---------------
2023-09-12 07:03:28.033501
current #epochs=5, #steps=32
start validation
acc: 0.250000
AUC: 0.630165
Avg Precision: 0.269335
Avg Recall: 1.000000
d_prime: 0.469931
train_loss: 1.427290
valid_loss: 1.384569
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.003977998423875725
Epoch-5 lr: 0.019889992119378627
epoch 5 training time: 6.362
---------------
2023-09-12 07:03:34.394973
current #epochs=6, #steps=40
start validation
acc: 0.250000
AUC: 0.555785
Avg Precision: 0.321105
Avg Recall: 1.000000
d_prime: 0.198402
train_loss: 1.427351
valid_loss: 1.392227
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.003977998423875725
Epoch-6 lr: 0.019889992119378627
epoch 6 training time: 6.275
---------------
2023-09-12 07:03:40.670424
current #epochs=7, #steps=48
start validation
acc: 0.250000
AUC: 0.491736
Avg Precision: 0.261322
Avg Recall: 1.000000
d_prime: -0.029299
train_loss: 1.463274
valid_loss: 1.389541
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.003977998423875725
Epoch-7 lr: 0.019889992119378627
epoch 7 training time: 6.425
---------------
2023-09-12 07:03:47.095314
current #epochs=8, #steps=56
start validation
acc: 0.250000
AUC: 0.565427
Avg Precision: 0.278383
Avg Recall: 1.000000
d_prime: 0.232982
train_loss: 1.457848
valid_loss: 1.396432
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.003977998423875725
Epoch-8 lr: 0.019889992119378627
epoch 8 training time: 6.308
---------------
2023-09-12 07:03:53.403102
current #epochs=9, #steps=64
start validation
acc: 0.272727
AUC: 0.526860
Avg Precision: 0.269837
Avg Recall: 1.000000
d_prime: 0.095287
train_loss: 1.454253
valid_loss: 1.397116
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.003606038292883143
Epoch-9 lr: 0.018030191464415715
epoch 9 training time: 6.257
---------------
2023-09-12 07:03:59.660396
current #epochs=10, #steps=72
start validation
acc: 0.250000
AUC: 0.586777
Avg Precision: 0.304614
Avg Recall: 1.000000
d_prime: 0.310083
train_loss: 1.479453
valid_loss: 1.389543
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.003606038292883143
Epoch-10 lr: 0.018030191464415715
epoch 10 training time: 6.216
---------------
2023-09-12 07:04:05.876303
current #epochs=11, #steps=80
start validation
acc: 0.250000
AUC: 0.567493
Avg Precision: 0.271991
Avg Recall: 1.000000
d_prime: 0.240410
train_loss: 1.436863
valid_loss: 1.387837
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.003606038292883143
Epoch-11 lr: 0.018030191464415715
epoch 11 training time: 6.287
---------------
2023-09-12 07:04:12.162910
current #epochs=12, #steps=88
start validation
acc: 0.250000
AUC: 0.506198
Avg Precision: 0.280370
Avg Recall: 1.000000
d_prime: 0.021973
train_loss: 1.393579
valid_loss: 1.388325
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.003606038292883143
Epoch-12 lr: 0.018030191464415715
epoch 12 training time: 6.287
---------------
2023-09-12 07:04:18.450233
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01166	Per Sample Data Time 0.00593	Per Sample DNN Time 0.00572	Train Loss 1.4185	
start validation
acc: 0.250000
AUC: 0.537190
Avg Precision: 0.277928
Avg Recall: 1.000000
d_prime: 0.132027
train_loss: 1.434402
valid_loss: 1.386432
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.003606038292883143
Epoch-13 lr: 0.018030191464415715
epoch 13 training time: 6.224
---------------
2023-09-12 07:04:24.674243
current #epochs=14, #steps=104
start validation
acc: 0.250000
AUC: 0.602617
Avg Precision: 0.290669
Avg Recall: 1.000000
d_prime: 0.367875
train_loss: 1.393641
valid_loss: 1.386540
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.003606038292883143
Epoch-14 lr: 0.018030191464415715
epoch 14 training time: 6.554
---------------
2023-09-12 07:04:31.228512
current #epochs=15, #steps=112
start validation
acc: 0.272727
AUC: 0.635675
Avg Precision: 0.305765
Avg Recall: 1.000000
d_prime: 0.490621
train_loss: 1.388256
valid_loss: 1.386174
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.003268858049740094
Epoch-15 lr: 0.01634429024870047
epoch 15 training time: 6.477
---------------
2023-09-12 07:04:37.705248
current #epochs=16, #steps=120
start validation
acc: 0.250000
AUC: 0.634298
Avg Precision: 0.323895
Avg Recall: 1.000000
d_prime: 0.485439
train_loss: 1.389711
valid_loss: 1.386523
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.003268858049740094
Epoch-16 lr: 0.01634429024870047
epoch 16 training time: 7.890
---------------
2023-09-12 07:04:45.595777
current #epochs=17, #steps=128
start validation
acc: 0.250000
AUC: 0.682507
Avg Precision: 0.329364
Avg Recall: 1.000000
d_prime: 0.671356
train_loss: 1.390248
valid_loss: 1.386302
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.003268858049740094
Epoch-17 lr: 0.01634429024870047
epoch 17 training time: 6.295
---------------
2023-09-12 07:04:51.891113
current #epochs=18, #steps=136
start validation
acc: 0.250000
AUC: 0.621901
Avg Precision: 0.283690
Avg Recall: 1.000000
d_prime: 0.439081
train_loss: 1.391515
valid_loss: 1.386503
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.003268858049740094
Epoch-18 lr: 0.01634429024870047
epoch 18 training time: 6.275
---------------
2023-09-12 07:04:58.165927
current #epochs=19, #steps=144
start validation
acc: 0.250000
AUC: 0.683540
Avg Precision: 0.301609
Avg Recall: 1.000000
d_prime: 0.675458
train_loss: 1.400995
valid_loss: 1.386616
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.003268858049740094
Epoch-19 lr: 0.01634429024870047
epoch 19 training time: 6.627
---------------
2023-09-12 07:05:04.793239
current #epochs=20, #steps=152
start validation
acc: 0.250000
AUC: 0.696281
Avg Precision: 0.323766
Avg Recall: 1.000000
d_prime: 0.726530
train_loss: 1.414099
valid_loss: 1.387228
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.003268858049740094
Epoch-20 lr: 0.01634429024870047
epoch 20 training time: 6.407
---------------
2023-09-12 07:05:11.199990
current #epochs=21, #steps=160
start validation
acc: 0.250000
AUC: 0.714187
Avg Precision: 0.297917
Avg Recall: 1.000000
d_prime: 0.799963
train_loss: 1.418108
valid_loss: 1.387828
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0029632056238668683
Epoch-21 lr: 0.014816028119334343
epoch 21 training time: 6.325
---------------
2023-09-12 07:05:17.524666
current #epochs=22, #steps=168
start validation
acc: 0.250000
AUC: 0.721763
Avg Precision: 0.304828
Avg Recall: 1.000000
d_prime: 0.831681
train_loss: 1.399461
valid_loss: 1.387471
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0029632056238668683
Epoch-22 lr: 0.014816028119334343
epoch 22 training time: 6.456
---------------
2023-09-12 07:05:23.980614
current #epochs=23, #steps=176
start validation
acc: 0.272727
AUC: 0.695937
Avg Precision: 0.303949
Avg Recall: 1.000000
d_prime: 0.725137
train_loss: 1.397418
valid_loss: 1.386191
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0029632056238668683
Epoch-23 lr: 0.014816028119334343
epoch 23 training time: 6.626
---------------
2023-09-12 07:05:30.607442
current #epochs=24, #steps=184
start validation
acc: 0.250000
AUC: 0.668733
Avg Precision: 0.319598
Avg Recall: 1.000000
d_prime: 0.617186
train_loss: 1.390892
valid_loss: 1.386807
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0029632056238668683
Epoch-24 lr: 0.014816028119334343
epoch 24 training time: 6.123
---------------
2023-09-12 07:05:36.730513
current #epochs=25, #steps=192
start validation
[I 2023-09-12 07:05:45,480] Trial 3 finished with value: 0.3409090909090909 and parameters: {'warmup': 'True', 'num_epochs': 25, 'batch_size': 25, 'lr-adaptschedule': 'True', 'lr': 0.003977998423875725, 'head-lr': 5, 'lr-scheduler-start': 9, 'lr-scheduler-step': 6, 'lr-scheduler-decay': 0.906495656519093}. Best is trial 1 with value: 0.4772727272727273.
acc: 0.340909
AUC: 0.645661
Avg Precision: 0.273822
Avg Recall: 1.000000
d_prime: 0.528396
train_loss: 1.391697
valid_loss: 1.386135
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0029632056238668683
Epoch-25 lr: 0.014816028119334343
epoch 25 training time: 8.746
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95372adbe0>
The learning rate scheduler starts at 3 epoch with decay rate of 0.811 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 07:05:45.486368
current #epochs=1, #steps=0
start validation
acc: 0.250000
AUC: 0.609504
Avg Precision: 0.317400
Avg Recall: 1.000000
d_prime: 0.393189
train_loss: 1.441501
valid_loss: 1.386462
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0025706103663804846
Epoch-1 lr: 0.010282441465521939
epoch 1 training time: 8.951
---------------
2023-09-12 07:05:54.437905
current #epochs=2, #steps=8
start validation
acc: 0.250000
AUC: 0.488636
Avg Precision: 0.279390
Avg Recall: 1.000000
d_prime: -0.040288
train_loss: 1.412724
valid_loss: 1.388977
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0025706103663804846
Epoch-2 lr: 0.010282441465521939
epoch 2 training time: 6.372
---------------
2023-09-12 07:06:00.810034
current #epochs=3, #steps=16
start validation
acc: 0.250000
AUC: 0.488981
Avg Precision: 0.269841
Avg Recall: 1.000000
d_prime: -0.039067
train_loss: 1.429813
valid_loss: 1.387945
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0020839007078460566
Epoch-3 lr: 0.008335602831384226
epoch 3 training time: 6.103
---------------
2023-09-12 07:06:06.912560
current #epochs=4, #steps=24
start validation
acc: 0.250000
AUC: 0.380165
Avg Precision: 0.259226
Avg Recall: 1.000000
d_prime: -0.431401
train_loss: 1.400983
valid_loss: 1.386583
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0020839007078460566
Epoch-4 lr: 0.008335602831384226
epoch 4 training time: 6.111
---------------
2023-09-12 07:06:13.023833
current #epochs=5, #steps=32
start validation
acc: 0.250000
AUC: 0.410124
Avg Precision: 0.263278
Avg Recall: 1.000000
d_prime: -0.321346
train_loss: 1.400014
valid_loss: 1.386532
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0020839007078460566
Epoch-5 lr: 0.008335602831384226
epoch 5 training time: 6.852
---------------
2023-09-12 07:06:19.875803
current #epochs=6, #steps=40
start validation
acc: 0.250000
AUC: 0.600551
Avg Precision: 0.293206
Avg Recall: 1.000000
d_prime: 0.360304
train_loss: 1.389127
valid_loss: 1.386348
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0020839007078460566
Epoch-6 lr: 0.008335602831384226
epoch 6 training time: 6.226
---------------
2023-09-12 07:06:26.101250
current #epochs=7, #steps=48
start validation
acc: 0.250000
AUC: 0.599862
Avg Precision: 0.266850
Avg Recall: 1.000000
d_prime: 0.357783
train_loss: 1.405454
valid_loss: 1.386611
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0016893428179377873
Epoch-7 lr: 0.006757371271751149
epoch 7 training time: 8.592
---------------
2023-09-12 07:06:34.692894
current #epochs=8, #steps=56
start validation
acc: 0.250000
AUC: 0.597796
Avg Precision: 0.268538
Avg Recall: 1.000000
d_prime: 0.350225
train_loss: 1.388517
valid_loss: 1.386432
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0016893428179377873
Epoch-8 lr: 0.006757371271751149
epoch 8 training time: 7.733
---------------
2023-09-12 07:06:42.426053
current #epochs=9, #steps=64
start validation
acc: 0.250000
AUC: 0.613292
Avg Precision: 0.275252
Avg Recall: 1.000000
d_prime: 0.407166
train_loss: 1.390662
valid_loss: 1.386416
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0016893428179377873
Epoch-9 lr: 0.006757371271751149
epoch 9 training time: 6.301
---------------
2023-09-12 07:06:48.727148
current #epochs=10, #steps=72
start validation
acc: 0.250000
AUC: 0.632231
Avg Precision: 0.285855
Avg Recall: 1.000000
d_prime: 0.477678
train_loss: 1.389988
valid_loss: 1.386421
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0016893428179377873
Epoch-10 lr: 0.006757371271751149
epoch 10 training time: 6.184
---------------
2023-09-12 07:06:54.911625
current #epochs=11, #steps=80
start validation
acc: 0.250000
AUC: 0.638430
Avg Precision: 0.296325
Avg Recall: 1.000000
d_prime: 0.501006
train_loss: 1.388791
valid_loss: 1.386292
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0013694890288068406
Epoch-11 lr: 0.005477956115227362
epoch 11 training time: 6.860
---------------
2023-09-12 07:07:01.771911
current #epochs=12, #steps=88
start validation
acc: 0.250000
AUC: 0.659780
Avg Precision: 0.306572
Avg Recall: 1.000000
d_prime: 0.582460
train_loss: 1.387330
valid_loss: 1.386466
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0013694890288068406
Epoch-12 lr: 0.005477956115227362
epoch 12 training time: 7.061
---------------
2023-09-12 07:07:08.832632
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01142	Per Sample Data Time 0.00585	Per Sample DNN Time 0.00557	Train Loss 1.3919	
start validation
acc: 0.250000
AUC: 0.646006
Avg Precision: 0.305788
Avg Recall: 1.000000
d_prime: 0.529705
train_loss: 1.393110
valid_loss: 1.386293
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0013694890288068406
Epoch-13 lr: 0.005477956115227362
epoch 13 training time: 6.103
---------------
2023-09-12 07:07:14.935795
current #epochs=14, #steps=104
start validation
acc: 0.250000
AUC: 0.653581
Avg Precision: 0.307153
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.385242
valid_loss: 1.386194
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0013694890288068406
Epoch-14 lr: 0.005477956115227362
epoch 14 training time: 7.104
---------------
2023-09-12 07:07:22.039406
current #epochs=15, #steps=112
start validation
acc: 0.250000
AUC: 0.581267
Avg Precision: 0.273552
Avg Recall: 1.000000
d_prime: 0.290107
train_loss: 1.390440
valid_loss: 1.385790
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.001110195148141549
Epoch-15 lr: 0.004440780592566196
epoch 15 training time: 6.260
---------------
2023-09-12 07:07:28.299286
current #epochs=16, #steps=120
start validation
acc: 0.363636
AUC: 0.608127
Avg Precision: 0.288169
Avg Recall: 1.000000
d_prime: 0.388117
train_loss: 1.383094
valid_loss: 1.383271
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.001110195148141549
Epoch-16 lr: 0.004440780592566196
epoch 16 training time: 9.884
---------------
2023-09-12 07:07:38.183169
current #epochs=17, #steps=128
start validation
acc: 0.340909
AUC: 0.543388
Avg Precision: 0.282236
Avg Recall: 1.000000
d_prime: 0.154112
train_loss: 1.359117
valid_loss: 1.373976
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.001110195148141549
Epoch-17 lr: 0.004440780592566196
epoch 17 training time: 6.372
---------------
2023-09-12 07:07:44.555365
current #epochs=18, #steps=136
start validation
acc: 0.272727
AUC: 0.635675
Avg Precision: 0.308307
Avg Recall: 1.000000
d_prime: 0.490621
train_loss: 1.253058
valid_loss: 1.359088
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001110195148141549
Epoch-18 lr: 0.004440780592566196
epoch 18 training time: 6.354
---------------
2023-09-12 07:07:50.909422
current #epochs=19, #steps=144
start validation
acc: 0.250000
AUC: 0.503444
Avg Precision: 0.269916
Avg Recall: 1.000000
d_prime: 0.012207
train_loss: 1.413629
valid_loss: 1.383835
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0008999949915851997
Epoch-19 lr: 0.0035999799663407987
epoch 19 training time: 6.797
---------------
2023-09-12 07:07:57.705856
current #epochs=20, #steps=152
start validation
acc: 0.250000
AUC: 0.467631
Avg Precision: 0.272024
Avg Recall: 1.000000
d_prime: -0.114872
train_loss: 1.390153
valid_loss: 1.386750
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0008999949915851997
Epoch-20 lr: 0.0035999799663407987
epoch 20 training time: 6.484
---------------
2023-09-12 07:08:04.189931
current #epochs=21, #steps=160
start validation
acc: 0.250000
AUC: 0.526171
Avg Precision: 0.263278
Avg Recall: 1.000000
d_prime: 0.092840
train_loss: 1.396325
valid_loss: 1.386671
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0008999949915851997
Epoch-21 lr: 0.0035999799663407987
epoch 21 training time: 6.441
---------------
2023-09-12 07:08:10.631529
current #epochs=22, #steps=168
start validation
acc: 0.250000
AUC: 0.516873
Avg Precision: 0.267525
Avg Recall: 1.000000
d_prime: 0.059832
train_loss: 1.388886
valid_loss: 1.386441
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0008999949915851997
Epoch-22 lr: 0.0035999799663407987
epoch 22 training time: 6.052
---------------
2023-09-12 07:08:16.683268
current #epochs=23, #steps=176
start validation
acc: 0.250000
AUC: 0.529614
Avg Precision: 0.268462
Avg Recall: 1.000000
d_prime: 0.105077
train_loss: 1.394034
valid_loss: 1.386520
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0007295933388236809
Epoch-23 lr: 0.0029183733552947235
epoch 23 training time: 6.260
---------------
2023-09-12 07:08:22.943329
current #epochs=24, #steps=184
start validation
acc: 0.318182
AUC: 0.588499
Avg Precision: 0.277393
Avg Recall: 1.000000
d_prime: 0.316338
train_loss: 1.385793
valid_loss: 1.385906
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0007295933388236809
Epoch-24 lr: 0.0029183733552947235
epoch 24 training time: 6.501
---------------
2023-09-12 07:08:29.443763
current #epochs=25, #steps=192
start validation
acc: 0.295455
AUC: 0.632231
Avg Precision: 0.305550
Avg Recall: 1.000000
d_prime: 0.477678
train_loss: 1.383045
valid_loss: 1.385659
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0007295933388236809
Epoch-25 lr: 0.0029183733552947235
epoch 25 training time: 6.262
---------------
2023-09-12 07:08:35.705977
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03504	Per Sample Data Time 0.02949	Per Sample DNN Time 0.00556	Train Loss 1.3736	
start validation
acc: 0.250000
AUC: 0.656336
Avg Precision: 0.319056
Avg Recall: 1.000000
d_prime: 0.569198
train_loss: 1.383569
valid_loss: 1.385002
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0007295933388236809
Epoch-26 lr: 0.0029183733552947235
epoch 26 training time: 6.263
---------------
2023-09-12 07:08:41.969378
current #epochs=27, #steps=208
start validation
acc: 0.318182
AUC: 0.663912
Avg Precision: 0.353232
Avg Recall: 1.000000
d_prime: 0.598443
train_loss: 1.376480
valid_loss: 1.383932
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0005914548914525761
Epoch-27 lr: 0.0023658195658103043
epoch 27 training time: 6.182
---------------
2023-09-12 07:08:48.151861
current #epochs=28, #steps=216
start validation
[I 2023-09-12 07:08:54,545] Trial 4 finished with value: 0.36363636363636365 and parameters: {'warmup': 'True', 'num_epochs': 28, 'batch_size': 19, 'lr-adaptschedule': 'False', 'lr': 0.0025706103663804846, 'head-lr': 4, 'lr-scheduler-start': 3, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.8106637766268198}. Best is trial 1 with value: 0.4772727272727273.
acc: 0.295455
AUC: 0.664601
Avg Precision: 0.354688
Avg Recall: 1.000000
d_prime: 0.601114
train_loss: 1.366877
valid_loss: 1.382016
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0005914548914525761
Epoch-28 lr: 0.0023658195658103043
epoch 28 training time: 6.390
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8e3d160>
The learning rate scheduler starts at 9 epoch with decay rate of 0.791 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 07:08:54.551360
current #epochs=1, #steps=0
start validation
acc: 0.250000
AUC: 0.477961
Avg Precision: 0.264298
Avg Recall: 1.000000
d_prime: -0.078164
train_loss: 1.542342
valid_loss: 1.389722
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003262524746515559
Epoch-1 lr: 0.013050098986062237
epoch 1 training time: 8.744
---------------
2023-09-12 07:09:03.295777
current #epochs=2, #steps=8
start validation
acc: 0.250000
AUC: 0.544766
Avg Precision: 0.285621
Avg Recall: 1.000000
d_prime: 0.159025
train_loss: 1.441800
valid_loss: 1.388143
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003262524746515559
Epoch-2 lr: 0.013050098986062237
epoch 2 training time: 6.201
---------------
2023-09-12 07:09:09.496995
current #epochs=3, #steps=16
start validation
acc: 0.250000
AUC: 0.618802
Avg Precision: 0.262775
Avg Recall: 1.000000
d_prime: 0.427566
train_loss: 1.465990
valid_loss: 1.386606
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003262524746515559
Epoch-3 lr: 0.013050098986062237
epoch 3 training time: 7.456
---------------
2023-09-12 07:09:16.952800
current #epochs=4, #steps=24
start validation
acc: 0.204545
AUC: 0.659780
Avg Precision: 0.330026
Avg Recall: 1.000000
d_prime: 0.582460
train_loss: 1.443864
valid_loss: 1.390253
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003262524746515559
Epoch-4 lr: 0.013050098986062237
epoch 4 training time: 6.225
---------------
2023-09-12 07:09:23.177590
current #epochs=5, #steps=32
start validation
acc: 0.250000
AUC: 0.592975
Avg Precision: 0.298343
Avg Recall: 1.000000
d_prime: 0.332630
train_loss: 1.442219
valid_loss: 1.386887
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.003262524746515559
Epoch-5 lr: 0.013050098986062237
epoch 5 training time: 6.392
---------------
2023-09-12 07:09:29.569299
current #epochs=6, #steps=40
start validation
acc: 0.250000
AUC: 0.612259
Avg Precision: 0.282336
Avg Recall: 1.000000
d_prime: 0.403350
train_loss: 1.418452
valid_loss: 1.386450
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.003262524746515559
Epoch-6 lr: 0.013050098986062237
epoch 6 training time: 6.166
---------------
2023-09-12 07:09:35.735375
current #epochs=7, #steps=48
start validation
acc: 0.250000
AUC: 0.625344
Avg Precision: 0.338292
Avg Recall: 1.000000
d_prime: 0.451909
train_loss: 1.413615
valid_loss: 1.388009
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.003262524746515559
Epoch-7 lr: 0.013050098986062237
epoch 7 training time: 6.264
---------------
2023-09-12 07:09:41.999393
current #epochs=8, #steps=56
start validation
acc: 0.250000
AUC: 0.640152
Avg Precision: 0.365420
Avg Recall: 1.000000
d_prime: 0.507510
train_loss: 1.389245
valid_loss: 1.386393
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.003262524746515559
Epoch-8 lr: 0.013050098986062237
epoch 8 training time: 6.268
---------------
2023-09-12 07:09:48.266885
current #epochs=9, #steps=64
start validation
acc: 0.250000
AUC: 0.649449
Avg Precision: 0.343561
Avg Recall: 1.000000
d_prime: 0.542822
train_loss: 1.399892
valid_loss: 1.386837
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0025805349668370954
Epoch-9 lr: 0.010322139867348382
epoch 9 training time: 6.282
---------------
2023-09-12 07:09:54.548874
current #epochs=10, #steps=72
start validation
acc: 0.250000
AUC: 0.651515
Avg Precision: 0.350867
Avg Recall: 1.000000
d_prime: 0.550715
train_loss: 1.390200
valid_loss: 1.386391
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0025805349668370954
Epoch-10 lr: 0.010322139867348382
epoch 10 training time: 6.218
---------------
2023-09-12 07:10:00.767334
current #epochs=11, #steps=80
start validation
acc: 0.250000
AUC: 0.567493
Avg Precision: 0.318736
Avg Recall: 1.000000
d_prime: 0.240410
train_loss: 1.388411
valid_loss: 1.386587
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0025805349668370954
Epoch-11 lr: 0.010322139867348382
epoch 11 training time: 6.504
---------------
2023-09-12 07:10:07.271443
current #epochs=12, #steps=88
start validation
acc: 0.250000
AUC: 0.561295
Avg Precision: 0.302930
Avg Recall: 1.000000
d_prime: 0.218146
train_loss: 1.392664
valid_loss: 1.386452
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0025805349668370954
Epoch-12 lr: 0.010322139867348382
epoch 12 training time: 6.302
---------------
2023-09-12 07:10:13.573006
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01105	Per Sample Data Time 0.00561	Per Sample DNN Time 0.00543	Train Loss 1.3841	
start validation
acc: 0.250000
AUC: 0.561983
Avg Precision: 0.301768
Avg Recall: 1.000000
d_prime: 0.220617
train_loss: 1.387064
valid_loss: 1.386285
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0025805349668370954
Epoch-13 lr: 0.010322139867348382
epoch 13 training time: 6.725
---------------
2023-09-12 07:10:20.297680
current #epochs=14, #steps=104
start validation
acc: 0.250000
AUC: 0.657713
Avg Precision: 0.326017
Avg Recall: 1.000000
d_prime: 0.574497
train_loss: 1.385543
valid_loss: 1.386333
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0025805349668370954
Epoch-14 lr: 0.010322139867348382
epoch 14 training time: 6.221
---------------
2023-09-12 07:10:26.518895
current #epochs=15, #steps=112
start validation
acc: 0.250000
AUC: 0.652893
Avg Precision: 0.289295
Avg Recall: 1.000000
d_prime: 0.555986
train_loss: 1.387243
valid_loss: 1.386356
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0025805349668370954
Epoch-15 lr: 0.010322139867348382
epoch 15 training time: 6.311
---------------
2023-09-12 07:10:32.830387
current #epochs=16, #steps=120
start validation
acc: 0.227273
AUC: 0.649449
Avg Precision: 0.314360
Avg Recall: 1.000000
d_prime: 0.542822
train_loss: 1.386927
valid_loss: 1.386329
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0025805349668370954
Epoch-16 lr: 0.010322139867348382
epoch 16 training time: 6.112
---------------
2023-09-12 07:10:38.942474
current #epochs=17, #steps=128
start validation
acc: 0.250000
AUC: 0.617080
Avg Precision: 0.260680
Avg Recall: 1.000000
d_prime: 0.421182
train_loss: 1.385131
valid_loss: 1.386412
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0025805349668370954
Epoch-17 lr: 0.010322139867348382
epoch 17 training time: 6.292
---------------
2023-09-12 07:10:45.234267
current #epochs=18, #steps=136
start validation
acc: 0.227273
AUC: 0.613636
Avg Precision: 0.259157
Avg Recall: 1.000000
d_prime: 0.408438
train_loss: 1.386382
valid_loss: 1.386445
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0025805349668370954
Epoch-18 lr: 0.010322139867348382
epoch 18 training time: 6.532
---------------
2023-09-12 07:10:51.766432
current #epochs=19, #steps=144
start validation
acc: 0.227273
AUC: 0.625344
Avg Precision: 0.273775
Avg Recall: 1.000000
d_prime: 0.451909
train_loss: 1.383444
valid_loss: 1.386378
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.002041106576181849
Epoch-19 lr: 0.008164426304727397
epoch 19 training time: 7.572
---------------
2023-09-12 07:10:59.338337
current #epochs=20, #steps=152
start validation
acc: 0.295455
AUC: 0.629477
Avg Precision: 0.285247
Avg Recall: 1.000000
d_prime: 0.467351
train_loss: 1.384573
valid_loss: 1.385781
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.002041106576181849
Epoch-20 lr: 0.008164426304727397
epoch 20 training time: 8.704
---------------
2023-09-12 07:11:08.041961
current #epochs=21, #steps=160
start validation
acc: 0.204545
AUC: 0.601240
Avg Precision: 0.272812
Avg Recall: 1.000000
d_prime: 0.362827
train_loss: 1.384867
valid_loss: 1.385455
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.002041106576181849
Epoch-21 lr: 0.008164426304727397
epoch 21 training time: 6.564
---------------
2023-09-12 07:11:14.606434
current #epochs=22, #steps=168
start validation
acc: 0.250000
AUC: 0.559229
Avg Precision: 0.266796
Avg Recall: 1.000000
d_prime: 0.210737
train_loss: 1.381900
valid_loss: 1.385679
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.002041106576181849
Epoch-22 lr: 0.008164426304727397
epoch 22 training time: 6.305
---------------
2023-09-12 07:11:20.911690
current #epochs=23, #steps=176
start validation
acc: 0.250000
AUC: 0.565427
Avg Precision: 0.266254
Avg Recall: 1.000000
d_prime: 0.232982
train_loss: 1.382963
valid_loss: 1.382671
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.002041106576181849
Epoch-23 lr: 0.008164426304727397
epoch 23 training time: 6.314
---------------
2023-09-12 07:11:27.225738
current #epochs=24, #steps=184
start validation
acc: 0.272727
AUC: 0.557163
Avg Precision: 0.266865
Avg Recall: 1.000000
d_prime: 0.203334
train_loss: 1.372916
valid_loss: 1.383980
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.002041106576181849
Epoch-24 lr: 0.008164426304727397
epoch 24 training time: 6.225
---------------
2023-09-12 07:11:33.451021
current #epochs=25, #steps=192
start validation
acc: 0.295455
AUC: 0.573691
Avg Precision: 0.266254
Avg Recall: 1.000000
d_prime: 0.262733
train_loss: 1.339631
valid_loss: 1.378649
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.002041106576181849
Epoch-25 lr: 0.008164426304727397
epoch 25 training time: 7.017
---------------
2023-09-12 07:11:40.467974
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03470	Per Sample Data Time 0.02865	Per Sample DNN Time 0.00605	Train Loss 1.3571	
start validation
acc: 0.340909
AUC: 0.562672
Avg Precision: 0.269836
Avg Recall: 1.000000
d_prime: 0.223089
train_loss: 1.280795
valid_loss: 1.344815
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.002041106576181849
Epoch-26 lr: 0.008164426304727397
epoch 26 training time: 10.915
---------------
2023-09-12 07:11:51.382829
current #epochs=27, #steps=208
start validation
acc: 0.272727
AUC: 0.536501
Avg Precision: 0.270501
Avg Recall: 1.000000
d_prime: 0.129575
train_loss: 1.280172
valid_loss: 1.362100
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.002041106576181849
Epoch-27 lr: 0.008164426304727397
epoch 27 training time: 6.378
---------------
2023-09-12 07:11:57.760796
current #epochs=28, #steps=216
start validation
acc: 0.295455
AUC: 0.535813
Avg Precision: 0.279784
Avg Recall: 1.000000
d_prime: 0.127124
train_loss: 1.270016
valid_loss: 1.383624
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.002041106576181849
Epoch-28 lr: 0.008164426304727397
epoch 28 training time: 6.460
---------------
2023-09-12 07:12:04.220705
current #epochs=29, #steps=224
start validation
acc: 0.272727
AUC: 0.533747
Avg Precision: 0.277928
Avg Recall: 1.000000
d_prime: 0.119771
train_loss: 1.320087
valid_loss: 1.375440
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.001614438908548915
Epoch-29 lr: 0.00645775563419566
epoch 29 training time: 6.132
---------------
2023-09-12 07:12:10.352534
current #epochs=30, #steps=232
start validation
acc: 0.295455
AUC: 0.605372
Avg Precision: 0.288767
Avg Recall: 1.000000
d_prime: 0.377986
train_loss: 1.321485
valid_loss: 1.376334
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.001614438908548915
Epoch-30 lr: 0.00645775563419566
epoch 30 training time: 7.142
---------------
2023-09-12 07:12:17.494621
current #epochs=31, #steps=240
start validation
acc: 0.295455
AUC: 0.596419
Avg Precision: 0.292805
Avg Recall: 1.000000
d_prime: 0.345193
train_loss: 1.303201
valid_loss: 1.371676
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.001614438908548915
Epoch-31 lr: 0.00645775563419566
epoch 31 training time: 6.378
---------------
2023-09-12 07:12:23.872890
current #epochs=32, #steps=248
start validation
acc: 0.295455
AUC: 0.533747
Avg Precision: 0.283489
Avg Recall: 1.000000
d_prime: 0.119771
train_loss: 1.270932
valid_loss: 1.364388
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.001614438908548915
Epoch-32 lr: 0.00645775563419566
epoch 32 training time: 6.235
---------------
2023-09-12 07:12:30.108345
current #epochs=33, #steps=256
start validation
acc: 0.363636
AUC: 0.543388
Avg Precision: 0.285445
Avg Recall: 1.000000
d_prime: 0.154112
train_loss: 1.250334
valid_loss: 1.353463
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.001614438908548915
Epoch-33 lr: 0.00645775563419566
epoch 33 training time: 8.817
---------------
2023-09-12 07:12:38.925794
current #epochs=34, #steps=264
start validation
acc: 0.340909
AUC: 0.563361
Avg Precision: 0.285327
Avg Recall: 1.000000
d_prime: 0.225561
train_loss: 1.234651
valid_loss: 1.341104
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.001614438908548915
Epoch-34 lr: 0.00645775563419566
epoch 34 training time: 6.619
---------------
2023-09-12 07:12:45.544801
current #epochs=35, #steps=272
start validation
acc: 0.340909
AUC: 0.563361
Avg Precision: 0.289928
Avg Recall: 1.000000
d_prime: 0.225561
train_loss: 1.209229
valid_loss: 1.339368
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.001614438908548915
Epoch-35 lr: 0.00645775563419566
epoch 35 training time: 8.346
---------------
2023-09-12 07:12:53.891253
current #epochs=36, #steps=280
start validation
acc: 0.409091
AUC: 0.591598
Avg Precision: 0.282645
Avg Recall: 1.000000
d_prime: 0.327613
train_loss: 1.202107
valid_loss: 1.329780
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.001614438908548915
Epoch-36 lr: 0.00645775563419566
epoch 36 training time: 9.015
---------------
2023-09-12 07:13:02.906028
current #epochs=37, #steps=288
start validation
acc: 0.386364
AUC: 0.608815
Avg Precision: 0.288238
Avg Recall: 1.000000
d_prime: 0.390652
train_loss: 1.192851
valid_loss: 1.325841
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.001614438908548915
Epoch-37 lr: 0.00645775563419566
epoch 37 training time: 6.795
---------------
2023-09-12 07:13:09.700891
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01149	Per Sample Data Time 0.00605	Per Sample DNN Time 0.00545	Train Loss 1.2005	
start validation
acc: 0.318182
AUC: 0.577135
Avg Precision: 0.291010
Avg Recall: 1.000000
d_prime: 0.275163
train_loss: 1.256897
valid_loss: 1.345147
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.001614438908548915
Epoch-38 lr: 0.00645775563419566
epoch 38 training time: 6.115
---------------
2023-09-12 07:13:15.816218
current #epochs=39, #steps=304
start validation
acc: 0.363636
AUC: 0.582645
Avg Precision: 0.285131
Avg Recall: 1.000000
d_prime: 0.295095
train_loss: 1.264319
valid_loss: 1.350234
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0012769607524915436
Epoch-39 lr: 0.0051078430099661745
epoch 39 training time: 6.284
---------------
2023-09-12 07:13:22.099952
current #epochs=40, #steps=312
start validation
acc: 0.318182
AUC: 0.613636
Avg Precision: 0.283759
Avg Recall: 1.000000
d_prime: 0.408438
train_loss: 1.251027
valid_loss: 1.355633
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0012769607524915436
Epoch-40 lr: 0.0051078430099661745
epoch 40 training time: 6.219
---------------
2023-09-12 07:13:28.318765
current #epochs=41, #steps=320
start validation
acc: 0.431818
AUC: 0.620523
Avg Precision: 0.282162
Avg Recall: 1.000000
d_prime: 0.433960
train_loss: 1.226461
valid_loss: 1.337897
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0012769607524915436
Epoch-41 lr: 0.0051078430099661745
epoch 41 training time: 8.684
---------------
2023-09-12 07:13:37.002518
current #epochs=42, #steps=328
start validation
acc: 0.363636
AUC: 0.616391
Avg Precision: 0.280639
Avg Recall: 1.000000
d_prime: 0.418630
train_loss: 1.192649
valid_loss: 1.324696
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0012769607524915436
Epoch-42 lr: 0.0051078430099661745
epoch 42 training time: 7.166
---------------
2023-09-12 07:13:44.168738
current #epochs=43, #steps=336
start validation
[I 2023-09-12 07:13:50,590] Trial 5 finished with value: 0.4318181818181818 and parameters: {'warmup': 'False', 'num_epochs': 43, 'batch_size': 42, 'lr-adaptschedule': 'False', 'lr': 0.003262524746515559, 'head-lr': 4, 'lr-scheduler-start': 9, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.7909625726496504}. Best is trial 1 with value: 0.4772727272727273.
acc: 0.386364
AUC: 0.617080
Avg Precision: 0.280639
Avg Recall: 1.000000
d_prime: 0.421182
train_loss: 1.228397
valid_loss: 1.322806
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0012769607524915436
Epoch-43 lr: 0.0051078430099661745
epoch 43 training time: 6.417
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95372bdf10>
The learning rate scheduler starts at 9 epoch with decay rate of 0.686 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 07:13:50.595797
current #epochs=1, #steps=0
start validation
acc: 0.318182
AUC: 0.612259
Avg Precision: 0.282162
Avg Recall: 1.000000
d_prime: 0.403350
train_loss: 1.281168
valid_loss: 1.338546
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.001229666783841333
Epoch-1 lr: 0.001229666783841333
epoch 1 training time: 8.758
---------------
2023-09-12 07:13:59.354127
current #epochs=2, #steps=8
start validation
acc: 0.431818
AUC: 0.629477
Avg Precision: 0.285436
Avg Recall: 1.000000
d_prime: 0.467351
train_loss: 1.184130
valid_loss: 1.339420
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.001229666783841333
Epoch-2 lr: 0.001229666783841333
epoch 2 training time: 9.855
---------------
2023-09-12 07:14:09.208958
current #epochs=3, #steps=16
start validation
acc: 0.295455
AUC: 0.628099
Avg Precision: 0.293608
Avg Recall: 1.000000
d_prime: 0.462198
train_loss: 1.212992
valid_loss: 1.331141
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.001229666783841333
Epoch-3 lr: 0.001229666783841333
epoch 3 training time: 6.475
---------------
2023-09-12 07:14:15.683779
current #epochs=4, #steps=24
start validation
acc: 0.318182
AUC: 0.635675
Avg Precision: 0.293608
Avg Recall: 1.000000
d_prime: 0.490621
train_loss: 1.202711
valid_loss: 1.330054
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.001229666783841333
Epoch-4 lr: 0.001229666783841333
epoch 4 training time: 6.247
---------------
2023-09-12 07:14:21.930828
current #epochs=5, #steps=32
start validation
acc: 0.431818
AUC: 0.632920
Avg Precision: 0.289054
Avg Recall: 1.000000
d_prime: 0.480263
train_loss: 1.199819
valid_loss: 1.330006
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.001229666783841333
Epoch-5 lr: 0.001229666783841333
epoch 5 training time: 6.804
---------------
2023-09-12 07:14:28.735325
current #epochs=6, #steps=40
start validation
acc: 0.318182
AUC: 0.633609
Avg Precision: 0.293465
Avg Recall: 1.000000
d_prime: 0.482850
train_loss: 1.161230
valid_loss: 1.323499
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.001229666783841333
Epoch-6 lr: 0.001229666783841333
epoch 6 training time: 6.497
---------------
2023-09-12 07:14:35.232162
current #epochs=7, #steps=48
start validation
acc: 0.340909
AUC: 0.637052
Avg Precision: 0.293782
Avg Recall: 1.000000
d_prime: 0.495810
train_loss: 1.185581
valid_loss: 1.318777
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.001229666783841333
Epoch-7 lr: 0.001229666783841333
epoch 7 training time: 6.909
---------------
2023-09-12 07:14:42.141076
current #epochs=8, #steps=56
start validation
acc: 0.386364
AUC: 0.640496
Avg Precision: 0.289154
Avg Recall: 1.000000
d_prime: 0.508812
train_loss: 1.180664
valid_loss: 1.313629
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001229666783841333
Epoch-8 lr: 0.001229666783841333
epoch 8 training time: 6.546
---------------
2023-09-12 07:14:48.687043
current #epochs=9, #steps=64
start validation
acc: 0.340909
AUC: 0.661157
Avg Precision: 0.304045
Avg Recall: 1.000000
d_prime: 0.587780
train_loss: 1.177870
valid_loss: 1.314734
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0008436106067577784
Epoch-9 lr: 0.0008436106067577784
epoch 9 training time: 8.089
---------------
2023-09-12 07:14:56.775800
current #epochs=10, #steps=72
start validation
[I 2023-09-12 07:15:04,814] Trial 6 finished with value: 0.4318181818181818 and parameters: {'warmup': 'False', 'num_epochs': 10, 'batch_size': 31, 'lr-adaptschedule': 'True', 'lr': 0.001229666783841333, 'head-lr': 1, 'lr-scheduler-start': 9, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.6860481374656955}. Best is trial 1 with value: 0.4772727272727273.
acc: 0.318182
AUC: 0.676309
Avg Precision: 0.363366
Avg Recall: 1.000000
d_prime: 0.646863
train_loss: 1.179446
valid_loss: 1.330415
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0008436106067577784
Epoch-10 lr: 0.0008436106067577784
epoch 10 training time: 8.034
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f953c187940>
The learning rate scheduler starts at 5 epoch with decay rate of 0.915 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 07:15:04.820017
current #epochs=1, #steps=0
start validation
acc: 0.272727
AUC: 0.663223
Avg Precision: 0.385450
Avg Recall: 1.000000
d_prime: 0.595774
train_loss: 1.238207
valid_loss: 1.348021
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0021444509390777054
Epoch-1 lr: 0.010722254695388527
epoch 1 training time: 9.536
---------------
2023-09-12 07:15:14.356218
current #epochs=2, #steps=8
start validation
acc: 0.318182
AUC: 0.650138
Avg Precision: 0.306027
Avg Recall: 1.000000
d_prime: 0.545451
train_loss: 1.282281
valid_loss: 1.340619
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0021444509390777054
Epoch-2 lr: 0.010722254695388527
epoch 2 training time: 9.316
---------------
2023-09-12 07:15:23.672566
current #epochs=3, #steps=16
start validation
acc: 0.409091
AUC: 0.651515
Avg Precision: 0.289877
Avg Recall: 1.000000
d_prime: 0.550715
train_loss: 1.243188
valid_loss: 1.326522
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0021444509390777054
Epoch-3 lr: 0.010722254695388527
epoch 3 training time: 10.033
---------------
2023-09-12 07:15:33.705480
current #epochs=4, #steps=24
start validation
acc: 0.295455
AUC: 0.643251
Avg Precision: 0.288486
Avg Recall: 1.000000
d_prime: 0.519245
train_loss: 1.226853
valid_loss: 1.346116
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0021444509390777054
Epoch-4 lr: 0.010722254695388527
epoch 4 training time: 6.108
---------------
2023-09-12 07:15:39.812813
current #epochs=5, #steps=32
start validation
acc: 0.409091
AUC: 0.652893
Avg Precision: 0.309188
Avg Recall: 1.000000
d_prime: 0.555986
train_loss: 1.238445
valid_loss: 1.349045
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0019622871374295726
Epoch-5 lr: 0.009811435687147861
epoch 5 training time: 6.099
---------------
2023-09-12 07:15:45.912274
current #epochs=6, #steps=40
start validation
acc: 0.295455
AUC: 0.661157
Avg Precision: 0.298701
Avg Recall: 1.000000
d_prime: 0.587780
train_loss: 1.244234
valid_loss: 1.342228
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0019622871374295726
Epoch-6 lr: 0.009811435687147861
epoch 6 training time: 7.023
---------------
2023-09-12 07:15:52.935136
current #epochs=7, #steps=48
start validation
acc: 0.386364
AUC: 0.655647
Avg Precision: 0.295062
Avg Recall: 1.000000
d_prime: 0.566552
train_loss: 1.197204
valid_loss: 1.323178
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0019622871374295726
Epoch-7 lr: 0.009811435687147861
epoch 7 training time: 7.968
---------------
2023-09-12 07:16:00.902679
current #epochs=8, #steps=56
start validation
acc: 0.340909
AUC: 0.608815
Avg Precision: 0.284427
Avg Recall: 1.000000
d_prime: 0.390652
train_loss: 1.213591
valid_loss: 1.334032
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0019622871374295726
Epoch-8 lr: 0.009811435687147861
epoch 8 training time: 6.306
---------------
2023-09-12 07:16:07.208995
current #epochs=9, #steps=64
start validation
acc: 0.340909
AUC: 0.606061
Avg Precision: 0.280987
Avg Recall: 1.000000
d_prime: 0.380517
train_loss: 1.218573
valid_loss: 1.333547
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0019622871374295726
Epoch-9 lr: 0.009811435687147861
epoch 9 training time: 7.109
---------------
2023-09-12 07:16:14.318002
current #epochs=10, #steps=72
start validation
acc: 0.340909
AUC: 0.594353
Avg Precision: 0.295724
Avg Recall: 1.000000
d_prime: 0.337652
train_loss: 1.222841
valid_loss: 1.348909
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0019622871374295726
Epoch-10 lr: 0.009811435687147861
epoch 10 training time: 6.330
---------------
2023-09-12 07:16:20.647922
current #epochs=11, #steps=80
start validation
acc: 0.340909
AUC: 0.597107
Avg Precision: 0.292416
Avg Recall: 1.000000
d_prime: 0.347709
train_loss: 1.195223
valid_loss: 1.343447
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0019622871374295726
Epoch-11 lr: 0.009811435687147861
epoch 11 training time: 6.222
---------------
2023-09-12 07:16:26.870426
current #epochs=12, #steps=88
start validation
acc: 0.363636
AUC: 0.612948
Avg Precision: 0.305511
Avg Recall: 1.000000
d_prime: 0.405893
train_loss: 1.189144
valid_loss: 1.335186
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0019622871374295726
Epoch-12 lr: 0.009811435687147861
epoch 12 training time: 6.346
---------------
2023-09-12 07:16:33.216021
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01116	Per Sample Data Time 0.00571	Per Sample DNN Time 0.00545	Train Loss 1.2065	
start validation
acc: 0.340909
AUC: 0.643939
Avg Precision: 0.297178
Avg Recall: 1.000000
d_prime: 0.521857
train_loss: 1.210731
valid_loss: 1.329040
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0019622871374295726
Epoch-13 lr: 0.009811435687147861
epoch 13 training time: 6.126
---------------
2023-09-12 07:16:39.342434
current #epochs=14, #steps=104
start validation
acc: 0.386364
AUC: 0.663223
Avg Precision: 0.283922
Avg Recall: 1.000000
d_prime: 0.595774
train_loss: 1.210702
valid_loss: 1.342894
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0019622871374295726
Epoch-14 lr: 0.009811435687147861
epoch 14 training time: 6.305
---------------
2023-09-12 07:16:45.647585
current #epochs=15, #steps=112
start validation
acc: 0.363636
AUC: 0.634986
Avg Precision: 0.294857
Avg Recall: 1.000000
d_prime: 0.488029
train_loss: 1.213851
valid_loss: 1.346346
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0017955975301433642
Epoch-15 lr: 0.00897798765071682
epoch 15 training time: 6.299
---------------
2023-09-12 07:16:51.946145
current #epochs=16, #steps=120
start validation
acc: 0.340909
AUC: 0.630854
Avg Precision: 0.294771
Avg Recall: 1.000000
d_prime: 0.472511
train_loss: 1.228209
valid_loss: 1.340147
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0017955975301433642
Epoch-16 lr: 0.00897798765071682
epoch 16 training time: 6.706
---------------
2023-09-12 07:16:58.652482
current #epochs=17, #steps=128
start validation
acc: 0.295455
AUC: 0.579890
Avg Precision: 0.292157
Avg Recall: 1.000000
d_prime: 0.285122
train_loss: 1.238321
valid_loss: 1.360593
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0017955975301433642
Epoch-17 lr: 0.00897798765071682
epoch 17 training time: 6.257
---------------
2023-09-12 07:17:04.909010
current #epochs=18, #steps=136
start validation
acc: 0.318182
AUC: 0.603306
Avg Precision: 0.293869
Avg Recall: 1.000000
d_prime: 0.370401
train_loss: 1.257121
valid_loss: 1.361971
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0017955975301433642
Epoch-18 lr: 0.00897798765071682
epoch 18 training time: 7.701
---------------
2023-09-12 07:17:12.610067
current #epochs=19, #steps=144
start validation
acc: 0.318182
AUC: 0.621212
Avg Precision: 0.305535
Avg Recall: 1.000000
d_prime: 0.436519
train_loss: 1.255935
valid_loss: 1.356102
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0017955975301433642
Epoch-19 lr: 0.00897798765071682
epoch 19 training time: 6.685
---------------
2023-09-12 07:17:19.295165
current #epochs=20, #steps=152
start validation
acc: 0.318182
AUC: 0.610882
Avg Precision: 0.297522
Avg Recall: 1.000000
d_prime: 0.398267
train_loss: 1.231932
valid_loss: 1.351135
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0017955975301433642
Epoch-20 lr: 0.00897798765071682
epoch 20 training time: 6.206
---------------
2023-09-12 07:17:25.501297
current #epochs=21, #steps=160
start validation
acc: 0.295455
AUC: 0.619146
Avg Precision: 0.313436
Avg Recall: 1.000000
d_prime: 0.428844
train_loss: 1.259973
valid_loss: 1.346756
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0017955975301433642
Epoch-21 lr: 0.00897798765071682
epoch 21 training time: 7.587
---------------
2023-09-12 07:17:33.088302
current #epochs=22, #steps=168
start validation
acc: 0.295455
AUC: 0.611570
Avg Precision: 0.328023
Avg Recall: 1.000000
d_prime: 0.400808
train_loss: 1.218967
valid_loss: 1.346347
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0017955975301433642
Epoch-22 lr: 0.00897798765071682
epoch 22 training time: 6.255
---------------
2023-09-12 07:17:39.343632
current #epochs=23, #steps=176
start validation
acc: 0.340909
AUC: 0.623967
Avg Precision: 0.334239
Avg Recall: 1.000000
d_prime: 0.446773
train_loss: 1.207112
valid_loss: 1.338341
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0017955975301433642
Epoch-23 lr: 0.00897798765071682
epoch 23 training time: 6.251
---------------
2023-09-12 07:17:45.594153
current #epochs=24, #steps=184
start validation
acc: 0.363636
AUC: 0.643939
Avg Precision: 0.334731
Avg Recall: 1.000000
d_prime: 0.521857
train_loss: 1.238295
valid_loss: 1.330491
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0017955975301433642
Epoch-24 lr: 0.00897798765071682
epoch 24 training time: 6.399
---------------
2023-09-12 07:17:51.993521
current #epochs=25, #steps=192
start validation
acc: 0.340909
AUC: 0.653581
Avg Precision: 0.342572
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.206043
valid_loss: 1.333763
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0016430676371248787
Epoch-25 lr: 0.008215338185624393
epoch 25 training time: 6.523
---------------
2023-09-12 07:17:58.516160
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03499	Per Sample Data Time 0.02901	Per Sample DNN Time 0.00598	Train Loss 1.1868	
start validation
acc: 0.340909
AUC: 0.661846
Avg Precision: 0.368056
Avg Recall: 1.000000
d_prime: 0.590442
train_loss: 1.175874
valid_loss: 1.316652
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0016430676371248787
Epoch-26 lr: 0.008215338185624393
epoch 26 training time: 6.263
---------------
2023-09-12 07:18:04.779518
current #epochs=27, #steps=208
start validation
acc: 0.409091
AUC: 0.677686
Avg Precision: 0.364400
Avg Recall: 1.000000
d_prime: 0.652289
train_loss: 1.171585
valid_loss: 1.304150
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0016430676371248787
Epoch-27 lr: 0.008215338185624393
epoch 27 training time: 6.308
---------------
2023-09-12 07:18:11.087498
current #epochs=28, #steps=216
start validation
acc: 0.340909
AUC: 0.664601
Avg Precision: 0.375553
Avg Recall: 1.000000
d_prime: 0.601114
train_loss: 1.156860
valid_loss: 1.315480
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0016430676371248787
Epoch-28 lr: 0.008215338185624393
epoch 28 training time: 6.418
---------------
2023-09-12 07:18:17.505619
current #epochs=29, #steps=224
start validation
acc: 0.386364
AUC: 0.662534
Avg Precision: 0.373904
Avg Recall: 1.000000
d_prime: 0.593107
train_loss: 1.203353
valid_loss: 1.314841
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0016430676371248787
Epoch-29 lr: 0.008215338185624393
epoch 29 training time: 7.142
---------------
2023-09-12 07:18:24.647745
current #epochs=30, #steps=232
start validation
acc: 0.363636
AUC: 0.712810
Avg Precision: 0.377943
Avg Recall: 1.000000
d_prime: 0.794240
train_loss: 1.169000
valid_loss: 1.308882
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0016430676371248787
Epoch-30 lr: 0.008215338185624393
epoch 30 training time: 6.114
---------------
2023-09-12 07:18:30.761810
current #epochs=31, #steps=240
start validation
acc: 0.386364
AUC: 0.685262
Avg Precision: 0.349324
Avg Recall: 1.000000
d_prime: 0.682307
train_loss: 1.172387
valid_loss: 1.316060
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0016430676371248787
Epoch-31 lr: 0.008215338185624393
epoch 31 training time: 6.829
---------------
2023-09-12 07:18:37.591074
current #epochs=32, #steps=248
start validation
acc: 0.363636
AUC: 0.690771
Avg Precision: 0.378453
Avg Recall: 1.000000
d_prime: 0.704332
train_loss: 1.207138
valid_loss: 1.315693
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0016430676371248787
Epoch-32 lr: 0.008215338185624393
epoch 32 training time: 6.278
---------------
2023-09-12 07:18:43.868567
current #epochs=33, #steps=256
start validation
acc: 0.363636
AUC: 0.672865
Avg Precision: 0.358632
Avg Recall: 1.000000
d_prime: 0.633339
train_loss: 1.186620
valid_loss: 1.317347
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0016430676371248787
Epoch-33 lr: 0.008215338185624393
epoch 33 training time: 6.384
---------------
2023-09-12 07:18:50.252551
current #epochs=34, #steps=264
start validation
acc: 0.363636
AUC: 0.616391
Avg Precision: 0.372220
Avg Recall: 1.000000
d_prime: 0.418630
train_loss: 1.186747
valid_loss: 1.323505
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0016430676371248787
Epoch-34 lr: 0.008215338185624393
epoch 34 training time: 6.266
---------------
2023-09-12 07:18:56.518759
current #epochs=35, #steps=272
start validation
acc: 0.409091
AUC: 0.608127
Avg Precision: 0.336584
Avg Recall: 1.000000
d_prime: 0.388117
train_loss: 1.183630
valid_loss: 1.322573
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0015034946388858001
Epoch-35 lr: 0.007517473194429001
epoch 35 training time: 6.207
---------------
2023-09-12 07:19:02.725742
current #epochs=36, #steps=280
start validation
acc: 0.318182
AUC: 0.623278
Avg Precision: 0.326346
Avg Recall: 1.000000
d_prime: 0.444207
train_loss: 1.200437
valid_loss: 1.331055
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0015034946388858001
Epoch-36 lr: 0.007517473194429001
epoch 36 training time: 6.194
---------------
2023-09-12 07:19:08.919403
current #epochs=37, #steps=288
start validation
acc: 0.409091
AUC: 0.618457
Avg Precision: 0.314990
Avg Recall: 1.000000
d_prime: 0.426289
train_loss: 1.200252
valid_loss: 1.326558
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0015034946388858001
Epoch-37 lr: 0.007517473194429001
epoch 37 training time: 6.223
---------------
2023-09-12 07:19:15.142863
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01173	Per Sample Data Time 0.00599	Per Sample DNN Time 0.00574	Train Loss 1.1373	
start validation
acc: 0.386364
AUC: 0.627410
Avg Precision: 0.293238
Avg Recall: 1.000000
d_prime: 0.459623
train_loss: 1.183327
valid_loss: 1.314946
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0015034946388858001
Epoch-38 lr: 0.007517473194429001
epoch 38 training time: 6.317
---------------
2023-09-12 07:19:21.460408
current #epochs=39, #steps=304
start validation
acc: 0.363636
AUC: 0.617080
Avg Precision: 0.306741
Avg Recall: 1.000000
d_prime: 0.421182
train_loss: 1.165249
valid_loss: 1.311490
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0015034946388858001
Epoch-39 lr: 0.007517473194429001
epoch 39 training time: 6.278
---------------
2023-09-12 07:19:27.738438
current #epochs=40, #steps=312
start validation
[I 2023-09-12 07:19:34,067] Trial 7 finished with value: 0.4090909090909091 and parameters: {'warmup': 'True', 'num_epochs': 40, 'batch_size': 46, 'lr-adaptschedule': 'False', 'lr': 0.0021444509390777054, 'head-lr': 5, 'lr-scheduler-start': 5, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.915053406758525}. Best is trial 1 with value: 0.4772727272727273.
acc: 0.386364
AUC: 0.622590
Avg Precision: 0.302787
Avg Recall: 1.000000
d_prime: 0.441643
train_loss: 1.185608
valid_loss: 1.323834
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0015034946388858001
Epoch-40 lr: 0.007517473194429001
epoch 40 training time: 6.325
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c85673a0>
The learning rate scheduler starts at 7 epoch with decay rate of 0.798 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 07:19:34.073344
current #epochs=1, #steps=0
start validation
acc: 0.340909
AUC: 0.684573
Avg Precision: 0.335898
Avg Recall: 1.000000
d_prime: 0.679565
train_loss: 1.415577
valid_loss: 1.350930
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.004155438983320217
Epoch-1 lr: 0.020777194916601086
epoch 1 training time: 8.882
---------------
2023-09-12 07:19:42.955870
current #epochs=2, #steps=8
start validation
acc: 0.295455
AUC: 0.636364
Avg Precision: 0.348413
Avg Recall: 1.000000
d_prime: 0.493215
train_loss: 1.324650
valid_loss: 1.344374
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.004155438983320217
Epoch-2 lr: 0.020777194916601086
epoch 2 training time: 6.309
---------------
2023-09-12 07:19:49.265353
current #epochs=3, #steps=16
start validation
acc: 0.363636
AUC: 0.627410
Avg Precision: 0.305094
Avg Recall: 1.000000
d_prime: 0.459623
train_loss: 1.283892
valid_loss: 1.339881
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.004155438983320217
Epoch-3 lr: 0.020777194916601086
epoch 3 training time: 8.856
---------------
2023-09-12 07:19:58.121531
current #epochs=4, #steps=24
start validation
acc: 0.363636
AUC: 0.561983
Avg Precision: 0.283183
Avg Recall: 1.000000
d_prime: 0.220617
train_loss: 1.315300
valid_loss: 1.364165
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.004155438983320217
Epoch-4 lr: 0.020777194916601086
epoch 4 training time: 7.032
---------------
2023-09-12 07:20:05.153708
current #epochs=5, #steps=32
start validation
acc: 0.318182
AUC: 0.540634
Avg Precision: 0.277167
Avg Recall: 1.000000
d_prime: 0.144292
train_loss: 1.306783
valid_loss: 1.348436
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.004155438983320217
Epoch-5 lr: 0.020777194916601086
epoch 5 training time: 6.296
---------------
2023-09-12 07:20:11.449362
current #epochs=6, #steps=40
start validation
acc: 0.340909
AUC: 0.557163
Avg Precision: 0.277719
Avg Recall: 1.000000
d_prime: 0.203334
train_loss: 1.220154
valid_loss: 1.345550
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.004155438983320217
Epoch-6 lr: 0.020777194916601086
epoch 6 training time: 6.262
---------------
2023-09-12 07:20:17.710886
current #epochs=7, #steps=48
start validation
acc: 0.363636
AUC: 0.589532
Avg Precision: 0.281740
Avg Recall: 1.000000
d_prime: 0.320094
train_loss: 1.333611
valid_loss: 1.349926
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0033141071558437526
Epoch-7 lr: 0.016570535779218763
epoch 7 training time: 6.473
---------------
2023-09-12 07:20:24.183674
current #epochs=8, #steps=56
start validation
[I 2023-09-12 07:20:30,420] Trial 8 finished with value: 0.36363636363636365 and parameters: {'warmup': 'False', 'num_epochs': 8, 'batch_size': 38, 'lr-adaptschedule': 'True', 'lr': 0.004155438983320217, 'head-lr': 5, 'lr-scheduler-start': 7, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.797534789740978}. Best is trial 1 with value: 0.4772727272727273.
acc: 0.340909
AUC: 0.603994
Avg Precision: 0.298735
Avg Recall: 1.000000
d_prime: 0.372928
train_loss: 1.222737
valid_loss: 1.338213
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0033141071558437526
Epoch-8 lr: 0.016570535779218763
epoch 8 training time: 6.232
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8e3d0d0>
The learning rate scheduler starts at 9 epoch with decay rate of 0.817 every 6 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 07:20:30.426278
current #epochs=1, #steps=0
start validation
acc: 0.340909
AUC: 0.588843
Avg Precision: 0.291756
Avg Recall: 1.000000
d_prime: 0.317589
train_loss: 1.336259
valid_loss: 1.341649
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.004343786441961169
Epoch-1 lr: 0.008687572883922337
epoch 1 training time: 8.590
---------------
2023-09-12 07:20:39.016398
current #epochs=2, #steps=8
start validation
acc: 0.318182
AUC: 0.637741
Avg Precision: 0.300620
Avg Recall: 1.000000
d_prime: 0.498407
train_loss: 1.205612
valid_loss: 1.334171
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.004343786441961169
Epoch-2 lr: 0.008687572883922337
epoch 2 training time: 7.268
---------------
2023-09-12 07:20:46.284419
current #epochs=3, #steps=16
start validation
acc: 0.318182
AUC: 0.623278
Avg Precision: 0.296325
Avg Recall: 1.000000
d_prime: 0.444207
train_loss: 1.224362
valid_loss: 1.330885
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.004343786441961169
Epoch-3 lr: 0.008687572883922337
epoch 3 training time: 7.342
---------------
2023-09-12 07:20:53.626253
current #epochs=4, #steps=24
start validation
acc: 0.295455
AUC: 0.626033
Avg Precision: 0.290740
Avg Recall: 1.000000
d_prime: 0.454479
train_loss: 1.172616
valid_loss: 1.335922
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.004343786441961169
Epoch-4 lr: 0.008687572883922337
epoch 4 training time: 6.282
---------------
2023-09-12 07:20:59.908749
current #epochs=5, #steps=32
start validation
acc: 0.340909
AUC: 0.622590
Avg Precision: 0.295030
Avg Recall: 1.000000
d_prime: 0.441643
train_loss: 1.184940
valid_loss: 1.341547
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.004343786441961169
Epoch-5 lr: 0.008687572883922337
epoch 5 training time: 6.108
---------------
2023-09-12 07:21:06.016154
current #epochs=6, #steps=40
start validation
acc: 0.295455
AUC: 0.635675
Avg Precision: 0.300209
Avg Recall: 1.000000
d_prime: 0.490621
train_loss: 1.200879
valid_loss: 1.350273
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.004343786441961169
Epoch-6 lr: 0.008687572883922337
epoch 6 training time: 6.328
---------------
2023-09-12 07:21:12.344271
current #epochs=7, #steps=48
start validation
acc: 0.409091
AUC: 0.648072
Avg Precision: 0.304649
Avg Recall: 1.000000
d_prime: 0.537570
train_loss: 1.230983
valid_loss: 1.336710
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.004343786441961169
Epoch-7 lr: 0.008687572883922337
epoch 7 training time: 9.191
---------------
2023-09-12 07:21:21.535465
current #epochs=8, #steps=56
start validation
acc: 0.340909
AUC: 0.618457
Avg Precision: 0.296349
Avg Recall: 1.000000
d_prime: 0.426289
train_loss: 1.198276
valid_loss: 1.320147
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.004343786441961169
Epoch-8 lr: 0.008687572883922337
epoch 8 training time: 6.455
---------------
2023-09-12 07:21:27.989987
current #epochs=9, #steps=64
start validation
acc: 0.340909
AUC: 0.655647
Avg Precision: 0.298111
Avg Recall: 1.000000
d_prime: 0.566552
train_loss: 1.177104
valid_loss: 1.316656
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.003550295214574465
Epoch-9 lr: 0.00710059042914893
epoch 9 training time: 6.319
---------------
2023-09-12 07:21:34.309434
current #epochs=10, #steps=72
start validation
acc: 0.363636
AUC: 0.656336
Avg Precision: 0.299377
Avg Recall: 1.000000
d_prime: 0.569198
train_loss: 1.164646
valid_loss: 1.312114
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.003550295214574465
Epoch-10 lr: 0.00710059042914893
epoch 10 training time: 6.182
---------------
2023-09-12 07:21:40.490972
current #epochs=11, #steps=80
start validation
[I 2023-09-12 07:21:47,567] Trial 9 finished with value: 0.4090909090909091 and parameters: {'warmup': 'False', 'num_epochs': 11, 'batch_size': 49, 'lr-adaptschedule': 'False', 'lr': 0.004343786441961169, 'head-lr': 2, 'lr-scheduler-start': 9, 'lr-scheduler-step': 6, 'lr-scheduler-decay': 0.817327293137263}. Best is trial 1 with value: 0.4772727272727273.
acc: 0.363636
AUC: 0.659091
Avg Precision: 0.301688
Avg Recall: 1.000000
d_prime: 0.579804
train_loss: 1.187435
valid_loss: 1.303359
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.003550295214574465
Epoch-11 lr: 0.00710059042914893
epoch 11 training time: 7.072
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c7f32160>
The learning rate scheduler starts at 5 epoch with decay rate of 0.717 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 07:21:47.597176
current #epochs=1, #steps=0
start validation
acc: 0.340909
AUC: 0.661157
Avg Precision: 0.301688
Avg Recall: 1.000000
d_prime: 0.587780
train_loss: 1.234677
valid_loss: 1.316739
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0005019364306346813
Epoch-1 lr: 0.0015058092919040438
epoch 1 training time: 9.709
---------------
2023-09-12 07:21:57.307002
current #epochs=2, #steps=8
start validation
acc: 0.431818
AUC: 0.657025
Avg Precision: 0.301688
Avg Recall: 1.000000
d_prime: 0.571847
train_loss: 1.190211
valid_loss: 1.306054
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0005019364306346813
Epoch-2 lr: 0.0015058092919040438
epoch 2 training time: 9.928
---------------
2023-09-12 07:22:07.235276
current #epochs=3, #steps=16
start validation
acc: 0.386364
AUC: 0.656336
Avg Precision: 0.301688
Avg Recall: 1.000000
d_prime: 0.569198
train_loss: 1.176856
valid_loss: 1.304436
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0005019364306346813
Epoch-3 lr: 0.0015058092919040438
epoch 3 training time: 6.335
---------------
2023-09-12 07:22:13.570321
current #epochs=4, #steps=24
start validation
acc: 0.409091
AUC: 0.655647
Avg Precision: 0.301688
Avg Recall: 1.000000
d_prime: 0.566552
train_loss: 1.193088
valid_loss: 1.297192
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0005019364306346813
Epoch-4 lr: 0.0015058092919040438
epoch 4 training time: 6.520
---------------
2023-09-12 07:22:20.090581
current #epochs=5, #steps=32
start validation
acc: 0.409091
AUC: 0.660468
Avg Precision: 0.299833
Avg Recall: 1.000000
d_prime: 0.585119
train_loss: 1.181432
valid_loss: 1.301104
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0003599933348946826
Epoch-5 lr: 0.0010799800046840478
epoch 5 training time: 6.198
---------------
2023-09-12 07:22:26.288363
current #epochs=6, #steps=40
start validation
acc: 0.431818
AUC: 0.659091
Avg Precision: 0.296393
Avg Recall: 1.000000
d_prime: 0.579804
train_loss: 1.167480
valid_loss: 1.303788
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0002581904664794433
Epoch-6 lr: 0.0007745713994383299
epoch 6 training time: 6.163
---------------
2023-09-12 07:22:32.451975
current #epochs=7, #steps=48
start validation
acc: 0.409091
AUC: 0.656336
Avg Precision: 0.296393
Avg Recall: 1.000000
d_prime: 0.569198
train_loss: 1.186131
valid_loss: 1.304203
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00018517653111654094
Epoch-7 lr: 0.0005555295933496228
epoch 7 training time: 6.485
---------------
2023-09-12 07:22:38.936715
current #epochs=8, #steps=56
start validation
acc: 0.386364
AUC: 0.654270
Avg Precision: 0.296393
Avg Recall: 1.000000
d_prime: 0.561265
train_loss: 1.170711
valid_loss: 1.303061
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00013281027817921154
Epoch-8 lr: 0.0003984308345376346
epoch 8 training time: 6.197
---------------
2023-09-12 07:22:45.133341
current #epochs=9, #steps=64
start validation
acc: 0.386364
AUC: 0.654959
Avg Precision: 0.296393
Avg Recall: 1.000000
d_prime: 0.563908
train_loss: 1.181908
valid_loss: 1.302272
validation finished
normal learning rate scheduler step
Epoch-9 lr: 9.525272929396604e-05
Epoch-9 lr: 0.0002857581878818981
epoch 9 training time: 6.285
---------------
2023-09-12 07:22:51.418681
current #epochs=10, #steps=72
start validation
acc: 0.409091
AUC: 0.652893
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.555986
train_loss: 1.152562
valid_loss: 1.302743
validation finished
normal learning rate scheduler step
Epoch-10 lr: 6.83161165110018e-05
Epoch-10 lr: 0.00020494834953300537
epoch 10 training time: 6.452
---------------
2023-09-12 07:22:57.870914
current #epochs=11, #steps=80
start validation
acc: 0.386364
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.133242
valid_loss: 1.301591
validation finished
normal learning rate scheduler step
Epoch-11 lr: 4.8996934888252265e-05
Epoch-11 lr: 0.00014699080466475676
epoch 11 training time: 6.465
---------------
2023-09-12 07:23:04.335525
current #epochs=12, #steps=88
start validation
acc: 0.386364
AUC: 0.654270
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.561265
train_loss: 1.174236
valid_loss: 1.300138
validation finished
normal learning rate scheduler step
Epoch-12 lr: 3.514104359338132e-05
Epoch-12 lr: 0.00010542313078014394
epoch 12 training time: 6.176
---------------
2023-09-12 07:23:10.511368
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01130	Per Sample Data Time 0.00584	Per Sample DNN Time 0.00546	Train Loss 1.1486	
start validation
acc: 0.386364
AUC: 0.654270
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.561265
train_loss: 1.162766
valid_loss: 1.299163
validation finished
normal learning rate scheduler step
Epoch-13 lr: 2.5203473393761415e-05
Epoch-13 lr: 7.561042018128423e-05
epoch 13 training time: 6.225
---------------
2023-09-12 07:23:16.736743
current #epochs=14, #steps=104
start validation
acc: 0.386364
AUC: 0.654959
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.563908
train_loss: 1.180380
valid_loss: 1.298737
validation finished
normal learning rate scheduler step
Epoch-14 lr: 1.8076158422047542e-05
Epoch-14 lr: 5.422847526614261e-05
epoch 14 training time: 6.384
---------------
2023-09-12 07:23:23.120800
current #epochs=15, #steps=112
start validation
acc: 0.386364
AUC: 0.654959
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.563908
train_loss: 1.187629
valid_loss: 1.298664
validation finished
normal learning rate scheduler step
Epoch-15 lr: 1.2964383844801316e-05
Epoch-15 lr: 3.889315153440394e-05
epoch 15 training time: 6.398
---------------
2023-09-12 07:23:29.518645
current #epochs=16, #steps=120
start validation
acc: 0.386364
AUC: 0.653581
Avg Precision: 0.293273
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.191540
valid_loss: 1.298814
validation finished
normal learning rate scheduler step
Epoch-16 lr: 9.298173016139508e-06
Epoch-16 lr: 2.789451904841851e-05
epoch 16 training time: 7.110
---------------
2023-09-12 07:23:36.628778
current #epochs=17, #steps=128
start validation
acc: 0.386364
AUC: 0.653581
Avg Precision: 0.293273
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.164897
valid_loss: 1.299163
validation finished
normal learning rate scheduler step
Epoch-17 lr: 6.6687335451529e-06
Epoch-17 lr: 2.000620063545869e-05
epoch 17 training time: 6.275
---------------
2023-09-12 07:23:42.903670
current #epochs=18, #steps=136
start validation
acc: 0.409091
AUC: 0.654270
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.561265
train_loss: 1.170033
valid_loss: 1.299448
validation finished
normal learning rate scheduler step
Epoch-18 lr: 4.782875842281521e-06
Epoch-18 lr: 1.4348627526844558e-05
epoch 18 training time: 6.603
---------------
2023-09-12 07:23:49.506595
current #epochs=19, #steps=144
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.166397
valid_loss: 1.299508
validation finished
normal learning rate scheduler step
Epoch-19 lr: 3.430321689686835e-06
Epoch-19 lr: 1.0290965069060501e-05
epoch 19 training time: 6.598
---------------
2023-09-12 07:23:56.104449
current #epochs=20, #steps=152
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.116203
valid_loss: 1.299530
validation finished
normal learning rate scheduler step
Epoch-20 lr: 2.460257653086561e-06
Epoch-20 lr: 7.3807729592596795e-06
epoch 20 training time: 6.413
---------------
2023-09-12 07:24:02.517453
current #epochs=21, #steps=160
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.167930
valid_loss: 1.299518
validation finished
normal learning rate scheduler step
Epoch-21 lr: 1.7645189772634932e-06
Epoch-21 lr: 5.2935569317904776e-06
epoch 21 training time: 6.435
---------------
2023-09-12 07:24:08.952854
current #epochs=22, #steps=168
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.142922
valid_loss: 1.299506
validation finished
normal learning rate scheduler step
Epoch-22 lr: 1.265528924264039e-06
Epoch-22 lr: 3.796586772792115e-06
epoch 22 training time: 6.406
---------------
2023-09-12 07:24:15.359112
current #epochs=23, #steps=176
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.143588
valid_loss: 1.299499
validation finished
normal learning rate scheduler step
Epoch-23 lr: 9.076487579820096e-07
Epoch-23 lr: 2.7229462739460272e-06
epoch 23 training time: 6.171
---------------
2023-09-12 07:24:21.529443
current #epochs=24, #steps=184
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.177178
valid_loss: 1.299499
validation finished
normal learning rate scheduler step
Epoch-24 lr: 6.509738750897188e-07
Epoch-24 lr: 1.9529216252691553e-06
epoch 24 training time: 7.635
---------------
2023-09-12 07:24:29.164901
current #epochs=25, #steps=192
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.161644
valid_loss: 1.299502
validation finished
normal learning rate scheduler step
Epoch-25 lr: 4.6688433419056606e-07
Epoch-25 lr: 1.4006530025716974e-06
epoch 25 training time: 6.263
---------------
2023-09-12 07:24:35.427262
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03507	Per Sample Data Time 0.02955	Per Sample DNN Time 0.00552	Train Loss 1.1212	
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.141395
valid_loss: 1.299500
validation finished
normal learning rate scheduler step
Epoch-26 lr: 3.348536551985677e-07
Epoch-26 lr: 1.0045609655957024e-06
epoch 26 training time: 6.285
---------------
2023-09-12 07:24:41.712239
current #epochs=27, #steps=208
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.140978
valid_loss: 1.299494
validation finished
normal learning rate scheduler step
Epoch-27 lr: 2.401600614726878e-07
Epoch-27 lr: 7.20480184418063e-07
epoch 27 training time: 6.545
---------------
2023-09-12 07:24:48.257709
current #epochs=28, #steps=216
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.185843
valid_loss: 1.299497
validation finished
normal learning rate scheduler step
Epoch-28 lr: 1.722449620338261e-07
Epoch-28 lr: 5.167348861014779e-07
epoch 28 training time: 6.423
---------------
2023-09-12 07:24:54.680860
current #epochs=29, #steps=224
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.159653
valid_loss: 1.299500
validation finished
normal learning rate scheduler step
Epoch-29 lr: 1.2353564020638886e-07
Epoch-29 lr: 3.706069206191663e-07
epoch 29 training time: 6.191
---------------
2023-09-12 07:25:00.871466
current #epochs=30, #steps=232
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.149356
valid_loss: 1.299501
validation finished
normal learning rate scheduler step
Epoch-30 lr: 8.860087529413683e-08
Epoch-30 lr: 2.6580262588241034e-07
epoch 30 training time: 6.240
---------------
2023-09-12 07:25:07.111305
current #epochs=31, #steps=240
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.185679
valid_loss: 1.299502
validation finished
normal learning rate scheduler step
Epoch-31 lr: 6.354534683085897e-08
Epoch-31 lr: 1.9063604049257682e-07
epoch 31 training time: 6.195
---------------
2023-09-12 07:25:13.306670
current #epochs=32, #steps=248
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.146727
valid_loss: 1.299503
validation finished
normal learning rate scheduler step
Epoch-32 lr: 4.5575295847233854e-08
Epoch-32 lr: 1.367258875417015e-07
epoch 32 training time: 6.283
---------------
2023-09-12 07:25:19.589941
current #epochs=33, #steps=256
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.184870
valid_loss: 1.299504
validation finished
normal learning rate scheduler step
Epoch-33 lr: 3.2687013214226465e-08
Epoch-33 lr: 9.806103964267934e-08
epoch 33 training time: 7.735
---------------
2023-09-12 07:25:27.324848
current #epochs=34, #steps=264
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.174154
valid_loss: 1.299505
validation finished
normal learning rate scheduler step
Epoch-34 lr: 2.344342067352402e-08
Epoch-34 lr: 7.033026202057203e-08
epoch 34 training time: 6.208
---------------
2023-09-12 07:25:33.532663
current #epochs=35, #steps=272
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.143984
valid_loss: 1.299505
validation finished
normal learning rate scheduler step
Epoch-35 lr: 1.6813832737602713e-08
Epoch-35 lr: 5.0441498212808116e-08
epoch 35 training time: 6.327
---------------
2023-09-12 07:25:39.860122
current #epochs=36, #steps=280
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.168613
valid_loss: 1.299505
validation finished
normal learning rate scheduler step
Epoch-36 lr: 1.205903247930689e-08
Epoch-36 lr: 3.6177097437920654e-08
epoch 36 training time: 7.602
---------------
2023-09-12 07:25:47.462183
current #epochs=37, #steps=288
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.134950
valid_loss: 1.299505
validation finished
normal learning rate scheduler step
Epoch-37 lr: 8.648846851661512e-09
Epoch-37 lr: 2.5946540554984523e-08
epoch 37 training time: 6.545
---------------
2023-09-12 07:25:54.007231
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01195	Per Sample Data Time 0.00604	Per Sample DNN Time 0.00591	Train Loss 1.1893	
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.142942
valid_loss: 1.299505
validation finished
normal learning rate scheduler step
Epoch-38 lr: 6.203030963873366e-09
Epoch-38 lr: 1.8609092891620088e-08
epoch 38 training time: 6.381
---------------
2023-09-12 07:26:00.388084
current #epochs=39, #steps=304
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.146460
valid_loss: 1.299505
validation finished
normal learning rate scheduler step
Epoch-39 lr: 4.44886975092869e-09
Epoch-39 lr: 1.3346609252786064e-08
epoch 39 training time: 6.968
---------------
2023-09-12 07:26:07.356613
current #epochs=40, #steps=312
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.162354
valid_loss: 1.299505
validation finished
normal learning rate scheduler step
Epoch-40 lr: 3.1907695086482833e-09
Epoch-40 lr: 9.572308525944845e-09
epoch 40 training time: 6.317
---------------
2023-09-12 07:26:13.673697
current #epochs=41, #steps=320
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.163407
valid_loss: 1.299505
validation finished
normal learning rate scheduler step
Epoch-41 lr: 2.288448668382424e-09
Epoch-41 lr: 6.865346005147268e-09
epoch 41 training time: 6.275
---------------
2023-09-12 07:26:19.948891
current #epochs=42, #steps=328
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.191885
valid_loss: 1.299505
validation finished
normal learning rate scheduler step
Epoch-42 lr: 1.6412960239299317e-09
Epoch-42 lr: 4.9238880717897925e-09
epoch 42 training time: 6.376
---------------
2023-09-12 07:26:26.325231
current #epochs=43, #steps=336
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.132816
valid_loss: 1.299505
validation finished
normal learning rate scheduler step
Epoch-43 lr: 1.1771523108151412e-09
Epoch-43 lr: 3.5314569324454216e-09
epoch 43 training time: 6.213
---------------
2023-09-12 07:26:32.538912
current #epochs=44, #steps=344
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.157737
valid_loss: 1.299505
validation finished
normal learning rate scheduler step
Epoch-44 lr: 8.442642537691195e-10
Epoch-44 lr: 2.532792761307357e-09
epoch 44 training time: 6.210
---------------
2023-09-12 07:26:38.748706
current #epochs=45, #steps=352
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.126102
valid_loss: 1.299505
validation finished
normal learning rate scheduler step
Epoch-45 lr: 6.05513937018693e-10
Epoch-45 lr: 1.8165418110560778e-09
epoch 45 training time: 6.265
---------------
2023-09-12 07:26:45.013839
current #epochs=46, #steps=360
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.173692
valid_loss: 1.299505
validation finished
normal learning rate scheduler step
Epoch-46 lr: 4.342800566138199e-10
Epoch-46 lr: 1.302840169841459e-09
epoch 46 training time: 6.204
---------------
2023-09-12 07:26:51.217942
current #epochs=47, #steps=368
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.161221
valid_loss: 1.299505
validation finished
normal learning rate scheduler step
Epoch-47 lr: 3.1146957327041733e-10
Epoch-47 lr: 9.344087198112514e-10
epoch 47 training time: 6.307
---------------
2023-09-12 07:26:57.525072
current #epochs=48, #steps=376
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.155244
valid_loss: 1.299505
validation finished
normal learning rate scheduler step
Epoch-48 lr: 2.2338878701842888e-10
Epoch-48 lr: 6.701663610552863e-10
epoch 48 training time: 6.467
---------------
2023-09-12 07:27:03.991982
current #epochs=49, #steps=384
start validation
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.157303
valid_loss: 1.299505
validation finished
normal learning rate scheduler step
Epoch-49 lr: 1.6021645273915625e-10
Epoch-49 lr: 4.806493582174685e-10
epoch 49 training time: 6.401
---------------
2023-09-12 07:27:10.392610
current #epochs=50, #steps=392
start validation
[I 2023-09-12 07:27:16,582] Trial 10 finished with value: 0.4318181818181818 and parameters: {'warmup': 'True', 'num_epochs': 50, 'batch_size': 59, 'lr-adaptschedule': 'True', 'lr': 0.0005019364306346813, 'head-lr': 3, 'lr-scheduler-start': 5, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7172090187585776}. Best is trial 1 with value: 0.4772727272727273.
acc: 0.409091
AUC: 0.653581
Avg Precision: 0.294796
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.113358
valid_loss: 1.299505
validation finished
normal learning rate scheduler step
Epoch-50 lr: 1.1490868485803027e-10
Epoch-50 lr: 3.4472605457409066e-10
epoch 50 training time: 6.186
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c859b4f0>
The learning rate scheduler starts at 10 epoch with decay rate of 0.753 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 07:27:16.612874
current #epochs=1, #steps=0
start validation
acc: 0.386364
AUC: 0.681818
Avg Precision: 0.299165
Avg Recall: 1.000000
d_prime: 0.668625
train_loss: 1.276374
valid_loss: 1.327654
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0031412232614734343
Epoch-1 lr: 0.012564893045893737
epoch 1 training time: 8.675
---------------
2023-09-12 07:27:25.288427
current #epochs=2, #steps=8
start validation
acc: 0.386364
AUC: 0.595730
Avg Precision: 0.294592
Avg Recall: 1.000000
d_prime: 0.342678
train_loss: 1.209852
valid_loss: 1.312938
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0031412232614734343
Epoch-2 lr: 0.012564893045893737
epoch 2 training time: 6.319
---------------
2023-09-12 07:27:31.607018
current #epochs=3, #steps=16
start validation
acc: 0.409091
AUC: 0.634298
Avg Precision: 0.290651
Avg Recall: 1.000000
d_prime: 0.485439
train_loss: 1.193292
valid_loss: 1.307887
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0031412232614734343
Epoch-3 lr: 0.012564893045893737
epoch 3 training time: 8.888
---------------
2023-09-12 07:27:40.494986
current #epochs=4, #steps=24
start validation
acc: 0.409091
AUC: 0.608127
Avg Precision: 0.278657
Avg Recall: 1.000000
d_prime: 0.388117
train_loss: 1.189663
valid_loss: 1.332812
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0031412232614734343
Epoch-4 lr: 0.012564893045893737
epoch 4 training time: 6.186
---------------
2023-09-12 07:27:46.680756
current #epochs=5, #steps=32
start validation
acc: 0.340909
AUC: 0.595041
Avg Precision: 0.276086
Avg Recall: 1.000000
d_prime: 0.340165
train_loss: 1.161014
valid_loss: 1.345548
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0031412232614734343
Epoch-5 lr: 0.012564893045893737
epoch 5 training time: 6.231
---------------
2023-09-12 07:27:52.911244
current #epochs=6, #steps=40
start validation
acc: 0.295455
AUC: 0.612259
Avg Precision: 0.290941
Avg Recall: 1.000000
d_prime: 0.403350
train_loss: 1.158913
valid_loss: 1.330351
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0031412232614734343
Epoch-6 lr: 0.012564893045893737
epoch 6 training time: 6.180
---------------
2023-09-12 07:27:59.091219
current #epochs=7, #steps=48
start validation
acc: 0.340909
AUC: 0.619146
Avg Precision: 0.279704
Avg Recall: 1.000000
d_prime: 0.428844
train_loss: 1.147262
valid_loss: 1.324905
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0031412232614734343
Epoch-7 lr: 0.012564893045893737
epoch 7 training time: 7.055
---------------
2023-09-12 07:28:06.146184
current #epochs=8, #steps=56
start validation
acc: 0.295455
AUC: 0.606061
Avg Precision: 0.277896
Avg Recall: 1.000000
d_prime: 0.380517
train_loss: 1.193774
valid_loss: 1.341822
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0031412232614734343
Epoch-8 lr: 0.012564893045893737
epoch 8 training time: 6.194
---------------
2023-09-12 07:28:12.340616
current #epochs=9, #steps=64
start validation
acc: 0.363636
AUC: 0.629477
Avg Precision: 0.285909
Avg Recall: 1.000000
d_prime: 0.467351
train_loss: 1.187374
valid_loss: 1.344895
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0031412232614734343
Epoch-9 lr: 0.012564893045893737
epoch 9 training time: 6.357
---------------
2023-09-12 07:28:18.697670
current #epochs=10, #steps=72
start validation
acc: 0.409091
AUC: 0.654270
Avg Precision: 0.296854
Avg Recall: 1.000000
d_prime: 0.561265
train_loss: 1.153923
valid_loss: 1.321080
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.002365678798349043
Epoch-10 lr: 0.009462715193396172
epoch 10 training time: 6.329
---------------
2023-09-12 07:28:25.026572
current #epochs=11, #steps=80
start validation
acc: 0.386364
AUC: 0.621901
Avg Precision: 0.284633
Avg Recall: 1.000000
d_prime: 0.439081
train_loss: 1.150751
valid_loss: 1.321291
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.002365678798349043
Epoch-11 lr: 0.009462715193396172
epoch 11 training time: 6.215
---------------
2023-09-12 07:28:31.241591
current #epochs=12, #steps=88
start validation
acc: 0.409091
AUC: 0.601240
Avg Precision: 0.287237
Avg Recall: 1.000000
d_prime: 0.362827
train_loss: 1.166758
valid_loss: 1.329892
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.002365678798349043
Epoch-12 lr: 0.009462715193396172
epoch 12 training time: 6.169
---------------
2023-09-12 07:28:37.410318
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01142	Per Sample Data Time 0.00595	Per Sample DNN Time 0.00547	Train Loss 1.1843	
start validation
acc: 0.363636
AUC: 0.608815
Avg Precision: 0.292273
Avg Recall: 1.000000
d_prime: 0.390652
train_loss: 1.196666
valid_loss: 1.346893
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.002365678798349043
Epoch-13 lr: 0.009462715193396172
epoch 13 training time: 6.170
---------------
2023-09-12 07:28:43.580215
current #epochs=14, #steps=104
start validation
acc: 0.340909
AUC: 0.602617
Avg Precision: 0.294036
Avg Recall: 1.000000
d_prime: 0.367875
train_loss: 1.217012
valid_loss: 1.335657
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.002365678798349043
Epoch-14 lr: 0.009462715193396172
epoch 14 training time: 6.898
---------------
2023-09-12 07:28:50.478384
current #epochs=15, #steps=112
start validation
acc: 0.363636
AUC: 0.607438
Avg Precision: 0.297067
Avg Recall: 1.000000
d_prime: 0.385582
train_loss: 1.192360
valid_loss: 1.326281
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.002365678798349043
Epoch-15 lr: 0.009462715193396172
epoch 15 training time: 6.224
---------------
2023-09-12 07:28:56.702493
current #epochs=16, #steps=120
start validation
acc: 0.363636
AUC: 0.612948
Avg Precision: 0.287973
Avg Recall: 1.000000
d_prime: 0.405893
train_loss: 1.193998
valid_loss: 1.324958
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.002365678798349043
Epoch-16 lr: 0.009462715193396172
epoch 16 training time: 6.253
---------------
2023-09-12 07:29:02.955575
current #epochs=17, #steps=128
start validation
acc: 0.340909
AUC: 0.606061
Avg Precision: 0.292805
Avg Recall: 1.000000
d_prime: 0.380517
train_loss: 1.143741
valid_loss: 1.318628
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.002365678798349043
Epoch-17 lr: 0.009462715193396172
epoch 17 training time: 6.509
---------------
2023-09-12 07:29:09.464173
current #epochs=18, #steps=136
start validation
acc: 0.340909
AUC: 0.606061
Avg Precision: 0.301120
Avg Recall: 1.000000
d_prime: 0.380517
train_loss: 1.174584
valid_loss: 1.328272
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.002365678798349043
Epoch-18 lr: 0.009462715193396172
epoch 18 training time: 6.298
---------------
2023-09-12 07:29:15.762091
current #epochs=19, #steps=144
start validation
acc: 0.204545
AUC: 0.601928
Avg Precision: 0.296534
Avg Recall: 1.000000
d_prime: 0.365350
train_loss: 1.170371
valid_loss: 1.334185
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.002365678798349043
Epoch-19 lr: 0.009462715193396172
epoch 19 training time: 6.172
---------------
2023-09-12 07:29:21.934452
current #epochs=20, #steps=152
start validation
acc: 0.363636
AUC: 0.612948
Avg Precision: 0.293260
Avg Recall: 1.000000
d_prime: 0.405893
train_loss: 1.165456
valid_loss: 1.333825
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0017816104463498359
Epoch-20 lr: 0.0071264417853993435
epoch 20 training time: 6.262
---------------
2023-09-12 07:29:28.196318
current #epochs=21, #steps=160
start validation
acc: 0.295455
AUC: 0.618457
Avg Precision: 0.292546
Avg Recall: 1.000000
d_prime: 0.426289
train_loss: 1.160152
valid_loss: 1.333156
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0017816104463498359
Epoch-21 lr: 0.0071264417853993435
epoch 21 training time: 6.292
---------------
2023-09-12 07:29:34.488387
current #epochs=22, #steps=168
start validation
acc: 0.363636
AUC: 0.621901
Avg Precision: 0.292546
Avg Recall: 1.000000
d_prime: 0.439081
train_loss: 1.116396
valid_loss: 1.315594
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0017816104463498359
Epoch-22 lr: 0.0071264417853993435
epoch 22 training time: 6.196
---------------
2023-09-12 07:29:40.684572
current #epochs=23, #steps=176
start validation
acc: 0.318182
AUC: 0.630854
Avg Precision: 0.294402
Avg Recall: 1.000000
d_prime: 0.472511
train_loss: 1.149104
valid_loss: 1.320778
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0017816104463498359
Epoch-23 lr: 0.0071264417853993435
epoch 23 training time: 6.334
---------------
2023-09-12 07:29:47.018729
current #epochs=24, #steps=184
start validation
acc: 0.363636
AUC: 0.625344
Avg Precision: 0.303724
Avg Recall: 1.000000
d_prime: 0.451909
train_loss: 1.144454
valid_loss: 1.318351
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0017816104463498359
Epoch-24 lr: 0.0071264417853993435
epoch 24 training time: 6.564
---------------
2023-09-12 07:29:53.582617
current #epochs=25, #steps=192
start validation
acc: 0.318182
AUC: 0.630165
Avg Precision: 0.306620
Avg Recall: 1.000000
d_prime: 0.469931
train_loss: 1.157282
valid_loss: 1.313258
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0017816104463498359
Epoch-25 lr: 0.0071264417853993435
epoch 25 training time: 7.918
---------------
2023-09-12 07:30:01.500453
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03653	Per Sample Data Time 0.02873	Per Sample DNN Time 0.00780	Train Loss 1.0894	
start validation
acc: 0.295455
AUC: 0.626722
Avg Precision: 0.313568
Avg Recall: 1.000000
d_prime: 0.457050
train_loss: 1.189374
valid_loss: 1.330463
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0017816104463498359
Epoch-26 lr: 0.0071264417853993435
epoch 26 training time: 7.612
---------------
2023-09-12 07:30:09.112592
current #epochs=27, #steps=208
start validation
acc: 0.340909
AUC: 0.653581
Avg Precision: 0.319048
Avg Recall: 1.000000
d_prime: 0.558625
train_loss: 1.173286
valid_loss: 1.339453
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0017816104463498359
Epoch-27 lr: 0.0071264417853993435
epoch 27 training time: 6.259
---------------
2023-09-12 07:30:15.371505
current #epochs=28, #steps=216
start validation
acc: 0.409091
AUC: 0.688017
Avg Precision: 0.315629
Avg Recall: 1.000000
d_prime: 0.693298
train_loss: 1.172096
valid_loss: 1.317438
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0017816104463498359
Epoch-28 lr: 0.0071264417853993435
epoch 28 training time: 6.474
---------------
2023-09-12 07:30:21.845124
current #epochs=29, #steps=224
start validation
acc: 0.500000
AUC: 0.691460
Avg Precision: 0.310867
Avg Recall: 1.000000
d_prime: 0.707097
train_loss: 1.183777
valid_loss: 1.295872
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0017816104463498359
Epoch-29 lr: 0.0071264417853993435
epoch 29 training time: 10.391
---------------
2023-09-12 07:30:32.236791
current #epochs=30, #steps=232
start validation
acc: 0.340909
AUC: 0.681818
Avg Precision: 0.321467
Avg Recall: 1.000000
d_prime: 0.668625
train_loss: 1.140571
valid_loss: 1.303634
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.001341744189768291
Epoch-30 lr: 0.005366976759073164
epoch 30 training time: 6.230
---------------
2023-09-12 07:30:38.466867
current #epochs=31, #steps=240
start validation
acc: 0.363636
AUC: 0.694904
Avg Precision: 0.330972
Avg Recall: 1.000000
d_prime: 0.720964
train_loss: 1.125037
valid_loss: 1.295804
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.001341744189768291
Epoch-31 lr: 0.005366976759073164
epoch 31 training time: 6.141
---------------
2023-09-12 07:30:44.607664
current #epochs=32, #steps=248
start validation
acc: 0.363636
AUC: 0.690083
Avg Precision: 0.328199
Avg Recall: 1.000000
d_prime: 0.701570
train_loss: 1.067476
valid_loss: 1.297292
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.001341744189768291
Epoch-32 lr: 0.005366976759073164
epoch 32 training time: 7.139
---------------
2023-09-12 07:30:51.746717
current #epochs=33, #steps=256
start validation
acc: 0.386364
AUC: 0.688705
Avg Precision: 0.332487
Avg Recall: 1.000000
d_prime: 0.696053
train_loss: 1.092165
valid_loss: 1.291706
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.001341744189768291
Epoch-33 lr: 0.005366976759073164
epoch 33 training time: 6.267
---------------
2023-09-12 07:30:58.013598
current #epochs=34, #steps=264
start validation
acc: 0.295455
AUC: 0.674931
Avg Precision: 0.328199
Avg Recall: 1.000000
d_prime: 0.641446
train_loss: 1.084649
valid_loss: 1.303803
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.001341744189768291
Epoch-34 lr: 0.005366976759073164
epoch 34 training time: 6.173
---------------
2023-09-12 07:31:04.186736
current #epochs=35, #steps=272
start validation
acc: 0.386364
AUC: 0.665289
Avg Precision: 0.329449
Avg Recall: 1.000000
d_prime: 0.603787
train_loss: 1.080024
valid_loss: 1.300495
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.001341744189768291
Epoch-35 lr: 0.005366976759073164
epoch 35 training time: 6.182
---------------
2023-09-12 07:31:10.368106
current #epochs=36, #steps=280
start validation
acc: 0.318182
AUC: 0.657025
Avg Precision: 0.329323
Avg Recall: 1.000000
d_prime: 0.571847
train_loss: 1.123979
valid_loss: 1.313609
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.001341744189768291
Epoch-36 lr: 0.005366976759073164
epoch 36 training time: 7.762
---------------
2023-09-12 07:31:18.130307
current #epochs=37, #steps=288
start validation
acc: 0.363636
AUC: 0.683196
Avg Precision: 0.323646
Avg Recall: 1.000000
d_prime: 0.674090
train_loss: 1.094078
valid_loss: 1.310015
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.001341744189768291
Epoch-37 lr: 0.005366976759073164
epoch 37 training time: 6.265
---------------
2023-09-12 07:31:24.394701
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01139	Per Sample Data Time 0.00588	Per Sample DNN Time 0.00551	Train Loss 1.1284	
start validation
acc: 0.295455
AUC: 0.648072
Avg Precision: 0.303657
Avg Recall: 1.000000
d_prime: 0.537570
train_loss: 1.113408
valid_loss: 1.321481
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.001341744189768291
Epoch-38 lr: 0.005366976759073164
epoch 38 training time: 6.211
---------------
2023-09-12 07:31:30.605595
current #epochs=39, #steps=304
start validation
acc: 0.318182
AUC: 0.627410
Avg Precision: 0.289240
Avg Recall: 1.000000
d_prime: 0.459623
train_loss: 1.106902
valid_loss: 1.318675
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.001341744189768291
Epoch-39 lr: 0.005366976759073164
epoch 39 training time: 7.584
---------------
2023-09-12 07:31:38.189390
current #epochs=40, #steps=312
start validation
acc: 0.318182
AUC: 0.618457
Avg Precision: 0.286728
Avg Recall: 1.000000
d_prime: 0.426289
train_loss: 1.122548
valid_loss: 1.321074
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.001010477612805525
Epoch-40 lr: 0.0040419104512221
epoch 40 training time: 6.432
---------------
2023-09-12 07:31:44.621303
current #epochs=41, #steps=320
start validation
acc: 0.363636
AUC: 0.626033
Avg Precision: 0.299703
Avg Recall: 1.000000
d_prime: 0.454479
train_loss: 1.059075
valid_loss: 1.311631
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.001010477612805525
Epoch-41 lr: 0.0040419104512221
epoch 41 training time: 6.581
---------------
2023-09-12 07:31:51.202432
current #epochs=42, #steps=328
start validation
acc: 0.295455
AUC: 0.629477
Avg Precision: 0.301768
Avg Recall: 1.000000
d_prime: 0.467351
train_loss: 1.112899
valid_loss: 1.307266
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.001010477612805525
Epoch-42 lr: 0.0040419104512221
epoch 42 training time: 6.664
---------------
2023-09-12 07:31:57.866694
current #epochs=43, #steps=336
start validation
acc: 0.318182
AUC: 0.646694
Avg Precision: 0.306261
Avg Recall: 1.000000
d_prime: 0.532325
train_loss: 1.069623
valid_loss: 1.309561
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.001010477612805525
Epoch-43 lr: 0.0040419104512221
epoch 43 training time: 6.281
---------------
2023-09-12 07:32:04.148023
current #epochs=44, #steps=344
start validation
acc: 0.295455
AUC: 0.659091
Avg Precision: 0.321884
Avg Recall: 1.000000
d_prime: 0.579804
train_loss: 1.063846
valid_loss: 1.309921
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.001010477612805525
Epoch-44 lr: 0.0040419104512221
epoch 44 training time: 6.271
---------------
2023-09-12 07:32:10.419243
current #epochs=45, #steps=352
start validation
acc: 0.363636
AUC: 0.665978
Avg Precision: 0.312152
Avg Recall: 1.000000
d_prime: 0.606463
train_loss: 1.090651
valid_loss: 1.306401
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.001010477612805525
Epoch-45 lr: 0.0040419104512221
epoch 45 training time: 6.244
---------------
2023-09-12 07:32:16.663192
current #epochs=46, #steps=360
start validation
acc: 0.363636
AUC: 0.652893
Avg Precision: 0.356108
Avg Recall: 1.000000
d_prime: 0.555986
train_loss: 1.091836
valid_loss: 1.310533
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.001010477612805525
Epoch-46 lr: 0.0040419104512221
epoch 46 training time: 6.176
---------------
2023-09-12 07:32:22.839048
current #epochs=47, #steps=368
start validation
acc: 0.295455
AUC: 0.648760
Avg Precision: 0.347256
Avg Recall: 1.000000
d_prime: 0.540195
train_loss: 1.080072
valid_loss: 1.309960
validation finished
normal learning rate scheduler step
Epoch-47 lr: 0.001010477612805525
Epoch-47 lr: 0.0040419104512221
epoch 47 training time: 6.339
---------------
2023-09-12 07:32:29.178176
current #epochs=48, #steps=376
start validation
acc: 0.340909
AUC: 0.644628
Avg Precision: 0.342672
Avg Recall: 1.000000
d_prime: 0.524471
train_loss: 1.043263
valid_loss: 1.310366
validation finished
normal learning rate scheduler step
Epoch-48 lr: 0.001010477612805525
Epoch-48 lr: 0.0040419104512221
epoch 48 training time: 6.452
---------------
2023-09-12 07:32:35.630357
current #epochs=49, #steps=384
start validation
acc: 0.409091
AUC: 0.662534
Avg Precision: 0.369242
Avg Recall: 1.000000
d_prime: 0.593107
train_loss: 1.041933
valid_loss: 1.301989
validation finished
normal learning rate scheduler step
Epoch-49 lr: 0.001010477612805525
Epoch-49 lr: 0.0040419104512221
epoch 49 training time: 6.278
---------------
2023-09-12 07:32:41.908281
current #epochs=50, #steps=392
start validation
[I 2023-09-12 07:32:49,394] Trial 11 finished with value: 0.5 and parameters: {'warmup': 'True', 'num_epochs': 50, 'batch_size': 64, 'lr-adaptschedule': 'False', 'lr': 0.0031412232614734343, 'head-lr': 4, 'lr-scheduler-start': 10, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.7531075003052755}. Best is trial 11 with value: 0.5.
acc: 0.363636
AUC: 0.667355
Avg Precision: 0.376068
Avg Recall: 1.000000
d_prime: 0.611820
train_loss: 1.048212
valid_loss: 1.297256
validation finished
normal learning rate scheduler step
Epoch-50 lr: 0.000760998269094411
Epoch-50 lr: 0.003043993076377644
epoch 50 training time: 7.481
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f957c000f10>
The learning rate scheduler starts at 10 epoch with decay rate of 0.727 every 8 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 07:32:49.425003
current #epochs=1, #steps=0
start validation
acc: 0.409091
AUC: 0.683884
Avg Precision: 0.371689
Avg Recall: 1.000000
d_prime: 0.676826
train_loss: 1.116474
valid_loss: 1.310875
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003133793649159716
Epoch-1 lr: 0.012535174596638865
epoch 1 training time: 9.066
---------------
2023-09-12 07:32:58.491161
current #epochs=2, #steps=8
start validation
acc: 0.409091
AUC: 0.659780
Avg Precision: 0.359463
Avg Recall: 1.000000
d_prime: 0.582460
train_loss: 1.183918
valid_loss: 1.316469
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003133793649159716
Epoch-2 lr: 0.012535174596638865
epoch 2 training time: 7.591
---------------
2023-09-12 07:33:06.081958
current #epochs=3, #steps=16
start validation
acc: 0.409091
AUC: 0.683196
Avg Precision: 0.377097
Avg Recall: 1.000000
d_prime: 0.674090
train_loss: 1.125986
valid_loss: 1.297541
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003133793649159716
Epoch-3 lr: 0.012535174596638865
epoch 3 training time: 6.469
---------------
2023-09-12 07:33:12.551309
current #epochs=4, #steps=24
start validation
acc: 0.409091
AUC: 0.688705
Avg Precision: 0.386037
Avg Recall: 1.000000
d_prime: 0.696053
train_loss: 1.109061
valid_loss: 1.286317
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003133793649159716
Epoch-4 lr: 0.012535174596638865
epoch 4 training time: 6.114
---------------
2023-09-12 07:33:18.665184
current #epochs=5, #steps=32
start validation
acc: 0.431818
AUC: 0.713499
Avg Precision: 0.414255
Avg Recall: 1.000000
d_prime: 0.797100
train_loss: 1.102642
valid_loss: 1.273394
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.003133793649159716
Epoch-5 lr: 0.012535174596638865
epoch 5 training time: 9.868
---------------
2023-09-12 07:33:28.533789
current #epochs=6, #steps=40
start validation
acc: 0.431818
AUC: 0.680441
Avg Precision: 0.423300
Avg Recall: 1.000000
d_prime: 0.663170
train_loss: 1.042481
valid_loss: 1.273346
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.003133793649159716
Epoch-6 lr: 0.012535174596638865
epoch 6 training time: 7.243
---------------
2023-09-12 07:33:35.776623
current #epochs=7, #steps=48
start validation
acc: 0.386364
AUC: 0.705923
Avg Precision: 0.449440
Avg Recall: 1.000000
d_prime: 0.765815
train_loss: 1.115641
valid_loss: 1.267819
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.003133793649159716
Epoch-7 lr: 0.012535174596638865
epoch 7 training time: 6.244
---------------
2023-09-12 07:33:42.020394
current #epochs=8, #steps=56
start validation
acc: 0.500000
AUC: 0.718320
Avg Precision: 0.425063
Avg Recall: 1.000000
d_prime: 0.817213
train_loss: 1.046598
valid_loss: 1.258282
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.003133793649159716
Epoch-8 lr: 0.012535174596638865
epoch 8 training time: 8.533
---------------
2023-09-12 07:33:50.553563
current #epochs=9, #steps=64
start validation
acc: 0.363636
AUC: 0.702479
Avg Precision: 0.412626
Avg Recall: 1.000000
d_prime: 0.751718
train_loss: 1.110736
valid_loss: 1.273973
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.003133793649159716
Epoch-9 lr: 0.012535174596638865
epoch 9 training time: 6.207
---------------
2023-09-12 07:33:56.760344
current #epochs=10, #steps=72
start validation
acc: 0.409091
AUC: 0.682507
Avg Precision: 0.408119
Avg Recall: 1.000000
d_prime: 0.671356
train_loss: 1.075608
valid_loss: 1.275346
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0022774216936666024
Epoch-10 lr: 0.00910968677466641
epoch 10 training time: 6.194
---------------
2023-09-12 07:34:02.954534
current #epochs=11, #steps=80
start validation
acc: 0.340909
AUC: 0.670110
Avg Precision: 0.380925
Avg Recall: 1.000000
d_prime: 0.622562
train_loss: 1.063820
valid_loss: 1.287664
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0022774216936666024
Epoch-11 lr: 0.00910968677466641
epoch 11 training time: 6.404
---------------
2023-09-12 07:34:09.358920
current #epochs=12, #steps=88
start validation
acc: 0.386364
AUC: 0.657025
Avg Precision: 0.367556
Avg Recall: 1.000000
d_prime: 0.571847
train_loss: 1.057567
valid_loss: 1.289082
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0022774216936666024
Epoch-12 lr: 0.00910968677466641
epoch 12 training time: 6.077
---------------
2023-09-12 07:34:15.435649
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01191	Per Sample Data Time 0.00613	Per Sample DNN Time 0.00578	Train Loss 1.0595	
start validation
acc: 0.386364
AUC: 0.669421
Avg Precision: 0.325213
Avg Recall: 1.000000
d_prime: 0.619873
train_loss: 1.066452
valid_loss: 1.293314
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0022774216936666024
Epoch-13 lr: 0.00910968677466641
epoch 13 training time: 6.399
---------------
2023-09-12 07:34:21.833953
current #epochs=14, #steps=104
start validation
acc: 0.363636
AUC: 0.666667
Avg Precision: 0.387473
Avg Recall: 1.000000
d_prime: 0.609140
train_loss: 1.038333
valid_loss: 1.283557
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0022774216936666024
Epoch-14 lr: 0.00910968677466641
epoch 14 training time: 6.303
---------------
2023-09-12 07:34:28.136925
current #epochs=15, #steps=112
start validation
acc: 0.295455
AUC: 0.699725
Avg Precision: 0.390250
Avg Recall: 1.000000
d_prime: 0.740494
train_loss: 1.064191
valid_loss: 1.290229
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0022774216936666024
Epoch-15 lr: 0.00910968677466641
epoch 15 training time: 6.256
---------------
2023-09-12 07:34:34.393735
current #epochs=16, #steps=120
start validation
acc: 0.363636
AUC: 0.690083
Avg Precision: 0.393863
Avg Recall: 1.000000
d_prime: 0.701570
train_loss: 1.031351
valid_loss: 1.272676
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0022774216936666024
Epoch-16 lr: 0.00910968677466641
epoch 16 training time: 6.237
---------------
2023-09-12 07:34:40.629955
current #epochs=17, #steps=128
start validation
acc: 0.295455
AUC: 0.688017
Avg Precision: 0.384842
Avg Recall: 1.000000
d_prime: 0.693298
train_loss: 1.025740
valid_loss: 1.278776
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0022774216936666024
Epoch-17 lr: 0.00910968677466641
epoch 17 training time: 6.198
---------------
2023-09-12 07:34:46.827764
current #epochs=18, #steps=136
start validation
acc: 0.386364
AUC: 0.688017
Avg Precision: 0.383267
Avg Recall: 1.000000
d_prime: 0.693298
train_loss: 1.040442
valid_loss: 1.277006
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0016550705475371632
Epoch-18 lr: 0.006620282190148653
epoch 18 training time: 6.162
---------------
2023-09-12 07:34:52.989313
current #epochs=19, #steps=144
start validation
acc: 0.431818
AUC: 0.705234
Avg Precision: 0.407532
Avg Recall: 1.000000
d_prime: 0.762989
train_loss: 1.021206
valid_loss: 1.268876
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0016550705475371632
Epoch-19 lr: 0.006620282190148653
epoch 19 training time: 6.455
---------------
2023-09-12 07:34:59.444279
current #epochs=20, #steps=152
start validation
acc: 0.454545
AUC: 0.696970
Avg Precision: 0.358442
Avg Recall: 1.000000
d_prime: 0.729317
train_loss: 0.991986
valid_loss: 1.272521
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0016550705475371632
Epoch-20 lr: 0.006620282190148653
epoch 20 training time: 6.253
---------------
2023-09-12 07:35:05.698005
current #epochs=21, #steps=160
start validation
acc: 0.454545
AUC: 0.698347
Avg Precision: 0.346241
Avg Recall: 1.000000
d_prime: 0.734900
train_loss: 1.020625
valid_loss: 1.273705
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0016550705475371632
Epoch-21 lr: 0.006620282190148653
epoch 21 training time: 6.248
---------------
2023-09-12 07:35:11.946285
current #epochs=22, #steps=168
start validation
acc: 0.477273
AUC: 0.694215
Avg Precision: 0.394335
Avg Recall: 1.000000
d_prime: 0.718185
train_loss: 1.002794
valid_loss: 1.270615
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0016550705475371632
Epoch-22 lr: 0.006620282190148653
epoch 22 training time: 6.324
---------------
2023-09-12 07:35:18.270201
current #epochs=23, #steps=176
start validation
acc: 0.318182
AUC: 0.691460
Avg Precision: 0.340516
Avg Recall: 1.000000
d_prime: 0.707097
train_loss: 1.027417
valid_loss: 1.273204
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0016550705475371632
Epoch-23 lr: 0.006620282190148653
epoch 23 training time: 6.299
---------------
2023-09-12 07:35:24.569534
current #epochs=24, #steps=184
start validation
acc: 0.318182
AUC: 0.671488
Avg Precision: 0.368075
Avg Recall: 1.000000
d_prime: 0.627946
train_loss: 1.004458
valid_loss: 1.305762
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0016550705475371632
Epoch-24 lr: 0.006620282190148653
epoch 24 training time: 6.448
---------------
2023-09-12 07:35:31.017569
current #epochs=25, #steps=192
start validation
acc: 0.409091
AUC: 0.720386
Avg Precision: 0.374869
Avg Recall: 1.000000
d_prime: 0.825883
train_loss: 1.087765
valid_loss: 1.280734
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0016550705475371632
Epoch-25 lr: 0.006620282190148653
epoch 25 training time: 6.243
---------------
2023-09-12 07:35:37.260305
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03555	Per Sample Data Time 0.02983	Per Sample DNN Time 0.00572	Train Loss 1.0739	
start validation
acc: 0.477273
AUC: 0.691460
Avg Precision: 0.373559
Avg Recall: 1.000000
d_prime: 0.707097
train_loss: 1.055789
valid_loss: 1.271925
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.001202789331875914
Epoch-26 lr: 0.004811157327503656
epoch 26 training time: 6.657
---------------
2023-09-12 07:35:43.917673
current #epochs=27, #steps=208
start validation
acc: 0.454545
AUC: 0.685950
Avg Precision: 0.386413
Avg Recall: 1.000000
d_prime: 0.685051
train_loss: 1.037415
valid_loss: 1.271875
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.001202789331875914
Epoch-27 lr: 0.004811157327503656
epoch 27 training time: 7.940
---------------
2023-09-12 07:35:51.857208
current #epochs=28, #steps=216
start validation
acc: 0.454545
AUC: 0.693526
Avg Precision: 0.391067
Avg Recall: 1.000000
d_prime: 0.715409
train_loss: 1.044828
valid_loss: 1.275527
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.001202789331875914
Epoch-28 lr: 0.004811157327503656
epoch 28 training time: 7.572
---------------
2023-09-12 07:35:59.429520
current #epochs=29, #steps=224
start validation
acc: 0.431818
AUC: 0.681818
Avg Precision: 0.421048
Avg Recall: 1.000000
d_prime: 0.668625
train_loss: 1.009044
valid_loss: 1.283104
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.001202789331875914
Epoch-29 lr: 0.004811157327503656
epoch 29 training time: 6.174
---------------
2023-09-12 07:36:05.603829
current #epochs=30, #steps=232
start validation
acc: 0.386364
AUC: 0.676309
Avg Precision: 0.402241
Avg Recall: 1.000000
d_prime: 0.646863
train_loss: 1.005664
valid_loss: 1.286665
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.001202789331875914
Epoch-30 lr: 0.004811157327503656
epoch 30 training time: 6.432
---------------
2023-09-12 07:36:12.035853
current #epochs=31, #steps=240
start validation
acc: 0.363636
AUC: 0.672176
Avg Precision: 0.395956
Avg Recall: 1.000000
d_prime: 0.630641
train_loss: 1.020526
valid_loss: 1.284496
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.001202789331875914
Epoch-31 lr: 0.004811157327503656
epoch 31 training time: 6.200
---------------
2023-09-12 07:36:18.236117
current #epochs=32, #steps=248
start validation
acc: 0.409091
AUC: 0.671488
Avg Precision: 0.397479
Avg Recall: 1.000000
d_prime: 0.627946
train_loss: 0.983896
valid_loss: 1.280899
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.001202789331875914
Epoch-32 lr: 0.004811157327503656
epoch 32 training time: 7.968
---------------
2023-09-12 07:36:26.204203
current #epochs=33, #steps=256
start validation
acc: 0.340909
AUC: 0.675620
Avg Precision: 0.399076
Avg Recall: 1.000000
d_prime: 0.644153
train_loss: 1.021238
valid_loss: 1.284173
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.001202789331875914
Epoch-33 lr: 0.004811157327503656
epoch 33 training time: 6.413
---------------
2023-09-12 07:36:32.616924
current #epochs=34, #steps=264
start validation
acc: 0.431818
AUC: 0.669421
Avg Precision: 0.379573
Avg Recall: 1.000000
d_prime: 0.619873
train_loss: 0.988936
valid_loss: 1.281575
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0008741030278300104
Epoch-34 lr: 0.0034964121113200417
epoch 34 training time: 6.350
---------------
2023-09-12 07:36:38.966930
current #epochs=35, #steps=272
start validation
acc: 0.386364
AUC: 0.685950
Avg Precision: 0.400881
Avg Recall: 1.000000
d_prime: 0.685051
train_loss: 0.981438
valid_loss: 1.266232
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0008741030278300104
Epoch-35 lr: 0.0034964121113200417
epoch 35 training time: 6.380
---------------
2023-09-12 07:36:45.346964
current #epochs=36, #steps=280
start validation
acc: 0.454545
AUC: 0.684573
Avg Precision: 0.380283
Avg Recall: 1.000000
d_prime: 0.679565
train_loss: 0.951319
valid_loss: 1.269690
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0008741030278300104
Epoch-36 lr: 0.0034964121113200417
epoch 36 training time: 7.343
---------------
2023-09-12 07:36:52.690324
current #epochs=37, #steps=288
start validation
acc: 0.409091
AUC: 0.686639
Avg Precision: 0.381960
Avg Recall: 1.000000
d_prime: 0.687797
train_loss: 0.963063
valid_loss: 1.265771
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0008741030278300104
Epoch-37 lr: 0.0034964121113200417
epoch 37 training time: 7.382
---------------
2023-09-12 07:37:00.072582
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01177	Per Sample Data Time 0.00595	Per Sample DNN Time 0.00582	Train Loss 0.9301	
start validation
acc: 0.409091
AUC: 0.690083
Avg Precision: 0.380283
Avg Recall: 1.000000
d_prime: 0.701570
train_loss: 0.937476
valid_loss: 1.271453
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0008741030278300104
Epoch-38 lr: 0.0034964121113200417
epoch 38 training time: 6.332
---------------
2023-09-12 07:37:06.403661
current #epochs=39, #steps=304
start validation
acc: 0.340909
AUC: 0.675620
Avg Precision: 0.368075
Avg Recall: 1.000000
d_prime: 0.644153
train_loss: 0.893366
valid_loss: 1.273997
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0008741030278300104
Epoch-39 lr: 0.0034964121113200417
epoch 39 training time: 6.478
---------------
2023-09-12 07:37:12.882140
current #epochs=40, #steps=312
start validation
acc: 0.340909
AUC: 0.664601
Avg Precision: 0.367645
Avg Recall: 1.000000
d_prime: 0.601114
train_loss: 0.993990
valid_loss: 1.285261
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0008741030278300104
Epoch-40 lr: 0.0034964121113200417
epoch 40 training time: 8.093
---------------
2023-09-12 07:37:20.975145
current #epochs=41, #steps=320
start validation
acc: 0.363636
AUC: 0.665978
Avg Precision: 0.370899
Avg Recall: 1.000000
d_prime: 0.606463
train_loss: 0.974034
valid_loss: 1.284769
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0008741030278300104
Epoch-41 lr: 0.0034964121113200417
epoch 41 training time: 7.784
---------------
2023-09-12 07:37:28.759768
current #epochs=42, #steps=328
start validation
acc: 0.409091
AUC: 0.671488
Avg Precision: 0.374669
Avg Recall: 1.000000
d_prime: 0.627946
train_loss: 0.944417
valid_loss: 1.286128
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0006352368473953308
Epoch-42 lr: 0.0025409473895813234
epoch 42 training time: 6.320
---------------
2023-09-12 07:37:35.079949
current #epochs=43, #steps=336
start validation
acc: 0.386364
AUC: 0.667355
Avg Precision: 0.370314
Avg Recall: 1.000000
d_prime: 0.611820
train_loss: 0.983551
valid_loss: 1.280548
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0006352368473953308
Epoch-43 lr: 0.0025409473895813234
epoch 43 training time: 6.302
---------------
2023-09-12 07:37:41.381844
current #epochs=44, #steps=344
start validation
acc: 0.409091
AUC: 0.665289
Avg Precision: 0.359187
Avg Recall: 1.000000
d_prime: 0.603787
train_loss: 0.963300
valid_loss: 1.275423
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0006352368473953308
Epoch-44 lr: 0.0025409473895813234
epoch 44 training time: 6.410
---------------
2023-09-12 07:37:47.792120
current #epochs=45, #steps=352
start validation
acc: 0.386364
AUC: 0.663223
Avg Precision: 0.363290
Avg Recall: 1.000000
d_prime: 0.595774
train_loss: 0.958705
valid_loss: 1.275711
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0006352368473953308
Epoch-45 lr: 0.0025409473895813234
epoch 45 training time: 6.419
---------------
2023-09-12 07:37:54.211035
current #epochs=46, #steps=360
start validation
acc: 0.363636
AUC: 0.664601
Avg Precision: 0.344059
Avg Recall: 1.000000
d_prime: 0.601114
train_loss: 0.989985
valid_loss: 1.277141
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.0006352368473953308
Epoch-46 lr: 0.0025409473895813234
epoch 46 training time: 6.235
---------------
2023-09-12 07:38:00.445946
current #epochs=47, #steps=368
start validation
acc: 0.409091
AUC: 0.663223
Avg Precision: 0.353097
Avg Recall: 1.000000
d_prime: 0.595774
train_loss: 0.912319
valid_loss: 1.271473
validation finished
normal learning rate scheduler step
Epoch-47 lr: 0.0006352368473953308
Epoch-47 lr: 0.0025409473895813234
epoch 47 training time: 7.393
---------------
2023-09-12 07:38:07.838896
current #epochs=48, #steps=376
start validation
acc: 0.409091
AUC: 0.668044
Avg Precision: 0.339301
Avg Recall: 1.000000
d_prime: 0.614502
train_loss: 0.989745
valid_loss: 1.267338
validation finished
normal learning rate scheduler step
Epoch-48 lr: 0.0006352368473953308
Epoch-48 lr: 0.0025409473895813234
epoch 48 training time: 6.281
---------------
2023-09-12 07:38:14.119847
current #epochs=49, #steps=384
start validation
acc: 0.363636
AUC: 0.659780
Avg Precision: 0.328359
Avg Recall: 1.000000
d_prime: 0.582460
train_loss: 0.911136
valid_loss: 1.272179
validation finished
normal learning rate scheduler step
Epoch-49 lr: 0.0006352368473953308
Epoch-49 lr: 0.0025409473895813234
epoch 49 training time: 6.204
---------------
2023-09-12 07:38:20.323417
current #epochs=50, #steps=392
start validation
[I 2023-09-12 07:38:26,636] Trial 12 finished with value: 0.5 and parameters: {'warmup': 'True', 'num_epochs': 50, 'batch_size': 59, 'lr-adaptschedule': 'False', 'lr': 0.003133793649159716, 'head-lr': 4, 'lr-scheduler-start': 10, 'lr-scheduler-step': 8, 'lr-scheduler-decay': 0.726729947352233}. Best is trial 11 with value: 0.5.
acc: 0.431818
AUC: 0.648760
Avg Precision: 0.326017
Avg Recall: 1.000000
d_prime: 0.540195
train_loss: 0.960353
valid_loss: 1.276198
validation finished
normal learning rate scheduler step
Epoch-50 lr: 0.0004616456406638072
Epoch-50 lr: 0.0018465825626552289
epoch 50 training time: 6.308
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8e14400>
The learning rate scheduler starts at 10 epoch with decay rate of 0.650 every 8 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 07:38:26.667655
current #epochs=1, #steps=0
start validation
acc: 0.363636
AUC: 0.688017
Avg Precision: 0.365491
Avg Recall: 1.000000
d_prime: 0.693298
train_loss: 1.140172
valid_loss: 1.301451
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0032890617161703785
Epoch-1 lr: 0.013156246864681514
epoch 1 training time: 8.666
---------------
2023-09-12 07:38:35.334240
current #epochs=2, #steps=8
start validation
acc: 0.386364
AUC: 0.700413
Avg Precision: 0.351729
Avg Recall: 1.000000
d_prime: 0.743296
train_loss: 1.053630
valid_loss: 1.273585
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0032890617161703785
Epoch-2 lr: 0.013156246864681514
epoch 2 training time: 8.999
---------------
2023-09-12 07:38:44.333049
current #epochs=3, #steps=16
start validation
acc: 0.318182
AUC: 0.665289
Avg Precision: 0.378183
Avg Recall: 1.000000
d_prime: 0.603787
train_loss: 0.987208
valid_loss: 1.299517
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0032890617161703785
Epoch-3 lr: 0.013156246864681514
epoch 3 training time: 6.344
---------------
2023-09-12 07:38:50.676907
current #epochs=4, #steps=24
start validation
acc: 0.386364
AUC: 0.623967
Avg Precision: 0.311202
Avg Recall: 1.000000
d_prime: 0.446773
train_loss: 1.007547
valid_loss: 1.295526
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0032890617161703785
Epoch-4 lr: 0.013156246864681514
epoch 4 training time: 6.352
---------------
2023-09-12 07:38:57.029066
current #epochs=5, #steps=32
start validation
acc: 0.318182
AUC: 0.619146
Avg Precision: 0.292692
Avg Recall: 1.000000
d_prime: 0.428844
train_loss: 1.058959
valid_loss: 1.302062
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0032890617161703785
Epoch-5 lr: 0.013156246864681514
epoch 5 training time: 6.268
---------------
2023-09-12 07:39:03.296675
current #epochs=6, #steps=40
start validation
acc: 0.318182
AUC: 0.632920
Avg Precision: 0.305208
Avg Recall: 1.000000
d_prime: 0.480263
train_loss: 1.053199
valid_loss: 1.307464
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0032890617161703785
Epoch-6 lr: 0.013156246864681514
epoch 6 training time: 6.209
---------------
2023-09-12 07:39:09.505540
current #epochs=7, #steps=48
start validation
acc: 0.409091
AUC: 0.673554
Avg Precision: 0.319526
Avg Recall: 1.000000
d_prime: 0.636039
train_loss: 1.056817
valid_loss: 1.300127
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0032890617161703785
Epoch-7 lr: 0.013156246864681514
epoch 7 training time: 9.307
---------------
2023-09-12 07:39:18.812315
current #epochs=8, #steps=56
start validation
acc: 0.409091
AUC: 0.707300
Avg Precision: 0.392339
Avg Recall: 1.000000
d_prime: 0.771475
train_loss: 1.012928
valid_loss: 1.276690
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0032890617161703785
Epoch-8 lr: 0.013156246864681514
epoch 8 training time: 6.302
---------------
2023-09-12 07:39:25.114015
current #epochs=9, #steps=64
start validation
acc: 0.431818
AUC: 0.737603
Avg Precision: 0.447038
Avg Recall: 1.000000
d_prime: 0.899403
train_loss: 0.970824
valid_loss: 1.251462
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0032890617161703785
Epoch-9 lr: 0.013156246864681514
epoch 9 training time: 8.800
---------------
2023-09-12 07:39:33.913467
current #epochs=10, #steps=72
start validation
acc: 0.409091
AUC: 0.730028
Avg Precision: 0.416552
Avg Recall: 1.000000
d_prime: 0.866766
train_loss: 0.992060
valid_loss: 1.275506
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00213877747570222
Epoch-10 lr: 0.00855510990280888
epoch 10 training time: 6.481
---------------
2023-09-12 07:39:40.394902
current #epochs=11, #steps=80
start validation
acc: 0.431818
AUC: 0.724518
Avg Precision: 0.419243
Avg Recall: 1.000000
d_prime: 0.843318
train_loss: 0.975782
valid_loss: 1.264527
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00213877747570222
Epoch-11 lr: 0.00855510990280888
epoch 11 training time: 7.569
---------------
2023-09-12 07:39:47.964132
current #epochs=12, #steps=88
start validation
acc: 0.363636
AUC: 0.713499
Avg Precision: 0.406999
Avg Recall: 1.000000
d_prime: 0.797100
train_loss: 0.992800
valid_loss: 1.278152
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00213877747570222
Epoch-12 lr: 0.00855510990280888
epoch 12 training time: 6.327
---------------
2023-09-12 07:39:54.290984
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01177	Per Sample Data Time 0.00600	Per Sample DNN Time 0.00577	Train Loss 0.9657	
start validation
acc: 0.431818
AUC: 0.716253
Avg Precision: 0.395545
Avg Recall: 1.000000
d_prime: 0.808573
train_loss: 0.952690
valid_loss: 1.276292
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00213877747570222
Epoch-13 lr: 0.00855510990280888
epoch 13 training time: 6.543
---------------
2023-09-12 07:40:00.834735
current #epochs=14, #steps=104
start validation
acc: 0.454545
AUC: 0.719008
Avg Precision: 0.378269
Avg Recall: 1.000000
d_prime: 0.820099
train_loss: 0.941455
valid_loss: 1.268970
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.00213877747570222
Epoch-14 lr: 0.00855510990280888
epoch 14 training time: 8.662
---------------
2023-09-12 07:40:09.496903
current #epochs=15, #steps=112
start validation
acc: 0.454545
AUC: 0.692837
Avg Precision: 0.321174
Avg Recall: 1.000000
d_prime: 0.712635
train_loss: 0.915824
valid_loss: 1.254381
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.00213877747570222
Epoch-15 lr: 0.00855510990280888
epoch 15 training time: 7.342
---------------
2023-09-12 07:40:16.838835
current #epochs=16, #steps=120
start validation
acc: 0.522727
AUC: 0.699725
Avg Precision: 0.349652
Avg Recall: 1.000000
d_prime: 0.740494
train_loss: 0.956153
valid_loss: 1.268376
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.00213877747570222
Epoch-16 lr: 0.00855510990280888
epoch 16 training time: 8.809
---------------
2023-09-12 07:40:25.648192
current #epochs=17, #steps=128
start validation
acc: 0.500000
AUC: 0.737603
Avg Precision: 0.380348
Avg Recall: 1.000000
d_prime: 0.899403
train_loss: 0.918221
valid_loss: 1.248574
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.00213877747570222
Epoch-17 lr: 0.00855510990280888
epoch 17 training time: 7.494
---------------
2023-09-12 07:40:33.141914
current #epochs=18, #steps=136
start validation
acc: 0.522727
AUC: 0.718320
Avg Precision: 0.386310
Avg Recall: 1.000000
d_prime: 0.817213
train_loss: 0.932814
valid_loss: 1.262285
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0013907823827329488
Epoch-18 lr: 0.005563129530931795
epoch 18 training time: 6.923
---------------
2023-09-12 07:40:40.064663
current #epochs=19, #steps=144
start validation
acc: 0.454545
AUC: 0.721074
Avg Precision: 0.364663
Avg Recall: 1.000000
d_prime: 0.828780
train_loss: 0.906561
valid_loss: 1.265388
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0013907823827329488
Epoch-19 lr: 0.005563129530931795
epoch 19 training time: 6.185
---------------
2023-09-12 07:40:46.249650
current #epochs=20, #steps=152
start validation
acc: 0.409091
AUC: 0.695592
Avg Precision: 0.346955
Avg Recall: 1.000000
d_prime: 0.723745
train_loss: 0.960878
valid_loss: 1.273327
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0013907823827329488
Epoch-20 lr: 0.005563129530931795
epoch 20 training time: 7.623
---------------
2023-09-12 07:40:53.872264
current #epochs=21, #steps=160
start validation
acc: 0.454545
AUC: 0.690083
Avg Precision: 0.313908
Avg Recall: 1.000000
d_prime: 0.701570
train_loss: 0.961168
valid_loss: 1.272346
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0013907823827329488
Epoch-21 lr: 0.005563129530931795
epoch 21 training time: 6.267
---------------
2023-09-12 07:41:00.138805
current #epochs=22, #steps=168
start validation
acc: 0.477273
AUC: 0.702479
Avg Precision: 0.311457
Avg Recall: 1.000000
d_prime: 0.751718
train_loss: 0.903708
valid_loss: 1.262658
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0013907823827329488
Epoch-22 lr: 0.005563129530931795
epoch 22 training time: 6.138
---------------
2023-09-12 07:41:06.276996
current #epochs=23, #steps=176
start validation
acc: 0.500000
AUC: 0.712810
Avg Precision: 0.299369
Avg Recall: 1.000000
d_prime: 0.794240
train_loss: 0.885020
valid_loss: 1.254280
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0013907823827329488
Epoch-23 lr: 0.005563129530931795
epoch 23 training time: 6.380
---------------
2023-09-12 07:41:12.656738
current #epochs=24, #steps=184
start validation
acc: 0.477273
AUC: 0.712121
Avg Precision: 0.314731
Avg Recall: 1.000000
d_prime: 0.791383
train_loss: 0.989030
valid_loss: 1.263681
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0013907823827329488
Epoch-24 lr: 0.005563129530931795
epoch 24 training time: 7.867
---------------
2023-09-12 07:41:20.524051
current #epochs=25, #steps=192
start validation
acc: 0.500000
AUC: 0.693526
Avg Precision: 0.309489
Avg Recall: 1.000000
d_prime: 0.715409
train_loss: 0.874389
valid_loss: 1.266627
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0013907823827329488
Epoch-25 lr: 0.005563129530931795
epoch 25 training time: 7.867
---------------
2023-09-12 07:41:28.391591
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03588	Per Sample Data Time 0.03031	Per Sample DNN Time 0.00557	Train Loss 0.9904	
start validation
acc: 0.500000
AUC: 0.714187
Avg Precision: 0.318789
Avg Recall: 1.000000
d_prime: 0.799963
train_loss: 0.895191
valid_loss: 1.258694
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0009043837697445649
Epoch-26 lr: 0.0036175350789782595
epoch 26 training time: 6.287
---------------
2023-09-12 07:41:34.678843
current #epochs=27, #steps=208
start validation
acc: 0.522727
AUC: 0.712121
Avg Precision: 0.321062
Avg Recall: 1.000000
d_prime: 0.791383
train_loss: 0.887493
valid_loss: 1.254362
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0009043837697445649
Epoch-27 lr: 0.0036175350789782595
epoch 27 training time: 6.297
---------------
2023-09-12 07:41:40.976126
current #epochs=28, #steps=216
start validation
acc: 0.477273
AUC: 0.696970
Avg Precision: 0.302112
Avg Recall: 1.000000
d_prime: 0.729317
train_loss: 0.847872
valid_loss: 1.260791
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0009043837697445649
Epoch-28 lr: 0.0036175350789782595
epoch 28 training time: 6.482
---------------
2023-09-12 07:41:47.458077
current #epochs=29, #steps=224
start validation
acc: 0.477273
AUC: 0.719697
Avg Precision: 0.339315
Avg Recall: 1.000000
d_prime: 0.822990
train_loss: 0.897017
valid_loss: 1.257753
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0009043837697445649
Epoch-29 lr: 0.0036175350789782595
epoch 29 training time: 6.205
---------------
2023-09-12 07:41:53.663075
current #epochs=30, #steps=232
start validation
acc: 0.386364
AUC: 0.716253
Avg Precision: 0.373147
Avg Recall: 1.000000
d_prime: 0.808573
train_loss: 0.893834
valid_loss: 1.261045
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0009043837697445649
Epoch-30 lr: 0.0036175350789782595
epoch 30 training time: 6.829
---------------
2023-09-12 07:42:00.492254
current #epochs=31, #steps=240
start validation
acc: 0.431818
AUC: 0.730716
Avg Precision: 0.413630
Avg Recall: 1.000000
d_prime: 0.869714
train_loss: 0.902050
valid_loss: 1.253433
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0009043837697445649
Epoch-31 lr: 0.0036175350789782595
epoch 31 training time: 6.277
---------------
2023-09-12 07:42:06.768975
current #epochs=32, #steps=248
start validation
acc: 0.522727
AUC: 0.739669
Avg Precision: 0.435242
Avg Recall: 1.000000
d_prime: 0.908387
train_loss: 0.875166
valid_loss: 1.242653
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0009043837697445649
Epoch-32 lr: 0.0036175350789782595
epoch 32 training time: 6.264
---------------
2023-09-12 07:42:13.033418
current #epochs=33, #steps=256
start validation
acc: 0.477273
AUC: 0.732094
Avg Precision: 0.430021
Avg Recall: 1.000000
d_prime: 0.875621
train_loss: 0.928228
valid_loss: 1.257181
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0009043837697445649
Epoch-33 lr: 0.0036175350789782595
epoch 33 training time: 6.872
---------------
2023-09-12 07:42:19.905388
current #epochs=34, #steps=264
start validation
acc: 0.431818
AUC: 0.733471
Avg Precision: 0.421656
Avg Recall: 1.000000
d_prime: 0.881543
train_loss: 0.945112
valid_loss: 1.257347
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0005880934451946112
Epoch-34 lr: 0.002352373780778445
epoch 34 training time: 6.311
---------------
2023-09-12 07:42:26.216340
current #epochs=35, #steps=272
start validation
acc: 0.409091
AUC: 0.730716
Avg Precision: 0.417252
Avg Recall: 1.000000
d_prime: 0.869714
train_loss: 0.942390
valid_loss: 1.259629
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0005880934451946112
Epoch-35 lr: 0.002352373780778445
epoch 35 training time: 6.198
---------------
2023-09-12 07:42:32.413764
current #epochs=36, #steps=280
start validation
acc: 0.477273
AUC: 0.732094
Avg Precision: 0.422234
Avg Recall: 1.000000
d_prime: 0.875621
train_loss: 0.924644
valid_loss: 1.253003
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0005880934451946112
Epoch-36 lr: 0.002352373780778445
epoch 36 training time: 6.411
---------------
2023-09-12 07:42:38.824740
current #epochs=37, #steps=288
start validation
acc: 0.522727
AUC: 0.734848
Avg Precision: 0.437974
Avg Recall: 1.000000
d_prime: 0.887481
train_loss: 0.894384
valid_loss: 1.243001
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0005880934451946112
Epoch-37 lr: 0.002352373780778445
epoch 37 training time: 6.261
---------------
2023-09-12 07:42:45.086326
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01159	Per Sample Data Time 0.00585	Per Sample DNN Time 0.00574	Train Loss 0.9173	
start validation
[I 2023-09-12 07:42:51,879] Trial 13 finished with value: 0.5227272727272727 and parameters: {'warmup': 'True', 'num_epochs': 38, 'batch_size': 64, 'lr-adaptschedule': 'False', 'lr': 0.0032890617161703785, 'head-lr': 4, 'lr-scheduler-start': 10, 'lr-scheduler-step': 8, 'lr-scheduler-decay': 0.6502697912864059}. Best is trial 13 with value: 0.5227272727272727.
acc: 0.477273
AUC: 0.736226
Avg Precision: 0.417598
Avg Recall: 1.000000
d_prime: 0.893434
train_loss: 0.901261
valid_loss: 1.243529
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0005880934451946112
Epoch-38 lr: 0.002352373780778445
epoch 38 training time: 6.788
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f956e06f730>
The learning rate scheduler starts at 10 epoch with decay rate of 0.643 every 8 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 07:42:51.909309
current #epochs=1, #steps=0
start validation
acc: 0.409091
AUC: 0.733471
Avg Precision: 0.358253
Avg Recall: 1.000000
d_prime: 0.881543
train_loss: 1.122228
valid_loss: 1.280538
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.00484589227848866
Epoch-1 lr: 0.01938356911395464
epoch 1 training time: 9.128
---------------
2023-09-12 07:43:01.037398
current #epochs=2, #steps=8
start validation
acc: 0.340909
AUC: 0.677686
Avg Precision: 0.323613
Avg Recall: 1.000000
d_prime: 0.652289
train_loss: 1.073295
valid_loss: 1.301555
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.00484589227848866
Epoch-2 lr: 0.01938356911395464
epoch 2 training time: 6.198
---------------
2023-09-12 07:43:07.235048
current #epochs=3, #steps=16
start validation
acc: 0.409091
AUC: 0.650826
Avg Precision: 0.365307
Avg Recall: 1.000000
d_prime: 0.548082
train_loss: 1.184276
valid_loss: 1.324261
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.00484589227848866
Epoch-3 lr: 0.01938356911395464
epoch 3 training time: 6.477
---------------
2023-09-12 07:43:13.712598
current #epochs=4, #steps=24
start validation
acc: 0.386364
AUC: 0.661846
Avg Precision: 0.365130
Avg Recall: 1.000000
d_prime: 0.590442
train_loss: 1.076219
valid_loss: 1.314275
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00484589227848866
Epoch-4 lr: 0.01938356911395464
epoch 4 training time: 6.220
---------------
2023-09-12 07:43:19.933007
current #epochs=5, #steps=32
start validation
acc: 0.409091
AUC: 0.687328
Avg Precision: 0.363124
Avg Recall: 1.000000
d_prime: 0.690547
train_loss: 1.037501
valid_loss: 1.273691
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00484589227848866
Epoch-5 lr: 0.01938356911395464
epoch 5 training time: 6.159
---------------
2023-09-12 07:43:26.091603
current #epochs=6, #steps=40
start validation
acc: 0.431818
AUC: 0.715565
Avg Precision: 0.383725
Avg Recall: 1.000000
d_prime: 0.805700
train_loss: 1.039113
valid_loss: 1.244639
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00484589227848866
Epoch-6 lr: 0.01938356911395464
epoch 6 training time: 10.933
---------------
2023-09-12 07:43:37.024405
current #epochs=7, #steps=48
start validation
acc: 0.409091
AUC: 0.689394
Avg Precision: 0.348249
Avg Recall: 1.000000
d_prime: 0.698810
train_loss: 0.999448
valid_loss: 1.278492
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00484589227848866
Epoch-7 lr: 0.01938356911395464
epoch 7 training time: 8.091
---------------
2023-09-12 07:43:45.115378
current #epochs=8, #steps=56
start validation
acc: 0.363636
AUC: 0.663912
Avg Precision: 0.303964
Avg Recall: 1.000000
d_prime: 0.598443
train_loss: 1.084883
valid_loss: 1.312438
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00484589227848866
Epoch-8 lr: 0.01938356911395464
epoch 8 training time: 6.365
---------------
2023-09-12 07:43:51.480709
current #epochs=9, #steps=64
start validation
acc: 0.477273
AUC: 0.706612
Avg Precision: 0.323258
Avg Recall: 1.000000
d_prime: 0.768643
train_loss: 1.037957
valid_loss: 1.309946
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00484589227848866
Epoch-9 lr: 0.01938356911395464
epoch 9 training time: 9.485
---------------
2023-09-12 07:44:00.966204
current #epochs=10, #steps=72
start validation
acc: 0.500000
AUC: 0.727273
Avg Precision: 0.327467
Avg Recall: 1.000000
d_prime: 0.855013
train_loss: 1.021334
valid_loss: 1.287933
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.003117374194935619
Epoch-10 lr: 0.012469496779742476
epoch 10 training time: 8.791
---------------
2023-09-12 07:44:09.757126
current #epochs=11, #steps=80
start validation
acc: 0.477273
AUC: 0.699725
Avg Precision: 0.326947
Avg Recall: 1.000000
d_prime: 0.740494
train_loss: 1.056780
valid_loss: 1.299289
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.003117374194935619
Epoch-11 lr: 0.012469496779742476
epoch 11 training time: 6.309
---------------
2023-09-12 07:44:16.066189
current #epochs=12, #steps=88
start validation
acc: 0.477273
AUC: 0.719697
Avg Precision: 0.337179
Avg Recall: 1.000000
d_prime: 0.822990
train_loss: 1.021118
valid_loss: 1.294009
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.003117374194935619
Epoch-12 lr: 0.012469496779742476
epoch 12 training time: 6.709
---------------
2023-09-12 07:44:22.775234
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01174	Per Sample Data Time 0.00617	Per Sample DNN Time 0.00558	Train Loss 0.9940	
start validation
acc: 0.409091
AUC: 0.733471
Avg Precision: 0.387326
Avg Recall: 1.000000
d_prime: 0.881543
train_loss: 0.991244
valid_loss: 1.279145
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.003117374194935619
Epoch-13 lr: 0.012469496779742476
epoch 13 training time: 7.324
---------------
2023-09-12 07:44:30.099133
current #epochs=14, #steps=104
start validation
acc: 0.454545
AUC: 0.738981
Avg Precision: 0.381562
Avg Recall: 1.000000
d_prime: 0.905388
train_loss: 0.922086
valid_loss: 1.267186
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.003117374194935619
Epoch-14 lr: 0.012469496779742476
epoch 14 training time: 6.243
---------------
2023-09-12 07:44:36.341948
current #epochs=15, #steps=112
start validation
acc: 0.500000
AUC: 0.730716
Avg Precision: 0.397222
Avg Recall: 1.000000
d_prime: 0.869714
train_loss: 0.942110
valid_loss: 1.255795
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.003117374194935619
Epoch-15 lr: 0.012469496779742476
epoch 15 training time: 8.092
---------------
2023-09-12 07:44:44.434194
current #epochs=16, #steps=120
start validation
acc: 0.431818
AUC: 0.715565
Avg Precision: 0.417109
Avg Recall: 1.000000
d_prime: 0.805700
train_loss: 0.915369
valid_loss: 1.254953
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.003117374194935619
Epoch-16 lr: 0.012469496779742476
epoch 16 training time: 6.312
---------------
2023-09-12 07:44:50.745524
current #epochs=17, #steps=128
start validation
acc: 0.500000
AUC: 0.735537
Avg Precision: 0.417252
Avg Recall: 1.000000
d_prime: 0.890455
train_loss: 0.935538
valid_loss: 1.252923
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.003117374194935619
Epoch-17 lr: 0.012469496779742476
epoch 17 training time: 6.155
---------------
2023-09-12 07:44:56.900825
current #epochs=18, #steps=136
start validation
acc: 0.363636
AUC: 0.743113
Avg Precision: 0.376414
Avg Recall: 1.000000
d_prime: 0.923442
train_loss: 0.951532
valid_loss: 1.288716
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.002005414341212174
Epoch-18 lr: 0.008021657364848696
epoch 18 training time: 6.175
---------------
2023-09-12 07:45:03.075676
current #epochs=19, #steps=144
start validation
acc: 0.431818
AUC: 0.716942
Avg Precision: 0.384335
Avg Recall: 1.000000
d_prime: 0.811450
train_loss: 1.023778
valid_loss: 1.273128
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.002005414341212174
Epoch-19 lr: 0.008021657364848696
epoch 19 training time: 6.316
---------------
2023-09-12 07:45:09.392069
current #epochs=20, #steps=152
start validation
acc: 0.477273
AUC: 0.712121
Avg Precision: 0.371824
Avg Recall: 1.000000
d_prime: 0.791383
train_loss: 0.986811
valid_loss: 1.263563
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.002005414341212174
Epoch-20 lr: 0.008021657364848696
epoch 20 training time: 6.256
---------------
2023-09-12 07:45:15.648295
current #epochs=21, #steps=160
start validation
acc: 0.431818
AUC: 0.747245
Avg Precision: 0.369366
Avg Recall: 1.000000
d_prime: 0.941648
train_loss: 0.899115
valid_loss: 1.266311
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.002005414341212174
Epoch-21 lr: 0.008021657364848696
epoch 21 training time: 6.227
---------------
2023-09-12 07:45:21.875163
current #epochs=22, #steps=168
start validation
acc: 0.431818
AUC: 0.709366
Avg Precision: 0.376071
Avg Recall: 1.000000
d_prime: 0.779988
train_loss: 0.908759
valid_loss: 1.257201
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.002005414341212174
Epoch-22 lr: 0.008021657364848696
epoch 22 training time: 6.284
---------------
2023-09-12 07:45:28.158765
current #epochs=23, #steps=176
start validation
acc: 0.500000
AUC: 0.730028
Avg Precision: 0.409450
Avg Recall: 1.000000
d_prime: 0.866766
train_loss: 0.951152
valid_loss: 1.262353
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.002005414341212174
Epoch-23 lr: 0.008021657364848696
epoch 23 training time: 6.239
---------------
2023-09-12 07:45:34.397478
current #epochs=24, #steps=184
start validation
acc: 0.522727
AUC: 0.708678
Avg Precision: 0.408416
Avg Recall: 1.000000
d_prime: 0.777147
train_loss: 0.920352
valid_loss: 1.250090
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.002005414341212174
Epoch-24 lr: 0.008021657364848696
epoch 24 training time: 9.951
---------------
2023-09-12 07:45:44.348357
current #epochs=25, #steps=192
start validation
acc: 0.568182
AUC: 0.723829
Avg Precision: 0.398457
Avg Recall: 1.000000
d_prime: 0.840403
train_loss: 0.929990
valid_loss: 1.237548
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.002005414341212174
Epoch-25 lr: 0.008021657364848696
epoch 25 training time: 9.700
---------------
2023-09-12 07:45:54.048076
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03709	Per Sample Data Time 0.02954	Per Sample DNN Time 0.00754	Train Loss 0.8109	
start validation
acc: 0.522727
AUC: 0.732782
Avg Precision: 0.386109
Avg Recall: 1.000000
d_prime: 0.878580
train_loss: 0.888205
valid_loss: 1.248435
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.001290087884371711
Epoch-26 lr: 0.005160351537486844
epoch 26 training time: 6.328
---------------
2023-09-12 07:46:00.375780
current #epochs=27, #steps=208
start validation
acc: 0.545455
AUC: 0.724518
Avg Precision: 0.383338
Avg Recall: 1.000000
d_prime: 0.843318
train_loss: 0.859700
valid_loss: 1.247502
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.001290087884371711
Epoch-27 lr: 0.005160351537486844
epoch 27 training time: 6.728
---------------
2023-09-12 07:46:07.103759
current #epochs=28, #steps=216
start validation
acc: 0.568182
AUC: 0.706612
Avg Precision: 0.376101
Avg Recall: 1.000000
d_prime: 0.768643
train_loss: 0.895287
valid_loss: 1.253949
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.001290087884371711
Epoch-28 lr: 0.005160351537486844
epoch 28 training time: 6.967
---------------
2023-09-12 07:46:14.070417
current #epochs=29, #steps=224
start validation
acc: 0.545455
AUC: 0.730028
Avg Precision: 0.370724
Avg Recall: 1.000000
d_prime: 0.866766
train_loss: 0.871954
valid_loss: 1.255384
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.001290087884371711
Epoch-29 lr: 0.005160351537486844
epoch 29 training time: 6.276
---------------
2023-09-12 07:46:20.345938
current #epochs=30, #steps=232
start validation
acc: 0.545455
AUC: 0.732094
Avg Precision: 0.362961
Avg Recall: 1.000000
d_prime: 0.875621
train_loss: 0.851610
valid_loss: 1.248790
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.001290087884371711
Epoch-30 lr: 0.005160351537486844
epoch 30 training time: 6.333
---------------
2023-09-12 07:46:26.678662
current #epochs=31, #steps=240
start validation
acc: 0.568182
AUC: 0.741736
Avg Precision: 0.358851
Avg Recall: 1.000000
d_prime: 0.917408
train_loss: 0.823707
valid_loss: 1.245697
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.001290087884371711
Epoch-31 lr: 0.005160351537486844
epoch 31 training time: 6.135
---------------
2023-09-12 07:46:32.813852
current #epochs=32, #steps=248
start validation
acc: 0.568182
AUC: 0.752755
Avg Precision: 0.393003
Avg Recall: 1.000000
d_prime: 0.966169
train_loss: 0.851236
valid_loss: 1.238289
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.001290087884371711
Epoch-32 lr: 0.005160351537486844
epoch 32 training time: 6.201
---------------
2023-09-12 07:46:39.014764
current #epochs=33, #steps=256
start validation
acc: 0.545455
AUC: 0.743802
Avg Precision: 0.393973
Avg Recall: 1.000000
d_prime: 0.926466
train_loss: 0.847095
valid_loss: 1.241544
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.001290087884371711
Epoch-33 lr: 0.005160351537486844
epoch 33 training time: 6.148
---------------
2023-09-12 07:46:45.162341
current #epochs=34, #steps=264
start validation
acc: 0.590909
AUC: 0.750689
Avg Precision: 0.366448
Avg Recall: 1.000000
d_prime: 0.956940
train_loss: 0.785001
valid_loss: 1.233341
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0008299166487443555
Epoch-34 lr: 0.003319666594977422
epoch 34 training time: 8.746
---------------
2023-09-12 07:46:53.907872
current #epochs=35, #steps=272
start validation
acc: 0.522727
AUC: 0.740358
Avg Precision: 0.382073
Avg Recall: 1.000000
d_prime: 0.911390
train_loss: 0.866936
valid_loss: 1.232672
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0008299166487443555
Epoch-35 lr: 0.003319666594977422
epoch 35 training time: 6.705
---------------
2023-09-12 07:47:00.612475
current #epochs=36, #steps=280
start validation
acc: 0.568182
AUC: 0.725895
Avg Precision: 0.392882
Avg Recall: 1.000000
d_prime: 0.849158
train_loss: 0.859966
valid_loss: 1.240388
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0008299166487443555
Epoch-36 lr: 0.003319666594977422
epoch 36 training time: 6.837
---------------
2023-09-12 07:47:07.449583
current #epochs=37, #steps=288
start validation
acc: 0.500000
AUC: 0.703168
Avg Precision: 0.397436
Avg Recall: 1.000000
d_prime: 0.754531
train_loss: 0.844400
valid_loss: 1.249246
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0008299166487443555
Epoch-37 lr: 0.003319666594977422
epoch 37 training time: 7.010
---------------
2023-09-12 07:47:14.459641
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01168	Per Sample Data Time 0.00592	Per Sample DNN Time 0.00575	Train Loss 0.8882	
start validation
[I 2023-09-12 07:47:20,690] Trial 14 finished with value: 0.5909090909090909 and parameters: {'warmup': 'True', 'num_epochs': 38, 'batch_size': 63, 'lr-adaptschedule': 'False', 'lr': 0.00484589227848866, 'head-lr': 4, 'lr-scheduler-start': 10, 'lr-scheduler-step': 8, 'lr-scheduler-decay': 0.6433024128030901}. Best is trial 14 with value: 0.5909090909090909.
acc: 0.545455
AUC: 0.723829
Avg Precision: 0.403067
Avg Recall: 1.000000
d_prime: 0.840403
train_loss: 0.845587
valid_loss: 1.246332
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0008299166487443555
Epoch-38 lr: 0.003319666594977422
epoch 38 training time: 6.226
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8e14c70>
The learning rate scheduler starts at 6 epoch with decay rate of 0.611 every 8 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 07:47:20.721013
current #epochs=1, #steps=0
start validation
acc: 0.340909
AUC: 0.651515
Avg Precision: 0.300457
Avg Recall: 1.000000
d_prime: 0.550715
train_loss: 1.308838
valid_loss: 1.349437
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0048291535368799815
Epoch-1 lr: 0.014487460610639945
epoch 1 training time: 9.037
---------------
2023-09-12 07:47:29.758756
current #epochs=2, #steps=8
start validation
acc: 0.500000
AUC: 0.692837
Avg Precision: 0.370564
Avg Recall: 1.000000
d_prime: 0.712635
train_loss: 1.225329
valid_loss: 1.302043
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0048291535368799815
Epoch-2 lr: 0.014487460610639945
epoch 2 training time: 9.955
---------------
2023-09-12 07:47:39.713289
current #epochs=3, #steps=16
start validation
acc: 0.409091
AUC: 0.686639
Avg Precision: 0.357961
Avg Recall: 1.000000
d_prime: 0.687797
train_loss: 1.135947
valid_loss: 1.307398
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0048291535368799815
Epoch-3 lr: 0.014487460610639945
epoch 3 training time: 6.283
---------------
2023-09-12 07:47:45.996596
current #epochs=4, #steps=24
start validation
acc: 0.363636
AUC: 0.682507
Avg Precision: 0.360262
Avg Recall: 1.000000
d_prime: 0.671356
train_loss: 1.087593
valid_loss: 1.306181
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0048291535368799815
Epoch-4 lr: 0.014487460610639945
epoch 4 training time: 6.905
---------------
2023-09-12 07:47:52.901536
current #epochs=5, #steps=32
start validation
acc: 0.431818
AUC: 0.711433
Avg Precision: 0.377475
Avg Recall: 1.000000
d_prime: 0.788529
train_loss: 1.043570
valid_loss: 1.275748
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0048291535368799815
Epoch-5 lr: 0.014487460610639945
epoch 5 training time: 6.197
---------------
2023-09-12 07:47:59.098915
current #epochs=6, #steps=40
start validation
acc: 0.477273
AUC: 0.721763
Avg Precision: 0.379786
Avg Recall: 1.000000
d_prime: 0.831681
train_loss: 0.982122
valid_loss: 1.272657
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0029484994422596935
Epoch-6 lr: 0.008845498326779081
epoch 6 training time: 7.474
---------------
2023-09-12 07:48:06.572996
current #epochs=7, #steps=48
start validation
acc: 0.409091
AUC: 0.730716
Avg Precision: 0.379762
Avg Recall: 1.000000
d_prime: 0.869714
train_loss: 0.936753
valid_loss: 1.250135
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0029484994422596935
Epoch-7 lr: 0.008845498326779081
epoch 7 training time: 6.164
---------------
2023-09-12 07:48:12.736906
current #epochs=8, #steps=56
start validation
acc: 0.477273
AUC: 0.729339
Avg Precision: 0.396308
Avg Recall: 1.000000
d_prime: 0.863822
train_loss: 0.958040
valid_loss: 1.270448
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0029484994422596935
Epoch-8 lr: 0.008845498326779081
epoch 8 training time: 6.409
---------------
2023-09-12 07:48:19.145903
current #epochs=9, #steps=64
start validation
acc: 0.409091
AUC: 0.724518
Avg Precision: 0.391709
Avg Recall: 1.000000
d_prime: 0.843318
train_loss: 0.925531
valid_loss: 1.270978
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0029484994422596935
Epoch-9 lr: 0.008845498326779081
epoch 9 training time: 6.208
---------------
2023-09-12 07:48:25.353323
current #epochs=10, #steps=72
start validation
acc: 0.522727
AUC: 0.719008
Avg Precision: 0.361225
Avg Recall: 1.000000
d_prime: 0.820099
train_loss: 0.913089
valid_loss: 1.267805
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0029484994422596935
Epoch-10 lr: 0.008845498326779081
epoch 10 training time: 8.837
---------------
2023-09-12 07:48:34.190612
current #epochs=11, #steps=80
start validation
acc: 0.386364
AUC: 0.704545
Avg Precision: 0.381269
Avg Recall: 1.000000
d_prime: 0.760167
train_loss: 0.863301
valid_loss: 1.288349
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0029484994422596935
Epoch-11 lr: 0.008845498326779081
epoch 11 training time: 6.819
---------------
2023-09-12 07:48:41.009966
current #epochs=12, #steps=88
start validation
acc: 0.500000
AUC: 0.693526
Avg Precision: 0.376204
Avg Recall: 1.000000
d_prime: 0.715409
train_loss: 0.915515
valid_loss: 1.281433
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0029484994422596935
Epoch-12 lr: 0.008845498326779081
epoch 12 training time: 6.186
---------------
2023-09-12 07:48:47.196182
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01148	Per Sample Data Time 0.00567	Per Sample DNN Time 0.00582	Train Loss 0.9570	
start validation
acc: 0.522727
AUC: 0.688705
Avg Precision: 0.380947
Avg Recall: 1.000000
d_prime: 0.696053
train_loss: 0.898308
valid_loss: 1.276772
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0029484994422596935
Epoch-13 lr: 0.008845498326779081
epoch 13 training time: 6.176
---------------
2023-09-12 07:48:53.372085
current #epochs=14, #steps=104
start validation
acc: 0.500000
AUC: 0.711433
Avg Precision: 0.388752
Avg Recall: 1.000000
d_prime: 0.788529
train_loss: 0.893945
valid_loss: 1.269892
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0018002428157673602
Epoch-14 lr: 0.005400728447302081
epoch 14 training time: 6.111
---------------
2023-09-12 07:48:59.482711
current #epochs=15, #steps=112
start validation
acc: 0.500000
AUC: 0.695592
Avg Precision: 0.357469
Avg Recall: 1.000000
d_prime: 0.723745
train_loss: 0.874789
valid_loss: 1.260709
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0018002428157673602
Epoch-15 lr: 0.005400728447302081
epoch 15 training time: 6.547
---------------
2023-09-12 07:49:06.029603
current #epochs=16, #steps=120
start validation
acc: 0.500000
AUC: 0.698347
Avg Precision: 0.389003
Avg Recall: 1.000000
d_prime: 0.734900
train_loss: 0.877768
valid_loss: 1.271110
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0018002428157673602
Epoch-16 lr: 0.005400728447302081
epoch 16 training time: 6.770
---------------
2023-09-12 07:49:12.799686
current #epochs=17, #steps=128
start validation
acc: 0.522727
AUC: 0.692149
Avg Precision: 0.358287
Avg Recall: 1.000000
d_prime: 0.709865
train_loss: 0.852934
valid_loss: 1.265861
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0018002428157673602
Epoch-17 lr: 0.005400728447302081
epoch 17 training time: 6.220
---------------
2023-09-12 07:49:19.019658
current #epochs=18, #steps=136
start validation
acc: 0.545455
AUC: 0.695592
Avg Precision: 0.347280
Avg Recall: 1.000000
d_prime: 0.723745
train_loss: 0.889889
valid_loss: 1.271674
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0018002428157673602
Epoch-18 lr: 0.005400728447302081
epoch 18 training time: 9.660
---------------
2023-09-12 07:49:28.680078
current #epochs=19, #steps=144
start validation
acc: 0.409091
AUC: 0.677686
Avg Precision: 0.361942
Avg Recall: 1.000000
d_prime: 0.652289
train_loss: 0.792414
valid_loss: 1.284695
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0018002428157673602
Epoch-19 lr: 0.005400728447302081
epoch 19 training time: 6.181
---------------
2023-09-12 07:49:34.861093
current #epochs=20, #steps=152
start validation
acc: 0.409091
AUC: 0.682507
Avg Precision: 0.367818
Avg Recall: 1.000000
d_prime: 0.671356
train_loss: 0.872836
valid_loss: 1.275472
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0018002428157673602
Epoch-20 lr: 0.005400728447302081
epoch 20 training time: 7.612
---------------
2023-09-12 07:49:42.472730
current #epochs=21, #steps=160
start validation
acc: 0.454545
AUC: 0.666667
Avg Precision: 0.342507
Avg Recall: 1.000000
d_prime: 0.609140
train_loss: 0.809066
valid_loss: 1.276473
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0018002428157673602
Epoch-21 lr: 0.005400728447302081
epoch 21 training time: 6.247
---------------
2023-09-12 07:49:48.720141
current #epochs=22, #steps=168
start validation
acc: 0.409091
AUC: 0.641873
Avg Precision: 0.349131
Avg Recall: 1.000000
d_prime: 0.514025
train_loss: 0.814588
valid_loss: 1.307339
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.001099160525273231
Epoch-22 lr: 0.0032974815758196933
epoch 22 training time: 7.272
---------------
2023-09-12 07:49:55.992450
current #epochs=23, #steps=176
start validation
acc: 0.477273
AUC: 0.664601
Avg Precision: 0.324538
Avg Recall: 1.000000
d_prime: 0.601114
train_loss: 0.803921
valid_loss: 1.293087
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.001099160525273231
Epoch-23 lr: 0.0032974815758196933
epoch 23 training time: 6.260
---------------
2023-09-12 07:50:02.252626
current #epochs=24, #steps=184
start validation
acc: 0.454545
AUC: 0.660468
Avg Precision: 0.337288
Avg Recall: 1.000000
d_prime: 0.585119
train_loss: 0.811666
valid_loss: 1.295269
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.001099160525273231
Epoch-24 lr: 0.0032974815758196933
epoch 24 training time: 6.439
---------------
2023-09-12 07:50:08.691608
current #epochs=25, #steps=192
start validation
acc: 0.477273
AUC: 0.678375
Avg Precision: 0.325901
Avg Recall: 1.000000
d_prime: 0.655005
train_loss: 0.770746
valid_loss: 1.288196
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.001099160525273231
Epoch-25 lr: 0.0032974815758196933
epoch 25 training time: 6.228
---------------
2023-09-12 07:50:14.919602
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03564	Per Sample Data Time 0.02992	Per Sample DNN Time 0.00572	Train Loss 0.8491	
start validation
acc: 0.454545
AUC: 0.678375
Avg Precision: 0.317579
Avg Recall: 1.000000
d_prime: 0.655005
train_loss: 0.769513
valid_loss: 1.288452
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.001099160525273231
Epoch-26 lr: 0.0032974815758196933
epoch 26 training time: 6.402
---------------
2023-09-12 07:50:21.321427
current #epochs=27, #steps=208
start validation
acc: 0.500000
AUC: 0.670110
Avg Precision: 0.309494
Avg Recall: 1.000000
d_prime: 0.622562
train_loss: 0.806110
valid_loss: 1.279373
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.001099160525273231
Epoch-27 lr: 0.0032974815758196933
epoch 27 training time: 6.511
---------------
2023-09-12 07:50:27.832395
current #epochs=28, #steps=216
start validation
acc: 0.477273
AUC: 0.668044
Avg Precision: 0.320106
Avg Recall: 1.000000
d_prime: 0.614502
train_loss: 0.807077
valid_loss: 1.284108
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.001099160525273231
Epoch-28 lr: 0.0032974815758196933
epoch 28 training time: 7.158
---------------
2023-09-12 07:50:34.990383
current #epochs=29, #steps=224
start validation
acc: 0.477273
AUC: 0.687328
Avg Precision: 0.300859
Avg Recall: 1.000000
d_prime: 0.690547
train_loss: 0.829834
valid_loss: 1.287588
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.001099160525273231
Epoch-29 lr: 0.0032974815758196933
epoch 29 training time: 6.220
---------------
2023-09-12 07:50:41.210597
current #epochs=30, #steps=232
start validation
acc: 0.568182
AUC: 0.694904
Avg Precision: 0.303836
Avg Recall: 1.000000
d_prime: 0.720964
train_loss: 0.782355
valid_loss: 1.277363
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0006711060584368698
Epoch-30 lr: 0.00201331817531061
epoch 30 training time: 11.432
---------------
2023-09-12 07:50:52.642380
current #epochs=31, #steps=240
start validation
acc: 0.522727
AUC: 0.682507
Avg Precision: 0.309453
Avg Recall: 1.000000
d_prime: 0.671356
train_loss: 0.752044
valid_loss: 1.281648
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0006711060584368698
Epoch-31 lr: 0.00201331817531061
epoch 31 training time: 6.184
---------------
2023-09-12 07:50:58.825920
current #epochs=32, #steps=248
start validation
acc: 0.500000
AUC: 0.683196
Avg Precision: 0.310549
Avg Recall: 1.000000
d_prime: 0.674090
train_loss: 0.752219
valid_loss: 1.278178
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0006711060584368698
Epoch-32 lr: 0.00201331817531061
epoch 32 training time: 6.760
---------------
2023-09-12 07:51:05.585601
current #epochs=33, #steps=256
start validation
acc: 0.522727
AUC: 0.690083
Avg Precision: 0.303477
Avg Recall: 1.000000
d_prime: 0.701570
train_loss: 0.749975
valid_loss: 1.272161
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0006711060584368698
Epoch-33 lr: 0.00201331817531061
epoch 33 training time: 7.103
---------------
2023-09-12 07:51:12.688688
current #epochs=34, #steps=264
start validation
acc: 0.522727
AUC: 0.694215
Avg Precision: 0.305792
Avg Recall: 1.000000
d_prime: 0.718185
train_loss: 0.680244
valid_loss: 1.272771
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0006711060584368698
Epoch-34 lr: 0.00201331817531061
epoch 34 training time: 6.320
---------------
2023-09-12 07:51:19.009351
current #epochs=35, #steps=272
start validation
acc: 0.568182
AUC: 0.694904
Avg Precision: 0.303836
Avg Recall: 1.000000
d_prime: 0.720964
train_loss: 0.715060
valid_loss: 1.268656
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0006711060584368698
Epoch-35 lr: 0.00201331817531061
epoch 35 training time: 6.269
---------------
2023-09-12 07:51:25.278594
current #epochs=36, #steps=280
start validation
acc: 0.568182
AUC: 0.694215
Avg Precision: 0.306333
Avg Recall: 1.000000
d_prime: 0.718185
train_loss: 0.653658
valid_loss: 1.267403
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0006711060584368698
Epoch-36 lr: 0.00201331817531061
epoch 36 training time: 6.416
---------------
2023-09-12 07:51:31.694562
current #epochs=37, #steps=288
start validation
acc: 0.568182
AUC: 0.696970
Avg Precision: 0.306333
Avg Recall: 1.000000
d_prime: 0.729317
train_loss: 0.740636
valid_loss: 1.263613
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0006711060584368698
Epoch-37 lr: 0.00201331817531061
epoch 37 training time: 6.470
---------------
2023-09-12 07:51:38.164297
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01153	Per Sample Data Time 0.00589	Per Sample DNN Time 0.00564	Train Loss 0.7408	
start validation
[I 2023-09-12 07:51:44,577] Trial 15 finished with value: 0.5681818181818182 and parameters: {'warmup': 'True', 'num_epochs': 38, 'batch_size': 57, 'lr-adaptschedule': 'False', 'lr': 0.0048291535368799815, 'head-lr': 3, 'lr-scheduler-start': 6, 'lr-scheduler-step': 8, 'lr-scheduler-decay': 0.6105623728345277}. Best is trial 14 with value: 0.5909090909090909.
acc: 0.568182
AUC: 0.702479
Avg Precision: 0.302924
Avg Recall: 1.000000
d_prime: 0.751718
train_loss: 0.733049
valid_loss: 1.261402
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0004097521074628425
Epoch-38 lr: 0.0012292563223885277
epoch 38 training time: 6.409
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8d715b0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.608 every 8 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 07:51:44.608926
current #epochs=1, #steps=0
start validation
acc: 0.454545
AUC: 0.702479
Avg Precision: 0.377457
Avg Recall: 1.000000
d_prime: 0.751718
train_loss: 1.230222
valid_loss: 1.310318
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.004818838274873415
Epoch-1 lr: 0.00963767654974683
epoch 1 training time: 9.388
---------------
2023-09-12 07:51:53.997434
current #epochs=2, #steps=8
start validation
acc: 0.386364
AUC: 0.734848
Avg Precision: 0.401168
Avg Recall: 1.000000
d_prime: 0.887481
train_loss: 1.085498
valid_loss: 1.291480
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.004818838274873415
Epoch-2 lr: 0.00963767654974683
epoch 2 training time: 6.379
---------------
2023-09-12 07:52:00.376264
current #epochs=3, #steps=16
start validation
acc: 0.318182
AUC: 0.656336
Avg Precision: 0.353916
Avg Recall: 1.000000
d_prime: 0.569198
train_loss: 0.994207
valid_loss: 1.297439
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.004818838274873415
Epoch-3 lr: 0.00963767654974683
epoch 3 training time: 6.107
---------------
2023-09-12 07:52:06.483682
current #epochs=4, #steps=24
start validation
acc: 0.454545
AUC: 0.729339
Avg Precision: 0.439816
Avg Recall: 1.000000
d_prime: 0.863822
train_loss: 1.015442
valid_loss: 1.262805
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.004818838274873415
Epoch-4 lr: 0.00963767654974683
epoch 4 training time: 6.316
---------------
2023-09-12 07:52:12.799590
current #epochs=5, #steps=32
start validation
acc: 0.500000
AUC: 0.729339
Avg Precision: 0.350801
Avg Recall: 1.000000
d_prime: 0.863822
train_loss: 0.946042
valid_loss: 1.270767
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.004818838274873415
Epoch-5 lr: 0.00963767654974683
epoch 5 training time: 9.623
---------------
2023-09-12 07:52:22.422226
current #epochs=6, #steps=40
start validation
acc: 0.431818
AUC: 0.717631
Avg Precision: 0.336444
Avg Recall: 1.000000
d_prime: 0.814329
train_loss: 0.936536
valid_loss: 1.278232
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002928355923559208
Epoch-6 lr: 0.005856711847118416
epoch 6 training time: 6.417
---------------
2023-09-12 07:52:28.838896
current #epochs=7, #steps=48
start validation
acc: 0.545455
AUC: 0.691460
Avg Precision: 0.320474
Avg Recall: 1.000000
d_prime: 0.707097
train_loss: 0.908599
valid_loss: 1.280318
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002928355923559208
Epoch-7 lr: 0.005856711847118416
epoch 7 training time: 10.030
---------------
2023-09-12 07:52:38.868578
current #epochs=8, #steps=56
start validation
acc: 0.500000
AUC: 0.705234
Avg Precision: 0.324656
Avg Recall: 1.000000
d_prime: 0.762989
train_loss: 0.936764
valid_loss: 1.270500
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.002928355923559208
Epoch-8 lr: 0.005856711847118416
epoch 8 training time: 6.384
---------------
2023-09-12 07:52:45.252524
current #epochs=9, #steps=64
start validation
acc: 0.454545
AUC: 0.699725
Avg Precision: 0.337463
Avg Recall: 1.000000
d_prime: 0.740494
train_loss: 0.910114
valid_loss: 1.269385
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.002928355923559208
Epoch-9 lr: 0.005856711847118416
epoch 9 training time: 6.352
---------------
2023-09-12 07:52:51.604484
current #epochs=10, #steps=72
start validation
acc: 0.431818
AUC: 0.712121
Avg Precision: 0.357937
Avg Recall: 1.000000
d_prime: 0.791383
train_loss: 0.862915
valid_loss: 1.275473
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.002928355923559208
Epoch-10 lr: 0.005856711847118416
epoch 10 training time: 6.392
---------------
2023-09-12 07:52:57.996020
current #epochs=11, #steps=80
start validation
acc: 0.522727
AUC: 0.706612
Avg Precision: 0.377842
Avg Recall: 1.000000
d_prime: 0.768643
train_loss: 0.881446
valid_loss: 1.264007
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.002928355923559208
Epoch-11 lr: 0.005856711847118416
epoch 11 training time: 7.976
---------------
2023-09-12 07:53:05.972306
current #epochs=12, #steps=88
start validation
acc: 0.545455
AUC: 0.694904
Avg Precision: 0.371692
Avg Recall: 1.000000
d_prime: 0.720964
train_loss: 0.859842
valid_loss: 1.263040
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.002928355923559208
Epoch-12 lr: 0.005856711847118416
epoch 12 training time: 6.517
---------------
2023-09-12 07:53:12.489392
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01159	Per Sample Data Time 0.00600	Per Sample DNN Time 0.00559	Train Loss 0.8401	
start validation
acc: 0.522727
AUC: 0.696970
Avg Precision: 0.345619
Avg Recall: 1.000000
d_prime: 0.729317
train_loss: 0.829125
valid_loss: 1.263934
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.002928355923559208
Epoch-13 lr: 0.005856711847118416
epoch 13 training time: 7.466
---------------
2023-09-12 07:53:19.955640
current #epochs=14, #steps=104
start validation
acc: 0.568182
AUC: 0.711433
Avg Precision: 0.343914
Avg Recall: 1.000000
d_prime: 0.788529
train_loss: 0.779536
valid_loss: 1.249581
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.001779530236521491
Epoch-14 lr: 0.003559060473042982
epoch 14 training time: 9.428
---------------
2023-09-12 07:53:29.383238
current #epochs=15, #steps=112
start validation
acc: 0.386364
AUC: 0.691460
Avg Precision: 0.322169
Avg Recall: 1.000000
d_prime: 0.707097
train_loss: 0.766281
valid_loss: 1.286635
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.001779530236521491
Epoch-15 lr: 0.003559060473042982
epoch 15 training time: 6.615
---------------
2023-09-12 07:53:35.998275
current #epochs=16, #steps=120
start validation
acc: 0.545455
AUC: 0.707300
Avg Precision: 0.328029
Avg Recall: 1.000000
d_prime: 0.771475
train_loss: 0.837778
valid_loss: 1.248087
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.001779530236521491
Epoch-16 lr: 0.003559060473042982
epoch 16 training time: 8.029
---------------
2023-09-12 07:53:44.026932
current #epochs=17, #steps=128
start validation
acc: 0.590909
AUC: 0.701102
Avg Precision: 0.347689
Avg Recall: 1.000000
d_prime: 0.746100
train_loss: 0.808705
valid_loss: 1.246630
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.001779530236521491
Epoch-17 lr: 0.003559060473042982
epoch 17 training time: 10.758
---------------
2023-09-12 07:53:54.785410
current #epochs=18, #steps=136
start validation
acc: 0.568182
AUC: 0.712810
Avg Precision: 0.333610
Avg Recall: 1.000000
d_prime: 0.794240
train_loss: 0.750826
valid_loss: 1.252963
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001779530236521491
Epoch-18 lr: 0.003559060473042982
epoch 18 training time: 6.395
---------------
2023-09-12 07:54:01.181038
current #epochs=19, #steps=144
start validation
acc: 0.500000
AUC: 0.711433
Avg Precision: 0.334232
Avg Recall: 1.000000
d_prime: 0.788529
train_loss: 0.799462
valid_loss: 1.260026
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.001779530236521491
Epoch-19 lr: 0.003559060473042982
epoch 19 training time: 6.597
---------------
2023-09-12 07:54:07.777840
current #epochs=20, #steps=152
start validation
acc: 0.454545
AUC: 0.696970
Avg Precision: 0.334193
Avg Recall: 1.000000
d_prime: 0.729317
train_loss: 0.715653
valid_loss: 1.263279
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.001779530236521491
Epoch-20 lr: 0.003559060473042982
epoch 20 training time: 6.423
---------------
2023-09-12 07:54:14.201158
current #epochs=21, #steps=160
start validation
acc: 0.454545
AUC: 0.696281
Avg Precision: 0.354960
Avg Recall: 1.000000
d_prime: 0.726530
train_loss: 0.779658
valid_loss: 1.260290
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.001779530236521491
Epoch-21 lr: 0.003559060473042982
epoch 21 training time: 6.526
---------------
2023-09-12 07:54:20.727244
current #epochs=22, #steps=168
start validation
acc: 0.522727
AUC: 0.692149
Avg Precision: 0.332778
Avg Recall: 1.000000
d_prime: 0.709865
train_loss: 0.703581
valid_loss: 1.257176
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0010814012863727652
Epoch-22 lr: 0.0021628025727455304
epoch 22 training time: 6.378
---------------
2023-09-12 07:54:27.104993
current #epochs=23, #steps=176
start validation
acc: 0.522727
AUC: 0.728650
Avg Precision: 0.363557
Avg Recall: 1.000000
d_prime: 0.860882
train_loss: 0.813124
valid_loss: 1.251290
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0010814012863727652
Epoch-23 lr: 0.0021628025727455304
epoch 23 training time: 7.433
---------------
2023-09-12 07:54:34.538326
current #epochs=24, #steps=184
start validation
acc: 0.477273
AUC: 0.736915
Avg Precision: 0.369377
Avg Recall: 1.000000
d_prime: 0.896416
train_loss: 0.809675
valid_loss: 1.255687
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0010814012863727652
Epoch-24 lr: 0.0021628025727455304
epoch 24 training time: 6.274
---------------
2023-09-12 07:54:40.812859
current #epochs=25, #steps=192
start validation
acc: 0.545455
AUC: 0.731405
Avg Precision: 0.375790
Avg Recall: 1.000000
d_prime: 0.872665
train_loss: 0.797162
valid_loss: 1.248852
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0010814012863727652
Epoch-25 lr: 0.0021628025727455304
epoch 25 training time: 7.153
---------------
2023-09-12 07:54:47.965208
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03567	Per Sample Data Time 0.02969	Per Sample DNN Time 0.00598	Train Loss 0.6642	
start validation
acc: 0.500000
AUC: 0.699725
Avg Precision: 0.345846
Avg Recall: 1.000000
d_prime: 0.740494
train_loss: 0.734040
valid_loss: 1.261022
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0010814012863727652
Epoch-26 lr: 0.0021628025727455304
epoch 26 training time: 6.489
---------------
2023-09-12 07:54:54.454916
current #epochs=27, #steps=208
start validation
acc: 0.500000
AUC: 0.692149
Avg Precision: 0.352393
Avg Recall: 1.000000
d_prime: 0.709865
train_loss: 0.778220
valid_loss: 1.258258
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0010814012863727652
Epoch-27 lr: 0.0021628025727455304
epoch 27 training time: 6.204
---------------
2023-09-12 07:55:00.659345
current #epochs=28, #steps=216
start validation
acc: 0.522727
AUC: 0.701791
Avg Precision: 0.369627
Avg Recall: 1.000000
d_prime: 0.748907
train_loss: 0.778629
valid_loss: 1.247929
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0010814012863727652
Epoch-28 lr: 0.0021628025727455304
epoch 28 training time: 7.510
---------------
2023-09-12 07:55:08.169358
current #epochs=29, #steps=224
start validation
acc: 0.477273
AUC: 0.696281
Avg Precision: 0.356414
Avg Recall: 1.000000
d_prime: 0.726530
train_loss: 0.745899
valid_loss: 1.255242
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0010814012863727652
Epoch-29 lr: 0.0021628025727455304
epoch 29 training time: 6.443
---------------
2023-09-12 07:55:14.611898
current #epochs=30, #steps=232
start validation
acc: 0.500000
AUC: 0.714876
Avg Precision: 0.373199
Avg Recall: 1.000000
d_prime: 0.802830
train_loss: 0.747201
valid_loss: 1.244094
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0006571558707845244
Epoch-30 lr: 0.0013143117415690489
epoch 30 training time: 6.361
---------------
2023-09-12 07:55:20.973332
current #epochs=31, #steps=240
start validation
acc: 0.568182
AUC: 0.710055
Avg Precision: 0.363358
Avg Recall: 1.000000
d_prime: 0.782832
train_loss: 0.728867
valid_loss: 1.240784
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0006571558707845244
Epoch-31 lr: 0.0013143117415690489
epoch 31 training time: 6.458
---------------
2023-09-12 07:55:27.431203
current #epochs=32, #steps=248
start validation
acc: 0.568182
AUC: 0.706612
Avg Precision: 0.354360
Avg Recall: 1.000000
d_prime: 0.768643
train_loss: 0.680245
valid_loss: 1.244886
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0006571558707845244
Epoch-32 lr: 0.0013143117415690489
epoch 32 training time: 6.244
---------------
2023-09-12 07:55:33.675302
current #epochs=33, #steps=256
start validation
acc: 0.545455
AUC: 0.701102
Avg Precision: 0.341731
Avg Recall: 1.000000
d_prime: 0.746100
train_loss: 0.714127
valid_loss: 1.246487
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0006571558707845244
Epoch-33 lr: 0.0013143117415690489
epoch 33 training time: 6.157
---------------
2023-09-12 07:55:39.832303
current #epochs=34, #steps=264
start validation
acc: 0.545455
AUC: 0.699725
Avg Precision: 0.338479
Avg Recall: 1.000000
d_prime: 0.740494
train_loss: 0.713730
valid_loss: 1.250603
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0006571558707845244
Epoch-34 lr: 0.0013143117415690489
epoch 34 training time: 6.327
---------------
2023-09-12 07:55:46.158958
current #epochs=35, #steps=272
start validation
[I 2023-09-12 07:55:52,443] Trial 16 finished with value: 0.5909090909090909 and parameters: {'warmup': 'True', 'num_epochs': 35, 'batch_size': 8, 'lr-adaptschedule': 'False', 'lr': 0.004818838274873415, 'head-lr': 2, 'lr-scheduler-start': 6, 'lr-scheduler-step': 8, 'lr-scheduler-decay': 0.6076891890786961}. Best is trial 14 with value: 0.5909090909090909.
acc: 0.522727
AUC: 0.695592
Avg Precision: 0.347802
Avg Recall: 1.000000
d_prime: 0.723745
train_loss: 0.663107
valid_loss: 1.259682
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0006571558707845244
Epoch-35 lr: 0.0013143117415690489
epoch 35 training time: 6.280
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c859b8e0>
The learning rate scheduler starts at 3 epoch with decay rate of 0.657 every 7 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 07:55:52.473881
current #epochs=1, #steps=0
start validation
acc: 0.477273
AUC: 0.703857
Avg Precision: 0.333460
Avg Recall: 1.000000
d_prime: 0.757347
train_loss: 1.075408
valid_loss: 1.288243
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0048406274779586225
Epoch-1 lr: 0.009681254955917245
epoch 1 training time: 9.688
---------------
2023-09-12 07:56:02.162253
current #epochs=2, #steps=8
start validation
acc: 0.340909
AUC: 0.712810
Avg Precision: 0.371216
Avg Recall: 1.000000
d_prime: 0.794240
train_loss: 1.027122
valid_loss: 1.277899
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0048406274779586225
Epoch-2 lr: 0.009681254955917245
epoch 2 training time: 6.346
---------------
2023-09-12 07:56:08.508305
current #epochs=3, #steps=16
start validation
acc: 0.454545
AUC: 0.759642
Avg Precision: 0.437599
Avg Recall: 1.000000
d_prime: 0.997234
train_loss: 0.968013
valid_loss: 1.252280
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0031795145077858893
Epoch-3 lr: 0.006359029015571779
epoch 3 training time: 7.043
---------------
2023-09-12 07:56:15.550740
current #epochs=4, #steps=24
start validation
acc: 0.454545
AUC: 0.743802
Avg Precision: 0.409399
Avg Recall: 1.000000
d_prime: 0.926466
train_loss: 0.914369
valid_loss: 1.284154
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0031795145077858893
Epoch-4 lr: 0.006359029015571779
epoch 4 training time: 6.457
---------------
2023-09-12 07:56:22.007351
current #epochs=5, #steps=32
start validation
acc: 0.409091
AUC: 0.726584
Avg Precision: 0.369382
Avg Recall: 1.000000
d_prime: 0.852084
train_loss: 0.915831
valid_loss: 1.277065
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0031795145077858893
Epoch-5 lr: 0.006359029015571779
epoch 5 training time: 6.470
---------------
2023-09-12 07:56:28.477735
current #epochs=6, #steps=40
start validation
acc: 0.500000
AUC: 0.734160
Avg Precision: 0.385417
Avg Recall: 1.000000
d_prime: 0.884510
train_loss: 0.859369
valid_loss: 1.247305
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0031795145077858893
Epoch-6 lr: 0.006359029015571779
epoch 6 training time: 9.005
---------------
2023-09-12 07:56:37.482932
current #epochs=7, #steps=48
start validation
acc: 0.477273
AUC: 0.706612
Avg Precision: 0.356918
Avg Recall: 1.000000
d_prime: 0.768643
train_loss: 0.867973
valid_loss: 1.264182
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0031795145077858893
Epoch-7 lr: 0.006359029015571779
epoch 7 training time: 7.831
---------------
2023-09-12 07:56:45.313356
current #epochs=8, #steps=56
start validation
acc: 0.500000
AUC: 0.709366
Avg Precision: 0.339208
Avg Recall: 1.000000
d_prime: 0.779988
train_loss: 0.837050
valid_loss: 1.254785
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0031795145077858893
Epoch-8 lr: 0.006359029015571779
epoch 8 training time: 6.358
---------------
2023-09-12 07:56:51.671335
current #epochs=9, #steps=64
start validation
acc: 0.522727
AUC: 0.716942
Avg Precision: 0.345039
Avg Recall: 1.000000
d_prime: 0.811450
train_loss: 0.821339
valid_loss: 1.252022
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0031795145077858893
Epoch-9 lr: 0.006359029015571779
epoch 9 training time: 9.050
---------------
2023-09-12 07:57:00.721228
current #epochs=10, #steps=72
start validation
acc: 0.477273
AUC: 0.698347
Avg Precision: 0.348958
Avg Recall: 1.000000
d_prime: 0.734900
train_loss: 0.749226
valid_loss: 1.264283
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0020884301779578833
Epoch-10 lr: 0.004176860355915767
epoch 10 training time: 6.143
---------------
2023-09-12 07:57:06.864213
current #epochs=11, #steps=80
start validation
acc: 0.522727
AUC: 0.709366
Avg Precision: 0.338999
Avg Recall: 1.000000
d_prime: 0.779988
train_loss: 0.744196
valid_loss: 1.244735
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0020884301779578833
Epoch-11 lr: 0.004176860355915767
epoch 11 training time: 7.326
---------------
2023-09-12 07:57:14.189947
current #epochs=12, #steps=88
start validation
acc: 0.522727
AUC: 0.698347
Avg Precision: 0.321543
Avg Recall: 1.000000
d_prime: 0.734900
train_loss: 0.736124
valid_loss: 1.251445
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0020884301779578833
Epoch-12 lr: 0.004176860355915767
epoch 12 training time: 6.348
---------------
2023-09-12 07:57:20.537802
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01133	Per Sample Data Time 0.00587	Per Sample DNN Time 0.00546	Train Loss 0.7352	
start validation
acc: 0.500000
AUC: 0.700413
Avg Precision: 0.313620
Avg Recall: 1.000000
d_prime: 0.743296
train_loss: 0.750915
valid_loss: 1.258860
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0020884301779578833
Epoch-13 lr: 0.004176860355915767
epoch 13 training time: 6.687
---------------
2023-09-12 07:57:27.224283
current #epochs=14, #steps=104
start validation
acc: 0.522727
AUC: 0.708678
Avg Precision: 0.310202
Avg Recall: 1.000000
d_prime: 0.777147
train_loss: 0.633325
valid_loss: 1.242603
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0020884301779578833
Epoch-14 lr: 0.004176860355915767
epoch 14 training time: 6.437
---------------
2023-09-12 07:57:33.661650
current #epochs=15, #steps=112
start validation
acc: 0.545455
AUC: 0.714187
Avg Precision: 0.307891
Avg Recall: 1.000000
d_prime: 0.799963
train_loss: 0.691627
valid_loss: 1.239640
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0020884301779578833
Epoch-15 lr: 0.004176860355915767
epoch 15 training time: 8.991
---------------
2023-09-12 07:57:42.652808
current #epochs=16, #steps=120
start validation
acc: 0.500000
AUC: 0.714187
Avg Precision: 0.306944
Avg Recall: 1.000000
d_prime: 0.799963
train_loss: 0.691338
valid_loss: 1.246575
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0020884301779578833
Epoch-16 lr: 0.004176860355915767
epoch 16 training time: 6.538
---------------
2023-09-12 07:57:49.190929
current #epochs=17, #steps=128
start validation
acc: 0.568182
AUC: 0.725207
Avg Precision: 0.311472
Avg Recall: 1.000000
d_prime: 0.846236
train_loss: 0.674736
valid_loss: 1.233483
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.001371763078144415
Epoch-17 lr: 0.00274352615628883
epoch 17 training time: 9.663
---------------
2023-09-12 07:57:58.854249
current #epochs=18, #steps=136
start validation
acc: 0.477273
AUC: 0.719697
Avg Precision: 0.319265
Avg Recall: 1.000000
d_prime: 0.822990
train_loss: 0.678876
valid_loss: 1.237215
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001371763078144415
Epoch-18 lr: 0.00274352615628883
epoch 18 training time: 6.356
---------------
2023-09-12 07:58:05.210123
current #epochs=19, #steps=144
start validation
acc: 0.545455
AUC: 0.712810
Avg Precision: 0.323290
Avg Recall: 1.000000
d_prime: 0.794240
train_loss: 0.829960
valid_loss: 1.259763
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.001371763078144415
Epoch-19 lr: 0.00274352615628883
epoch 19 training time: 7.786
---------------
2023-09-12 07:58:12.996598
current #epochs=20, #steps=152
start validation
acc: 0.522727
AUC: 0.717631
Avg Precision: 0.339534
Avg Recall: 1.000000
d_prime: 0.814329
train_loss: 0.760887
valid_loss: 1.258856
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.001371763078144415
Epoch-20 lr: 0.00274352615628883
epoch 20 training time: 6.448
---------------
2023-09-12 07:58:19.444509
current #epochs=21, #steps=160
start validation
acc: 0.590909
AUC: 0.732094
Avg Precision: 0.340790
Avg Recall: 1.000000
d_prime: 0.875621
train_loss: 0.807216
valid_loss: 1.248841
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.001371763078144415
Epoch-21 lr: 0.00274352615628883
epoch 21 training time: 9.012
---------------
2023-09-12 07:58:28.456867
current #epochs=22, #steps=168
start validation
acc: 0.590909
AUC: 0.732094
Avg Precision: 0.334355
Avg Recall: 1.000000
d_prime: 0.875621
train_loss: 0.762996
valid_loss: 1.245429
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.001371763078144415
Epoch-22 lr: 0.00274352615628883
epoch 22 training time: 6.539
---------------
2023-09-12 07:58:34.995945
current #epochs=23, #steps=176
start validation
acc: 0.545455
AUC: 0.732094
Avg Precision: 0.327460
Avg Recall: 1.000000
d_prime: 0.875621
train_loss: 0.704133
valid_loss: 1.236567
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.001371763078144415
Epoch-23 lr: 0.00274352615628883
epoch 23 training time: 6.246
---------------
2023-09-12 07:58:41.242205
current #epochs=24, #steps=184
start validation
acc: 0.590909
AUC: 0.738292
Avg Precision: 0.323230
Avg Recall: 1.000000
d_prime: 0.902394
train_loss: 0.686328
valid_loss: 1.229798
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0009010279407091525
Epoch-24 lr: 0.001802055881418305
epoch 24 training time: 6.378
---------------
2023-09-12 07:58:47.620018
current #epochs=25, #steps=192
start validation
acc: 0.545455
AUC: 0.725207
Avg Precision: 0.320766
Avg Recall: 1.000000
d_prime: 0.846236
train_loss: 0.699877
valid_loss: 1.235766
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0009010279407091525
Epoch-25 lr: 0.001802055881418305
epoch 25 training time: 6.571
---------------
2023-09-12 07:58:54.191392
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03438	Per Sample Data Time 0.02882	Per Sample DNN Time 0.00556	Train Loss 0.6117	
start validation
acc: 0.522727
AUC: 0.723140
Avg Precision: 0.314946
Avg Recall: 1.000000
d_prime: 0.837492
train_loss: 0.702299
valid_loss: 1.247935
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0009010279407091525
Epoch-26 lr: 0.001802055881418305
epoch 26 training time: 6.328
---------------
2023-09-12 07:59:00.519768
current #epochs=27, #steps=208
start validation
acc: 0.522727
AUC: 0.729339
Avg Precision: 0.310176
Avg Recall: 1.000000
d_prime: 0.863822
train_loss: 0.648203
valid_loss: 1.244854
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0009010279407091525
Epoch-27 lr: 0.001802055881418305
epoch 27 training time: 6.920
---------------
2023-09-12 07:59:07.440371
current #epochs=28, #steps=216
start validation
acc: 0.522727
AUC: 0.724518
Avg Precision: 0.305562
Avg Recall: 1.000000
d_prime: 0.843318
train_loss: 0.672272
valid_loss: 1.242986
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0009010279407091525
Epoch-28 lr: 0.001802055881418305
epoch 28 training time: 6.258
---------------
2023-09-12 07:59:13.698457
current #epochs=29, #steps=224
start validation
acc: 0.545455
AUC: 0.714876
Avg Precision: 0.293576
Avg Recall: 1.000000
d_prime: 0.802830
train_loss: 0.598485
valid_loss: 1.245423
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0009010279407091525
Epoch-29 lr: 0.001802055881418305
epoch 29 training time: 6.513
---------------
2023-09-12 07:59:20.211696
current #epochs=30, #steps=232
start validation
acc: 0.545455
AUC: 0.723829
Avg Precision: 0.293155
Avg Recall: 1.000000
d_prime: 0.840403
train_loss: 0.611534
valid_loss: 1.241692
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0009010279407091525
Epoch-30 lr: 0.001802055881418305
epoch 30 training time: 6.343
---------------
2023-09-12 07:59:26.554671
current #epochs=31, #steps=240
start validation
acc: 0.590909
AUC: 0.726584
Avg Precision: 0.290972
Avg Recall: 1.000000
d_prime: 0.852084
train_loss: 0.614138
valid_loss: 1.232816
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0005918305885858716
Epoch-31 lr: 0.0011836611771717431
epoch 31 training time: 6.372
---------------
2023-09-12 07:59:32.927387
current #epochs=32, #steps=248
start validation
acc: 0.590909
AUC: 0.727961
Avg Precision: 0.290972
Avg Recall: 1.000000
d_prime: 0.857946
train_loss: 0.634351
valid_loss: 1.230950
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0005918305885858716
Epoch-32 lr: 0.0011836611771717431
epoch 32 training time: 6.206
---------------
2023-09-12 07:59:39.133630
current #epochs=33, #steps=256
start validation
[I 2023-09-12 07:59:46,487] Trial 17 finished with value: 0.5909090909090909 and parameters: {'warmup': 'True', 'num_epochs': 33, 'batch_size': 8, 'lr-adaptschedule': 'False', 'lr': 0.0048406274779586225, 'head-lr': 2, 'lr-scheduler-start': 3, 'lr-scheduler-step': 7, 'lr-scheduler-decay': 0.6568393296661503}. Best is trial 14 with value: 0.5909090909090909.
acc: 0.590909
AUC: 0.737603
Avg Precision: 0.292735
Avg Recall: 1.000000
d_prime: 0.899403
train_loss: 0.624344
valid_loss: 1.232140
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0005918305885858716
Epoch-33 lr: 0.0011836611771717431
epoch 33 training time: 7.349
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95bc7a7f10>
The learning rate scheduler starts at 6 epoch with decay rate of 0.604 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 07:59:46.518281
current #epochs=1, #steps=0
start validation
acc: 0.340909
AUC: 0.669421
Avg Precision: 0.297762
Avg Recall: 1.000000
d_prime: 0.619873
train_loss: 0.989856
valid_loss: 1.299828
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.004829520785473158
Epoch-1 lr: 0.009659041570946316
epoch 1 training time: 9.231
---------------
2023-09-12 07:59:55.749696
current #epochs=2, #steps=8
start validation
acc: 0.431818
AUC: 0.701102
Avg Precision: 0.312152
Avg Recall: 1.000000
d_prime: 0.746100
train_loss: 1.086161
valid_loss: 1.304228
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.004829520785473158
Epoch-2 lr: 0.009659041570946316
epoch 2 training time: 9.782
---------------
2023-09-12 08:00:05.532121
current #epochs=3, #steps=16
start validation
acc: 0.431818
AUC: 0.723829
Avg Precision: 0.340773
Avg Recall: 1.000000
d_prime: 0.840403
train_loss: 0.944388
valid_loss: 1.253375
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.004829520785473158
Epoch-3 lr: 0.009659041570946316
epoch 3 training time: 6.522
---------------
2023-09-12 08:00:12.054270
current #epochs=4, #steps=24
start validation
acc: 0.522727
AUC: 0.748623
Avg Precision: 0.399252
Avg Recall: 1.000000
d_prime: 0.947752
train_loss: 0.878793
valid_loss: 1.246410
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.004829520785473158
Epoch-4 lr: 0.009659041570946316
epoch 4 training time: 9.098
---------------
2023-09-12 08:00:21.152542
current #epochs=5, #steps=32
start validation
acc: 0.613636
AUC: 0.746556
Avg Precision: 0.368452
Avg Recall: 1.000000
d_prime: 0.938603
train_loss: 0.798437
valid_loss: 1.221543
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.004829520785473158
Epoch-5 lr: 0.009659041570946316
epoch 5 training time: 9.036
---------------
2023-09-12 08:00:30.188917
current #epochs=6, #steps=40
start validation
acc: 0.522727
AUC: 0.746556
Avg Precision: 0.360022
Avg Recall: 1.000000
d_prime: 0.938603
train_loss: 0.816694
valid_loss: 1.221287
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0029162836617967623
Epoch-6 lr: 0.005832567323593525
epoch 6 training time: 6.670
---------------
2023-09-12 08:00:36.859076
current #epochs=7, #steps=48
start validation
acc: 0.522727
AUC: 0.716942
Avg Precision: 0.314775
Avg Recall: 1.000000
d_prime: 0.811450
train_loss: 0.755539
valid_loss: 1.244016
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0029162836617967623
Epoch-7 lr: 0.005832567323593525
epoch 7 training time: 7.553
---------------
2023-09-12 08:00:44.411728
current #epochs=8, #steps=56
start validation
acc: 0.500000
AUC: 0.740358
Avg Precision: 0.330830
Avg Recall: 1.000000
d_prime: 0.911390
train_loss: 0.771899
valid_loss: 1.227954
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0029162836617967623
Epoch-8 lr: 0.005832567323593525
epoch 8 training time: 6.299
---------------
2023-09-12 08:00:50.710195
current #epochs=9, #steps=64
start validation
acc: 0.545455
AUC: 0.741736
Avg Precision: 0.352177
Avg Recall: 1.000000
d_prime: 0.917408
train_loss: 0.783389
valid_loss: 1.223836
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0029162836617967623
Epoch-9 lr: 0.005832567323593525
epoch 9 training time: 6.311
---------------
2023-09-12 08:00:57.021605
current #epochs=10, #steps=72
start validation
acc: 0.568182
AUC: 0.747934
Avg Precision: 0.414568
Avg Recall: 1.000000
d_prime: 0.944698
train_loss: 0.730592
valid_loss: 1.211982
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0029162836617967623
Epoch-10 lr: 0.005832567323593525
epoch 10 training time: 6.561
---------------
2023-09-12 08:01:03.582452
current #epochs=11, #steps=80
start validation
acc: 0.545455
AUC: 0.752755
Avg Precision: 0.450095
Avg Recall: 1.000000
d_prime: 0.966169
train_loss: 0.712883
valid_loss: 1.210177
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0029162836617967623
Epoch-11 lr: 0.005832567323593525
epoch 11 training time: 6.877
---------------
2023-09-12 08:01:10.459633
current #epochs=12, #steps=88
start validation
acc: 0.522727
AUC: 0.751377
Avg Precision: 0.407162
Avg Recall: 1.000000
d_prime: 0.960011
train_loss: 0.727621
valid_loss: 1.213714
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0029162836617967623
Epoch-12 lr: 0.005832567323593525
epoch 12 training time: 6.290
---------------
2023-09-12 08:01:16.750347
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01181	Per Sample Data Time 0.00600	Per Sample DNN Time 0.00580	Train Loss 0.7540	
start validation
acc: 0.613636
AUC: 0.740358
Avg Precision: 0.357177
Avg Recall: 1.000000
d_prime: 0.911390
train_loss: 0.779115
valid_loss: 1.225085
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0029162836617967623
Epoch-13 lr: 0.005832567323593525
epoch 13 training time: 6.463
---------------
2023-09-12 08:01:23.213104
current #epochs=14, #steps=104
start validation
acc: 0.500000
AUC: 0.742424
Avg Precision: 0.341467
Avg Recall: 1.000000
d_prime: 0.920423
train_loss: 0.691836
valid_loss: 1.226709
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0029162836617967623
Epoch-14 lr: 0.005832567323593525
epoch 14 training time: 6.363
---------------
2023-09-12 08:01:29.576383
current #epochs=15, #steps=112
start validation
acc: 0.545455
AUC: 0.723829
Avg Precision: 0.317050
Avg Recall: 1.000000
d_prime: 0.840403
train_loss: 0.676715
valid_loss: 1.234857
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0017609843240853778
Epoch-15 lr: 0.0035219686481707557
epoch 15 training time: 7.809
---------------
2023-09-12 08:01:37.385768
current #epochs=16, #steps=120
start validation
acc: 0.636364
AUC: 0.751377
Avg Precision: 0.357512
Avg Recall: 1.000000
d_prime: 0.960011
train_loss: 0.667983
valid_loss: 1.212751
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0017609843240853778
Epoch-16 lr: 0.0035219686481707557
epoch 16 training time: 9.141
---------------
2023-09-12 08:01:46.526712
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.748623
Avg Precision: 0.343225
Avg Recall: 1.000000
d_prime: 0.947752
train_loss: 0.725213
valid_loss: 1.224286
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0017609843240853778
Epoch-17 lr: 0.0035219686481707557
epoch 17 training time: 6.409
---------------
2023-09-12 08:01:52.935459
current #epochs=18, #steps=136
start validation
[I 2023-09-12 08:01:59,399] Trial 18 finished with value: 0.6363636363636364 and parameters: {'warmup': 'True', 'num_epochs': 18, 'batch_size': 10, 'lr-adaptschedule': 'True', 'lr': 0.004829520785473158, 'head-lr': 2, 'lr-scheduler-start': 6, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.6038453485009793}. Best is trial 18 with value: 0.6363636363636364.
acc: 0.568182
AUC: 0.727961
Avg Precision: 0.319559
Avg Recall: 1.000000
d_prime: 0.857946
train_loss: 0.648524
valid_loss: 1.237281
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0017609843240853778
Epoch-18 lr: 0.0035219686481707557
epoch 18 training time: 6.459
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f957c120190>
The learning rate scheduler starts at 4 epoch with decay rate of 0.675 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 08:01:59.430491
current #epochs=1, #steps=0
start validation
acc: 0.500000
AUC: 0.735537
Avg Precision: 0.375058
Avg Recall: 1.000000
d_prime: 0.890455
train_loss: 0.943384
valid_loss: 1.245273
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0039260468189189265
Epoch-1 lr: 0.01177814045675678
epoch 1 training time: 10.039
---------------
2023-09-12 08:02:09.469414
current #epochs=2, #steps=8
start validation
acc: 0.431818
AUC: 0.703168
Avg Precision: 0.386963
Avg Recall: 1.000000
d_prime: 0.754531
train_loss: 0.853431
valid_loss: 1.286448
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0039260468189189265
Epoch-2 lr: 0.01177814045675678
epoch 2 training time: 6.541
---------------
2023-09-12 08:02:16.010666
current #epochs=3, #steps=16
start validation
acc: 0.500000
AUC: 0.730028
Avg Precision: 0.367484
Avg Recall: 1.000000
d_prime: 0.866766
train_loss: 0.904985
valid_loss: 1.263029
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0039260468189189265
Epoch-3 lr: 0.01177814045675678
epoch 3 training time: 7.266
---------------
2023-09-12 08:02:23.276945
current #epochs=4, #steps=24
start validation
acc: 0.431818
AUC: 0.719008
Avg Precision: 0.391593
Avg Recall: 1.000000
d_prime: 0.820099
train_loss: 0.864957
valid_loss: 1.270311
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00265124672721866
Epoch-4 lr: 0.007953740181655981
epoch 4 training time: 6.326
---------------
2023-09-12 08:02:29.603163
current #epochs=5, #steps=32
start validation
acc: 0.545455
AUC: 0.745868
Avg Precision: 0.400333
Avg Recall: 1.000000
d_prime: 0.935562
train_loss: 0.773136
valid_loss: 1.236655
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00265124672721866
Epoch-5 lr: 0.007953740181655981
epoch 5 training time: 9.573
---------------
2023-09-12 08:02:39.176431
current #epochs=6, #steps=40
start validation
acc: 0.522727
AUC: 0.735537
Avg Precision: 0.398092
Avg Recall: 1.000000
d_prime: 0.890455
train_loss: 0.786697
valid_loss: 1.236494
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00265124672721866
Epoch-6 lr: 0.007953740181655981
epoch 6 training time: 7.995
---------------
2023-09-12 08:02:47.171389
current #epochs=7, #steps=48
start validation
acc: 0.500000
AUC: 0.736226
Avg Precision: 0.375971
Avg Recall: 1.000000
d_prime: 0.893434
train_loss: 0.773608
valid_loss: 1.254323
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00265124672721866
Epoch-7 lr: 0.007953740181655981
epoch 7 training time: 7.290
---------------
2023-09-12 08:02:54.461070
current #epochs=8, #steps=56
start validation
acc: 0.590909
AUC: 0.736915
Avg Precision: 0.378312
Avg Recall: 1.000000
d_prime: 0.896416
train_loss: 0.738437
valid_loss: 1.239620
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00265124672721866
Epoch-8 lr: 0.007953740181655981
epoch 8 training time: 9.226
---------------
2023-09-12 08:03:03.686602
current #epochs=9, #steps=64
start validation
acc: 0.522727
AUC: 0.717631
Avg Precision: 0.357950
Avg Recall: 1.000000
d_prime: 0.814329
train_loss: 0.692368
valid_loss: 1.252824
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00265124672721866
Epoch-9 lr: 0.007953740181655981
epoch 9 training time: 6.368
---------------
2023-09-12 08:03:10.054132
current #epochs=10, #steps=72
start validation
acc: 0.545455
AUC: 0.716253
Avg Precision: 0.355885
Avg Recall: 1.000000
d_prime: 0.808573
train_loss: 0.744771
valid_loss: 1.259761
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00265124672721866
Epoch-10 lr: 0.007953740181655981
epoch 10 training time: 6.217
---------------
2023-09-12 08:03:16.270739
current #epochs=11, #steps=80
start validation
acc: 0.568182
AUC: 0.734848
Avg Precision: 0.343085
Avg Recall: 1.000000
d_prime: 0.887481
train_loss: 0.737147
valid_loss: 1.229482
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00265124672721866
Epoch-11 lr: 0.007953740181655981
epoch 11 training time: 6.261
---------------
2023-09-12 08:03:22.531979
current #epochs=12, #steps=88
start validation
acc: 0.568182
AUC: 0.742424
Avg Precision: 0.344166
Avg Recall: 1.000000
d_prime: 0.920423
train_loss: 0.659761
valid_loss: 1.232019
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00265124672721866
Epoch-12 lr: 0.007953740181655981
epoch 12 training time: 6.234
---------------
2023-09-12 08:03:28.766295
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01143	Per Sample Data Time 0.00588	Per Sample DNN Time 0.00555	Train Loss 0.6875	
start validation
acc: 0.545455
AUC: 0.718320
Avg Precision: 0.334850
Avg Recall: 1.000000
d_prime: 0.817213
train_loss: 0.700246
valid_loss: 1.251674
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0017903783456467255
Epoch-13 lr: 0.005371135036940177
epoch 13 training time: 6.355
---------------
2023-09-12 08:03:35.121567
current #epochs=14, #steps=104
start validation
acc: 0.568182
AUC: 0.738981
Avg Precision: 0.328202
Avg Recall: 1.000000
d_prime: 0.905388
train_loss: 0.679028
valid_loss: 1.232012
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0017903783456467255
Epoch-14 lr: 0.005371135036940177
epoch 14 training time: 8.078
---------------
2023-09-12 08:03:43.199251
current #epochs=15, #steps=112
start validation
acc: 0.590909
AUC: 0.756198
Avg Precision: 0.337840
Avg Recall: 1.000000
d_prime: 0.981642
train_loss: 0.664730
valid_loss: 1.226229
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0017903783456467255
Epoch-15 lr: 0.005371135036940177
epoch 15 training time: 6.265
---------------
2023-09-12 08:03:49.464276
current #epochs=16, #steps=120
start validation
[I 2023-09-12 08:03:55,646] Trial 19 finished with value: 0.5909090909090909 and parameters: {'warmup': 'True', 'num_epochs': 16, 'batch_size': 31, 'lr-adaptschedule': 'True', 'lr': 0.0039260468189189265, 'head-lr': 3, 'lr-scheduler-start': 4, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.6752967678436157}. Best is trial 18 with value: 0.6363636363636364.
acc: 0.590909
AUC: 0.750689
Avg Precision: 0.328950
Avg Recall: 1.000000
d_prime: 0.956940
train_loss: 0.620001
valid_loss: 1.238222
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0017903783456467255
Epoch-16 lr: 0.005371135036940177
epoch 16 training time: 6.178
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8edc220>
The learning rate scheduler starts at 7 epoch with decay rate of 0.640 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 08:03:55.677903
current #epochs=1, #steps=0
start validation
acc: 0.522727
AUC: 0.731405
Avg Precision: 0.312907
Avg Recall: 1.000000
d_prime: 0.872665
train_loss: 0.938742
valid_loss: 1.274751
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.004337457589920546
Epoch-1 lr: 0.008674915179841092
epoch 1 training time: 9.079
---------------
2023-09-12 08:04:04.757463
current #epochs=2, #steps=8
start validation
acc: 0.477273
AUC: 0.724518
Avg Precision: 0.312015
Avg Recall: 1.000000
d_prime: 0.843318
train_loss: 0.935489
valid_loss: 1.264925
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.004337457589920546
Epoch-2 lr: 0.008674915179841092
epoch 2 training time: 7.329
---------------
2023-09-12 08:04:12.086220
current #epochs=3, #steps=16
start validation
acc: 0.477273
AUC: 0.711433
Avg Precision: 0.346592
Avg Recall: 1.000000
d_prime: 0.788529
train_loss: 0.703363
valid_loss: 1.264417
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.004337457589920546
Epoch-3 lr: 0.008674915179841092
epoch 3 training time: 6.270
---------------
2023-09-12 08:04:18.356521
current #epochs=4, #steps=24
start validation
acc: 0.545455
AUC: 0.740358
Avg Precision: 0.363893
Avg Recall: 1.000000
d_prime: 0.911390
train_loss: 0.729306
valid_loss: 1.232883
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.004337457589920546
Epoch-4 lr: 0.008674915179841092
epoch 4 training time: 8.700
---------------
2023-09-12 08:04:27.056597
current #epochs=5, #steps=32
start validation
acc: 0.568182
AUC: 0.761019
Avg Precision: 0.360464
Avg Recall: 1.000000
d_prime: 1.003505
train_loss: 0.750288
valid_loss: 1.232162
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.004337457589920546
Epoch-5 lr: 0.008674915179841092
epoch 5 training time: 9.208
---------------
2023-09-12 08:04:36.264655
current #epochs=6, #steps=40
start validation
acc: 0.545455
AUC: 0.776171
Avg Precision: 0.387401
Avg Recall: 1.000000
d_prime: 1.073847
train_loss: 0.722564
valid_loss: 1.221928
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.004337457589920546
Epoch-6 lr: 0.008674915179841092
epoch 6 training time: 6.252
---------------
2023-09-12 08:04:42.516558
current #epochs=7, #steps=48
start validation
acc: 0.522727
AUC: 0.743113
Avg Precision: 0.354047
Avg Recall: 1.000000
d_prime: 0.923442
train_loss: 0.771132
valid_loss: 1.245022
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002775373290276616
Epoch-7 lr: 0.005550746580553232
epoch 7 training time: 6.283
---------------
2023-09-12 08:04:48.799163
current #epochs=8, #steps=56
start validation
acc: 0.545455
AUC: 0.747934
Avg Precision: 0.324749
Avg Recall: 1.000000
d_prime: 0.944698
train_loss: 0.706601
valid_loss: 1.247482
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.002775373290276616
Epoch-8 lr: 0.005550746580553232
epoch 8 training time: 6.951
---------------
2023-09-12 08:04:55.750407
current #epochs=9, #steps=64
start validation
acc: 0.613636
AUC: 0.767906
Avg Precision: 0.357487
Avg Recall: 1.000000
d_prime: 1.035161
train_loss: 0.667589
valid_loss: 1.200881
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.002775373290276616
Epoch-9 lr: 0.005550746580553232
epoch 9 training time: 10.427
---------------
2023-09-12 08:05:06.177164
current #epochs=10, #steps=72
start validation
acc: 0.545455
AUC: 0.775482
Avg Precision: 0.350741
Avg Recall: 1.000000
d_prime: 1.070593
train_loss: 0.736323
valid_loss: 1.208662
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.002775373290276616
Epoch-10 lr: 0.005550746580553232
epoch 10 training time: 7.212
---------------
2023-09-12 08:05:13.389275
current #epochs=11, #steps=80
start validation
acc: 0.568182
AUC: 0.773416
Avg Precision: 0.369658
Avg Recall: 1.000000
d_prime: 1.060864
train_loss: 0.594445
valid_loss: 1.212801
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.002775373290276616
Epoch-11 lr: 0.005550746580553232
epoch 11 training time: 6.249
---------------
2023-09-12 08:05:19.639022
current #epochs=12, #steps=88
start validation
acc: 0.590909
AUC: 0.792011
Avg Precision: 0.408795
Avg Recall: 1.000000
d_prime: 1.150348
train_loss: 0.641598
valid_loss: 1.205160
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.002775373290276616
Epoch-12 lr: 0.005550746580553232
epoch 12 training time: 6.688
---------------
2023-09-12 08:05:26.327204
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01154	Per Sample Data Time 0.00595	Per Sample DNN Time 0.00558	Train Loss 0.6432	
start validation
acc: 0.522727
AUC: 0.797521
Avg Precision: 0.407785
Avg Recall: 1.000000
d_prime: 1.177754
train_loss: 0.638314
valid_loss: 1.201467
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.002775373290276616
Epoch-13 lr: 0.005550746580553232
epoch 13 training time: 6.313
---------------
2023-09-12 08:05:32.640300
current #epochs=14, #steps=104
start validation
acc: 0.613636
AUC: 0.785124
Avg Precision: 0.386150
Avg Recall: 1.000000
d_prime: 1.116686
train_loss: 0.609842
valid_loss: 1.199092
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.002775373290276616
Epoch-14 lr: 0.005550746580553232
epoch 14 training time: 7.361
---------------
2023-09-12 08:05:40.001711
current #epochs=15, #steps=112
start validation
acc: 0.545455
AUC: 0.782369
Avg Precision: 0.371905
Avg Recall: 1.000000
d_prime: 1.103397
train_loss: 0.612562
valid_loss: 1.211360
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.002775373290276616
Epoch-15 lr: 0.005550746580553232
epoch 15 training time: 7.845
---------------
2023-09-12 08:05:47.847163
current #epochs=16, #steps=120
start validation
acc: 0.545455
AUC: 0.786501
Avg Precision: 0.383070
Avg Recall: 1.000000
d_prime: 1.123367
train_loss: 0.574328
valid_loss: 1.199929
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0017758552656008675
Epoch-16 lr: 0.003551710531201735
epoch 16 training time: 6.364
---------------
2023-09-12 08:05:54.211010
current #epochs=17, #steps=128
start validation
acc: 0.590909
AUC: 0.780303
Avg Precision: 0.370570
Avg Recall: 1.000000
d_prime: 1.093494
train_loss: 0.552912
valid_loss: 1.202366
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0017758552656008675
Epoch-17 lr: 0.003551710531201735
epoch 17 training time: 6.183
---------------
2023-09-12 08:06:00.394130
current #epochs=18, #steps=136
start validation
acc: 0.545455
AUC: 0.761019
Avg Precision: 0.329956
Avg Recall: 1.000000
d_prime: 1.003505
train_loss: 0.547768
valid_loss: 1.221352
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0017758552656008675
Epoch-18 lr: 0.003551710531201735
epoch 18 training time: 6.205
---------------
2023-09-12 08:06:06.598788
current #epochs=19, #steps=144
start validation
acc: 0.590909
AUC: 0.783058
Avg Precision: 0.382814
Avg Recall: 1.000000
d_prime: 1.106710
train_loss: 0.549543
valid_loss: 1.191924
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0017758552656008675
Epoch-19 lr: 0.003551710531201735
epoch 19 training time: 6.321
---------------
2023-09-12 08:06:12.920296
current #epochs=20, #steps=152
start validation
acc: 0.613636
AUC: 0.801653
Avg Precision: 0.396134
Avg Recall: 1.000000
d_prime: 1.198603
train_loss: 0.616963
valid_loss: 1.185112
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0017758552656008675
Epoch-20 lr: 0.003551710531201735
epoch 20 training time: 7.391
---------------
2023-09-12 08:06:20.310830
current #epochs=21, #steps=160
start validation
[I 2023-09-12 08:06:27,265] Trial 20 finished with value: 0.6136363636363636 and parameters: {'warmup': 'True', 'num_epochs': 21, 'batch_size': 52, 'lr-adaptschedule': 'True', 'lr': 0.004337457589920546, 'head-lr': 2, 'lr-scheduler-start': 7, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.6398617698824476}. Best is trial 18 with value: 0.6363636363636364.
acc: 0.545455
AUC: 0.794077
Avg Precision: 0.339301
Avg Recall: 1.000000
d_prime: 1.160574
train_loss: 0.556304
valid_loss: 1.202179
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0017758552656008675
Epoch-21 lr: 0.003551710531201735
epoch 21 training time: 6.950
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8e7ab80>
The learning rate scheduler starts at 7 epoch with decay rate of 0.640 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 08:06:27.297907
current #epochs=1, #steps=0
start validation
[I 2023-09-12 08:06:36,774] Trial 21 finished with value: 0.6136363636363636 and parameters: {'warmup': 'True', 'num_epochs': 1, 'batch_size': 52, 'lr-adaptschedule': 'True', 'lr': 0.004525714748414486, 'head-lr': 2, 'lr-scheduler-start': 7, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.6402051702553326}. Best is trial 18 with value: 0.6363636363636364.
acc: 0.613636
AUC: 0.794766
Avg Precision: 0.398319
Avg Recall: 1.000000
d_prime: 1.163996
train_loss: 0.707590
valid_loss: 1.218208
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.004525714748414486
Epoch-1 lr: 0.009051429496828972
epoch 1 training time: 9.472
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8e67c10>
The learning rate scheduler starts at 7 epoch with decay rate of 0.634 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 08:06:36.806527
current #epochs=1, #steps=0
start validation
acc: 0.545455
AUC: 0.739669
Avg Precision: 0.330164
Avg Recall: 1.000000
d_prime: 0.908387
train_loss: 0.842764
valid_loss: 1.247825
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.004432005266396624
Epoch-1 lr: 0.008864010532793247
epoch 1 training time: 8.891
---------------
2023-09-12 08:06:45.697574
current #epochs=2, #steps=8
start validation
acc: 0.522727
AUC: 0.761019
Avg Precision: 0.358650
Avg Recall: 1.000000
d_prime: 1.003505
train_loss: 0.761368
valid_loss: 1.248544
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.004432005266396624
Epoch-2 lr: 0.008864010532793247
epoch 2 training time: 6.164
---------------
2023-09-12 08:06:51.861732
current #epochs=3, #steps=16
start validation
acc: 0.522727
AUC: 0.786501
Avg Precision: 0.401168
Avg Recall: 1.000000
d_prime: 1.123367
train_loss: 0.744517
valid_loss: 1.237853
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.004432005266396624
Epoch-3 lr: 0.008864010532793247
epoch 3 training time: 6.481
---------------
2023-09-12 08:06:58.342580
current #epochs=4, #steps=24
start validation
[I 2023-09-12 08:07:08,576] Trial 22 finished with value: 0.5681818181818182 and parameters: {'warmup': 'True', 'num_epochs': 4, 'batch_size': 53, 'lr-adaptschedule': 'True', 'lr': 0.004432005266396624, 'head-lr': 2, 'lr-scheduler-start': 7, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.6335018365657036}. Best is trial 18 with value: 0.6363636363636364.
acc: 0.568182
AUC: 0.783058
Avg Precision: 0.413290
Avg Recall: 1.000000
d_prime: 1.106710
train_loss: 0.765272
valid_loss: 1.216979
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.004432005266396624
Epoch-4 lr: 0.008864010532793247
epoch 4 training time: 10.229
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8ebad90>
The learning rate scheduler starts at 6 epoch with decay rate of 0.676 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 08:07:08.610334
current #epochs=1, #steps=0
start validation
[I 2023-09-12 08:07:17,779] Trial 23 finished with value: 0.5681818181818182 and parameters: {'warmup': 'True', 'num_epochs': 1, 'batch_size': 41, 'lr-adaptschedule': 'True', 'lr': 0.003778094924466087, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.676466998662267}. Best is trial 18 with value: 0.6363636363636364.
acc: 0.568182
AUC: 0.802342
Avg Precision: 0.376105
Avg Recall: 1.000000
d_prime: 1.202103
train_loss: 0.736979
valid_loss: 1.206939
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003778094924466087
Epoch-1 lr: 0.003778094924466087
epoch 1 training time: 9.165
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f957c120190>
The learning rate scheduler starts at 7 epoch with decay rate of 0.631 every 7 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 08:07:17.812611
current #epochs=1, #steps=0
start validation
acc: 0.568182
AUC: 0.793388
Avg Precision: 0.421317
Avg Recall: 1.000000
d_prime: 1.157159
train_loss: 0.747295
valid_loss: 1.218898
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.004458228298155291
Epoch-1 lr: 0.008916456596310582
epoch 1 training time: 8.920
---------------
2023-09-12 08:07:26.732730
current #epochs=2, #steps=8
start validation
acc: 0.613636
AUC: 0.761708
Avg Precision: 0.376057
Avg Recall: 1.000000
d_prime: 1.006648
train_loss: 0.733093
valid_loss: 1.218908
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.004458228298155291
Epoch-2 lr: 0.008916456596310582
epoch 2 training time: 9.473
---------------
2023-09-12 08:07:36.205434
current #epochs=3, #steps=16
start validation
acc: 0.522727
AUC: 0.764463
Avg Precision: 0.349245
Avg Recall: 1.000000
d_prime: 1.019269
train_loss: 0.691592
valid_loss: 1.224477
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.004458228298155291
Epoch-3 lr: 0.008916456596310582
epoch 3 training time: 7.270
---------------
2023-09-12 08:07:43.475772
current #epochs=4, #steps=24
start validation
acc: 0.545455
AUC: 0.738981
Avg Precision: 0.366709
Avg Recall: 1.000000
d_prime: 0.905388
train_loss: 0.640780
valid_loss: 1.239849
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.004458228298155291
Epoch-4 lr: 0.008916456596310582
epoch 4 training time: 6.821
---------------
2023-09-12 08:07:50.297254
current #epochs=5, #steps=32
start validation
acc: 0.568182
AUC: 0.780992
Avg Precision: 0.379880
Avg Recall: 1.000000
d_prime: 1.096789
train_loss: 0.708323
valid_loss: 1.211783
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.004458228298155291
Epoch-5 lr: 0.008916456596310582
epoch 5 training time: 6.180
---------------
2023-09-12 08:07:56.476870
current #epochs=6, #steps=40
start validation
acc: 0.545455
AUC: 0.785124
Avg Precision: 0.422615
Avg Recall: 1.000000
d_prime: 1.116686
train_loss: 0.613136
valid_loss: 1.211453
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.004458228298155291
Epoch-6 lr: 0.008916456596310582
epoch 6 training time: 6.267
---------------
2023-09-12 08:08:02.743979
current #epochs=7, #steps=48
start validation
acc: 0.545455
AUC: 0.783747
Avg Precision: 0.357925
Avg Recall: 1.000000
d_prime: 1.110029
train_loss: 0.635131
valid_loss: 1.214965
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0028129958416373215
Epoch-7 lr: 0.005625991683274643
epoch 7 training time: 6.193
---------------
2023-09-12 08:08:08.937375
current #epochs=8, #steps=56
start validation
acc: 0.545455
AUC: 0.774793
Avg Precision: 0.367289
Avg Recall: 1.000000
d_prime: 1.067344
train_loss: 0.566251
valid_loss: 1.214047
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0028129958416373215
Epoch-8 lr: 0.005625991683274643
epoch 8 training time: 6.224
---------------
2023-09-12 08:08:15.161148
current #epochs=9, #steps=64
start validation
acc: 0.522727
AUC: 0.781680
Avg Precision: 0.395355
Avg Recall: 1.000000
d_prime: 1.100090
train_loss: 0.594185
valid_loss: 1.204994
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0028129958416373215
Epoch-9 lr: 0.005625991683274643
epoch 9 training time: 9.136
---------------
2023-09-12 08:08:24.297061
current #epochs=10, #steps=72
start validation
acc: 0.613636
AUC: 0.799587
Avg Precision: 0.387974
Avg Recall: 1.000000
d_prime: 1.188146
train_loss: 0.601199
valid_loss: 1.196164
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0028129958416373215
Epoch-10 lr: 0.005625991683274643
epoch 10 training time: 6.305
---------------
2023-09-12 08:08:30.601976
current #epochs=11, #steps=80
start validation
acc: 0.613636
AUC: 0.793388
Avg Precision: 0.407969
Avg Recall: 1.000000
d_prime: 1.157159
train_loss: 0.574213
valid_loss: 1.192578
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0028129958416373215
Epoch-11 lr: 0.005625991683274643
epoch 11 training time: 6.147
---------------
2023-09-12 08:08:36.749313
current #epochs=12, #steps=88
start validation
acc: 0.613636
AUC: 0.774793
Avg Precision: 0.344232
Avg Recall: 1.000000
d_prime: 1.067344
train_loss: 0.525065
valid_loss: 1.214099
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0028129958416373215
Epoch-12 lr: 0.005625991683274643
epoch 12 training time: 6.265
---------------
2023-09-12 08:08:43.013975
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01167	Per Sample Data Time 0.00589	Per Sample DNN Time 0.00578	Train Loss 0.5127	
start validation
acc: 0.568182
AUC: 0.758264
Avg Precision: 0.333617
Avg Recall: 1.000000
d_prime: 0.990983
train_loss: 0.547205
valid_loss: 1.211322
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0028129958416373215
Epoch-13 lr: 0.005625991683274643
epoch 13 training time: 7.683
---------------
2023-09-12 08:08:50.696919
current #epochs=14, #steps=104
start validation
acc: 0.590909
AUC: 0.770661
Avg Precision: 0.320547
Avg Recall: 1.000000
d_prime: 1.047969
train_loss: 0.657709
valid_loss: 1.220968
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0017749081195198217
Epoch-14 lr: 0.0035498162390396435
epoch 14 training time: 6.300
---------------
2023-09-12 08:08:56.996771
current #epochs=15, #steps=112
start validation
acc: 0.568182
AUC: 0.792011
Avg Precision: 0.348149
Avg Recall: 1.000000
d_prime: 1.150348
train_loss: 0.561959
valid_loss: 1.210166
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0017749081195198217
Epoch-15 lr: 0.0035498162390396435
epoch 15 training time: 6.177
---------------
2023-09-12 08:09:03.173799
current #epochs=16, #steps=120
start validation
acc: 0.500000
AUC: 0.784435
Avg Precision: 0.311138
Avg Recall: 1.000000
d_prime: 1.113354
train_loss: 0.544217
valid_loss: 1.210211
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0017749081195198217
Epoch-16 lr: 0.0035498162390396435
epoch 16 training time: 6.341
---------------
2023-09-12 08:09:09.514615
current #epochs=17, #steps=128
start validation
acc: 0.590909
AUC: 0.799587
Avg Precision: 0.327069
Avg Recall: 1.000000
d_prime: 1.188146
train_loss: 0.586172
valid_loss: 1.196841
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0017749081195198217
Epoch-17 lr: 0.0035498162390396435
epoch 17 training time: 6.211
---------------
2023-09-12 08:09:15.725168
current #epochs=18, #steps=136
start validation
acc: 0.613636
AUC: 0.793388
Avg Precision: 0.329187
Avg Recall: 1.000000
d_prime: 1.157159
train_loss: 0.525368
valid_loss: 1.194771
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0017749081195198217
Epoch-18 lr: 0.0035498162390396435
epoch 18 training time: 7.237
---------------
2023-09-12 08:09:22.962476
current #epochs=19, #steps=144
start validation
[I 2023-09-12 08:09:31,773] Trial 24 finished with value: 0.6136363636363636 and parameters: {'warmup': 'True', 'num_epochs': 19, 'batch_size': 53, 'lr-adaptschedule': 'True', 'lr': 0.004458228298155291, 'head-lr': 2, 'lr-scheduler-start': 7, 'lr-scheduler-step': 7, 'lr-scheduler-decay': 0.6309672034519346}. Best is trial 18 with value: 0.6363636363636364.
acc: 0.568182
AUC: 0.800275
Avg Precision: 0.352943
Avg Recall: 1.000000
d_prime: 1.191624
train_loss: 0.562063
valid_loss: 1.184213
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0017749081195198217
Epoch-19 lr: 0.0035498162390396435
epoch 19 training time: 8.806
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8d97bb0>
The learning rate scheduler starts at 5 epoch with decay rate of 0.691 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 08:09:31.806820
current #epochs=1, #steps=0
start validation
acc: 0.568182
AUC: 0.765840
Avg Precision: 0.338838
Avg Recall: 1.000000
d_prime: 1.025610
train_loss: 0.631074
valid_loss: 1.227516
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0037152687764433756
Epoch-1 lr: 0.007430537552886751
epoch 1 training time: 9.694
---------------
2023-09-12 08:09:41.501547
current #epochs=2, #steps=8
start validation
acc: 0.545455
AUC: 0.784435
Avg Precision: 0.319859
Avg Recall: 1.000000
d_prime: 1.113354
train_loss: 0.815339
valid_loss: 1.235590
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0037152687764433756
Epoch-2 lr: 0.007430537552886751
epoch 2 training time: 7.342
---------------
2023-09-12 08:09:48.843617
current #epochs=3, #steps=16
start validation
acc: 0.545455
AUC: 0.776860
Avg Precision: 0.322978
Avg Recall: 1.000000
d_prime: 1.077107
train_loss: 0.707764
valid_loss: 1.236401
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0037152687764433756
Epoch-3 lr: 0.007430537552886751
epoch 3 training time: 6.502
---------------
2023-09-12 08:09:55.345517
current #epochs=4, #steps=24
start validation
acc: 0.545455
AUC: 0.744490
Avg Precision: 0.336348
Avg Recall: 1.000000
d_prime: 0.929494
train_loss: 0.657448
valid_loss: 1.247756
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0037152687764433756
Epoch-4 lr: 0.007430537552886751
epoch 4 training time: 6.221
---------------
2023-09-12 08:10:01.566538
current #epochs=5, #steps=32
start validation
acc: 0.500000
AUC: 0.758953
Avg Precision: 0.347539
Avg Recall: 1.000000
d_prime: 0.994106
train_loss: 0.679415
valid_loss: 1.233825
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0025686325644918824
Epoch-5 lr: 0.005137265128983765
epoch 5 training time: 6.325
---------------
2023-09-12 08:10:07.891047
current #epochs=6, #steps=40
start validation
acc: 0.522727
AUC: 0.802342
Avg Precision: 0.352689
Avg Recall: 1.000000
d_prime: 1.202103
train_loss: 0.616280
valid_loss: 1.199074
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0025686325644918824
Epoch-6 lr: 0.005137265128983765
epoch 6 training time: 6.464
---------------
2023-09-12 08:10:14.355483
current #epochs=7, #steps=48
start validation
acc: 0.545455
AUC: 0.786501
Avg Precision: 0.346584
Avg Recall: 1.000000
d_prime: 1.123367
train_loss: 0.601427
valid_loss: 1.206367
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0025686325644918824
Epoch-7 lr: 0.005137265128983765
epoch 7 training time: 8.093
---------------
2023-09-12 08:10:22.448609
current #epochs=8, #steps=56
start validation
acc: 0.590909
AUC: 0.796832
Avg Precision: 0.345475
Avg Recall: 1.000000
d_prime: 1.174304
train_loss: 0.607671
valid_loss: 1.202552
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0025686325644918824
Epoch-8 lr: 0.005137265128983765
epoch 8 training time: 10.644
---------------
2023-09-12 08:10:33.092615
current #epochs=9, #steps=64
start validation
acc: 0.590909
AUC: 0.783747
Avg Precision: 0.349335
Avg Recall: 1.000000
d_prime: 1.110029
train_loss: 0.544320
valid_loss: 1.202973
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0025686325644918824
Epoch-9 lr: 0.005137265128983765
epoch 9 training time: 6.935
---------------
2023-09-12 08:10:40.027131
current #epochs=10, #steps=72
start validation
acc: 0.568182
AUC: 0.788567
Avg Precision: 0.366592
Avg Recall: 1.000000
d_prime: 1.133437
train_loss: 0.565197
valid_loss: 1.196304
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0025686325644918824
Epoch-10 lr: 0.005137265128983765
epoch 10 training time: 6.207
---------------
2023-09-12 08:10:46.233983
current #epochs=11, #steps=80
start validation
acc: 0.590909
AUC: 0.794077
Avg Precision: 0.368004
Avg Recall: 1.000000
d_prime: 1.160574
train_loss: 0.480734
valid_loss: 1.192789
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0025686325644918824
Epoch-11 lr: 0.005137265128983765
epoch 11 training time: 6.239
---------------
2023-09-12 08:10:52.472471
current #epochs=12, #steps=88
start validation
acc: 0.568182
AUC: 0.793388
Avg Precision: 0.350185
Avg Recall: 1.000000
d_prime: 1.157159
train_loss: 0.579020
valid_loss: 1.193706
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0025686325644918824
Epoch-12 lr: 0.005137265128983765
epoch 12 training time: 8.254
---------------
2023-09-12 08:11:00.726821
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01155	Per Sample Data Time 0.00564	Per Sample DNN Time 0.00591	Train Loss 0.5346	
start validation
acc: 0.590909
AUC: 0.789945
Avg Precision: 0.344239
Avg Recall: 1.000000
d_prime: 1.140182
train_loss: 0.531046
valid_loss: 1.195110
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0025686325644918824
Epoch-13 lr: 0.005137265128983765
epoch 13 training time: 8.224
---------------
2023-09-12 08:11:08.951001
current #epochs=14, #steps=104
start validation
acc: 0.568182
AUC: 0.803719
Avg Precision: 0.377624
Avg Recall: 1.000000
d_prime: 1.209125
train_loss: 0.542573
valid_loss: 1.188589
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0017758804674380207
Epoch-14 lr: 0.0035517609348760413
epoch 14 training time: 8.163
---------------
2023-09-12 08:11:17.114447
current #epochs=15, #steps=112
start validation
[I 2023-09-12 08:11:26,238] Trial 25 finished with value: 0.6363636363636364 and parameters: {'warmup': 'True', 'num_epochs': 15, 'batch_size': 33, 'lr-adaptschedule': 'True', 'lr': 0.0037152687764433756, 'head-lr': 2, 'lr-scheduler-start': 5, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.6913719353975872}. Best is trial 18 with value: 0.6363636363636364.
acc: 0.636364
AUC: 0.815427
Avg Precision: 0.362313
Avg Recall: 1.000000
d_prime: 1.270069
train_loss: 0.496153
valid_loss: 1.180769
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0017758804674380207
Epoch-15 lr: 0.0035517609348760413
epoch 15 training time: 9.119
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95bc7b1f40>
The learning rate scheduler starts at 5 epoch with decay rate of 0.603 every 7 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 08:11:26.271493
current #epochs=1, #steps=0
start validation
acc: 0.568182
AUC: 0.814738
Avg Precision: 0.363715
Avg Recall: 1.000000
d_prime: 1.266419
train_loss: 0.749569
valid_loss: 1.194871
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0036191732338070473
Epoch-1 lr: 0.0036191732338070473
epoch 1 training time: 9.792
---------------
2023-09-12 08:11:36.064386
current #epochs=2, #steps=8
start validation
acc: 0.590909
AUC: 0.789945
Avg Precision: 0.328317
Avg Recall: 1.000000
d_prime: 1.140182
train_loss: 0.657142
valid_loss: 1.197531
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0036191732338070473
Epoch-2 lr: 0.0036191732338070473
epoch 2 training time: 9.174
---------------
2023-09-12 08:11:45.238205
current #epochs=3, #steps=16
start validation
acc: 0.613636
AUC: 0.796143
Avg Precision: 0.352877
Avg Recall: 1.000000
d_prime: 1.170861
train_loss: 0.554508
valid_loss: 1.203448
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0036191732338070473
Epoch-3 lr: 0.0036191732338070473
epoch 3 training time: 8.792
---------------
2023-09-12 08:11:54.030043
current #epochs=4, #steps=24
start validation
acc: 0.590909
AUC: 0.794077
Avg Precision: 0.347333
Avg Recall: 1.000000
d_prime: 1.160574
train_loss: 0.504883
valid_loss: 1.198813
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0036191732338070473
Epoch-4 lr: 0.0036191732338070473
epoch 4 training time: 7.810
---------------
2023-09-12 08:12:01.840856
current #epochs=5, #steps=32
start validation
acc: 0.522727
AUC: 0.796143
Avg Precision: 0.367154
Avg Recall: 1.000000
d_prime: 1.170861
train_loss: 0.572459
valid_loss: 1.189379
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0021840257981070037
Epoch-5 lr: 0.0021840257981070037
epoch 5 training time: 6.530
---------------
2023-09-12 08:12:08.370680
current #epochs=6, #steps=40
start validation
acc: 0.545455
AUC: 0.811295
Avg Precision: 0.372520
Avg Recall: 1.000000
d_prime: 1.248295
train_loss: 0.499758
valid_loss: 1.180170
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0021840257981070037
Epoch-6 lr: 0.0021840257981070037
epoch 6 training time: 6.332
---------------
2023-09-12 08:12:14.703070
current #epochs=7, #steps=48
start validation
acc: 0.590909
AUC: 0.804408
Avg Precision: 0.401910
Avg Recall: 1.000000
d_prime: 1.212647
train_loss: 0.481901
valid_loss: 1.182103
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0021840257981070037
Epoch-7 lr: 0.0021840257981070037
epoch 7 training time: 7.559
---------------
2023-09-12 08:12:22.261915
current #epochs=8, #steps=56
start validation
acc: 0.590909
AUC: 0.800964
Avg Precision: 0.369337
Avg Recall: 1.000000
d_prime: 1.195110
train_loss: 0.451469
valid_loss: 1.180555
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0021840257981070037
Epoch-8 lr: 0.0021840257981070037
epoch 8 training time: 6.365
---------------
2023-09-12 08:12:28.627027
current #epochs=9, #steps=64
start validation
acc: 0.568182
AUC: 0.818182
Avg Precision: 0.374284
Avg Recall: 1.000000
d_prime: 1.284753
train_loss: 0.479097
valid_loss: 1.178609
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0021840257981070037
Epoch-9 lr: 0.0021840257981070037
epoch 9 training time: 6.532
---------------
2023-09-12 08:12:35.159644
current #epochs=10, #steps=72
start validation
acc: 0.613636
AUC: 0.792011
Avg Precision: 0.370541
Avg Recall: 1.000000
d_prime: 1.150348
train_loss: 0.527041
valid_loss: 1.187600
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0021840257981070037
Epoch-10 lr: 0.0021840257981070037
epoch 10 training time: 6.561
---------------
2023-09-12 08:12:41.720052
current #epochs=11, #steps=80
start validation
acc: 0.636364
AUC: 0.811983
Avg Precision: 0.382154
Avg Recall: 1.000000
d_prime: 1.251903
train_loss: 0.492599
valid_loss: 1.169243
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0021840257981070037
Epoch-11 lr: 0.0021840257981070037
epoch 11 training time: 9.064
---------------
2023-09-12 08:12:50.784386
current #epochs=12, #steps=88
start validation
acc: 0.613636
AUC: 0.819559
Avg Precision: 0.337648
Avg Recall: 1.000000
d_prime: 1.292148
train_loss: 0.517890
valid_loss: 1.162767
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0013179719175197794
Epoch-12 lr: 0.0013179719175197794
epoch 12 training time: 6.338
---------------
2023-09-12 08:12:57.122518
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01108	Per Sample Data Time 0.00562	Per Sample DNN Time 0.00546	Train Loss 0.4379	
start validation
acc: 0.636364
AUC: 0.821625
Avg Precision: 0.371349
Avg Recall: 1.000000
d_prime: 1.303307
train_loss: 0.426387
valid_loss: 1.156649
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0013179719175197794
Epoch-13 lr: 0.0013179719175197794
epoch 13 training time: 6.261
---------------
2023-09-12 08:13:03.383417
current #epochs=14, #steps=104
start validation
acc: 0.681818
AUC: 0.831956
Avg Precision: 0.383387
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.494718
valid_loss: 1.155465
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0013179719175197794
Epoch-14 lr: 0.0013179719175197794
epoch 14 training time: 8.981
---------------
2023-09-12 08:13:12.364740
current #epochs=15, #steps=112
start validation
acc: 0.681818
AUC: 0.829890
Avg Precision: 0.390433
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.499430
valid_loss: 1.151302
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0013179719175197794
Epoch-15 lr: 0.0013179719175197794
epoch 15 training time: 7.535
---------------
2023-09-12 08:13:19.899830
current #epochs=16, #steps=120
start validation
[I 2023-09-12 08:13:26,270] Trial 26 finished with value: 0.6818181818181818 and parameters: {'warmup': 'True', 'num_epochs': 16, 'batch_size': 32, 'lr-adaptschedule': 'True', 'lr': 0.0036191732338070473, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 7, 'lr-scheduler-decay': 0.6034598669402745}. Best is trial 26 with value: 0.6818181818181818.
acc: 0.613636
AUC: 0.821625
Avg Precision: 0.344195
Avg Recall: 1.000000
d_prime: 1.303307
train_loss: 0.500110
valid_loss: 1.166124
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0013179719175197794
Epoch-16 lr: 0.0013179719175197794
epoch 16 training time: 6.366
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95bc7b1b80>
The learning rate scheduler starts at 5 epoch with decay rate of 0.606 every 7 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 08:13:26.304868
current #epochs=1, #steps=0
start validation
acc: 0.613636
AUC: 0.799587
Avg Precision: 0.362426
Avg Recall: 1.000000
d_prime: 1.188146
train_loss: 0.618148
valid_loss: 1.200527
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003657707855165335
Epoch-1 lr: 0.003657707855165335
epoch 1 training time: 10.292
---------------
2023-09-12 08:13:36.597338
current #epochs=2, #steps=8
start validation
acc: 0.522727
AUC: 0.795455
Avg Precision: 0.368665
Avg Recall: 1.000000
d_prime: 1.167426
train_loss: 0.613050
valid_loss: 1.217041
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003657707855165335
Epoch-2 lr: 0.003657707855165335
epoch 2 training time: 6.346
---------------
2023-09-12 08:13:42.942646
current #epochs=3, #steps=16
start validation
acc: 0.590909
AUC: 0.809229
Avg Precision: 0.385730
Avg Recall: 1.000000
d_prime: 1.237518
train_loss: 0.610383
valid_loss: 1.201486
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003657707855165335
Epoch-3 lr: 0.003657707855165335
epoch 3 training time: 7.697
---------------
2023-09-12 08:13:50.639915
current #epochs=4, #steps=24
start validation
acc: 0.613636
AUC: 0.807851
Avg Precision: 0.374622
Avg Recall: 1.000000
d_prime: 1.230373
train_loss: 0.572667
valid_loss: 1.188608
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003657707855165335
Epoch-4 lr: 0.003657707855165335
epoch 4 training time: 6.837
---------------
2023-09-12 08:13:57.476805
current #epochs=5, #steps=32
start validation
acc: 0.590909
AUC: 0.796832
Avg Precision: 0.356313
Avg Recall: 1.000000
d_prime: 1.174304
train_loss: 0.522618
valid_loss: 1.197022
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0022163558228082444
Epoch-5 lr: 0.0022163558228082444
epoch 5 training time: 7.497
---------------
2023-09-12 08:14:04.974111
current #epochs=6, #steps=40
start validation
acc: 0.545455
AUC: 0.808540
Avg Precision: 0.366482
Avg Recall: 1.000000
d_prime: 1.233942
train_loss: 0.496235
valid_loss: 1.188623
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0022163558228082444
Epoch-6 lr: 0.0022163558228082444
epoch 6 training time: 6.223
---------------
2023-09-12 08:14:11.197237
current #epochs=7, #steps=48
start validation
acc: 0.568182
AUC: 0.812672
Avg Precision: 0.379544
Avg Recall: 1.000000
d_prime: 1.255520
train_loss: 0.552077
valid_loss: 1.174983
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0022163558228082444
Epoch-7 lr: 0.0022163558228082444
epoch 7 training time: 6.372
---------------
2023-09-12 08:14:17.569388
current #epochs=8, #steps=56
start validation
acc: 0.590909
AUC: 0.802342
Avg Precision: 0.355541
Avg Recall: 1.000000
d_prime: 1.202103
train_loss: 0.508660
valid_loss: 1.169669
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0022163558228082444
Epoch-8 lr: 0.0022163558228082444
epoch 8 training time: 6.356
---------------
2023-09-12 08:14:23.925560
current #epochs=9, #steps=64
start validation
acc: 0.636364
AUC: 0.819559
Avg Precision: 0.407271
Avg Recall: 1.000000
d_prime: 1.292148
train_loss: 0.435592
valid_loss: 1.165515
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0022163558228082444
Epoch-9 lr: 0.0022163558228082444
epoch 9 training time: 8.665
---------------
2023-09-12 08:14:32.590621
current #epochs=10, #steps=72
start validation
acc: 0.613636
AUC: 0.805096
Avg Precision: 0.370660
Avg Recall: 1.000000
d_prime: 1.216177
train_loss: 0.575797
valid_loss: 1.175880
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0022163558228082444
Epoch-10 lr: 0.0022163558228082444
epoch 10 training time: 8.098
---------------
2023-09-12 08:14:40.688465
current #epochs=11, #steps=80
start validation
acc: 0.568182
AUC: 0.810606
Avg Precision: 0.389019
Avg Recall: 1.000000
d_prime: 1.244694
train_loss: 0.454238
valid_loss: 1.179389
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0022163558228082444
Epoch-11 lr: 0.0022163558228082444
epoch 11 training time: 6.353
---------------
2023-09-12 08:14:47.041156
current #epochs=12, #steps=88
start validation
acc: 0.545455
AUC: 0.814738
Avg Precision: 0.398584
Avg Recall: 1.000000
d_prime: 1.266419
train_loss: 0.417156
valid_loss: 1.174712
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0013429812679979518
Epoch-12 lr: 0.0013429812679979518
epoch 12 training time: 6.195
---------------
2023-09-12 08:14:53.235911
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01176	Per Sample Data Time 0.00600	Per Sample DNN Time 0.00576	Train Loss 0.3990	
start validation
acc: 0.568182
AUC: 0.800964
Avg Precision: 0.380075
Avg Recall: 1.000000
d_prime: 1.195110
train_loss: 0.468170
valid_loss: 1.176297
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0013429812679979518
Epoch-13 lr: 0.0013429812679979518
epoch 13 training time: 6.293
---------------
2023-09-12 08:14:59.529195
current #epochs=14, #steps=104
start validation
acc: 0.613636
AUC: 0.811295
Avg Precision: 0.357605
Avg Recall: 1.000000
d_prime: 1.248295
train_loss: 0.421376
valid_loss: 1.164527
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0013429812679979518
Epoch-14 lr: 0.0013429812679979518
epoch 14 training time: 6.594
---------------
2023-09-12 08:15:06.123661
current #epochs=15, #steps=112
start validation
[I 2023-09-12 08:15:13,336] Trial 27 finished with value: 0.6363636363636364 and parameters: {'warmup': 'True', 'num_epochs': 15, 'batch_size': 31, 'lr-adaptschedule': 'True', 'lr': 0.003657707855165335, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 7, 'lr-scheduler-decay': 0.6059411824480064}. Best is trial 26 with value: 0.6818181818181818.
acc: 0.590909
AUC: 0.783058
Avg Precision: 0.341423
Avg Recall: 1.000000
d_prime: 1.106710
train_loss: 0.460716
valid_loss: 1.180081
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0013429812679979518
Epoch-15 lr: 0.0013429812679979518
epoch 15 training time: 7.209
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8d71ac0>
The learning rate scheduler starts at 4 epoch with decay rate of 0.691 every 7 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 08:15:13.370170
current #epochs=1, #steps=0
start validation
acc: 0.522727
AUC: 0.776860
Avg Precision: 0.382461
Avg Recall: 1.000000
d_prime: 1.077107
train_loss: 0.676172
valid_loss: 1.218602
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0035688928831450594
Epoch-1 lr: 0.0035688928831450594
epoch 1 training time: 9.618
---------------
2023-09-12 08:15:22.988210
current #epochs=2, #steps=8
start validation
acc: 0.590909
AUC: 0.814738
Avg Precision: 0.380763
Avg Recall: 1.000000
d_prime: 1.266419
train_loss: 0.662052
valid_loss: 1.200947
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0035688928831450594
Epoch-2 lr: 0.0035688928831450594
epoch 2 training time: 9.339
---------------
2023-09-12 08:15:32.327166
current #epochs=3, #steps=16
start validation
acc: 0.568182
AUC: 0.781680
Avg Precision: 0.371376
Avg Recall: 1.000000
d_prime: 1.100090
train_loss: 0.566353
valid_loss: 1.205883
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0035688928831450594
Epoch-3 lr: 0.0035688928831450594
epoch 3 training time: 7.776
---------------
2023-09-12 08:15:40.103321
current #epochs=4, #steps=24
start validation
acc: 0.545455
AUC: 0.803030
Avg Precision: 0.364618
Avg Recall: 1.000000
d_prime: 1.205610
train_loss: 0.579698
valid_loss: 1.192026
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002466999808157453
Epoch-4 lr: 0.002466999808157453
epoch 4 training time: 7.264
---------------
2023-09-12 08:15:47.366829
current #epochs=5, #steps=32
start validation
acc: 0.659091
AUC: 0.811983
Avg Precision: 0.403274
Avg Recall: 1.000000
d_prime: 1.251903
train_loss: 0.643662
valid_loss: 1.176360
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002466999808157453
Epoch-5 lr: 0.002466999808157453
epoch 5 training time: 8.567
---------------
2023-09-12 08:15:55.934077
current #epochs=6, #steps=40
start validation
acc: 0.659091
AUC: 0.820248
Avg Precision: 0.360170
Avg Recall: 1.000000
d_prime: 1.295859
train_loss: 0.530875
valid_loss: 1.179157
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002466999808157453
Epoch-6 lr: 0.002466999808157453
epoch 6 training time: 6.331
---------------
2023-09-12 08:16:02.264899
current #epochs=7, #steps=48
start validation
acc: 0.659091
AUC: 0.836777
Avg Precision: 0.372883
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.490574
valid_loss: 1.152960
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002466999808157453
Epoch-7 lr: 0.002466999808157453
epoch 7 training time: 7.223
---------------
2023-09-12 08:16:09.488118
current #epochs=8, #steps=56
start validation
acc: 0.659091
AUC: 0.841598
Avg Precision: 0.377366
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.506611
valid_loss: 1.152636
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.002466999808157453
Epoch-8 lr: 0.002466999808157453
epoch 8 training time: 6.363
---------------
2023-09-12 08:16:15.851235
current #epochs=9, #steps=64
start validation
acc: 0.636364
AUC: 0.835399
Avg Precision: 0.381534
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.446424
valid_loss: 1.152842
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.002466999808157453
Epoch-9 lr: 0.002466999808157453
epoch 9 training time: 7.954
---------------
2023-09-12 08:16:23.804808
current #epochs=10, #steps=72
start validation
acc: 0.613636
AUC: 0.829890
Avg Precision: 0.362923
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.440504
valid_loss: 1.152777
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.002466999808157453
Epoch-10 lr: 0.002466999808157453
epoch 10 training time: 7.246
---------------
2023-09-12 08:16:31.050744
current #epochs=11, #steps=80
start validation
acc: 0.636364
AUC: 0.842975
Avg Precision: 0.378560
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.454980
valid_loss: 1.143205
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0017053154164956587
Epoch-11 lr: 0.0017053154164956587
epoch 11 training time: 6.176
---------------
2023-09-12 08:16:37.226466
current #epochs=12, #steps=88
start validation
acc: 0.659091
AUC: 0.835399
Avg Precision: 0.365486
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.384725
valid_loss: 1.147890
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0017053154164956587
Epoch-12 lr: 0.0017053154164956587
epoch 12 training time: 6.946
---------------
2023-09-12 08:16:44.172753
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01155	Per Sample Data Time 0.00605	Per Sample DNN Time 0.00550	Train Loss 0.5419	
start validation
acc: 0.636364
AUC: 0.834022
Avg Precision: 0.365486
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.456383
valid_loss: 1.144666
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0017053154164956587
Epoch-13 lr: 0.0017053154164956587
epoch 13 training time: 7.181
---------------
2023-09-12 08:16:51.353557
current #epochs=14, #steps=104
start validation
acc: 0.636364
AUC: 0.827135
Avg Precision: 0.355026
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.436817
valid_loss: 1.146985
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0017053154164956587
Epoch-14 lr: 0.0017053154164956587
epoch 14 training time: 7.130
---------------
2023-09-12 08:16:58.483051
current #epochs=15, #steps=112
start validation
[I 2023-09-12 08:17:06,372] Trial 28 finished with value: 0.6590909090909091 and parameters: {'warmup': 'True', 'num_epochs': 15, 'batch_size': 14, 'lr-adaptschedule': 'True', 'lr': 0.0035688928831450594, 'head-lr': 1, 'lr-scheduler-start': 4, 'lr-scheduler-step': 7, 'lr-scheduler-decay': 0.6912507292691363}. Best is trial 26 with value: 0.6818181818181818.
acc: 0.636364
AUC: 0.845041
Avg Precision: 0.377271
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.413840
valid_loss: 1.135253
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0017053154164956587
Epoch-15 lr: 0.0017053154164956587
epoch 15 training time: 7.885
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8e7a730>
The learning rate scheduler starts at 4 epoch with decay rate of 0.621 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 08:17:06.406244
current #epochs=1, #steps=0
start validation
acc: 0.568182
AUC: 0.820937
Avg Precision: 0.417281
Avg Recall: 1.000000
d_prime: 1.299578
train_loss: 0.603119
valid_loss: 1.170256
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0034372162329946877
Epoch-1 lr: 0.0034372162329946877
epoch 1 training time: 9.875
---------------
2023-09-12 08:17:16.281558
current #epochs=2, #steps=8
start validation
acc: 0.568182
AUC: 0.822314
Avg Precision: 0.388958
Avg Recall: 1.000000
d_prime: 1.307044
train_loss: 0.486854
valid_loss: 1.177822
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0034372162329946877
Epoch-2 lr: 0.0034372162329946877
epoch 2 training time: 6.296
---------------
2023-09-12 08:17:22.577733
current #epochs=3, #steps=16
start validation
acc: 0.545455
AUC: 0.807851
Avg Precision: 0.375491
Avg Recall: 1.000000
d_prime: 1.230373
train_loss: 0.558681
valid_loss: 1.198100
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0034372162329946877
Epoch-3 lr: 0.0034372162329946877
epoch 3 training time: 7.452
---------------
2023-09-12 08:17:30.029643
current #epochs=4, #steps=24
start validation
acc: 0.590909
AUC: 0.840220
Avg Precision: 0.425792
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.606097
valid_loss: 1.172344
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0021342636458861956
Epoch-4 lr: 0.0021342636458861956
epoch 4 training time: 8.820
---------------
2023-09-12 08:17:38.849122
current #epochs=5, #steps=32
start validation
acc: 0.613636
AUC: 0.836088
Avg Precision: 0.433994
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.523529
valid_loss: 1.168921
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0021342636458861956
Epoch-5 lr: 0.0021342636458861956
epoch 5 training time: 9.282
---------------
2023-09-12 08:17:48.131288
current #epochs=6, #steps=40
start validation
acc: 0.659091
AUC: 0.798209
Avg Precision: 0.445602
Avg Recall: 1.000000
d_prime: 1.181211
train_loss: 0.519961
valid_loss: 1.183266
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0021342636458861956
Epoch-6 lr: 0.0021342636458861956
epoch 6 training time: 10.176
---------------
2023-09-12 08:17:58.308007
current #epochs=7, #steps=48
start validation
acc: 0.681818
AUC: 0.856749
Avg Precision: 0.440383
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.456496
valid_loss: 1.141761
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0021342636458861956
Epoch-7 lr: 0.0021342636458861956
epoch 7 training time: 10.271
---------------
2023-09-12 08:18:08.578834
current #epochs=8, #steps=56
start validation
acc: 0.500000
AUC: 0.846419
Avg Precision: 0.391945
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.487540
valid_loss: 1.145084
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0021342636458861956
Epoch-8 lr: 0.0021342636458861956
epoch 8 training time: 6.511
---------------
2023-09-12 08:18:15.089591
current #epochs=9, #steps=64
start validation
acc: 0.545455
AUC: 0.825069
Avg Precision: 0.394573
Avg Recall: 1.000000
d_prime: 1.322087
train_loss: 0.473135
valid_loss: 1.161460
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0013252239607232403
Epoch-9 lr: 0.0013252239607232403
epoch 9 training time: 6.522
---------------
2023-09-12 08:18:21.611936
current #epochs=10, #steps=72
start validation
acc: 0.636364
AUC: 0.814738
Avg Precision: 0.406548
Avg Recall: 1.000000
d_prime: 1.266419
train_loss: 0.432942
valid_loss: 1.167336
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0013252239607232403
Epoch-10 lr: 0.0013252239607232403
epoch 10 training time: 8.936
---------------
2023-09-12 08:18:30.547352
current #epochs=11, #steps=80
start validation
acc: 0.636364
AUC: 0.825069
Avg Precision: 0.427652
Avg Recall: 1.000000
d_prime: 1.322087
train_loss: 0.469175
valid_loss: 1.163960
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0013252239607232403
Epoch-11 lr: 0.0013252239607232403
epoch 11 training time: 6.243
---------------
2023-09-12 08:18:36.790645
current #epochs=12, #steps=88
start validation
acc: 0.636364
AUC: 0.830579
Avg Precision: 0.423236
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.424168
valid_loss: 1.151979
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0013252239607232403
Epoch-12 lr: 0.0013252239607232403
epoch 12 training time: 8.349
---------------
2023-09-12 08:18:45.139274
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01177	Per Sample Data Time 0.00618	Per Sample DNN Time 0.00559	Train Loss 0.4906	
start validation
acc: 0.659091
AUC: 0.824380
Avg Precision: 0.376054
Avg Recall: 1.000000
d_prime: 1.318312
train_loss: 0.446797
valid_loss: 1.149949
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0013252239607232403
Epoch-13 lr: 0.0013252239607232403
epoch 13 training time: 6.328
---------------
2023-09-12 08:18:51.467152
current #epochs=14, #steps=104
start validation
acc: 0.659091
AUC: 0.837466
Avg Precision: 0.382241
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.418936
valid_loss: 1.144892
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0008228686036329733
Epoch-14 lr: 0.0008228686036329733
epoch 14 training time: 7.331
---------------
2023-09-12 08:18:58.798058
current #epochs=15, #steps=112
start validation
acc: 0.659091
AUC: 0.836088
Avg Precision: 0.382241
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.373883
valid_loss: 1.148393
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0008228686036329733
Epoch-15 lr: 0.0008228686036329733
epoch 15 training time: 7.139
---------------
2023-09-12 08:19:05.937560
current #epochs=16, #steps=120
start validation
acc: 0.659091
AUC: 0.831267
Avg Precision: 0.392201
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.384457
valid_loss: 1.151707
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0008228686036329733
Epoch-16 lr: 0.0008228686036329733
epoch 16 training time: 6.377
---------------
2023-09-12 08:19:12.314750
current #epochs=17, #steps=128
start validation
acc: 0.681818
AUC: 0.835399
Avg Precision: 0.404152
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.411749
valid_loss: 1.147306
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0008228686036329733
Epoch-17 lr: 0.0008228686036329733
epoch 17 training time: 6.727
---------------
2023-09-12 08:19:19.041806
current #epochs=18, #steps=136
start validation
acc: 0.659091
AUC: 0.829890
Avg Precision: 0.424622
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.367852
valid_loss: 1.147455
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0008228686036329733
Epoch-18 lr: 0.0008228686036329733
epoch 18 training time: 6.216
---------------
2023-09-12 08:19:25.257753
current #epochs=19, #steps=144
start validation
acc: 0.659091
AUC: 0.825069
Avg Precision: 0.409935
Avg Recall: 1.000000
d_prime: 1.322087
train_loss: 0.377481
valid_loss: 1.146738
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.000510942119153464
Epoch-19 lr: 0.000510942119153464
epoch 19 training time: 6.241
---------------
2023-09-12 08:19:31.498356
current #epochs=20, #steps=152
start validation
acc: 0.659091
AUC: 0.827824
Avg Precision: 0.406297
Avg Recall: 1.000000
d_prime: 1.337280
train_loss: 0.486321
valid_loss: 1.143729
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.000510942119153464
Epoch-20 lr: 0.000510942119153464
epoch 20 training time: 6.642
---------------
2023-09-12 08:19:38.140422
current #epochs=21, #steps=160
start validation
acc: 0.681818
AUC: 0.834711
Avg Precision: 0.410942
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.363101
valid_loss: 1.136354
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.000510942119153464
Epoch-21 lr: 0.000510942119153464
epoch 21 training time: 6.420
---------------
2023-09-12 08:19:44.560834
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.843664
Avg Precision: 0.408907
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.325699
valid_loss: 1.130651
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.000510942119153464
Epoch-22 lr: 0.000510942119153464
epoch 22 training time: 6.241
---------------
2023-09-12 08:19:50.802105
current #epochs=23, #steps=176
start validation
acc: 0.636364
AUC: 0.842287
Avg Precision: 0.408907
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.379230
valid_loss: 1.128992
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.000510942119153464
Epoch-23 lr: 0.000510942119153464
epoch 23 training time: 6.803
---------------
2023-09-12 08:19:57.605124
current #epochs=24, #steps=184
start validation
acc: 0.659091
AUC: 0.842287
Avg Precision: 0.414859
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.380533
valid_loss: 1.129447
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00031725824508608283
Epoch-24 lr: 0.00031725824508608283
epoch 24 training time: 6.456
---------------
2023-09-12 08:20:04.061531
current #epochs=25, #steps=192
start validation
[I 2023-09-12 08:20:10,254] Trial 29 finished with value: 0.6818181818181818 and parameters: {'warmup': 'False', 'num_epochs': 25, 'batch_size': 15, 'lr-adaptschedule': 'True', 'lr': 0.0034372162329946877, 'head-lr': 1, 'lr-scheduler-start': 4, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.6209279548370776}. Best is trial 26 with value: 0.6818181818181818.
acc: 0.659091
AUC: 0.838843
Avg Precision: 0.414859
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.405302
valid_loss: 1.129832
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00031725824508608283
Epoch-25 lr: 0.00031725824508608283
epoch 25 training time: 6.188
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f957c0005b0>
The learning rate scheduler starts at 4 epoch with decay rate of 0.663 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 08:20:10.292473
current #epochs=1, #steps=0
start validation
acc: 0.590909
AUC: 0.818871
Avg Precision: 0.411325
Avg Recall: 1.000000
d_prime: 1.288446
train_loss: 0.428612
valid_loss: 1.159617
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002710209623788547
Epoch-1 lr: 0.002710209623788547
epoch 1 training time: 8.864
---------------
2023-09-12 08:20:19.156927
current #epochs=2, #steps=8
start validation
acc: 0.568182
AUC: 0.820937
Avg Precision: 0.395800
Avg Recall: 1.000000
d_prime: 1.299578
train_loss: 0.459485
valid_loss: 1.174446
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002710209623788547
Epoch-2 lr: 0.002710209623788547
epoch 2 training time: 6.649
---------------
2023-09-12 08:20:25.805441
current #epochs=3, #steps=16
start validation
acc: 0.613636
AUC: 0.803030
Avg Precision: 0.411929
Avg Recall: 1.000000
d_prime: 1.205610
train_loss: 0.445599
valid_loss: 1.172108
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002710209623788547
Epoch-3 lr: 0.002710209623788547
epoch 3 training time: 8.786
---------------
2023-09-12 08:20:34.591753
current #epochs=4, #steps=24
start validation
acc: 0.590909
AUC: 0.804408
Avg Precision: 0.419245
Avg Recall: 1.000000
d_prime: 1.212647
train_loss: 0.442748
valid_loss: 1.173863
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0017975062597282386
Epoch-4 lr: 0.0017975062597282386
epoch 4 training time: 7.532
---------------
2023-09-12 08:20:42.123844
current #epochs=5, #steps=32
start validation
acc: 0.568182
AUC: 0.815427
Avg Precision: 0.411282
Avg Recall: 1.000000
d_prime: 1.270069
train_loss: 0.388669
valid_loss: 1.168220
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0017975062597282386
Epoch-5 lr: 0.0017975062597282386
epoch 5 training time: 6.480
---------------
2023-09-12 08:20:48.604038
current #epochs=6, #steps=40
start validation
acc: 0.590909
AUC: 0.825758
Avg Precision: 0.364050
Avg Recall: 1.000000
d_prime: 1.325871
train_loss: 0.390621
valid_loss: 1.158821
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0017975062597282386
Epoch-6 lr: 0.0017975062597282386
epoch 6 training time: 6.226
---------------
2023-09-12 08:20:54.830305
current #epochs=7, #steps=48
start validation
acc: 0.590909
AUC: 0.829201
Avg Precision: 0.403387
Avg Recall: 1.000000
d_prime: 1.344935
train_loss: 0.410976
valid_loss: 1.160258
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0017975062597282386
Epoch-7 lr: 0.0017975062597282386
epoch 7 training time: 7.027
---------------
2023-09-12 08:21:01.856907
current #epochs=8, #steps=56
start validation
acc: 0.659091
AUC: 0.838154
Avg Precision: 0.409260
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.394778
valid_loss: 1.150696
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0017975062597282386
Epoch-8 lr: 0.0017975062597282386
epoch 8 training time: 9.214
---------------
2023-09-12 08:21:11.071181
current #epochs=9, #steps=64
start validation
acc: 0.659091
AUC: 0.834022
Avg Precision: 0.404021
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.394753
valid_loss: 1.147982
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0011921693161304667
Epoch-9 lr: 0.0011921693161304667
epoch 9 training time: 8.749
---------------
2023-09-12 08:21:19.819751
current #epochs=10, #steps=72
start validation
acc: 0.636364
AUC: 0.814050
Avg Precision: 0.387249
Avg Recall: 1.000000
d_prime: 1.262777
train_loss: 0.361124
valid_loss: 1.164268
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0011921693161304667
Epoch-10 lr: 0.0011921693161304667
epoch 10 training time: 6.379
---------------
2023-09-12 08:21:26.198671
current #epochs=11, #steps=80
start validation
acc: 0.636364
AUC: 0.836088
Avg Precision: 0.411934
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.399665
valid_loss: 1.149531
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0011921693161304667
Epoch-11 lr: 0.0011921693161304667
epoch 11 training time: 8.671
---------------
2023-09-12 08:21:34.869423
current #epochs=12, #steps=88
start validation
acc: 0.659091
AUC: 0.825758
Avg Precision: 0.420847
Avg Recall: 1.000000
d_prime: 1.325871
train_loss: 0.359082
valid_loss: 1.156030
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0011921693161304667
Epoch-12 lr: 0.0011921693161304667
epoch 12 training time: 6.140
---------------
2023-09-12 08:21:41.009039
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01152	Per Sample Data Time 0.00574	Per Sample DNN Time 0.00578	Train Loss 0.3330	
start validation
acc: 0.636364
AUC: 0.820248
Avg Precision: 0.369044
Avg Recall: 1.000000
d_prime: 1.295859
train_loss: 0.377417
valid_loss: 1.165397
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0011921693161304667
Epoch-13 lr: 0.0011921693161304667
epoch 13 training time: 6.676
---------------
2023-09-12 08:21:47.685438
current #epochs=14, #steps=104
start validation
acc: 0.636364
AUC: 0.820248
Avg Precision: 0.365883
Avg Recall: 1.000000
d_prime: 1.295859
train_loss: 0.413050
valid_loss: 1.161439
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0007906885834922564
Epoch-14 lr: 0.0007906885834922564
epoch 14 training time: 6.412
---------------
2023-09-12 08:21:54.097625
current #epochs=15, #steps=112
start validation
acc: 0.659091
AUC: 0.824380
Avg Precision: 0.394271
Avg Recall: 1.000000
d_prime: 1.318312
train_loss: 0.332549
valid_loss: 1.159296
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0007906885834922564
Epoch-15 lr: 0.0007906885834922564
epoch 15 training time: 7.352
---------------
2023-09-12 08:22:01.449511
current #epochs=16, #steps=120
start validation
acc: 0.613636
AUC: 0.829201
Avg Precision: 0.390245
Avg Recall: 1.000000
d_prime: 1.344935
train_loss: 0.358971
valid_loss: 1.158136
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0007906885834922564
Epoch-16 lr: 0.0007906885834922564
epoch 16 training time: 6.269
---------------
2023-09-12 08:22:07.718533
current #epochs=17, #steps=128
start validation
acc: 0.613636
AUC: 0.816804
Avg Precision: 0.346759
Avg Recall: 1.000000
d_prime: 1.277394
train_loss: 0.389208
valid_loss: 1.159588
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0007906885834922564
Epoch-17 lr: 0.0007906885834922564
epoch 17 training time: 6.338
---------------
2023-09-12 08:22:14.056833
current #epochs=18, #steps=136
start validation
acc: 0.636364
AUC: 0.799587
Avg Precision: 0.315075
Avg Recall: 1.000000
d_prime: 1.188146
train_loss: 0.341639
valid_loss: 1.170226
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0007906885834922564
Epoch-18 lr: 0.0007906885834922564
epoch 18 training time: 7.574
---------------
2023-09-12 08:22:21.630721
current #epochs=19, #steps=144
start validation
acc: 0.613636
AUC: 0.798898
Avg Precision: 0.320301
Avg Recall: 1.000000
d_prime: 1.184675
train_loss: 0.352855
valid_loss: 1.174840
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0005244124535046937
Epoch-19 lr: 0.0005244124535046937
epoch 19 training time: 8.047
---------------
2023-09-12 08:22:29.677957
current #epochs=20, #steps=152
start validation
acc: 0.636364
AUC: 0.795455
Avg Precision: 0.325998
Avg Recall: 1.000000
d_prime: 1.167426
train_loss: 0.413549
valid_loss: 1.176065
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0005244124535046937
Epoch-20 lr: 0.0005244124535046937
epoch 20 training time: 6.249
---------------
2023-09-12 08:22:35.927412
current #epochs=21, #steps=160
start validation
acc: 0.681818
AUC: 0.803719
Avg Precision: 0.338608
Avg Recall: 1.000000
d_prime: 1.209125
train_loss: 0.323435
valid_loss: 1.171371
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0005244124535046937
Epoch-21 lr: 0.0005244124535046937
epoch 21 training time: 9.683
---------------
2023-09-12 08:22:45.610434
current #epochs=22, #steps=168
start validation
acc: 0.659091
AUC: 0.809917
Avg Precision: 0.338356
Avg Recall: 1.000000
d_prime: 1.241102
train_loss: 0.375759
valid_loss: 1.169216
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0005244124535046937
Epoch-22 lr: 0.0005244124535046937
epoch 22 training time: 6.299
---------------
2023-09-12 08:22:51.909314
current #epochs=23, #steps=176
start validation
acc: 0.659091
AUC: 0.802342
Avg Precision: 0.341266
Avg Recall: 1.000000
d_prime: 1.202103
train_loss: 0.376971
valid_loss: 1.175330
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0005244124535046937
Epoch-23 lr: 0.0005244124535046937
epoch 23 training time: 6.203
---------------
2023-09-12 08:22:58.112793
current #epochs=24, #steps=184
start validation
acc: 0.659091
AUC: 0.798209
Avg Precision: 0.329805
Avg Recall: 1.000000
d_prime: 1.181211
train_loss: 0.346573
valid_loss: 1.171790
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00034780876710799986
Epoch-24 lr: 0.00034780876710799986
epoch 24 training time: 6.320
---------------
2023-09-12 08:23:04.433488
current #epochs=25, #steps=192
start validation
acc: 0.681818
AUC: 0.816804
Avg Precision: 0.324112
Avg Recall: 1.000000
d_prime: 1.277394
train_loss: 0.317652
valid_loss: 1.152028
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00034780876710799986
Epoch-25 lr: 0.00034780876710799986
epoch 25 training time: 6.295
---------------
2023-09-12 08:23:10.728797
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03714	Per Sample Data Time 0.02948	Per Sample DNN Time 0.00766	Train Loss 0.3904	
start validation
acc: 0.659091
AUC: 0.816804
Avg Precision: 0.314291
Avg Recall: 1.000000
d_prime: 1.277394
train_loss: 0.337880
valid_loss: 1.146370
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00034780876710799986
Epoch-26 lr: 0.00034780876710799986
epoch 26 training time: 6.624
---------------
2023-09-12 08:23:17.352768
current #epochs=27, #steps=208
start validation
acc: 0.704545
AUC: 0.813361
Avg Precision: 0.319865
Avg Recall: 1.000000
d_prime: 1.259144
train_loss: 0.326520
valid_loss: 1.150048
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00034780876710799986
Epoch-27 lr: 0.00034780876710799986
epoch 27 training time: 8.900
---------------
2023-09-12 08:23:26.253350
current #epochs=28, #steps=216
start validation
acc: 0.613636
AUC: 0.804408
Avg Precision: 0.334482
Avg Recall: 1.000000
d_prime: 1.212647
train_loss: 0.330243
valid_loss: 1.163422
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00034780876710799986
Epoch-28 lr: 0.00034780876710799986
epoch 28 training time: 6.231
---------------
2023-09-12 08:23:32.484239
current #epochs=29, #steps=224
start validation
acc: 0.613636
AUC: 0.800275
Avg Precision: 0.339735
Avg Recall: 1.000000
d_prime: 1.191624
train_loss: 0.365418
valid_loss: 1.166998
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00023067899640583984
Epoch-29 lr: 0.00023067899640583984
epoch 29 training time: 7.595
---------------
2023-09-12 08:23:40.079305
current #epochs=30, #steps=232
start validation
[I 2023-09-12 08:23:46,547] Trial 30 finished with value: 0.7045454545454546 and parameters: {'warmup': 'False', 'num_epochs': 30, 'batch_size': 14, 'lr-adaptschedule': 'True', 'lr': 0.002710209623788547, 'head-lr': 1, 'lr-scheduler-start': 4, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.6632351401717558}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.613636
AUC: 0.801653
Avg Precision: 0.339735
Avg Recall: 1.000000
d_prime: 1.198603
train_loss: 0.350438
valid_loss: 1.166020
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00023067899640583984
Epoch-30 lr: 0.00023067899640583984
epoch 30 training time: 6.463
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8e11b50>
The learning rate scheduler starts at 4 epoch with decay rate of 0.664 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 08:23:46.583386
current #epochs=1, #steps=0
start validation
acc: 0.636364
AUC: 0.804408
Avg Precision: 0.325434
Avg Recall: 1.000000
d_prime: 1.212647
train_loss: 0.560017
valid_loss: 1.182016
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0028092852764693343
Epoch-1 lr: 0.0028092852764693343
epoch 1 training time: 10.788
---------------
2023-09-12 08:23:57.371603
current #epochs=2, #steps=8
start validation
acc: 0.590909
AUC: 0.827824
Avg Precision: 0.393382
Avg Recall: 1.000000
d_prime: 1.337280
train_loss: 0.538147
valid_loss: 1.156789
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0028092852764693343
Epoch-2 lr: 0.0028092852764693343
epoch 2 training time: 8.122
---------------
2023-09-12 08:24:05.493271
current #epochs=3, #steps=16
start validation
acc: 0.590909
AUC: 0.831956
Avg Precision: 0.360975
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.432648
valid_loss: 1.170122
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0028092852764693343
Epoch-3 lr: 0.0028092852764693343
epoch 3 training time: 6.663
---------------
2023-09-12 08:24:12.155846
current #epochs=4, #steps=24
start validation
acc: 0.659091
AUC: 0.836777
Avg Precision: 0.398642
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.426108
valid_loss: 1.144742
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00186427229392079
Epoch-4 lr: 0.00186427229392079
epoch 4 training time: 9.259
---------------
2023-09-12 08:24:21.415364
current #epochs=5, #steps=32
start validation
acc: 0.613636
AUC: 0.845041
Avg Precision: 0.376190
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.430428
valid_loss: 1.134426
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00186427229392079
Epoch-5 lr: 0.00186427229392079
epoch 5 training time: 7.039
---------------
2023-09-12 08:24:28.454143
current #epochs=6, #steps=40
start validation
acc: 0.613636
AUC: 0.840220
Avg Precision: 0.356553
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.386540
valid_loss: 1.128499
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00186427229392079
Epoch-6 lr: 0.00186427229392079
epoch 6 training time: 8.110
---------------
2023-09-12 08:24:36.564473
current #epochs=7, #steps=48
start validation
acc: 0.613636
AUC: 0.832645
Avg Precision: 0.398349
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.415798
valid_loss: 1.127028
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00186427229392079
Epoch-7 lr: 0.00186427229392079
epoch 7 training time: 6.197
---------------
2023-09-12 08:24:42.760966
current #epochs=8, #steps=56
start validation
acc: 0.636364
AUC: 0.832645
Avg Precision: 0.386824
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.398513
valid_loss: 1.119599
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00186427229392079
Epoch-8 lr: 0.00186427229392079
epoch 8 training time: 7.954
---------------
2023-09-12 08:24:50.715443
current #epochs=9, #steps=64
start validation
acc: 0.659091
AUC: 0.835399
Avg Precision: 0.383867
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.425647
valid_loss: 1.125158
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0012371513904236354
Epoch-9 lr: 0.0012371513904236354
epoch 9 training time: 7.454
---------------
2023-09-12 08:24:58.169421
current #epochs=10, #steps=72
start validation
acc: 0.636364
AUC: 0.835399
Avg Precision: 0.371199
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.394950
valid_loss: 1.133507
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0012371513904236354
Epoch-10 lr: 0.0012371513904236354
epoch 10 training time: 6.329
---------------
2023-09-12 08:25:04.498012
current #epochs=11, #steps=80
start validation
acc: 0.681818
AUC: 0.835399
Avg Precision: 0.359762
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.289072
valid_loss: 1.135778
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0012371513904236354
Epoch-11 lr: 0.0012371513904236354
epoch 11 training time: 9.118
---------------
2023-09-12 08:25:13.616094
current #epochs=12, #steps=88
start validation
acc: 0.636364
AUC: 0.848485
Avg Precision: 0.378631
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.419111
valid_loss: 1.130205
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0012371513904236354
Epoch-12 lr: 0.0012371513904236354
epoch 12 training time: 6.755
---------------
2023-09-12 08:25:20.370615
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01160	Per Sample Data Time 0.00601	Per Sample DNN Time 0.00558	Train Loss 0.3374	
start validation
acc: 0.659091
AUC: 0.820937
Avg Precision: 0.327896
Avg Recall: 1.000000
d_prime: 1.299578
train_loss: 0.362504
valid_loss: 1.144464
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0012371513904236354
Epoch-13 lr: 0.0012371513904236354
epoch 13 training time: 6.924
---------------
2023-09-12 08:25:27.295091
current #epochs=14, #steps=104
start validation
acc: 0.659091
AUC: 0.803030
Avg Precision: 0.319172
Avg Recall: 1.000000
d_prime: 1.205610
train_loss: 0.366299
valid_loss: 1.167621
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0008209871314496748
Epoch-14 lr: 0.0008209871314496748
epoch 14 training time: 8.432
---------------
2023-09-12 08:25:35.727147
current #epochs=15, #steps=112
start validation
acc: 0.659091
AUC: 0.814738
Avg Precision: 0.328721
Avg Recall: 1.000000
d_prime: 1.266419
train_loss: 0.387695
valid_loss: 1.151405
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0008209871314496748
Epoch-15 lr: 0.0008209871314496748
epoch 15 training time: 7.291
---------------
2023-09-12 08:25:43.017722
current #epochs=16, #steps=120
start validation
acc: 0.704545
AUC: 0.822314
Avg Precision: 0.341467
Avg Recall: 1.000000
d_prime: 1.307044
train_loss: 0.332800
valid_loss: 1.147382
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0008209871314496748
Epoch-16 lr: 0.0008209871314496748
epoch 16 training time: 10.404
---------------
2023-09-12 08:25:53.421423
current #epochs=17, #steps=128
start validation
acc: 0.659091
AUC: 0.825069
Avg Precision: 0.351969
Avg Recall: 1.000000
d_prime: 1.322087
train_loss: 0.286481
valid_loss: 1.148304
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0008209871314496748
Epoch-17 lr: 0.0008209871314496748
epoch 17 training time: 7.909
---------------
2023-09-12 08:26:01.330656
current #epochs=18, #steps=136
start validation
acc: 0.659091
AUC: 0.820937
Avg Precision: 0.355094
Avg Recall: 1.000000
d_prime: 1.299578
train_loss: 0.315755
valid_loss: 1.157287
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0008209871314496748
Epoch-18 lr: 0.0008209871314496748
epoch 18 training time: 7.129
---------------
2023-09-12 08:26:08.459397
current #epochs=19, #steps=144
start validation
acc: 0.659091
AUC: 0.831267
Avg Precision: 0.363499
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.340904
valid_loss: 1.146643
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0005448159984487932
Epoch-19 lr: 0.0005448159984487932
epoch 19 training time: 6.770
---------------
2023-09-12 08:26:15.229255
current #epochs=20, #steps=152
start validation
acc: 0.636364
AUC: 0.828512
Avg Precision: 0.349647
Avg Recall: 1.000000
d_prime: 1.341103
train_loss: 0.326214
valid_loss: 1.141956
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0005448159984487932
Epoch-20 lr: 0.0005448159984487932
epoch 20 training time: 6.352
---------------
2023-09-12 08:26:21.581091
current #epochs=21, #steps=160
start validation
acc: 0.659091
AUC: 0.829890
Avg Precision: 0.362313
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.435630
valid_loss: 1.141512
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0005448159984487932
Epoch-21 lr: 0.0005448159984487932
epoch 21 training time: 6.246
---------------
2023-09-12 08:26:27.827451
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.826446
Avg Precision: 0.362789
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.369759
valid_loss: 1.144288
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0005448159984487932
Epoch-22 lr: 0.0005448159984487932
epoch 22 training time: 7.458
---------------
2023-09-12 08:26:35.285598
current #epochs=23, #steps=176
start validation
acc: 0.636364
AUC: 0.827135
Avg Precision: 0.362437
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.306294
valid_loss: 1.143654
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0005448159984487932
Epoch-23 lr: 0.0005448159984487932
epoch 23 training time: 6.282
---------------
2023-09-12 08:26:41.568190
current #epochs=24, #steps=184
start validation
acc: 0.636364
AUC: 0.832645
Avg Precision: 0.383727
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.315448
valid_loss: 1.141802
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.000361545827937195
Epoch-24 lr: 0.000361545827937195
epoch 24 training time: 6.477
---------------
2023-09-12 08:26:48.045098
current #epochs=25, #steps=192
start validation
[I 2023-09-12 08:26:54,551] Trial 31 finished with value: 0.7045454545454546 and parameters: {'warmup': 'False', 'num_epochs': 25, 'batch_size': 13, 'lr-adaptschedule': 'True', 'lr': 0.0028092852764693343, 'head-lr': 1, 'lr-scheduler-start': 4, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.6636108869170375}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.659091
AUC: 0.827135
Avg Precision: 0.398836
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.322496
valid_loss: 1.148294
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.000361545827937195
Epoch-25 lr: 0.000361545827937195
epoch 25 training time: 6.502
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8dd5ee0>
The learning rate scheduler starts at 4 epoch with decay rate of 0.622 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 08:26:54.585998
current #epochs=1, #steps=0
start validation
acc: 0.681818
AUC: 0.847796
Avg Precision: 0.363015
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.474277
valid_loss: 1.131916
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0027768922743960367
Epoch-1 lr: 0.0027768922743960367
epoch 1 training time: 10.632
---------------
2023-09-12 08:27:05.218765
current #epochs=2, #steps=8
start validation
acc: 0.590909
AUC: 0.837466
Avg Precision: 0.341884
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.498950
valid_loss: 1.168334
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0027768922743960367
Epoch-2 lr: 0.0027768922743960367
epoch 2 training time: 7.117
---------------
2023-09-12 08:27:12.335947
current #epochs=3, #steps=16
start validation
acc: 0.636364
AUC: 0.823003
Avg Precision: 0.349188
Avg Recall: 1.000000
d_prime: 1.310791
train_loss: 0.493797
valid_loss: 1.163122
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0027768922743960367
Epoch-3 lr: 0.0027768922743960367
epoch 3 training time: 7.466
---------------
2023-09-12 08:27:19.801704
current #epochs=4, #steps=24
start validation
acc: 0.613636
AUC: 0.841598
Avg Precision: 0.358972
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.420631
valid_loss: 1.141208
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0017263386624731087
Epoch-4 lr: 0.0017263386624731087
epoch 4 training time: 6.548
---------------
2023-09-12 08:27:26.350384
current #epochs=5, #steps=32
start validation
acc: 0.545455
AUC: 0.833333
Avg Precision: 0.345447
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.437618
valid_loss: 1.148767
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0017263386624731087
Epoch-5 lr: 0.0017263386624731087
epoch 5 training time: 7.020
---------------
2023-09-12 08:27:33.370761
current #epochs=6, #steps=40
start validation
acc: 0.636364
AUC: 0.851928
Avg Precision: 0.373865
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.435631
valid_loss: 1.126617
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0017263386624731087
Epoch-6 lr: 0.0017263386624731087
epoch 6 training time: 8.361
---------------
2023-09-12 08:27:41.731755
current #epochs=7, #steps=48
start validation
acc: 0.590909
AUC: 0.823691
Avg Precision: 0.373578
Avg Recall: 1.000000
d_prime: 1.314547
train_loss: 0.354571
valid_loss: 1.155339
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0017263386624731087
Epoch-7 lr: 0.0017263386624731087
epoch 7 training time: 6.959
---------------
2023-09-12 08:27:48.690753
current #epochs=8, #steps=56
start validation
acc: 0.590909
AUC: 0.796143
Avg Precision: 0.316011
Avg Recall: 1.000000
d_prime: 1.170861
train_loss: 0.336278
valid_loss: 1.163134
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0017263386624731087
Epoch-8 lr: 0.0017263386624731087
epoch 8 training time: 6.625
---------------
2023-09-12 08:27:55.315979
current #epochs=9, #steps=64
start validation
acc: 0.613636
AUC: 0.807851
Avg Precision: 0.335076
Avg Recall: 1.000000
d_prime: 1.230373
train_loss: 0.390846
valid_loss: 1.157399
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0010732303896079777
Epoch-9 lr: 0.0010732303896079777
epoch 9 training time: 6.556
---------------
2023-09-12 08:28:01.872388
current #epochs=10, #steps=72
start validation
acc: 0.590909
AUC: 0.814050
Avg Precision: 0.336599
Avg Recall: 1.000000
d_prime: 1.262777
train_loss: 0.351634
valid_loss: 1.154672
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0010732303896079777
Epoch-10 lr: 0.0010732303896079777
epoch 10 training time: 6.594
---------------
2023-09-12 08:28:08.466505
current #epochs=11, #steps=80
start validation
acc: 0.590909
AUC: 0.825758
Avg Precision: 0.365704
Avg Recall: 1.000000
d_prime: 1.325871
train_loss: 0.316632
valid_loss: 1.148284
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0010732303896079777
Epoch-11 lr: 0.0010732303896079777
epoch 11 training time: 6.496
---------------
2023-09-12 08:28:14.962301
current #epochs=12, #steps=88
start validation
acc: 0.590909
AUC: 0.832645
Avg Precision: 0.370466
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.294988
valid_loss: 1.138627
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0010732303896079777
Epoch-12 lr: 0.0010732303896079777
epoch 12 training time: 6.226
---------------
2023-09-12 08:28:21.188667
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01211	Per Sample Data Time 0.00637	Per Sample DNN Time 0.00574	Train Loss 0.3967	
start validation
acc: 0.636364
AUC: 0.829890
Avg Precision: 0.346344
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.354178
valid_loss: 1.140716
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0010732303896079777
Epoch-13 lr: 0.0010732303896079777
epoch 13 training time: 6.691
---------------
2023-09-12 08:28:27.880386
current #epochs=14, #steps=104
start validation
acc: 0.590909
AUC: 0.820937
Avg Precision: 0.332179
Avg Recall: 1.000000
d_prime: 1.299578
train_loss: 0.295460
valid_loss: 1.148899
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.000667205974248424
Epoch-14 lr: 0.000667205974248424
epoch 14 training time: 9.137
---------------
2023-09-12 08:28:37.017774
current #epochs=15, #steps=112
start validation
acc: 0.636364
AUC: 0.827824
Avg Precision: 0.339873
Avg Recall: 1.000000
d_prime: 1.337280
train_loss: 0.294094
valid_loss: 1.141592
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.000667205974248424
Epoch-15 lr: 0.000667205974248424
epoch 15 training time: 8.179
---------------
2023-09-12 08:28:45.197074
current #epochs=16, #steps=120
start validation
acc: 0.636364
AUC: 0.824380
Avg Precision: 0.351639
Avg Recall: 1.000000
d_prime: 1.318312
train_loss: 0.319316
valid_loss: 1.142707
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.000667205974248424
Epoch-16 lr: 0.000667205974248424
epoch 16 training time: 7.021
---------------
2023-09-12 08:28:52.218037
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.817493
Avg Precision: 0.351639
Avg Recall: 1.000000
d_prime: 1.281069
train_loss: 0.323690
valid_loss: 1.151103
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.000667205974248424
Epoch-17 lr: 0.000667205974248424
epoch 17 training time: 6.814
---------------
2023-09-12 08:28:59.031713
current #epochs=18, #steps=136
start validation
acc: 0.613636
AUC: 0.824380
Avg Precision: 0.363846
Avg Recall: 1.000000
d_prime: 1.318312
train_loss: 0.298974
valid_loss: 1.148398
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.000667205974248424
Epoch-18 lr: 0.000667205974248424
epoch 18 training time: 12.936
---------------
2023-09-12 08:29:11.967344
current #epochs=19, #steps=144
start validation
acc: 0.613636
AUC: 0.831956
Avg Precision: 0.372961
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.312483
valid_loss: 1.142465
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0004147886757431413
Epoch-19 lr: 0.0004147886757431413
epoch 19 training time: 6.364
---------------
2023-09-12 08:29:18.331791
current #epochs=20, #steps=152
start validation
acc: 0.636364
AUC: 0.837466
Avg Precision: 0.369522
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.279861
valid_loss: 1.136952
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0004147886757431413
Epoch-20 lr: 0.0004147886757431413
epoch 20 training time: 8.121
---------------
2023-09-12 08:29:26.453432
current #epochs=21, #steps=160
start validation
acc: 0.613636
AUC: 0.836777
Avg Precision: 0.368038
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.287211
valid_loss: 1.136187
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0004147886757431413
Epoch-21 lr: 0.0004147886757431413
epoch 21 training time: 6.455
---------------
2023-09-12 08:29:32.908100
current #epochs=22, #steps=168
start validation
acc: 0.613636
AUC: 0.833333
Avg Precision: 0.370655
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.398637
valid_loss: 1.143570
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0004147886757431413
Epoch-22 lr: 0.0004147886757431413
epoch 22 training time: 8.044
---------------
2023-09-12 08:29:40.952054
current #epochs=23, #steps=176
start validation
acc: 0.613636
AUC: 0.826446
Avg Precision: 0.375200
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.366195
valid_loss: 1.149430
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0004147886757431413
Epoch-23 lr: 0.0004147886757431413
epoch 23 training time: 6.223
---------------
2023-09-12 08:29:47.175028
current #epochs=24, #steps=184
start validation
[I 2023-09-12 08:29:54,500] Trial 32 finished with value: 0.6818181818181818 and parameters: {'warmup': 'False', 'num_epochs': 24, 'batch_size': 24, 'lr-adaptschedule': 'True', 'lr': 0.0027768922743960367, 'head-lr': 1, 'lr-scheduler-start': 4, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.6216800984289463}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.613636
AUC: 0.818871
Avg Precision: 0.367154
Avg Recall: 1.000000
d_prime: 1.288446
train_loss: 0.276552
valid_loss: 1.153113
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0002578658647632084
Epoch-24 lr: 0.0002578658647632084
epoch 24 training time: 7.320
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8dd5910>
The learning rate scheduler starts at 4 epoch with decay rate of 0.660 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 08:29:54.534572
current #epochs=1, #steps=0
start validation
acc: 0.590909
AUC: 0.818871
Avg Precision: 0.400427
Avg Recall: 1.000000
d_prime: 1.288446
train_loss: 0.437221
valid_loss: 1.164138
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0026062871913365452
Epoch-1 lr: 0.0026062871913365452
epoch 1 training time: 9.584
---------------
2023-09-12 08:30:04.118858
current #epochs=2, #steps=8
start validation
acc: 0.659091
AUC: 0.832645
Avg Precision: 0.360825
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.502392
valid_loss: 1.148343
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0026062871913365452
Epoch-2 lr: 0.0026062871913365452
epoch 2 training time: 12.032
---------------
2023-09-12 08:30:16.151266
current #epochs=3, #steps=16
start validation
acc: 0.545455
AUC: 0.776171
Avg Precision: 0.340575
Avg Recall: 1.000000
d_prime: 1.073847
train_loss: 0.384835
valid_loss: 1.207954
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0026062871913365452
Epoch-3 lr: 0.0026062871913365452
epoch 3 training time: 7.663
---------------
2023-09-12 08:30:23.814327
current #epochs=4, #steps=24
start validation
acc: 0.590909
AUC: 0.796143
Avg Precision: 0.360170
Avg Recall: 1.000000
d_prime: 1.170861
train_loss: 0.552398
valid_loss: 1.187209
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0017197977612671052
Epoch-4 lr: 0.0017197977612671052
epoch 4 training time: 7.515
---------------
2023-09-12 08:30:31.328971
current #epochs=5, #steps=32
start validation
acc: 0.590909
AUC: 0.809917
Avg Precision: 0.349694
Avg Recall: 1.000000
d_prime: 1.241102
train_loss: 0.441470
valid_loss: 1.179892
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0017197977612671052
Epoch-5 lr: 0.0017197977612671052
epoch 5 training time: 6.588
---------------
2023-09-12 08:30:37.916759
current #epochs=6, #steps=40
start validation
acc: 0.613636
AUC: 0.825069
Avg Precision: 0.397222
Avg Recall: 1.000000
d_prime: 1.322087
train_loss: 0.374508
valid_loss: 1.160438
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0017197977612671052
Epoch-6 lr: 0.0017197977612671052
epoch 6 training time: 8.478
---------------
2023-09-12 08:30:46.394208
current #epochs=7, #steps=48
start validation
acc: 0.613636
AUC: 0.834022
Avg Precision: 0.408514
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.363132
valid_loss: 1.155995
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0017197977612671052
Epoch-7 lr: 0.0017197977612671052
epoch 7 training time: 6.525
---------------
2023-09-12 08:30:52.918888
current #epochs=8, #steps=56
start validation
acc: 0.659091
AUC: 0.862948
Avg Precision: 0.384401
Avg Recall: 1.000000
d_prime: 1.546667
train_loss: 0.342936
valid_loss: 1.129457
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0011348343918087514
Epoch-8 lr: 0.0011348343918087514
epoch 8 training time: 7.571
---------------
2023-09-12 08:31:00.489923
current #epochs=9, #steps=64
start validation
acc: 0.681818
AUC: 0.860882
Avg Precision: 0.382532
Avg Recall: 1.000000
d_prime: 1.533415
train_loss: 0.309740
valid_loss: 1.125697
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0011348343918087514
Epoch-9 lr: 0.0011348343918087514
epoch 9 training time: 10.922
---------------
2023-09-12 08:31:11.411461
current #epochs=10, #steps=72
start validation
acc: 0.659091
AUC: 0.843664
Avg Precision: 0.368633
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.356998
valid_loss: 1.133016
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0011348343918087514
Epoch-10 lr: 0.0011348343918087514
epoch 10 training time: 8.334
---------------
2023-09-12 08:31:19.745521
current #epochs=11, #steps=80
start validation
acc: 0.659091
AUC: 0.838154
Avg Precision: 0.357830
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.327426
valid_loss: 1.137566
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0011348343918087514
Epoch-11 lr: 0.0011348343918087514
epoch 11 training time: 8.791
---------------
2023-09-12 08:31:28.536524
current #epochs=12, #steps=88
start validation
acc: 0.659091
AUC: 0.830579
Avg Precision: 0.381888
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.350037
valid_loss: 1.138903
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0007488375237115571
Epoch-12 lr: 0.0007488375237115571
epoch 12 training time: 6.318
---------------
2023-09-12 08:31:34.854997
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01172	Per Sample Data Time 0.00596	Per Sample DNN Time 0.00576	Train Loss 0.3178	
start validation
acc: 0.659091
AUC: 0.819559
Avg Precision: 0.375609
Avg Recall: 1.000000
d_prime: 1.292148
train_loss: 0.316892
valid_loss: 1.142434
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0007488375237115571
Epoch-13 lr: 0.0007488375237115571
epoch 13 training time: 7.536
---------------
2023-09-12 08:31:42.390724
current #epochs=14, #steps=104
start validation
acc: 0.681818
AUC: 0.822314
Avg Precision: 0.386438
Avg Recall: 1.000000
d_prime: 1.307044
train_loss: 0.364523
valid_loss: 1.146038
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0007488375237115571
Epoch-14 lr: 0.0007488375237115571
epoch 14 training time: 6.656
---------------
2023-09-12 08:31:49.046953
current #epochs=15, #steps=112
start validation
acc: 0.636364
AUC: 0.827135
Avg Precision: 0.390495
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.319917
valid_loss: 1.143361
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0007488375237115571
Epoch-15 lr: 0.0007488375237115571
epoch 15 training time: 7.624
---------------
2023-09-12 08:31:56.671080
current #epochs=16, #steps=120
start validation
acc: 0.636364
AUC: 0.831267
Avg Precision: 0.391667
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.279087
valid_loss: 1.142086
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0004941316909022254
Epoch-16 lr: 0.0004941316909022254
epoch 16 training time: 6.379
---------------
2023-09-12 08:32:03.050490
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.827824
Avg Precision: 0.384446
Avg Recall: 1.000000
d_prime: 1.337280
train_loss: 0.318621
valid_loss: 1.143376
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0004941316909022254
Epoch-17 lr: 0.0004941316909022254
epoch 17 training time: 7.615
---------------
2023-09-12 08:32:10.665064
current #epochs=18, #steps=136
start validation
acc: 0.659091
AUC: 0.823691
Avg Precision: 0.375298
Avg Recall: 1.000000
d_prime: 1.314547
train_loss: 0.333724
valid_loss: 1.143999
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0004941316909022254
Epoch-18 lr: 0.0004941316909022254
epoch 18 training time: 8.705
---------------
2023-09-12 08:32:19.370587
current #epochs=19, #steps=144
start validation
acc: 0.659091
AUC: 0.825758
Avg Precision: 0.369863
Avg Recall: 1.000000
d_prime: 1.325871
train_loss: 0.286031
valid_loss: 1.139269
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0004941316909022254
Epoch-19 lr: 0.0004941316909022254
epoch 19 training time: 8.687
---------------
2023-09-12 08:32:28.058012
current #epochs=20, #steps=152
start validation
acc: 0.659091
AUC: 0.830579
Avg Precision: 0.370843
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.251014
valid_loss: 1.135277
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00032606022030480156
Epoch-20 lr: 0.00032606022030480156
epoch 20 training time: 6.623
---------------
2023-09-12 08:32:34.681258
current #epochs=21, #steps=160
start validation
acc: 0.636364
AUC: 0.828512
Avg Precision: 0.367682
Avg Recall: 1.000000
d_prime: 1.341103
train_loss: 0.280672
valid_loss: 1.136401
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00032606022030480156
Epoch-21 lr: 0.00032606022030480156
epoch 21 training time: 6.654
---------------
2023-09-12 08:32:41.334780
current #epochs=22, #steps=168
start validation
acc: 0.659091
AUC: 0.820937
Avg Precision: 0.363908
Avg Recall: 1.000000
d_prime: 1.299578
train_loss: 0.334524
valid_loss: 1.141110
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00032606022030480156
Epoch-22 lr: 0.00032606022030480156
epoch 22 training time: 6.354
---------------
2023-09-12 08:32:47.688836
current #epochs=23, #steps=176
start validation
acc: 0.659091
AUC: 0.820248
Avg Precision: 0.368155
Avg Recall: 1.000000
d_prime: 1.295859
train_loss: 0.283885
valid_loss: 1.145677
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00032606022030480156
Epoch-23 lr: 0.00032606022030480156
epoch 23 training time: 8.420
---------------
2023-09-12 08:32:56.108602
current #epochs=24, #steps=184
start validation
acc: 0.659091
AUC: 0.816804
Avg Precision: 0.368865
Avg Recall: 1.000000
d_prime: 1.277394
train_loss: 0.338240
valid_loss: 1.148227
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00021515573524761542
Epoch-24 lr: 0.00021515573524761542
epoch 24 training time: 7.166
---------------
2023-09-12 08:33:03.274828
current #epochs=25, #steps=192
start validation
acc: 0.636364
AUC: 0.816804
Avg Precision: 0.363571
Avg Recall: 1.000000
d_prime: 1.277394
train_loss: 0.330395
valid_loss: 1.148526
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00021515573524761542
Epoch-25 lr: 0.00021515573524761542
epoch 25 training time: 6.251
---------------
2023-09-12 08:33:09.525490
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03420	Per Sample Data Time 0.02864	Per Sample DNN Time 0.00556	Train Loss 0.1949	
start validation
acc: 0.636364
AUC: 0.816116
Avg Precision: 0.363571
Avg Recall: 1.000000
d_prime: 1.273727
train_loss: 0.248007
valid_loss: 1.148424
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00021515573524761542
Epoch-26 lr: 0.00021515573524761542
epoch 26 training time: 6.676
---------------
2023-09-12 08:33:16.201988
current #epochs=27, #steps=208
start validation
acc: 0.613636
AUC: 0.813361
Avg Precision: 0.363571
Avg Recall: 1.000000
d_prime: 1.259144
train_loss: 0.301063
valid_loss: 1.148075
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00021515573524761542
Epoch-27 lr: 0.00021515573524761542
epoch 27 training time: 6.258
---------------
2023-09-12 08:33:22.459842
current #epochs=28, #steps=216
start validation
[I 2023-09-12 08:33:30,101] Trial 33 finished with value: 0.6818181818181818 and parameters: {'warmup': 'False', 'num_epochs': 28, 'batch_size': 15, 'lr-adaptschedule': 'True', 'lr': 0.0026062871913365452, 'head-lr': 1, 'lr-scheduler-start': 4, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.6598650244623141}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.613636
AUC: 0.813361
Avg Precision: 0.359341
Avg Recall: 1.000000
d_prime: 1.259144
train_loss: 0.245552
valid_loss: 1.147984
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00014197374450237492
Epoch-28 lr: 0.00014197374450237492
epoch 28 training time: 7.637
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8e67a30>
The learning rate scheduler starts at 3 epoch with decay rate of 0.622 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 08:33:30.135458
current #epochs=1, #steps=0
start validation
acc: 0.522727
AUC: 0.789945
Avg Precision: 0.308371
Avg Recall: 1.000000
d_prime: 1.140182
train_loss: 0.455246
valid_loss: 1.196252
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0028741628130467805
Epoch-1 lr: 0.0028741628130467805
epoch 1 training time: 9.034
---------------
2023-09-12 08:33:39.170236
current #epochs=2, #steps=8
start validation
acc: 0.568182
AUC: 0.786501
Avg Precision: 0.353912
Avg Recall: 1.000000
d_prime: 1.123367
train_loss: 0.464908
valid_loss: 1.199521
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0028741628130467805
Epoch-2 lr: 0.0028741628130467805
epoch 2 training time: 9.462
---------------
2023-09-12 08:33:48.631535
current #epochs=3, #steps=16
start validation
acc: 0.545455
AUC: 0.802342
Avg Precision: 0.358617
Avg Recall: 1.000000
d_prime: 1.202103
train_loss: 0.469388
valid_loss: 1.185608
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.001788210590090126
Epoch-3 lr: 0.001788210590090126
epoch 3 training time: 6.332
---------------
2023-09-12 08:33:54.963510
current #epochs=4, #steps=24
start validation
acc: 0.590909
AUC: 0.794077
Avg Precision: 0.387408
Avg Recall: 1.000000
d_prime: 1.160574
train_loss: 0.494165
valid_loss: 1.185681
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.001788210590090126
Epoch-4 lr: 0.001788210590090126
epoch 4 training time: 9.035
---------------
2023-09-12 08:34:03.998785
current #epochs=5, #steps=32
start validation
acc: 0.613636
AUC: 0.815427
Avg Precision: 0.345513
Avg Recall: 1.000000
d_prime: 1.270069
train_loss: 0.373932
valid_loss: 1.169097
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.001788210590090126
Epoch-5 lr: 0.001788210590090126
epoch 5 training time: 9.089
---------------
2023-09-12 08:34:13.088125
current #epochs=6, #steps=40
start validation
acc: 0.636364
AUC: 0.821625
Avg Precision: 0.350488
Avg Recall: 1.000000
d_prime: 1.303307
train_loss: 0.356635
valid_loss: 1.164338
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.001788210590090126
Epoch-6 lr: 0.001788210590090126
epoch 6 training time: 8.783
---------------
2023-09-12 08:34:21.871098
current #epochs=7, #steps=48
start validation
acc: 0.636364
AUC: 0.826446
Avg Precision: 0.353886
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.327420
valid_loss: 1.154227
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.001788210590090126
Epoch-7 lr: 0.001788210590090126
epoch 7 training time: 6.389
---------------
2023-09-12 08:34:28.259739
current #epochs=8, #steps=56
start validation
acc: 0.659091
AUC: 0.816116
Avg Precision: 0.344932
Avg Recall: 1.000000
d_prime: 1.273727
train_loss: 0.301405
valid_loss: 1.156464
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001112566448913425
Epoch-8 lr: 0.001112566448913425
epoch 8 training time: 8.877
---------------
2023-09-12 08:34:37.136920
current #epochs=9, #steps=64
start validation
acc: 0.659091
AUC: 0.823003
Avg Precision: 0.353318
Avg Recall: 1.000000
d_prime: 1.310791
train_loss: 0.430073
valid_loss: 1.148189
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001112566448913425
Epoch-9 lr: 0.001112566448913425
epoch 9 training time: 6.957
---------------
2023-09-12 08:34:44.094283
current #epochs=10, #steps=72
start validation
acc: 0.659091
AUC: 0.829890
Avg Precision: 0.357549
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.305587
valid_loss: 1.145053
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001112566448913425
Epoch-10 lr: 0.001112566448913425
epoch 10 training time: 6.310
---------------
2023-09-12 08:34:50.404124
current #epochs=11, #steps=80
start validation
acc: 0.659091
AUC: 0.829890
Avg Precision: 0.368209
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.340096
valid_loss: 1.146096
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001112566448913425
Epoch-11 lr: 0.001112566448913425
epoch 11 training time: 8.226
---------------
2023-09-12 08:34:58.630468
current #epochs=12, #steps=88
start validation
acc: 0.636364
AUC: 0.827135
Avg Precision: 0.354597
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.284942
valid_loss: 1.144500
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001112566448913425
Epoch-12 lr: 0.001112566448913425
epoch 12 training time: 6.377
---------------
2023-09-12 08:35:05.007767
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01187	Per Sample Data Time 0.00612	Per Sample DNN Time 0.00575	Train Loss 0.3316	
start validation
acc: 0.659091
AUC: 0.823003
Avg Precision: 0.360338
Avg Recall: 1.000000
d_prime: 1.310791
train_loss: 0.335721
valid_loss: 1.151655
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0006922026466611202
Epoch-13 lr: 0.0006922026466611202
epoch 13 training time: 7.738
---------------
2023-09-12 08:35:12.745961
current #epochs=14, #steps=104
start validation
acc: 0.636364
AUC: 0.816116
Avg Precision: 0.358695
Avg Recall: 1.000000
d_prime: 1.273727
train_loss: 0.300884
valid_loss: 1.159217
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0006922026466611202
Epoch-14 lr: 0.0006922026466611202
epoch 14 training time: 6.214
---------------
2023-09-12 08:35:18.960378
current #epochs=15, #steps=112
start validation
acc: 0.636364
AUC: 0.807163
Avg Precision: 0.365888
Avg Recall: 1.000000
d_prime: 1.226813
train_loss: 0.268638
valid_loss: 1.162042
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0006922026466611202
Epoch-15 lr: 0.0006922026466611202
epoch 15 training time: 6.330
---------------
2023-09-12 08:35:25.290967
current #epochs=16, #steps=120
start validation
acc: 0.613636
AUC: 0.808540
Avg Precision: 0.366667
Avg Recall: 1.000000
d_prime: 1.233942
train_loss: 0.303184
valid_loss: 1.161487
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0006922026466611202
Epoch-16 lr: 0.0006922026466611202
epoch 16 training time: 6.313
---------------
2023-09-12 08:35:31.604122
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.807851
Avg Precision: 0.344195
Avg Recall: 1.000000
d_prime: 1.230373
train_loss: 0.375687
valid_loss: 1.160698
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0006922026466611202
Epoch-17 lr: 0.0006922026466611202
epoch 17 training time: 6.448
---------------
2023-09-12 08:35:38.052139
current #epochs=18, #steps=136
start validation
acc: 0.636364
AUC: 0.799587
Avg Precision: 0.325904
Avg Recall: 1.000000
d_prime: 1.188146
train_loss: 0.292304
valid_loss: 1.164408
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0004306659656262423
Epoch-18 lr: 0.0004306659656262423
epoch 18 training time: 6.325
---------------
2023-09-12 08:35:44.377635
current #epochs=19, #steps=144
start validation
acc: 0.636364
AUC: 0.798898
Avg Precision: 0.322743
Avg Recall: 1.000000
d_prime: 1.184675
train_loss: 0.297254
valid_loss: 1.163291
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0004306659656262423
Epoch-19 lr: 0.0004306659656262423
epoch 19 training time: 6.704
---------------
2023-09-12 08:35:51.081793
current #epochs=20, #steps=152
start validation
acc: 0.636364
AUC: 0.798209
Avg Precision: 0.319786
Avg Recall: 1.000000
d_prime: 1.181211
train_loss: 0.277924
valid_loss: 1.162095
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0004306659656262423
Epoch-20 lr: 0.0004306659656262423
epoch 20 training time: 8.260
---------------
2023-09-12 08:35:59.341852
current #epochs=21, #steps=160
start validation
acc: 0.636364
AUC: 0.802342
Avg Precision: 0.321675
Avg Recall: 1.000000
d_prime: 1.202103
train_loss: 0.317772
valid_loss: 1.159853
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0004306659656262423
Epoch-21 lr: 0.0004306659656262423
epoch 21 training time: 6.588
---------------
2023-09-12 08:36:05.929311
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.804408
Avg Precision: 0.327250
Avg Recall: 1.000000
d_prime: 1.212647
train_loss: 0.359082
valid_loss: 1.156872
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0004306659656262423
Epoch-22 lr: 0.0004306659656262423
epoch 22 training time: 7.061
---------------
2023-09-12 08:36:12.990849
current #epochs=23, #steps=176
start validation
acc: 0.636364
AUC: 0.809917
Avg Precision: 0.342530
Avg Recall: 1.000000
d_prime: 1.241102
train_loss: 0.329956
valid_loss: 1.156809
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.000267946351900595
Epoch-23 lr: 0.000267946351900595
epoch 23 training time: 6.386
---------------
2023-09-12 08:36:19.376194
current #epochs=24, #steps=184
start validation
acc: 0.636364
AUC: 0.809917
Avg Precision: 0.336873
Avg Recall: 1.000000
d_prime: 1.241102
train_loss: 0.306279
valid_loss: 1.157292
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.000267946351900595
Epoch-24 lr: 0.000267946351900595
epoch 24 training time: 6.265
---------------
2023-09-12 08:36:25.640873
current #epochs=25, #steps=192
start validation
acc: 0.636364
AUC: 0.809229
Avg Precision: 0.334691
Avg Recall: 1.000000
d_prime: 1.237518
train_loss: 0.287414
valid_loss: 1.158991
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.000267946351900595
Epoch-25 lr: 0.000267946351900595
epoch 25 training time: 8.494
---------------
2023-09-12 08:36:34.135173
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03587	Per Sample Data Time 0.03035	Per Sample DNN Time 0.00552	Train Loss 0.2547	
start validation
acc: 0.636364
AUC: 0.810606
Avg Precision: 0.331497
Avg Recall: 1.000000
d_prime: 1.244694
train_loss: 0.306543
valid_loss: 1.158880
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.000267946351900595
Epoch-26 lr: 0.000267946351900595
epoch 26 training time: 6.352
---------------
2023-09-12 08:36:40.487232
current #epochs=27, #steps=208
start validation
acc: 0.636364
AUC: 0.809917
Avg Precision: 0.325445
Avg Recall: 1.000000
d_prime: 1.241102
train_loss: 0.289647
valid_loss: 1.157971
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.000267946351900595
Epoch-27 lr: 0.000267946351900595
epoch 27 training time: 7.682
---------------
2023-09-12 08:36:48.169096
current #epochs=28, #steps=216
start validation
acc: 0.636364
AUC: 0.812672
Avg Precision: 0.333236
Avg Recall: 1.000000
d_prime: 1.255520
train_loss: 0.272223
valid_loss: 1.156328
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00016670750239675475
Epoch-28 lr: 0.00016670750239675475
epoch 28 training time: 7.540
---------------
2023-09-12 08:36:55.708874
current #epochs=29, #steps=224
start validation
acc: 0.636364
AUC: 0.814050
Avg Precision: 0.337202
Avg Recall: 1.000000
d_prime: 1.262777
train_loss: 0.291918
valid_loss: 1.155208
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00016670750239675475
Epoch-29 lr: 0.00016670750239675475
epoch 29 training time: 6.495
---------------
2023-09-12 08:37:02.204368
current #epochs=30, #steps=232
start validation
acc: 0.636364
AUC: 0.811983
Avg Precision: 0.328869
Avg Recall: 1.000000
d_prime: 1.251903
train_loss: 0.271177
valid_loss: 1.155274
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00016670750239675475
Epoch-30 lr: 0.00016670750239675475
epoch 30 training time: 8.332
---------------
2023-09-12 08:37:10.536725
current #epochs=31, #steps=240
start validation
acc: 0.636364
AUC: 0.807851
Avg Precision: 0.328181
Avg Recall: 1.000000
d_prime: 1.230373
train_loss: 0.276789
valid_loss: 1.155524
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.00016670750239675475
Epoch-31 lr: 0.00016670750239675475
epoch 31 training time: 6.392
---------------
2023-09-12 08:37:16.928179
current #epochs=32, #steps=248
start validation
[I 2023-09-12 08:37:23,368] Trial 34 finished with value: 0.6590909090909091 and parameters: {'warmup': 'False', 'num_epochs': 32, 'batch_size': 24, 'lr-adaptschedule': 'True', 'lr': 0.0028741628130467805, 'head-lr': 1, 'lr-scheduler-start': 3, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.6221674645475349}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.636364
AUC: 0.811983
Avg Precision: 0.334798
Avg Recall: 1.000000
d_prime: 1.251903
train_loss: 0.338064
valid_loss: 1.152997
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00016670750239675475
Epoch-32 lr: 0.00016670750239675475
epoch 32 training time: 6.436
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f957bffa100>
The learning rate scheduler starts at 4 epoch with decay rate of 0.601 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 08:37:23.406274
current #epochs=1, #steps=0
start validation
acc: 0.659091
AUC: 0.839532
Avg Precision: 0.368493
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.452369
valid_loss: 1.161889
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002890761883077623
Epoch-1 lr: 0.002890761883077623
epoch 1 training time: 8.975
---------------
2023-09-12 08:37:32.381151
current #epochs=2, #steps=8
start validation
acc: 0.545455
AUC: 0.806474
Avg Precision: 0.344067
Avg Recall: 1.000000
d_prime: 1.223260
train_loss: 0.485659
valid_loss: 1.184425
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002890761883077623
Epoch-2 lr: 0.002890761883077623
epoch 2 training time: 7.153
---------------
2023-09-12 08:37:39.534222
current #epochs=3, #steps=16
start validation
acc: 0.636364
AUC: 0.830579
Avg Precision: 0.371737
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.415693
valid_loss: 1.148655
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002890761883077623
Epoch-3 lr: 0.002890761883077623
epoch 3 training time: 7.546
---------------
2023-09-12 08:37:47.080707
current #epochs=4, #steps=24
start validation
acc: 0.613636
AUC: 0.842975
Avg Precision: 0.419392
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.452876
valid_loss: 1.132399
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0017359237169197307
Epoch-4 lr: 0.0017359237169197307
epoch 4 training time: 6.218
---------------
2023-09-12 08:37:53.298638
current #epochs=5, #steps=32
start validation
acc: 0.590909
AUC: 0.850551
Avg Precision: 0.393221
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.359291
valid_loss: 1.124708
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0017359237169197307
Epoch-5 lr: 0.0017359237169197307
epoch 5 training time: 6.431
---------------
2023-09-12 08:37:59.729649
current #epochs=6, #steps=40
start validation
acc: 0.659091
AUC: 0.858815
Avg Precision: 0.401317
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.320580
valid_loss: 1.115670
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0017359237169197307
Epoch-6 lr: 0.0017359237169197307
epoch 6 training time: 6.211
---------------
2023-09-12 08:38:05.940881
current #epochs=7, #steps=48
start validation
acc: 0.590909
AUC: 0.845730
Avg Precision: 0.414962
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.367753
valid_loss: 1.130133
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0010424349264478996
Epoch-7 lr: 0.0010424349264478996
epoch 7 training time: 7.145
---------------
2023-09-12 08:38:13.086466
current #epochs=8, #steps=56
start validation
acc: 0.613636
AUC: 0.836777
Avg Precision: 0.405758
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.339949
valid_loss: 1.140976
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0010424349264478996
Epoch-8 lr: 0.0010424349264478996
epoch 8 training time: 6.190
---------------
2023-09-12 08:38:19.276997
current #epochs=9, #steps=64
start validation
acc: 0.590909
AUC: 0.836088
Avg Precision: 0.394565
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.382870
valid_loss: 1.137628
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0010424349264478996
Epoch-9 lr: 0.0010424349264478996
epoch 9 training time: 6.460
---------------
2023-09-12 08:38:25.736478
current #epochs=10, #steps=72
start validation
acc: 0.613636
AUC: 0.847796
Avg Precision: 0.409932
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.265799
valid_loss: 1.128044
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0006259898204551609
Epoch-10 lr: 0.0006259898204551609
epoch 10 training time: 6.394
---------------
2023-09-12 08:38:32.130788
current #epochs=11, #steps=80
start validation
acc: 0.590909
AUC: 0.835399
Avg Precision: 0.411901
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.324066
valid_loss: 1.138078
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0006259898204551609
Epoch-11 lr: 0.0006259898204551609
epoch 11 training time: 7.112
---------------
2023-09-12 08:38:39.243118
current #epochs=12, #steps=88
start validation
acc: 0.568182
AUC: 0.839532
Avg Precision: 0.436470
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.345432
valid_loss: 1.138174
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0006259898204551609
Epoch-12 lr: 0.0006259898204551609
epoch 12 training time: 6.330
---------------
2023-09-12 08:38:45.572911
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01212	Per Sample Data Time 0.00634	Per Sample DNN Time 0.00578	Train Loss 0.2435	
start validation
acc: 0.568182
AUC: 0.842975
Avg Precision: 0.433150
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.255310
valid_loss: 1.135693
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.000375911479336902
Epoch-13 lr: 0.000375911479336902
epoch 13 training time: 6.840
---------------
2023-09-12 08:38:52.412623
current #epochs=14, #steps=104
start validation
acc: 0.568182
AUC: 0.840220
Avg Precision: 0.423216
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.280538
valid_loss: 1.135412
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.000375911479336902
Epoch-14 lr: 0.000375911479336902
epoch 14 training time: 6.247
---------------
2023-09-12 08:38:58.659555
current #epochs=15, #steps=112
start validation
acc: 0.613636
AUC: 0.848485
Avg Precision: 0.443866
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.263210
valid_loss: 1.131039
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.000375911479336902
Epoch-15 lr: 0.000375911479336902
epoch 15 training time: 7.402
---------------
2023-09-12 08:39:06.062016
current #epochs=16, #steps=120
start validation
acc: 0.613636
AUC: 0.854683
Avg Precision: 0.421331
Avg Recall: 1.000000
d_prime: 1.494446
train_loss: 0.253775
valid_loss: 1.121427
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.00022573760096372043
Epoch-16 lr: 0.00022573760096372043
epoch 16 training time: 6.562
---------------
2023-09-12 08:39:12.623969
current #epochs=17, #steps=128
start validation
acc: 0.613636
AUC: 0.853994
Avg Precision: 0.407451
Avg Recall: 1.000000
d_prime: 1.490185
train_loss: 0.267107
valid_loss: 1.120890
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.00022573760096372043
Epoch-17 lr: 0.00022573760096372043
epoch 17 training time: 7.666
---------------
2023-09-12 08:39:20.289657
current #epochs=18, #steps=136
start validation
acc: 0.613636
AUC: 0.856061
Avg Precision: 0.408189
Avg Recall: 1.000000
d_prime: 1.503007
train_loss: 0.280753
valid_loss: 1.120359
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00022573760096372043
Epoch-18 lr: 0.00022573760096372043
epoch 18 training time: 7.759
---------------
2023-09-12 08:39:28.049160
current #epochs=19, #steps=144
start validation
acc: 0.613636
AUC: 0.854683
Avg Precision: 0.408189
Avg Recall: 1.000000
d_prime: 1.494446
train_loss: 0.316065
valid_loss: 1.121470
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00013555708535090098
Epoch-19 lr: 0.00013555708535090098
epoch 19 training time: 6.343
---------------
2023-09-12 08:39:34.391853
current #epochs=20, #steps=152
start validation
acc: 0.613636
AUC: 0.852617
Avg Precision: 0.401499
Avg Recall: 1.000000
d_prime: 1.481705
train_loss: 0.305800
valid_loss: 1.123268
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00013555708535090098
Epoch-20 lr: 0.00013555708535090098
epoch 20 training time: 6.459
---------------
2023-09-12 08:39:40.850406
current #epochs=21, #steps=160
start validation
acc: 0.590909
AUC: 0.852617
Avg Precision: 0.413776
Avg Recall: 1.000000
d_prime: 1.481705
train_loss: 0.273080
valid_loss: 1.123844
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00013555708535090098
Epoch-21 lr: 0.00013555708535090098
epoch 21 training time: 6.289
---------------
2023-09-12 08:39:47.138997
current #epochs=22, #steps=168
start validation
acc: 0.590909
AUC: 0.851240
Avg Precision: 0.413776
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.286757
valid_loss: 1.126758
validation finished
normal learning rate scheduler step
Epoch-22 lr: 8.140302417666217e-05
Epoch-22 lr: 8.140302417666217e-05
epoch 22 training time: 6.373
---------------
2023-09-12 08:39:53.512356
current #epochs=23, #steps=176
start validation
[I 2023-09-12 08:40:00,120] Trial 35 finished with value: 0.6590909090909091 and parameters: {'warmup': 'False', 'num_epochs': 23, 'batch_size': 20, 'lr-adaptschedule': 'True', 'lr': 0.002890761883077623, 'head-lr': 1, 'lr-scheduler-start': 4, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.6005073358278806}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.590909
AUC: 0.849174
Avg Precision: 0.417413
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.233004
valid_loss: 1.127497
validation finished
normal learning rate scheduler step
Epoch-23 lr: 8.140302417666217e-05
Epoch-23 lr: 8.140302417666217e-05
epoch 23 training time: 6.604
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8ea0490>
The learning rate scheduler starts at 3 epoch with decay rate of 0.666 every 6 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 08:40:00.155903
current #epochs=1, #steps=0
start validation
acc: 0.590909
AUC: 0.834022
Avg Precision: 0.401499
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.464110
valid_loss: 1.168059
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0021516881884676847
Epoch-1 lr: 0.0021516881884676847
epoch 1 training time: 9.079
---------------
2023-09-12 08:40:09.235263
current #epochs=2, #steps=8
start validation
acc: 0.590909
AUC: 0.849862
Avg Precision: 0.410520
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.434465
valid_loss: 1.151924
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0021516881884676847
Epoch-2 lr: 0.0021516881884676847
epoch 2 training time: 6.317
---------------
2023-09-12 08:40:15.552429
current #epochs=3, #steps=16
start validation
acc: 0.659091
AUC: 0.869146
Avg Precision: 0.424511
Avg Recall: 1.000000
d_prime: 1.587261
train_loss: 0.402937
valid_loss: 1.128349
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0014326443030941802
Epoch-3 lr: 0.0014326443030941802
epoch 3 training time: 9.483
---------------
2023-09-12 08:40:25.035889
current #epochs=4, #steps=24
start validation
acc: 0.613636
AUC: 0.865702
Avg Precision: 0.440031
Avg Recall: 1.000000
d_prime: 1.564550
train_loss: 0.351862
valid_loss: 1.127533
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0014326443030941802
Epoch-4 lr: 0.0014326443030941802
epoch 4 training time: 6.416
---------------
2023-09-12 08:40:31.451630
current #epochs=5, #steps=32
start validation
acc: 0.613636
AUC: 0.871212
Avg Precision: 0.464390
Avg Recall: 1.000000
d_prime: 1.601087
train_loss: 0.346057
valid_loss: 1.126973
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0014326443030941802
Epoch-5 lr: 0.0014326443030941802
epoch 5 training time: 6.195
---------------
2023-09-12 08:40:37.646422
current #epochs=6, #steps=40
start validation
acc: 0.590909
AUC: 0.869835
Avg Precision: 0.461455
Avg Recall: 1.000000
d_prime: 1.591853
train_loss: 0.300947
valid_loss: 1.127302
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0014326443030941802
Epoch-6 lr: 0.0014326443030941802
epoch 6 training time: 6.378
---------------
2023-09-12 08:40:44.024022
current #epochs=7, #steps=48
start validation
acc: 0.590909
AUC: 0.878788
Avg Precision: 0.465363
Avg Recall: 1.000000
d_prime: 1.653143
train_loss: 0.306258
valid_loss: 1.111529
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0014326443030941802
Epoch-7 lr: 0.0014326443030941802
epoch 7 training time: 7.637
---------------
2023-09-12 08:40:51.660990
current #epochs=8, #steps=56
start validation
acc: 0.590909
AUC: 0.850551
Avg Precision: 0.403638
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.331490
valid_loss: 1.111748
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0014326443030941802
Epoch-8 lr: 0.0014326443030941802
epoch 8 training time: 7.527
---------------
2023-09-12 08:40:59.187585
current #epochs=9, #steps=64
start validation
acc: 0.636364
AUC: 0.850551
Avg Precision: 0.398733
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.282563
valid_loss: 1.112088
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0009538880727183182
Epoch-9 lr: 0.0009538880727183182
epoch 9 training time: 6.548
---------------
2023-09-12 08:41:05.735514
current #epochs=10, #steps=72
start validation
acc: 0.636364
AUC: 0.860193
Avg Precision: 0.387241
Avg Recall: 1.000000
d_prime: 1.529028
train_loss: 0.292958
valid_loss: 1.110673
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0009538880727183182
Epoch-10 lr: 0.0009538880727183182
epoch 10 training time: 6.369
---------------
2023-09-12 08:41:12.104628
current #epochs=11, #steps=80
start validation
acc: 0.681818
AUC: 0.865014
Avg Precision: 0.403770
Avg Recall: 1.000000
d_prime: 1.560056
train_loss: 0.299293
valid_loss: 1.109019
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0009538880727183182
Epoch-11 lr: 0.0009538880727183182
epoch 11 training time: 9.039
---------------
2023-09-12 08:41:21.144158
current #epochs=12, #steps=88
start validation
acc: 0.659091
AUC: 0.864325
Avg Precision: 0.416366
Avg Recall: 1.000000
d_prime: 1.555577
train_loss: 0.289322
valid_loss: 1.112370
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0009538880727183182
Epoch-12 lr: 0.0009538880727183182
epoch 12 training time: 6.555
---------------
2023-09-12 08:41:27.699337
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01162	Per Sample Data Time 0.00608	Per Sample DNN Time 0.00554	Train Loss 0.2999	
start validation
acc: 0.636364
AUC: 0.861570
Avg Precision: 0.427308
Avg Recall: 1.000000
d_prime: 1.537818
train_loss: 0.270949
valid_loss: 1.115092
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0009538880727183182
Epoch-13 lr: 0.0009538880727183182
epoch 13 training time: 7.166
---------------
2023-09-12 08:41:34.865617
current #epochs=14, #steps=104
start validation
acc: 0.613636
AUC: 0.850551
Avg Precision: 0.420597
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.315706
valid_loss: 1.116028
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0009538880727183182
Epoch-14 lr: 0.0009538880727183182
epoch 14 training time: 6.160
---------------
2023-09-12 08:41:41.026357
current #epochs=15, #steps=112
start validation
acc: 0.636364
AUC: 0.846419
Avg Precision: 0.428333
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.241576
valid_loss: 1.125355
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.000635120981048184
Epoch-15 lr: 0.000635120981048184
epoch 15 training time: 6.238
---------------
2023-09-12 08:41:47.264415
current #epochs=16, #steps=120
start validation
acc: 0.636364
AUC: 0.845041
Avg Precision: 0.432187
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.240992
valid_loss: 1.131668
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.000635120981048184
Epoch-16 lr: 0.000635120981048184
epoch 16 training time: 6.561
---------------
2023-09-12 08:41:53.825322
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.845041
Avg Precision: 0.439828
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.321677
valid_loss: 1.124500
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.000635120981048184
Epoch-17 lr: 0.000635120981048184
epoch 17 training time: 7.666
---------------
2023-09-12 08:42:01.491494
current #epochs=18, #steps=136
start validation
acc: 0.636364
AUC: 0.851240
Avg Precision: 0.423390
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.226626
valid_loss: 1.117801
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.000635120981048184
Epoch-18 lr: 0.000635120981048184
epoch 18 training time: 7.298
---------------
2023-09-12 08:42:08.789579
current #epochs=19, #steps=144
start validation
acc: 0.613636
AUC: 0.847796
Avg Precision: 0.415522
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.189184
valid_loss: 1.120666
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.000635120981048184
Epoch-19 lr: 0.000635120981048184
epoch 19 training time: 7.064
---------------
2023-09-12 08:42:15.852837
current #epochs=20, #steps=152
start validation
acc: 0.613636
AUC: 0.848485
Avg Precision: 0.407687
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.254642
valid_loss: 1.118194
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.000635120981048184
Epoch-20 lr: 0.000635120981048184
epoch 20 training time: 6.484
---------------
2023-09-12 08:42:22.337199
current #epochs=21, #steps=160
start validation
acc: 0.636364
AUC: 0.845041
Avg Precision: 0.415242
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.301010
valid_loss: 1.119900
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00042287839852959855
Epoch-21 lr: 0.00042287839852959855
epoch 21 training time: 6.174
---------------
2023-09-12 08:42:28.510795
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.844353
Avg Precision: 0.428287
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.211273
valid_loss: 1.128495
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00042287839852959855
Epoch-22 lr: 0.00042287839852959855
epoch 22 training time: 6.292
---------------
2023-09-12 08:42:34.802755
current #epochs=23, #steps=176
start validation
acc: 0.568182
AUC: 0.831267
Avg Precision: 0.411507
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.289311
valid_loss: 1.141955
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00042287839852959855
Epoch-23 lr: 0.00042287839852959855
epoch 23 training time: 6.669
---------------
2023-09-12 08:42:41.471540
current #epochs=24, #steps=184
start validation
acc: 0.545455
AUC: 0.828512
Avg Precision: 0.402263
Avg Recall: 1.000000
d_prime: 1.341103
train_loss: 0.319827
valid_loss: 1.139086
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00042287839852959855
Epoch-24 lr: 0.00042287839852959855
epoch 24 training time: 7.745
---------------
2023-09-12 08:42:49.215914
current #epochs=25, #steps=192
start validation
acc: 0.636364
AUC: 0.832645
Avg Precision: 0.397869
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.269245
valid_loss: 1.131891
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00042287839852959855
Epoch-25 lr: 0.00042287839852959855
epoch 25 training time: 6.478
---------------
2023-09-12 08:42:55.693624
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03674	Per Sample Data Time 0.02958	Per Sample DNN Time 0.00716	Train Loss 0.2222	
start validation
acc: 0.636364
AUC: 0.835399
Avg Precision: 0.385593
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.256228
valid_loss: 1.132500
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00042287839852959855
Epoch-26 lr: 0.00042287839852959855
epoch 26 training time: 6.274
---------------
2023-09-12 08:43:01.967077
current #epochs=27, #steps=208
start validation
acc: 0.636364
AUC: 0.839532
Avg Precision: 0.379828
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.227041
valid_loss: 1.134522
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00028156232478390004
Epoch-27 lr: 0.00028156232478390004
epoch 27 training time: 6.420
---------------
2023-09-12 08:43:08.386788
current #epochs=28, #steps=216
start validation
acc: 0.636364
AUC: 0.840220
Avg Precision: 0.376667
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.329838
valid_loss: 1.134095
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00028156232478390004
Epoch-28 lr: 0.00028156232478390004
epoch 28 training time: 6.420
---------------
2023-09-12 08:43:14.806871
current #epochs=29, #steps=224
start validation
acc: 0.636364
AUC: 0.842287
Avg Precision: 0.385204
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.220668
valid_loss: 1.129900
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00028156232478390004
Epoch-29 lr: 0.00028156232478390004
epoch 29 training time: 6.322
---------------
2023-09-12 08:43:21.129181
current #epochs=30, #steps=232
start validation
acc: 0.636364
AUC: 0.845730
Avg Precision: 0.397869
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.229275
valid_loss: 1.125846
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00028156232478390004
Epoch-30 lr: 0.00028156232478390004
epoch 30 training time: 6.972
---------------
2023-09-12 08:43:28.101629
current #epochs=31, #steps=240
start validation
[I 2023-09-12 08:43:34,368] Trial 36 finished with value: 0.6818181818181818 and parameters: {'warmup': 'False', 'num_epochs': 31, 'batch_size': 14, 'lr-adaptschedule': 'True', 'lr': 0.0021516881884676847, 'head-lr': 1, 'lr-scheduler-start': 3, 'lr-scheduler-step': 6, 'lr-scheduler-decay': 0.6658233803451008}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.636364
AUC: 0.847796
Avg Precision: 0.412449
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.254328
valid_loss: 1.124209
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.00028156232478390004
Epoch-31 lr: 0.00028156232478390004
epoch 31 training time: 6.263
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f956e068e50>
The learning rate scheduler starts at 5 epoch with decay rate of 0.698 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 08:43:34.402489
current #epochs=1, #steps=0
start validation
acc: 0.636364
AUC: 0.836088
Avg Precision: 0.351140
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.440057
valid_loss: 1.139493
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0034456845717451756
Epoch-1 lr: 0.0034456845717451756
epoch 1 training time: 9.053
---------------
2023-09-12 08:43:43.455573
current #epochs=2, #steps=8
start validation
acc: 0.613636
AUC: 0.829890
Avg Precision: 0.379806
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.448223
valid_loss: 1.157959
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0034456845717451756
Epoch-2 lr: 0.0034456845717451756
epoch 2 training time: 7.431
---------------
2023-09-12 08:43:50.886986
current #epochs=3, #steps=16
start validation
acc: 0.613636
AUC: 0.836088
Avg Precision: 0.365424
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.376029
valid_loss: 1.159368
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0034456845717451756
Epoch-3 lr: 0.0034456845717451756
epoch 3 training time: 6.549
---------------
2023-09-12 08:43:57.435859
current #epochs=4, #steps=24
start validation
acc: 0.613636
AUC: 0.808540
Avg Precision: 0.344047
Avg Recall: 1.000000
d_prime: 1.233942
train_loss: 0.385350
valid_loss: 1.166381
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0034456845717451756
Epoch-4 lr: 0.0034456845717451756
epoch 4 training time: 6.209
---------------
2023-09-12 08:44:03.645157
current #epochs=5, #steps=32
start validation
acc: 0.636364
AUC: 0.834022
Avg Precision: 0.348399
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.315452
valid_loss: 1.144682
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002404472776192224
Epoch-5 lr: 0.002404472776192224
epoch 5 training time: 6.332
---------------
2023-09-12 08:44:09.976986
current #epochs=6, #steps=40
start validation
acc: 0.590909
AUC: 0.814050
Avg Precision: 0.343581
Avg Recall: 1.000000
d_prime: 1.262777
train_loss: 0.281647
valid_loss: 1.164607
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002404472776192224
Epoch-6 lr: 0.002404472776192224
epoch 6 training time: 7.181
---------------
2023-09-12 08:44:17.158042
current #epochs=7, #steps=48
start validation
acc: 0.681818
AUC: 0.859504
Avg Precision: 0.385099
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.327495
valid_loss: 1.119095
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002404472776192224
Epoch-7 lr: 0.002404472776192224
epoch 7 training time: 8.594
---------------
2023-09-12 08:44:25.751697
current #epochs=8, #steps=56
start validation
acc: 0.613636
AUC: 0.851928
Avg Precision: 0.469841
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.361081
valid_loss: 1.130061
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0016778927992591394
Epoch-8 lr: 0.0016778927992591394
epoch 8 training time: 6.419
---------------
2023-09-12 08:44:32.170593
current #epochs=9, #steps=64
start validation
acc: 0.636364
AUC: 0.845041
Avg Precision: 0.397326
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.270735
valid_loss: 1.133255
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0016778927992591394
Epoch-9 lr: 0.0016778927992591394
epoch 9 training time: 6.413
---------------
2023-09-12 08:44:38.583228
current #epochs=10, #steps=72
start validation
acc: 0.636364
AUC: 0.844353
Avg Precision: 0.391031
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.311373
valid_loss: 1.127411
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0016778927992591394
Epoch-10 lr: 0.0016778927992591394
epoch 10 training time: 6.288
---------------
2023-09-12 08:44:44.871024
current #epochs=11, #steps=80
start validation
acc: 0.613636
AUC: 0.837466
Avg Precision: 0.378762
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.280374
valid_loss: 1.135108
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0011708696699257622
Epoch-11 lr: 0.0011708696699257622
epoch 11 training time: 6.289
---------------
2023-09-12 08:44:51.160804
current #epochs=12, #steps=88
start validation
acc: 0.590909
AUC: 0.835399
Avg Precision: 0.384127
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.313748
valid_loss: 1.127129
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0011708696699257622
Epoch-12 lr: 0.0011708696699257622
epoch 12 training time: 6.449
---------------
2023-09-12 08:44:57.609564
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01187	Per Sample Data Time 0.00636	Per Sample DNN Time 0.00551	Train Loss 0.2847	
start validation
acc: 0.704545
AUC: 0.864325
Avg Precision: 0.391666
Avg Recall: 1.000000
d_prime: 1.555577
train_loss: 0.309457
valid_loss: 1.098742
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0011708696699257622
Epoch-13 lr: 0.0011708696699257622
epoch 13 training time: 9.754
---------------
2023-09-12 08:45:07.363180
current #epochs=14, #steps=104
start validation
acc: 0.704545
AUC: 0.864325
Avg Precision: 0.412202
Avg Recall: 1.000000
d_prime: 1.555577
train_loss: 0.257952
valid_loss: 1.103323
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0008170580293075871
Epoch-14 lr: 0.0008170580293075871
epoch 14 training time: 6.374
---------------
2023-09-12 08:45:13.737296
current #epochs=15, #steps=112
start validation
acc: 0.681818
AUC: 0.847107
Avg Precision: 0.386667
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.236451
valid_loss: 1.119995
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0008170580293075871
Epoch-15 lr: 0.0008170580293075871
epoch 15 training time: 6.334
---------------
2023-09-12 08:45:20.071268
current #epochs=16, #steps=120
start validation
acc: 0.636364
AUC: 0.848485
Avg Precision: 0.386910
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.276895
valid_loss: 1.123273
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0008170580293075871
Epoch-16 lr: 0.0008170580293075871
epoch 16 training time: 6.410
---------------
2023-09-12 08:45:26.481586
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.847796
Avg Precision: 0.390675
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.218754
valid_loss: 1.123164
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0005701606595534457
Epoch-17 lr: 0.0005701606595534457
epoch 17 training time: 6.331
---------------
2023-09-12 08:45:32.812684
current #epochs=18, #steps=136
start validation
acc: 0.613636
AUC: 0.839532
Avg Precision: 0.382889
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.250276
valid_loss: 1.123898
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0005701606595534457
Epoch-18 lr: 0.0005701606595534457
epoch 18 training time: 6.437
---------------
2023-09-12 08:45:39.250227
current #epochs=19, #steps=144
start validation
acc: 0.613636
AUC: 0.840909
Avg Precision: 0.382889
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.286360
valid_loss: 1.125148
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0005701606595534457
Epoch-19 lr: 0.0005701606595534457
epoch 19 training time: 6.528
---------------
2023-09-12 08:45:45.777932
current #epochs=20, #steps=152
start validation
acc: 0.636364
AUC: 0.843664
Avg Precision: 0.382992
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.270151
valid_loss: 1.130386
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00039787036665915983
Epoch-20 lr: 0.00039787036665915983
epoch 20 training time: 6.625
---------------
2023-09-12 08:45:52.402624
current #epochs=21, #steps=160
start validation
acc: 0.636364
AUC: 0.830579
Avg Precision: 0.376730
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.292979
valid_loss: 1.138636
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00039787036665915983
Epoch-21 lr: 0.00039787036665915983
epoch 21 training time: 6.394
---------------
2023-09-12 08:45:58.796519
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.828512
Avg Precision: 0.382606
Avg Recall: 1.000000
d_prime: 1.341103
train_loss: 0.202044
valid_loss: 1.139443
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00039787036665915983
Epoch-22 lr: 0.00039787036665915983
epoch 22 training time: 6.695
---------------
2023-09-12 08:46:05.491034
current #epochs=23, #steps=176
start validation
acc: 0.659091
AUC: 0.840909
Avg Precision: 0.407440
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.191840
valid_loss: 1.128630
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0002776424960457228
Epoch-23 lr: 0.0002776424960457228
epoch 23 training time: 6.451
---------------
2023-09-12 08:46:11.942165
current #epochs=24, #steps=184
start validation
acc: 0.704545
AUC: 0.842975
Avg Precision: 0.409074
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.256727
valid_loss: 1.125264
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0002776424960457228
Epoch-24 lr: 0.0002776424960457228
epoch 24 training time: 6.300
---------------
2023-09-12 08:46:18.242738
current #epochs=25, #steps=192
start validation
acc: 0.659091
AUC: 0.846419
Avg Precision: 0.415774
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.222884
valid_loss: 1.121958
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0002776424960457228
Epoch-25 lr: 0.0002776424960457228
epoch 25 training time: 8.596
---------------
2023-09-12 08:46:26.838374
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03585	Per Sample Data Time 0.02988	Per Sample DNN Time 0.00597	Train Loss 0.3469	
start validation
acc: 0.659091
AUC: 0.841598
Avg Precision: 0.393752
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.248442
valid_loss: 1.125508
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00019374490303907267
Epoch-26 lr: 0.00019374490303907267
epoch 26 training time: 8.438
---------------
2023-09-12 08:46:35.276677
current #epochs=27, #steps=208
start validation
acc: 0.636364
AUC: 0.838843
Avg Precision: 0.392616
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.178601
valid_loss: 1.124862
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00019374490303907267
Epoch-27 lr: 0.00019374490303907267
epoch 27 training time: 8.159
---------------
2023-09-12 08:46:43.435757
current #epochs=28, #steps=216
start validation
[I 2023-09-12 08:46:51,334] Trial 37 finished with value: 0.7045454545454546 and parameters: {'warmup': 'False', 'num_epochs': 28, 'batch_size': 22, 'lr-adaptschedule': 'True', 'lr': 0.0034456845717451756, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.6978214999449015}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.636364
AUC: 0.839532
Avg Precision: 0.387634
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.234917
valid_loss: 1.122381
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00019374490303907267
Epoch-28 lr: 0.00019374490303907267
epoch 28 training time: 7.893
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f957c101fd0>
The learning rate scheduler starts at 5 epoch with decay rate of 0.706 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 08:46:51.369299
current #epochs=1, #steps=0
start validation
acc: 0.545455
AUC: 0.827824
Avg Precision: 0.376044
Avg Recall: 1.000000
d_prime: 1.337280
train_loss: 0.391013
valid_loss: 1.144885
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002270702722803983
Epoch-1 lr: 0.002270702722803983
epoch 1 training time: 12.006
---------------
2023-09-12 08:47:03.375836
current #epochs=2, #steps=8
start validation
acc: 0.613636
AUC: 0.842287
Avg Precision: 0.363100
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.352529
valid_loss: 1.137657
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002270702722803983
Epoch-2 lr: 0.002270702722803983
epoch 2 training time: 11.232
---------------
2023-09-12 08:47:14.608029
current #epochs=3, #steps=16
start validation
acc: 0.659091
AUC: 0.842287
Avg Precision: 0.462485
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.298131
valid_loss: 1.106653
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002270702722803983
Epoch-3 lr: 0.002270702722803983
epoch 3 training time: 9.426
---------------
2023-09-12 08:47:24.034493
current #epochs=4, #steps=24
start validation
acc: 0.704545
AUC: 0.865702
Avg Precision: 0.361484
Avg Recall: 1.000000
d_prime: 1.564550
train_loss: 0.434290
valid_loss: 1.104089
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002270702722803983
Epoch-4 lr: 0.002270702722803983
epoch 4 training time: 9.369
---------------
2023-09-12 08:47:33.403528
current #epochs=5, #steps=32
start validation
acc: 0.659091
AUC: 0.863636
Avg Precision: 0.401691
Avg Recall: 1.000000
d_prime: 1.551114
train_loss: 0.342764
valid_loss: 1.114613
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0016040147160339669
Epoch-5 lr: 0.0016040147160339669
epoch 5 training time: 6.381
---------------
2023-09-12 08:47:39.784344
current #epochs=6, #steps=40
start validation
acc: 0.681818
AUC: 0.857438
Avg Precision: 0.391544
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.297841
valid_loss: 1.110536
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0016040147160339669
Epoch-6 lr: 0.0016040147160339669
epoch 6 training time: 6.404
---------------
2023-09-12 08:47:46.187933
current #epochs=7, #steps=48
start validation
acc: 0.659091
AUC: 0.857438
Avg Precision: 0.374428
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.299315
valid_loss: 1.101930
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0016040147160339669
Epoch-7 lr: 0.0016040147160339669
epoch 7 training time: 6.133
---------------
2023-09-12 08:47:52.320969
current #epochs=8, #steps=56
start validation
acc: 0.636364
AUC: 0.845041
Avg Precision: 0.367937
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.256954
valid_loss: 1.111436
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0011330691523003154
Epoch-8 lr: 0.0011330691523003154
epoch 8 training time: 6.348
---------------
2023-09-12 08:47:58.669302
current #epochs=9, #steps=64
start validation
acc: 0.659091
AUC: 0.829890
Avg Precision: 0.378916
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.319140
valid_loss: 1.131934
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0011330691523003154
Epoch-9 lr: 0.0011330691523003154
epoch 9 training time: 7.063
---------------
2023-09-12 08:48:05.732816
current #epochs=10, #steps=72
start validation
acc: 0.636364
AUC: 0.837466
Avg Precision: 0.363935
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.317818
valid_loss: 1.123564
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0011330691523003154
Epoch-10 lr: 0.0011330691523003154
epoch 10 training time: 6.231
---------------
2023-09-12 08:48:11.964240
current #epochs=11, #steps=80
start validation
acc: 0.636364
AUC: 0.857438
Avg Precision: 0.351480
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.219582
valid_loss: 1.107180
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.000800395215244003
Epoch-11 lr: 0.000800395215244003
epoch 11 training time: 6.500
---------------
2023-09-12 08:48:18.464826
current #epochs=12, #steps=88
start validation
acc: 0.659091
AUC: 0.854683
Avg Precision: 0.362952
Avg Recall: 1.000000
d_prime: 1.494446
train_loss: 0.238975
valid_loss: 1.111090
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.000800395215244003
Epoch-12 lr: 0.000800395215244003
epoch 12 training time: 6.402
---------------
2023-09-12 08:48:24.866274
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01136	Per Sample Data Time 0.00591	Per Sample DNN Time 0.00545	Train Loss 0.2857	
start validation
acc: 0.613636
AUC: 0.834711
Avg Precision: 0.367853
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.284731
valid_loss: 1.124931
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.000800395215244003
Epoch-13 lr: 0.000800395215244003
epoch 13 training time: 6.314
---------------
2023-09-12 08:48:31.180684
current #epochs=14, #steps=104
start validation
acc: 0.613636
AUC: 0.827824
Avg Precision: 0.372812
Avg Recall: 1.000000
d_prime: 1.337280
train_loss: 0.223837
valid_loss: 1.133403
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0005653957653731066
Epoch-14 lr: 0.0005653957653731066
epoch 14 training time: 6.140
---------------
2023-09-12 08:48:37.320622
current #epochs=15, #steps=112
start validation
acc: 0.613636
AUC: 0.827135
Avg Precision: 0.374199
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.254253
valid_loss: 1.130450
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0005653957653731066
Epoch-15 lr: 0.0005653957653731066
epoch 15 training time: 6.353
---------------
2023-09-12 08:48:43.673111
current #epochs=16, #steps=120
start validation
acc: 0.613636
AUC: 0.831267
Avg Precision: 0.363204
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.230494
valid_loss: 1.122676
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0005653957653731066
Epoch-16 lr: 0.0005653957653731066
epoch 16 training time: 6.248
---------------
2023-09-12 08:48:49.920745
current #epochs=17, #steps=128
start validation
acc: 0.613636
AUC: 0.832645
Avg Precision: 0.362258
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.221021
valid_loss: 1.118047
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0003993931565475287
Epoch-17 lr: 0.0003993931565475287
epoch 17 training time: 6.325
---------------
2023-09-12 08:48:56.245494
current #epochs=18, #steps=136
start validation
acc: 0.613636
AUC: 0.834711
Avg Precision: 0.362258
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.207104
valid_loss: 1.118224
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0003993931565475287
Epoch-18 lr: 0.0003993931565475287
epoch 18 training time: 6.348
---------------
2023-09-12 08:49:02.593902
current #epochs=19, #steps=144
start validation
acc: 0.613636
AUC: 0.830579
Avg Precision: 0.363935
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.181376
valid_loss: 1.119888
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0003993931565475287
Epoch-19 lr: 0.0003993931565475287
epoch 19 training time: 6.695
---------------
2023-09-12 08:49:09.289416
current #epochs=20, #steps=152
start validation
acc: 0.590909
AUC: 0.830579
Avg Precision: 0.368519
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.189842
valid_loss: 1.119839
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0002821296218795242
Epoch-20 lr: 0.0002821296218795242
epoch 20 training time: 6.404
---------------
2023-09-12 08:49:15.693429
current #epochs=21, #steps=160
start validation
acc: 0.590909
AUC: 0.831956
Avg Precision: 0.368519
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.236929
valid_loss: 1.118798
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0002821296218795242
Epoch-21 lr: 0.0002821296218795242
epoch 21 training time: 6.338
---------------
2023-09-12 08:49:22.031652
current #epochs=22, #steps=168
start validation
acc: 0.590909
AUC: 0.831956
Avg Precision: 0.372436
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.184108
valid_loss: 1.119153
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0002821296218795242
Epoch-22 lr: 0.0002821296218795242
epoch 22 training time: 6.405
---------------
2023-09-12 08:49:28.436856
current #epochs=23, #steps=176
start validation
acc: 0.568182
AUC: 0.831267
Avg Precision: 0.376667
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.253533
valid_loss: 1.119688
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00019929516126401396
Epoch-23 lr: 0.00019929516126401396
epoch 23 training time: 7.268
---------------
2023-09-12 08:49:35.705019
current #epochs=24, #steps=184
start validation
acc: 0.568182
AUC: 0.833333
Avg Precision: 0.376667
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.195475
valid_loss: 1.121296
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00019929516126401396
Epoch-24 lr: 0.00019929516126401396
epoch 24 training time: 7.860
---------------
2023-09-12 08:49:43.564915
current #epochs=25, #steps=192
start validation
acc: 0.590909
AUC: 0.832645
Avg Precision: 0.372436
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.220613
valid_loss: 1.121253
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00019929516126401396
Epoch-25 lr: 0.00019929516126401396
epoch 25 training time: 6.419
---------------
2023-09-12 08:49:49.983644
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03652	Per Sample Data Time 0.02920	Per Sample DNN Time 0.00732	Train Loss 0.3667	
start validation
acc: 0.590909
AUC: 0.835399
Avg Precision: 0.374199
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.290084
valid_loss: 1.121457
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00014078125167661432
Epoch-26 lr: 0.00014078125167661432
epoch 26 training time: 6.394
---------------
2023-09-12 08:49:56.377451
current #epochs=27, #steps=208
start validation
[I 2023-09-12 08:50:03,020] Trial 38 finished with value: 0.7045454545454546 and parameters: {'warmup': 'False', 'num_epochs': 27, 'batch_size': 27, 'lr-adaptschedule': 'True', 'lr': 0.002270702722803983, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.7063957337635307}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.590909
AUC: 0.836777
Avg Precision: 0.374199
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.234838
valid_loss: 1.120299
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00014078125167661432
Epoch-27 lr: 0.00014078125167661432
epoch 27 training time: 6.638
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f957c101fa0>
The learning rate scheduler starts at 5 epoch with decay rate of 0.736 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 08:50:03.055046
current #epochs=1, #steps=0
start validation
acc: 0.636364
AUC: 0.830579
Avg Precision: 0.370278
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.246470
valid_loss: 1.129321
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0023721008923207713
Epoch-1 lr: 0.0023721008923207713
epoch 1 training time: 11.301
---------------
2023-09-12 08:50:14.356502
current #epochs=2, #steps=8
start validation
acc: 0.636364
AUC: 0.849862
Avg Precision: 0.410166
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.315512
valid_loss: 1.107008
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0023721008923207713
Epoch-2 lr: 0.0023721008923207713
epoch 2 training time: 6.424
---------------
2023-09-12 08:50:20.780454
current #epochs=3, #steps=16
start validation
acc: 0.659091
AUC: 0.846419
Avg Precision: 0.370753
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.348234
valid_loss: 1.115530
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0023721008923207713
Epoch-3 lr: 0.0023721008923207713
epoch 3 training time: 10.525
---------------
2023-09-12 08:50:31.305155
current #epochs=4, #steps=24
start validation
acc: 0.636364
AUC: 0.836088
Avg Precision: 0.358847
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.315105
valid_loss: 1.126881
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0023721008923207713
Epoch-4 lr: 0.0023721008923207713
epoch 4 training time: 7.612
---------------
2023-09-12 08:50:38.917333
current #epochs=5, #steps=32
start validation
acc: 0.613636
AUC: 0.830579
Avg Precision: 0.361389
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.352727
valid_loss: 1.144083
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00174669741611655
Epoch-5 lr: 0.00174669741611655
epoch 5 training time: 7.517
---------------
2023-09-12 08:50:46.434756
current #epochs=6, #steps=40
start validation
acc: 0.613636
AUC: 0.844353
Avg Precision: 0.388478
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.319084
valid_loss: 1.133376
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00174669741611655
Epoch-6 lr: 0.00174669741611655
epoch 6 training time: 7.508
---------------
2023-09-12 08:50:53.942509
current #epochs=7, #steps=48
start validation
acc: 0.613636
AUC: 0.847107
Avg Precision: 0.369975
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.291003
valid_loss: 1.126733
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00174669741611655
Epoch-7 lr: 0.00174669741611655
epoch 7 training time: 6.480
---------------
2023-09-12 08:51:00.422561
current #epochs=8, #steps=56
start validation
acc: 0.659091
AUC: 0.838843
Avg Precision: 0.353138
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.293567
valid_loss: 1.126516
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0012861813227865277
Epoch-8 lr: 0.0012861813227865277
epoch 8 training time: 6.327
---------------
2023-09-12 08:51:06.749676
current #epochs=9, #steps=64
start validation
acc: 0.613636
AUC: 0.843664
Avg Precision: 0.343794
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.262552
valid_loss: 1.118937
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0012861813227865277
Epoch-9 lr: 0.0012861813227865277
epoch 9 training time: 6.415
---------------
2023-09-12 08:51:13.164326
current #epochs=10, #steps=72
start validation
acc: 0.613636
AUC: 0.847796
Avg Precision: 0.360006
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.284658
valid_loss: 1.119941
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0012861813227865277
Epoch-10 lr: 0.0012861813227865277
epoch 10 training time: 6.441
---------------
2023-09-12 08:51:19.605174
current #epochs=11, #steps=80
start validation
acc: 0.613636
AUC: 0.838154
Avg Precision: 0.374669
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.269364
valid_loss: 1.125915
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.000947080118068097
Epoch-11 lr: 0.000947080118068097
epoch 11 training time: 6.535
---------------
2023-09-12 08:51:26.140795
current #epochs=12, #steps=88
start validation
acc: 0.613636
AUC: 0.836088
Avg Precision: 0.380853
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.253828
valid_loss: 1.124656
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.000947080118068097
Epoch-12 lr: 0.000947080118068097
epoch 12 training time: 7.705
---------------
2023-09-12 08:51:33.845648
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01195	Per Sample Data Time 0.00638	Per Sample DNN Time 0.00557	Train Loss 0.3236	
start validation
acc: 0.590909
AUC: 0.840220
Avg Precision: 0.403199
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.245498
valid_loss: 1.132394
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.000947080118068097
Epoch-13 lr: 0.000947080118068097
epoch 13 training time: 9.481
---------------
2023-09-12 08:51:43.326496
current #epochs=14, #steps=104
start validation
acc: 0.590909
AUC: 0.822314
Avg Precision: 0.374216
Avg Recall: 1.000000
d_prime: 1.307044
train_loss: 0.208594
valid_loss: 1.151593
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0006973828138761989
Epoch-14 lr: 0.0006973828138761989
epoch 14 training time: 6.411
---------------
2023-09-12 08:51:49.737917
current #epochs=15, #steps=112
start validation
acc: 0.568182
AUC: 0.817493
Avg Precision: 0.362925
Avg Recall: 1.000000
d_prime: 1.281069
train_loss: 0.271743
valid_loss: 1.150938
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0006973828138761989
Epoch-15 lr: 0.0006973828138761989
epoch 15 training time: 6.550
---------------
2023-09-12 08:51:56.288772
current #epochs=16, #steps=120
start validation
acc: 0.636364
AUC: 0.829890
Avg Precision: 0.373446
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.248921
valid_loss: 1.134611
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0006973828138761989
Epoch-16 lr: 0.0006973828138761989
epoch 16 training time: 6.402
---------------
2023-09-12 08:52:02.690955
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.832645
Avg Precision: 0.373101
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.217070
valid_loss: 1.131288
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.000513518106664463
Epoch-17 lr: 0.000513518106664463
epoch 17 training time: 8.842
---------------
2023-09-12 08:52:11.532683
current #epochs=18, #steps=136
start validation
acc: 0.636364
AUC: 0.830579
Avg Precision: 0.371579
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.229978
valid_loss: 1.129918
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.000513518106664463
Epoch-18 lr: 0.000513518106664463
epoch 18 training time: 7.358
---------------
2023-09-12 08:52:18.890427
current #epochs=19, #steps=144
start validation
acc: 0.636364
AUC: 0.828512
Avg Precision: 0.374698
Avg Recall: 1.000000
d_prime: 1.341103
train_loss: 0.219230
valid_loss: 1.130464
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.000513518106664463
Epoch-19 lr: 0.000513518106664463
epoch 19 training time: 7.866
---------------
2023-09-12 08:52:26.756043
current #epochs=20, #steps=152
start validation
acc: 0.613636
AUC: 0.827135
Avg Precision: 0.365354
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.258999
valid_loss: 1.131456
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00037812925788427524
Epoch-20 lr: 0.00037812925788427524
epoch 20 training time: 6.302
---------------
2023-09-12 08:52:33.058049
current #epochs=21, #steps=160
start validation
acc: 0.613636
AUC: 0.834022
Avg Precision: 0.367030
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.233677
valid_loss: 1.129609
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00037812925788427524
Epoch-21 lr: 0.00037812925788427524
epoch 21 training time: 6.322
---------------
2023-09-12 08:52:39.380073
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.834711
Avg Precision: 0.357096
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.236851
valid_loss: 1.129143
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00037812925788427524
Epoch-22 lr: 0.00037812925788427524
epoch 22 training time: 6.241
---------------
2023-09-12 08:52:45.621092
current #epochs=23, #steps=176
start validation
acc: 0.659091
AUC: 0.831956
Avg Precision: 0.357096
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.185597
valid_loss: 1.128371
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00027843562634401555
Epoch-23 lr: 0.00027843562634401555
epoch 23 training time: 6.546
---------------
2023-09-12 08:52:52.166900
current #epochs=24, #steps=184
start validation
acc: 0.636364
AUC: 0.831612
Avg Precision: 0.357096
Avg Recall: 1.000000
d_prime: 1.358427
train_loss: 0.166941
valid_loss: 1.126097
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00027843562634401555
Epoch-24 lr: 0.00027843562634401555
epoch 24 training time: 6.399
---------------
2023-09-12 08:52:58.565606
current #epochs=25, #steps=192
start validation
acc: 0.613636
AUC: 0.831267
Avg Precision: 0.352258
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.199845
valid_loss: 1.124079
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00027843562634401555
Epoch-25 lr: 0.00027843562634401555
epoch 25 training time: 6.326
---------------
2023-09-12 08:53:04.891548
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03794	Per Sample Data Time 0.03080	Per Sample DNN Time 0.00713	Train Loss 0.1523	
start validation
acc: 0.636364
AUC: 0.830579
Avg Precision: 0.352258
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.179474
valid_loss: 1.123695
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00020502618192351266
Epoch-26 lr: 0.00020502618192351266
epoch 26 training time: 6.332
---------------
2023-09-12 08:53:11.223378
current #epochs=27, #steps=208
start validation
acc: 0.636364
AUC: 0.830579
Avg Precision: 0.350661
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.222673
valid_loss: 1.123719
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00020502618192351266
Epoch-27 lr: 0.00020502618192351266
epoch 27 training time: 6.629
---------------
2023-09-12 08:53:17.852684
current #epochs=28, #steps=216
start validation
acc: 0.636364
AUC: 0.831956
Avg Precision: 0.358810
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.200408
valid_loss: 1.124854
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00020502618192351266
Epoch-28 lr: 0.00020502618192351266
epoch 28 training time: 7.054
---------------
2023-09-12 08:53:24.906753
current #epochs=29, #steps=224
start validation
[I 2023-09-12 08:53:31,745] Trial 39 finished with value: 0.6590909090909091 and parameters: {'warmup': 'False', 'num_epochs': 29, 'batch_size': 28, 'lr-adaptschedule': 'True', 'lr': 0.0023721008923207713, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.7363503895517906}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.636364
AUC: 0.830579
Avg Precision: 0.358810
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.213756
valid_loss: 1.125308
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00015097110892769481
Epoch-29 lr: 0.00015097110892769481
epoch 29 training time: 6.833
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8ebaeb0>
The learning rate scheduler starts at 4 epoch with decay rate of 0.698 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 08:53:31.784909
current #epochs=1, #steps=0
start validation
acc: 0.590909
AUC: 0.841598
Avg Precision: 0.380244
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.246594
valid_loss: 1.123869
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0017093326580253823
Epoch-1 lr: 0.0017093326580253823
epoch 1 training time: 8.892
---------------
2023-09-12 08:53:40.676628
current #epochs=2, #steps=8
start validation
acc: 0.590909
AUC: 0.831267
Avg Precision: 0.373895
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.213710
valid_loss: 1.123911
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0017093326580253823
Epoch-2 lr: 0.0017093326580253823
epoch 2 training time: 6.439
---------------
2023-09-12 08:53:47.116099
current #epochs=3, #steps=16
start validation
acc: 0.613636
AUC: 0.840909
Avg Precision: 0.371074
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.316142
valid_loss: 1.123044
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0017093326580253823
Epoch-3 lr: 0.0017093326580253823
epoch 3 training time: 10.507
---------------
2023-09-12 08:53:57.622676
current #epochs=4, #steps=24
start validation
acc: 0.613636
AUC: 0.845041
Avg Precision: 0.371873
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.272573
valid_loss: 1.120985
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0011932955654453
Epoch-4 lr: 0.0011932955654453
epoch 4 training time: 6.358
---------------
2023-09-12 08:54:03.980293
current #epochs=5, #steps=32
start validation
acc: 0.590909
AUC: 0.851928
Avg Precision: 0.383255
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.264048
valid_loss: 1.122176
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0011932955654453
Epoch-5 lr: 0.0011932955654453
epoch 5 training time: 6.265
---------------
2023-09-12 08:54:10.244776
current #epochs=6, #steps=40
start validation
acc: 0.590909
AUC: 0.848485
Avg Precision: 0.358254
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.299192
valid_loss: 1.101869
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0011932955654453
Epoch-6 lr: 0.0011932955654453
epoch 6 training time: 7.541
---------------
2023-09-12 08:54:17.785449
current #epochs=7, #steps=48
start validation
acc: 0.613636
AUC: 0.856749
Avg Precision: 0.367485
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.285308
valid_loss: 1.105359
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0008330469202854683
Epoch-7 lr: 0.0008330469202854683
epoch 7 training time: 6.392
---------------
2023-09-12 08:54:24.176989
current #epochs=8, #steps=56
start validation
acc: 0.613636
AUC: 0.849174
Avg Precision: 0.371123
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.251198
valid_loss: 1.115789
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0008330469202854683
Epoch-8 lr: 0.0008330469202854683
epoch 8 training time: 7.784
---------------
2023-09-12 08:54:31.961097
current #epochs=9, #steps=64
start validation
acc: 0.590909
AUC: 0.840220
Avg Precision: 0.373290
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.228126
valid_loss: 1.121711
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0008330469202854683
Epoch-9 lr: 0.0008330469202854683
epoch 9 training time: 6.488
---------------
2023-09-12 08:54:38.449466
current #epochs=10, #steps=72
start validation
acc: 0.590909
AUC: 0.840909
Avg Precision: 0.378345
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.196553
valid_loss: 1.124536
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0005815551414859544
Epoch-10 lr: 0.0005815551414859544
epoch 10 training time: 6.226
---------------
2023-09-12 08:54:44.675605
current #epochs=11, #steps=80
start validation
acc: 0.590909
AUC: 0.842287
Avg Precision: 0.381117
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.237456
valid_loss: 1.124602
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0005815551414859544
Epoch-11 lr: 0.0005815551414859544
epoch 11 training time: 6.634
---------------
2023-09-12 08:54:51.310184
current #epochs=12, #steps=88
start validation
acc: 0.636364
AUC: 0.846419
Avg Precision: 0.381117
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.220634
valid_loss: 1.120865
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0005815551414859544
Epoch-12 lr: 0.0005815551414859544
epoch 12 training time: 8.876
---------------
2023-09-12 08:55:00.186205
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01156	Per Sample Data Time 0.00602	Per Sample DNN Time 0.00553	Train Loss 0.1343	
start validation
acc: 0.636364
AUC: 0.850551
Avg Precision: 0.382177
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.194900
valid_loss: 1.111104
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00040598719514244405
Epoch-13 lr: 0.00040598719514244405
epoch 13 training time: 6.439
---------------
2023-09-12 08:55:06.625057
current #epochs=14, #steps=104
start validation
acc: 0.613636
AUC: 0.848485
Avg Precision: 0.376135
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.213174
valid_loss: 1.112499
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.00040598719514244405
Epoch-14 lr: 0.00040598719514244405
epoch 14 training time: 6.385
---------------
2023-09-12 08:55:13.009490
current #epochs=15, #steps=112
start validation
acc: 0.590909
AUC: 0.844353
Avg Precision: 0.370592
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.241387
valid_loss: 1.116834
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.00040598719514244405
Epoch-15 lr: 0.00040598719514244405
epoch 15 training time: 7.058
---------------
2023-09-12 08:55:20.067350
current #epochs=16, #steps=120
start validation
acc: 0.568182
AUC: 0.840220
Avg Precision: 0.374031
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.179471
valid_loss: 1.124080
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0002834221398137356
Epoch-16 lr: 0.0002834221398137356
epoch 16 training time: 6.327
---------------
2023-09-12 08:55:26.394221
current #epochs=17, #steps=128
start validation
acc: 0.590909
AUC: 0.840220
Avg Precision: 0.373718
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.189450
valid_loss: 1.124992
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0002834221398137356
Epoch-17 lr: 0.0002834221398137356
epoch 17 training time: 6.362
---------------
2023-09-12 08:55:32.755777
current #epochs=18, #steps=136
start validation
acc: 0.568182
AUC: 0.840220
Avg Precision: 0.377949
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.189118
valid_loss: 1.129762
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0002834221398137356
Epoch-18 lr: 0.0002834221398137356
epoch 18 training time: 6.387
---------------
2023-09-12 08:55:39.142748
current #epochs=19, #steps=144
start validation
acc: 0.568182
AUC: 0.838843
Avg Precision: 0.394565
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.196851
valid_loss: 1.131790
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0001978587263285801
Epoch-19 lr: 0.0001978587263285801
epoch 19 training time: 6.434
---------------
2023-09-12 08:55:45.576592
current #epochs=20, #steps=152
start validation
acc: 0.568182
AUC: 0.842975
Avg Precision: 0.394565
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.200000
valid_loss: 1.129617
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0001978587263285801
Epoch-20 lr: 0.0001978587263285801
epoch 20 training time: 6.540
---------------
2023-09-12 08:55:52.116969
current #epochs=21, #steps=160
start validation
acc: 0.568182
AUC: 0.837466
Avg Precision: 0.385000
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.201431
valid_loss: 1.128368
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0001978587263285801
Epoch-21 lr: 0.0001978587263285801
epoch 21 training time: 6.443
---------------
2023-09-12 08:55:58.559459
current #epochs=22, #steps=168
start validation
acc: 0.568182
AUC: 0.838843
Avg Precision: 0.382532
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.214110
valid_loss: 1.127603
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0001381263849397792
Epoch-22 lr: 0.0001381263849397792
epoch 22 training time: 7.564
---------------
2023-09-12 08:56:06.124051
current #epochs=23, #steps=176
start validation
acc: 0.568182
AUC: 0.836088
Avg Precision: 0.382532
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.146796
valid_loss: 1.127275
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0001381263849397792
Epoch-23 lr: 0.0001381263849397792
epoch 23 training time: 9.315
---------------
2023-09-12 08:56:15.438471
current #epochs=24, #steps=184
start validation
acc: 0.568182
AUC: 0.838154
Avg Precision: 0.382532
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.195972
valid_loss: 1.126265
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0001381263849397792
Epoch-24 lr: 0.0001381263849397792
epoch 24 training time: 6.577
---------------
2023-09-12 08:56:22.015278
current #epochs=25, #steps=192
start validation
acc: 0.590909
AUC: 0.837466
Avg Precision: 0.386763
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.192382
valid_loss: 1.125523
validation finished
normal learning rate scheduler step
Epoch-25 lr: 9.64268727013238e-05
Epoch-25 lr: 9.64268727013238e-05
epoch 25 training time: 7.524
---------------
2023-09-12 08:56:29.539581
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03586	Per Sample Data Time 0.03037	Per Sample DNN Time 0.00548	Train Loss 0.2186	
start validation
acc: 0.545455
AUC: 0.838843
Avg Precision: 0.386763
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.176596
valid_loss: 1.125760
validation finished
normal learning rate scheduler step
Epoch-26 lr: 9.64268727013238e-05
Epoch-26 lr: 9.64268727013238e-05
epoch 26 training time: 6.428
---------------
2023-09-12 08:56:35.968130
current #epochs=27, #steps=208
start validation
[I 2023-09-12 08:56:43,440] Trial 40 finished with value: 0.6363636363636364 and parameters: {'warmup': 'False', 'num_epochs': 27, 'batch_size': 21, 'lr-adaptschedule': 'True', 'lr': 0.0017093326580253823, 'head-lr': 1, 'lr-scheduler-start': 4, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.6981061058201466}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.568182
AUC: 0.839532
Avg Precision: 0.391346
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.133743
valid_loss: 1.125280
validation finished
normal learning rate scheduler step
Epoch-27 lr: 9.64268727013238e-05
Epoch-27 lr: 9.64268727013238e-05
epoch 27 training time: 7.467
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8d978e0>
The learning rate scheduler starts at 5 epoch with decay rate of 0.705 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 08:56:43.475491
current #epochs=1, #steps=0
start validation
acc: 0.613636
AUC: 0.823691
Avg Precision: 0.389721
Avg Recall: 1.000000
d_prime: 1.314547
train_loss: 0.401778
valid_loss: 1.155883
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002479682524486715
Epoch-1 lr: 0.002479682524486715
epoch 1 training time: 9.527
---------------
2023-09-12 08:56:53.002803
current #epochs=2, #steps=8
start validation
acc: 0.590909
AUC: 0.807163
Avg Precision: 0.376933
Avg Recall: 1.000000
d_prime: 1.226813
train_loss: 0.399782
valid_loss: 1.164304
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002479682524486715
Epoch-2 lr: 0.002479682524486715
epoch 2 training time: 6.495
---------------
2023-09-12 08:56:59.497289
current #epochs=3, #steps=16
start validation
acc: 0.613636
AUC: 0.803719
Avg Precision: 0.336344
Avg Recall: 1.000000
d_prime: 1.209125
train_loss: 0.356622
valid_loss: 1.156972
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002479682524486715
Epoch-3 lr: 0.002479682524486715
epoch 3 training time: 6.477
---------------
2023-09-12 08:57:05.974415
current #epochs=4, #steps=24
start validation
acc: 0.568182
AUC: 0.816804
Avg Precision: 0.339163
Avg Recall: 1.000000
d_prime: 1.277394
train_loss: 0.289279
valid_loss: 1.150595
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002479682524486715
Epoch-4 lr: 0.002479682524486715
epoch 4 training time: 6.297
---------------
2023-09-12 08:57:12.271147
current #epochs=5, #steps=32
start validation
acc: 0.659091
AUC: 0.819559
Avg Precision: 0.347311
Avg Recall: 1.000000
d_prime: 1.292148
train_loss: 0.261188
valid_loss: 1.139840
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0017471352433904093
Epoch-5 lr: 0.0017471352433904093
epoch 5 training time: 8.896
---------------
2023-09-12 08:57:21.166767
current #epochs=6, #steps=40
start validation
acc: 0.659091
AUC: 0.836088
Avg Precision: 0.348021
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.257223
valid_loss: 1.128207
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0017471352433904093
Epoch-6 lr: 0.0017471352433904093
epoch 6 training time: 8.004
---------------
2023-09-12 08:57:29.171090
current #epochs=7, #steps=48
start validation
acc: 0.568182
AUC: 0.816804
Avg Precision: 0.356230
Avg Recall: 1.000000
d_prime: 1.277394
train_loss: 0.295456
valid_loss: 1.146785
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0017471352433904093
Epoch-7 lr: 0.0017471352433904093
epoch 7 training time: 6.250
---------------
2023-09-12 08:57:35.421684
current #epochs=8, #steps=56
start validation
acc: 0.590909
AUC: 0.827135
Avg Precision: 0.364371
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.342343
valid_loss: 1.128334
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0017471352433904093
Epoch-8 lr: 0.0017471352433904093
epoch 8 training time: 6.181
---------------
2023-09-12 08:57:41.602441
current #epochs=9, #steps=64
start validation
acc: 0.636364
AUC: 0.824380
Avg Precision: 0.368633
Avg Recall: 1.000000
d_prime: 1.318312
train_loss: 0.312433
valid_loss: 1.137381
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001230996923418137
Epoch-9 lr: 0.001230996923418137
epoch 9 training time: 6.549
---------------
2023-09-12 08:57:48.152100
current #epochs=10, #steps=72
start validation
acc: 0.613636
AUC: 0.831956
Avg Precision: 0.376375
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.249932
valid_loss: 1.135060
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001230996923418137
Epoch-10 lr: 0.001230996923418137
epoch 10 training time: 6.605
---------------
2023-09-12 08:57:54.756898
current #epochs=11, #steps=80
start validation
acc: 0.613636
AUC: 0.833333
Avg Precision: 0.357847
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.246624
valid_loss: 1.127452
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001230996923418137
Epoch-11 lr: 0.001230996923418137
epoch 11 training time: 6.309
---------------
2023-09-12 08:58:01.065602
current #epochs=12, #steps=88
start validation
acc: 0.613636
AUC: 0.835399
Avg Precision: 0.362060
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.229734
valid_loss: 1.122705
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001230996923418137
Epoch-12 lr: 0.001230996923418137
epoch 12 training time: 6.420
---------------
2023-09-12 08:58:07.485868
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01204	Per Sample Data Time 0.00619	Per Sample DNN Time 0.00585	Train Loss 0.1581	
start validation
acc: 0.590909
AUC: 0.832645
Avg Precision: 0.388310
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.166561
valid_loss: 1.123955
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0008673360755543423
Epoch-13 lr: 0.0008673360755543423
epoch 13 training time: 6.450
---------------
2023-09-12 08:58:13.936128
current #epochs=14, #steps=104
start validation
acc: 0.590909
AUC: 0.834022
Avg Precision: 0.380853
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.304781
valid_loss: 1.126813
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0008673360755543423
Epoch-14 lr: 0.0008673360755543423
epoch 14 training time: 6.818
---------------
2023-09-12 08:58:20.753628
current #epochs=15, #steps=112
start validation
acc: 0.590909
AUC: 0.840220
Avg Precision: 0.381950
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.203355
valid_loss: 1.131576
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0008673360755543423
Epoch-15 lr: 0.0008673360755543423
epoch 15 training time: 7.158
---------------
2023-09-12 08:58:27.911943
current #epochs=16, #steps=120
start validation
acc: 0.590909
AUC: 0.833333
Avg Precision: 0.380627
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.252082
valid_loss: 1.132666
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0008673360755543423
Epoch-16 lr: 0.0008673360755543423
epoch 16 training time: 7.403
---------------
2023-09-12 08:58:35.315120
current #epochs=17, #steps=128
start validation
acc: 0.613636
AUC: 0.836777
Avg Precision: 0.389583
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.227993
valid_loss: 1.124292
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0006111078375965048
Epoch-17 lr: 0.0006111078375965048
epoch 17 training time: 6.477
---------------
2023-09-12 08:58:41.791489
current #epochs=18, #steps=136
start validation
acc: 0.613636
AUC: 0.841598
Avg Precision: 0.397817
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.212591
valid_loss: 1.122144
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0006111078375965048
Epoch-18 lr: 0.0006111078375965048
epoch 18 training time: 6.465
---------------
2023-09-12 08:58:48.256817
current #epochs=19, #steps=144
start validation
acc: 0.613636
AUC: 0.842287
Avg Precision: 0.397817
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.135117
valid_loss: 1.120814
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0006111078375965048
Epoch-19 lr: 0.0006111078375965048
epoch 19 training time: 6.423
---------------
2023-09-12 08:58:54.680135
current #epochs=20, #steps=152
start validation
acc: 0.613636
AUC: 0.845730
Avg Precision: 0.405093
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.161064
valid_loss: 1.118601
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0006111078375965048
Epoch-20 lr: 0.0006111078375965048
epoch 20 training time: 7.176
---------------
2023-09-12 08:59:01.856205
current #epochs=21, #steps=160
start validation
acc: 0.613636
AUC: 0.842975
Avg Precision: 0.395532
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.199638
valid_loss: 1.120407
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0004305744909009929
Epoch-21 lr: 0.0004305744909009929
epoch 21 training time: 6.736
---------------
2023-09-12 08:59:08.592021
current #epochs=22, #steps=168
start validation
acc: 0.613636
AUC: 0.842287
Avg Precision: 0.404151
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.149997
valid_loss: 1.123064
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0004305744909009929
Epoch-22 lr: 0.0004305744909009929
epoch 22 training time: 6.398
---------------
2023-09-12 08:59:14.989775
current #epochs=23, #steps=176
start validation
[I 2023-09-12 08:59:21,287] Trial 41 finished with value: 0.6590909090909091 and parameters: {'warmup': 'False', 'num_epochs': 23, 'batch_size': 27, 'lr-adaptschedule': 'True', 'lr': 0.002479682524486715, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.7045802138530052}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.590909
AUC: 0.838843
Avg Precision: 0.417989
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.195226
valid_loss: 1.124301
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0004305744909009929
Epoch-23 lr: 0.0004305744909009929
epoch 23 training time: 6.293
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95bc7b1e20>
The learning rate scheduler starts at 5 epoch with decay rate of 0.675 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 08:59:21.323194
current #epochs=1, #steps=0
start validation
acc: 0.500000
AUC: 0.827135
Avg Precision: 0.464050
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.302050
valid_loss: 1.139430
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003050014295898122
Epoch-1 lr: 0.003050014295898122
epoch 1 training time: 9.586
---------------
2023-09-12 08:59:30.909213
current #epochs=2, #steps=8
start validation
acc: 0.636364
AUC: 0.840220
Avg Precision: 0.377056
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.465607
valid_loss: 1.139258
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003050014295898122
Epoch-2 lr: 0.003050014295898122
epoch 2 training time: 9.561
---------------
2023-09-12 08:59:40.470386
current #epochs=3, #steps=16
start validation
acc: 0.636364
AUC: 0.825758
Avg Precision: 0.332380
Avg Recall: 1.000000
d_prime: 1.325871
train_loss: 0.353597
valid_loss: 1.146503
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003050014295898122
Epoch-3 lr: 0.003050014295898122
epoch 3 training time: 8.697
---------------
2023-09-12 08:59:49.167010
current #epochs=4, #steps=24
start validation
acc: 0.613636
AUC: 0.826446
Avg Precision: 0.349220
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.358489
valid_loss: 1.149902
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003050014295898122
Epoch-4 lr: 0.003050014295898122
epoch 4 training time: 6.334
---------------
2023-09-12 08:59:55.501065
current #epochs=5, #steps=32
start validation
acc: 0.568182
AUC: 0.831956
Avg Precision: 0.372357
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.354954
valid_loss: 1.144480
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0020576840914512335
Epoch-5 lr: 0.0020576840914512335
epoch 5 training time: 6.338
---------------
2023-09-12 09:00:01.839432
current #epochs=6, #steps=40
start validation
acc: 0.636364
AUC: 0.831956
Avg Precision: 0.356701
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.307148
valid_loss: 1.139336
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.001388211139175892
Epoch-6 lr: 0.001388211139175892
epoch 6 training time: 7.670
---------------
2023-09-12 09:00:09.509755
current #epochs=7, #steps=48
start validation
acc: 0.681818
AUC: 0.834022
Avg Precision: 0.394872
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.291974
valid_loss: 1.141867
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.000936552979603818
Epoch-7 lr: 0.000936552979603818
epoch 7 training time: 9.125
---------------
2023-09-12 09:00:18.635024
current #epochs=8, #steps=56
start validation
acc: 0.636364
AUC: 0.836777
Avg Precision: 0.390954
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.323838
valid_loss: 1.137713
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0006318429948094901
Epoch-8 lr: 0.0006318429948094901
epoch 8 training time: 6.532
---------------
2023-09-12 09:00:25.167214
current #epochs=9, #steps=64
start validation
acc: 0.636364
AUC: 0.837466
Avg Precision: 0.387248
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.275249
valid_loss: 1.136048
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00042627120812610764
Epoch-9 lr: 0.00042627120812610764
epoch 9 training time: 6.336
---------------
2023-09-12 09:00:31.503021
current #epochs=10, #steps=72
start validation
acc: 0.636364
AUC: 0.843664
Avg Precision: 0.384407
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.257966
valid_loss: 1.131846
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00028758274503316877
Epoch-10 lr: 0.00028758274503316877
epoch 10 training time: 6.343
---------------
2023-09-12 09:00:37.845749
current #epochs=11, #steps=80
start validation
acc: 0.659091
AUC: 0.846419
Avg Precision: 0.385251
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.209636
valid_loss: 1.128391
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00019401693960138528
Epoch-11 lr: 0.00019401693960138528
epoch 11 training time: 6.293
---------------
2023-09-12 09:00:44.138843
current #epochs=12, #steps=88
start validation
acc: 0.636364
AUC: 0.849174
Avg Precision: 0.385361
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.276582
valid_loss: 1.126354
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0001308930160185585
Epoch-12 lr: 0.0001308930160185585
epoch 12 training time: 6.390
---------------
2023-09-12 09:00:50.529188
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01135	Per Sample Data Time 0.00590	Per Sample DNN Time 0.00545	Train Loss 0.2211	
start validation
acc: 0.659091
AUC: 0.848485
Avg Precision: 0.381130
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.227210
valid_loss: 1.125619
validation finished
normal learning rate scheduler step
Epoch-13 lr: 8.8306627646199e-05
Epoch-13 lr: 8.8306627646199e-05
epoch 13 training time: 6.393
---------------
2023-09-12 09:00:56.922745
current #epochs=14, #steps=104
start validation
acc: 0.636364
AUC: 0.848485
Avg Precision: 0.384087
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.210945
valid_loss: 1.125431
validation finished
normal learning rate scheduler step
Epoch-14 lr: 5.957583317614746e-05
Epoch-14 lr: 5.957583317614746e-05
epoch 14 training time: 6.353
---------------
2023-09-12 09:01:03.275621
current #epochs=15, #steps=112
start validation
acc: 0.636364
AUC: 0.849862
Avg Precision: 0.390355
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.275586
valid_loss: 1.125772
validation finished
normal learning rate scheduler step
Epoch-15 lr: 4.0192678547892934e-05
Epoch-15 lr: 4.0192678547892934e-05
epoch 15 training time: 7.989
---------------
2023-09-12 09:01:11.264896
current #epochs=16, #steps=120
start validation
acc: 0.636364
AUC: 0.850551
Avg Precision: 0.394273
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.222971
valid_loss: 1.126044
validation finished
normal learning rate scheduler step
Epoch-16 lr: 2.7115884457341266e-05
Epoch-16 lr: 2.7115884457341266e-05
epoch 16 training time: 6.330
---------------
2023-09-12 09:01:17.594812
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.850551
Avg Precision: 0.394273
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.260972
valid_loss: 1.126197
validation finished
normal learning rate scheduler step
Epoch-17 lr: 1.829365985219782e-05
Epoch-17 lr: 1.829365985219782e-05
epoch 17 training time: 6.433
---------------
2023-09-12 09:01:24.028010
current #epochs=18, #steps=136
start validation
acc: 0.636364
AUC: 0.850551
Avg Precision: 0.394273
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.242235
valid_loss: 1.126188
validation finished
normal learning rate scheduler step
Epoch-18 lr: 1.2341769316593698e-05
Epoch-18 lr: 1.2341769316593698e-05
epoch 18 training time: 6.999
---------------
2023-09-12 09:01:31.027186
current #epochs=19, #steps=144
start validation
acc: 0.636364
AUC: 0.849174
Avg Precision: 0.390355
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.272207
valid_loss: 1.126170
validation finished
normal learning rate scheduler step
Epoch-19 lr: 8.326342082156616e-06
Epoch-19 lr: 8.326342082156616e-06
epoch 19 training time: 6.423
---------------
2023-09-12 09:01:37.450482
current #epochs=20, #steps=152
start validation
acc: 0.636364
AUC: 0.849174
Avg Precision: 0.390355
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.234735
valid_loss: 1.126113
validation finished
normal learning rate scheduler step
Epoch-20 lr: 5.617344700802311e-06
Epoch-20 lr: 5.617344700802311e-06
epoch 20 training time: 6.629
---------------
2023-09-12 09:01:44.079281
current #epochs=21, #steps=160
start validation
acc: 0.636364
AUC: 0.849862
Avg Precision: 0.394273
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.224740
valid_loss: 1.126063
validation finished
normal learning rate scheduler step
Epoch-21 lr: 3.7897267703249128e-06
Epoch-21 lr: 3.7897267703249128e-06
epoch 21 training time: 6.329
---------------
2023-09-12 09:01:50.408885
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.849862
Avg Precision: 0.394273
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.242801
valid_loss: 1.126051
validation finished
normal learning rate scheduler step
Epoch-22 lr: 2.556729159181918e-06
Epoch-22 lr: 2.556729159181918e-06
epoch 22 training time: 6.384
---------------
2023-09-12 09:01:56.793203
current #epochs=23, #steps=176
start validation
acc: 0.636364
AUC: 0.849862
Avg Precision: 0.394273
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.255623
valid_loss: 1.126049
validation finished
normal learning rate scheduler step
Epoch-23 lr: 1.724890576438744e-06
Epoch-23 lr: 1.724890576438744e-06
epoch 23 training time: 6.420
---------------
2023-09-12 09:02:03.213307
current #epochs=24, #steps=184
start validation
acc: 0.636364
AUC: 0.849862
Avg Precision: 0.394273
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.227568
valid_loss: 1.126042
validation finished
normal learning rate scheduler step
Epoch-24 lr: 1.163692872982752e-06
Epoch-24 lr: 1.163692872982752e-06
epoch 24 training time: 6.263
---------------
2023-09-12 09:02:09.475835
current #epochs=25, #steps=192
start validation
acc: 0.636364
AUC: 0.849862
Avg Precision: 0.394273
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.225410
valid_loss: 1.126036
validation finished
normal learning rate scheduler step
Epoch-25 lr: 7.850823241360217e-07
Epoch-25 lr: 7.850823241360217e-07
epoch 25 training time: 6.397
---------------
2023-09-12 09:02:15.872595
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03656	Per Sample Data Time 0.03106	Per Sample DNN Time 0.00549	Train Loss 0.2709	
start validation
acc: 0.636364
AUC: 0.849862
Avg Precision: 0.394273
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.258231
valid_loss: 1.126035
validation finished
normal learning rate scheduler step
Epoch-26 lr: 5.296537170421881e-07
Epoch-26 lr: 5.296537170421881e-07
epoch 26 training time: 8.039
---------------
2023-09-12 09:02:23.911331
current #epochs=27, #steps=208
start validation
acc: 0.636364
AUC: 0.849862
Avg Precision: 0.394273
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.224705
valid_loss: 1.126029
validation finished
normal learning rate scheduler step
Epoch-27 lr: 3.573294817015925e-07
Epoch-27 lr: 3.573294817015925e-07
epoch 27 training time: 7.353
---------------
2023-09-12 09:02:31.263848
current #epochs=28, #steps=216
start validation
acc: 0.636364
AUC: 0.849862
Avg Precision: 0.394273
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.231660
valid_loss: 1.126030
validation finished
normal learning rate scheduler step
Epoch-28 lr: 2.410713913350265e-07
Epoch-28 lr: 2.410713913350265e-07
epoch 28 training time: 6.407
---------------
2023-09-12 09:02:37.670870
current #epochs=29, #steps=224
start validation
acc: 0.636364
AUC: 0.849862
Avg Precision: 0.394273
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.196540
valid_loss: 1.126030
validation finished
normal learning rate scheduler step
Epoch-29 lr: 1.626381776377969e-07
Epoch-29 lr: 1.626381776377969e-07
epoch 29 training time: 7.764
---------------
2023-09-12 09:02:45.435310
current #epochs=30, #steps=232
start validation
[I 2023-09-12 09:02:52,254] Trial 42 finished with value: 0.6818181818181818 and parameters: {'warmup': 'False', 'num_epochs': 30, 'batch_size': 18, 'lr-adaptschedule': 'True', 'lr': 0.003050014295898122, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.6746473595938729}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.636364
AUC: 0.849862
Avg Precision: 0.394273
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.204632
valid_loss: 1.126029
validation finished
normal learning rate scheduler step
Epoch-30 lr: 1.0972341711249893e-07
Epoch-30 lr: 1.0972341711249893e-07
epoch 30 training time: 6.813
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8e7a910>
The learning rate scheduler starts at 5 epoch with decay rate of 0.708 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 09:02:52.292523
current #epochs=1, #steps=0
start validation
acc: 0.613636
AUC: 0.836777
Avg Precision: 0.371032
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.318050
valid_loss: 1.136999
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002711135888853712
Epoch-1 lr: 0.002711135888853712
epoch 1 training time: 10.242
---------------
2023-09-12 09:03:02.535439
current #epochs=2, #steps=8
start validation
acc: 0.590909
AUC: 0.833333
Avg Precision: 0.377674
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.335246
valid_loss: 1.139578
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002711135888853712
Epoch-2 lr: 0.002711135888853712
epoch 2 training time: 6.361
---------------
2023-09-12 09:03:08.896750
current #epochs=3, #steps=16
start validation
acc: 0.590909
AUC: 0.848485
Avg Precision: 0.383878
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.336415
valid_loss: 1.120746
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002711135888853712
Epoch-3 lr: 0.002711135888853712
epoch 3 training time: 6.746
---------------
2023-09-12 09:03:15.642210
current #epochs=4, #steps=24
start validation
acc: 0.590909
AUC: 0.814050
Avg Precision: 0.387634
Avg Recall: 1.000000
d_prime: 1.262777
train_loss: 0.342520
valid_loss: 1.139374
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002711135888853712
Epoch-4 lr: 0.002711135888853712
epoch 4 training time: 7.747
---------------
2023-09-12 09:03:23.388836
current #epochs=5, #steps=32
start validation
acc: 0.659091
AUC: 0.842975
Avg Precision: 0.377013
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.341880
valid_loss: 1.132734
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0019207732491407846
Epoch-5 lr: 0.0019207732491407846
epoch 5 training time: 10.924
---------------
2023-09-12 09:03:34.312837
current #epochs=6, #steps=40
start validation
acc: 0.636364
AUC: 0.853306
Avg Precision: 0.428667
Avg Recall: 1.000000
d_prime: 1.485939
train_loss: 0.297951
valid_loss: 1.126511
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0019207732491407846
Epoch-6 lr: 0.0019207732491407846
epoch 6 training time: 6.433
---------------
2023-09-12 09:03:40.745608
current #epochs=7, #steps=48
start validation
acc: 0.659091
AUC: 0.851928
Avg Precision: 0.417725
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.369906
valid_loss: 1.117969
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0013608207134813664
Epoch-7 lr: 0.0013608207134813664
epoch 7 training time: 6.315
---------------
2023-09-12 09:03:47.060825
current #epochs=8, #steps=56
start validation
acc: 0.681818
AUC: 0.854683
Avg Precision: 0.440095
Avg Recall: 1.000000
d_prime: 1.494446
train_loss: 0.235051
valid_loss: 1.112630
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0013608207134813664
Epoch-8 lr: 0.0013608207134813664
epoch 8 training time: 9.115
---------------
2023-09-12 09:03:56.175318
current #epochs=9, #steps=64
start validation
acc: 0.636364
AUC: 0.857438
Avg Precision: 0.454485
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.275961
valid_loss: 1.115801
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0009641080825486879
Epoch-9 lr: 0.0009641080825486879
epoch 9 training time: 6.555
---------------
2023-09-12 09:04:02.730479
current #epochs=10, #steps=72
start validation
acc: 0.613636
AUC: 0.859504
Avg Precision: 0.448423
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.262874
valid_loss: 1.115041
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0009641080825486879
Epoch-10 lr: 0.0009641080825486879
epoch 10 training time: 7.926
---------------
2023-09-12 09:04:10.656555
current #epochs=11, #steps=80
start validation
acc: 0.636364
AUC: 0.856061
Avg Precision: 0.400780
Avg Recall: 1.000000
d_prime: 1.503007
train_loss: 0.266125
valid_loss: 1.118767
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0006830469183980681
Epoch-11 lr: 0.0006830469183980681
epoch 11 training time: 8.260
---------------
2023-09-12 09:04:18.916926
current #epochs=12, #steps=88
start validation
acc: 0.636364
AUC: 0.846419
Avg Precision: 0.383487
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.214122
valid_loss: 1.128372
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0006830469183980681
Epoch-12 lr: 0.0006830469183980681
epoch 12 training time: 6.526
---------------
2023-09-12 09:04:25.443000
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01147	Per Sample Data Time 0.00591	Per Sample DNN Time 0.00556	Train Loss 0.2716	
start validation
acc: 0.636364
AUC: 0.835399
Avg Precision: 0.405674
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.248962
valid_loss: 1.137072
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0004839219805104537
Epoch-13 lr: 0.0004839219805104537
epoch 13 training time: 6.398
---------------
2023-09-12 09:04:31.840987
current #epochs=14, #steps=104
start validation
acc: 0.636364
AUC: 0.831267
Avg Precision: 0.388620
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.282184
valid_loss: 1.138950
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0004839219805104537
Epoch-14 lr: 0.0004839219805104537
epoch 14 training time: 6.494
---------------
2023-09-12 09:04:38.335082
current #epochs=15, #steps=112
start validation
acc: 0.613636
AUC: 0.842287
Avg Precision: 0.396543
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.243994
valid_loss: 1.132458
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.00034284684831076793
Epoch-15 lr: 0.00034284684831076793
epoch 15 training time: 8.059
---------------
2023-09-12 09:04:46.393507
current #epochs=16, #steps=120
start validation
acc: 0.636364
AUC: 0.845041
Avg Precision: 0.393382
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.208341
valid_loss: 1.129720
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.00034284684831076793
Epoch-16 lr: 0.00034284684831076793
epoch 16 training time: 6.305
---------------
2023-09-12 09:04:52.699197
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.842287
Avg Precision: 0.387685
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.189977
valid_loss: 1.129447
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0002428985789664653
Epoch-17 lr: 0.0002428985789664653
epoch 17 training time: 6.324
---------------
2023-09-12 09:04:59.023236
current #epochs=18, #steps=136
start validation
acc: 0.590909
AUC: 0.842287
Avg Precision: 0.392600
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.199889
valid_loss: 1.130907
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0002428985789664653
Epoch-18 lr: 0.0002428985789664653
epoch 18 training time: 6.360
---------------
2023-09-12 09:05:05.383361
current #epochs=19, #steps=144
start validation
acc: 0.590909
AUC: 0.842287
Avg Precision: 0.392600
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.221126
valid_loss: 1.131521
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0001720876827499632
Epoch-19 lr: 0.0001720876827499632
epoch 19 training time: 6.546
---------------
2023-09-12 09:05:11.929472
current #epochs=20, #steps=152
start validation
acc: 0.590909
AUC: 0.840909
Avg Precision: 0.390289
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.222191
valid_loss: 1.131494
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0001720876827499632
Epoch-20 lr: 0.0001720876827499632
epoch 20 training time: 8.082
---------------
2023-09-12 09:05:20.011327
current #epochs=21, #steps=160
start validation
acc: 0.590909
AUC: 0.839532
Avg Precision: 0.381732
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.218221
valid_loss: 1.130593
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00012191990039736101
Epoch-21 lr: 0.00012191990039736101
epoch 21 training time: 6.249
---------------
2023-09-12 09:05:26.260227
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.841598
Avg Precision: 0.394232
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.226186
valid_loss: 1.129180
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00012191990039736101
Epoch-22 lr: 0.00012191990039736101
epoch 22 training time: 6.267
---------------
2023-09-12 09:05:32.527857
current #epochs=23, #steps=176
start validation
acc: 0.636364
AUC: 0.845041
Avg Precision: 0.394232
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.273912
valid_loss: 1.127614
validation finished
normal learning rate scheduler step
Epoch-23 lr: 8.637725765939869e-05
Epoch-23 lr: 8.637725765939869e-05
epoch 23 training time: 6.622
---------------
2023-09-12 09:05:39.150268
current #epochs=24, #steps=184
start validation
acc: 0.636364
AUC: 0.845041
Avg Precision: 0.394232
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.136086
valid_loss: 1.127390
validation finished
normal learning rate scheduler step
Epoch-24 lr: 8.637725765939869e-05
Epoch-24 lr: 8.637725765939869e-05
epoch 24 training time: 7.388
---------------
2023-09-12 09:05:46.537900
current #epochs=25, #steps=192
start validation
acc: 0.636364
AUC: 0.845730
Avg Precision: 0.394232
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.212541
valid_loss: 1.127554
validation finished
normal learning rate scheduler step
Epoch-25 lr: 6.119616745454334e-05
Epoch-25 lr: 6.119616745454334e-05
epoch 25 training time: 8.457
---------------
2023-09-12 09:05:54.994838
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03610	Per Sample Data Time 0.03057	Per Sample DNN Time 0.00553	Train Loss 0.1777	
start validation
acc: 0.636364
AUC: 0.845730
Avg Precision: 0.394232
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.203781
valid_loss: 1.127861
validation finished
normal learning rate scheduler step
Epoch-26 lr: 6.119616745454334e-05
Epoch-26 lr: 6.119616745454334e-05
epoch 26 training time: 8.214
---------------
2023-09-12 09:06:03.208633
current #epochs=27, #steps=208
start validation
acc: 0.613636
AUC: 0.843664
Avg Precision: 0.394232
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.213638
valid_loss: 1.128697
validation finished
normal learning rate scheduler step
Epoch-27 lr: 4.335598295898226e-05
Epoch-27 lr: 4.335598295898226e-05
epoch 27 training time: 6.388
---------------
2023-09-12 09:06:09.596516
current #epochs=28, #steps=216
start validation
acc: 0.613636
AUC: 0.842975
Avg Precision: 0.394232
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.186106
valid_loss: 1.128890
validation finished
normal learning rate scheduler step
Epoch-28 lr: 4.335598295898226e-05
Epoch-28 lr: 4.335598295898226e-05
epoch 28 training time: 6.363
---------------
2023-09-12 09:06:15.959437
current #epochs=29, #steps=224
start validation
acc: 0.613636
AUC: 0.842287
Avg Precision: 0.387685
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.176410
valid_loss: 1.129319
validation finished
normal learning rate scheduler step
Epoch-29 lr: 3.071665002119351e-05
Epoch-29 lr: 3.071665002119351e-05
epoch 29 training time: 6.399
---------------
2023-09-12 09:06:22.358182
current #epochs=30, #steps=232
start validation
acc: 0.613636
AUC: 0.842287
Avg Precision: 0.387685
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.205752
valid_loss: 1.129537
validation finished
normal learning rate scheduler step
Epoch-30 lr: 3.071665002119351e-05
Epoch-30 lr: 3.071665002119351e-05
epoch 30 training time: 6.489
---------------
2023-09-12 09:06:28.847193
current #epochs=31, #steps=240
start validation
acc: 0.613636
AUC: 0.842975
Avg Precision: 0.397619
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.206831
valid_loss: 1.129656
validation finished
normal learning rate scheduler step
Epoch-31 lr: 2.176199278925621e-05
Epoch-31 lr: 2.176199278925621e-05
epoch 31 training time: 6.953
---------------
2023-09-12 09:06:35.800096
current #epochs=32, #steps=248
start validation
acc: 0.613636
AUC: 0.843664
Avg Precision: 0.397619
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.161689
valid_loss: 1.129532
validation finished
normal learning rate scheduler step
Epoch-32 lr: 2.176199278925621e-05
Epoch-32 lr: 2.176199278925621e-05
epoch 32 training time: 6.452
---------------
2023-09-12 09:06:42.252445
current #epochs=33, #steps=256
start validation
acc: 0.613636
AUC: 0.843664
Avg Precision: 0.397619
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.201871
valid_loss: 1.129429
validation finished
normal learning rate scheduler step
Epoch-33 lr: 1.541783787727116e-05
Epoch-33 lr: 1.541783787727116e-05
epoch 33 training time: 8.531
---------------
2023-09-12 09:06:50.783105
current #epochs=34, #steps=264
start validation
acc: 0.613636
AUC: 0.843664
Avg Precision: 0.397619
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.172845
valid_loss: 1.129341
validation finished
normal learning rate scheduler step
Epoch-34 lr: 1.541783787727116e-05
Epoch-34 lr: 1.541783787727116e-05
epoch 34 training time: 6.274
---------------
2023-09-12 09:06:57.056622
current #epochs=35, #steps=272
start validation
[I 2023-09-12 09:07:06,402] Trial 43 finished with value: 0.6818181818181818 and parameters: {'warmup': 'False', 'num_epochs': 35, 'batch_size': 35, 'lr-adaptschedule': 'True', 'lr': 0.002711135888853712, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.7084754611665377}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.613636
AUC: 0.843664
Avg Precision: 0.397619
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.160240
valid_loss: 1.129200
validation finished
normal learning rate scheduler step
Epoch-35 lr: 1.0923159800290598e-05
Epoch-35 lr: 1.0923159800290598e-05
epoch 35 training time: 9.341
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f957c101040>
The learning rate scheduler starts at 3 epoch with decay rate of 0.657 every 6 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 09:07:06.438022
current #epochs=1, #steps=0
start validation
acc: 0.568182
AUC: 0.803719
Avg Precision: 0.367997
Avg Recall: 1.000000
d_prime: 1.209125
train_loss: 0.359046
valid_loss: 1.171403
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0033935972627329673
Epoch-1 lr: 0.0033935972627329673
epoch 1 training time: 8.956
---------------
2023-09-12 09:07:15.394641
current #epochs=2, #steps=8
start validation
acc: 0.613636
AUC: 0.809917
Avg Precision: 0.424193
Avg Recall: 1.000000
d_prime: 1.241102
train_loss: 0.411214
valid_loss: 1.199165
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0033935972627329673
Epoch-2 lr: 0.0033935972627329673
epoch 2 training time: 9.545
---------------
2023-09-12 09:07:24.940081
current #epochs=3, #steps=16
start validation
acc: 0.522727
AUC: 0.788567
Avg Precision: 0.328571
Avg Recall: 1.000000
d_prime: 1.133437
train_loss: 0.403677
valid_loss: 1.211255
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0022284407765576233
Epoch-3 lr: 0.0022284407765576233
epoch 3 training time: 6.821
---------------
2023-09-12 09:07:31.761299
current #epochs=4, #steps=24
start validation
acc: 0.590909
AUC: 0.818871
Avg Precision: 0.350605
Avg Recall: 1.000000
d_prime: 1.288446
train_loss: 0.397272
valid_loss: 1.163380
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0022284407765576233
Epoch-4 lr: 0.0022284407765576233
epoch 4 training time: 6.254
---------------
2023-09-12 09:07:38.015681
current #epochs=5, #steps=32
start validation
acc: 0.613636
AUC: 0.838154
Avg Precision: 0.382432
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.408614
valid_loss: 1.150931
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0022284407765576233
Epoch-5 lr: 0.0022284407765576233
epoch 5 training time: 6.426
---------------
2023-09-12 09:07:44.441800
current #epochs=6, #steps=40
start validation
acc: 0.590909
AUC: 0.838154
Avg Precision: 0.378631
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.348237
valid_loss: 1.156986
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0022284407765576233
Epoch-6 lr: 0.0022284407765576233
epoch 6 training time: 7.281
---------------
2023-09-12 09:07:51.722767
current #epochs=7, #steps=48
start validation
acc: 0.613636
AUC: 0.855372
Avg Precision: 0.367689
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.355312
valid_loss: 1.128404
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0022284407765576233
Epoch-7 lr: 0.0022284407765576233
epoch 7 training time: 8.055
---------------
2023-09-12 09:07:59.777780
current #epochs=8, #steps=56
start validation
acc: 0.636364
AUC: 0.858127
Avg Precision: 0.373254
Avg Recall: 1.000000
d_prime: 1.515953
train_loss: 0.300124
valid_loss: 1.119759
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0022284407765576233
Epoch-8 lr: 0.0022284407765576233
epoch 8 training time: 9.691
---------------
2023-09-12 09:08:09.468710
current #epochs=9, #steps=64
start validation
acc: 0.636364
AUC: 0.849174
Avg Precision: 0.365165
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.331234
valid_loss: 1.132392
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0014633287070209132
Epoch-9 lr: 0.0014633287070209132
epoch 9 training time: 7.784
---------------
2023-09-12 09:08:17.252769
current #epochs=10, #steps=72
start validation
acc: 0.613636
AUC: 0.847796
Avg Precision: 0.372249
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.288426
valid_loss: 1.140124
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0014633287070209132
Epoch-10 lr: 0.0014633287070209132
epoch 10 training time: 7.382
---------------
2023-09-12 09:08:24.634821
current #epochs=11, #steps=80
start validation
acc: 0.568182
AUC: 0.846419
Avg Precision: 0.369218
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.312511
valid_loss: 1.133983
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0014633287070209132
Epoch-11 lr: 0.0014633287070209132
epoch 11 training time: 6.377
---------------
2023-09-12 09:08:31.011869
current #epochs=12, #steps=88
start validation
acc: 0.613636
AUC: 0.837466
Avg Precision: 0.368652
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.228672
valid_loss: 1.135973
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0014633287070209132
Epoch-12 lr: 0.0014633287070209132
epoch 12 training time: 6.507
---------------
2023-09-12 09:08:37.518622
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01212	Per Sample Data Time 0.00625	Per Sample DNN Time 0.00587	Train Loss 0.2410	
start validation
acc: 0.659091
AUC: 0.837466
Avg Precision: 0.374509
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.296203
valid_loss: 1.134905
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0014633287070209132
Epoch-13 lr: 0.0014633287070209132
epoch 13 training time: 9.486
---------------
2023-09-12 09:08:47.004111
current #epochs=14, #steps=104
start validation
acc: 0.613636
AUC: 0.838154
Avg Precision: 0.368633
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.219626
valid_loss: 1.136580
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0014633287070209132
Epoch-14 lr: 0.0014633287070209132
epoch 14 training time: 6.502
---------------
2023-09-12 09:08:53.506448
current #epochs=15, #steps=112
start validation
acc: 0.636364
AUC: 0.829201
Avg Precision: 0.370843
Avg Recall: 1.000000
d_prime: 1.344935
train_loss: 0.200812
valid_loss: 1.140547
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0009609099453382431
Epoch-15 lr: 0.0009609099453382431
epoch 15 training time: 6.493
---------------
2023-09-12 09:08:59.999646
current #epochs=16, #steps=120
start validation
acc: 0.636364
AUC: 0.834711
Avg Precision: 0.383863
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.223040
valid_loss: 1.136165
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0009609099453382431
Epoch-16 lr: 0.0009609099453382431
epoch 16 training time: 6.983
---------------
2023-09-12 09:09:06.983119
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.834711
Avg Precision: 0.383863
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.242354
valid_loss: 1.133668
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0009609099453382431
Epoch-17 lr: 0.0009609099453382431
epoch 17 training time: 6.455
---------------
2023-09-12 09:09:13.438125
current #epochs=18, #steps=136
start validation
acc: 0.681818
AUC: 0.829890
Avg Precision: 0.384722
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.255842
valid_loss: 1.134284
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0009609099453382431
Epoch-18 lr: 0.0009609099453382431
epoch 18 training time: 9.734
---------------
2023-09-12 09:09:23.171492
current #epochs=19, #steps=144
start validation
acc: 0.659091
AUC: 0.825069
Avg Precision: 0.378219
Avg Recall: 1.000000
d_prime: 1.322087
train_loss: 0.206887
valid_loss: 1.138831
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0009609099453382431
Epoch-19 lr: 0.0009609099453382431
epoch 19 training time: 6.444
---------------
2023-09-12 09:09:29.615604
current #epochs=20, #steps=152
start validation
acc: 0.681818
AUC: 0.825758
Avg Precision: 0.378513
Avg Recall: 1.000000
d_prime: 1.325871
train_loss: 0.195080
valid_loss: 1.136044
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0009609099453382431
Epoch-20 lr: 0.0009609099453382431
epoch 20 training time: 7.225
---------------
2023-09-12 09:09:36.840706
current #epochs=21, #steps=160
start validation
acc: 0.613636
AUC: 0.821625
Avg Precision: 0.367674
Avg Recall: 1.000000
d_prime: 1.303307
train_loss: 0.179685
valid_loss: 1.135252
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0006309914639272838
Epoch-21 lr: 0.0006309914639272838
epoch 21 training time: 6.283
---------------
2023-09-12 09:09:43.123589
current #epochs=22, #steps=168
start validation
acc: 0.613636
AUC: 0.824380
Avg Precision: 0.369722
Avg Recall: 1.000000
d_prime: 1.318312
train_loss: 0.224860
valid_loss: 1.137123
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0006309914639272838
Epoch-22 lr: 0.0006309914639272838
epoch 22 training time: 6.551
---------------
2023-09-12 09:09:49.674595
current #epochs=23, #steps=176
start validation
acc: 0.636364
AUC: 0.822314
Avg Precision: 0.369926
Avg Recall: 1.000000
d_prime: 1.307044
train_loss: 0.221778
valid_loss: 1.138445
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0006309914639272838
Epoch-23 lr: 0.0006309914639272838
epoch 23 training time: 6.337
---------------
2023-09-12 09:09:56.011622
current #epochs=24, #steps=184
start validation
acc: 0.636364
AUC: 0.826446
Avg Precision: 0.369926
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.196772
valid_loss: 1.135645
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0006309914639272838
Epoch-24 lr: 0.0006309914639272838
epoch 24 training time: 6.443
---------------
2023-09-12 09:10:02.454488
current #epochs=25, #steps=192
start validation
acc: 0.613636
AUC: 0.825758
Avg Precision: 0.359762
Avg Recall: 1.000000
d_prime: 1.325871
train_loss: 0.262255
valid_loss: 1.135036
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0006309914639272838
Epoch-25 lr: 0.0006309914639272838
epoch 25 training time: 6.295
---------------
2023-09-12 09:10:08.749136
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03528	Per Sample Data Time 0.02978	Per Sample DNN Time 0.00550	Train Loss 0.1917	
start validation
[I 2023-09-12 09:10:15,353] Trial 44 finished with value: 0.6818181818181818 and parameters: {'warmup': 'False', 'num_epochs': 26, 'batch_size': 27, 'lr-adaptschedule': 'True', 'lr': 0.0033935972627329673, 'head-lr': 1, 'lr-scheduler-start': 3, 'lr-scheduler-step': 6, 'lr-scheduler-decay': 0.6566603530210866}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.636364
AUC: 0.823003
Avg Precision: 0.352915
Avg Recall: 1.000000
d_prime: 1.310791
train_loss: 0.178687
valid_loss: 1.132586
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0006309914639272838
Epoch-26 lr: 0.0006309914639272838
epoch 26 training time: 6.599
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8db6700>
The learning rate scheduler starts at 6 epoch with decay rate of 0.718 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 09:10:15.389419
current #epochs=1, #steps=0
start validation
acc: 0.636364
AUC: 0.829890
Avg Precision: 0.407304
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.325330
valid_loss: 1.136999
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002325699427271327
Epoch-1 lr: 0.002325699427271327
epoch 1 training time: 8.974
---------------
2023-09-12 09:10:24.364361
current #epochs=2, #steps=8
start validation
acc: 0.590909
AUC: 0.836088
Avg Precision: 0.388487
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.280934
valid_loss: 1.147459
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002325699427271327
Epoch-2 lr: 0.002325699427271327
epoch 2 training time: 6.583
---------------
2023-09-12 09:10:30.947474
current #epochs=3, #steps=16
start validation
acc: 0.590909
AUC: 0.831267
Avg Precision: 0.356402
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.351003
valid_loss: 1.136707
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002325699427271327
Epoch-3 lr: 0.002325699427271327
epoch 3 training time: 7.531
---------------
2023-09-12 09:10:38.479039
current #epochs=4, #steps=24
start validation
acc: 0.613636
AUC: 0.847107
Avg Precision: 0.379475
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.225001
valid_loss: 1.130044
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002325699427271327
Epoch-4 lr: 0.002325699427271327
epoch 4 training time: 6.488
---------------
2023-09-12 09:10:44.967379
current #epochs=5, #steps=32
start validation
acc: 0.545455
AUC: 0.834022
Avg Precision: 0.367717
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.258294
valid_loss: 1.143296
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002325699427271327
Epoch-5 lr: 0.002325699427271327
epoch 5 training time: 8.775
---------------
2023-09-12 09:10:53.742429
current #epochs=6, #steps=40
start validation
acc: 0.590909
AUC: 0.823691
Avg Precision: 0.354443
Avg Recall: 1.000000
d_prime: 1.314547
train_loss: 0.217362
valid_loss: 1.146642
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.001668968643610723
Epoch-6 lr: 0.001668968643610723
epoch 6 training time: 6.236
---------------
2023-09-12 09:10:59.979058
current #epochs=7, #steps=48
start validation
acc: 0.636364
AUC: 0.820248
Avg Precision: 0.346105
Avg Recall: 1.000000
d_prime: 1.295859
train_loss: 0.232726
valid_loss: 1.153724
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.001668968643610723
Epoch-7 lr: 0.001668968643610723
epoch 7 training time: 6.458
---------------
2023-09-12 09:11:06.437229
current #epochs=8, #steps=56
start validation
acc: 0.613636
AUC: 0.829201
Avg Precision: 0.371283
Avg Recall: 1.000000
d_prime: 1.344935
train_loss: 0.281653
valid_loss: 1.151558
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0011976854363437276
Epoch-8 lr: 0.0011976854363437276
epoch 8 training time: 6.409
---------------
2023-09-12 09:11:12.846193
current #epochs=9, #steps=64
start validation
acc: 0.636364
AUC: 0.837466
Avg Precision: 0.380831
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.217925
valid_loss: 1.149914
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0011976854363437276
Epoch-9 lr: 0.0011976854363437276
epoch 9 training time: 7.590
---------------
2023-09-12 09:11:20.436493
current #epochs=10, #steps=72
start validation
acc: 0.636364
AUC: 0.825758
Avg Precision: 0.342277
Avg Recall: 1.000000
d_prime: 1.325871
train_loss: 0.221740
valid_loss: 1.150530
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0008594831364395856
Epoch-10 lr: 0.0008594831364395856
epoch 10 training time: 7.051
---------------
2023-09-12 09:11:27.487788
current #epochs=11, #steps=80
start validation
acc: 0.590909
AUC: 0.817493
Avg Precision: 0.342277
Avg Recall: 1.000000
d_prime: 1.281069
train_loss: 0.214029
valid_loss: 1.151876
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0008594831364395856
Epoch-11 lr: 0.0008594831364395856
epoch 11 training time: 6.415
---------------
2023-09-12 09:11:33.902582
current #epochs=12, #steps=88
start validation
acc: 0.590909
AUC: 0.826446
Avg Precision: 0.347704
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.183169
valid_loss: 1.142973
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0006167823699010248
Epoch-12 lr: 0.0006167823699010248
epoch 12 training time: 6.894
---------------
2023-09-12 09:11:40.796902
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01124	Per Sample Data Time 0.00572	Per Sample DNN Time 0.00552	Train Loss 0.2093	
start validation
acc: 0.613636
AUC: 0.830579
Avg Precision: 0.362723
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.212262
valid_loss: 1.137883
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0006167823699010248
Epoch-13 lr: 0.0006167823699010248
epoch 13 training time: 6.879
---------------
2023-09-12 09:11:47.676194
current #epochs=14, #steps=104
start validation
acc: 0.659091
AUC: 0.834022
Avg Precision: 0.357096
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.149557
valid_loss: 1.141030
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0004426154227954011
Epoch-14 lr: 0.0004426154227954011
epoch 14 training time: 9.359
---------------
2023-09-12 09:11:57.035154
current #epochs=15, #steps=112
start validation
acc: 0.659091
AUC: 0.831956
Avg Precision: 0.358859
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.180308
valid_loss: 1.138391
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0004426154227954011
Epoch-15 lr: 0.0004426154227954011
epoch 15 training time: 6.945
---------------
2023-09-12 09:12:03.979821
current #epochs=16, #steps=120
start validation
acc: 0.636364
AUC: 0.833333
Avg Precision: 0.358056
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.172373
valid_loss: 1.131376
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0003176297216922545
Epoch-16 lr: 0.0003176297216922545
epoch 16 training time: 6.435
---------------
2023-09-12 09:12:10.414555
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.834022
Avg Precision: 0.358056
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.186254
valid_loss: 1.130276
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0003176297216922545
Epoch-17 lr: 0.0003176297216922545
epoch 17 training time: 6.236
---------------
2023-09-12 09:12:16.650990
current #epochs=18, #steps=136
start validation
acc: 0.636364
AUC: 0.833333
Avg Precision: 0.358056
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.169527
valid_loss: 1.131010
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00022793747101066292
Epoch-18 lr: 0.00022793747101066292
epoch 18 training time: 6.953
---------------
2023-09-12 09:12:23.604023
current #epochs=19, #steps=144
start validation
acc: 0.636364
AUC: 0.828512
Avg Precision: 0.358056
Avg Recall: 1.000000
d_prime: 1.341103
train_loss: 0.202366
valid_loss: 1.134688
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00022793747101066292
Epoch-19 lr: 0.00022793747101066292
epoch 19 training time: 6.385
---------------
2023-09-12 09:12:29.989014
current #epochs=20, #steps=152
start validation
acc: 0.636364
AUC: 0.828512
Avg Precision: 0.361013
Avg Recall: 1.000000
d_prime: 1.341103
train_loss: 0.165376
valid_loss: 1.135601
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00016357250956847011
Epoch-20 lr: 0.00016357250956847011
epoch 20 training time: 6.427
---------------
2023-09-12 09:12:36.415627
current #epochs=21, #steps=160
start validation
acc: 0.636364
AUC: 0.827135
Avg Precision: 0.357853
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.157330
valid_loss: 1.135324
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00016357250956847011
Epoch-21 lr: 0.00016357250956847011
epoch 21 training time: 7.238
---------------
2023-09-12 09:12:43.653594
current #epochs=22, #steps=168
start validation
[I 2023-09-12 09:12:50,065] Trial 45 finished with value: 0.6590909090909091 and parameters: {'warmup': 'False', 'num_epochs': 22, 'batch_size': 21, 'lr-adaptschedule': 'True', 'lr': 0.002325699427271327, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.7176200948584631}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.636364
AUC: 0.826446
Avg Precision: 0.365244
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.142251
valid_loss: 1.134539
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00011738291983276239
Epoch-22 lr: 0.00011738291983276239
epoch 22 training time: 6.407
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8dcebb0>
The learning rate scheduler starts at 4 epoch with decay rate of 0.755 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 09:12:50.101613
current #epochs=1, #steps=0
start validation
acc: 0.568182
AUC: 0.807851
Avg Precision: 0.380651
Avg Recall: 1.000000
d_prime: 1.230373
train_loss: 0.378379
valid_loss: 1.170667
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0029502765930428617
Epoch-1 lr: 0.0059005531860857234
epoch 1 training time: 9.344
---------------
2023-09-12 09:12:59.446545
current #epochs=2, #steps=8
start validation
acc: 0.545455
AUC: 0.824380
Avg Precision: 0.423140
Avg Recall: 1.000000
d_prime: 1.318312
train_loss: 0.367243
valid_loss: 1.164352
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0029502765930428617
Epoch-2 lr: 0.0059005531860857234
epoch 2 training time: 6.332
---------------
2023-09-12 09:13:05.777998
current #epochs=3, #steps=16
start validation
acc: 0.636364
AUC: 0.835399
Avg Precision: 0.393708
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.372668
valid_loss: 1.148099
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0029502765930428617
Epoch-3 lr: 0.0059005531860857234
epoch 3 training time: 9.151
---------------
2023-09-12 09:13:14.929433
current #epochs=4, #steps=24
start validation
acc: 0.681818
AUC: 0.842287
Avg Precision: 0.394654
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.327677
valid_loss: 1.146150
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0022279093581868835
Epoch-4 lr: 0.004455818716373767
epoch 4 training time: 9.269
---------------
2023-09-12 09:13:24.198000
current #epochs=5, #steps=32
start validation
acc: 0.545455
AUC: 0.847107
Avg Precision: 0.427925
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.319186
valid_loss: 1.133160
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0022279093581868835
Epoch-5 lr: 0.004455818716373767
epoch 5 training time: 6.342
---------------
2023-09-12 09:13:30.539955
current #epochs=6, #steps=40
start validation
acc: 0.636364
AUC: 0.836777
Avg Precision: 0.399471
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.304298
valid_loss: 1.139376
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0022279093581868835
Epoch-6 lr: 0.004455818716373767
epoch 6 training time: 6.607
---------------
2023-09-12 09:13:37.146544
current #epochs=7, #steps=48
start validation
acc: 0.613636
AUC: 0.834022
Avg Precision: 0.374881
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.266533
valid_loss: 1.143893
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0022279093581868835
Epoch-7 lr: 0.004455818716373767
epoch 7 training time: 7.651
---------------
2023-09-12 09:13:44.797315
current #epochs=8, #steps=56
start validation
acc: 0.636364
AUC: 0.838154
Avg Precision: 0.377418
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.276086
valid_loss: 1.130222
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0016824117847124783
Epoch-8 lr: 0.0033648235694249567
epoch 8 training time: 6.331
---------------
2023-09-12 09:13:51.128184
current #epochs=9, #steps=64
start validation
acc: 0.659091
AUC: 0.855372
Avg Precision: 0.425104
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.244487
valid_loss: 1.136838
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0016824117847124783
Epoch-9 lr: 0.0033648235694249567
epoch 9 training time: 6.424
---------------
2023-09-12 09:13:57.551859
current #epochs=10, #steps=72
start validation
acc: 0.681818
AUC: 0.845041
Avg Precision: 0.405416
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.248477
valid_loss: 1.136839
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0016824117847124783
Epoch-10 lr: 0.0033648235694249567
epoch 10 training time: 8.408
---------------
2023-09-12 09:14:05.959468
current #epochs=11, #steps=80
start validation
acc: 0.590909
AUC: 0.827135
Avg Precision: 0.400818
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.216281
valid_loss: 1.146658
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0016824117847124783
Epoch-11 lr: 0.0033648235694249567
epoch 11 training time: 8.072
---------------
2023-09-12 09:14:14.031891
current #epochs=12, #steps=88
start validation
acc: 0.568182
AUC: 0.823691
Avg Precision: 0.420873
Avg Recall: 1.000000
d_prime: 1.314547
train_loss: 0.312915
valid_loss: 1.148689
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001270477814969524
Epoch-12 lr: 0.002540955629939048
epoch 12 training time: 6.818
---------------
2023-09-12 09:14:20.849916
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01155	Per Sample Data Time 0.00605	Per Sample DNN Time 0.00551	Train Loss 0.2528	
start validation
acc: 0.613636
AUC: 0.833333
Avg Precision: 0.397313
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.233080
valid_loss: 1.135566
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.001270477814969524
Epoch-13 lr: 0.002540955629939048
epoch 13 training time: 8.094
---------------
2023-09-12 09:14:28.944256
current #epochs=14, #steps=104
start validation
acc: 0.613636
AUC: 0.839532
Avg Precision: 0.405596
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.198625
valid_loss: 1.136057
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.001270477814969524
Epoch-14 lr: 0.002540955629939048
epoch 14 training time: 6.456
---------------
2023-09-12 09:14:35.400610
current #epochs=15, #steps=112
start validation
acc: 0.613636
AUC: 0.835399
Avg Precision: 0.397957
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.172288
valid_loss: 1.135312
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.001270477814969524
Epoch-15 lr: 0.002540955629939048
epoch 15 training time: 6.563
---------------
2023-09-12 09:14:41.963994
current #epochs=16, #steps=120
start validation
acc: 0.568182
AUC: 0.830579
Avg Precision: 0.394683
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.217754
valid_loss: 1.140154
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0009594047622565755
Epoch-16 lr: 0.001918809524513151
epoch 16 training time: 6.602
---------------
2023-09-12 09:14:48.565588
current #epochs=17, #steps=128
start validation
acc: 0.590909
AUC: 0.835399
Avg Precision: 0.400430
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.242245
valid_loss: 1.137141
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0009594047622565755
Epoch-17 lr: 0.001918809524513151
epoch 17 training time: 7.707
---------------
2023-09-12 09:14:56.273213
current #epochs=18, #steps=136
start validation
acc: 0.636364
AUC: 0.834022
Avg Precision: 0.400430
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.310848
valid_loss: 1.137047
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0009594047622565755
Epoch-18 lr: 0.001918809524513151
epoch 18 training time: 6.986
---------------
2023-09-12 09:15:03.258684
current #epochs=19, #steps=144
start validation
acc: 0.613636
AUC: 0.831267
Avg Precision: 0.391031
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.209633
valid_loss: 1.144386
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0009594047622565755
Epoch-19 lr: 0.001918809524513151
epoch 19 training time: 6.395
---------------
2023-09-12 09:15:09.654079
current #epochs=20, #steps=152
start validation
acc: 0.590909
AUC: 0.840220
Avg Precision: 0.402713
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.195716
valid_loss: 1.139346
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0007244971041565775
Epoch-20 lr: 0.001448994208313155
epoch 20 training time: 6.835
---------------
2023-09-12 09:15:16.489286
current #epochs=21, #steps=160
start validation
acc: 0.590909
AUC: 0.837466
Avg Precision: 0.400991
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.215909
valid_loss: 1.136337
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0007244971041565775
Epoch-21 lr: 0.001448994208313155
epoch 21 training time: 6.406
---------------
2023-09-12 09:15:22.895097
current #epochs=22, #steps=168
start validation
acc: 0.613636
AUC: 0.835399
Avg Precision: 0.387514
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.212855
valid_loss: 1.136671
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0007244971041565775
Epoch-22 lr: 0.001448994208313155
epoch 22 training time: 6.592
---------------
2023-09-12 09:15:29.487157
current #epochs=23, #steps=176
start validation
acc: 0.613636
AUC: 0.840220
Avg Precision: 0.397090
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.248835
valid_loss: 1.139017
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0007244971041565775
Epoch-23 lr: 0.001448994208313155
epoch 23 training time: 7.135
---------------
2023-09-12 09:15:36.622240
current #epochs=24, #steps=184
start validation
acc: 0.590909
AUC: 0.840909
Avg Precision: 0.406216
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.170790
valid_loss: 1.140204
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0005471059500441511
Epoch-24 lr: 0.0010942119000883022
epoch 24 training time: 7.716
---------------
2023-09-12 09:15:44.338211
current #epochs=25, #steps=192
start validation
acc: 0.590909
AUC: 0.840909
Avg Precision: 0.398717
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.187229
valid_loss: 1.137530
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0005471059500441511
Epoch-25 lr: 0.0010942119000883022
epoch 25 training time: 7.707
---------------
2023-09-12 09:15:52.044578
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03875	Per Sample Data Time 0.03156	Per Sample DNN Time 0.00719	Train Loss 0.0932	
start validation
acc: 0.636364
AUC: 0.841598
Avg Precision: 0.390574
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.161516
valid_loss: 1.136126
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0005471059500441511
Epoch-26 lr: 0.0010942119000883022
epoch 26 training time: 7.241
---------------
2023-09-12 09:15:59.285089
current #epochs=27, #steps=208
start validation
acc: 0.590909
AUC: 0.841598
Avg Precision: 0.386763
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.156166
valid_loss: 1.136117
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0005471059500441511
Epoch-27 lr: 0.0010942119000883022
epoch 27 training time: 7.355
---------------
2023-09-12 09:16:06.640267
current #epochs=28, #steps=216
start validation
acc: 0.590909
AUC: 0.844353
Avg Precision: 0.396726
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.155661
valid_loss: 1.135695
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0004131485396648644
Epoch-28 lr: 0.0008262970793297288
epoch 28 training time: 6.496
---------------
2023-09-12 09:16:13.135972
current #epochs=29, #steps=224
start validation
acc: 0.613636
AUC: 0.845041
Avg Precision: 0.401964
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.145240
valid_loss: 1.133196
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0004131485396648644
Epoch-29 lr: 0.0008262970793297288
epoch 29 training time: 6.326
---------------
2023-09-12 09:16:19.462010
current #epochs=30, #steps=232
start validation
acc: 0.613636
AUC: 0.849862
Avg Precision: 0.401964
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.194515
valid_loss: 1.129677
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0004131485396648644
Epoch-30 lr: 0.0008262970793297288
epoch 30 training time: 6.263
---------------
2023-09-12 09:16:25.725400
current #epochs=31, #steps=240
start validation
acc: 0.613636
AUC: 0.847796
Avg Precision: 0.410166
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.236186
valid_loss: 1.132933
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0004131485396648644
Epoch-31 lr: 0.0008262970793297288
epoch 31 training time: 6.257
---------------
2023-09-12 09:16:31.982150
current #epochs=32, #steps=248
start validation
acc: 0.636364
AUC: 0.848485
Avg Precision: 0.404387
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.285263
valid_loss: 1.133711
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0003119902384783703
Epoch-32 lr: 0.0006239804769567406
epoch 32 training time: 6.390
---------------
2023-09-12 09:16:38.372305
current #epochs=33, #steps=256
start validation
acc: 0.636364
AUC: 0.847107
Avg Precision: 0.390574
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.254545
valid_loss: 1.131520
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0003119902384783703
Epoch-33 lr: 0.0006239804769567406
epoch 33 training time: 7.483
---------------
2023-09-12 09:16:45.854896
current #epochs=34, #steps=264
start validation
acc: 0.613636
AUC: 0.849862
Avg Precision: 0.383034
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.175957
valid_loss: 1.131038
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0003119902384783703
Epoch-34 lr: 0.0006239804769567406
epoch 34 training time: 6.406
---------------
2023-09-12 09:16:52.260983
current #epochs=35, #steps=272
start validation
acc: 0.613636
AUC: 0.849174
Avg Precision: 0.376031
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.223004
valid_loss: 1.130409
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0003119902384783703
Epoch-35 lr: 0.0006239804769567406
epoch 35 training time: 6.308
---------------
2023-09-12 09:16:58.568877
current #epochs=36, #steps=280
start validation
acc: 0.636364
AUC: 0.849862
Avg Precision: 0.383640
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.191610
valid_loss: 1.127319
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0002356002734143715
Epoch-36 lr: 0.000471200546828743
epoch 36 training time: 7.440
---------------
2023-09-12 09:17:06.009119
current #epochs=37, #steps=288
start validation
acc: 0.636364
AUC: 0.852617
Avg Precision: 0.389992
Avg Recall: 1.000000
d_prime: 1.481705
train_loss: 0.171304
valid_loss: 1.125253
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0002356002734143715
Epoch-37 lr: 0.000471200546828743
epoch 37 training time: 6.799
---------------
2023-09-12 09:17:12.808770
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01158	Per Sample Data Time 0.00586	Per Sample DNN Time 0.00572	Train Loss 0.1864	
start validation
acc: 0.613636
AUC: 0.852617
Avg Precision: 0.394222
Avg Recall: 1.000000
d_prime: 1.481705
train_loss: 0.177844
valid_loss: 1.123910
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0002356002734143715
Epoch-38 lr: 0.000471200546828743
epoch 38 training time: 6.329
---------------
2023-09-12 09:17:19.137838
current #epochs=39, #steps=304
start validation
acc: 0.613636
AUC: 0.856061
Avg Precision: 0.398901
Avg Recall: 1.000000
d_prime: 1.503007
train_loss: 0.209871
valid_loss: 1.118196
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0002356002734143715
Epoch-39 lr: 0.000471200546828743
epoch 39 training time: 6.316
---------------
2023-09-12 09:17:25.454356
current #epochs=40, #steps=312
start validation
acc: 0.590909
AUC: 0.856061
Avg Precision: 0.404347
Avg Recall: 1.000000
d_prime: 1.503007
train_loss: 0.216673
valid_loss: 1.116067
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.00017791418444258422
Epoch-40 lr: 0.00035582836888516843
epoch 40 training time: 6.268
---------------
2023-09-12 09:17:31.721757
current #epochs=41, #steps=320
start validation
acc: 0.590909
AUC: 0.856061
Avg Precision: 0.402713
Avg Recall: 1.000000
d_prime: 1.503007
train_loss: 0.209305
valid_loss: 1.116638
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.00017791418444258422
Epoch-41 lr: 0.00035582836888516843
epoch 41 training time: 6.560
---------------
2023-09-12 09:17:38.281844
current #epochs=42, #steps=328
start validation
[I 2023-09-12 09:17:44,707] Trial 46 finished with value: 0.6818181818181818 and parameters: {'warmup': 'False', 'num_epochs': 42, 'batch_size': 38, 'lr-adaptschedule': 'True', 'lr': 0.0029502765930428617, 'head-lr': 2, 'lr-scheduler-start': 4, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.7551527078649457}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.613636
AUC: 0.856749
Avg Precision: 0.402713
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.184395
valid_loss: 1.116609
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.00017791418444258422
Epoch-42 lr: 0.00035582836888516843
epoch 42 training time: 6.421
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8d717c0>
The learning rate scheduler starts at 5 epoch with decay rate of 0.684 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 09:17:44.743809
current #epochs=1, #steps=0
start validation
acc: 0.613636
AUC: 0.834711
Avg Precision: 0.402693
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.365501
valid_loss: 1.151095
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003233984617244279
Epoch-1 lr: 0.003233984617244279
epoch 1 training time: 9.220
---------------
2023-09-12 09:17:53.964002
current #epochs=2, #steps=8
start validation
acc: 0.568182
AUC: 0.823003
Avg Precision: 0.337883
Avg Recall: 1.000000
d_prime: 1.310791
train_loss: 0.393695
valid_loss: 1.148547
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003233984617244279
Epoch-2 lr: 0.003233984617244279
epoch 2 training time: 7.227
---------------
2023-09-12 09:18:01.191015
current #epochs=3, #steps=16
start validation
acc: 0.590909
AUC: 0.840220
Avg Precision: 0.371647
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.368260
valid_loss: 1.146079
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003233984617244279
Epoch-3 lr: 0.003233984617244279
epoch 3 training time: 7.697
---------------
2023-09-12 09:18:08.887566
current #epochs=4, #steps=24
start validation
acc: 0.568182
AUC: 0.851928
Avg Precision: 0.413245
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.365042
valid_loss: 1.140645
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003233984617244279
Epoch-4 lr: 0.003233984617244279
epoch 4 training time: 6.411
---------------
2023-09-12 09:18:15.298103
current #epochs=5, #steps=32
start validation
acc: 0.659091
AUC: 0.860193
Avg Precision: 0.378016
Avg Recall: 1.000000
d_prime: 1.529028
train_loss: 0.343836
valid_loss: 1.128279
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0022135570502580903
Epoch-5 lr: 0.0022135570502580903
epoch 5 training time: 9.454
---------------
2023-09-12 09:18:24.752333
current #epochs=6, #steps=40
start validation
acc: 0.659091
AUC: 0.851928
Avg Precision: 0.344273
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.324951
valid_loss: 1.129138
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0022135570502580903
Epoch-6 lr: 0.0022135570502580903
epoch 6 training time: 7.193
---------------
2023-09-12 09:18:31.945262
current #epochs=7, #steps=48
start validation
acc: 0.613636
AUC: 0.853306
Avg Precision: 0.352377
Avg Recall: 1.000000
d_prime: 1.485939
train_loss: 0.274876
valid_loss: 1.122384
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0022135570502580903
Epoch-7 lr: 0.0022135570502580903
epoch 7 training time: 7.190
---------------
2023-09-12 09:18:39.135137
current #epochs=8, #steps=56
start validation
acc: 0.636364
AUC: 0.853306
Avg Precision: 0.364138
Avg Recall: 1.000000
d_prime: 1.485939
train_loss: 0.262888
valid_loss: 1.111086
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0015151076441799873
Epoch-8 lr: 0.0015151076441799873
epoch 8 training time: 6.396
---------------
2023-09-12 09:18:45.531148
current #epochs=9, #steps=64
start validation
acc: 0.636364
AUC: 0.849174
Avg Precision: 0.368637
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.258823
valid_loss: 1.120853
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0015151076441799873
Epoch-9 lr: 0.0015151076441799873
epoch 9 training time: 6.222
---------------
2023-09-12 09:18:51.753193
current #epochs=10, #steps=72
start validation
acc: 0.659091
AUC: 0.839532
Avg Precision: 0.386027
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.275467
valid_loss: 1.134969
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0015151076441799873
Epoch-10 lr: 0.0015151076441799873
epoch 10 training time: 6.331
---------------
2023-09-12 09:18:58.084959
current #epochs=11, #steps=80
start validation
[I 2023-09-12 09:19:06,341] Trial 47 finished with value: 0.6590909090909091 and parameters: {'warmup': 'False', 'num_epochs': 11, 'batch_size': 11, 'lr-adaptschedule': 'True', 'lr': 0.003233984617244279, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.6844674023664007}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.613636
AUC: 0.836777
Avg Precision: 0.393221
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.258708
valid_loss: 1.139420
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0010370417935173528
Epoch-11 lr: 0.0010370417935173528
epoch 11 training time: 8.252
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8e14e20>
The learning rate scheduler starts at 5 epoch with decay rate of 0.666 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 09:19:06.378251
current #epochs=1, #steps=0
start validation
acc: 0.590909
AUC: 0.846419
Avg Precision: 0.376533
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.351019
valid_loss: 1.129911
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.001913516448278889
Epoch-1 lr: 0.003827032896557778
epoch 1 training time: 9.373
---------------
2023-09-12 09:19:15.751653
current #epochs=2, #steps=8
start validation
acc: 0.613636
AUC: 0.829890
Avg Precision: 0.351556
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.337717
valid_loss: 1.141380
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.001913516448278889
Epoch-2 lr: 0.003827032896557778
epoch 2 training time: 9.752
---------------
2023-09-12 09:19:25.503987
current #epochs=3, #steps=16
start validation
acc: 0.659091
AUC: 0.847107
Avg Precision: 0.365089
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.290706
valid_loss: 1.135612
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.001913516448278889
Epoch-3 lr: 0.003827032896557778
epoch 3 training time: 10.172
---------------
2023-09-12 09:19:35.675814
current #epochs=4, #steps=24
start validation
acc: 0.613636
AUC: 0.836777
Avg Precision: 0.371649
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.343355
valid_loss: 1.133268
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.001913516448278889
Epoch-4 lr: 0.003827032896557778
epoch 4 training time: 6.344
---------------
2023-09-12 09:19:42.019875
current #epochs=5, #steps=32
start validation
acc: 0.568182
AUC: 0.823003
Avg Precision: 0.363134
Avg Recall: 1.000000
d_prime: 1.310791
train_loss: 0.207914
valid_loss: 1.159119
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0012738796733095987
Epoch-5 lr: 0.0025477593466191975
epoch 5 training time: 6.406
---------------
2023-09-12 09:19:48.425875
current #epochs=6, #steps=40
start validation
acc: 0.590909
AUC: 0.823691
Avg Precision: 0.356199
Avg Recall: 1.000000
d_prime: 1.314547
train_loss: 0.209134
valid_loss: 1.152232
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0012738796733095987
Epoch-6 lr: 0.0025477593466191975
epoch 6 training time: 6.410
---------------
2023-09-12 09:19:54.836536
current #epochs=7, #steps=48
start validation
acc: 0.545455
AUC: 0.826446
Avg Precision: 0.358972
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.218667
valid_loss: 1.146610
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0012738796733095987
Epoch-7 lr: 0.0025477593466191975
epoch 7 training time: 7.506
---------------
2023-09-12 09:20:02.342220
current #epochs=8, #steps=56
start validation
acc: 0.590909
AUC: 0.825069
Avg Precision: 0.370753
Avg Recall: 1.000000
d_prime: 1.322087
train_loss: 0.256704
valid_loss: 1.147183
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0012738796733095987
Epoch-8 lr: 0.0025477593466191975
epoch 8 training time: 6.282
---------------
2023-09-12 09:20:08.624019
current #epochs=9, #steps=64
start validation
acc: 0.590909
AUC: 0.820937
Avg Precision: 0.351140
Avg Recall: 1.000000
d_prime: 1.299578
train_loss: 0.219428
valid_loss: 1.153389
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0008480561656686928
Epoch-9 lr: 0.0016961123313373855
epoch 9 training time: 6.354
---------------
2023-09-12 09:20:14.977664
current #epochs=10, #steps=72
start validation
acc: 0.590909
AUC: 0.831267
Avg Precision: 0.361146
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.198697
valid_loss: 1.136921
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0008480561656686928
Epoch-10 lr: 0.0016961123313373855
epoch 10 training time: 6.385
---------------
2023-09-12 09:20:21.362352
current #epochs=11, #steps=80
start validation
acc: 0.590909
AUC: 0.835399
Avg Precision: 0.383948
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.239744
valid_loss: 1.129754
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0008480561656686928
Epoch-11 lr: 0.0016961123313373855
epoch 11 training time: 6.284
---------------
2023-09-12 09:20:27.646831
current #epochs=12, #steps=88
start validation
acc: 0.613636
AUC: 0.842287
Avg Precision: 0.394271
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.211099
valid_loss: 1.128538
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0008480561656686928
Epoch-12 lr: 0.0016961123313373855
epoch 12 training time: 6.402
---------------
2023-09-12 09:20:34.048935
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01175	Per Sample Data Time 0.00598	Per Sample DNN Time 0.00577	Train Loss 0.1815	
start validation
acc: 0.613636
AUC: 0.845041
Avg Precision: 0.402995
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.174112
valid_loss: 1.129583
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0005645739351976409
Epoch-13 lr: 0.0011291478703952817
epoch 13 training time: 6.442
---------------
2023-09-12 09:20:40.490543
current #epochs=14, #steps=104
start validation
acc: 0.590909
AUC: 0.845730
Avg Precision: 0.380853
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.165363
valid_loss: 1.126898
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0005645739351976409
Epoch-14 lr: 0.0011291478703952817
epoch 14 training time: 8.385
---------------
2023-09-12 09:20:48.875465
current #epochs=15, #steps=112
start validation
acc: 0.613636
AUC: 0.846419
Avg Precision: 0.370168
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.181356
valid_loss: 1.121106
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0005645739351976409
Epoch-15 lr: 0.0011291478703952817
epoch 15 training time: 6.344
---------------
2023-09-12 09:20:55.219305
current #epochs=16, #steps=120
start validation
acc: 0.613636
AUC: 0.852617
Avg Precision: 0.378563
Avg Recall: 1.000000
d_prime: 1.481705
train_loss: 0.149393
valid_loss: 1.117302
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0005645739351976409
Epoch-16 lr: 0.0011291478703952817
epoch 16 training time: 6.373
---------------
2023-09-12 09:21:01.592321
current #epochs=17, #steps=128
start validation
acc: 0.613636
AUC: 0.852617
Avg Precision: 0.376488
Avg Recall: 1.000000
d_prime: 1.481705
train_loss: 0.192514
valid_loss: 1.116569
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0003758521442423809
Epoch-17 lr: 0.0007517042884847618
epoch 17 training time: 8.096
---------------
2023-09-12 09:21:09.689295
current #epochs=18, #steps=136
start validation
acc: 0.613636
AUC: 0.848485
Avg Precision: 0.376488
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.206669
valid_loss: 1.118059
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0003758521442423809
Epoch-18 lr: 0.0007517042884847618
epoch 18 training time: 6.420
---------------
2023-09-12 09:21:16.108097
current #epochs=19, #steps=144
start validation
acc: 0.613636
AUC: 0.847796
Avg Precision: 0.386197
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.246134
valid_loss: 1.121343
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0003758521442423809
Epoch-19 lr: 0.0007517042884847618
epoch 19 training time: 6.888
---------------
2023-09-12 09:21:22.996186
current #epochs=20, #steps=152
start validation
acc: 0.613636
AUC: 0.842975
Avg Precision: 0.376027
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.216938
valid_loss: 1.128410
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0003758521442423809
Epoch-20 lr: 0.0007517042884847618
epoch 20 training time: 6.400
---------------
2023-09-12 09:21:29.396140
current #epochs=21, #steps=160
start validation
acc: 0.636364
AUC: 0.838843
Avg Precision: 0.370753
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.191168
valid_loss: 1.129994
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00025021494178994075
Epoch-21 lr: 0.0005004298835798815
epoch 21 training time: 7.432
---------------
2023-09-12 09:21:36.828106
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.834711
Avg Precision: 0.357513
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.229256
valid_loss: 1.128643
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00025021494178994075
Epoch-22 lr: 0.0005004298835798815
epoch 22 training time: 8.759
---------------
2023-09-12 09:21:45.586726
current #epochs=23, #steps=176
start validation
acc: 0.613636
AUC: 0.836777
Avg Precision: 0.362745
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.168431
valid_loss: 1.123865
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00025021494178994075
Epoch-23 lr: 0.0005004298835798815
epoch 23 training time: 7.305
---------------
2023-09-12 09:21:52.891780
current #epochs=24, #steps=184
start validation
acc: 0.613636
AUC: 0.837466
Avg Precision: 0.369292
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.202793
valid_loss: 1.121342
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00025021494178994075
Epoch-24 lr: 0.0005004298835798815
epoch 24 training time: 7.699
---------------
2023-09-12 09:22:00.590547
current #epochs=25, #steps=192
start validation
acc: 0.613636
AUC: 0.836777
Avg Precision: 0.369292
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.177342
valid_loss: 1.122007
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00016657485677285075
Epoch-25 lr: 0.0003331497135457015
epoch 25 training time: 6.532
---------------
2023-09-12 09:22:07.122168
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03424	Per Sample Data Time 0.02872	Per Sample DNN Time 0.00552	Train Loss 0.0920	
start validation
acc: 0.613636
AUC: 0.836777
Avg Precision: 0.365062
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.132084
valid_loss: 1.123704
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00016657485677285075
Epoch-26 lr: 0.0003331497135457015
epoch 26 training time: 8.035
---------------
2023-09-12 09:22:15.157189
current #epochs=27, #steps=208
start validation
acc: 0.613636
AUC: 0.834711
Avg Precision: 0.358903
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.221832
valid_loss: 1.125387
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00016657485677285075
Epoch-27 lr: 0.0003331497135457015
epoch 27 training time: 7.641
---------------
2023-09-12 09:22:22.798216
current #epochs=28, #steps=216
start validation
acc: 0.590909
AUC: 0.836777
Avg Precision: 0.361675
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.166353
valid_loss: 1.127394
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00016657485677285075
Epoch-28 lr: 0.0003331497135457015
epoch 28 training time: 6.677
---------------
2023-09-12 09:22:29.475591
current #epochs=29, #steps=224
start validation
acc: 0.590909
AUC: 0.836088
Avg Precision: 0.361675
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.125858
valid_loss: 1.129339
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0001108933891413644
Epoch-29 lr: 0.0002217867782827288
epoch 29 training time: 6.617
---------------
2023-09-12 09:22:36.092498
current #epochs=30, #steps=232
start validation
acc: 0.590909
AUC: 0.835399
Avg Precision: 0.361675
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.243550
valid_loss: 1.130685
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0001108933891413644
Epoch-30 lr: 0.0002217867782827288
epoch 30 training time: 7.668
---------------
2023-09-12 09:22:43.760661
current #epochs=31, #steps=240
start validation
acc: 0.590909
AUC: 0.835399
Avg Precision: 0.372445
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.183924
valid_loss: 1.129766
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0001108933891413644
Epoch-31 lr: 0.0002217867782827288
epoch 31 training time: 6.315
---------------
2023-09-12 09:22:50.075373
current #epochs=32, #steps=248
start validation
acc: 0.590909
AUC: 0.838154
Avg Precision: 0.380384
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.210380
valid_loss: 1.128091
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0001108933891413644
Epoch-32 lr: 0.0002217867782827288
epoch 32 training time: 6.423
---------------
2023-09-12 09:22:56.498713
current #epochs=33, #steps=256
start validation
acc: 0.590909
AUC: 0.840220
Avg Precision: 0.375402
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.234567
valid_loss: 1.126939
validation finished
normal learning rate scheduler step
Epoch-33 lr: 7.382472957504811e-05
Epoch-33 lr: 0.00014764945915009622
epoch 33 training time: 6.257
---------------
2023-09-12 09:23:02.756218
current #epochs=34, #steps=264
start validation
[I 2023-09-12 09:23:09,060] Trial 48 finished with value: 0.6590909090909091 and parameters: {'warmup': 'False', 'num_epochs': 34, 'batch_size': 17, 'lr-adaptschedule': 'True', 'lr': 0.001913516448278889, 'head-lr': 2, 'lr-scheduler-start': 5, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.6657270568305744}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.590909
AUC: 0.837466
Avg Precision: 0.373446
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.155497
valid_loss: 1.126966
validation finished
normal learning rate scheduler step
Epoch-34 lr: 7.382472957504811e-05
Epoch-34 lr: 0.00014764945915009622
epoch 34 training time: 6.299
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f957bffa100>
The learning rate scheduler starts at 6 epoch with decay rate of 0.649 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 09:23:09.095861
current #epochs=1, #steps=0
start validation
acc: 0.613636
AUC: 0.858127
Avg Precision: 0.398156
Avg Recall: 1.000000
d_prime: 1.515953
train_loss: 0.214919
valid_loss: 1.111567
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0026203055810685785
Epoch-1 lr: 0.0026203055810685785
epoch 1 training time: 9.079
---------------
2023-09-12 09:23:18.175443
current #epochs=2, #steps=8
start validation
acc: 0.659091
AUC: 0.853306
Avg Precision: 0.398085
Avg Recall: 1.000000
d_prime: 1.485939
train_loss: 0.235292
valid_loss: 1.120528
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0026203055810685785
Epoch-2 lr: 0.0026203055810685785
epoch 2 training time: 8.991
---------------
2023-09-12 09:23:27.166629
current #epochs=3, #steps=16
start validation
acc: 0.590909
AUC: 0.855372
Avg Precision: 0.363219
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.264454
valid_loss: 1.115899
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0026203055810685785
Epoch-3 lr: 0.0026203055810685785
epoch 3 training time: 6.500
---------------
2023-09-12 09:23:33.667190
current #epochs=4, #steps=24
start validation
acc: 0.568182
AUC: 0.842287
Avg Precision: 0.371389
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.214136
valid_loss: 1.122601
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0026203055810685785
Epoch-4 lr: 0.0026203055810685785
epoch 4 training time: 6.808
---------------
2023-09-12 09:23:40.475232
current #epochs=5, #steps=32
start validation
acc: 0.613636
AUC: 0.831267
Avg Precision: 0.369098
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.216909
valid_loss: 1.135006
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0026203055810685785
Epoch-5 lr: 0.0026203055810685785
epoch 5 training time: 6.381
---------------
2023-09-12 09:23:46.856385
current #epochs=6, #steps=40
start validation
acc: 0.590909
AUC: 0.840220
Avg Precision: 0.388368
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.250029
valid_loss: 1.141653
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.001700060894846695
Epoch-6 lr: 0.001700060894846695
epoch 6 training time: 6.261
---------------
2023-09-12 09:23:53.117512
current #epochs=7, #steps=48
start validation
acc: 0.636364
AUC: 0.850551
Avg Precision: 0.393639
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.280981
valid_loss: 1.123224
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.001700060894846695
Epoch-7 lr: 0.001700060894846695
epoch 7 training time: 7.607
---------------
2023-09-12 09:24:00.725177
current #epochs=8, #steps=56
start validation
acc: 0.636364
AUC: 0.871212
Avg Precision: 0.371032
Avg Recall: 1.000000
d_prime: 1.601087
train_loss: 0.252262
valid_loss: 1.104199
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001700060894846695
Epoch-8 lr: 0.001700060894846695
epoch 8 training time: 6.552
---------------
2023-09-12 09:24:07.277458
current #epochs=9, #steps=64
start validation
acc: 0.704545
AUC: 0.870523
Avg Precision: 0.394180
Avg Recall: 1.000000
d_prime: 1.596462
train_loss: 0.170810
valid_loss: 1.092670
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001700060894846695
Epoch-9 lr: 0.001700060894846695
epoch 9 training time: 12.278
---------------
2023-09-12 09:24:19.555438
current #epochs=10, #steps=72
start validation
acc: 0.681818
AUC: 0.871212
Avg Precision: 0.381359
Avg Recall: 1.000000
d_prime: 1.601087
train_loss: 0.230115
valid_loss: 1.092899
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001700060894846695
Epoch-10 lr: 0.001700060894846695
epoch 10 training time: 8.442
---------------
2023-09-12 09:24:27.997739
current #epochs=11, #steps=80
start validation
acc: 0.659091
AUC: 0.868457
Avg Precision: 0.387128
Avg Recall: 1.000000
d_prime: 1.582686
train_loss: 0.273115
valid_loss: 1.100721
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0011030038126348223
Epoch-11 lr: 0.0011030038126348223
epoch 11 training time: 6.906
---------------
2023-09-12 09:24:34.904158
current #epochs=12, #steps=88
start validation
acc: 0.590909
AUC: 0.869835
Avg Precision: 0.413823
Avg Recall: 1.000000
d_prime: 1.591853
train_loss: 0.274903
valid_loss: 1.106676
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0011030038126348223
Epoch-12 lr: 0.0011030038126348223
epoch 12 training time: 7.393
---------------
2023-09-12 09:24:42.296909
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01152	Per Sample Data Time 0.00607	Per Sample DNN Time 0.00545	Train Loss 0.2259	
start validation
acc: 0.659091
AUC: 0.863636
Avg Precision: 0.383240
Avg Recall: 1.000000
d_prime: 1.551114
train_loss: 0.209840
valid_loss: 1.101850
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0011030038126348223
Epoch-13 lr: 0.0011030038126348223
epoch 13 training time: 8.068
---------------
2023-09-12 09:24:50.365356
current #epochs=14, #steps=104
start validation
acc: 0.659091
AUC: 0.855372
Avg Precision: 0.371911
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.192475
valid_loss: 1.105433
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0011030038126348223
Epoch-14 lr: 0.0011030038126348223
epoch 14 training time: 7.078
---------------
2023-09-12 09:24:57.443176
current #epochs=15, #steps=112
start validation
acc: 0.636364
AUC: 0.856749
Avg Precision: 0.391648
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.223861
valid_loss: 1.108696
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0011030038126348223
Epoch-15 lr: 0.0011030038126348223
epoch 15 training time: 7.445
---------------
2023-09-12 09:25:04.888822
current #epochs=16, #steps=120
start validation
acc: 0.613636
AUC: 0.834711
Avg Precision: 0.374548
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.174526
valid_loss: 1.131098
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0007156316661213856
Epoch-16 lr: 0.0007156316661213856
epoch 16 training time: 7.065
---------------
2023-09-12 09:25:11.953862
current #epochs=17, #steps=128
start validation
acc: 0.613636
AUC: 0.838154
Avg Precision: 0.392286
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.192470
valid_loss: 1.128539
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0007156316661213856
Epoch-17 lr: 0.0007156316661213856
epoch 17 training time: 7.475
---------------
2023-09-12 09:25:19.429302
current #epochs=18, #steps=136
start validation
acc: 0.613636
AUC: 0.836088
Avg Precision: 0.381095
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.240973
valid_loss: 1.125405
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0007156316661213856
Epoch-18 lr: 0.0007156316661213856
epoch 18 training time: 6.454
---------------
2023-09-12 09:25:25.883472
current #epochs=19, #steps=144
start validation
acc: 0.636364
AUC: 0.838154
Avg Precision: 0.374515
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.180584
valid_loss: 1.125579
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0007156316661213856
Epoch-19 lr: 0.0007156316661213856
epoch 19 training time: 6.358
---------------
2023-09-12 09:25:32.241739
current #epochs=20, #steps=152
start validation
acc: 0.659091
AUC: 0.841598
Avg Precision: 0.372838
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.165447
valid_loss: 1.117424
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0007156316661213856
Epoch-20 lr: 0.0007156316661213856
epoch 20 training time: 6.340
---------------
2023-09-12 09:25:38.581984
current #epochs=21, #steps=160
start validation
acc: 0.659091
AUC: 0.842975
Avg Precision: 0.375671
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.186517
valid_loss: 1.112969
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0004643036367501874
Epoch-21 lr: 0.0004643036367501874
epoch 21 training time: 7.475
---------------
2023-09-12 09:25:46.057361
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.845041
Avg Precision: 0.372838
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.150051
valid_loss: 1.111593
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0004643036367501874
Epoch-22 lr: 0.0004643036367501874
epoch 22 training time: 8.018
---------------
2023-09-12 09:25:54.075807
current #epochs=23, #steps=176
start validation
acc: 0.613636
AUC: 0.839532
Avg Precision: 0.382177
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.158896
valid_loss: 1.122917
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0004643036367501874
Epoch-23 lr: 0.0004643036367501874
epoch 23 training time: 6.453
---------------
2023-09-12 09:26:00.528630
current #epochs=24, #steps=184
start validation
acc: 0.613636
AUC: 0.840909
Avg Precision: 0.383854
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.211685
valid_loss: 1.123471
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0004643036367501874
Epoch-24 lr: 0.0004643036367501874
epoch 24 training time: 6.624
---------------
2023-09-12 09:26:07.152898
current #epochs=25, #steps=192
start validation
acc: 0.613636
AUC: 0.848485
Avg Precision: 0.396382
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.164085
valid_loss: 1.124040
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0004643036367501874
Epoch-25 lr: 0.0004643036367501874
epoch 25 training time: 7.456
---------------
2023-09-12 09:26:14.608932
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03560	Per Sample Data Time 0.03005	Per Sample DNN Time 0.00555	Train Loss 0.2179	
start validation
acc: 0.636364
AUC: 0.837466
Avg Precision: 0.397734
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.259149
valid_loss: 1.130671
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0003012413750048948
Epoch-26 lr: 0.0003012413750048948
epoch 26 training time: 6.740
---------------
2023-09-12 09:26:21.349110
current #epochs=27, #steps=208
start validation
acc: 0.636364
AUC: 0.842287
Avg Precision: 0.414464
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.245506
valid_loss: 1.132707
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0003012413750048948
Epoch-27 lr: 0.0003012413750048948
epoch 27 training time: 6.930
---------------
2023-09-12 09:26:28.279450
current #epochs=28, #steps=216
start validation
acc: 0.636364
AUC: 0.847796
Avg Precision: 0.413317
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.271482
valid_loss: 1.133097
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0003012413750048948
Epoch-28 lr: 0.0003012413750048948
epoch 28 training time: 7.624
---------------
2023-09-12 09:26:35.903598
current #epochs=29, #steps=224
start validation
acc: 0.636364
AUC: 0.845730
Avg Precision: 0.407051
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.240333
valid_loss: 1.133256
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0003012413750048948
Epoch-29 lr: 0.0003012413750048948
epoch 29 training time: 7.530
---------------
2023-09-12 09:26:43.433419
current #epochs=30, #steps=232
start validation
acc: 0.613636
AUC: 0.845041
Avg Precision: 0.399217
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.207790
valid_loss: 1.131073
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0003012413750048948
Epoch-30 lr: 0.0003012413750048948
epoch 30 training time: 6.446
---------------
2023-09-12 09:26:49.879217
current #epochs=31, #steps=240
start validation
acc: 0.636364
AUC: 0.849174
Avg Precision: 0.386507
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.153927
valid_loss: 1.122097
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.00019544616675846668
Epoch-31 lr: 0.00019544616675846668
epoch 31 training time: 7.729
---------------
2023-09-12 09:26:57.607863
current #epochs=32, #steps=248
start validation
acc: 0.659091
AUC: 0.851240
Avg Precision: 0.386507
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.178863
valid_loss: 1.120376
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00019544616675846668
Epoch-32 lr: 0.00019544616675846668
epoch 32 training time: 9.512
---------------
2023-09-12 09:27:07.120515
current #epochs=33, #steps=256
start validation
acc: 0.659091
AUC: 0.845730
Avg Precision: 0.376375
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.184547
valid_loss: 1.120856
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.00019544616675846668
Epoch-33 lr: 0.00019544616675846668
epoch 33 training time: 7.754
---------------
2023-09-12 09:27:14.874377
current #epochs=34, #steps=264
start validation
acc: 0.636364
AUC: 0.844353
Avg Precision: 0.378138
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.199320
valid_loss: 1.123305
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.00019544616675846668
Epoch-34 lr: 0.00019544616675846668
epoch 34 training time: 6.271
---------------
2023-09-12 09:27:21.144852
current #epochs=35, #steps=272
start validation
acc: 0.636364
AUC: 0.844353
Avg Precision: 0.378138
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.169859
valid_loss: 1.124342
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.00019544616675846668
Epoch-35 lr: 0.00019544616675846668
epoch 35 training time: 6.378
---------------
2023-09-12 09:27:27.522663
current #epochs=36, #steps=280
start validation
acc: 0.636364
AUC: 0.844353
Avg Precision: 0.378138
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.181505
valid_loss: 1.124588
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.00012680596780557674
Epoch-36 lr: 0.00012680596780557674
epoch 36 training time: 6.735
---------------
2023-09-12 09:27:34.257709
current #epochs=37, #steps=288
start validation
acc: 0.636364
AUC: 0.844353
Avg Precision: 0.373555
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.213411
valid_loss: 1.124302
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.00012680596780557674
Epoch-37 lr: 0.00012680596780557674
epoch 37 training time: 6.361
---------------
2023-09-12 09:27:40.618351
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01166	Per Sample Data Time 0.00585	Per Sample DNN Time 0.00581	Train Loss 0.1826	
start validation
acc: 0.636364
AUC: 0.843664
Avg Precision: 0.373555
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.235375
valid_loss: 1.124014
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.00012680596780557674
Epoch-38 lr: 0.00012680596780557674
epoch 38 training time: 6.322
---------------
2023-09-12 09:27:46.940292
current #epochs=39, #steps=304
start validation
acc: 0.636364
AUC: 0.841598
Avg Precision: 0.371792
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.145448
valid_loss: 1.124275
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.00012680596780557674
Epoch-39 lr: 0.00012680596780557674
epoch 39 training time: 6.778
---------------
2023-09-12 09:27:53.718555
current #epochs=40, #steps=312
start validation
acc: 0.636364
AUC: 0.840909
Avg Precision: 0.371792
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.171326
valid_loss: 1.123325
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.00012680596780557674
Epoch-40 lr: 0.00012680596780557674
epoch 40 training time: 7.918
---------------
2023-09-12 09:28:01.637054
current #epochs=41, #steps=320
start validation
acc: 0.636364
AUC: 0.841598
Avg Precision: 0.371792
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.167752
valid_loss: 1.123364
validation finished
normal learning rate scheduler step
Epoch-41 lr: 8.227203294798001e-05
Epoch-41 lr: 8.227203294798001e-05
epoch 41 training time: 7.877
---------------
2023-09-12 09:28:09.514055
current #epochs=42, #steps=328
start validation
acc: 0.636364
AUC: 0.841598
Avg Precision: 0.368631
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.150057
valid_loss: 1.123079
validation finished
normal learning rate scheduler step
Epoch-42 lr: 8.227203294798001e-05
Epoch-42 lr: 8.227203294798001e-05
epoch 42 training time: 8.788
---------------
2023-09-12 09:28:18.301509
current #epochs=43, #steps=336
start validation
acc: 0.636364
AUC: 0.841598
Avg Precision: 0.366954
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.192715
valid_loss: 1.122512
validation finished
normal learning rate scheduler step
Epoch-43 lr: 8.227203294798001e-05
Epoch-43 lr: 8.227203294798001e-05
epoch 43 training time: 6.734
---------------
2023-09-12 09:28:25.035656
current #epochs=44, #steps=344
start validation
acc: 0.636364
AUC: 0.840909
Avg Precision: 0.366954
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.166912
valid_loss: 1.122529
validation finished
normal learning rate scheduler step
Epoch-44 lr: 8.227203294798001e-05
Epoch-44 lr: 8.227203294798001e-05
epoch 44 training time: 6.468
---------------
2023-09-12 09:28:31.503966
current #epochs=45, #steps=352
start validation
acc: 0.636364
AUC: 0.840909
Avg Precision: 0.370592
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.222400
valid_loss: 1.122921
validation finished
normal learning rate scheduler step
Epoch-45 lr: 8.227203294798001e-05
Epoch-45 lr: 8.227203294798001e-05
epoch 45 training time: 8.111
---------------
2023-09-12 09:28:39.615242
current #epochs=46, #steps=360
start validation
[I 2023-09-12 09:28:45,972] Trial 49 finished with value: 0.7045454545454546 and parameters: {'warmup': 'False', 'num_epochs': 46, 'batch_size': 23, 'lr-adaptschedule': 'True', 'lr': 0.0026203055810685785, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.648802531708305}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.636364
AUC: 0.839532
Avg Precision: 0.367635
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.177870
valid_loss: 1.123014
validation finished
normal learning rate scheduler step
Epoch-46 lr: 5.337830326543852e-05
Epoch-46 lr: 5.337830326543852e-05
epoch 46 training time: 6.353
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8db6910>
The learning rate scheduler starts at 8 epoch with decay rate of 0.650 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 09:28:46.007965
current #epochs=1, #steps=0
start validation
acc: 0.636364
AUC: 0.858815
Avg Precision: 0.433102
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.298971
valid_loss: 1.123182
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0025731159712530233
Epoch-1 lr: 0.0025731159712530233
epoch 1 training time: 10.407
---------------
2023-09-12 09:28:56.415031
current #epochs=2, #steps=8
start validation
acc: 0.681818
AUC: 0.855372
Avg Precision: 0.422318
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.267688
valid_loss: 1.130851
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0025731159712530233
Epoch-2 lr: 0.0025731159712530233
epoch 2 training time: 10.634
---------------
2023-09-12 09:29:07.048928
current #epochs=3, #steps=16
start validation
acc: 0.659091
AUC: 0.864325
Avg Precision: 0.399769
Avg Recall: 1.000000
d_prime: 1.555577
train_loss: 0.272939
valid_loss: 1.111970
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0025731159712530233
Epoch-3 lr: 0.0025731159712530233
epoch 3 training time: 7.738
---------------
2023-09-12 09:29:14.786543
current #epochs=4, #steps=24
start validation
acc: 0.613636
AUC: 0.859504
Avg Precision: 0.455775
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.291570
valid_loss: 1.128127
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0025731159712530233
Epoch-4 lr: 0.0025731159712530233
epoch 4 training time: 8.379
---------------
2023-09-12 09:29:23.165436
current #epochs=5, #steps=32
start validation
acc: 0.545455
AUC: 0.815427
Avg Precision: 0.359035
Avg Recall: 1.000000
d_prime: 1.270069
train_loss: 0.338672
valid_loss: 1.151504
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0025731159712530233
Epoch-5 lr: 0.0025731159712530233
epoch 5 training time: 6.512
---------------
2023-09-12 09:29:29.677357
current #epochs=6, #steps=40
start validation
acc: 0.613636
AUC: 0.847107
Avg Precision: 0.388161
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.281678
valid_loss: 1.123892
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0025731159712530233
Epoch-6 lr: 0.0025731159712530233
epoch 6 training time: 9.286
---------------
2023-09-12 09:29:38.963245
current #epochs=7, #steps=48
start validation
acc: 0.613636
AUC: 0.856749
Avg Precision: 0.405370
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.298219
valid_loss: 1.127961
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0025731159712530233
Epoch-7 lr: 0.0025731159712530233
epoch 7 training time: 7.821
---------------
2023-09-12 09:29:46.784731
current #epochs=8, #steps=56
start validation
acc: 0.590909
AUC: 0.829890
Avg Precision: 0.358621
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.200685
valid_loss: 1.140082
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0016716375331222223
Epoch-8 lr: 0.0016716375331222223
epoch 8 training time: 6.528
---------------
2023-09-12 09:29:53.312862
current #epochs=9, #steps=64
start validation
acc: 0.636364
AUC: 0.825069
Avg Precision: 0.369906
Avg Recall: 1.000000
d_prime: 1.322087
train_loss: 0.210435
valid_loss: 1.136097
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0016716375331222223
Epoch-9 lr: 0.0016716375331222223
epoch 9 training time: 8.441
---------------
2023-09-12 09:30:01.754240
current #epochs=10, #steps=72
start validation
acc: 0.636364
AUC: 0.835399
Avg Precision: 0.358519
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.156719
valid_loss: 1.123787
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0016716375331222223
Epoch-10 lr: 0.0016716375331222223
epoch 10 training time: 7.066
---------------
2023-09-12 09:30:08.821134
current #epochs=11, #steps=80
start validation
acc: 0.636364
AUC: 0.829201
Avg Precision: 0.344723
Avg Recall: 1.000000
d_prime: 1.344935
train_loss: 0.179801
valid_loss: 1.129236
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0016716375331222223
Epoch-11 lr: 0.0016716375331222223
epoch 11 training time: 8.361
---------------
2023-09-12 09:30:17.180784
current #epochs=12, #steps=88
start validation
acc: 0.590909
AUC: 0.829890
Avg Precision: 0.361607
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.183612
valid_loss: 1.131454
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0016716375331222223
Epoch-12 lr: 0.0016716375331222223
epoch 12 training time: 6.717
---------------
2023-09-12 09:30:23.897528
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01164	Per Sample Data Time 0.00591	Per Sample DNN Time 0.00573	Train Loss 0.2924	
start validation
acc: 0.613636
AUC: 0.823691
Avg Precision: 0.365861
Avg Recall: 1.000000
d_prime: 1.314547
train_loss: 0.244939
valid_loss: 1.134015
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0010859876015546167
Epoch-13 lr: 0.0010859876015546167
epoch 13 training time: 6.281
---------------
2023-09-12 09:30:30.178880
current #epochs=14, #steps=104
start validation
acc: 0.590909
AUC: 0.833333
Avg Precision: 0.377485
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.245748
valid_loss: 1.145503
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0010859876015546167
Epoch-14 lr: 0.0010859876015546167
epoch 14 training time: 6.292
---------------
2023-09-12 09:30:36.470840
current #epochs=15, #steps=112
start validation
acc: 0.568182
AUC: 0.841598
Avg Precision: 0.395690
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.204514
valid_loss: 1.132437
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0010859876015546167
Epoch-15 lr: 0.0010859876015546167
epoch 15 training time: 6.912
---------------
2023-09-12 09:30:43.382536
current #epochs=16, #steps=120
start validation
acc: 0.590909
AUC: 0.832645
Avg Precision: 0.384469
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.252894
valid_loss: 1.135444
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0010859876015546167
Epoch-16 lr: 0.0010859876015546167
epoch 16 training time: 7.885
---------------
2023-09-12 09:30:51.268313
current #epochs=17, #steps=128
start validation
acc: 0.568182
AUC: 0.829890
Avg Precision: 0.374033
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.220505
valid_loss: 1.148559
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0010859876015546167
Epoch-17 lr: 0.0010859876015546167
epoch 17 training time: 7.743
---------------
2023-09-12 09:30:59.011696
current #epochs=18, #steps=136
start validation
acc: 0.522727
AUC: 0.814738
Avg Precision: 0.371199
Avg Recall: 1.000000
d_prime: 1.266419
train_loss: 0.249218
valid_loss: 1.168728
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0007055172232987419
Epoch-18 lr: 0.0007055172232987419
epoch 18 training time: 6.226
---------------
2023-09-12 09:31:05.237052
current #epochs=19, #steps=144
start validation
acc: 0.659091
AUC: 0.823691
Avg Precision: 0.374550
Avg Recall: 1.000000
d_prime: 1.314547
train_loss: 0.153073
valid_loss: 1.155908
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0007055172232987419
Epoch-19 lr: 0.0007055172232987419
epoch 19 training time: 7.765
---------------
2023-09-12 09:31:13.002265
current #epochs=20, #steps=152
start validation
acc: 0.659091
AUC: 0.820248
Avg Precision: 0.371579
Avg Recall: 1.000000
d_prime: 1.295859
train_loss: 0.180674
valid_loss: 1.155583
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0007055172232987419
Epoch-20 lr: 0.0007055172232987419
epoch 20 training time: 8.000
---------------
2023-09-12 09:31:21.001976
current #epochs=21, #steps=160
start validation
acc: 0.613636
AUC: 0.820937
Avg Precision: 0.368518
Avg Recall: 1.000000
d_prime: 1.299578
train_loss: 0.176348
valid_loss: 1.158779
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0007055172232987419
Epoch-21 lr: 0.0007055172232987419
epoch 21 training time: 7.548
---------------
2023-09-12 09:31:28.550658
current #epochs=22, #steps=168
start validation
acc: 0.545455
AUC: 0.820937
Avg Precision: 0.361970
Avg Recall: 1.000000
d_prime: 1.299578
train_loss: 0.152991
valid_loss: 1.164862
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0007055172232987419
Epoch-22 lr: 0.0007055172232987419
epoch 22 training time: 6.448
---------------
2023-09-12 09:31:34.998649
current #epochs=23, #steps=176
start validation
acc: 0.545455
AUC: 0.820937
Avg Precision: 0.361970
Avg Recall: 1.000000
d_prime: 1.299578
train_loss: 0.264677
valid_loss: 1.162293
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00045834275792708826
Epoch-23 lr: 0.00045834275792708826
epoch 23 training time: 6.439
---------------
2023-09-12 09:31:41.437294
current #epochs=24, #steps=184
start validation
acc: 0.681818
AUC: 0.827824
Avg Precision: 0.373101
Avg Recall: 1.000000
d_prime: 1.337280
train_loss: 0.180289
valid_loss: 1.150183
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00045834275792708826
Epoch-24 lr: 0.00045834275792708826
epoch 24 training time: 6.478
---------------
2023-09-12 09:31:47.914834
current #epochs=25, #steps=192
start validation
acc: 0.659091
AUC: 0.824380
Avg Precision: 0.376488
Avg Recall: 1.000000
d_prime: 1.318312
train_loss: 0.185056
valid_loss: 1.145691
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00045834275792708826
Epoch-25 lr: 0.00045834275792708826
epoch 25 training time: 6.512
---------------
2023-09-12 09:31:54.427033
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03784	Per Sample Data Time 0.03185	Per Sample DNN Time 0.00599	Train Loss 0.0349	
start validation
acc: 0.681818
AUC: 0.825069
Avg Precision: 0.374965
Avg Recall: 1.000000
d_prime: 1.322087
train_loss: 0.154270
valid_loss: 1.142332
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00045834275792708826
Epoch-26 lr: 0.00045834275792708826
epoch 26 training time: 8.084
---------------
2023-09-12 09:32:02.511498
current #epochs=27, #steps=208
start validation
acc: 0.636364
AUC: 0.828512
Avg Precision: 0.376739
Avg Recall: 1.000000
d_prime: 1.341103
train_loss: 0.203430
valid_loss: 1.141370
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00045834275792708826
Epoch-27 lr: 0.00045834275792708826
epoch 27 training time: 6.682
---------------
2023-09-12 09:32:09.194148
current #epochs=28, #steps=216
start validation
acc: 0.659091
AUC: 0.826446
Avg Precision: 0.368518
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.185187
valid_loss: 1.139640
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0002977646424589902
Epoch-28 lr: 0.0002977646424589902
epoch 28 training time: 8.470
---------------
2023-09-12 09:32:17.663864
current #epochs=29, #steps=224
start validation
acc: 0.659091
AUC: 0.827824
Avg Precision: 0.368518
Avg Recall: 1.000000
d_prime: 1.337280
train_loss: 0.180755
valid_loss: 1.139738
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0002977646424589902
Epoch-29 lr: 0.0002977646424589902
epoch 29 training time: 9.526
---------------
2023-09-12 09:32:27.190453
current #epochs=30, #steps=232
start validation
acc: 0.659091
AUC: 0.825758
Avg Precision: 0.373101
Avg Recall: 1.000000
d_prime: 1.325871
train_loss: 0.157656
valid_loss: 1.138795
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0002977646424589902
Epoch-30 lr: 0.0002977646424589902
epoch 30 training time: 7.242
---------------
2023-09-12 09:32:34.431749
current #epochs=31, #steps=240
start validation
acc: 0.659091
AUC: 0.824380
Avg Precision: 0.369940
Avg Recall: 1.000000
d_prime: 1.318312
train_loss: 0.182698
valid_loss: 1.138640
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0002977646424589902
Epoch-31 lr: 0.0002977646424589902
epoch 31 training time: 6.451
---------------
2023-09-12 09:32:40.882422
current #epochs=32, #steps=248
start validation
acc: 0.659091
AUC: 0.830579
Avg Precision: 0.374698
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.173159
valid_loss: 1.137218
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0002977646424589902
Epoch-32 lr: 0.0002977646424589902
epoch 32 training time: 8.031
---------------
2023-09-12 09:32:48.913073
current #epochs=33, #steps=256
start validation
acc: 0.659091
AUC: 0.831267
Avg Precision: 0.374698
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.156989
valid_loss: 1.137333
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.00019344427454188033
Epoch-33 lr: 0.00019344427454188033
epoch 33 training time: 7.210
---------------
2023-09-12 09:32:56.123299
current #epochs=34, #steps=264
start validation
acc: 0.659091
AUC: 0.829890
Avg Precision: 0.371792
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.209852
valid_loss: 1.138025
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.00019344427454188033
Epoch-34 lr: 0.00019344427454188033
epoch 34 training time: 12.129
---------------
2023-09-12 09:33:08.252111
current #epochs=35, #steps=272
start validation
acc: 0.659091
AUC: 0.831267
Avg Precision: 0.371792
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.172558
valid_loss: 1.137830
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.00019344427454188033
Epoch-35 lr: 0.00019344427454188033
epoch 35 training time: 6.429
---------------
2023-09-12 09:33:14.681293
current #epochs=36, #steps=280
start validation
acc: 0.636364
AUC: 0.829890
Avg Precision: 0.373502
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.151766
valid_loss: 1.137878
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.00019344427454188033
Epoch-36 lr: 0.00019344427454188033
epoch 36 training time: 7.844
---------------
2023-09-12 09:33:22.525058
current #epochs=37, #steps=288
start validation
acc: 0.636364
AUC: 0.830579
Avg Precision: 0.378816
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.138388
valid_loss: 1.138577
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.00019344427454188033
Epoch-37 lr: 0.00019344427454188033
epoch 37 training time: 7.465
---------------
2023-09-12 09:33:29.990167
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01151	Per Sample Data Time 0.00606	Per Sample DNN Time 0.00545	Train Loss 0.1901	
start validation
acc: 0.636364
AUC: 0.829890
Avg Precision: 0.378816
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.173879
valid_loss: 1.138768
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.00012567203091679415
Epoch-38 lr: 0.00012567203091679415
epoch 38 training time: 7.793
---------------
2023-09-12 09:33:37.783226
current #epochs=39, #steps=304
start validation
acc: 0.659091
AUC: 0.831267
Avg Precision: 0.380579
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.198264
valid_loss: 1.138561
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.00012567203091679415
Epoch-39 lr: 0.00012567203091679415
epoch 39 training time: 6.482
---------------
2023-09-12 09:33:44.265503
current #epochs=40, #steps=312
start validation
acc: 0.613636
AUC: 0.830579
Avg Precision: 0.378204
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.129335
valid_loss: 1.139694
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.00012567203091679415
Epoch-40 lr: 0.00012567203091679415
epoch 40 training time: 6.356
---------------
2023-09-12 09:33:50.621509
current #epochs=41, #steps=320
start validation
acc: 0.613636
AUC: 0.830579
Avg Precision: 0.381841
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.158042
valid_loss: 1.140144
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.00012567203091679415
Epoch-41 lr: 0.00012567203091679415
epoch 41 training time: 6.304
---------------
2023-09-12 09:33:56.925468
current #epochs=42, #steps=328
start validation
acc: 0.613636
AUC: 0.830579
Avg Precision: 0.381841
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.192161
valid_loss: 1.140972
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.00012567203091679415
Epoch-42 lr: 0.00012567203091679415
epoch 42 training time: 11.242
---------------
2023-09-12 09:34:08.167886
current #epochs=43, #steps=336
start validation
acc: 0.613636
AUC: 0.830579
Avg Precision: 0.381841
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.154264
valid_loss: 1.141344
validation finished
normal learning rate scheduler step
Epoch-43 lr: 8.164345722898307e-05
Epoch-43 lr: 8.164345722898307e-05
epoch 43 training time: 8.520
---------------
2023-09-12 09:34:16.687319
current #epochs=44, #steps=344
start validation
[I 2023-09-12 09:34:23,036] Trial 50 finished with value: 0.6818181818181818 and parameters: {'warmup': 'False', 'num_epochs': 44, 'batch_size': 23, 'lr-adaptschedule': 'True', 'lr': 0.0025731159712530233, 'head-lr': 1, 'lr-scheduler-start': 8, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.6496549521272411}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.613636
AUC: 0.831267
Avg Precision: 0.381841
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.135937
valid_loss: 1.140568
validation finished
normal learning rate scheduler step
Epoch-44 lr: 8.164345722898307e-05
Epoch-44 lr: 8.164345722898307e-05
epoch 44 training time: 6.344
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8d711c0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.648 every 6 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 09:34:23.072593
current #epochs=1, #steps=0
start validation
acc: 0.545455
AUC: 0.835399
Avg Precision: 0.370454
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.256108
valid_loss: 1.138908
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003129263925732025
Epoch-1 lr: 0.003129263925732025
epoch 1 training time: 8.985
---------------
2023-09-12 09:34:32.057946
current #epochs=2, #steps=8
start validation
acc: 0.659091
AUC: 0.829890
Avg Precision: 0.324280
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.292171
valid_loss: 1.136698
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003129263925732025
Epoch-2 lr: 0.003129263925732025
epoch 2 training time: 8.945
---------------
2023-09-12 09:34:41.002796
current #epochs=3, #steps=16
start validation
acc: 0.613636
AUC: 0.860193
Avg Precision: 0.439286
Avg Recall: 1.000000
d_prime: 1.529028
train_loss: 0.267355
valid_loss: 1.123490
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003129263925732025
Epoch-3 lr: 0.003129263925732025
epoch 3 training time: 6.358
---------------
2023-09-12 09:34:47.361108
current #epochs=4, #steps=24
start validation
acc: 0.545455
AUC: 0.840220
Avg Precision: 0.451560
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.302497
valid_loss: 1.137115
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003129263925732025
Epoch-4 lr: 0.003129263925732025
epoch 4 training time: 6.387
---------------
2023-09-12 09:34:53.748210
current #epochs=5, #steps=32
start validation
acc: 0.545455
AUC: 0.848485
Avg Precision: 0.431584
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.232695
valid_loss: 1.136099
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.003129263925732025
Epoch-5 lr: 0.003129263925732025
epoch 5 training time: 6.443
---------------
2023-09-12 09:35:00.191099
current #epochs=6, #steps=40
start validation
acc: 0.545455
AUC: 0.863636
Avg Precision: 0.446652
Avg Recall: 1.000000
d_prime: 1.551114
train_loss: 0.338978
valid_loss: 1.128054
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002026582759275689
Epoch-6 lr: 0.002026582759275689
epoch 6 training time: 6.462
---------------
2023-09-12 09:35:06.653325
current #epochs=7, #steps=48
start validation
[I 2023-09-12 09:35:13,025] Trial 51 finished with value: 0.6590909090909091 and parameters: {'warmup': 'False', 'num_epochs': 7, 'batch_size': 28, 'lr-adaptschedule': 'True', 'lr': 0.003129263925732025, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 6, 'lr-scheduler-decay': 0.6476228299604396}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.613636
AUC: 0.860882
Avg Precision: 0.389019
Avg Recall: 1.000000
d_prime: 1.533415
train_loss: 0.338121
valid_loss: 1.121703
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002026582759275689
Epoch-7 lr: 0.002026582759275689
epoch 7 training time: 6.367
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8d78700>
The learning rate scheduler starts at 6 epoch with decay rate of 0.687 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 09:35:13.064013
current #epochs=1, #steps=0
start validation
acc: 0.613636
AUC: 0.846419
Avg Precision: 0.448994
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.385347
valid_loss: 1.157341
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0026992235834261886
Epoch-1 lr: 0.0026992235834261886
epoch 1 training time: 9.239
---------------
2023-09-12 09:35:22.302915
current #epochs=2, #steps=8
start validation
acc: 0.590909
AUC: 0.863636
Avg Precision: 0.400587
Avg Recall: 1.000000
d_prime: 1.551114
train_loss: 0.250668
valid_loss: 1.125096
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0026992235834261886
Epoch-2 lr: 0.0026992235834261886
epoch 2 training time: 6.396
---------------
2023-09-12 09:35:28.699396
current #epochs=3, #steps=16
start validation
acc: 0.590909
AUC: 0.837466
Avg Precision: 0.378704
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.291881
valid_loss: 1.147255
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0026992235834261886
Epoch-3 lr: 0.0026992235834261886
epoch 3 training time: 6.394
---------------
2023-09-12 09:35:35.092860
current #epochs=4, #steps=24
start validation
acc: 0.568182
AUC: 0.839532
Avg Precision: 0.361778
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.283808
valid_loss: 1.150024
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0026992235834261886
Epoch-4 lr: 0.0026992235834261886
epoch 4 training time: 6.381
---------------
2023-09-12 09:35:41.473579
current #epochs=5, #steps=32
start validation
acc: 0.636364
AUC: 0.833333
Avg Precision: 0.356367
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.268146
valid_loss: 1.146195
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0026992235834261886
Epoch-5 lr: 0.0026992235834261886
epoch 5 training time: 9.130
---------------
2023-09-12 09:35:50.604005
current #epochs=6, #steps=40
start validation
acc: 0.568182
AUC: 0.827824
Avg Precision: 0.407917
Avg Recall: 1.000000
d_prime: 1.337280
train_loss: 0.264328
valid_loss: 1.159160
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.001855639490563825
Epoch-6 lr: 0.001855639490563825
epoch 6 training time: 9.331
---------------
2023-09-12 09:35:59.934339
current #epochs=7, #steps=48
start validation
acc: 0.590909
AUC: 0.826446
Avg Precision: 0.417487
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.294036
valid_loss: 1.151763
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.001855639490563825
Epoch-7 lr: 0.001855639490563825
epoch 7 training time: 7.827
---------------
2023-09-12 09:36:07.761089
current #epochs=8, #steps=56
start validation
acc: 0.568182
AUC: 0.818182
Avg Precision: 0.346057
Avg Recall: 1.000000
d_prime: 1.284753
train_loss: 0.250732
valid_loss: 1.163015
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001855639490563825
Epoch-8 lr: 0.001855639490563825
epoch 8 training time: 6.782
---------------
2023-09-12 09:36:14.543549
current #epochs=9, #steps=64
start validation
acc: 0.590909
AUC: 0.831267
Avg Precision: 0.344885
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.252544
valid_loss: 1.135738
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001855639490563825
Epoch-9 lr: 0.001855639490563825
epoch 9 training time: 6.277
---------------
2023-09-12 09:36:20.820827
current #epochs=10, #steps=72
start validation
acc: 0.590909
AUC: 0.833333
Avg Precision: 0.412356
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.207341
valid_loss: 1.136879
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001855639490563825
Epoch-10 lr: 0.001855639490563825
epoch 10 training time: 6.236
---------------
2023-09-12 09:36:27.057529
current #epochs=11, #steps=80
start validation
acc: 0.613636
AUC: 0.850551
Avg Precision: 0.477599
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.199462
valid_loss: 1.114069
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0012756994048522597
Epoch-11 lr: 0.0012756994048522597
epoch 11 training time: 6.389
---------------
2023-09-12 09:36:33.446826
current #epochs=12, #steps=88
start validation
acc: 0.590909
AUC: 0.849174
Avg Precision: 0.409405
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.309211
valid_loss: 1.115327
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0012756994048522597
Epoch-12 lr: 0.0012756994048522597
epoch 12 training time: 6.312
---------------
2023-09-12 09:36:39.758841
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01132	Per Sample Data Time 0.00587	Per Sample DNN Time 0.00544	Train Loss 0.1676	
start validation
acc: 0.590909
AUC: 0.834022
Avg Precision: 0.353472
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.180091
valid_loss: 1.130814
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0012756994048522597
Epoch-13 lr: 0.0012756994048522597
epoch 13 training time: 6.540
---------------
2023-09-12 09:36:46.299166
current #epochs=14, #steps=104
start validation
acc: 0.590909
AUC: 0.825758
Avg Precision: 0.349591
Avg Recall: 1.000000
d_prime: 1.325871
train_loss: 0.240250
valid_loss: 1.148671
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0012756994048522597
Epoch-14 lr: 0.0012756994048522597
epoch 14 training time: 6.217
---------------
2023-09-12 09:36:52.516404
current #epochs=15, #steps=112
start validation
acc: 0.636364
AUC: 0.838154
Avg Precision: 0.385541
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.220561
valid_loss: 1.136684
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0012756994048522597
Epoch-15 lr: 0.0012756994048522597
epoch 15 training time: 6.318
---------------
2023-09-12 09:36:58.833993
current #epochs=16, #steps=120
start validation
acc: 0.613636
AUC: 0.851928
Avg Precision: 0.421675
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.162217
valid_loss: 1.126921
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0008770070802092766
Epoch-16 lr: 0.0008770070802092766
epoch 16 training time: 6.344
---------------
2023-09-12 09:37:05.177839
current #epochs=17, #steps=128
start validation
acc: 0.590909
AUC: 0.842287
Avg Precision: 0.445281
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.170668
valid_loss: 1.134816
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0008770070802092766
Epoch-17 lr: 0.0008770070802092766
epoch 17 training time: 8.310
---------------
2023-09-12 09:37:13.487614
current #epochs=18, #steps=136
start validation
[I 2023-09-12 09:37:19,820] Trial 52 finished with value: 0.6363636363636364 and parameters: {'warmup': 'False', 'num_epochs': 18, 'batch_size': 17, 'lr-adaptschedule': 'True', 'lr': 0.0026992235834261886, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.6874715758849506}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.545455
AUC: 0.840220
Avg Precision: 0.437018
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.229067
valid_loss: 1.136539
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0008770070802092766
Epoch-18 lr: 0.0008770070802092766
epoch 18 training time: 6.327
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f956e068c40>
The learning rate scheduler starts at 5 epoch with decay rate of 0.631 every 6 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 09:37:19.860115
current #epochs=1, #steps=0
start validation
acc: 0.636364
AUC: 0.856749
Avg Precision: 0.384868
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.340140
valid_loss: 1.117602
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003465912171890557
Epoch-1 lr: 0.003465912171890557
epoch 1 training time: 8.921
---------------
2023-09-12 09:37:28.781402
current #epochs=2, #steps=8
start validation
acc: 0.659091
AUC: 0.856061
Avg Precision: 0.354923
Avg Recall: 1.000000
d_prime: 1.503007
train_loss: 0.320780
valid_loss: 1.122237
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003465912171890557
Epoch-2 lr: 0.003465912171890557
epoch 2 training time: 10.526
---------------
2023-09-12 09:37:39.307936
current #epochs=3, #steps=16
start validation
acc: 0.636364
AUC: 0.835399
Avg Precision: 0.369907
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.241156
valid_loss: 1.137307
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003465912171890557
Epoch-3 lr: 0.003465912171890557
epoch 3 training time: 6.331
---------------
2023-09-12 09:37:45.638944
current #epochs=4, #steps=24
start validation
acc: 0.659091
AUC: 0.829890
Avg Precision: 0.379092
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.299177
valid_loss: 1.132580
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003465912171890557
Epoch-4 lr: 0.003465912171890557
epoch 4 training time: 7.607
---------------
2023-09-12 09:37:53.245628
current #epochs=5, #steps=32
start validation
acc: 0.613636
AUC: 0.852617
Avg Precision: 0.406968
Avg Recall: 1.000000
d_prime: 1.481705
train_loss: 0.250449
valid_loss: 1.125082
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0021864821211059157
Epoch-5 lr: 0.0021864821211059157
epoch 5 training time: 6.990
---------------
2023-09-12 09:38:00.235566
current #epochs=6, #steps=40
start validation
acc: 0.659091
AUC: 0.860193
Avg Precision: 0.462219
Avg Recall: 1.000000
d_prime: 1.529028
train_loss: 0.225203
valid_loss: 1.116033
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0021864821211059157
Epoch-6 lr: 0.0021864821211059157
epoch 6 training time: 7.528
---------------
2023-09-12 09:38:07.763161
current #epochs=7, #steps=48
start validation
acc: 0.659091
AUC: 0.845041
Avg Precision: 0.406847
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.265963
valid_loss: 1.135805
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0021864821211059157
Epoch-7 lr: 0.0021864821211059157
epoch 7 training time: 7.511
---------------
2023-09-12 09:38:15.274463
current #epochs=8, #steps=56
start validation
acc: 0.681818
AUC: 0.827135
Avg Precision: 0.356475
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.206618
valid_loss: 1.152711
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0021864821211059157
Epoch-8 lr: 0.0021864821211059157
epoch 8 training time: 9.008
---------------
2023-09-12 09:38:24.282048
current #epochs=9, #steps=64
start validation
acc: 0.613636
AUC: 0.831267
Avg Precision: 0.337058
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.260125
valid_loss: 1.152165
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0021864821211059157
Epoch-9 lr: 0.0021864821211059157
epoch 9 training time: 6.506
---------------
2023-09-12 09:38:30.788571
current #epochs=10, #steps=72
start validation
acc: 0.613636
AUC: 0.850551
Avg Precision: 0.372083
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.238448
valid_loss: 1.130232
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0021864821211059157
Epoch-10 lr: 0.0021864821211059157
epoch 10 training time: 6.305
---------------
2023-09-12 09:38:37.093841
current #epochs=11, #steps=80
start validation
acc: 0.613636
AUC: 0.853994
Avg Precision: 0.378201
Avg Recall: 1.000000
d_prime: 1.490185
train_loss: 0.213762
valid_loss: 1.122944
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0013793494551560103
Epoch-11 lr: 0.0013793494551560103
epoch 11 training time: 6.399
---------------
2023-09-12 09:38:43.492419
current #epochs=12, #steps=88
start validation
acc: 0.613636
AUC: 0.852617
Avg Precision: 0.386626
Avg Recall: 1.000000
d_prime: 1.481705
train_loss: 0.243369
valid_loss: 1.114603
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0013793494551560103
Epoch-12 lr: 0.0013793494551560103
epoch 12 training time: 6.329
---------------
2023-09-12 09:38:49.822107
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01147	Per Sample Data Time 0.00604	Per Sample DNN Time 0.00543	Train Loss 0.2230	
start validation
acc: 0.613636
AUC: 0.852617
Avg Precision: 0.395158
Avg Recall: 1.000000
d_prime: 1.481705
train_loss: 0.228362
valid_loss: 1.114466
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0013793494551560103
Epoch-13 lr: 0.0013793494551560103
epoch 13 training time: 7.899
---------------
2023-09-12 09:38:57.721321
current #epochs=14, #steps=104
start validation
acc: 0.590909
AUC: 0.873967
Avg Precision: 0.489169
Avg Recall: 1.000000
d_prime: 1.619763
train_loss: 0.273830
valid_loss: 1.103235
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0013793494551560103
Epoch-14 lr: 0.0013793494551560103
epoch 14 training time: 6.761
---------------
2023-09-12 09:39:04.482688
current #epochs=15, #steps=112
start validation
acc: 0.636364
AUC: 0.885675
Avg Precision: 0.500893
Avg Recall: 1.000000
d_prime: 1.702492
train_loss: 0.235537
valid_loss: 1.083800
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0013793494551560103
Epoch-15 lr: 0.0013793494551560103
epoch 15 training time: 6.362
---------------
2023-09-12 09:39:10.844319
current #epochs=16, #steps=120
start validation
acc: 0.636364
AUC: 0.878099
Avg Precision: 0.437500
Avg Recall: 1.000000
d_prime: 1.648318
train_loss: 0.209007
valid_loss: 1.091883
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0013793494551560103
Epoch-16 lr: 0.0013793494551560103
epoch 16 training time: 7.375
---------------
2023-09-12 09:39:18.219219
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.873278
Avg Precision: 0.415062
Avg Recall: 1.000000
d_prime: 1.615068
train_loss: 0.243098
valid_loss: 1.101866
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0008701671516421323
Epoch-17 lr: 0.0008701671516421323
epoch 17 training time: 8.137
---------------
2023-09-12 09:39:26.356007
current #epochs=18, #steps=136
start validation
acc: 0.636364
AUC: 0.871212
Avg Precision: 0.414425
Avg Recall: 1.000000
d_prime: 1.601087
train_loss: 0.218323
valid_loss: 1.100299
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0008701671516421323
Epoch-18 lr: 0.0008701671516421323
epoch 18 training time: 6.710
---------------
2023-09-12 09:39:33.066482
current #epochs=19, #steps=144
start validation
acc: 0.613636
AUC: 0.869835
Avg Precision: 0.432898
Avg Recall: 1.000000
d_prime: 1.591853
train_loss: 0.273265
valid_loss: 1.102684
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0008701671516421323
Epoch-19 lr: 0.0008701671516421323
epoch 19 training time: 8.016
---------------
2023-09-12 09:39:41.082489
current #epochs=20, #steps=152
start validation
acc: 0.636364
AUC: 0.869835
Avg Precision: 0.417744
Avg Recall: 1.000000
d_prime: 1.591853
train_loss: 0.210109
valid_loss: 1.103096
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0008701671516421323
Epoch-20 lr: 0.0008701671516421323
epoch 20 training time: 7.829
---------------
2023-09-12 09:39:48.911686
current #epochs=21, #steps=160
start validation
acc: 0.636364
AUC: 0.868457
Avg Precision: 0.401118
Avg Recall: 1.000000
d_prime: 1.582686
train_loss: 0.202654
valid_loss: 1.104164
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0008701671516421323
Epoch-21 lr: 0.0008701671516421323
epoch 21 training time: 6.698
---------------
2023-09-12 09:39:55.609508
current #epochs=22, #steps=168
start validation
acc: 0.613636
AUC: 0.866391
Avg Precision: 0.379271
Avg Recall: 1.000000
d_prime: 1.569060
train_loss: 0.162622
valid_loss: 1.107309
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0008701671516421323
Epoch-22 lr: 0.0008701671516421323
epoch 22 training time: 6.802
---------------
2023-09-12 09:40:02.411227
current #epochs=23, #steps=176
start validation
acc: 0.613636
AUC: 0.862948
Avg Precision: 0.367028
Avg Recall: 1.000000
d_prime: 1.546667
train_loss: 0.219617
valid_loss: 1.113877
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0005489478166439991
Epoch-23 lr: 0.0005489478166439991
epoch 23 training time: 6.631
---------------
2023-09-12 09:40:09.041854
current #epochs=24, #steps=184
start validation
acc: 0.613636
AUC: 0.862948
Avg Precision: 0.367028
Avg Recall: 1.000000
d_prime: 1.546667
train_loss: 0.147872
valid_loss: 1.116634
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0005489478166439991
Epoch-24 lr: 0.0005489478166439991
epoch 24 training time: 8.002
---------------
2023-09-12 09:40:17.043757
current #epochs=25, #steps=192
start validation
acc: 0.659091
AUC: 0.862948
Avg Precision: 0.383275
Avg Recall: 1.000000
d_prime: 1.546667
train_loss: 0.213809
valid_loss: 1.115191
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0005489478166439991
Epoch-25 lr: 0.0005489478166439991
epoch 25 training time: 6.827
---------------
2023-09-12 09:40:23.871007
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03699	Per Sample Data Time 0.02978	Per Sample DNN Time 0.00721	Train Loss 0.2298	
start validation
acc: 0.659091
AUC: 0.862948
Avg Precision: 0.394662
Avg Recall: 1.000000
d_prime: 1.546667
train_loss: 0.167041
valid_loss: 1.113031
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0005489478166439991
Epoch-26 lr: 0.0005489478166439991
epoch 26 training time: 9.559
---------------
2023-09-12 09:40:33.430340
current #epochs=27, #steps=208
start validation
acc: 0.659091
AUC: 0.865702
Avg Precision: 0.395372
Avg Recall: 1.000000
d_prime: 1.564550
train_loss: 0.232297
valid_loss: 1.108454
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0005489478166439991
Epoch-27 lr: 0.0005489478166439991
epoch 27 training time: 6.872
---------------
2023-09-12 09:40:40.302898
current #epochs=28, #steps=216
start validation
acc: 0.636364
AUC: 0.869835
Avg Precision: 0.399609
Avg Recall: 1.000000
d_prime: 1.591853
train_loss: 0.214533
valid_loss: 1.101562
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0005489478166439991
Epoch-28 lr: 0.0005489478166439991
epoch 28 training time: 6.549
---------------
2023-09-12 09:40:46.851388
current #epochs=29, #steps=224
start validation
acc: 0.613636
AUC: 0.871212
Avg Precision: 0.416876
Avg Recall: 1.000000
d_prime: 1.601087
train_loss: 0.138187
valid_loss: 1.103116
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0003463055400672551
Epoch-29 lr: 0.0003463055400672551
epoch 29 training time: 7.840
---------------
2023-09-12 09:40:54.691352
current #epochs=30, #steps=232
start validation
acc: 0.613636
AUC: 0.867769
Avg Precision: 0.425863
Avg Recall: 1.000000
d_prime: 1.578128
train_loss: 0.142514
valid_loss: 1.102934
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0003463055400672551
Epoch-30 lr: 0.0003463055400672551
epoch 30 training time: 6.684
---------------
2023-09-12 09:41:01.375060
current #epochs=31, #steps=240
start validation
acc: 0.636364
AUC: 0.863636
Avg Precision: 0.423412
Avg Recall: 1.000000
d_prime: 1.551114
train_loss: 0.181381
valid_loss: 1.105982
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0003463055400672551
Epoch-31 lr: 0.0003463055400672551
epoch 31 training time: 6.686
---------------
2023-09-12 09:41:08.061093
current #epochs=32, #steps=248
start validation
acc: 0.636364
AUC: 0.860193
Avg Precision: 0.425863
Avg Recall: 1.000000
d_prime: 1.529028
train_loss: 0.187526
valid_loss: 1.110913
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0003463055400672551
Epoch-32 lr: 0.0003463055400672551
epoch 32 training time: 9.095
---------------
2023-09-12 09:41:17.155729
current #epochs=33, #steps=256
start validation
acc: 0.613636
AUC: 0.854683
Avg Precision: 0.422253
Avg Recall: 1.000000
d_prime: 1.494446
train_loss: 0.139057
valid_loss: 1.113664
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0003463055400672551
Epoch-33 lr: 0.0003463055400672551
epoch 33 training time: 8.911
---------------
2023-09-12 09:41:26.066884
current #epochs=34, #steps=264
start validation
acc: 0.636364
AUC: 0.853306
Avg Precision: 0.414425
Avg Recall: 1.000000
d_prime: 1.485939
train_loss: 0.135504
valid_loss: 1.115507
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0003463055400672551
Epoch-34 lr: 0.0003463055400672551
epoch 34 training time: 6.689
---------------
2023-09-12 09:41:32.755799
current #epochs=35, #steps=272
start validation
acc: 0.636364
AUC: 0.855372
Avg Precision: 0.394654
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.144111
valid_loss: 1.113417
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.00021846799175639684
Epoch-35 lr: 0.00021846799175639684
epoch 35 training time: 7.806
---------------
2023-09-12 09:41:40.561487
current #epochs=36, #steps=280
start validation
acc: 0.613636
AUC: 0.857438
Avg Precision: 0.396837
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.142225
valid_loss: 1.109653
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.00021846799175639684
Epoch-36 lr: 0.00021846799175639684
epoch 36 training time: 8.589
---------------
2023-09-12 09:41:49.150990
current #epochs=37, #steps=288
start validation
acc: 0.613636
AUC: 0.859504
Avg Precision: 0.394654
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.209104
valid_loss: 1.107517
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.00021846799175639684
Epoch-37 lr: 0.00021846799175639684
epoch 37 training time: 6.300
---------------
2023-09-12 09:41:55.450769
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01195	Per Sample Data Time 0.00620	Per Sample DNN Time 0.00575	Train Loss 0.2279	
start validation
acc: 0.613636
AUC: 0.858127
Avg Precision: 0.394654
Avg Recall: 1.000000
d_prime: 1.515953
train_loss: 0.206597
valid_loss: 1.107127
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.00021846799175639684
Epoch-38 lr: 0.00021846799175639684
epoch 38 training time: 6.380
---------------
2023-09-12 09:42:01.830380
current #epochs=39, #steps=304
start validation
acc: 0.590909
AUC: 0.859504
Avg Precision: 0.390879
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.164562
valid_loss: 1.107119
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.00021846799175639684
Epoch-39 lr: 0.00021846799175639684
epoch 39 training time: 6.329
---------------
2023-09-12 09:42:08.159518
current #epochs=40, #steps=312
start validation
acc: 0.568182
AUC: 0.859504
Avg Precision: 0.388106
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.225465
valid_loss: 1.105745
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.00021846799175639684
Epoch-40 lr: 0.00021846799175639684
epoch 40 training time: 11.686
---------------
2023-09-12 09:42:19.845795
current #epochs=41, #steps=320
start validation
acc: 0.590909
AUC: 0.862948
Avg Precision: 0.394654
Avg Recall: 1.000000
d_prime: 1.546667
train_loss: 0.195662
valid_loss: 1.105117
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.00013782125291095224
Epoch-41 lr: 0.00013782125291095224
epoch 41 training time: 6.298
---------------
2023-09-12 09:42:26.143570
current #epochs=42, #steps=328
start validation
acc: 0.590909
AUC: 0.860882
Avg Precision: 0.394654
Avg Recall: 1.000000
d_prime: 1.533415
train_loss: 0.202290
valid_loss: 1.105513
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.00013782125291095224
Epoch-42 lr: 0.00013782125291095224
epoch 42 training time: 6.425
---------------
2023-09-12 09:42:32.569021
current #epochs=43, #steps=336
start validation
acc: 0.590909
AUC: 0.859504
Avg Precision: 0.388106
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.165060
valid_loss: 1.106177
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.00013782125291095224
Epoch-43 lr: 0.00013782125291095224
epoch 43 training time: 6.338
---------------
2023-09-12 09:42:38.907207
current #epochs=44, #steps=344
start validation
acc: 0.590909
AUC: 0.860882
Avg Precision: 0.388106
Avg Recall: 1.000000
d_prime: 1.533415
train_loss: 0.094062
valid_loss: 1.105570
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.00013782125291095224
Epoch-44 lr: 0.00013782125291095224
epoch 44 training time: 6.660
---------------
2023-09-12 09:42:45.567511
current #epochs=45, #steps=352
start validation
[I 2023-09-12 09:42:52,017] Trial 53 finished with value: 0.6818181818181818 and parameters: {'warmup': 'False', 'num_epochs': 45, 'batch_size': 12, 'lr-adaptschedule': 'True', 'lr': 0.003465912171890557, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 6, 'lr-scheduler-decay': 0.630853297102809}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.636364
AUC: 0.858127
Avg Precision: 0.388106
Avg Recall: 1.000000
d_prime: 1.515953
train_loss: 0.266815
valid_loss: 1.105349
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.00013782125291095224
Epoch-45 lr: 0.00013782125291095224
epoch 45 training time: 6.445
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c856a910>
The learning rate scheduler starts at 4 epoch with decay rate of 0.703 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 09:42:52.053476
current #epochs=1, #steps=0
start validation
acc: 0.590909
AUC: 0.852617
Avg Precision: 0.419543
Avg Recall: 1.000000
d_prime: 1.481705
train_loss: 0.360808
valid_loss: 1.122674
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002951700598152437
Epoch-1 lr: 0.002951700598152437
epoch 1 training time: 9.833
---------------
2023-09-12 09:43:01.887213
current #epochs=2, #steps=8
start validation
acc: 0.636364
AUC: 0.878099
Avg Precision: 0.398545
Avg Recall: 1.000000
d_prime: 1.648318
train_loss: 0.289715
valid_loss: 1.104990
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002951700598152437
Epoch-2 lr: 0.002951700598152437
epoch 2 training time: 9.052
---------------
2023-09-12 09:43:10.939306
current #epochs=3, #steps=16
start validation
acc: 0.613636
AUC: 0.851928
Avg Precision: 0.423121
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.347329
valid_loss: 1.133559
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002951700598152437
Epoch-3 lr: 0.002951700598152437
epoch 3 training time: 6.441
---------------
2023-09-12 09:43:17.379604
current #epochs=4, #steps=24
start validation
acc: 0.568182
AUC: 0.840909
Avg Precision: 0.419113
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.271338
valid_loss: 1.148540
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002074583974534525
Epoch-4 lr: 0.002074583974534525
epoch 4 training time: 6.574
---------------
2023-09-12 09:43:23.953535
current #epochs=5, #steps=32
start validation
acc: 0.636364
AUC: 0.834711
Avg Precision: 0.397861
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.272601
valid_loss: 1.149325
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002074583974534525
Epoch-5 lr: 0.002074583974534525
epoch 5 training time: 6.279
---------------
2023-09-12 09:43:30.232279
current #epochs=6, #steps=40
start validation
acc: 0.590909
AUC: 0.838154
Avg Precision: 0.389823
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.254978
valid_loss: 1.147336
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002074583974534525
Epoch-6 lr: 0.002074583974534525
epoch 6 training time: 7.684
---------------
2023-09-12 09:43:37.916183
current #epochs=7, #steps=48
start validation
acc: 0.681818
AUC: 0.840220
Avg Precision: 0.403814
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.223118
valid_loss: 1.139268
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002074583974534525
Epoch-7 lr: 0.002074583974534525
epoch 7 training time: 11.290
---------------
2023-09-12 09:43:49.206671
current #epochs=8, #steps=56
start validation
acc: 0.659091
AUC: 0.834022
Avg Precision: 0.394769
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.257881
valid_loss: 1.138419
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001458108139453376
Epoch-8 lr: 0.001458108139453376
epoch 8 training time: 6.701
---------------
2023-09-12 09:43:55.907311
current #epochs=9, #steps=64
start validation
acc: 0.636364
AUC: 0.829201
Avg Precision: 0.400587
Avg Recall: 1.000000
d_prime: 1.344935
train_loss: 0.143924
valid_loss: 1.149295
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001458108139453376
Epoch-9 lr: 0.001458108139453376
epoch 9 training time: 7.647
---------------
2023-09-12 09:44:03.553942
current #epochs=10, #steps=72
start validation
acc: 0.659091
AUC: 0.844353
Avg Precision: 0.418300
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.191331
valid_loss: 1.140839
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001458108139453376
Epoch-10 lr: 0.001458108139453376
epoch 10 training time: 6.846
---------------
2023-09-12 09:44:10.400192
current #epochs=11, #steps=80
start validation
acc: 0.681818
AUC: 0.845041
Avg Precision: 0.427141
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.190718
valid_loss: 1.137241
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001458108139453376
Epoch-11 lr: 0.001458108139453376
epoch 11 training time: 6.564
---------------
2023-09-12 09:44:16.964504
current #epochs=12, #steps=88
start validation
acc: 0.659091
AUC: 0.832645
Avg Precision: 0.387015
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.183991
valid_loss: 1.135373
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001024822023325045
Epoch-12 lr: 0.001024822023325045
epoch 12 training time: 8.059
---------------
2023-09-12 09:44:25.023403
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01182	Per Sample Data Time 0.00628	Per Sample DNN Time 0.00555	Train Loss 0.2138	
start validation
[I 2023-09-12 09:44:31,321] Trial 54 finished with value: 0.6818181818181818 and parameters: {'warmup': 'False', 'num_epochs': 13, 'batch_size': 23, 'lr-adaptschedule': 'True', 'lr': 0.002951700598152437, 'head-lr': 1, 'lr-scheduler-start': 4, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.7028436338811168}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.590909
AUC: 0.830579
Avg Precision: 0.346331
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.189357
valid_loss: 1.136008
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.001024822023325045
Epoch-13 lr: 0.001024822023325045
epoch 13 training time: 6.293
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8e67c40>
The learning rate scheduler starts at 6 epoch with decay rate of 0.675 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 09:44:31.358143
current #epochs=1, #steps=0
start validation
acc: 0.636364
AUC: 0.831956
Avg Precision: 0.352808
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.269878
valid_loss: 1.139688
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0024900746518213383
Epoch-1 lr: 0.004980149303642677
epoch 1 training time: 10.565
---------------
2023-09-12 09:44:41.923449
current #epochs=2, #steps=8
start validation
acc: 0.500000
AUC: 0.806474
Avg Precision: 0.341093
Avg Recall: 1.000000
d_prime: 1.223260
train_loss: 0.253280
valid_loss: 1.171677
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0024900746518213383
Epoch-2 lr: 0.004980149303642677
epoch 2 training time: 6.963
---------------
2023-09-12 09:44:48.886468
current #epochs=3, #steps=16
start validation
acc: 0.545455
AUC: 0.818871
Avg Precision: 0.375832
Avg Recall: 1.000000
d_prime: 1.288446
train_loss: 0.202411
valid_loss: 1.164028
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0024900746518213383
Epoch-3 lr: 0.004980149303642677
epoch 3 training time: 6.516
---------------
2023-09-12 09:44:55.402256
current #epochs=4, #steps=24
start validation
acc: 0.613636
AUC: 0.801653
Avg Precision: 0.330783
Avg Recall: 1.000000
d_prime: 1.198603
train_loss: 0.259873
valid_loss: 1.165286
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0024900746518213383
Epoch-4 lr: 0.004980149303642677
epoch 4 training time: 6.515
---------------
2023-09-12 09:45:01.917628
current #epochs=5, #steps=32
start validation
acc: 0.590909
AUC: 0.805096
Avg Precision: 0.349519
Avg Recall: 1.000000
d_prime: 1.216177
train_loss: 0.234888
valid_loss: 1.163551
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0024900746518213383
Epoch-5 lr: 0.004980149303642677
epoch 5 training time: 6.384
---------------
2023-09-12 09:45:08.302150
current #epochs=6, #steps=40
start validation
acc: 0.545455
AUC: 0.804408
Avg Precision: 0.350929
Avg Recall: 1.000000
d_prime: 1.212647
train_loss: 0.244536
valid_loss: 1.170605
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0016819972193512585
Epoch-6 lr: 0.003363994438702517
epoch 6 training time: 7.425
---------------
2023-09-12 09:45:15.727425
current #epochs=7, #steps=48
start validation
acc: 0.613636
AUC: 0.800964
Avg Precision: 0.362246
Avg Recall: 1.000000
d_prime: 1.195110
train_loss: 0.207369
valid_loss: 1.172263
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0016819972193512585
Epoch-7 lr: 0.003363994438702517
epoch 7 training time: 6.483
---------------
2023-09-12 09:45:22.210580
current #epochs=8, #steps=56
start validation
acc: 0.636364
AUC: 0.830579
Avg Precision: 0.364101
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.198746
valid_loss: 1.136166
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0016819972193512585
Epoch-8 lr: 0.003363994438702517
epoch 8 training time: 6.510
---------------
2023-09-12 09:45:28.720969
current #epochs=9, #steps=64
start validation
acc: 0.613636
AUC: 0.816116
Avg Precision: 0.357981
Avg Recall: 1.000000
d_prime: 1.273727
train_loss: 0.210053
valid_loss: 1.159783
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0011361565581321186
Epoch-9 lr: 0.002272313116264237
epoch 9 training time: 6.546
---------------
2023-09-12 09:45:35.267073
current #epochs=10, #steps=72
start validation
acc: 0.590909
AUC: 0.818871
Avg Precision: 0.355765
Avg Recall: 1.000000
d_prime: 1.288446
train_loss: 0.213909
valid_loss: 1.152891
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0011361565581321186
Epoch-10 lr: 0.002272313116264237
epoch 10 training time: 6.334
---------------
2023-09-12 09:45:41.601397
current #epochs=11, #steps=80
start validation
acc: 0.636364
AUC: 0.820937
Avg Precision: 0.354754
Avg Recall: 1.000000
d_prime: 1.299578
train_loss: 0.242044
valid_loss: 1.140215
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0011361565581321186
Epoch-11 lr: 0.002272313116264237
epoch 11 training time: 6.488
---------------
2023-09-12 09:45:48.089372
current #epochs=12, #steps=88
start validation
acc: 0.636364
AUC: 0.819559
Avg Precision: 0.339784
Avg Recall: 1.000000
d_prime: 1.292148
train_loss: 0.161957
valid_loss: 1.142754
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0007674517589776398
Epoch-12 lr: 0.0015349035179552796
epoch 12 training time: 7.321
---------------
2023-09-12 09:45:55.410535
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01220	Per Sample Data Time 0.00641	Per Sample DNN Time 0.00579	Train Loss 0.1942	
start validation
acc: 0.659091
AUC: 0.824380
Avg Precision: 0.336827
Avg Recall: 1.000000
d_prime: 1.318312
train_loss: 0.200333
valid_loss: 1.146948
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0007674517589776398
Epoch-13 lr: 0.0015349035179552796
epoch 13 training time: 11.119
---------------
2023-09-12 09:46:06.530108
current #epochs=14, #steps=104
start validation
acc: 0.568182
AUC: 0.823691
Avg Precision: 0.334222
Avg Recall: 1.000000
d_prime: 1.314547
train_loss: 0.248312
valid_loss: 1.147181
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0007674517589776398
Epoch-14 lr: 0.0015349035179552796
epoch 14 training time: 6.835
---------------
2023-09-12 09:46:13.365306
current #epochs=15, #steps=112
start validation
acc: 0.568182
AUC: 0.828512
Avg Precision: 0.335583
Avg Recall: 1.000000
d_prime: 1.341103
train_loss: 0.146274
valid_loss: 1.140550
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0005183988052898104
Epoch-15 lr: 0.0010367976105796208
epoch 15 training time: 6.867
---------------
2023-09-12 09:46:20.232608
current #epochs=16, #steps=120
start validation
acc: 0.545455
AUC: 0.828512
Avg Precision: 0.331316
Avg Recall: 1.000000
d_prime: 1.341103
train_loss: 0.142226
valid_loss: 1.142623
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0005183988052898104
Epoch-16 lr: 0.0010367976105796208
epoch 16 training time: 6.320
---------------
2023-09-12 09:46:26.552562
current #epochs=17, #steps=128
start validation
acc: 0.590909
AUC: 0.823691
Avg Precision: 0.329461
Avg Recall: 1.000000
d_prime: 1.314547
train_loss: 0.140484
valid_loss: 1.149899
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0005183988052898104
Epoch-17 lr: 0.0010367976105796208
epoch 17 training time: 6.679
---------------
2023-09-12 09:46:33.231272
current #epochs=18, #steps=136
start validation
acc: 0.590909
AUC: 0.826446
Avg Precision: 0.336584
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.173031
valid_loss: 1.149742
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00035016835674974665
Epoch-18 lr: 0.0007003367134994933
epoch 18 training time: 6.488
---------------
2023-09-12 09:46:39.719051
current #epochs=19, #steps=144
start validation
acc: 0.590909
AUC: 0.829890
Avg Precision: 0.336584
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.201984
valid_loss: 1.146703
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00035016835674974665
Epoch-19 lr: 0.0007003367134994933
epoch 19 training time: 7.762
---------------
2023-09-12 09:46:47.480713
current #epochs=20, #steps=152
start validation
acc: 0.613636
AUC: 0.830579
Avg Precision: 0.343765
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.193102
valid_loss: 1.145890
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00035016835674974665
Epoch-20 lr: 0.0007003367134994933
epoch 20 training time: 7.077
---------------
2023-09-12 09:46:54.557560
current #epochs=21, #steps=160
start validation
acc: 0.590909
AUC: 0.831956
Avg Precision: 0.345948
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.175480
valid_loss: 1.144420
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00023653194570976763
Epoch-21 lr: 0.00047306389141953527
epoch 21 training time: 6.419
---------------
2023-09-12 09:47:00.976351
current #epochs=22, #steps=168
start validation
acc: 0.590909
AUC: 0.827824
Avg Precision: 0.345948
Avg Recall: 1.000000
d_prime: 1.337280
train_loss: 0.128320
valid_loss: 1.145057
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00023653194570976763
Epoch-22 lr: 0.00047306389141953527
epoch 22 training time: 6.733
---------------
2023-09-12 09:47:07.709196
current #epochs=23, #steps=176
start validation
acc: 0.590909
AUC: 0.827135
Avg Precision: 0.341701
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.151910
valid_loss: 1.146491
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00023653194570976763
Epoch-23 lr: 0.00047306389141953527
epoch 23 training time: 6.486
---------------
2023-09-12 09:47:14.195086
current #epochs=24, #steps=184
start validation
acc: 0.590909
AUC: 0.826446
Avg Precision: 0.334477
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.158356
valid_loss: 1.148178
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00015977275005814456
Epoch-24 lr: 0.0003195455001162891
epoch 24 training time: 7.086
---------------
2023-09-12 09:47:21.280775
current #epochs=25, #steps=192
start validation
acc: 0.590909
AUC: 0.824380
Avg Precision: 0.331090
Avg Recall: 1.000000
d_prime: 1.318312
train_loss: 0.186029
valid_loss: 1.149353
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00015977275005814456
Epoch-25 lr: 0.0003195455001162891
epoch 25 training time: 7.478
---------------
2023-09-12 09:47:28.759121
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03786	Per Sample Data Time 0.03038	Per Sample DNN Time 0.00749	Train Loss 0.1623	
start validation
acc: 0.590909
AUC: 0.826446
Avg Precision: 0.331090
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.166721
valid_loss: 1.149121
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00015977275005814456
Epoch-26 lr: 0.0003195455001162891
epoch 26 training time: 6.434
---------------
2023-09-12 09:47:35.193038
current #epochs=27, #steps=208
start validation
acc: 0.590909
AUC: 0.827135
Avg Precision: 0.335337
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.193644
valid_loss: 1.149512
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00010792339945685474
Epoch-27 lr: 0.00021584679891370947
epoch 27 training time: 6.375
---------------
2023-09-12 09:47:41.567574
current #epochs=28, #steps=216
start validation
acc: 0.590909
AUC: 0.827135
Avg Precision: 0.335337
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.154049
valid_loss: 1.149804
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00010792339945685474
Epoch-28 lr: 0.00021584679891370947
epoch 28 training time: 6.705
---------------
2023-09-12 09:47:48.272134
current #epochs=29, #steps=224
start validation
acc: 0.590909
AUC: 0.829201
Avg Precision: 0.337519
Avg Recall: 1.000000
d_prime: 1.344935
train_loss: 0.129986
valid_loss: 1.149999
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00010792339945685474
Epoch-29 lr: 0.00021584679891370947
epoch 29 training time: 6.395
---------------
2023-09-12 09:47:54.667452
current #epochs=30, #steps=232
start validation
acc: 0.613636
AUC: 0.830579
Avg Precision: 0.339830
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.163089
valid_loss: 1.149944
validation finished
normal learning rate scheduler step
Epoch-30 lr: 7.29001669313765e-05
Epoch-30 lr: 0.000145800333862753
epoch 30 training time: 6.390
---------------
2023-09-12 09:48:01.057785
current #epochs=31, #steps=240
start validation
acc: 0.613636
AUC: 0.830579
Avg Precision: 0.339830
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.152572
valid_loss: 1.149420
validation finished
normal learning rate scheduler step
Epoch-31 lr: 7.29001669313765e-05
Epoch-31 lr: 0.000145800333862753
epoch 31 training time: 6.481
---------------
2023-09-12 09:48:07.539285
current #epochs=32, #steps=248
start validation
acc: 0.613636
AUC: 0.830579
Avg Precision: 0.339830
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.207909
valid_loss: 1.149185
validation finished
normal learning rate scheduler step
Epoch-32 lr: 7.29001669313765e-05
Epoch-32 lr: 0.000145800333862753
epoch 32 training time: 6.416
---------------
2023-09-12 09:48:13.955374
current #epochs=33, #steps=256
start validation
acc: 0.613636
AUC: 0.828512
Avg Precision: 0.339830
Avg Recall: 1.000000
d_prime: 1.341103
train_loss: 0.157033
valid_loss: 1.149417
validation finished
normal learning rate scheduler step
Epoch-33 lr: 4.9242651411727884e-05
Epoch-33 lr: 9.848530282345577e-05
epoch 33 training time: 6.285
---------------
2023-09-12 09:48:20.240374
current #epochs=34, #steps=264
start validation
acc: 0.613636
AUC: 0.829201
Avg Precision: 0.342991
Avg Recall: 1.000000
d_prime: 1.344935
train_loss: 0.173163
valid_loss: 1.149288
validation finished
normal learning rate scheduler step
Epoch-34 lr: 4.9242651411727884e-05
Epoch-34 lr: 9.848530282345577e-05
epoch 34 training time: 6.382
---------------
2023-09-12 09:48:26.622760
current #epochs=35, #steps=272
start validation
acc: 0.613636
AUC: 0.829201
Avg Precision: 0.342991
Avg Recall: 1.000000
d_prime: 1.344935
train_loss: 0.177109
valid_loss: 1.149199
validation finished
normal learning rate scheduler step
Epoch-35 lr: 4.9242651411727884e-05
Epoch-35 lr: 9.848530282345577e-05
epoch 35 training time: 6.367
---------------
2023-09-12 09:48:32.989923
current #epochs=36, #steps=280
start validation
acc: 0.613636
AUC: 0.829890
Avg Precision: 0.345948
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.144397
valid_loss: 1.149014
validation finished
normal learning rate scheduler step
Epoch-36 lr: 3.3262457688739347e-05
Epoch-36 lr: 6.652491537747869e-05
epoch 36 training time: 6.754
---------------
2023-09-12 09:48:39.744200
current #epochs=37, #steps=288
start validation
acc: 0.613636
AUC: 0.830579
Avg Precision: 0.345948
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.194416
valid_loss: 1.148701
validation finished
normal learning rate scheduler step
Epoch-37 lr: 3.3262457688739347e-05
Epoch-37 lr: 6.652491537747869e-05
epoch 37 training time: 6.978
---------------
2023-09-12 09:48:46.721890
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01181	Per Sample Data Time 0.00604	Per Sample DNN Time 0.00577	Train Loss 0.2907	
start validation
acc: 0.613636
AUC: 0.830579
Avg Precision: 0.345948
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.227318
valid_loss: 1.148510
validation finished
normal learning rate scheduler step
Epoch-38 lr: 3.3262457688739347e-05
Epoch-38 lr: 6.652491537747869e-05
epoch 38 training time: 6.362
---------------
2023-09-12 09:48:53.084191
current #epochs=39, #steps=304
start validation
acc: 0.613636
AUC: 0.831267
Avg Precision: 0.345948
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.152269
valid_loss: 1.148432
validation finished
normal learning rate scheduler step
Epoch-39 lr: 2.246814620610927e-05
Epoch-39 lr: 4.493629241221854e-05
epoch 39 training time: 6.398
---------------
2023-09-12 09:48:59.482725
current #epochs=40, #steps=312
start validation
acc: 0.613636
AUC: 0.831267
Avg Precision: 0.345948
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.144937
valid_loss: 1.148459
validation finished
normal learning rate scheduler step
Epoch-40 lr: 2.246814620610927e-05
Epoch-40 lr: 4.493629241221854e-05
epoch 40 training time: 7.080
---------------
2023-09-12 09:49:06.563020
current #epochs=41, #steps=320
start validation
acc: 0.613636
AUC: 0.831956
Avg Precision: 0.345948
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.178693
valid_loss: 1.148574
validation finished
normal learning rate scheduler step
Epoch-41 lr: 2.246814620610927e-05
Epoch-41 lr: 4.493629241221854e-05
epoch 41 training time: 7.175
---------------
2023-09-12 09:49:13.738068
current #epochs=42, #steps=328
start validation
acc: 0.613636
AUC: 0.831956
Avg Precision: 0.345948
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.134907
valid_loss: 1.148556
validation finished
normal learning rate scheduler step
Epoch-42 lr: 1.5176797777934585e-05
Epoch-42 lr: 3.035359555586917e-05
epoch 42 training time: 6.437
---------------
2023-09-12 09:49:20.175234
current #epochs=43, #steps=336
start validation
acc: 0.613636
AUC: 0.831956
Avg Precision: 0.345948
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.218149
valid_loss: 1.148340
validation finished
normal learning rate scheduler step
Epoch-43 lr: 1.5176797777934585e-05
Epoch-43 lr: 3.035359555586917e-05
epoch 43 training time: 6.453
---------------
2023-09-12 09:49:26.628724
current #epochs=44, #steps=344
start validation
acc: 0.613636
AUC: 0.831956
Avg Precision: 0.345948
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.240862
valid_loss: 1.148214
validation finished
normal learning rate scheduler step
Epoch-44 lr: 1.5176797777934585e-05
Epoch-44 lr: 3.035359555586917e-05
epoch 44 training time: 6.352
---------------
2023-09-12 09:49:32.980107
current #epochs=45, #steps=352
start validation
acc: 0.613636
AUC: 0.831956
Avg Precision: 0.345948
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.228731
valid_loss: 1.148158
validation finished
normal learning rate scheduler step
Epoch-45 lr: 1.0251633075526727e-05
Epoch-45 lr: 2.0503266151053453e-05
epoch 45 training time: 6.491
---------------
2023-09-12 09:49:39.471498
current #epochs=46, #steps=360
start validation
[I 2023-09-12 09:49:46,745] Trial 55 finished with value: 0.6590909090909091 and parameters: {'warmup': 'False', 'num_epochs': 46, 'batch_size': 30, 'lr-adaptschedule': 'True', 'lr': 0.0024900746518213383, 'head-lr': 2, 'lr-scheduler-start': 6, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.675480639956308}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.613636
AUC: 0.831956
Avg Precision: 0.345948
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.169075
valid_loss: 1.148056
validation finished
normal learning rate scheduler step
Epoch-46 lr: 1.0251633075526727e-05
Epoch-46 lr: 2.0503266151053453e-05
epoch 46 training time: 7.269
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8ec6a00>
The learning rate scheduler starts at 5 epoch with decay rate of 0.719 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 09:49:46.782819
current #epochs=1, #steps=0
start validation
acc: 0.522727
AUC: 0.820248
Avg Precision: 0.339931
Avg Recall: 1.000000
d_prime: 1.295859
train_loss: 0.358176
valid_loss: 1.187348
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003281033019499187
Epoch-1 lr: 0.016405165097495934
epoch 1 training time: 9.026
---------------
2023-09-12 09:49:55.809687
current #epochs=2, #steps=8
start validation
acc: 0.568182
AUC: 0.794766
Avg Precision: 0.340685
Avg Recall: 1.000000
d_prime: 1.163996
train_loss: 0.352619
valid_loss: 1.182245
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003281033019499187
Epoch-2 lr: 0.016405165097495934
epoch 2 training time: 9.036
---------------
2023-09-12 09:50:04.845379
current #epochs=3, #steps=16
start validation
acc: 0.613636
AUC: 0.845730
Avg Precision: 0.409942
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.285912
valid_loss: 1.141924
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003281033019499187
Epoch-3 lr: 0.016405165097495934
epoch 3 training time: 9.248
---------------
2023-09-12 09:50:14.093902
current #epochs=4, #steps=24
start validation
acc: 0.613636
AUC: 0.846419
Avg Precision: 0.419941
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.353435
valid_loss: 1.144975
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003281033019499187
Epoch-4 lr: 0.016405165097495934
epoch 4 training time: 6.374
---------------
2023-09-12 09:50:20.468414
current #epochs=5, #steps=32
start validation
acc: 0.590909
AUC: 0.834022
Avg Precision: 0.403199
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.266075
valid_loss: 1.148222
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0023593155466020504
Epoch-5 lr: 0.011796577733010252
epoch 5 training time: 6.296
---------------
2023-09-12 09:50:26.764348
current #epochs=6, #steps=40
start validation
acc: 0.590909
AUC: 0.845041
Avg Precision: 0.406771
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.283148
valid_loss: 1.130490
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0023593155466020504
Epoch-6 lr: 0.011796577733010252
epoch 6 training time: 6.356
---------------
2023-09-12 09:50:33.120439
current #epochs=7, #steps=48
start validation
acc: 0.613636
AUC: 0.840909
Avg Precision: 0.420650
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.283924
valid_loss: 1.132954
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0023593155466020504
Epoch-7 lr: 0.011796577733010252
epoch 7 training time: 7.273
---------------
2023-09-12 09:50:40.392950
current #epochs=8, #steps=56
start validation
acc: 0.704545
AUC: 0.832645
Avg Precision: 0.374977
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.210436
valid_loss: 1.140792
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0023593155466020504
Epoch-8 lr: 0.011796577733010252
epoch 8 training time: 9.086
---------------
2023-09-12 09:50:49.479219
current #epochs=9, #steps=64
start validation
acc: 0.659091
AUC: 0.837466
Avg Precision: 0.351367
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.181301
valid_loss: 1.137300
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0016965296646992527
Epoch-9 lr: 0.008482648323496263
epoch 9 training time: 7.484
---------------
2023-09-12 09:50:56.962862
current #epochs=10, #steps=72
start validation
acc: 0.659091
AUC: 0.829890
Avg Precision: 0.342760
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.131985
valid_loss: 1.141699
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0016965296646992527
Epoch-10 lr: 0.008482648323496263
epoch 10 training time: 6.387
---------------
2023-09-12 09:51:03.349819
current #epochs=11, #steps=80
start validation
acc: 0.636364
AUC: 0.824380
Avg Precision: 0.350865
Avg Recall: 1.000000
d_prime: 1.318312
train_loss: 0.145481
valid_loss: 1.142146
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0016965296646992527
Epoch-11 lr: 0.008482648323496263
epoch 11 training time: 6.388
---------------
2023-09-12 09:51:09.738083
current #epochs=12, #steps=88
start validation
acc: 0.659091
AUC: 0.829890
Avg Precision: 0.346425
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.148485
valid_loss: 1.132719
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0016965296646992527
Epoch-12 lr: 0.008482648323496263
epoch 12 training time: 6.253
---------------
2023-09-12 09:51:15.991188
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01162	Per Sample Data Time 0.00607	Per Sample DNN Time 0.00555	Train Loss 0.1714	
start validation
acc: 0.613636
AUC: 0.823003
Avg Precision: 0.339400
Avg Recall: 1.000000
d_prime: 1.310791
train_loss: 0.201160
valid_loss: 1.146469
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0012199355475573574
Epoch-13 lr: 0.006099677737786788
epoch 13 training time: 6.269
---------------
2023-09-12 09:51:22.260467
current #epochs=14, #steps=104
start validation
acc: 0.613636
AUC: 0.827824
Avg Precision: 0.336127
Avg Recall: 1.000000
d_prime: 1.337280
train_loss: 0.167354
valid_loss: 1.156111
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0012199355475573574
Epoch-14 lr: 0.006099677737786788
epoch 14 training time: 6.375
---------------
2023-09-12 09:51:28.635554
current #epochs=15, #steps=112
start validation
acc: 0.613636
AUC: 0.832645
Avg Precision: 0.336127
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.156075
valid_loss: 1.147655
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0012199355475573574
Epoch-15 lr: 0.006099677737786788
epoch 15 training time: 7.852
---------------
2023-09-12 09:51:36.488127
current #epochs=16, #steps=120
start validation
acc: 0.659091
AUC: 0.829890
Avg Precision: 0.348259
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.186225
valid_loss: 1.152038
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0012199355475573574
Epoch-16 lr: 0.006099677737786788
epoch 16 training time: 6.691
---------------
2023-09-12 09:51:43.179512
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.823003
Avg Precision: 0.356936
Avg Recall: 1.000000
d_prime: 1.310791
train_loss: 0.206568
valid_loss: 1.159219
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0008772276554668399
Epoch-17 lr: 0.0043861382773342
epoch 17 training time: 6.258
---------------
2023-09-12 09:51:49.437759
current #epochs=18, #steps=136
start validation
acc: 0.636364
AUC: 0.823003
Avg Precision: 0.347115
Avg Recall: 1.000000
d_prime: 1.310791
train_loss: 0.169613
valid_loss: 1.150032
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0008772276554668399
Epoch-18 lr: 0.0043861382773342
epoch 18 training time: 6.411
---------------
2023-09-12 09:51:55.848250
current #epochs=19, #steps=144
start validation
acc: 0.636364
AUC: 0.826446
Avg Precision: 0.350502
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.178445
valid_loss: 1.140545
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0008772276554668399
Epoch-19 lr: 0.0043861382773342
epoch 19 training time: 6.270
---------------
2023-09-12 09:52:02.118218
current #epochs=20, #steps=152
start validation
acc: 0.613636
AUC: 0.827824
Avg Precision: 0.352689
Avg Recall: 1.000000
d_prime: 1.337280
train_loss: 0.157535
valid_loss: 1.135252
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0008772276554668399
Epoch-20 lr: 0.0043861382773342
epoch 20 training time: 7.312
---------------
2023-09-12 09:52:09.430097
current #epochs=21, #steps=160
start validation
acc: 0.590909
AUC: 0.839532
Avg Precision: 0.380217
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.130862
valid_loss: 1.136878
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0006307942752030251
Epoch-21 lr: 0.003153971376015126
epoch 21 training time: 7.325
---------------
2023-09-12 09:52:16.755199
current #epochs=22, #steps=168
start validation
acc: 0.590909
AUC: 0.834711
Avg Precision: 0.387015
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.185587
valid_loss: 1.144589
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0006307942752030251
Epoch-22 lr: 0.003153971376015126
epoch 22 training time: 7.662
---------------
2023-09-12 09:52:24.417435
current #epochs=23, #steps=176
start validation
acc: 0.568182
AUC: 0.827824
Avg Precision: 0.382288
Avg Recall: 1.000000
d_prime: 1.337280
train_loss: 0.108376
valid_loss: 1.152278
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0006307942752030251
Epoch-23 lr: 0.003153971376015126
epoch 23 training time: 6.409
---------------
2023-09-12 09:52:30.826377
current #epochs=24, #steps=184
start validation
acc: 0.590909
AUC: 0.825413
Avg Precision: 0.379133
Avg Recall: 1.000000
d_prime: 1.323978
train_loss: 0.230742
valid_loss: 1.156986
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0006307942752030251
Epoch-24 lr: 0.003153971376015126
epoch 24 training time: 6.395
---------------
2023-09-12 09:52:37.221210
current #epochs=25, #steps=192
start validation
acc: 0.568182
AUC: 0.831956
Avg Precision: 0.372389
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.178532
valid_loss: 1.148793
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0004535896869520786
Epoch-25 lr: 0.002267948434760393
epoch 25 training time: 6.709
---------------
2023-09-12 09:52:43.930633
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03729	Per Sample Data Time 0.02997	Per Sample DNN Time 0.00732	Train Loss 0.2197	
start validation
acc: 0.568182
AUC: 0.833333
Avg Precision: 0.373313
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.169457
valid_loss: 1.137486
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0004535896869520786
Epoch-26 lr: 0.002267948434760393
epoch 26 training time: 8.201
---------------
2023-09-12 09:52:52.131897
current #epochs=27, #steps=208
start validation
acc: 0.568182
AUC: 0.849174
Avg Precision: 0.400376
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.205341
valid_loss: 1.122645
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0004535896869520786
Epoch-27 lr: 0.002267948434760393
epoch 27 training time: 6.879
---------------
2023-09-12 09:52:59.010902
current #epochs=28, #steps=216
start validation
acc: 0.636364
AUC: 0.850551
Avg Precision: 0.399306
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.163251
valid_loss: 1.127507
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0004535896869520786
Epoch-28 lr: 0.002267948434760393
epoch 28 training time: 6.330
---------------
2023-09-12 09:53:05.340560
current #epochs=29, #steps=224
start validation
acc: 0.613636
AUC: 0.847107
Avg Precision: 0.397502
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.179587
valid_loss: 1.138644
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00032616593427875484
Epoch-29 lr: 0.0016308296713937742
epoch 29 training time: 6.306
---------------
2023-09-12 09:53:11.646072
current #epochs=30, #steps=232
start validation
acc: 0.613636
AUC: 0.842287
Avg Precision: 0.399769
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.175078
valid_loss: 1.140718
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00032616593427875484
Epoch-30 lr: 0.0016308296713937742
epoch 30 training time: 6.416
---------------
2023-09-12 09:53:18.062374
current #epochs=31, #steps=240
start validation
acc: 0.613636
AUC: 0.841598
Avg Precision: 0.424286
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.115714
valid_loss: 1.140321
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.00032616593427875484
Epoch-31 lr: 0.0016308296713937742
epoch 31 training time: 7.927
---------------
2023-09-12 09:53:25.988933
current #epochs=32, #steps=248
start validation
acc: 0.636364
AUC: 0.836088
Avg Precision: 0.414141
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.134599
valid_loss: 1.139173
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00032616593427875484
Epoch-32 lr: 0.0016308296713937742
epoch 32 training time: 6.494
---------------
2023-09-12 09:53:32.483062
current #epochs=33, #steps=256
start validation
acc: 0.659091
AUC: 0.837466
Avg Precision: 0.414141
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.129717
valid_loss: 1.137264
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.00023453843802928533
Epoch-33 lr: 0.0011726921901464265
epoch 33 training time: 7.123
---------------
2023-09-12 09:53:39.606360
current #epochs=34, #steps=264
start validation
acc: 0.681818
AUC: 0.836777
Avg Precision: 0.414141
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.153523
valid_loss: 1.136714
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.00023453843802928533
Epoch-34 lr: 0.0011726921901464265
epoch 34 training time: 9.181
---------------
2023-09-12 09:53:48.787442
current #epochs=35, #steps=272
start validation
acc: 0.659091
AUC: 0.836777
Avg Precision: 0.406985
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.164394
valid_loss: 1.136156
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.00023453843802928533
Epoch-35 lr: 0.0011726921901464265
epoch 35 training time: 6.817
---------------
2023-09-12 09:53:55.604611
current #epochs=36, #steps=280
start validation
[I 2023-09-12 09:54:02,477] Trial 56 finished with value: 0.7045454545454546 and parameters: {'warmup': 'False', 'num_epochs': 36, 'batch_size': 26, 'lr-adaptschedule': 'False', 'lr': 0.003281033019499187, 'head-lr': 5, 'lr-scheduler-start': 5, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.7190770506059014}. Best is trial 30 with value: 0.7045454545454546.
acc: 0.659091
AUC: 0.838154
Avg Precision: 0.400376
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.142449
valid_loss: 1.137555
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.00023453843802928533
Epoch-36 lr: 0.0011726921901464265
epoch 36 training time: 6.867
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95bc7b12b0>
The learning rate scheduler starts at 3 epoch with decay rate of 0.716 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 09:54:02.514132
current #epochs=1, #steps=0
start validation
acc: 0.568182
AUC: 0.815427
Avg Precision: 0.345274
Avg Recall: 1.000000
d_prime: 1.270069
train_loss: 0.263333
valid_loss: 1.167524
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0032123112290088555
Epoch-1 lr: 0.016061556145044276
epoch 1 training time: 10.780
---------------
2023-09-12 09:54:13.294158
current #epochs=2, #steps=8
start validation
acc: 0.613636
AUC: 0.849862
Avg Precision: 0.363710
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.290195
valid_loss: 1.127852
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0032123112290088555
Epoch-2 lr: 0.016061556145044276
epoch 2 training time: 10.202
---------------
2023-09-12 09:54:23.495999
current #epochs=3, #steps=16
start validation
acc: 0.613636
AUC: 0.815427
Avg Precision: 0.313722
Avg Recall: 1.000000
d_prime: 1.270069
train_loss: 0.285374
valid_loss: 1.155752
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0023006389710768897
Epoch-3 lr: 0.011503194855384449
epoch 3 training time: 6.570
---------------
2023-09-12 09:54:30.065709
current #epochs=4, #steps=24
start validation
acc: 0.659091
AUC: 0.848485
Avg Precision: 0.353241
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.347846
valid_loss: 1.123698
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0023006389710768897
Epoch-4 lr: 0.011503194855384449
epoch 4 training time: 9.398
---------------
2023-09-12 09:54:39.464135
current #epochs=5, #steps=32
start validation
acc: 0.568182
AUC: 0.847796
Avg Precision: 0.388591
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.243099
valid_loss: 1.139933
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0023006389710768897
Epoch-5 lr: 0.011503194855384449
epoch 5 training time: 6.987
---------------
2023-09-12 09:54:46.451201
current #epochs=6, #steps=40
start validation
acc: 0.636364
AUC: 0.842975
Avg Precision: 0.361494
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.218812
valid_loss: 1.143202
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0023006389710768897
Epoch-6 lr: 0.011503194855384449
epoch 6 training time: 6.860
---------------
2023-09-12 09:54:53.311200
current #epochs=7, #steps=48
start validation
acc: 0.636364
AUC: 0.834711
Avg Precision: 0.333236
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.254865
valid_loss: 1.124905
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0016477045024279428
Epoch-7 lr: 0.008238522512139714
epoch 7 training time: 6.341
---------------
2023-09-12 09:54:59.652175
current #epochs=8, #steps=56
start validation
acc: 0.659091
AUC: 0.832645
Avg Precision: 0.320211
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.231237
valid_loss: 1.122251
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0016477045024279428
Epoch-8 lr: 0.008238522512139714
epoch 8 training time: 7.075
---------------
2023-09-12 09:55:06.727118
current #epochs=9, #steps=64
start validation
acc: 0.636364
AUC: 0.811295
Avg Precision: 0.318903
Avg Recall: 1.000000
d_prime: 1.248295
train_loss: 0.242535
valid_loss: 1.154387
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0016477045024279428
Epoch-9 lr: 0.008238522512139714
epoch 9 training time: 6.496
---------------
2023-09-12 09:55:13.223793
current #epochs=10, #steps=72
start validation
acc: 0.659091
AUC: 0.807851
Avg Precision: 0.320292
Avg Recall: 1.000000
d_prime: 1.230373
train_loss: 0.242387
valid_loss: 1.162221
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0016477045024279428
Epoch-10 lr: 0.008238522512139714
epoch 10 training time: 7.297
---------------
2023-09-12 09:55:20.520633
current #epochs=11, #steps=80
start validation
acc: 0.636364
AUC: 0.816116
Avg Precision: 0.334951
Avg Recall: 1.000000
d_prime: 1.273727
train_loss: 0.219326
valid_loss: 1.154351
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0011800765619694351
Epoch-11 lr: 0.0059003828098471755
epoch 11 training time: 6.309
---------------
2023-09-12 09:55:26.829392
current #epochs=12, #steps=88
start validation
acc: 0.659091
AUC: 0.839532
Avg Precision: 0.339320
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.219733
valid_loss: 1.138420
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0011800765619694351
Epoch-12 lr: 0.0059003828098471755
epoch 12 training time: 6.441
---------------
2023-09-12 09:55:33.270347
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01178	Per Sample Data Time 0.00603	Per Sample DNN Time 0.00574	Train Loss 0.2443	
start validation
acc: 0.704545
AUC: 0.841598
Avg Precision: 0.334909
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.215184
valid_loss: 1.123990
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0011800765619694351
Epoch-13 lr: 0.0059003828098471755
epoch 13 training time: 9.824
---------------
2023-09-12 09:55:43.094519
current #epochs=14, #steps=104
start validation
acc: 0.772727
AUC: 0.840220
Avg Precision: 0.334909
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.238948
valid_loss: 1.120440
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0011800765619694351
Epoch-14 lr: 0.0059003828098471755
epoch 14 training time: 9.639
---------------
2023-09-12 09:55:52.733835
current #epochs=15, #steps=112
start validation
acc: 0.704545
AUC: 0.838843
Avg Precision: 0.329522
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.194752
valid_loss: 1.125056
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0008451640995443006
Epoch-15 lr: 0.004225820497721503
epoch 15 training time: 8.523
---------------
2023-09-12 09:56:01.256937
current #epochs=16, #steps=120
start validation
acc: 0.681818
AUC: 0.842287
Avg Precision: 0.329522
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.154547
valid_loss: 1.121343
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0008451640995443006
Epoch-16 lr: 0.004225820497721503
epoch 16 training time: 7.049
---------------
2023-09-12 09:56:08.305415
current #epochs=17, #steps=128
start validation
acc: 0.704545
AUC: 0.848485
Avg Precision: 0.336467
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.166857
valid_loss: 1.120255
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0008451640995443006
Epoch-17 lr: 0.004225820497721503
epoch 17 training time: 7.091
---------------
2023-09-12 09:56:15.396204
current #epochs=18, #steps=136
start validation
acc: 0.681818
AUC: 0.842287
Avg Precision: 0.331478
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.192535
valid_loss: 1.123306
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0008451640995443006
Epoch-18 lr: 0.004225820497721503
epoch 18 training time: 6.405
---------------
2023-09-12 09:56:21.801598
current #epochs=19, #steps=144
start validation
acc: 0.636364
AUC: 0.837466
Avg Precision: 0.345061
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.147608
valid_loss: 1.122708
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0006053017051422714
Epoch-19 lr: 0.003026508525711357
epoch 19 training time: 6.479
---------------
2023-09-12 09:56:28.280566
current #epochs=20, #steps=152
start validation
acc: 0.590909
AUC: 0.841598
Avg Precision: 0.355660
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.203320
valid_loss: 1.118011
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0006053017051422714
Epoch-20 lr: 0.003026508525711357
epoch 20 training time: 6.454
---------------
2023-09-12 09:56:34.734914
current #epochs=21, #steps=160
start validation
acc: 0.590909
AUC: 0.850551
Avg Precision: 0.363809
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.143998
valid_loss: 1.117404
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0006053017051422714
Epoch-21 lr: 0.003026508525711357
epoch 21 training time: 6.286
---------------
2023-09-12 09:56:41.021048
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.850551
Avg Precision: 0.372016
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.178661
valid_loss: 1.116714
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0006053017051422714
Epoch-22 lr: 0.003026508525711357
epoch 22 training time: 6.543
---------------
2023-09-12 09:56:47.563983
current #epochs=23, #steps=176
start validation
acc: 0.590909
AUC: 0.847796
Avg Precision: 0.366581
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.156603
valid_loss: 1.117849
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00043351362705265547
Epoch-23 lr: 0.002167568135263277
epoch 23 training time: 7.896
---------------
2023-09-12 09:56:55.460396
current #epochs=24, #steps=184
start validation
acc: 0.590909
AUC: 0.845041
Avg Precision: 0.359670
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.174583
valid_loss: 1.121647
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00043351362705265547
Epoch-24 lr: 0.002167568135263277
epoch 24 training time: 6.513
---------------
2023-09-12 09:57:01.972877
current #epochs=25, #steps=192
start validation
acc: 0.590909
AUC: 0.844353
Avg Precision: 0.369411
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.120953
valid_loss: 1.124131
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00043351362705265547
Epoch-25 lr: 0.002167568135263277
epoch 25 training time: 6.501
---------------
2023-09-12 09:57:08.473881
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03468	Per Sample Data Time 0.02917	Per Sample DNN Time 0.00552	Train Loss 0.1847	
start validation
acc: 0.590909
AUC: 0.842287
Avg Precision: 0.372016
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.159471
valid_loss: 1.125394
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00043351362705265547
Epoch-26 lr: 0.002167568135263277
epoch 26 training time: 7.364
---------------
2023-09-12 09:57:15.838174
current #epochs=27, #steps=208
start validation
acc: 0.590909
AUC: 0.842975
Avg Precision: 0.370160
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.165335
valid_loss: 1.128426
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00031047998583809774
Epoch-27 lr: 0.0015523999291904885
epoch 27 training time: 6.459
---------------
2023-09-12 09:57:22.297337
current #epochs=28, #steps=216
start validation
acc: 0.590909
AUC: 0.840909
Avg Precision: 0.367388
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.124075
valid_loss: 1.127387
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00031047998583809774
Epoch-28 lr: 0.0015523999291904885
epoch 28 training time: 6.409
---------------
2023-09-12 09:57:28.705898
current #epochs=29, #steps=224
start validation
acc: 0.590909
AUC: 0.842287
Avg Precision: 0.367388
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.209235
valid_loss: 1.127493
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00031047998583809774
Epoch-29 lr: 0.0015523999291904885
epoch 29 training time: 6.352
---------------
2023-09-12 09:57:35.057727
current #epochs=30, #steps=232
start validation
acc: 0.613636
AUC: 0.840909
Avg Precision: 0.365625
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.153492
valid_loss: 1.129315
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00031047998583809774
Epoch-30 lr: 0.0015523999291904885
epoch 30 training time: 7.593
---------------
2023-09-12 09:57:42.650398
current #epochs=31, #steps=240
start validation
acc: 0.613636
AUC: 0.842287
Avg Precision: 0.365625
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.139908
valid_loss: 1.128378
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.00022236399409496924
Epoch-31 lr: 0.001111819970474846
epoch 31 training time: 6.417
---------------
2023-09-12 09:57:49.067749
current #epochs=32, #steps=248
start validation
acc: 0.613636
AUC: 0.841598
Avg Precision: 0.355208
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.113082
valid_loss: 1.127966
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00022236399409496924
Epoch-32 lr: 0.001111819970474846
epoch 32 training time: 6.636
---------------
2023-09-12 09:57:55.703142
current #epochs=33, #steps=256
start validation
acc: 0.636364
AUC: 0.842287
Avg Precision: 0.355208
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.170827
valid_loss: 1.126730
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.00022236399409496924
Epoch-33 lr: 0.001111819970474846
epoch 33 training time: 6.500
---------------
2023-09-12 09:58:02.203835
current #epochs=34, #steps=264
start validation
acc: 0.613636
AUC: 0.842975
Avg Precision: 0.357981
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.162179
valid_loss: 1.126371
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.00022236399409496924
Epoch-34 lr: 0.001111819970474846
epoch 34 training time: 6.550
---------------
2023-09-12 09:58:08.753823
current #epochs=35, #steps=272
start validation
acc: 0.613636
AUC: 0.843664
Avg Precision: 0.374515
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.188284
valid_loss: 1.125455
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.00015925582364478523
Epoch-35 lr: 0.0007962791182239262
epoch 35 training time: 6.477
---------------
2023-09-12 09:58:15.230796
current #epochs=36, #steps=280
start validation
acc: 0.613636
AUC: 0.840909
Avg Precision: 0.369080
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.142602
valid_loss: 1.125464
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.00015925582364478523
Epoch-36 lr: 0.0007962791182239262
epoch 36 training time: 7.407
---------------
2023-09-12 09:58:22.637776
current #epochs=37, #steps=288
start validation
[I 2023-09-12 09:58:28,958] Trial 57 finished with value: 0.7727272727272727 and parameters: {'warmup': 'False', 'num_epochs': 37, 'batch_size': 19, 'lr-adaptschedule': 'False', 'lr': 0.0032123112290088555, 'head-lr': 5, 'lr-scheduler-start': 3, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.7161942934734695}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.636364
AUC: 0.838154
Avg Precision: 0.360937
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.094878
valid_loss: 1.125494
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.00015925582364478523
Epoch-37 lr: 0.0007962791182239262
epoch 37 training time: 6.315
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8ebaaf0>
The learning rate scheduler starts at 3 epoch with decay rate of 0.730 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 09:58:28.994932
current #epochs=1, #steps=0
start validation
acc: 0.590909
AUC: 0.848485
Avg Precision: 0.398836
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.267702
valid_loss: 1.149635
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003041763696985344
Epoch-1 lr: 0.01520881848492672
epoch 1 training time: 8.739
---------------
2023-09-12 09:58:37.734401
current #epochs=2, #steps=8
start validation
acc: 0.590909
AUC: 0.805785
Avg Precision: 0.358519
Avg Recall: 1.000000
d_prime: 1.219715
train_loss: 0.200451
valid_loss: 1.164599
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003041763696985344
Epoch-2 lr: 0.01520881848492672
epoch 2 training time: 6.439
---------------
2023-09-12 09:58:44.173402
current #epochs=3, #steps=16
start validation
acc: 0.613636
AUC: 0.818182
Avg Precision: 0.344885
Avg Recall: 1.000000
d_prime: 1.284753
train_loss: 0.204425
valid_loss: 1.164650
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002219383601286279
Epoch-3 lr: 0.011096918006431396
epoch 3 training time: 8.812
---------------
2023-09-12 09:58:52.986157
current #epochs=4, #steps=24
start validation
acc: 0.613636
AUC: 0.823691
Avg Precision: 0.330397
Avg Recall: 1.000000
d_prime: 1.314547
train_loss: 0.196035
valid_loss: 1.157440
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002219383601286279
Epoch-4 lr: 0.011096918006431396
epoch 4 training time: 6.299
---------------
2023-09-12 09:58:59.285359
current #epochs=5, #steps=32
start validation
acc: 0.613636
AUC: 0.816116
Avg Precision: 0.323838
Avg Recall: 1.000000
d_prime: 1.273727
train_loss: 0.223807
valid_loss: 1.166321
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002219383601286279
Epoch-5 lr: 0.011096918006431396
epoch 5 training time: 6.375
---------------
2023-09-12 09:59:05.660990
current #epochs=6, #steps=40
start validation
acc: 0.636364
AUC: 0.823003
Avg Precision: 0.329569
Avg Recall: 1.000000
d_prime: 1.310791
train_loss: 0.224680
valid_loss: 1.144514
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002219383601286279
Epoch-6 lr: 0.011096918006431396
epoch 6 training time: 11.058
---------------
2023-09-12 09:59:16.719328
current #epochs=7, #steps=48
start validation
acc: 0.545455
AUC: 0.821625
Avg Precision: 0.323249
Avg Recall: 1.000000
d_prime: 1.303307
train_loss: 0.158691
valid_loss: 1.150768
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002219383601286279
Epoch-7 lr: 0.011096918006431396
epoch 7 training time: 6.397
---------------
2023-09-12 09:59:23.115915
current #epochs=8, #steps=56
start validation
acc: 0.613636
AUC: 0.838843
Avg Precision: 0.343765
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.183531
valid_loss: 1.121877
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0016193445843739344
Epoch-8 lr: 0.008096722921869672
epoch 8 training time: 6.287
---------------
2023-09-12 09:59:29.403038
current #epochs=9, #steps=64
start validation
acc: 0.659091
AUC: 0.859504
Avg Precision: 0.376307
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.220228
valid_loss: 1.106463
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0016193445843739344
Epoch-9 lr: 0.008096722921869672
epoch 9 training time: 9.024
---------------
2023-09-12 09:59:38.427310
current #epochs=10, #steps=72
start validation
acc: 0.636364
AUC: 0.851928
Avg Precision: 0.391435
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.162714
valid_loss: 1.133223
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0016193445843739344
Epoch-10 lr: 0.008096722921869672
epoch 10 training time: 6.389
---------------
2023-09-12 09:59:44.815535
current #epochs=11, #steps=80
start validation
acc: 0.613636
AUC: 0.843664
Avg Precision: 0.357645
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.274340
valid_loss: 1.127494
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0016193445843739344
Epoch-11 lr: 0.008096722921869672
epoch 11 training time: 6.287
---------------
2023-09-12 09:59:51.102258
current #epochs=12, #steps=88
start validation
acc: 0.613636
AUC: 0.836088
Avg Precision: 0.341050
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.241248
valid_loss: 1.138523
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0016193445843739344
Epoch-12 lr: 0.008096722921869672
epoch 12 training time: 6.298
---------------
2023-09-12 09:59:57.400673
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01218	Per Sample Data Time 0.00636	Per Sample DNN Time 0.00581	Train Loss 0.2209	
start validation
acc: 0.636364
AUC: 0.833333
Avg Precision: 0.336078
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.222954
valid_loss: 1.151184
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0011815338643672991
Epoch-13 lr: 0.005907669321836495
epoch 13 training time: 6.497
---------------
2023-09-12 10:00:03.898011
current #epochs=14, #steps=104
start validation
acc: 0.613636
AUC: 0.837466
Avg Precision: 0.352381
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.215948
valid_loss: 1.145930
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0011815338643672991
Epoch-14 lr: 0.005907669321836495
epoch 14 training time: 6.408
---------------
2023-09-12 10:00:10.306011
current #epochs=15, #steps=112
start validation
acc: 0.659091
AUC: 0.836777
Avg Precision: 0.355234
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.141163
valid_loss: 1.140504
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0011815338643672991
Epoch-15 lr: 0.005907669321836495
epoch 15 training time: 6.307
---------------
2023-09-12 10:00:16.612874
current #epochs=16, #steps=120
start validation
acc: 0.659091
AUC: 0.838843
Avg Precision: 0.348552
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.177637
valid_loss: 1.138983
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0011815338643672991
Epoch-16 lr: 0.005907669321836495
epoch 16 training time: 6.311
---------------
2023-09-12 10:00:22.923887
current #epochs=17, #steps=128
start validation
acc: 0.681818
AUC: 0.836777
Avg Precision: 0.348552
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.170308
valid_loss: 1.134250
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0011815338643672991
Epoch-17 lr: 0.005907669321836495
epoch 17 training time: 9.181
---------------
2023-09-12 10:00:32.105346
current #epochs=18, #steps=136
start validation
acc: 0.659091
AUC: 0.839532
Avg Precision: 0.350015
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.155675
valid_loss: 1.131259
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0008620909262412784
Epoch-18 lr: 0.004310454631206392
epoch 18 training time: 6.571
---------------
2023-09-12 10:00:38.676851
current #epochs=19, #steps=144
start validation
acc: 0.704545
AUC: 0.840909
Avg Precision: 0.362437
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.214359
valid_loss: 1.126007
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0008620909262412784
Epoch-19 lr: 0.004310454631206392
epoch 19 training time: 8.865
---------------
2023-09-12 10:00:47.541731
current #epochs=20, #steps=152
start validation
acc: 0.659091
AUC: 0.840220
Avg Precision: 0.360889
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.180366
valid_loss: 1.120436
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0008620909262412784
Epoch-20 lr: 0.004310454631206392
epoch 20 training time: 7.673
---------------
2023-09-12 10:00:55.214474
current #epochs=21, #steps=160
start validation
acc: 0.704545
AUC: 0.842975
Avg Precision: 0.366361
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.106461
valid_loss: 1.118017
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0008620909262412784
Epoch-21 lr: 0.004310454631206392
epoch 21 training time: 6.389
---------------
2023-09-12 10:01:01.603874
current #epochs=22, #steps=168
start validation
acc: 0.659091
AUC: 0.842975
Avg Precision: 0.381726
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.114803
valid_loss: 1.120342
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0008620909262412784
Epoch-22 lr: 0.004310454631206392
epoch 22 training time: 6.417
---------------
2023-09-12 10:01:08.020188
current #epochs=23, #steps=176
start validation
acc: 0.659091
AUC: 0.840220
Avg Precision: 0.364863
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.162824
valid_loss: 1.123777
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.000629013511606392
Epoch-23 lr: 0.00314506755803196
epoch 23 training time: 7.244
---------------
2023-09-12 10:01:15.264736
current #epochs=24, #steps=184
start validation
acc: 0.636364
AUC: 0.840909
Avg Precision: 0.367635
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.183232
valid_loss: 1.124256
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.000629013511606392
Epoch-24 lr: 0.00314506755803196
epoch 24 training time: 6.360
---------------
2023-09-12 10:01:21.624550
current #epochs=25, #steps=192
start validation
acc: 0.636364
AUC: 0.839532
Avg Precision: 0.362287
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.122094
valid_loss: 1.123929
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.000629013511606392
Epoch-25 lr: 0.00314506755803196
epoch 25 training time: 7.165
---------------
2023-09-12 10:01:28.789402
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03535	Per Sample Data Time 0.02937	Per Sample DNN Time 0.00598	Train Loss 0.1007	
start validation
acc: 0.659091
AUC: 0.840909
Avg Precision: 0.364050
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.117489
valid_loss: 1.125900
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.000629013511606392
Epoch-26 lr: 0.00314506755803196
epoch 26 training time: 7.273
---------------
2023-09-12 10:01:36.062181
current #epochs=27, #steps=208
start validation
acc: 0.659091
AUC: 0.842287
Avg Precision: 0.369292
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.131141
valid_loss: 1.123621
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.000629013511606392
Epoch-27 lr: 0.00314506755803196
epoch 27 training time: 6.469
---------------
2023-09-12 10:01:42.531299
current #epochs=28, #steps=216
start validation
acc: 0.659091
AUC: 0.840909
Avg Precision: 0.361443
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.143445
valid_loss: 1.122219
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00045895158589416535
Epoch-28 lr: 0.002294757929470827
epoch 28 training time: 6.441
---------------
2023-09-12 10:01:48.972004
current #epochs=29, #steps=224
start validation
acc: 0.636364
AUC: 0.833333
Avg Precision: 0.354252
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.149241
valid_loss: 1.126262
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00045895158589416535
Epoch-29 lr: 0.002294757929470827
epoch 29 training time: 6.155
---------------
2023-09-12 10:01:55.127548
current #epochs=30, #steps=232
start validation
acc: 0.659091
AUC: 0.829890
Avg Precision: 0.362400
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.145492
valid_loss: 1.131217
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00045895158589416535
Epoch-30 lr: 0.002294757929470827
epoch 30 training time: 6.414
---------------
2023-09-12 10:02:01.541071
current #epochs=31, #steps=240
start validation
acc: 0.636364
AUC: 0.829890
Avg Precision: 0.362400
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.101010
valid_loss: 1.136470
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.00045895158589416535
Epoch-31 lr: 0.002294757929470827
epoch 31 training time: 8.345
---------------
2023-09-12 10:02:09.886111
current #epochs=32, #steps=248
start validation
acc: 0.636364
AUC: 0.830579
Avg Precision: 0.359628
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.112732
valid_loss: 1.133460
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00045895158589416535
Epoch-32 lr: 0.002294757929470827
epoch 32 training time: 7.656
---------------
2023-09-12 10:02:17.542017
current #epochs=33, #steps=256
start validation
acc: 0.681818
AUC: 0.831956
Avg Precision: 0.363266
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.146519
valid_loss: 1.129802
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0003348680979154804
Epoch-33 lr: 0.0016743404895774021
epoch 33 training time: 6.443
---------------
2023-09-12 10:02:23.985297
current #epochs=34, #steps=264
start validation
acc: 0.659091
AUC: 0.833333
Avg Precision: 0.362952
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.114989
valid_loss: 1.132085
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0003348680979154804
Epoch-34 lr: 0.0016743404895774021
epoch 34 training time: 6.361
---------------
2023-09-12 10:02:30.346030
current #epochs=35, #steps=272
start validation
acc: 0.681818
AUC: 0.830579
Avg Precision: 0.362952
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.112996
valid_loss: 1.132958
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0003348680979154804
Epoch-35 lr: 0.0016743404895774021
epoch 35 training time: 6.317
---------------
2023-09-12 10:02:36.662921
current #epochs=36, #steps=280
start validation
acc: 0.659091
AUC: 0.828512
Avg Precision: 0.362952
Avg Recall: 1.000000
d_prime: 1.341103
train_loss: 0.100527
valid_loss: 1.133576
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0003348680979154804
Epoch-36 lr: 0.0016743404895774021
epoch 36 training time: 6.366
---------------
2023-09-12 10:02:43.029280
current #epochs=37, #steps=288
start validation
acc: 0.681818
AUC: 0.829201
Avg Precision: 0.363266
Avg Recall: 1.000000
d_prime: 1.344935
train_loss: 0.132501
valid_loss: 1.131632
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0003348680979154804
Epoch-37 lr: 0.0016743404895774021
epoch 37 training time: 6.215
---------------
2023-09-12 10:02:49.244682
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01172	Per Sample Data Time 0.00597	Per Sample DNN Time 0.00575	Train Loss 0.1585	
start validation
acc: 0.681818
AUC: 0.830579
Avg Precision: 0.361807
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.149892
valid_loss: 1.120611
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0002443321832804181
Epoch-38 lr: 0.0012216609164020908
epoch 38 training time: 7.194
---------------
2023-09-12 10:02:56.438138
current #epochs=39, #steps=304
start validation
acc: 0.681818
AUC: 0.832645
Avg Precision: 0.374186
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.196939
valid_loss: 1.120275
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0002443321832804181
Epoch-39 lr: 0.0012216609164020908
epoch 39 training time: 7.532
---------------
2023-09-12 10:03:03.969973
current #epochs=40, #steps=312
start validation
[I 2023-09-12 10:03:10,395] Trial 58 finished with value: 0.7045454545454546 and parameters: {'warmup': 'False', 'num_epochs': 40, 'batch_size': 19, 'lr-adaptschedule': 'False', 'lr': 0.003041763696985344, 'head-lr': 5, 'lr-scheduler-start': 3, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.7296370863673217}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.704545
AUC: 0.834022
Avg Precision: 0.371552
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.152451
valid_loss: 1.120340
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0002443321832804181
Epoch-40 lr: 0.0012216609164020908
epoch 40 training time: 6.420
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8edc0a0>
The learning rate scheduler starts at 3 epoch with decay rate of 0.745 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 10:03:10.431990
current #epochs=1, #steps=0
start validation
acc: 0.590909
AUC: 0.838154
Avg Precision: 0.422209
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.216903
valid_loss: 1.149446
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002735245348181679
Epoch-1 lr: 0.010940981392726716
epoch 1 training time: 8.851
---------------
2023-09-12 10:03:19.283106
current #epochs=2, #steps=8
start validation
acc: 0.613636
AUC: 0.842975
Avg Precision: 0.377445
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.256061
valid_loss: 1.132180
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002735245348181679
Epoch-2 lr: 0.010940981392726716
epoch 2 training time: 11.483
---------------
2023-09-12 10:03:30.765757
current #epochs=3, #steps=16
start validation
acc: 0.659091
AUC: 0.864325
Avg Precision: 0.429763
Avg Recall: 1.000000
d_prime: 1.555577
train_loss: 0.204900
valid_loss: 1.106245
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002038146762787081
Epoch-3 lr: 0.008152587051148324
epoch 3 training time: 10.385
---------------
2023-09-12 10:03:41.150825
current #epochs=4, #steps=24
start validation
acc: 0.613636
AUC: 0.868457
Avg Precision: 0.429763
Avg Recall: 1.000000
d_prime: 1.582686
train_loss: 0.240507
valid_loss: 1.106279
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002038146762787081
Epoch-4 lr: 0.008152587051148324
epoch 4 training time: 6.516
---------------
2023-09-12 10:03:47.666376
current #epochs=5, #steps=32
start validation
acc: 0.659091
AUC: 0.845041
Avg Precision: 0.398657
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.179044
valid_loss: 1.123510
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002038146762787081
Epoch-5 lr: 0.008152587051148324
epoch 5 training time: 6.618
---------------
2023-09-12 10:03:54.284506
current #epochs=6, #steps=40
start validation
acc: 0.681818
AUC: 0.840909
Avg Precision: 0.379966
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.207053
valid_loss: 1.138349
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0015187091824947108
Epoch-6 lr: 0.006074836729978843
epoch 6 training time: 9.587
---------------
2023-09-12 10:04:03.871585
current #epochs=7, #steps=48
start validation
acc: 0.681818
AUC: 0.831956
Avg Precision: 0.368699
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.158807
valid_loss: 1.136878
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0015187091824947108
Epoch-7 lr: 0.006074836729978843
epoch 7 training time: 7.779
---------------
2023-09-12 10:04:11.650528
current #epochs=8, #steps=56
start validation
acc: 0.659091
AUC: 0.833333
Avg Precision: 0.358514
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.193216
valid_loss: 1.151186
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0015187091824947108
Epoch-8 lr: 0.006074836729978843
epoch 8 training time: 6.386
---------------
2023-09-12 10:04:18.036877
current #epochs=9, #steps=64
start validation
acc: 0.636364
AUC: 0.818182
Avg Precision: 0.342996
Avg Recall: 1.000000
d_prime: 1.284753
train_loss: 0.190150
valid_loss: 1.153921
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0011316543161198757
Epoch-9 lr: 0.004526617264479503
epoch 9 training time: 6.388
---------------
2023-09-12 10:04:24.424799
current #epochs=10, #steps=72
start validation
acc: 0.636364
AUC: 0.826446
Avg Precision: 0.352137
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.152633
valid_loss: 1.146585
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0011316543161198757
Epoch-10 lr: 0.004526617264479503
epoch 10 training time: 6.332
---------------
2023-09-12 10:04:30.756874
current #epochs=11, #steps=80
start validation
acc: 0.659091
AUC: 0.831956
Avg Precision: 0.350929
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.134653
valid_loss: 1.141841
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0011316543161198757
Epoch-11 lr: 0.004526617264479503
epoch 11 training time: 6.327
---------------
2023-09-12 10:04:37.084247
current #epochs=12, #steps=88
start validation
acc: 0.659091
AUC: 0.838843
Avg Precision: 0.364725
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.138062
valid_loss: 1.133157
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0008432433977182486
Epoch-12 lr: 0.0033729735908729942
epoch 12 training time: 6.196
---------------
2023-09-12 10:04:43.279707
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01161	Per Sample Data Time 0.00618	Per Sample DNN Time 0.00544	Train Loss 0.1862	
start validation
acc: 0.636364
AUC: 0.849174
Avg Precision: 0.375842
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.149442
valid_loss: 1.127752
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0008432433977182486
Epoch-13 lr: 0.0033729735908729942
epoch 13 training time: 6.499
---------------
2023-09-12 10:04:49.778360
current #epochs=14, #steps=104
start validation
acc: 0.613636
AUC: 0.843664
Avg Precision: 0.380897
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.126904
valid_loss: 1.126497
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0008432433977182486
Epoch-14 lr: 0.0033729735908729942
epoch 14 training time: 7.232
---------------
2023-09-12 10:04:57.010058
current #epochs=15, #steps=112
start validation
acc: 0.636364
AUC: 0.841598
Avg Precision: 0.382390
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.182669
valid_loss: 1.131787
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0006283362486818758
Epoch-15 lr: 0.0025133449947275033
epoch 15 training time: 6.275
---------------
2023-09-12 10:05:03.285245
current #epochs=16, #steps=120
start validation
acc: 0.636364
AUC: 0.840220
Avg Precision: 0.380973
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.086524
valid_loss: 1.128577
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0006283362486818758
Epoch-16 lr: 0.0025133449947275033
epoch 16 training time: 6.915
---------------
2023-09-12 10:05:10.200633
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.842287
Avg Precision: 0.383930
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.121171
valid_loss: 1.133625
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0006283362486818758
Epoch-17 lr: 0.0025133449947275033
epoch 17 training time: 6.802
---------------
2023-09-12 10:05:17.002244
current #epochs=18, #steps=136
start validation
acc: 0.590909
AUC: 0.839532
Avg Precision: 0.382621
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.155939
valid_loss: 1.140266
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0004681998607708377
Epoch-18 lr: 0.001872799443083351
epoch 18 training time: 6.385
---------------
2023-09-12 10:05:23.386715
current #epochs=19, #steps=144
start validation
acc: 0.590909
AUC: 0.830579
Avg Precision: 0.369695
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.103601
valid_loss: 1.149596
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0004681998607708377
Epoch-19 lr: 0.001872799443083351
epoch 19 training time: 6.348
---------------
2023-09-12 10:05:29.734562
current #epochs=20, #steps=152
start validation
acc: 0.613636
AUC: 0.826446
Avg Precision: 0.367739
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.189336
valid_loss: 1.153526
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0004681998607708377
Epoch-20 lr: 0.001872799443083351
epoch 20 training time: 8.584
---------------
2023-09-12 10:05:38.318594
current #epochs=21, #steps=160
start validation
acc: 0.613636
AUC: 0.827824
Avg Precision: 0.364101
Avg Recall: 1.000000
d_prime: 1.337280
train_loss: 0.138738
valid_loss: 1.148345
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0003488754788311084
Epoch-21 lr: 0.0013955019153244336
epoch 21 training time: 6.394
---------------
2023-09-12 10:05:44.712558
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.829201
Avg Precision: 0.358859
Avg Recall: 1.000000
d_prime: 1.344935
train_loss: 0.135550
valid_loss: 1.143130
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0003488754788311084
Epoch-22 lr: 0.0013955019153244336
epoch 22 training time: 6.422
---------------
2023-09-12 10:05:51.134499
current #epochs=23, #steps=176
start validation
acc: 0.659091
AUC: 0.836088
Avg Precision: 0.362776
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.131345
valid_loss: 1.137531
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0003488754788311084
Epoch-23 lr: 0.0013955019153244336
epoch 23 training time: 6.465
---------------
2023-09-12 10:05:57.599599
current #epochs=24, #steps=184
start validation
acc: 0.681818
AUC: 0.835399
Avg Precision: 0.359337
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.116671
valid_loss: 1.135021
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00025996184520270206
Epoch-24 lr: 0.0010398473808108082
epoch 24 training time: 6.374
---------------
2023-09-12 10:06:03.973315
current #epochs=25, #steps=192
start validation
acc: 0.659091
AUC: 0.836088
Avg Precision: 0.366361
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.221236
valid_loss: 1.134154
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00025996184520270206
Epoch-25 lr: 0.0010398473808108082
epoch 25 training time: 6.558
---------------
2023-09-12 10:06:10.531148
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03593	Per Sample Data Time 0.02996	Per Sample DNN Time 0.00597	Train Loss 0.1701	
start validation
acc: 0.636364
AUC: 0.838154
Avg Precision: 0.371955
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.189433
valid_loss: 1.133803
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00025996184520270206
Epoch-26 lr: 0.0010398473808108082
epoch 26 training time: 7.235
---------------
2023-09-12 10:06:17.766505
current #epochs=27, #steps=208
start validation
acc: 0.636364
AUC: 0.840909
Avg Precision: 0.376186
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.146696
valid_loss: 1.132681
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00019370854376930677
Epoch-27 lr: 0.0007748341750772271
epoch 27 training time: 6.345
---------------
2023-09-12 10:06:24.111489
current #epochs=28, #steps=216
start validation
acc: 0.636364
AUC: 0.840909
Avg Precision: 0.376186
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.111553
valid_loss: 1.131020
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00019370854376930677
Epoch-28 lr: 0.0007748341750772271
epoch 28 training time: 6.463
---------------
2023-09-12 10:06:30.574836
current #epochs=29, #steps=224
start validation
acc: 0.613636
AUC: 0.840909
Avg Precision: 0.376186
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.211418
valid_loss: 1.129218
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00019370854376930677
Epoch-29 lr: 0.0007748341750772271
epoch 29 training time: 6.291
---------------
2023-09-12 10:06:36.866029
current #epochs=30, #steps=232
start validation
acc: 0.636364
AUC: 0.842975
Avg Precision: 0.376186
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.161902
valid_loss: 1.128057
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00014434041234000065
Epoch-30 lr: 0.0005773616493600026
epoch 30 training time: 6.439
---------------
2023-09-12 10:06:43.304588
current #epochs=31, #steps=240
start validation
acc: 0.636364
AUC: 0.842975
Avg Precision: 0.376186
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.081190
valid_loss: 1.129084
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.00014434041234000065
Epoch-31 lr: 0.0005773616493600026
epoch 31 training time: 6.839
---------------
2023-09-12 10:06:50.144023
current #epochs=32, #steps=248
start validation
acc: 0.636364
AUC: 0.843664
Avg Precision: 0.376186
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.168493
valid_loss: 1.129016
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00014434041234000065
Epoch-32 lr: 0.0005773616493600026
epoch 32 training time: 6.566
---------------
2023-09-12 10:06:56.710452
current #epochs=33, #steps=256
start validation
acc: 0.636364
AUC: 0.843664
Avg Precision: 0.376186
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.176136
valid_loss: 1.129491
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.00010755413379852477
Epoch-33 lr: 0.0004302165351940991
epoch 33 training time: 7.531
---------------
2023-09-12 10:07:04.240985
current #epochs=34, #steps=264
start validation
acc: 0.636364
AUC: 0.842287
Avg Precision: 0.368038
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.089129
valid_loss: 1.129023
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.00010755413379852477
Epoch-34 lr: 0.0004302165351940991
epoch 34 training time: 7.280
---------------
2023-09-12 10:07:11.520567
current #epochs=35, #steps=272
start validation
acc: 0.636364
AUC: 0.842975
Avg Precision: 0.366163
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.108514
valid_loss: 1.127889
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.00010755413379852477
Epoch-35 lr: 0.0004302165351940991
epoch 35 training time: 6.441
---------------
2023-09-12 10:07:17.961664
current #epochs=36, #steps=280
start validation
acc: 0.636364
AUC: 0.844353
Avg Precision: 0.366163
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.180024
valid_loss: 1.127249
validation finished
normal learning rate scheduler step
Epoch-36 lr: 8.01431249198752e-05
Epoch-36 lr: 0.0003205724996795008
epoch 36 training time: 6.463
---------------
2023-09-12 10:07:24.424718
current #epochs=37, #steps=288
start validation
acc: 0.659091
AUC: 0.845041
Avg Precision: 0.366163
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.185246
valid_loss: 1.126870
validation finished
normal learning rate scheduler step
Epoch-37 lr: 8.01431249198752e-05
Epoch-37 lr: 0.0003205724996795008
epoch 37 training time: 6.392
---------------
2023-09-12 10:07:30.816840
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01169	Per Sample Data Time 0.00593	Per Sample DNN Time 0.00575	Train Loss 0.1692	
start validation
acc: 0.659091
AUC: 0.845041
Avg Precision: 0.368019
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.150194
valid_loss: 1.127180
validation finished
normal learning rate scheduler step
Epoch-38 lr: 8.01431249198752e-05
Epoch-38 lr: 0.0003205724996795008
epoch 38 training time: 6.357
---------------
2023-09-12 10:07:37.174143
current #epochs=39, #steps=304
start validation
acc: 0.659091
AUC: 0.843664
Avg Precision: 0.368019
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.192114
valid_loss: 1.128052
validation finished
normal learning rate scheduler step
Epoch-39 lr: 5.9718025194219174e-05
Epoch-39 lr: 0.0002388721007768767
epoch 39 training time: 6.773
---------------
2023-09-12 10:07:43.947581
current #epochs=40, #steps=312
start validation
acc: 0.659091
AUC: 0.843664
Avg Precision: 0.366163
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.137117
valid_loss: 1.128776
validation finished
normal learning rate scheduler step
Epoch-40 lr: 5.9718025194219174e-05
Epoch-40 lr: 0.0002388721007768767
epoch 40 training time: 6.542
---------------
2023-09-12 10:07:50.489243
current #epochs=41, #steps=320
start validation
acc: 0.659091
AUC: 0.840909
Avg Precision: 0.362776
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.124329
valid_loss: 1.129023
validation finished
normal learning rate scheduler step
Epoch-41 lr: 5.9718025194219174e-05
Epoch-41 lr: 0.0002388721007768767
epoch 41 training time: 6.388
---------------
2023-09-12 10:07:56.877898
current #epochs=42, #steps=328
start validation
acc: 0.659091
AUC: 0.838843
Avg Precision: 0.362776
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.125079
valid_loss: 1.129683
validation finished
normal learning rate scheduler step
Epoch-42 lr: 4.4498421251515e-05
Epoch-42 lr: 0.00017799368500606
epoch 42 training time: 6.418
---------------
2023-09-12 10:08:03.296225
current #epochs=43, #steps=336
start validation
acc: 0.659091
AUC: 0.840220
Avg Precision: 0.362776
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.124500
valid_loss: 1.130119
validation finished
normal learning rate scheduler step
Epoch-43 lr: 4.4498421251515e-05
Epoch-43 lr: 0.00017799368500606
epoch 43 training time: 6.433
---------------
2023-09-12 10:08:09.729335
current #epochs=44, #steps=344
start validation
acc: 0.659091
AUC: 0.842287
Avg Precision: 0.362776
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.170826
valid_loss: 1.130342
validation finished
normal learning rate scheduler step
Epoch-44 lr: 4.4498421251515e-05
Epoch-44 lr: 0.00017799368500606
epoch 44 training time: 6.363
---------------
2023-09-12 10:08:16.092413
current #epochs=45, #steps=352
start validation
acc: 0.659091
AUC: 0.841598
Avg Precision: 0.362776
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.125857
valid_loss: 1.130584
validation finished
normal learning rate scheduler step
Epoch-45 lr: 3.315765193904905e-05
Epoch-45 lr: 0.0001326306077561962
epoch 45 training time: 6.479
---------------
2023-09-12 10:08:22.571194
current #epochs=46, #steps=360
start validation
acc: 0.681818
AUC: 0.842287
Avg Precision: 0.362776
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.095175
valid_loss: 1.130663
validation finished
normal learning rate scheduler step
Epoch-46 lr: 3.315765193904905e-05
Epoch-46 lr: 0.0001326306077561962
epoch 46 training time: 6.291
---------------
2023-09-12 10:08:28.862295
current #epochs=47, #steps=368
start validation
acc: 0.681818
AUC: 0.842287
Avg Precision: 0.362776
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.109660
valid_loss: 1.130793
validation finished
normal learning rate scheduler step
Epoch-47 lr: 3.315765193904905e-05
Epoch-47 lr: 0.0001326306077561962
epoch 47 training time: 6.465
---------------
2023-09-12 10:08:35.327443
current #epochs=48, #steps=376
start validation
[I 2023-09-12 10:08:41,692] Trial 59 finished with value: 0.6818181818181818 and parameters: {'warmup': 'False', 'num_epochs': 48, 'batch_size': 12, 'lr-adaptschedule': 'False', 'lr': 0.002735245348181679, 'head-lr': 4, 'lr-scheduler-start': 3, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.7451422096895216}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.681818
AUC: 0.841598
Avg Precision: 0.362776
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.125152
valid_loss: 1.130872
validation finished
normal learning rate scheduler step
Epoch-48 lr: 2.4707166033979062e-05
Epoch-48 lr: 9.882866413591625e-05
epoch 48 training time: 6.359
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8e14a90>
The learning rate scheduler starts at 4 epoch with decay rate of 0.711 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 10:08:41.732251
current #epochs=1, #steps=0
start validation
acc: 0.590909
AUC: 0.826446
Avg Precision: 0.433808
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.239693
valid_loss: 1.154578
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0023373530020979003
Epoch-1 lr: 0.007012059006293701
epoch 1 training time: 9.127
---------------
2023-09-12 10:08:50.859920
current #epochs=2, #steps=8
start validation
acc: 0.681818
AUC: 0.846419
Avg Precision: 0.367658
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.229923
valid_loss: 1.131658
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0023373530020979003
Epoch-2 lr: 0.007012059006293701
epoch 2 training time: 9.486
---------------
2023-09-12 10:09:00.346308
current #epochs=3, #steps=16
start validation
acc: 0.636364
AUC: 0.837466
Avg Precision: 0.367689
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.281221
valid_loss: 1.146024
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0023373530020979003
Epoch-3 lr: 0.007012059006293701
epoch 3 training time: 8.365
---------------
2023-09-12 10:09:08.711684
current #epochs=4, #steps=24
start validation
acc: 0.659091
AUC: 0.831267
Avg Precision: 0.333387
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.208180
valid_loss: 1.144176
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0016622047725820149
Epoch-4 lr: 0.004986614317746045
epoch 4 training time: 6.535
---------------
2023-09-12 10:09:15.246206
current #epochs=5, #steps=32
start validation
acc: 0.659091
AUC: 0.820937
Avg Precision: 0.319364
Avg Recall: 1.000000
d_prime: 1.299578
train_loss: 0.194512
valid_loss: 1.155100
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0016622047725820149
Epoch-5 lr: 0.004986614317746045
epoch 5 training time: 6.336
---------------
2023-09-12 10:09:21.582576
current #epochs=6, #steps=40
start validation
acc: 0.659091
AUC: 0.820248
Avg Precision: 0.324424
Avg Recall: 1.000000
d_prime: 1.295859
train_loss: 0.188230
valid_loss: 1.156896
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0016622047725820149
Epoch-6 lr: 0.004986614317746045
epoch 6 training time: 6.418
---------------
2023-09-12 10:09:28.001073
current #epochs=7, #steps=48
start validation
acc: 0.636364
AUC: 0.824380
Avg Precision: 0.337202
Avg Recall: 1.000000
d_prime: 1.318312
train_loss: 0.157936
valid_loss: 1.150242
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0016622047725820149
Epoch-7 lr: 0.004986614317746045
epoch 7 training time: 6.544
---------------
2023-09-12 10:09:34.544648
current #epochs=8, #steps=56
start validation
acc: 0.590909
AUC: 0.823691
Avg Precision: 0.344932
Avg Recall: 1.000000
d_prime: 1.314547
train_loss: 0.202657
valid_loss: 1.151650
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0011820742110903034
Epoch-8 lr: 0.003546222633270911
epoch 8 training time: 6.408
---------------
2023-09-12 10:09:40.952618
current #epochs=9, #steps=64
start validation
acc: 0.590909
AUC: 0.825758
Avg Precision: 0.340066
Avg Recall: 1.000000
d_prime: 1.325871
train_loss: 0.120744
valid_loss: 1.140632
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0011820742110903034
Epoch-9 lr: 0.003546222633270911
epoch 9 training time: 6.846
---------------
2023-09-12 10:09:47.798993
current #epochs=10, #steps=72
start validation
acc: 0.659091
AUC: 0.825758
Avg Precision: 0.328251
Avg Recall: 1.000000
d_prime: 1.325871
train_loss: 0.131204
valid_loss: 1.141582
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0011820742110903034
Epoch-10 lr: 0.003546222633270911
epoch 10 training time: 6.448
---------------
2023-09-12 10:09:54.246993
current #epochs=11, #steps=80
start validation
acc: 0.613636
AUC: 0.829890
Avg Precision: 0.331790
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.104949
valid_loss: 1.138617
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0011820742110903034
Epoch-11 lr: 0.003546222633270911
epoch 11 training time: 7.794
---------------
2023-09-12 10:10:02.041142
current #epochs=12, #steps=88
start validation
acc: 0.636364
AUC: 0.835399
Avg Precision: 0.334562
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.151150
valid_loss: 1.132684
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0008406301459201346
Epoch-12 lr: 0.002521890437760404
epoch 12 training time: 6.581
---------------
2023-09-12 10:10:08.622377
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01167	Per Sample Data Time 0.00612	Per Sample DNN Time 0.00555	Train Loss 0.1344	
start validation
acc: 0.681818
AUC: 0.836777
Avg Precision: 0.336827
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.139006
valid_loss: 1.131521
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0008406301459201346
Epoch-13 lr: 0.002521890437760404
epoch 13 training time: 6.561
---------------
2023-09-12 10:10:15.183656
current #epochs=14, #steps=104
start validation
acc: 0.659091
AUC: 0.848485
Avg Precision: 0.351003
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.117866
valid_loss: 1.126624
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0008406301459201346
Epoch-14 lr: 0.002521890437760404
epoch 14 training time: 6.516
---------------
2023-09-12 10:10:21.699827
current #epochs=15, #steps=112
start validation
acc: 0.613636
AUC: 0.839532
Avg Precision: 0.333306
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.152842
valid_loss: 1.134462
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0008406301459201346
Epoch-15 lr: 0.002521890437760404
epoch 15 training time: 6.453
---------------
2023-09-12 10:10:28.153050
current #epochs=16, #steps=120
start validation
acc: 0.636364
AUC: 0.835399
Avg Precision: 0.329849
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.152090
valid_loss: 1.137455
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0005978127562548797
Epoch-16 lr: 0.0017934382687646393
epoch 16 training time: 6.369
---------------
2023-09-12 10:10:34.521980
current #epochs=17, #steps=128
start validation
acc: 0.613636
AUC: 0.837466
Avg Precision: 0.329849
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.109691
valid_loss: 1.136421
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0005978127562548797
Epoch-17 lr: 0.0017934382687646393
epoch 17 training time: 6.754
---------------
2023-09-12 10:10:41.275671
current #epochs=18, #steps=136
start validation
acc: 0.613636
AUC: 0.837466
Avg Precision: 0.329849
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.093109
valid_loss: 1.135277
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0005978127562548797
Epoch-18 lr: 0.0017934382687646393
epoch 18 training time: 6.993
---------------
2023-09-12 10:10:48.268920
current #epochs=19, #steps=144
start validation
acc: 0.613636
AUC: 0.842975
Avg Precision: 0.339239
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.186007
valid_loss: 1.132785
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0005978127562548797
Epoch-19 lr: 0.0017934382687646393
epoch 19 training time: 6.969
---------------
2023-09-12 10:10:55.238209
current #epochs=20, #steps=152
start validation
acc: 0.613636
AUC: 0.842287
Avg Precision: 0.344411
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.190101
valid_loss: 1.131881
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00042513356590355927
Epoch-20 lr: 0.001275400697710678
epoch 20 training time: 6.632
---------------
2023-09-12 10:11:01.870440
current #epochs=21, #steps=160
start validation
acc: 0.636364
AUC: 0.841598
Avg Precision: 0.342556
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.119153
valid_loss: 1.132720
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00042513356590355927
Epoch-21 lr: 0.001275400697710678
epoch 21 training time: 6.563
---------------
2023-09-12 10:11:08.433363
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.838843
Avg Precision: 0.342556
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.157392
valid_loss: 1.130975
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00042513356590355927
Epoch-22 lr: 0.001275400697710678
epoch 22 training time: 6.630
---------------
2023-09-12 10:11:15.063761
current #epochs=23, #steps=176
start validation
acc: 0.613636
AUC: 0.841598
Avg Precision: 0.342556
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.149892
valid_loss: 1.129890
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00042513356590355927
Epoch-23 lr: 0.001275400697710678
epoch 23 training time: 6.368
---------------
2023-09-12 10:11:21.431331
current #epochs=24, #steps=184
start validation
acc: 0.613636
AUC: 0.840220
Avg Precision: 0.342556
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.104689
valid_loss: 1.128148
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0003023330415198056
Epoch-24 lr: 0.000906999124559417
epoch 24 training time: 6.476
---------------
2023-09-12 10:11:27.907398
current #epochs=25, #steps=192
start validation
acc: 0.636364
AUC: 0.840220
Avg Precision: 0.342556
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.145937
valid_loss: 1.129379
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0003023330415198056
Epoch-25 lr: 0.000906999124559417
epoch 25 training time: 6.619
---------------
2023-09-12 10:11:34.526020
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03561	Per Sample Data Time 0.02958	Per Sample DNN Time 0.00603	Train Loss 0.0333	
start validation
acc: 0.659091
AUC: 0.838154
Avg Precision: 0.339599
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.069701
valid_loss: 1.130514
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0003023330415198056
Epoch-26 lr: 0.000906999124559417
epoch 26 training time: 6.473
---------------
2023-09-12 10:11:40.999442
current #epochs=27, #steps=208
start validation
acc: 0.636364
AUC: 0.835399
Avg Precision: 0.339599
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.159401
valid_loss: 1.133846
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0003023330415198056
Epoch-27 lr: 0.000906999124559417
epoch 27 training time: 6.375
---------------
2023-09-12 10:11:47.374693
current #epochs=28, #steps=216
start validation
acc: 0.636364
AUC: 0.834711
Avg Precision: 0.336642
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.122237
valid_loss: 1.136311
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00021500364903050638
Epoch-28 lr: 0.0006450109470915191
epoch 28 training time: 6.619
---------------
2023-09-12 10:11:53.993413
current #epochs=29, #steps=224
start validation
acc: 0.636364
AUC: 0.836088
Avg Precision: 0.336642
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.120042
valid_loss: 1.136104
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00021500364903050638
Epoch-29 lr: 0.0006450109470915191
epoch 29 training time: 6.406
---------------
2023-09-12 10:12:00.398794
current #epochs=30, #steps=232
start validation
[I 2023-09-12 10:12:08,411] Trial 60 finished with value: 0.6818181818181818 and parameters: {'warmup': 'False', 'num_epochs': 30, 'batch_size': 22, 'lr-adaptschedule': 'False', 'lr': 0.0023373530020979003, 'head-lr': 3, 'lr-scheduler-start': 4, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.7111483678717321}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.613636
AUC: 0.834711
Avg Precision: 0.327658
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.175325
valid_loss: 1.132375
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00021500364903050638
Epoch-30 lr: 0.0006450109470915191
epoch 30 training time: 8.007
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f956e070dc0>
The learning rate scheduler starts at 3 epoch with decay rate of 0.720 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 10:12:08.448922
current #epochs=1, #steps=0
start validation
acc: 0.590909
AUC: 0.814738
Avg Precision: 0.318349
Avg Recall: 1.000000
d_prime: 1.266419
train_loss: 0.218380
valid_loss: 1.154294
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0032809073685915037
Epoch-1 lr: 0.016404536842957517
epoch 1 training time: 10.522
---------------
2023-09-12 10:12:18.970897
current #epochs=2, #steps=8
start validation
acc: 0.681818
AUC: 0.802342
Avg Precision: 0.288885
Avg Recall: 1.000000
d_prime: 1.202103
train_loss: 0.298125
valid_loss: 1.165005
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0032809073685915037
Epoch-2 lr: 0.016404536842957517
epoch 2 training time: 9.088
---------------
2023-09-12 10:12:28.058837
current #epochs=3, #steps=16
start validation
acc: 0.659091
AUC: 0.820248
Avg Precision: 0.332460
Avg Recall: 1.000000
d_prime: 1.295859
train_loss: 0.302274
valid_loss: 1.151258
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0023631553071037205
Epoch-3 lr: 0.011815776535518602
epoch 3 training time: 6.353
---------------
2023-09-12 10:12:34.411723
current #epochs=4, #steps=24
start validation
acc: 0.636364
AUC: 0.801653
Avg Precision: 0.367802
Avg Recall: 1.000000
d_prime: 1.198603
train_loss: 0.261350
valid_loss: 1.175512
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0023631553071037205
Epoch-4 lr: 0.011815776535518602
epoch 4 training time: 6.316
---------------
2023-09-12 10:12:40.727666
current #epochs=5, #steps=32
start validation
acc: 0.590909
AUC: 0.804408
Avg Precision: 0.343595
Avg Recall: 1.000000
d_prime: 1.212647
train_loss: 0.163289
valid_loss: 1.170524
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0023631553071037205
Epoch-5 lr: 0.011815776535518602
epoch 5 training time: 6.393
---------------
2023-09-12 10:12:47.120717
current #epochs=6, #steps=40
start validation
acc: 0.568182
AUC: 0.830579
Avg Precision: 0.380106
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.221413
valid_loss: 1.150491
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0023631553071037205
Epoch-6 lr: 0.011815776535518602
epoch 6 training time: 6.889
---------------
2023-09-12 10:12:54.009902
current #epochs=7, #steps=48
start validation
acc: 0.568182
AUC: 0.825758
Avg Precision: 0.420461
Avg Recall: 1.000000
d_prime: 1.325871
train_loss: 0.212520
valid_loss: 1.138556
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.001702121510333866
Epoch-7 lr: 0.008510607551669328
epoch 7 training time: 6.531
---------------
2023-09-12 10:13:00.540677
current #epochs=8, #steps=56
start validation
acc: 0.568182
AUC: 0.845730
Avg Precision: 0.399147
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.172001
valid_loss: 1.131755
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001702121510333866
Epoch-8 lr: 0.008510607551669328
epoch 8 training time: 8.038
---------------
2023-09-12 10:13:08.578242
current #epochs=9, #steps=64
start validation
acc: 0.590909
AUC: 0.842975
Avg Precision: 0.391493
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.214279
valid_loss: 1.133550
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001702121510333866
Epoch-9 lr: 0.008510607551669328
epoch 9 training time: 6.406
---------------
2023-09-12 10:13:14.983759
current #epochs=10, #steps=72
start validation
acc: 0.659091
AUC: 0.840909
Avg Precision: 0.384555
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.259710
valid_loss: 1.146711
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001702121510333866
Epoch-10 lr: 0.008510607551669328
epoch 10 training time: 6.605
---------------
2023-09-12 10:13:21.588584
current #epochs=11, #steps=80
start validation
acc: 0.613636
AUC: 0.841598
Avg Precision: 0.361638
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.204949
valid_loss: 1.145252
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001225995442293662
Epoch-11 lr: 0.00612997721146831
epoch 11 training time: 6.627
---------------
2023-09-12 10:13:28.215585
current #epochs=12, #steps=88
start validation
acc: 0.681818
AUC: 0.841598
Avg Precision: 0.369677
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.182537
valid_loss: 1.138054
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001225995442293662
Epoch-12 lr: 0.00612997721146831
epoch 12 training time: 7.102
---------------
2023-09-12 10:13:35.317715
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01197	Per Sample Data Time 0.00617	Per Sample DNN Time 0.00579	Train Loss 0.1812	
start validation
acc: 0.613636
AUC: 0.842975
Avg Precision: 0.377002
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.170029
valid_loss: 1.142734
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.001225995442293662
Epoch-13 lr: 0.00612997721146831
epoch 13 training time: 8.048
---------------
2023-09-12 10:13:43.365267
current #epochs=14, #steps=104
start validation
acc: 0.636364
AUC: 0.843664
Avg Precision: 0.370937
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.159428
valid_loss: 1.143891
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.001225995442293662
Epoch-14 lr: 0.00612997721146831
epoch 14 training time: 6.551
---------------
2023-09-12 10:13:49.916758
current #epochs=15, #steps=112
start validation
acc: 0.636364
AUC: 0.839532
Avg Precision: 0.357381
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.129222
valid_loss: 1.150620
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0008830537745980372
Epoch-15 lr: 0.004415268872990185
epoch 15 training time: 6.405
---------------
2023-09-12 10:13:56.322099
current #epochs=16, #steps=120
start validation
acc: 0.681818
AUC: 0.840909
Avg Precision: 0.356216
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.139136
valid_loss: 1.152486
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0008830537745980372
Epoch-16 lr: 0.004415268872990185
epoch 16 training time: 7.780
---------------
2023-09-12 10:14:04.101843
current #epochs=17, #steps=128
start validation
acc: 0.659091
AUC: 0.836777
Avg Precision: 0.353611
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.175265
valid_loss: 1.142034
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0008830537745980372
Epoch-17 lr: 0.004415268872990185
epoch 17 training time: 6.452
---------------
2023-09-12 10:14:10.554427
current #epochs=18, #steps=136
start validation
acc: 0.590909
AUC: 0.834711
Avg Precision: 0.360446
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.122793
valid_loss: 1.139536
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0008830537745980372
Epoch-18 lr: 0.004415268872990185
epoch 18 training time: 6.483
---------------
2023-09-12 10:14:17.037335
current #epochs=19, #steps=144
start validation
acc: 0.613636
AUC: 0.836777
Avg Precision: 0.360474
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.094113
valid_loss: 1.143534
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0006360414908011214
Epoch-19 lr: 0.0031802074540056065
epoch 19 training time: 6.703
---------------
2023-09-12 10:14:23.740197
current #epochs=20, #steps=152
start validation
acc: 0.568182
AUC: 0.833333
Avg Precision: 0.363808
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.179494
valid_loss: 1.146767
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0006360414908011214
Epoch-20 lr: 0.0031802074540056065
epoch 20 training time: 8.972
---------------
2023-09-12 10:14:32.712596
current #epochs=21, #steps=160
start validation
acc: 0.636364
AUC: 0.834022
Avg Precision: 0.366765
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.128061
valid_loss: 1.153204
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0006360414908011214
Epoch-21 lr: 0.0031802074540056065
epoch 21 training time: 8.704
---------------
2023-09-12 10:14:41.416638
current #epochs=22, #steps=168
start validation
acc: 0.613636
AUC: 0.842975
Avg Precision: 0.363808
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.180770
valid_loss: 1.145439
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0006360414908011214
Epoch-22 lr: 0.0031802074540056065
epoch 22 training time: 6.454
---------------
2023-09-12 10:14:47.870722
current #epochs=23, #steps=176
start validation
acc: 0.590909
AUC: 0.844353
Avg Precision: 0.372109
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.211272
valid_loss: 1.138495
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00045812473674625544
Epoch-23 lr: 0.0022906236837312768
epoch 23 training time: 6.481
---------------
2023-09-12 10:14:54.351814
current #epochs=24, #steps=184
start validation
acc: 0.590909
AUC: 0.847107
Avg Precision: 0.387372
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.141025
valid_loss: 1.133461
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00045812473674625544
Epoch-24 lr: 0.0022906236837312768
epoch 24 training time: 6.524
---------------
2023-09-12 10:15:00.875790
current #epochs=25, #steps=192
start validation
acc: 0.590909
AUC: 0.854683
Avg Precision: 0.402396
Avg Recall: 1.000000
d_prime: 1.494446
train_loss: 0.148601
valid_loss: 1.128750
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00045812473674625544
Epoch-25 lr: 0.0022906236837312768
epoch 25 training time: 6.618
---------------
2023-09-12 10:15:07.494245
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03751	Per Sample Data Time 0.03142	Per Sample DNN Time 0.00610	Train Loss 0.1806	
start validation
acc: 0.613636
AUC: 0.859504
Avg Precision: 0.406314
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.168181
valid_loss: 1.125034
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00045812473674625544
Epoch-26 lr: 0.0022906236837312768
epoch 26 training time: 6.732
---------------
2023-09-12 10:15:14.226203
current #epochs=27, #steps=208
start validation
acc: 0.613636
AUC: 0.861570
Avg Precision: 0.405306
Avg Recall: 1.000000
d_prime: 1.537818
train_loss: 0.164708
valid_loss: 1.127063
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0003299757601575256
Epoch-27 lr: 0.0016498788007876276
epoch 27 training time: 7.690
---------------
2023-09-12 10:15:21.916395
current #epochs=28, #steps=216
start validation
acc: 0.590909
AUC: 0.860193
Avg Precision: 0.392211
Avg Recall: 1.000000
d_prime: 1.529028
train_loss: 0.130149
valid_loss: 1.129400
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0003299757601575256
Epoch-28 lr: 0.0016498788007876276
epoch 28 training time: 6.483
---------------
2023-09-12 10:15:28.399394
current #epochs=29, #steps=224
start validation
acc: 0.613636
AUC: 0.855372
Avg Precision: 0.386482
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.147739
valid_loss: 1.130618
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0003299757601575256
Epoch-29 lr: 0.0016498788007876276
epoch 29 training time: 6.533
---------------
2023-09-12 10:15:34.932287
current #epochs=30, #steps=232
start validation
acc: 0.613636
AUC: 0.849862
Avg Precision: 0.380530
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.150244
valid_loss: 1.133239
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0003299757601575256
Epoch-30 lr: 0.0016498788007876276
epoch 30 training time: 7.755
---------------
2023-09-12 10:15:42.687438
current #epochs=31, #steps=240
start validation
acc: 0.613636
AUC: 0.851240
Avg Precision: 0.392806
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.152578
valid_loss: 1.134219
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.00023767326572423256
Epoch-31 lr: 0.0011883663286211626
epoch 31 training time: 6.288
---------------
2023-09-12 10:15:48.975704
current #epochs=32, #steps=248
start validation
acc: 0.613636
AUC: 0.847796
Avg Precision: 0.392806
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.102522
valid_loss: 1.136293
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00023767326572423256
Epoch-32 lr: 0.0011883663286211626
epoch 32 training time: 6.366
---------------
2023-09-12 10:15:55.341446
current #epochs=33, #steps=256
start validation
acc: 0.613636
AUC: 0.847796
Avg Precision: 0.392806
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.140614
valid_loss: 1.136729
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.00023767326572423256
Epoch-33 lr: 0.0011883663286211626
epoch 33 training time: 6.481
---------------
2023-09-12 10:16:01.822747
current #epochs=34, #steps=264
start validation
acc: 0.613636
AUC: 0.846419
Avg Precision: 0.392806
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.137785
valid_loss: 1.136698
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.00023767326572423256
Epoch-34 lr: 0.0011883663286211626
epoch 34 training time: 6.518
---------------
2023-09-12 10:16:08.341259
current #epochs=35, #steps=272
start validation
acc: 0.613636
AUC: 0.848485
Avg Precision: 0.396444
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.137566
valid_loss: 1.137250
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.00017119009351794457
Epoch-35 lr: 0.0008559504675897228
epoch 35 training time: 6.429
---------------
2023-09-12 10:16:14.770099
current #epochs=36, #steps=280
start validation
[I 2023-09-12 10:16:21,197] Trial 61 finished with value: 0.6818181818181818 and parameters: {'warmup': 'False', 'num_epochs': 36, 'batch_size': 25, 'lr-adaptschedule': 'False', 'lr': 0.0032809073685915037, 'head-lr': 5, 'lr-scheduler-start': 3, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.720274924469515}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.613636
AUC: 0.848485
Avg Precision: 0.396444
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.140835
valid_loss: 1.138106
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.00017119009351794457
Epoch-36 lr: 0.0008559504675897228
epoch 36 training time: 6.421
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c856aca0>
The learning rate scheduler starts at 4 epoch with decay rate of 0.699 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 10:16:21.234432
current #epochs=1, #steps=0
start validation
acc: 0.613636
AUC: 0.831956
Avg Precision: 0.367485
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.362307
valid_loss: 1.157884
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003187511615129357
Epoch-1 lr: 0.015937558075646785
epoch 1 training time: 9.077
---------------
2023-09-12 10:16:30.311452
current #epochs=2, #steps=8
start validation
acc: 0.590909
AUC: 0.847107
Avg Precision: 0.375776
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.286438
valid_loss: 1.143189
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003187511615129357
Epoch-2 lr: 0.015937558075646785
epoch 2 training time: 6.355
---------------
2023-09-12 10:16:36.666625
current #epochs=3, #steps=16
start validation
acc: 0.636364
AUC: 0.834711
Avg Precision: 0.362789
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.308098
valid_loss: 1.142204
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003187511615129357
Epoch-3 lr: 0.015937558075646785
epoch 3 training time: 9.171
---------------
2023-09-12 10:16:45.837459
current #epochs=4, #steps=24
start validation
acc: 0.636364
AUC: 0.849174
Avg Precision: 0.438923
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.269371
valid_loss: 1.117424
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0022287681552527984
Epoch-4 lr: 0.011143840776263993
epoch 4 training time: 6.298
---------------
2023-09-12 10:16:52.135803
current #epochs=5, #steps=32
start validation
acc: 0.636364
AUC: 0.831956
Avg Precision: 0.415274
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.285237
valid_loss: 1.141908
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0022287681552527984
Epoch-5 lr: 0.011143840776263993
epoch 5 training time: 6.394
---------------
2023-09-12 10:16:58.529785
current #epochs=6, #steps=40
start validation
acc: 0.636364
AUC: 0.829201
Avg Precision: 0.397482
Avg Recall: 1.000000
d_prime: 1.344935
train_loss: 0.328540
valid_loss: 1.143325
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0015583966710243258
Epoch-6 lr: 0.00779198335512163
epoch 6 training time: 6.930
---------------
2023-09-12 10:17:05.459697
current #epochs=7, #steps=48
start validation
acc: 0.636364
AUC: 0.833333
Avg Precision: 0.366765
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.200424
valid_loss: 1.145290
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0015583966710243258
Epoch-7 lr: 0.00779198335512163
epoch 7 training time: 6.518
---------------
2023-09-12 10:17:11.977449
current #epochs=8, #steps=56
start validation
acc: 0.636364
AUC: 0.831267
Avg Precision: 0.368916
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.211113
valid_loss: 1.138399
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0010896603033994068
Epoch-8 lr: 0.0054483015169970355
epoch 8 training time: 6.424
---------------
2023-09-12 10:17:18.402192
current #epochs=9, #steps=64
start validation
acc: 0.636364
AUC: 0.835399
Avg Precision: 0.373163
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.176591
valid_loss: 1.143604
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0010896603033994068
Epoch-9 lr: 0.0054483015169970355
epoch 9 training time: 6.356
---------------
2023-09-12 10:17:24.758654
current #epochs=10, #steps=72
start validation
acc: 0.636364
AUC: 0.836088
Avg Precision: 0.383895
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.170302
valid_loss: 1.144390
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0007619110069222891
Epoch-10 lr: 0.0038095550346114466
epoch 10 training time: 6.328
---------------
2023-09-12 10:17:31.087203
current #epochs=11, #steps=80
start validation
acc: 0.636364
AUC: 0.840220
Avg Precision: 0.398895
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.159866
valid_loss: 1.142885
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0007619110069222891
Epoch-11 lr: 0.0038095550346114466
epoch 11 training time: 6.438
---------------
2023-09-12 10:17:37.525698
current #epochs=12, #steps=88
start validation
acc: 0.636364
AUC: 0.839532
Avg Precision: 0.398895
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.172963
valid_loss: 1.142394
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0005327425259581614
Epoch-12 lr: 0.0026637126297908075
epoch 12 training time: 6.598
---------------
2023-09-12 10:17:44.123532
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01146	Per Sample Data Time 0.00596	Per Sample DNN Time 0.00550	Train Loss 0.1464	
start validation
acc: 0.636364
AUC: 0.839532
Avg Precision: 0.402812
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.153907
valid_loss: 1.140725
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0005327425259581614
Epoch-13 lr: 0.0026637126297908075
epoch 13 training time: 7.465
---------------
2023-09-12 10:17:51.588559
current #epochs=14, #steps=104
start validation
acc: 0.636364
AUC: 0.838154
Avg Precision: 0.396064
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.149414
valid_loss: 1.141038
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0003725036078829477
Epoch-14 lr: 0.0018625180394147391
epoch 14 training time: 6.356
---------------
2023-09-12 10:17:57.944141
current #epochs=15, #steps=112
start validation
acc: 0.636364
AUC: 0.838843
Avg Precision: 0.396064
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.197816
valid_loss: 1.139475
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0003725036078829477
Epoch-15 lr: 0.0018625180394147391
epoch 15 training time: 6.685
---------------
2023-09-12 10:18:04.629062
current #epochs=16, #steps=120
start validation
acc: 0.636364
AUC: 0.836088
Avg Precision: 0.396064
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.103573
valid_loss: 1.140486
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.000260461538406848
Epoch-16 lr: 0.0013023076920342404
epoch 16 training time: 6.444
---------------
2023-09-12 10:18:11.073213
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.837466
Avg Precision: 0.391082
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.133572
valid_loss: 1.141981
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.000260461538406848
Epoch-17 lr: 0.0013023076920342404
epoch 17 training time: 6.357
---------------
2023-09-12 10:18:17.430625
current #epochs=18, #steps=136
start validation
acc: 0.636364
AUC: 0.838843
Avg Precision: 0.386027
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.164811
valid_loss: 1.140169
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00018211961321614763
Epoch-18 lr: 0.0009105980660807384
epoch 18 training time: 6.438
---------------
2023-09-12 10:18:23.868342
current #epochs=19, #steps=144
start validation
acc: 0.636364
AUC: 0.838843
Avg Precision: 0.386027
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.170965
valid_loss: 1.140223
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00018211961321614763
Epoch-19 lr: 0.0009105980660807384
epoch 19 training time: 6.624
---------------
2023-09-12 10:18:30.492571
current #epochs=20, #steps=152
start validation
acc: 0.636364
AUC: 0.840909
Avg Precision: 0.391009
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.134997
valid_loss: 1.139547
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00012734146362212832
Epoch-20 lr: 0.0006367073181106418
epoch 20 training time: 6.399
---------------
2023-09-12 10:18:36.891900
current #epochs=21, #steps=160
start validation
acc: 0.636364
AUC: 0.840909
Avg Precision: 0.391009
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.124391
valid_loss: 1.138995
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00012734146362212832
Epoch-21 lr: 0.0006367073181106418
epoch 21 training time: 6.497
---------------
2023-09-12 10:18:43.388545
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.840909
Avg Precision: 0.391009
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.183739
valid_loss: 1.139121
validation finished
normal learning rate scheduler step
Epoch-22 lr: 8.90395497281237e-05
Epoch-22 lr: 0.0004451977486406186
epoch 22 training time: 6.426
---------------
2023-09-12 10:18:49.814361
current #epochs=23, #steps=176
start validation
acc: 0.636364
AUC: 0.840909
Avg Precision: 0.388478
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.184828
valid_loss: 1.139160
validation finished
normal learning rate scheduler step
Epoch-23 lr: 8.90395497281237e-05
Epoch-23 lr: 0.0004451977486406186
epoch 23 training time: 6.444
---------------
2023-09-12 10:18:56.258554
current #epochs=24, #steps=184
start validation
acc: 0.636364
AUC: 0.839532
Avg Precision: 0.386027
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.141133
valid_loss: 1.139398
validation finished
normal learning rate scheduler step
Epoch-24 lr: 6.225813015085641e-05
Epoch-24 lr: 0.0003112906507542822
epoch 24 training time: 6.600
---------------
2023-09-12 10:19:02.858605
current #epochs=25, #steps=192
start validation
acc: 0.636364
AUC: 0.839532
Avg Precision: 0.386027
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.146284
valid_loss: 1.139365
validation finished
normal learning rate scheduler step
Epoch-25 lr: 6.225813015085641e-05
Epoch-25 lr: 0.0003112906507542822
epoch 25 training time: 9.380
---------------
2023-09-12 10:19:12.239112
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03598	Per Sample Data Time 0.03000	Per Sample DNN Time 0.00598	Train Loss 0.1378	
start validation
acc: 0.636364
AUC: 0.840220
Avg Precision: 0.386027
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.166038
valid_loss: 1.139118
validation finished
normal learning rate scheduler step
Epoch-26 lr: 4.353205717814512e-05
Epoch-26 lr: 0.0002176602858907257
epoch 26 training time: 6.499
---------------
2023-09-12 10:19:18.737504
current #epochs=27, #steps=208
start validation
acc: 0.636364
AUC: 0.840220
Avg Precision: 0.388478
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.099505
valid_loss: 1.139385
validation finished
normal learning rate scheduler step
Epoch-27 lr: 4.353205717814512e-05
Epoch-27 lr: 0.0002176602858907257
epoch 27 training time: 6.745
---------------
2023-09-12 10:19:25.482407
current #epochs=28, #steps=216
start validation
acc: 0.636364
AUC: 0.838843
Avg Precision: 0.388478
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.152284
valid_loss: 1.139725
validation finished
normal learning rate scheduler step
Epoch-28 lr: 3.04384342666486e-05
Epoch-28 lr: 0.00015219217133324305
epoch 28 training time: 8.208
---------------
2023-09-12 10:19:33.690177
current #epochs=29, #steps=224
start validation
acc: 0.636364
AUC: 0.838154
Avg Precision: 0.388478
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.141329
valid_loss: 1.139853
validation finished
normal learning rate scheduler step
Epoch-29 lr: 3.04384342666486e-05
Epoch-29 lr: 0.00015219217133324305
epoch 29 training time: 7.740
---------------
2023-09-12 10:19:41.429613
current #epochs=30, #steps=232
start validation
acc: 0.636364
AUC: 0.838154
Avg Precision: 0.388478
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.149126
valid_loss: 1.140020
validation finished
normal learning rate scheduler step
Epoch-30 lr: 2.128312652015508e-05
Epoch-30 lr: 0.00010641563260077542
epoch 30 training time: 6.863
---------------
2023-09-12 10:19:48.292991
current #epochs=31, #steps=240
start validation
acc: 0.636364
AUC: 0.838843
Avg Precision: 0.388478
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.185064
valid_loss: 1.139935
validation finished
normal learning rate scheduler step
Epoch-31 lr: 2.128312652015508e-05
Epoch-31 lr: 0.00010641563260077542
epoch 31 training time: 6.416
---------------
2023-09-12 10:19:54.709649
current #epochs=32, #steps=248
start validation
acc: 0.636364
AUC: 0.838154
Avg Precision: 0.388478
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.105760
valid_loss: 1.140065
validation finished
normal learning rate scheduler step
Epoch-32 lr: 1.4881562911705001e-05
Epoch-32 lr: 7.440781455852502e-05
epoch 32 training time: 6.440
---------------
2023-09-12 10:20:01.150079
current #epochs=33, #steps=256
start validation
acc: 0.636364
AUC: 0.838843
Avg Precision: 0.388478
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.192995
valid_loss: 1.140153
validation finished
normal learning rate scheduler step
Epoch-33 lr: 1.4881562911705001e-05
Epoch-33 lr: 7.440781455852502e-05
epoch 33 training time: 6.438
---------------
2023-09-12 10:20:07.587728
current #epochs=34, #steps=264
start validation
acc: 0.636364
AUC: 0.838843
Avg Precision: 0.388478
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.186180
valid_loss: 1.140166
validation finished
normal learning rate scheduler step
Epoch-34 lr: 1.0405469068903517e-05
Epoch-34 lr: 5.20273453445176e-05
epoch 34 training time: 6.331
---------------
2023-09-12 10:20:13.919006
current #epochs=35, #steps=272
start validation
acc: 0.636364
AUC: 0.839532
Avg Precision: 0.388478
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.173615
valid_loss: 1.140112
validation finished
normal learning rate scheduler step
Epoch-35 lr: 1.0405469068903517e-05
Epoch-35 lr: 5.20273453445176e-05
epoch 35 training time: 6.485
---------------
2023-09-12 10:20:20.403497
current #epochs=36, #steps=280
start validation
acc: 0.636364
AUC: 0.839532
Avg Precision: 0.388478
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.152238
valid_loss: 1.140073
validation finished
normal learning rate scheduler step
Epoch-36 lr: 7.275699950758919e-06
Epoch-36 lr: 3.6378499753794604e-05
epoch 36 training time: 6.350
---------------
2023-09-12 10:20:26.753468
current #epochs=37, #steps=288
start validation
[I 2023-09-12 10:20:34,266] Trial 62 finished with value: 0.6363636363636364 and parameters: {'warmup': 'False', 'num_epochs': 37, 'batch_size': 26, 'lr-adaptschedule': 'False', 'lr': 0.003187511615129357, 'head-lr': 5, 'lr-scheduler-start': 4, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.6992188341131267}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.636364
AUC: 0.839532
Avg Precision: 0.388478
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.186249
valid_loss: 1.140093
validation finished
normal learning rate scheduler step
Epoch-37 lr: 7.275699950758919e-06
Epoch-37 lr: 3.6378499753794604e-05
epoch 37 training time: 7.507
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c856c760>
The learning rate scheduler starts at 5 epoch with decay rate of 0.719 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 10:20:34.304325
current #epochs=1, #steps=0
start validation
acc: 0.590909
AUC: 0.828512
Avg Precision: 0.391548
Avg Recall: 1.000000
d_prime: 1.341103
train_loss: 0.343323
valid_loss: 1.163379
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003848547772932128
Epoch-1 lr: 0.01924273886466064
epoch 1 training time: 9.472
---------------
2023-09-12 10:20:43.776565
current #epochs=2, #steps=8
start validation
acc: 0.545455
AUC: 0.803719
Avg Precision: 0.364484
Avg Recall: 1.000000
d_prime: 1.209125
train_loss: 0.291806
valid_loss: 1.176987
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003848547772932128
Epoch-2 lr: 0.01924273886466064
epoch 2 training time: 6.335
---------------
2023-09-12 10:20:50.111740
current #epochs=3, #steps=16
start validation
acc: 0.613636
AUC: 0.814738
Avg Precision: 0.455098
Avg Recall: 1.000000
d_prime: 1.266419
train_loss: 0.262001
valid_loss: 1.168973
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003848547772932128
Epoch-3 lr: 0.01924273886466064
epoch 3 training time: 9.269
---------------
2023-09-12 10:20:59.380872
current #epochs=4, #steps=24
start validation
acc: 0.636364
AUC: 0.831267
Avg Precision: 0.332406
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.363045
valid_loss: 1.135114
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003848547772932128
Epoch-4 lr: 0.01924273886466064
epoch 4 training time: 9.124
---------------
2023-09-12 10:21:08.504901
current #epochs=5, #steps=32
start validation
acc: 0.568182
AUC: 0.799587
Avg Precision: 0.337998
Avg Recall: 1.000000
d_prime: 1.188146
train_loss: 0.247200
valid_loss: 1.179623
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0027677638981092887
Epoch-5 lr: 0.013838819490546442
epoch 5 training time: 6.326
---------------
2023-09-12 10:21:14.830967
current #epochs=6, #steps=40
start validation
acc: 0.613636
AUC: 0.821625
Avg Precision: 0.332622
Avg Recall: 1.000000
d_prime: 1.303307
train_loss: 0.197042
valid_loss: 1.163321
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0027677638981092887
Epoch-6 lr: 0.013838819490546442
epoch 6 training time: 6.518
---------------
2023-09-12 10:21:21.348259
current #epochs=7, #steps=48
start validation
acc: 0.659091
AUC: 0.808540
Avg Precision: 0.314915
Avg Recall: 1.000000
d_prime: 1.233942
train_loss: 0.180954
valid_loss: 1.161685
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0027677638981092887
Epoch-7 lr: 0.013838819490546442
epoch 7 training time: 9.211
---------------
2023-09-12 10:21:30.559640
current #epochs=8, #steps=56
start validation
acc: 0.659091
AUC: 0.797521
Avg Precision: 0.295892
Avg Recall: 1.000000
d_prime: 1.177754
train_loss: 0.232943
valid_loss: 1.161690
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0027677638981092887
Epoch-8 lr: 0.013838819490546442
epoch 8 training time: 7.445
---------------
2023-09-12 10:21:38.004808
current #epochs=9, #steps=64
start validation
acc: 0.613636
AUC: 0.812672
Avg Precision: 0.334879
Avg Recall: 1.000000
d_prime: 1.255520
train_loss: 0.280396
valid_loss: 1.147703
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0027677638981092887
Epoch-9 lr: 0.013838819490546442
epoch 9 training time: 6.993
---------------
2023-09-12 10:21:44.998116
current #epochs=10, #steps=72
start validation
acc: 0.613636
AUC: 0.818871
Avg Precision: 0.346320
Avg Recall: 1.000000
d_prime: 1.288446
train_loss: 0.144986
valid_loss: 1.163594
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0019904954927558913
Epoch-10 lr: 0.009952477463779457
epoch 10 training time: 6.502
---------------
2023-09-12 10:21:51.499929
current #epochs=11, #steps=80
start validation
acc: 0.613636
AUC: 0.833333
Avg Precision: 0.369446
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.270506
valid_loss: 1.164419
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0019904954927558913
Epoch-11 lr: 0.009952477463779457
epoch 11 training time: 6.443
---------------
2023-09-12 10:21:57.942788
current #epochs=12, #steps=88
start validation
acc: 0.590909
AUC: 0.827135
Avg Precision: 0.345230
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.223394
valid_loss: 1.151480
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0019904954927558913
Epoch-12 lr: 0.009952477463779457
epoch 12 training time: 7.684
---------------
2023-09-12 10:22:05.626842
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01198	Per Sample Data Time 0.00655	Per Sample DNN Time 0.00544	Train Loss 0.1856	
start validation
acc: 0.636364
AUC: 0.809917
Avg Precision: 0.323404
Avg Recall: 1.000000
d_prime: 1.241102
train_loss: 0.192430
valid_loss: 1.153662
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0019904954927558913
Epoch-13 lr: 0.009952477463779457
epoch 13 training time: 6.477
---------------
2023-09-12 10:22:12.104287
current #epochs=14, #steps=104
start validation
acc: 0.681818
AUC: 0.833333
Avg Precision: 0.321066
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.153941
valid_loss: 1.140661
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0019904954927558913
Epoch-14 lr: 0.009952477463779457
epoch 14 training time: 9.119
---------------
2023-09-12 10:22:21.223427
current #epochs=15, #steps=112
start validation
acc: 0.704545
AUC: 0.847107
Avg Precision: 0.332842
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.160247
valid_loss: 1.111168
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0014315066069718173
Epoch-15 lr: 0.007157533034859088
epoch 15 training time: 11.231
---------------
2023-09-12 10:22:32.453908
current #epochs=16, #steps=120
start validation
acc: 0.727273
AUC: 0.857438
Avg Precision: 0.344059
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.147866
valid_loss: 1.103492
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0014315066069718173
Epoch-16 lr: 0.007157533034859088
epoch 16 training time: 9.175
---------------
2023-09-12 10:22:41.629411
current #epochs=17, #steps=128
start validation
acc: 0.681818
AUC: 0.849174
Avg Precision: 0.335300
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.169767
valid_loss: 1.111514
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0014315066069718173
Epoch-17 lr: 0.007157533034859088
epoch 17 training time: 7.494
---------------
2023-09-12 10:22:49.123310
current #epochs=18, #steps=136
start validation
acc: 0.659091
AUC: 0.850551
Avg Precision: 0.338181
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.138630
valid_loss: 1.115377
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0014315066069718173
Epoch-18 lr: 0.007157533034859088
epoch 18 training time: 6.385
---------------
2023-09-12 10:22:55.508587
current #epochs=19, #steps=144
start validation
acc: 0.681818
AUC: 0.850551
Avg Precision: 0.351729
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.201975
valid_loss: 1.113920
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0014315066069718173
Epoch-19 lr: 0.007157533034859088
epoch 19 training time: 6.461
---------------
2023-09-12 10:23:01.969408
current #epochs=20, #steps=152
start validation
acc: 0.636364
AUC: 0.848485
Avg Precision: 0.355234
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.191285
valid_loss: 1.130808
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0010294980185897233
Epoch-20 lr: 0.005147490092948618
epoch 20 training time: 6.623
---------------
2023-09-12 10:23:08.592469
current #epochs=21, #steps=160
start validation
acc: 0.659091
AUC: 0.845730
Avg Precision: 0.347842
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.111223
valid_loss: 1.128865
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0010294980185897233
Epoch-21 lr: 0.005147490092948618
epoch 21 training time: 6.644
---------------
2023-09-12 10:23:15.236257
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.838843
Avg Precision: 0.340363
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.231562
valid_loss: 1.124390
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0010294980185897233
Epoch-22 lr: 0.005147490092948618
epoch 22 training time: 6.533
---------------
2023-09-12 10:23:21.768549
current #epochs=23, #steps=176
start validation
acc: 0.681818
AUC: 0.839532
Avg Precision: 0.335681
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.178970
valid_loss: 1.118890
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0010294980185897233
Epoch-23 lr: 0.005147490092948618
epoch 23 training time: 6.709
---------------
2023-09-12 10:23:28.477703
current #epochs=24, #steps=184
start validation
acc: 0.636364
AUC: 0.838843
Avg Precision: 0.343982
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.133933
valid_loss: 1.116778
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0010294980185897233
Epoch-24 lr: 0.005147490092948618
epoch 24 training time: 6.545
---------------
2023-09-12 10:23:35.023101
current #epochs=25, #steps=192
start validation
acc: 0.636364
AUC: 0.835399
Avg Precision: 0.337611
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.201552
valid_loss: 1.121661
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0007403851055372965
Epoch-25 lr: 0.003701925527686484
epoch 25 training time: 8.526
---------------
2023-09-12 10:23:43.548838
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03520	Per Sample Data Time 0.02970	Per Sample DNN Time 0.00550	Train Loss 0.0789	
start validation
acc: 0.659091
AUC: 0.839532
Avg Precision: 0.334450
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.136142
valid_loss: 1.119581
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0007403851055372965
Epoch-26 lr: 0.003701925527686484
epoch 26 training time: 7.271
---------------
2023-09-12 10:23:50.819996
current #epochs=27, #steps=208
start validation
acc: 0.681818
AUC: 0.842975
Avg Precision: 0.334450
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.143760
valid_loss: 1.117447
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0007403851055372965
Epoch-27 lr: 0.003701925527686484
epoch 27 training time: 7.698
---------------
2023-09-12 10:23:58.518314
current #epochs=28, #steps=216
start validation
acc: 0.704545
AUC: 0.845730
Avg Precision: 0.337889
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.132388
valid_loss: 1.117545
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0007403851055372965
Epoch-28 lr: 0.003701925527686484
epoch 28 training time: 7.686
---------------
2023-09-12 10:24:06.204093
current #epochs=29, #steps=224
start validation
acc: 0.704545
AUC: 0.835399
Avg Precision: 0.332418
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.143106
valid_loss: 1.121753
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0007403851055372965
Epoch-29 lr: 0.003701925527686484
epoch 29 training time: 7.885
---------------
2023-09-12 10:24:14.088803
current #epochs=30, #steps=232
start validation
acc: 0.681818
AUC: 0.840220
Avg Precision: 0.331266
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.106677
valid_loss: 1.123481
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0005324634866732377
Epoch-30 lr: 0.0026623174333661897
epoch 30 training time: 8.141
---------------
2023-09-12 10:24:22.229552
current #epochs=31, #steps=240
start validation
acc: 0.704545
AUC: 0.840220
Avg Precision: 0.341454
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.146688
valid_loss: 1.120111
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0005324634866732377
Epoch-31 lr: 0.0026623174333661897
epoch 31 training time: 6.539
---------------
2023-09-12 10:24:28.768407
current #epochs=32, #steps=248
start validation
acc: 0.704545
AUC: 0.846419
Avg Precision: 0.347572
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.084182
valid_loss: 1.117140
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0005324634866732377
Epoch-32 lr: 0.0026623174333661897
epoch 32 training time: 9.556
---------------
2023-09-12 10:24:38.324701
current #epochs=33, #steps=256
start validation
acc: 0.659091
AUC: 0.848485
Avg Precision: 0.348878
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.106136
valid_loss: 1.115340
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0005324634866732377
Epoch-33 lr: 0.0026623174333661897
epoch 33 training time: 6.488
---------------
2023-09-12 10:24:44.812832
current #epochs=34, #steps=264
start validation
acc: 0.636364
AUC: 0.847796
Avg Precision: 0.342277
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.172233
valid_loss: 1.116920
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0005324634866732377
Epoch-34 lr: 0.0026623174333661897
epoch 34 training time: 7.172
---------------
2023-09-12 10:24:51.985234
current #epochs=35, #steps=272
start validation
acc: 0.659091
AUC: 0.851240
Avg Precision: 0.344885
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.138160
valid_loss: 1.118225
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0003829322909386096
Epoch-35 lr: 0.0019146614546930488
epoch 35 training time: 8.058
---------------
2023-09-12 10:25:00.043275
current #epochs=36, #steps=280
start validation
acc: 0.659091
AUC: 0.851928
Avg Precision: 0.344885
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.126480
valid_loss: 1.114013
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0003829322909386096
Epoch-36 lr: 0.0019146614546930488
epoch 36 training time: 6.362
---------------
2023-09-12 10:25:06.405188
current #epochs=37, #steps=288
start validation
acc: 0.681818
AUC: 0.852617
Avg Precision: 0.350447
Avg Recall: 1.000000
d_prime: 1.481705
train_loss: 0.116936
valid_loss: 1.112107
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0003829322909386096
Epoch-37 lr: 0.0019146614546930488
epoch 37 training time: 9.484
---------------
2023-09-12 10:25:15.888955
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01232	Per Sample Data Time 0.00647	Per Sample DNN Time 0.00585	Train Loss 0.1379	
start validation
acc: 0.681818
AUC: 0.856061
Avg Precision: 0.353219
Avg Recall: 1.000000
d_prime: 1.503007
train_loss: 0.157304
valid_loss: 1.109620
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0003829322909386096
Epoch-38 lr: 0.0019146614546930488
epoch 38 training time: 9.667
---------------
2023-09-12 10:25:25.555975
current #epochs=39, #steps=304
start validation
acc: 0.659091
AUC: 0.850551
Avg Precision: 0.349784
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.156300
valid_loss: 1.111846
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0003829322909386096
Epoch-39 lr: 0.0019146614546930488
epoch 39 training time: 6.479
---------------
2023-09-12 10:25:32.035069
current #epochs=40, #steps=312
start validation
acc: 0.681818
AUC: 0.849862
Avg Precision: 0.343374
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.094398
valid_loss: 1.116967
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.00027539379340292726
Epoch-40 lr: 0.0013769689670146369
epoch 40 training time: 6.522
---------------
2023-09-12 10:25:38.556909
current #epochs=41, #steps=320
start validation
[I 2023-09-12 10:25:48,729] Trial 63 finished with value: 0.7272727272727273 and parameters: {'warmup': 'False', 'num_epochs': 41, 'batch_size': 16, 'lr-adaptschedule': 'False', 'lr': 0.003848547772932128, 'head-lr': 5, 'lr-scheduler-start': 5, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.7191709864109566}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.681818
AUC: 0.849862
Avg Precision: 0.342626
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.087443
valid_loss: 1.116452
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.00027539379340292726
Epoch-41 lr: 0.0013769689670146369
epoch 41 training time: 10.167
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8dcea30>
The learning rate scheduler starts at 4 epoch with decay rate of 0.697 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 10:25:48.768658
current #epochs=1, #steps=0
start validation
acc: 0.636364
AUC: 0.844353
Avg Precision: 0.317295
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.304038
valid_loss: 1.106425
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003799413075150686
Epoch-1 lr: 0.015197652300602745
epoch 1 training time: 11.038
---------------
2023-09-12 10:25:59.806803
current #epochs=2, #steps=8
start validation
acc: 0.613636
AUC: 0.827135
Avg Precision: 0.325738
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.361505
valid_loss: 1.174134
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003799413075150686
Epoch-2 lr: 0.015197652300602745
epoch 2 training time: 6.406
---------------
2023-09-12 10:26:06.213077
current #epochs=3, #steps=16
start validation
acc: 0.590909
AUC: 0.842287
Avg Precision: 0.365898
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.291404
valid_loss: 1.135897
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003799413075150686
Epoch-3 lr: 0.015197652300602745
epoch 3 training time: 8.170
---------------
2023-09-12 10:26:14.382776
current #epochs=4, #steps=24
start validation
acc: 0.613636
AUC: 0.858815
Avg Precision: 0.434669
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.227677
valid_loss: 1.123344
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0026466164747925187
Epoch-4 lr: 0.010586465899170075
epoch 4 training time: 6.470
---------------
2023-09-12 10:26:20.852599
current #epochs=5, #steps=32
start validation
acc: 0.659091
AUC: 0.845041
Avg Precision: 0.373627
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.223005
valid_loss: 1.126807
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0026466164747925187
Epoch-5 lr: 0.010586465899170075
epoch 5 training time: 9.447
---------------
2023-09-12 10:26:30.299404
current #epochs=6, #steps=40
start validation
acc: 0.636364
AUC: 0.823691
Avg Precision: 0.322800
Avg Recall: 1.000000
d_prime: 1.314547
train_loss: 0.218837
valid_loss: 1.132808
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0026466164747925187
Epoch-6 lr: 0.010586465899170075
epoch 6 training time: 9.381
---------------
2023-09-12 10:26:39.680946
current #epochs=7, #steps=48
start validation
acc: 0.636364
AUC: 0.836088
Avg Precision: 0.378491
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.201795
valid_loss: 1.128382
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0026466164747925187
Epoch-7 lr: 0.010586465899170075
epoch 7 training time: 6.393
---------------
2023-09-12 10:26:46.073388
current #epochs=8, #steps=56
start validation
acc: 0.613636
AUC: 0.837466
Avg Precision: 0.403223
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.144020
valid_loss: 1.138149
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0026466164747925187
Epoch-8 lr: 0.010586465899170075
epoch 8 training time: 6.218
---------------
2023-09-12 10:26:52.291211
current #epochs=9, #steps=64
start validation
acc: 0.590909
AUC: 0.827824
Avg Precision: 0.387125
Avg Recall: 1.000000
d_prime: 1.337280
train_loss: 0.150469
valid_loss: 1.139959
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001843594951666416
Epoch-9 lr: 0.007374379806665664
epoch 9 training time: 6.327
---------------
2023-09-12 10:26:58.617925
current #epochs=10, #steps=72
start validation
acc: 0.590909
AUC: 0.811983
Avg Precision: 0.343491
Avg Recall: 1.000000
d_prime: 1.251903
train_loss: 0.204340
valid_loss: 1.162709
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001843594951666416
Epoch-10 lr: 0.007374379806665664
epoch 10 training time: 6.274
---------------
2023-09-12 10:27:04.891576
current #epochs=11, #steps=80
start validation
acc: 0.590909
AUC: 0.814738
Avg Precision: 0.337254
Avg Recall: 1.000000
d_prime: 1.266419
train_loss: 0.168139
valid_loss: 1.155014
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001843594951666416
Epoch-11 lr: 0.007374379806665664
epoch 11 training time: 8.835
---------------
2023-09-12 10:27:13.726867
current #epochs=12, #steps=88
start validation
acc: 0.636364
AUC: 0.825069
Avg Precision: 0.358224
Avg Recall: 1.000000
d_prime: 1.322087
train_loss: 0.147685
valid_loss: 1.145351
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001843594951666416
Epoch-12 lr: 0.007374379806665664
epoch 12 training time: 6.530
---------------
2023-09-12 10:27:20.257052
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01169	Per Sample Data Time 0.00623	Per Sample DNN Time 0.00547	Train Loss 0.1083	
start validation
acc: 0.613636
AUC: 0.831956
Avg Precision: 0.348732
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.116601
valid_loss: 1.133657
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.001843594951666416
Epoch-13 lr: 0.007374379806665664
epoch 13 training time: 6.422
---------------
2023-09-12 10:27:26.678615
current #epochs=14, #steps=104
start validation
acc: 0.613636
AUC: 0.829201
Avg Precision: 0.324147
Avg Recall: 1.000000
d_prime: 1.344935
train_loss: 0.105589
valid_loss: 1.134800
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.001284221714094917
Epoch-14 lr: 0.005136886856379668
epoch 14 training time: 6.500
---------------
2023-09-12 10:27:33.178330
current #epochs=15, #steps=112
start validation
acc: 0.681818
AUC: 0.838843
Avg Precision: 0.341884
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.196033
valid_loss: 1.128453
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.001284221714094917
Epoch-15 lr: 0.005136886856379668
epoch 15 training time: 10.902
---------------
2023-09-12 10:27:44.080240
current #epochs=16, #steps=120
start validation
acc: 0.704545
AUC: 0.843664
Avg Precision: 0.338498
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.149809
valid_loss: 1.118385
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.001284221714094917
Epoch-16 lr: 0.005136886856379668
epoch 16 training time: 8.987
---------------
2023-09-12 10:27:53.066723
current #epochs=17, #steps=128
start validation
acc: 0.681818
AUC: 0.847107
Avg Precision: 0.362962
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.189284
valid_loss: 1.117510
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.001284221714094917
Epoch-17 lr: 0.005136886856379668
epoch 17 training time: 6.568
---------------
2023-09-12 10:27:59.634654
current #epochs=18, #steps=136
start validation
acc: 0.659091
AUC: 0.847107
Avg Precision: 0.371852
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.124763
valid_loss: 1.107066
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001284221714094917
Epoch-18 lr: 0.005136886856379668
epoch 18 training time: 6.456
---------------
2023-09-12 10:28:06.090105
current #epochs=19, #steps=144
start validation
acc: 0.613636
AUC: 0.846419
Avg Precision: 0.372325
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.230941
valid_loss: 1.110319
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0008945703661545397
Epoch-19 lr: 0.0035782814646181586
epoch 19 training time: 7.372
---------------
2023-09-12 10:28:13.462393
current #epochs=20, #steps=152
start validation
acc: 0.590909
AUC: 0.845730
Avg Precision: 0.372325
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.102774
valid_loss: 1.114884
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0008945703661545397
Epoch-20 lr: 0.0035782814646181586
epoch 20 training time: 7.528
---------------
2023-09-12 10:28:20.990285
current #epochs=21, #steps=160
start validation
acc: 0.636364
AUC: 0.848485
Avg Precision: 0.377122
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.126037
valid_loss: 1.122555
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0008945703661545397
Epoch-21 lr: 0.0035782814646181586
epoch 21 training time: 6.478
---------------
2023-09-12 10:28:27.468339
current #epochs=22, #steps=168
start validation
acc: 0.659091
AUC: 0.844353
Avg Precision: 0.381842
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.169291
valid_loss: 1.124717
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0008945703661545397
Epoch-22 lr: 0.0035782814646181586
epoch 22 training time: 6.617
---------------
2023-09-12 10:28:34.085450
current #epochs=23, #steps=176
start validation
acc: 0.681818
AUC: 0.842975
Avg Precision: 0.379384
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.112038
valid_loss: 1.121281
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0008945703661545397
Epoch-23 lr: 0.0035782814646181586
epoch 23 training time: 7.582
---------------
2023-09-12 10:28:41.667356
current #epochs=24, #steps=184
start validation
acc: 0.659091
AUC: 0.838154
Avg Precision: 0.373432
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.169041
valid_loss: 1.127182
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0006231448442419968
Epoch-24 lr: 0.002492579376967987
epoch 24 training time: 9.889
---------------
2023-09-12 10:28:51.556310
current #epochs=25, #steps=192
start validation
acc: 0.636364
AUC: 0.840220
Avg Precision: 0.367997
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.109827
valid_loss: 1.135932
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0006231448442419968
Epoch-25 lr: 0.002492579376967987
epoch 25 training time: 6.534
---------------
2023-09-12 10:28:58.090854
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03712	Per Sample Data Time 0.03160	Per Sample DNN Time 0.00552	Train Loss 0.0889	
start validation
acc: 0.613636
AUC: 0.842975
Avg Precision: 0.358264
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.154934
valid_loss: 1.139185
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0006231448442419968
Epoch-26 lr: 0.002492579376967987
epoch 26 training time: 8.278
---------------
2023-09-12 10:29:06.368852
current #epochs=27, #steps=208
start validation
acc: 0.613636
AUC: 0.843664
Avg Precision: 0.359577
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.120366
valid_loss: 1.139562
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0006231448442419968
Epoch-27 lr: 0.002492579376967987
epoch 27 training time: 6.500
---------------
2023-09-12 10:29:12.868591
current #epochs=28, #steps=216
start validation
acc: 0.659091
AUC: 0.843664
Avg Precision: 0.362534
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.098025
valid_loss: 1.138741
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0006231448442419968
Epoch-28 lr: 0.002492579376967987
epoch 28 training time: 6.258
---------------
2023-09-12 10:29:19.126477
current #epochs=29, #steps=224
start validation
acc: 0.659091
AUC: 0.842975
Avg Precision: 0.362534
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.120339
valid_loss: 1.139900
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0004340737314769276
Epoch-29 lr: 0.0017362949259077103
epoch 29 training time: 9.178
---------------
2023-09-12 10:29:28.304555
current #epochs=30, #steps=232
start validation
acc: 0.659091
AUC: 0.839532
Avg Precision: 0.351824
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.178532
valid_loss: 1.138074
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0004340737314769276
Epoch-30 lr: 0.0017362949259077103
epoch 30 training time: 6.626
---------------
2023-09-12 10:29:34.930854
current #epochs=31, #steps=240
start validation
acc: 0.659091
AUC: 0.838154
Avg Precision: 0.351824
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.110537
valid_loss: 1.136753
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0004340737314769276
Epoch-31 lr: 0.0017362949259077103
epoch 31 training time: 7.915
---------------
2023-09-12 10:29:42.845858
current #epochs=32, #steps=248
start validation
acc: 0.636364
AUC: 0.832645
Avg Precision: 0.341975
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.130537
valid_loss: 1.132225
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0004340737314769276
Epoch-32 lr: 0.0017362949259077103
epoch 32 training time: 7.242
---------------
2023-09-12 10:29:50.088082
current #epochs=33, #steps=256
start validation
acc: 0.636364
AUC: 0.834022
Avg Precision: 0.352896
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.132146
valid_loss: 1.130962
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0004340737314769276
Epoch-33 lr: 0.0017362949259077103
epoch 33 training time: 8.122
---------------
2023-09-12 10:29:58.209913
current #epochs=34, #steps=264
start validation
acc: 0.636364
AUC: 0.838154
Avg Precision: 0.349301
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.117204
valid_loss: 1.134976
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0003023695150483045
Epoch-34 lr: 0.001209478060193218
epoch 34 training time: 8.733
---------------
2023-09-12 10:30:06.943322
current #epochs=35, #steps=272
start validation
acc: 0.659091
AUC: 0.838154
Avg Precision: 0.355698
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.130787
valid_loss: 1.135907
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0003023695150483045
Epoch-35 lr: 0.001209478060193218
epoch 35 training time: 10.205
---------------
2023-09-12 10:30:17.148406
current #epochs=36, #steps=280
start validation
acc: 0.681818
AUC: 0.839532
Avg Precision: 0.354597
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.129388
valid_loss: 1.134542
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0003023695150483045
Epoch-36 lr: 0.001209478060193218
epoch 36 training time: 6.443
---------------
2023-09-12 10:30:23.591762
current #epochs=37, #steps=288
start validation
acc: 0.681818
AUC: 0.842287
Avg Precision: 0.357554
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.103709
valid_loss: 1.134286
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0003023695150483045
Epoch-37 lr: 0.001209478060193218
epoch 37 training time: 6.451
---------------
2023-09-12 10:30:30.043045
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01164	Per Sample Data Time 0.00604	Per Sample DNN Time 0.00560	Train Loss 0.1428	
start validation
acc: 0.681818
AUC: 0.843664
Avg Precision: 0.357554
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.125720
valid_loss: 1.134525
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0003023695150483045
Epoch-38 lr: 0.001209478060193218
epoch 38 training time: 6.258
---------------
2023-09-12 10:30:36.301476
current #epochs=39, #steps=304
start validation
acc: 0.659091
AUC: 0.839532
Avg Precision: 0.357554
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.144609
valid_loss: 1.133826
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.00021062625310098155
Epoch-39 lr: 0.0008425050124039262
epoch 39 training time: 6.294
---------------
2023-09-12 10:30:42.595272
current #epochs=40, #steps=312
start validation
acc: 0.636364
AUC: 0.841598
Avg Precision: 0.365702
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.120928
valid_loss: 1.133263
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.00021062625310098155
Epoch-40 lr: 0.0008425050124039262
epoch 40 training time: 6.559
---------------
2023-09-12 10:30:49.154247
current #epochs=41, #steps=320
start validation
[I 2023-09-12 10:30:55,924] Trial 64 finished with value: 0.7045454545454546 and parameters: {'warmup': 'False', 'num_epochs': 41, 'batch_size': 17, 'lr-adaptschedule': 'False', 'lr': 0.003799413075150686, 'head-lr': 4, 'lr-scheduler-start': 4, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.6965856100517717}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.636364
AUC: 0.840220
Avg Precision: 0.363846
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.132021
valid_loss: 1.132090
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.00021062625310098155
Epoch-41 lr: 0.0008425050124039262
epoch 41 training time: 6.764
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f957c120b50>
The learning rate scheduler starts at 5 epoch with decay rate of 0.679 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 10:30:55.963174
current #epochs=1, #steps=0
start validation
acc: 0.590909
AUC: 0.833333
Avg Precision: 0.378449
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.278225
valid_loss: 1.129931
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.004063597428736782
Epoch-1 lr: 0.012190792286210346
epoch 1 training time: 9.962
---------------
2023-09-12 10:31:05.925195
current #epochs=2, #steps=8
start validation
acc: 0.545455
AUC: 0.819559
Avg Precision: 0.395000
Avg Recall: 1.000000
d_prime: 1.292148
train_loss: 0.254579
valid_loss: 1.157650
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.004063597428736782
Epoch-2 lr: 0.012190792286210346
epoch 2 training time: 6.561
---------------
2023-09-12 10:31:12.486092
current #epochs=3, #steps=16
start validation
acc: 0.545455
AUC: 0.813361
Avg Precision: 0.342916
Avg Recall: 1.000000
d_prime: 1.259144
train_loss: 0.269132
valid_loss: 1.148206
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.004063597428736782
Epoch-3 lr: 0.012190792286210346
epoch 3 training time: 6.812
---------------
2023-09-12 10:31:19.297940
current #epochs=4, #steps=24
start validation
acc: 0.613636
AUC: 0.802342
Avg Precision: 0.328449
Avg Recall: 1.000000
d_prime: 1.202103
train_loss: 0.305749
valid_loss: 1.188746
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.004063597428736782
Epoch-4 lr: 0.012190792286210346
epoch 4 training time: 9.057
---------------
2023-09-12 10:31:28.355148
current #epochs=5, #steps=32
start validation
acc: 0.545455
AUC: 0.836777
Avg Precision: 0.384510
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.234658
valid_loss: 1.143014
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00275937432553321
Epoch-5 lr: 0.00827812297659963
epoch 5 training time: 6.394
---------------
2023-09-12 10:31:34.748768
current #epochs=6, #steps=40
start validation
acc: 0.659091
AUC: 0.833333
Avg Precision: 0.354294
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.164011
valid_loss: 1.138006
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00275937432553321
Epoch-6 lr: 0.00827812297659963
epoch 6 training time: 9.687
---------------
2023-09-12 10:31:44.435831
current #epochs=7, #steps=48
start validation
acc: 0.613636
AUC: 0.831956
Avg Precision: 0.359747
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.241928
valid_loss: 1.130967
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00275937432553321
Epoch-7 lr: 0.00827812297659963
epoch 7 training time: 6.472
---------------
2023-09-12 10:31:50.907502
current #epochs=8, #steps=56
start validation
acc: 0.590909
AUC: 0.844353
Avg Precision: 0.374973
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.152990
valid_loss: 1.129226
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00275937432553321
Epoch-8 lr: 0.00827812297659963
epoch 8 training time: 6.882
---------------
2023-09-12 10:31:57.789606
current #epochs=9, #steps=64
start validation
acc: 0.636364
AUC: 0.854683
Avg Precision: 0.408638
Avg Recall: 1.000000
d_prime: 1.494446
train_loss: 0.198733
valid_loss: 1.118231
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00275937432553321
Epoch-9 lr: 0.00827812297659963
epoch 9 training time: 6.525
---------------
2023-09-12 10:32:04.314909
current #epochs=10, #steps=72
start validation
acc: 0.659091
AUC: 0.846419
Avg Precision: 0.357966
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.166180
valid_loss: 1.124139
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001873745320972606
Epoch-10 lr: 0.005621235962917818
epoch 10 training time: 6.365
---------------
2023-09-12 10:32:10.679845
current #epochs=11, #steps=80
start validation
acc: 0.636364
AUC: 0.828512
Avg Precision: 0.391071
Avg Recall: 1.000000
d_prime: 1.341103
train_loss: 0.160110
valid_loss: 1.136062
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001873745320972606
Epoch-11 lr: 0.005621235962917818
epoch 11 training time: 6.413
---------------
2023-09-12 10:32:17.092965
current #epochs=12, #steps=88
start validation
acc: 0.659091
AUC: 0.824380
Avg Precision: 0.353304
Avg Recall: 1.000000
d_prime: 1.318312
train_loss: 0.132718
valid_loss: 1.150132
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001873745320972606
Epoch-12 lr: 0.005621235962917818
epoch 12 training time: 7.756
---------------
2023-09-12 10:32:24.849271
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01218	Per Sample Data Time 0.00662	Per Sample DNN Time 0.00556	Train Loss 0.1423	
start validation
acc: 0.704545
AUC: 0.822314
Avg Precision: 0.328087
Avg Recall: 1.000000
d_prime: 1.307044
train_loss: 0.148449
valid_loss: 1.147669
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.001873745320972606
Epoch-13 lr: 0.005621235962917818
epoch 13 training time: 10.714
---------------
2023-09-12 10:32:35.563321
current #epochs=14, #steps=104
start validation
acc: 0.659091
AUC: 0.842975
Avg Precision: 0.357740
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.166988
valid_loss: 1.120436
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.001873745320972606
Epoch-14 lr: 0.005621235962917818
epoch 14 training time: 6.540
---------------
2023-09-12 10:32:42.103266
current #epochs=15, #steps=112
start validation
acc: 0.659091
AUC: 0.825758
Avg Precision: 0.350104
Avg Recall: 1.000000
d_prime: 1.325871
train_loss: 0.162654
valid_loss: 1.144220
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.001272361453601732
Epoch-15 lr: 0.0038170843608051966
epoch 15 training time: 6.368
---------------
2023-09-12 10:32:48.470927
current #epochs=16, #steps=120
start validation
acc: 0.681818
AUC: 0.826446
Avg Precision: 0.360825
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.125481
valid_loss: 1.150327
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.001272361453601732
Epoch-16 lr: 0.0038170843608051966
epoch 16 training time: 6.460
---------------
2023-09-12 10:32:54.931635
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.827135
Avg Precision: 0.367849
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.152131
valid_loss: 1.144494
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.001272361453601732
Epoch-17 lr: 0.0038170843608051966
epoch 17 training time: 6.592
---------------
2023-09-12 10:33:01.523707
current #epochs=18, #steps=136
start validation
acc: 0.636364
AUC: 0.833333
Avg Precision: 0.368492
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.191257
valid_loss: 1.143755
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001272361453601732
Epoch-18 lr: 0.0038170843608051966
epoch 18 training time: 6.557
---------------
2023-09-12 10:33:08.080920
current #epochs=19, #steps=144
start validation
acc: 0.659091
AUC: 0.835399
Avg Precision: 0.378016
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.151908
valid_loss: 1.150769
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.001272361453601732
Epoch-19 lr: 0.0038170843608051966
epoch 19 training time: 8.090
---------------
2023-09-12 10:33:16.171404
current #epochs=20, #steps=152
start validation
acc: 0.659091
AUC: 0.841598
Avg Precision: 0.378016
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.168659
valid_loss: 1.148275
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0008639934416333525
Epoch-20 lr: 0.002591980324900058
epoch 20 training time: 6.316
---------------
2023-09-12 10:33:22.487951
current #epochs=21, #steps=160
start validation
acc: 0.636364
AUC: 0.849174
Avg Precision: 0.389823
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.114944
valid_loss: 1.139349
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0008639934416333525
Epoch-21 lr: 0.002591980324900058
epoch 21 training time: 6.581
---------------
2023-09-12 10:33:29.068787
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.857438
Avg Precision: 0.413362
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.133094
valid_loss: 1.126686
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0008639934416333525
Epoch-22 lr: 0.002591980324900058
epoch 22 training time: 7.141
---------------
2023-09-12 10:33:36.209155
current #epochs=23, #steps=176
start validation
acc: 0.636364
AUC: 0.853306
Avg Precision: 0.388725
Avg Recall: 1.000000
d_prime: 1.485939
train_loss: 0.185377
valid_loss: 1.119100
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0008639934416333525
Epoch-23 lr: 0.002591980324900058
epoch 23 training time: 7.256
---------------
2023-09-12 10:33:43.465113
current #epochs=24, #steps=184
start validation
acc: 0.636364
AUC: 0.853306
Avg Precision: 0.377194
Avg Recall: 1.000000
d_prime: 1.485939
train_loss: 0.126480
valid_loss: 1.118293
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0008639934416333525
Epoch-24 lr: 0.002591980324900058
epoch 24 training time: 6.298
---------------
2023-09-12 10:33:49.763083
current #epochs=25, #steps=192
start validation
acc: 0.636364
AUC: 0.847796
Avg Precision: 0.390978
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.128081
valid_loss: 1.121458
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0005866922996388619
Epoch-25 lr: 0.001760076898916586
epoch 25 training time: 6.485
---------------
2023-09-12 10:33:56.248246
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03717	Per Sample Data Time 0.02981	Per Sample DNN Time 0.00736	Train Loss 0.3258	
start validation
acc: 0.636364
AUC: 0.849174
Avg Precision: 0.399019
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.178313
valid_loss: 1.125542
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0005866922996388619
Epoch-26 lr: 0.001760076898916586
epoch 26 training time: 7.289
---------------
2023-09-12 10:34:03.537092
current #epochs=27, #steps=208
start validation
acc: 0.636364
AUC: 0.844353
Avg Precision: 0.398630
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.220424
valid_loss: 1.128090
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0005866922996388619
Epoch-27 lr: 0.001760076898916586
epoch 27 training time: 8.324
---------------
2023-09-12 10:34:11.861044
current #epochs=28, #steps=216
start validation
acc: 0.659091
AUC: 0.845041
Avg Precision: 0.385213
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.144468
valid_loss: 1.129756
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0005866922996388619
Epoch-28 lr: 0.001760076898916586
epoch 28 training time: 7.189
---------------
2023-09-12 10:34:19.049568
current #epochs=29, #steps=224
start validation
acc: 0.636364
AUC: 0.845041
Avg Precision: 0.380580
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.146560
valid_loss: 1.124597
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0005866922996388619
Epoch-29 lr: 0.001760076898916586
epoch 29 training time: 6.209
---------------
2023-09-12 10:34:25.259327
current #epochs=30, #steps=232
start validation
acc: 0.636364
AUC: 0.854683
Avg Precision: 0.394654
Avg Recall: 1.000000
d_prime: 1.494446
train_loss: 0.148130
valid_loss: 1.115108
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0003983917445077152
Epoch-30 lr: 0.0011951752335231458
epoch 30 training time: 7.461
---------------
2023-09-12 10:34:32.719714
current #epochs=31, #steps=240
start validation
acc: 0.636364
AUC: 0.853306
Avg Precision: 0.400223
Avg Recall: 1.000000
d_prime: 1.485939
train_loss: 0.165319
valid_loss: 1.118076
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0003983917445077152
Epoch-31 lr: 0.0011951752335231458
epoch 31 training time: 6.397
---------------
2023-09-12 10:34:39.116342
current #epochs=32, #steps=248
start validation
acc: 0.636364
AUC: 0.845730
Avg Precision: 0.384945
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.166915
valid_loss: 1.126733
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0003983917445077152
Epoch-32 lr: 0.0011951752335231458
epoch 32 training time: 6.258
---------------
2023-09-12 10:34:45.374761
current #epochs=33, #steps=256
start validation
acc: 0.636364
AUC: 0.845730
Avg Precision: 0.386482
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.122420
valid_loss: 1.132439
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0003983917445077152
Epoch-33 lr: 0.0011951752335231458
epoch 33 training time: 6.635
---------------
2023-09-12 10:34:52.010134
current #epochs=34, #steps=264
start validation
acc: 0.636364
AUC: 0.846419
Avg Precision: 0.382981
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.144790
valid_loss: 1.133521
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0003983917445077152
Epoch-34 lr: 0.0011951752335231458
epoch 34 training time: 6.556
---------------
2023-09-12 10:34:58.565735
current #epochs=35, #steps=272
start validation
acc: 0.636364
AUC: 0.847796
Avg Precision: 0.378219
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.120821
valid_loss: 1.131712
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.00027052678582895696
Epoch-35 lr: 0.0008115803574868711
epoch 35 training time: 7.854
---------------
2023-09-12 10:35:06.419733
current #epochs=36, #steps=280
start validation
acc: 0.636364
AUC: 0.847796
Avg Precision: 0.378219
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.117895
valid_loss: 1.131531
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.00027052678582895696
Epoch-36 lr: 0.0008115803574868711
epoch 36 training time: 6.362
---------------
2023-09-12 10:35:12.781707
current #epochs=37, #steps=288
start validation
acc: 0.636364
AUC: 0.847107
Avg Precision: 0.378219
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.113923
valid_loss: 1.130768
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.00027052678582895696
Epoch-37 lr: 0.0008115803574868711
epoch 37 training time: 6.279
---------------
2023-09-12 10:35:19.060352
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01199	Per Sample Data Time 0.00623	Per Sample DNN Time 0.00576	Train Loss 0.1008	
start validation
acc: 0.636364
AUC: 0.847107
Avg Precision: 0.378219
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.147000
valid_loss: 1.129677
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.00027052678582895696
Epoch-38 lr: 0.0008115803574868711
epoch 38 training time: 7.654
---------------
2023-09-12 10:35:26.714301
current #epochs=39, #steps=304
start validation
acc: 0.636364
AUC: 0.845041
Avg Precision: 0.378219
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.180111
valid_loss: 1.128710
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.00027052678582895696
Epoch-39 lr: 0.0008115803574868711
epoch 39 training time: 6.352
---------------
2023-09-12 10:35:33.066984
current #epochs=40, #steps=312
start validation
acc: 0.590909
AUC: 0.845041
Avg Precision: 0.380530
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.128250
valid_loss: 1.127745
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.00018370044776248886
Epoch-40 lr: 0.0005511013432874667
epoch 40 training time: 7.386
---------------
2023-09-12 10:35:40.452421
current #epochs=41, #steps=320
start validation
acc: 0.590909
AUC: 0.845730
Avg Precision: 0.380530
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.125573
valid_loss: 1.128932
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.00018370044776248886
Epoch-41 lr: 0.0005511013432874667
epoch 41 training time: 7.094
---------------
2023-09-12 10:35:47.546832
current #epochs=42, #steps=328
start validation
acc: 0.613636
AUC: 0.849174
Avg Precision: 0.385585
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.108739
valid_loss: 1.129358
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.00018370044776248886
Epoch-42 lr: 0.0005511013432874667
epoch 42 training time: 6.670
---------------
2023-09-12 10:35:54.216574
current #epochs=43, #steps=336
start validation
acc: 0.613636
AUC: 0.851928
Avg Precision: 0.388357
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.137256
valid_loss: 1.129151
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.00018370044776248886
Epoch-43 lr: 0.0005511013432874667
epoch 43 training time: 6.521
---------------
2023-09-12 10:36:00.737613
current #epochs=44, #steps=344
start validation
acc: 0.636364
AUC: 0.855372
Avg Precision: 0.394086
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.097806
valid_loss: 1.129588
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.00018370044776248886
Epoch-44 lr: 0.0005511013432874667
epoch 44 training time: 6.306
---------------
2023-09-12 10:36:07.043384
current #epochs=45, #steps=352
start validation
acc: 0.636364
AUC: 0.856749
Avg Precision: 0.391314
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.102618
valid_loss: 1.128742
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.00012474126879796304
Epoch-45 lr: 0.00037422380639388924
epoch 45 training time: 6.359
---------------
2023-09-12 10:36:13.402006
current #epochs=46, #steps=360
start validation
acc: 0.636364
AUC: 0.858815
Avg Precision: 0.391314
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.111368
valid_loss: 1.128049
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.00012474126879796304
Epoch-46 lr: 0.00037422380639388924
epoch 46 training time: 6.309
---------------
2023-09-12 10:36:19.710694
current #epochs=47, #steps=368
start validation
[I 2023-09-12 10:36:27,070] Trial 65 finished with value: 0.7045454545454546 and parameters: {'warmup': 'False', 'num_epochs': 47, 'batch_size': 10, 'lr-adaptschedule': 'False', 'lr': 0.004063597428736782, 'head-lr': 3, 'lr-scheduler-start': 5, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.6790471679156945}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.636364
AUC: 0.858127
Avg Precision: 0.394086
Avg Recall: 1.000000
d_prime: 1.515953
train_loss: 0.104017
valid_loss: 1.128247
validation finished
normal learning rate scheduler step
Epoch-47 lr: 0.00012474126879796304
Epoch-47 lr: 0.00037422380639388924
epoch 47 training time: 7.353
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8dce370>
The learning rate scheduler starts at 6 epoch with decay rate of 0.769 every 6 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 10:36:27.108113
current #epochs=1, #steps=0
start validation
acc: 0.613636
AUC: 0.853994
Avg Precision: 0.391068
Avg Recall: 1.000000
d_prime: 1.490185
train_loss: 0.264859
valid_loss: 1.149758
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003908691932459723
Epoch-1 lr: 0.019543459662298614
epoch 1 training time: 10.400
---------------
2023-09-12 10:36:37.507987
current #epochs=2, #steps=8
start validation
acc: 0.636364
AUC: 0.837466
Avg Precision: 0.361126
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.270094
valid_loss: 1.134832
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003908691932459723
Epoch-2 lr: 0.019543459662298614
epoch 2 training time: 9.066
---------------
2023-09-12 10:36:46.573846
current #epochs=3, #steps=16
start validation
acc: 0.636364
AUC: 0.849862
Avg Precision: 0.384043
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.269828
valid_loss: 1.129189
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003908691932459723
Epoch-3 lr: 0.019543459662298614
epoch 3 training time: 6.396
---------------
2023-09-12 10:36:52.969847
current #epochs=4, #steps=24
start validation
acc: 0.659091
AUC: 0.857438
Avg Precision: 0.371032
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.304699
valid_loss: 1.116618
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003908691932459723
Epoch-4 lr: 0.019543459662298614
epoch 4 training time: 10.642
---------------
2023-09-12 10:37:03.611404
current #epochs=5, #steps=32
start validation
acc: 0.636364
AUC: 0.846419
Avg Precision: 0.344048
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.309887
valid_loss: 1.131749
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.003908691932459723
Epoch-5 lr: 0.019543459662298614
epoch 5 training time: 6.340
---------------
2023-09-12 10:37:09.951010
current #epochs=6, #steps=40
start validation
acc: 0.613636
AUC: 0.840909
Avg Precision: 0.326583
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.268023
valid_loss: 1.144275
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.003006633967062653
Epoch-6 lr: 0.015033169835313265
epoch 6 training time: 6.292
---------------
2023-09-12 10:37:16.242731
current #epochs=7, #steps=48
start validation
acc: 0.681818
AUC: 0.848485
Avg Precision: 0.336412
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.241369
valid_loss: 1.120863
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.003006633967062653
Epoch-7 lr: 0.015033169835313265
epoch 7 training time: 8.929
---------------
2023-09-12 10:37:25.171849
current #epochs=8, #steps=56
start validation
acc: 0.636364
AUC: 0.862948
Avg Precision: 0.464184
Avg Recall: 1.000000
d_prime: 1.546667
train_loss: 0.302229
valid_loss: 1.112571
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.003006633967062653
Epoch-8 lr: 0.015033169835313265
epoch 8 training time: 7.948
---------------
2023-09-12 10:37:33.119603
current #epochs=9, #steps=64
start validation
acc: 0.613636
AUC: 0.851240
Avg Precision: 0.385213
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.211267
valid_loss: 1.137761
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.003006633967062653
Epoch-9 lr: 0.015033169835313265
epoch 9 training time: 6.930
---------------
2023-09-12 10:37:40.049281
current #epochs=10, #steps=72
start validation
acc: 0.636364
AUC: 0.853994
Avg Precision: 0.399790
Avg Recall: 1.000000
d_prime: 1.490185
train_loss: 0.265508
valid_loss: 1.098463
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.003006633967062653
Epoch-10 lr: 0.015033169835313265
epoch 10 training time: 6.408
---------------
2023-09-12 10:37:46.457599
current #epochs=11, #steps=80
start validation
acc: 0.659091
AUC: 0.853994
Avg Precision: 0.380580
Avg Recall: 1.000000
d_prime: 1.490185
train_loss: 0.260643
valid_loss: 1.106716
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.003006633967062653
Epoch-11 lr: 0.015033169835313265
epoch 11 training time: 6.274
---------------
2023-09-12 10:37:52.731763
current #epochs=12, #steps=88
start validation
acc: 0.659091
AUC: 0.848485
Avg Precision: 0.385338
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.187780
valid_loss: 1.126354
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0023127552562593923
Epoch-12 lr: 0.011563776281296963
epoch 12 training time: 6.282
---------------
2023-09-12 10:37:59.013115
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01193	Per Sample Data Time 0.00618	Per Sample DNN Time 0.00575	Train Loss 0.1773	
start validation
acc: 0.613636
AUC: 0.844353
Avg Precision: 0.384950
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.152087
valid_loss: 1.125872
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0023127552562593923
Epoch-13 lr: 0.011563776281296963
epoch 13 training time: 6.526
---------------
2023-09-12 10:38:05.539088
current #epochs=14, #steps=104
start validation
acc: 0.636364
AUC: 0.842287
Avg Precision: 0.395673
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.139722
valid_loss: 1.129469
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0023127552562593923
Epoch-14 lr: 0.011563776281296963
epoch 14 training time: 6.472
---------------
2023-09-12 10:38:12.010776
current #epochs=15, #steps=112
start validation
acc: 0.590909
AUC: 0.844353
Avg Precision: 0.387817
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.149008
valid_loss: 1.118537
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0023127552562593923
Epoch-15 lr: 0.011563776281296963
epoch 15 training time: 7.293
---------------
2023-09-12 10:38:19.303540
current #epochs=16, #steps=120
start validation
acc: 0.613636
AUC: 0.850551
Avg Precision: 0.385115
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.146498
valid_loss: 1.099500
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0023127552562593923
Epoch-16 lr: 0.011563776281296963
epoch 16 training time: 6.486
---------------
2023-09-12 10:38:25.789560
current #epochs=17, #steps=128
start validation
acc: 0.659091
AUC: 0.855372
Avg Precision: 0.376561
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.179745
valid_loss: 1.097735
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0023127552562593923
Epoch-17 lr: 0.011563776281296963
epoch 17 training time: 6.482
---------------
2023-09-12 10:38:32.271655
current #epochs=18, #steps=136
start validation
acc: 0.704545
AUC: 0.855372
Avg Precision: 0.359689
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.229799
valid_loss: 1.106490
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001779011656873225
Epoch-18 lr: 0.008895058284366125
epoch 18 training time: 10.470
---------------
2023-09-12 10:38:42.741403
current #epochs=19, #steps=144
start validation
acc: 0.613636
AUC: 0.834022
Avg Precision: 0.331818
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.238167
valid_loss: 1.122637
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.001779011656873225
Epoch-19 lr: 0.008895058284366125
epoch 19 training time: 8.877
---------------
2023-09-12 10:38:51.618640
current #epochs=20, #steps=152
start validation
acc: 0.659091
AUC: 0.840220
Avg Precision: 0.331544
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.163870
valid_loss: 1.117620
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.001779011656873225
Epoch-20 lr: 0.008895058284366125
epoch 20 training time: 6.429
---------------
2023-09-12 10:38:58.047711
current #epochs=21, #steps=160
start validation
acc: 0.681818
AUC: 0.849174
Avg Precision: 0.355060
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.192615
valid_loss: 1.105854
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.001779011656873225
Epoch-21 lr: 0.008895058284366125
epoch 21 training time: 7.381
---------------
2023-09-12 10:39:05.428665
current #epochs=22, #steps=168
start validation
acc: 0.681818
AUC: 0.845041
Avg Precision: 0.348665
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.155026
valid_loss: 1.128480
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.001779011656873225
Epoch-22 lr: 0.008895058284366125
epoch 22 training time: 6.363
---------------
2023-09-12 10:39:11.791662
current #epochs=23, #steps=176
start validation
acc: 0.636364
AUC: 0.851240
Avg Precision: 0.339830
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.112896
valid_loss: 1.111694
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.001779011656873225
Epoch-23 lr: 0.008895058284366125
epoch 23 training time: 7.200
---------------
2023-09-12 10:39:18.991878
current #epochs=24, #steps=184
start validation
acc: 0.590909
AUC: 0.845730
Avg Precision: 0.344067
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.176739
valid_loss: 1.111539
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0013684467765126343
Epoch-24 lr: 0.006842233882563172
epoch 24 training time: 6.259
---------------
2023-09-12 10:39:25.250761
current #epochs=25, #steps=192
start validation
acc: 0.636364
AUC: 0.853306
Avg Precision: 0.364256
Avg Recall: 1.000000
d_prime: 1.485939
train_loss: 0.108884
valid_loss: 1.106834
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0013684467765126343
Epoch-25 lr: 0.006842233882563172
epoch 25 training time: 6.277
---------------
2023-09-12 10:39:31.528053
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03643	Per Sample Data Time 0.03083	Per Sample DNN Time 0.00560	Train Loss 0.1321	
start validation
acc: 0.659091
AUC: 0.858815
Avg Precision: 0.389040
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.121402
valid_loss: 1.100620
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0013684467765126343
Epoch-26 lr: 0.006842233882563172
epoch 26 training time: 8.512
---------------
2023-09-12 10:39:40.040814
current #epochs=27, #steps=208
start validation
acc: 0.636364
AUC: 0.859504
Avg Precision: 0.408263
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.182291
valid_loss: 1.105243
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0013684467765126343
Epoch-27 lr: 0.006842233882563172
epoch 27 training time: 6.457
---------------
2023-09-12 10:39:46.497121
current #epochs=28, #steps=216
start validation
acc: 0.613636
AUC: 0.862948
Avg Precision: 0.397894
Avg Recall: 1.000000
d_prime: 1.546667
train_loss: 0.125501
valid_loss: 1.103031
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0013684467765126343
Epoch-28 lr: 0.006842233882563172
epoch 28 training time: 6.425
---------------
2023-09-12 10:39:52.922826
current #epochs=29, #steps=224
start validation
acc: 0.613636
AUC: 0.864325
Avg Precision: 0.400412
Avg Recall: 1.000000
d_prime: 1.555577
train_loss: 0.132044
valid_loss: 1.097639
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0013684467765126343
Epoch-29 lr: 0.006842233882563172
epoch 29 training time: 6.518
---------------
2023-09-12 10:39:59.441052
current #epochs=30, #steps=232
start validation
acc: 0.613636
AUC: 0.861570
Avg Precision: 0.397138
Avg Recall: 1.000000
d_prime: 1.537818
train_loss: 0.119700
valid_loss: 1.097460
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0010526331139612468
Epoch-30 lr: 0.0052631655698062345
epoch 30 training time: 6.465
---------------
2023-09-12 10:40:05.906795
current #epochs=31, #steps=240
start validation
acc: 0.613636
AUC: 0.862259
Avg Precision: 0.387269
Avg Recall: 1.000000
d_prime: 1.542235
train_loss: 0.148211
valid_loss: 1.095406
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0010526331139612468
Epoch-31 lr: 0.0052631655698062345
epoch 31 training time: 6.380
---------------
2023-09-12 10:40:12.286916
current #epochs=32, #steps=248
start validation
acc: 0.659091
AUC: 0.853994
Avg Precision: 0.388135
Avg Recall: 1.000000
d_prime: 1.490185
train_loss: 0.123159
valid_loss: 1.103221
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0010526331139612468
Epoch-32 lr: 0.0052631655698062345
epoch 32 training time: 6.390
---------------
2023-09-12 10:40:18.677099
current #epochs=33, #steps=256
start validation
acc: 0.659091
AUC: 0.834022
Avg Precision: 0.373290
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.144859
valid_loss: 1.126912
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0010526331139612468
Epoch-33 lr: 0.0052631655698062345
epoch 33 training time: 6.466
---------------
2023-09-12 10:40:25.143582
current #epochs=34, #steps=264
start validation
acc: 0.636364
AUC: 0.837466
Avg Precision: 0.378585
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.127134
valid_loss: 1.127497
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0010526331139612468
Epoch-34 lr: 0.0052631655698062345
epoch 34 training time: 6.395
---------------
2023-09-12 10:40:31.538839
current #epochs=35, #steps=272
start validation
acc: 0.636364
AUC: 0.831956
Avg Precision: 0.363426
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.123837
valid_loss: 1.129498
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0010526331139612468
Epoch-35 lr: 0.0052631655698062345
epoch 35 training time: 6.522
---------------
2023-09-12 10:40:38.060563
current #epochs=36, #steps=280
start validation
acc: 0.636364
AUC: 0.823003
Avg Precision: 0.347753
Avg Recall: 1.000000
d_prime: 1.310791
train_loss: 0.088126
valid_loss: 1.136861
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0008097037397621588
Epoch-36 lr: 0.004048518698810795
epoch 36 training time: 6.604
---------------
2023-09-12 10:40:44.664696
current #epochs=37, #steps=288
start validation
acc: 0.613636
AUC: 0.835399
Avg Precision: 0.355024
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.096744
valid_loss: 1.122604
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0008097037397621588
Epoch-37 lr: 0.004048518698810795
epoch 37 training time: 6.377
---------------
2023-09-12 10:40:51.041482
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01210	Per Sample Data Time 0.00654	Per Sample DNN Time 0.00556	Train Loss 0.1421	
start validation
acc: 0.659091
AUC: 0.838843
Avg Precision: 0.350661
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.128475
valid_loss: 1.117952
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0008097037397621588
Epoch-38 lr: 0.004048518698810795
epoch 38 training time: 6.549
---------------
2023-09-12 10:40:57.591018
current #epochs=39, #steps=304
start validation
[I 2023-09-12 10:41:08,080] Trial 66 finished with value: 0.7045454545454546 and parameters: {'warmup': 'False', 'num_epochs': 39, 'batch_size': 15, 'lr-adaptschedule': 'False', 'lr': 0.003908691932459723, 'head-lr': 5, 'lr-scheduler-start': 6, 'lr-scheduler-step': 6, 'lr-scheduler-decay': 0.7692174310525903}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.659091
AUC: 0.839532
Avg Precision: 0.366852
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.106598
valid_loss: 1.120953
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0008097037397621588
Epoch-39 lr: 0.004048518698810795
epoch 39 training time: 10.484
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8d805e0>
The learning rate scheduler starts at 4 epoch with decay rate of 0.732 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 10:41:08.117898
current #epochs=1, #steps=0
start validation
acc: 0.681818
AUC: 0.836088
Avg Precision: 0.356771
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.209350
valid_loss: 1.123585
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0028191855210397
Epoch-1 lr: 0.0112767420841588
epoch 1 training time: 9.194
---------------
2023-09-12 10:41:17.312109
current #epochs=2, #steps=8
start validation
acc: 0.613636
AUC: 0.836088
Avg Precision: 0.382923
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.244343
valid_loss: 1.129125
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0028191855210397
Epoch-2 lr: 0.0112767420841588
epoch 2 training time: 7.221
---------------
2023-09-12 10:41:24.533218
current #epochs=3, #steps=16
start validation
acc: 0.681818
AUC: 0.841598
Avg Precision: 0.365279
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.220031
valid_loss: 1.122683
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0028191855210397
Epoch-3 lr: 0.0112767420841588
epoch 3 training time: 7.328
---------------
2023-09-12 10:41:31.861458
current #epochs=4, #steps=24
start validation
acc: 0.659091
AUC: 0.845041
Avg Precision: 0.384524
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.184615
valid_loss: 1.113732
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0020634486221067913
Epoch-4 lr: 0.008253794488427165
epoch 4 training time: 6.460
---------------
2023-09-12 10:41:38.321882
current #epochs=5, #steps=32
start validation
acc: 0.659091
AUC: 0.846419
Avg Precision: 0.392901
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.181912
valid_loss: 1.118245
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0020634486221067913
Epoch-5 lr: 0.008253794488427165
epoch 5 training time: 6.504
---------------
2023-09-12 10:41:44.826257
current #epochs=6, #steps=40
start validation
acc: 0.636364
AUC: 0.842975
Avg Precision: 0.359187
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.211767
valid_loss: 1.115407
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0020634486221067913
Epoch-6 lr: 0.008253794488427165
epoch 6 training time: 6.889
---------------
2023-09-12 10:41:51.715440
current #epochs=7, #steps=48
start validation
acc: 0.613636
AUC: 0.841598
Avg Precision: 0.373432
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.148561
valid_loss: 1.122512
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0020634486221067913
Epoch-7 lr: 0.008253794488427165
epoch 7 training time: 9.274
---------------
2023-09-12 10:42:00.989373
current #epochs=8, #steps=56
start validation
acc: 0.613636
AUC: 0.840909
Avg Precision: 0.365476
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.130694
valid_loss: 1.116001
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0020634486221067913
Epoch-8 lr: 0.008253794488427165
epoch 8 training time: 6.232
---------------
2023-09-12 10:42:07.220902
current #epochs=9, #steps=64
start validation
acc: 0.613636
AUC: 0.842975
Avg Precision: 0.352381
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.122744
valid_loss: 1.108790
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001510301533651519
Epoch-9 lr: 0.006041206134606076
epoch 9 training time: 6.946
---------------
2023-09-12 10:42:14.166824
current #epochs=10, #steps=72
start validation
acc: 0.613636
AUC: 0.849862
Avg Precision: 0.370724
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.131881
valid_loss: 1.105232
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001510301533651519
Epoch-10 lr: 0.006041206134606076
epoch 10 training time: 6.547
---------------
2023-09-12 10:42:20.714262
current #epochs=11, #steps=80
start validation
acc: 0.636364
AUC: 0.856061
Avg Precision: 0.383338
Avg Recall: 1.000000
d_prime: 1.503007
train_loss: 0.138821
valid_loss: 1.102466
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001510301533651519
Epoch-11 lr: 0.006041206134606076
epoch 11 training time: 6.875
---------------
2023-09-12 10:42:27.589187
current #epochs=12, #steps=88
start validation
acc: 0.659091
AUC: 0.844353
Avg Precision: 0.355773
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.154844
valid_loss: 1.106962
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001510301533651519
Epoch-12 lr: 0.006041206134606076
epoch 12 training time: 6.566
---------------
2023-09-12 10:42:34.154923
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01139	Per Sample Data Time 0.00593	Per Sample DNN Time 0.00546	Train Loss 0.2548	
start validation
acc: 0.636364
AUC: 0.852617
Avg Precision: 0.376928
Avg Recall: 1.000000
d_prime: 1.481705
train_loss: 0.225562
valid_loss: 1.103920
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.001510301533651519
Epoch-13 lr: 0.006041206134606076
epoch 13 training time: 7.225
---------------
2023-09-12 10:42:41.379970
current #epochs=14, #steps=104
start validation
acc: 0.636364
AUC: 0.846419
Avg Precision: 0.369917
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.155755
valid_loss: 1.116778
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.001105436160664474
Epoch-14 lr: 0.004421744642657896
epoch 14 training time: 6.389
---------------
2023-09-12 10:42:47.768638
current #epochs=15, #steps=112
start validation
acc: 0.636364
AUC: 0.831956
Avg Precision: 0.377122
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.114093
valid_loss: 1.124446
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.001105436160664474
Epoch-15 lr: 0.004421744642657896
epoch 15 training time: 6.446
---------------
2023-09-12 10:42:54.214478
current #epochs=16, #steps=120
start validation
acc: 0.659091
AUC: 0.837466
Avg Precision: 0.385923
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.127340
valid_loss: 1.112212
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.001105436160664474
Epoch-16 lr: 0.004421744642657896
epoch 16 training time: 6.479
---------------
2023-09-12 10:43:00.693000
current #epochs=17, #steps=128
start validation
acc: 0.613636
AUC: 0.849174
Avg Precision: 0.400269
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.146037
valid_loss: 1.105138
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.001105436160664474
Epoch-17 lr: 0.004421744642657896
epoch 17 training time: 6.517
---------------
2023-09-12 10:43:07.210173
current #epochs=18, #steps=136
start validation
acc: 0.613636
AUC: 0.848485
Avg Precision: 0.373789
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.130150
valid_loss: 1.108335
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001105436160664474
Epoch-18 lr: 0.004421744642657896
epoch 18 training time: 6.509
---------------
2023-09-12 10:43:13.719422
current #epochs=19, #steps=144
start validation
acc: 0.568182
AUC: 0.845730
Avg Precision: 0.368735
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.133400
valid_loss: 1.113398
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.000809102737484586
Epoch-19 lr: 0.003236410949938344
epoch 19 training time: 6.433
---------------
2023-09-12 10:43:20.152344
current #epochs=20, #steps=152
start validation
acc: 0.636364
AUC: 0.844353
Avg Precision: 0.371046
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.182786
valid_loss: 1.116516
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.000809102737484586
Epoch-20 lr: 0.003236410949938344
epoch 20 training time: 6.398
---------------
2023-09-12 10:43:26.550261
current #epochs=21, #steps=160
start validation
acc: 0.636364
AUC: 0.845730
Avg Precision: 0.371057
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.110451
valid_loss: 1.118849
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.000809102737484586
Epoch-21 lr: 0.003236410949938344
epoch 21 training time: 7.105
---------------
2023-09-12 10:43:33.655164
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.842975
Avg Precision: 0.373829
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.159792
valid_loss: 1.123010
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.000809102737484586
Epoch-22 lr: 0.003236410949938344
epoch 22 training time: 7.090
---------------
2023-09-12 10:43:40.744870
current #epochs=23, #steps=176
start validation
acc: 0.659091
AUC: 0.842287
Avg Precision: 0.390562
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.145706
valid_loss: 1.120431
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.000809102737484586
Epoch-23 lr: 0.003236410949938344
epoch 23 training time: 6.423
---------------
2023-09-12 10:43:47.167915
current #epochs=24, #steps=184
start validation
acc: 0.659091
AUC: 0.823691
Avg Precision: 0.372043
Avg Recall: 1.000000
d_prime: 1.314547
train_loss: 0.139521
valid_loss: 1.136478
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0005922071876240638
Epoch-24 lr: 0.0023688287504962553
epoch 24 training time: 6.285
---------------
2023-09-12 10:43:53.453179
current #epochs=25, #steps=192
start validation
acc: 0.568182
AUC: 0.829890
Avg Precision: 0.378161
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.104139
valid_loss: 1.143803
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0005922071876240638
Epoch-25 lr: 0.0023688287504962553
epoch 25 training time: 7.654
---------------
2023-09-12 10:44:01.107603
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03734	Per Sample Data Time 0.03003	Per Sample DNN Time 0.00731	Train Loss 0.0778	
start validation
acc: 0.613636
AUC: 0.831956
Avg Precision: 0.389881
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.114513
valid_loss: 1.139846
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0005922071876240638
Epoch-26 lr: 0.0023688287504962553
epoch 26 training time: 6.824
---------------
2023-09-12 10:44:07.932094
current #epochs=27, #steps=208
start validation
acc: 0.613636
AUC: 0.869835
Avg Precision: 0.421221
Avg Recall: 1.000000
d_prime: 1.591853
train_loss: 0.149230
valid_loss: 1.102196
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0005922071876240638
Epoch-27 lr: 0.0023688287504962553
epoch 27 training time: 6.351
---------------
2023-09-12 10:44:14.282660
current #epochs=28, #steps=216
start validation
acc: 0.636364
AUC: 0.876033
Avg Precision: 0.442871
Avg Recall: 1.000000
d_prime: 1.633957
train_loss: 0.112980
valid_loss: 1.100196
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0005922071876240638
Epoch-28 lr: 0.0023688287504962553
epoch 28 training time: 6.718
---------------
2023-09-12 10:44:21.001334
current #epochs=29, #steps=224
start validation
acc: 0.636364
AUC: 0.877410
Avg Precision: 0.457439
Avg Recall: 1.000000
d_prime: 1.643513
train_loss: 0.146446
valid_loss: 1.092185
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0004334546613498319
Epoch-29 lr: 0.0017338186453993275
epoch 29 training time: 6.310
---------------
2023-09-12 10:44:27.310993
current #epochs=30, #steps=232
start validation
acc: 0.613636
AUC: 0.871901
Avg Precision: 0.441375
Avg Recall: 1.000000
d_prime: 1.605730
train_loss: 0.135684
valid_loss: 1.099816
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0004334546613498319
Epoch-30 lr: 0.0017338186453993275
epoch 30 training time: 7.085
---------------
2023-09-12 10:44:34.396509
current #epochs=31, #steps=240
start validation
acc: 0.613636
AUC: 0.860193
Avg Precision: 0.430213
Avg Recall: 1.000000
d_prime: 1.529028
train_loss: 0.086867
valid_loss: 1.111292
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0004334546613498319
Epoch-31 lr: 0.0017338186453993275
epoch 31 training time: 8.665
---------------
2023-09-12 10:44:43.061497
current #epochs=32, #steps=248
start validation
acc: 0.613636
AUC: 0.858815
Avg Precision: 0.425982
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.151721
valid_loss: 1.109622
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0004334546613498319
Epoch-32 lr: 0.0017338186453993275
epoch 32 training time: 6.492
---------------
2023-09-12 10:44:49.554166
current #epochs=33, #steps=256
start validation
[I 2023-09-12 10:44:57,811] Trial 67 finished with value: 0.6818181818181818 and parameters: {'warmup': 'False', 'num_epochs': 33, 'batch_size': 19, 'lr-adaptschedule': 'False', 'lr': 0.0028191855210397, 'head-lr': 4, 'lr-scheduler-start': 4, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.7319307674884067}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.613636
AUC: 0.858127
Avg Precision: 0.413984
Avg Recall: 1.000000
d_prime: 1.515953
train_loss: 0.099173
valid_loss: 1.102326
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0004334546613498319
Epoch-33 lr: 0.0017338186453993275
epoch 33 training time: 8.252
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8d80070>
The learning rate scheduler starts at 3 epoch with decay rate of 0.689 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 10:44:57.849569
current #epochs=1, #steps=0
start validation
acc: 0.636364
AUC: 0.823003
Avg Precision: 0.340302
Avg Recall: 1.000000
d_prime: 1.310791
train_loss: 0.209114
valid_loss: 1.153854
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0035015748330970214
Epoch-1 lr: 0.017507874165485108
epoch 1 training time: 9.638
---------------
2023-09-12 10:45:07.487760
current #epochs=2, #steps=8
start validation
acc: 0.636364
AUC: 0.832645
Avg Precision: 0.370320
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.271964
valid_loss: 1.136331
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0035015748330970214
Epoch-2 lr: 0.017507874165485108
epoch 2 training time: 6.344
---------------
2023-09-12 10:45:13.832075
current #epochs=3, #steps=16
start validation
acc: 0.659091
AUC: 0.858815
Avg Precision: 0.409113
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.292604
valid_loss: 1.126019
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002411107456405988
Epoch-3 lr: 0.012055537282029943
epoch 3 training time: 9.089
---------------
2023-09-12 10:45:22.920990
current #epochs=4, #steps=24
start validation
acc: 0.636364
AUC: 0.833333
Avg Precision: 0.369749
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.223050
valid_loss: 1.132585
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002411107456405988
Epoch-4 lr: 0.012055537282029943
epoch 4 training time: 6.410
---------------
2023-09-12 10:45:29.330604
current #epochs=5, #steps=32
start validation
acc: 0.613636
AUC: 0.815427
Avg Precision: 0.347423
Avg Recall: 1.000000
d_prime: 1.270069
train_loss: 0.197822
valid_loss: 1.138754
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002411107456405988
Epoch-5 lr: 0.012055537282029943
epoch 5 training time: 6.419
---------------
2023-09-12 10:45:35.750044
current #epochs=6, #steps=40
start validation
acc: 0.636364
AUC: 0.806474
Avg Precision: 0.354294
Avg Recall: 1.000000
d_prime: 1.223260
train_loss: 0.235439
valid_loss: 1.163927
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0016602355921077857
Epoch-6 lr: 0.00830117796053893
epoch 6 training time: 6.270
---------------
2023-09-12 10:45:42.020008
current #epochs=7, #steps=48
start validation
acc: 0.590909
AUC: 0.825069
Avg Precision: 0.370454
Avg Recall: 1.000000
d_prime: 1.322087
train_loss: 0.209189
valid_loss: 1.150807
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0016602355921077857
Epoch-7 lr: 0.00830117796053893
epoch 7 training time: 6.472
---------------
2023-09-12 10:45:48.491591
current #epochs=8, #steps=56
start validation
acc: 0.590909
AUC: 0.838154
Avg Precision: 0.380906
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.263180
valid_loss: 1.133972
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0016602355921077857
Epoch-8 lr: 0.00830117796053893
epoch 8 training time: 6.748
---------------
2023-09-12 10:45:55.239517
current #epochs=9, #steps=64
start validation
acc: 0.659091
AUC: 0.849862
Avg Precision: 0.391067
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.190606
valid_loss: 1.115984
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0011432017324562425
Epoch-9 lr: 0.005716008662281213
epoch 9 training time: 6.434
---------------
2023-09-12 10:46:01.673358
current #epochs=10, #steps=72
start validation
acc: 0.704545
AUC: 0.851928
Avg Precision: 0.415373
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.132294
valid_loss: 1.100073
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0011432017324562425
Epoch-10 lr: 0.005716008662281213
epoch 10 training time: 9.957
---------------
2023-09-12 10:46:11.630488
current #epochs=11, #steps=80
start validation
acc: 0.659091
AUC: 0.856061
Avg Precision: 0.432508
Avg Recall: 1.000000
d_prime: 1.503007
train_loss: 0.107962
valid_loss: 1.096608
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0011432017324562425
Epoch-11 lr: 0.005716008662281213
epoch 11 training time: 6.728
---------------
2023-09-12 10:46:18.358927
current #epochs=12, #steps=88
start validation
acc: 0.659091
AUC: 0.855372
Avg Precision: 0.425709
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.118170
valid_loss: 1.100557
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0007871835824406944
Epoch-12 lr: 0.003935917912203472
epoch 12 training time: 7.068
---------------
2023-09-12 10:46:25.427277
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01146	Per Sample Data Time 0.00602	Per Sample DNN Time 0.00544	Train Loss 0.1545	
start validation
acc: 0.659091
AUC: 0.857438
Avg Precision: 0.435304
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.118826
valid_loss: 1.100924
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0007871835824406944
Epoch-13 lr: 0.003935917912203472
epoch 13 training time: 6.335
---------------
2023-09-12 10:46:31.761879
current #epochs=14, #steps=104
start validation
acc: 0.636364
AUC: 0.867080
Avg Precision: 0.447086
Avg Recall: 1.000000
d_prime: 1.573586
train_loss: 0.125278
valid_loss: 1.094417
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0007871835824406944
Epoch-14 lr: 0.003935917912203472
epoch 14 training time: 6.512
---------------
2023-09-12 10:46:38.274582
current #epochs=15, #steps=112
start validation
acc: 0.659091
AUC: 0.867080
Avg Precision: 0.450602
Avg Recall: 1.000000
d_prime: 1.573586
train_loss: 0.133577
valid_loss: 1.092485
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0005420373105390512
Epoch-15 lr: 0.0027101865526952557
epoch 15 training time: 6.572
---------------
2023-09-12 10:46:44.846707
current #epochs=16, #steps=120
start validation
acc: 0.590909
AUC: 0.860882
Avg Precision: 0.439899
Avg Recall: 1.000000
d_prime: 1.533415
train_loss: 0.064587
valid_loss: 1.104887
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0005420373105390512
Epoch-16 lr: 0.0027101865526952557
epoch 16 training time: 6.558
---------------
2023-09-12 10:46:51.404366
current #epochs=17, #steps=128
start validation
acc: 0.613636
AUC: 0.856749
Avg Precision: 0.417702
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.089010
valid_loss: 1.114807
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0005420373105390512
Epoch-17 lr: 0.0027101865526952557
epoch 17 training time: 6.572
---------------
2023-09-12 10:46:57.976316
current #epochs=18, #steps=136
start validation
acc: 0.636364
AUC: 0.856749
Avg Precision: 0.419127
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.080435
valid_loss: 1.115088
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00037323497665621436
Epoch-18 lr: 0.0018661748832810717
epoch 18 training time: 6.422
---------------
2023-09-12 10:47:04.398856
current #epochs=19, #steps=144
start validation
acc: 0.636364
AUC: 0.861570
Avg Precision: 0.430600
Avg Recall: 1.000000
d_prime: 1.537818
train_loss: 0.152560
valid_loss: 1.111977
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00037323497665621436
Epoch-19 lr: 0.0018661748832810717
epoch 19 training time: 6.919
---------------
2023-09-12 10:47:11.317580
current #epochs=20, #steps=152
start validation
acc: 0.636364
AUC: 0.859504
Avg Precision: 0.423676
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.122431
valid_loss: 1.112017
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00037323497665621436
Epoch-20 lr: 0.0018661748832810717
epoch 20 training time: 6.800
---------------
2023-09-12 10:47:18.117564
current #epochs=21, #steps=160
start validation
acc: 0.636364
AUC: 0.856749
Avg Precision: 0.413852
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.092701
valid_loss: 1.113978
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0002570014002560598
Epoch-21 lr: 0.001285007001280299
epoch 21 training time: 6.454
---------------
2023-09-12 10:47:24.571829
current #epochs=22, #steps=168
start validation
acc: 0.659091
AUC: 0.856061
Avg Precision: 0.413852
Avg Recall: 1.000000
d_prime: 1.503007
train_loss: 0.139131
valid_loss: 1.114736
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0002570014002560598
Epoch-22 lr: 0.001285007001280299
epoch 22 training time: 6.253
---------------
2023-09-12 10:47:30.825324
current #epochs=23, #steps=176
start validation
acc: 0.659091
AUC: 0.855372
Avg Precision: 0.421089
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.107505
valid_loss: 1.115933
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0002570014002560598
Epoch-23 lr: 0.001285007001280299
epoch 23 training time: 6.549
---------------
2023-09-12 10:47:37.373906
current #epochs=24, #steps=184
start validation
acc: 0.681818
AUC: 0.854683
Avg Precision: 0.429130
Avg Recall: 1.000000
d_prime: 1.494446
train_loss: 0.140744
valid_loss: 1.113327
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00017696551466132732
Epoch-24 lr: 0.0008848275733066365
epoch 24 training time: 6.480
---------------
2023-09-12 10:47:43.853962
current #epochs=25, #steps=192
start validation
acc: 0.659091
AUC: 0.856749
Avg Precision: 0.438117
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.162722
valid_loss: 1.113513
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00017696551466132732
Epoch-25 lr: 0.0008848275733066365
epoch 25 training time: 6.579
---------------
2023-09-12 10:47:50.433211
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03567	Per Sample Data Time 0.03018	Per Sample DNN Time 0.00549	Train Loss 0.1106	
start validation
acc: 0.681818
AUC: 0.857438
Avg Precision: 0.448227
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.070921
valid_loss: 1.113851
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00017696551466132732
Epoch-26 lr: 0.0008848275733066365
epoch 26 training time: 7.106
---------------
2023-09-12 10:47:57.539359
current #epochs=27, #steps=208
start validation
[I 2023-09-12 10:48:04,836] Trial 68 finished with value: 0.7045454545454546 and parameters: {'warmup': 'False', 'num_epochs': 27, 'batch_size': 13, 'lr-adaptschedule': 'False', 'lr': 0.0035015748330970214, 'head-lr': 5, 'lr-scheduler-start': 3, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.6885780174155088}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.681818
AUC: 0.856061
Avg Precision: 0.446371
Avg Recall: 1.000000
d_prime: 1.503007
train_loss: 0.093157
valid_loss: 1.114263
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00012185456323641193
Epoch-27 lr: 0.0006092728161820595
epoch 27 training time: 7.291
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8d58bb0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.662 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 10:48:04.874443
current #epochs=1, #steps=0
start validation
acc: 0.659091
AUC: 0.843664
Avg Precision: 0.406126
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.256506
valid_loss: 1.143225
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003395912767458449
Epoch-1 lr: 0.006791825534916898
epoch 1 training time: 9.419
---------------
2023-09-12 10:48:14.293452
current #epochs=2, #steps=8
start validation
acc: 0.727273
AUC: 0.849862
Avg Precision: 0.376253
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.212079
valid_loss: 1.107961
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003395912767458449
Epoch-2 lr: 0.006791825534916898
epoch 2 training time: 8.959
---------------
2023-09-12 10:48:23.252384
current #epochs=3, #steps=16
start validation
acc: 0.681818
AUC: 0.846419
Avg Precision: 0.385000
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.215435
valid_loss: 1.115108
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003395912767458449
Epoch-3 lr: 0.006791825534916898
epoch 3 training time: 6.390
---------------
2023-09-12 10:48:29.642361
current #epochs=4, #steps=24
start validation
acc: 0.568182
AUC: 0.808540
Avg Precision: 0.360417
Avg Recall: 1.000000
d_prime: 1.233942
train_loss: 0.188386
valid_loss: 1.153373
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003395912767458449
Epoch-4 lr: 0.006791825534916898
epoch 4 training time: 6.464
---------------
2023-09-12 10:48:36.106236
current #epochs=5, #steps=32
start validation
acc: 0.659091
AUC: 0.837466
Avg Precision: 0.371562
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.233587
valid_loss: 1.140267
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.003395912767458449
Epoch-5 lr: 0.006791825534916898
epoch 5 training time: 7.198
---------------
2023-09-12 10:48:43.303823
current #epochs=6, #steps=40
start validation
acc: 0.613636
AUC: 0.841598
Avg Precision: 0.417625
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.213944
valid_loss: 1.148973
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0022465830926302085
Epoch-6 lr: 0.004493166185260417
epoch 6 training time: 6.481
---------------
2023-09-12 10:48:49.785271
current #epochs=7, #steps=48
start validation
acc: 0.659091
AUC: 0.834022
Avg Precision: 0.407328
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.211486
valid_loss: 1.153341
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0022465830926302085
Epoch-7 lr: 0.004493166185260417
epoch 7 training time: 6.668
---------------
2023-09-12 10:48:56.453699
current #epochs=8, #steps=56
start validation
acc: 0.613636
AUC: 0.838843
Avg Precision: 0.401716
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.222538
valid_loss: 1.142316
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0022465830926302085
Epoch-8 lr: 0.004493166185260417
epoch 8 training time: 6.392
---------------
2023-09-12 10:49:02.845853
current #epochs=9, #steps=64
start validation
acc: 0.613636
AUC: 0.845730
Avg Precision: 0.388161
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.191364
valid_loss: 1.124725
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0022465830926302085
Epoch-9 lr: 0.004493166185260417
epoch 9 training time: 6.566
---------------
2023-09-12 10:49:09.412206
current #epochs=10, #steps=72
start validation
acc: 0.659091
AUC: 0.854683
Avg Precision: 0.393195
Avg Recall: 1.000000
d_prime: 1.494446
train_loss: 0.163484
valid_loss: 1.116640
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0014862382922366003
Epoch-10 lr: 0.0029724765844732007
epoch 10 training time: 7.213
---------------
2023-09-12 10:49:16.624926
current #epochs=11, #steps=80
start validation
acc: 0.659091
AUC: 0.854683
Avg Precision: 0.398177
Avg Recall: 1.000000
d_prime: 1.494446
train_loss: 0.142926
valid_loss: 1.117932
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0014862382922366003
Epoch-11 lr: 0.0029724765844732007
epoch 11 training time: 6.324
---------------
2023-09-12 10:49:22.948884
current #epochs=12, #steps=88
start validation
acc: 0.659091
AUC: 0.848485
Avg Precision: 0.379092
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.135221
valid_loss: 1.129842
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0014862382922366003
Epoch-12 lr: 0.0029724765844732007
epoch 12 training time: 6.660
---------------
2023-09-12 10:49:29.609309
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01219	Per Sample Data Time 0.00622	Per Sample DNN Time 0.00597	Train Loss 0.1033	
start validation
acc: 0.704545
AUC: 0.847796
Avg Precision: 0.387159
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.121780
valid_loss: 1.128929
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0014862382922366003
Epoch-13 lr: 0.0029724765844732007
epoch 13 training time: 6.549
---------------
2023-09-12 10:49:36.158418
current #epochs=14, #steps=104
start validation
acc: 0.659091
AUC: 0.847107
Avg Precision: 0.376135
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.158463
valid_loss: 1.127287
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0009832283829414343
Epoch-14 lr: 0.0019664567658828685
epoch 14 training time: 6.591
---------------
2023-09-12 10:49:42.749248
current #epochs=15, #steps=112
start validation
acc: 0.636364
AUC: 0.840220
Avg Precision: 0.381117
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.167704
valid_loss: 1.128415
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0009832283829414343
Epoch-15 lr: 0.0019664567658828685
epoch 15 training time: 6.509
---------------
2023-09-12 10:49:49.258831
current #epochs=16, #steps=120
start validation
acc: 0.636364
AUC: 0.842287
Avg Precision: 0.377418
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.112398
valid_loss: 1.122238
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0009832283829414343
Epoch-16 lr: 0.0019664567658828685
epoch 16 training time: 6.466
---------------
2023-09-12 10:49:55.724928
current #epochs=17, #steps=128
start validation
acc: 0.659091
AUC: 0.847107
Avg Precision: 0.386471
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.133760
valid_loss: 1.120126
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0009832283829414343
Epoch-17 lr: 0.0019664567658828685
epoch 17 training time: 6.365
---------------
2023-09-12 10:50:02.090094
current #epochs=18, #steps=136
start validation
acc: 0.659091
AUC: 0.849174
Avg Precision: 0.390491
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.131484
valid_loss: 1.123708
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0006504596591753865
Epoch-18 lr: 0.001300919318350773
epoch 18 training time: 6.380
---------------
2023-09-12 10:50:08.470774
current #epochs=19, #steps=144
start validation
acc: 0.681818
AUC: 0.848485
Avg Precision: 0.390491
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.136578
valid_loss: 1.129179
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0006504596591753865
Epoch-19 lr: 0.001300919318350773
epoch 19 training time: 6.494
---------------
2023-09-12 10:50:14.964783
current #epochs=20, #steps=152
start validation
acc: 0.659091
AUC: 0.840220
Avg Precision: 0.363323
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.133664
valid_loss: 1.134566
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0006504596591753865
Epoch-20 lr: 0.001300919318350773
epoch 20 training time: 6.521
---------------
2023-09-12 10:50:21.485739
current #epochs=21, #steps=160
start validation
acc: 0.636364
AUC: 0.838154
Avg Precision: 0.350473
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.189289
valid_loss: 1.135249
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0006504596591753865
Epoch-21 lr: 0.001300919318350773
epoch 21 training time: 7.136
---------------
2023-09-12 10:50:28.622113
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.840220
Avg Precision: 0.349439
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.120903
valid_loss: 1.130464
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0004303148439926207
Epoch-22 lr: 0.0008606296879852414
epoch 22 training time: 6.254
---------------
2023-09-12 10:50:34.876324
current #epochs=23, #steps=176
start validation
acc: 0.636364
AUC: 0.838154
Avg Precision: 0.356714
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.154520
valid_loss: 1.130036
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0004303148439926207
Epoch-23 lr: 0.0008606296879852414
epoch 23 training time: 6.319
---------------
2023-09-12 10:50:41.195213
current #epochs=24, #steps=184
start validation
acc: 0.659091
AUC: 0.838843
Avg Precision: 0.359035
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.162430
valid_loss: 1.133205
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0004303148439926207
Epoch-24 lr: 0.0008606296879852414
epoch 24 training time: 6.478
---------------
2023-09-12 10:50:47.672823
current #epochs=25, #steps=192
start validation
acc: 0.613636
AUC: 0.840220
Avg Precision: 0.362952
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.123393
valid_loss: 1.133995
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0004303148439926207
Epoch-25 lr: 0.0008606296879852414
epoch 25 training time: 6.362
---------------
2023-09-12 10:50:54.034691
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03622	Per Sample Data Time 0.03072	Per Sample DNN Time 0.00550	Train Loss 0.0836	
start validation
acc: 0.613636
AUC: 0.840220
Avg Precision: 0.369162
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.091821
valid_loss: 1.136807
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00028467693937413727
Epoch-26 lr: 0.0005693538787482745
epoch 26 training time: 6.376
---------------
2023-09-12 10:51:00.410383
current #epochs=27, #steps=208
start validation
acc: 0.613636
AUC: 0.839532
Avg Precision: 0.371870
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.092350
valid_loss: 1.137094
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00028467693937413727
Epoch-27 lr: 0.0005693538787482745
epoch 27 training time: 6.396
---------------
2023-09-12 10:51:06.806112
current #epochs=28, #steps=216
start validation
acc: 0.613636
AUC: 0.840220
Avg Precision: 0.378375
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.090590
valid_loss: 1.136889
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00028467693937413727
Epoch-28 lr: 0.0005693538787482745
epoch 28 training time: 6.443
---------------
2023-09-12 10:51:13.249039
current #epochs=29, #steps=224
start validation
acc: 0.613636
AUC: 0.842287
Avg Precision: 0.378345
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.123537
valid_loss: 1.130133
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00028467693937413727
Epoch-29 lr: 0.0005693538787482745
epoch 29 training time: 6.413
---------------
2023-09-12 10:51:19.662456
current #epochs=30, #steps=232
start validation
acc: 0.636364
AUC: 0.847107
Avg Precision: 0.389075
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.111329
valid_loss: 1.122902
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00018832945445129928
Epoch-30 lr: 0.00037665890890259857
epoch 30 training time: 7.526
---------------
2023-09-12 10:51:27.188945
current #epochs=31, #steps=240
start validation
acc: 0.659091
AUC: 0.851240
Avg Precision: 0.391031
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.133733
valid_loss: 1.118988
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.00018832945445129928
Epoch-31 lr: 0.00037665890890259857
epoch 31 training time: 6.617
---------------
2023-09-12 10:51:33.806275
current #epochs=32, #steps=248
start validation
acc: 0.659091
AUC: 0.850551
Avg Precision: 0.391031
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.113727
valid_loss: 1.116937
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00018832945445129928
Epoch-32 lr: 0.00037665890890259857
epoch 32 training time: 8.532
---------------
2023-09-12 10:51:42.338265
current #epochs=33, #steps=256
start validation
acc: 0.659091
AUC: 0.849862
Avg Precision: 0.389075
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.104018
valid_loss: 1.116315
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.00018832945445129928
Epoch-33 lr: 0.00037665890890259857
epoch 33 training time: 6.488
---------------
2023-09-12 10:51:48.826435
current #epochs=34, #steps=264
start validation
acc: 0.636364
AUC: 0.849862
Avg Precision: 0.389687
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.115543
valid_loss: 1.117568
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.00012459029344596875
Epoch-34 lr: 0.0002491805868919375
epoch 34 training time: 7.299
---------------
2023-09-12 10:51:56.125888
current #epochs=35, #steps=272
start validation
acc: 0.613636
AUC: 0.849174
Avg Precision: 0.389687
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.146732
valid_loss: 1.117865
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.00012459029344596875
Epoch-35 lr: 0.0002491805868919375
epoch 35 training time: 7.300
---------------
2023-09-12 10:52:03.425601
current #epochs=36, #steps=280
start validation
acc: 0.613636
AUC: 0.845041
Avg Precision: 0.389687
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.096442
valid_loss: 1.118782
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.00012459029344596875
Epoch-36 lr: 0.0002491805868919375
epoch 36 training time: 6.683
---------------
2023-09-12 10:52:10.108813
current #epochs=37, #steps=288
start validation
acc: 0.613636
AUC: 0.845730
Avg Precision: 0.389687
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.121548
valid_loss: 1.120007
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.00012459029344596875
Epoch-37 lr: 0.0002491805868919375
epoch 37 training time: 6.470
---------------
2023-09-12 10:52:16.578365
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01164	Per Sample Data Time 0.00620	Per Sample DNN Time 0.00544	Train Loss 0.1278	
start validation
acc: 0.613636
AUC: 0.846419
Avg Precision: 0.389687
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.103363
valid_loss: 1.120505
validation finished
normal learning rate scheduler step
Epoch-38 lr: 8.242333237877391e-05
Epoch-38 lr: 0.00016484666475754782
epoch 38 training time: 6.585
---------------
2023-09-12 10:52:23.163747
current #epochs=39, #steps=304
start validation
acc: 0.613636
AUC: 0.847107
Avg Precision: 0.389687
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.108356
valid_loss: 1.120757
validation finished
normal learning rate scheduler step
Epoch-39 lr: 8.242333237877391e-05
Epoch-39 lr: 0.00016484666475754782
epoch 39 training time: 6.461
---------------
2023-09-12 10:52:29.625192
current #epochs=40, #steps=312
start validation
acc: 0.636364
AUC: 0.847107
Avg Precision: 0.389687
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.101813
valid_loss: 1.120960
validation finished
normal learning rate scheduler step
Epoch-40 lr: 8.242333237877391e-05
Epoch-40 lr: 0.00016484666475754782
epoch 40 training time: 6.288
---------------
2023-09-12 10:52:35.913577
current #epochs=41, #steps=320
start validation
acc: 0.636364
AUC: 0.847107
Avg Precision: 0.385457
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.092240
valid_loss: 1.120540
validation finished
normal learning rate scheduler step
Epoch-41 lr: 8.242333237877391e-05
Epoch-41 lr: 0.00016484666475754782
epoch 41 training time: 6.770
---------------
2023-09-12 10:52:42.683833
current #epochs=42, #steps=328
start validation
acc: 0.636364
AUC: 0.847107
Avg Precision: 0.385457
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.111717
valid_loss: 1.119961
validation finished
normal learning rate scheduler step
Epoch-42 lr: 5.452756817984406e-05
Epoch-42 lr: 0.00010905513635968811
epoch 42 training time: 6.356
---------------
2023-09-12 10:52:49.039965
current #epochs=43, #steps=336
start validation
[I 2023-09-12 10:52:55,513] Trial 69 finished with value: 0.7272727272727273 and parameters: {'warmup': 'False', 'num_epochs': 43, 'batch_size': 8, 'lr-adaptschedule': 'False', 'lr': 0.003395912767458449, 'head-lr': 2, 'lr-scheduler-start': 6, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.6615550064060051}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.613636
AUC: 0.847107
Avg Precision: 0.385457
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.100104
valid_loss: 1.119817
validation finished
normal learning rate scheduler step
Epoch-43 lr: 5.452756817984406e-05
Epoch-43 lr: 0.00010905513635968811
epoch 43 training time: 6.467
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f957c020bb0>
The learning rate scheduler starts at 5 epoch with decay rate of 0.665 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 10:52:55.551940
current #epochs=1, #steps=0
start validation
acc: 0.613636
AUC: 0.818871
Avg Precision: 0.332909
Avg Recall: 1.000000
d_prime: 1.288446
train_loss: 0.285154
valid_loss: 1.154168
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0036366154220321533
Epoch-1 lr: 0.01090984626609646
epoch 1 training time: 9.574
---------------
2023-09-12 10:53:05.126275
current #epochs=2, #steps=8
start validation
acc: 0.636364
AUC: 0.853994
Avg Precision: 0.382734
Avg Recall: 1.000000
d_prime: 1.490185
train_loss: 0.346845
valid_loss: 1.133414
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0036366154220321533
Epoch-2 lr: 0.01090984626609646
epoch 2 training time: 8.862
---------------
2023-09-12 10:53:13.988189
current #epochs=3, #steps=16
start validation
acc: 0.613636
AUC: 0.858815
Avg Precision: 0.416311
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.269328
valid_loss: 1.093618
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0036366154220321533
Epoch-3 lr: 0.01090984626609646
epoch 3 training time: 7.812
---------------
2023-09-12 10:53:21.799909
current #epochs=4, #steps=24
start validation
acc: 0.704545
AUC: 0.862948
Avg Precision: 0.429763
Avg Recall: 1.000000
d_prime: 1.546667
train_loss: 0.287111
valid_loss: 1.101471
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0036366154220321533
Epoch-4 lr: 0.01090984626609646
epoch 4 training time: 9.202
---------------
2023-09-12 10:53:31.002400
current #epochs=5, #steps=32
start validation
acc: 0.636364
AUC: 0.875344
Avg Precision: 0.421717
Avg Recall: 1.000000
d_prime: 1.629208
train_loss: 0.288502
valid_loss: 1.099714
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0024170681103221864
Epoch-5 lr: 0.007251204330966559
epoch 5 training time: 6.387
---------------
2023-09-12 10:53:37.389330
current #epochs=6, #steps=40
start validation
acc: 0.681818
AUC: 0.867769
Avg Precision: 0.447942
Avg Recall: 1.000000
d_prime: 1.578128
train_loss: 0.290750
valid_loss: 1.094460
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0024170681103221864
Epoch-6 lr: 0.007251204330966559
epoch 6 training time: 6.526
---------------
2023-09-12 10:53:43.915139
current #epochs=7, #steps=48
start validation
acc: 0.613636
AUC: 0.840909
Avg Precision: 0.419086
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.217682
valid_loss: 1.129062
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0024170681103221864
Epoch-7 lr: 0.007251204330966559
epoch 7 training time: 7.607
---------------
2023-09-12 10:53:51.522319
current #epochs=8, #steps=56
start validation
acc: 0.636364
AUC: 0.865702
Avg Precision: 0.460036
Avg Recall: 1.000000
d_prime: 1.564550
train_loss: 0.205226
valid_loss: 1.119416
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0024170681103221864
Epoch-8 lr: 0.007251204330966559
epoch 8 training time: 7.252
---------------
2023-09-12 10:53:58.774638
current #epochs=9, #steps=64
start validation
acc: 0.613636
AUC: 0.861570
Avg Precision: 0.447341
Avg Recall: 1.000000
d_prime: 1.537818
train_loss: 0.162804
valid_loss: 1.107171
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0016064987830557602
Epoch-9 lr: 0.0048194963491672805
epoch 9 training time: 6.406
---------------
2023-09-12 10:54:05.180595
current #epochs=10, #steps=72
start validation
acc: 0.659091
AUC: 0.857438
Avg Precision: 0.395353
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.114520
valid_loss: 1.120746
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0016064987830557602
Epoch-10 lr: 0.0048194963491672805
epoch 10 training time: 6.517
---------------
2023-09-12 10:54:11.697821
current #epochs=11, #steps=80
start validation
acc: 0.636364
AUC: 0.863636
Avg Precision: 0.400954
Avg Recall: 1.000000
d_prime: 1.551114
train_loss: 0.185755
valid_loss: 1.112130
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0016064987830557602
Epoch-11 lr: 0.0048194963491672805
epoch 11 training time: 8.503
---------------
2023-09-12 10:54:20.200659
current #epochs=12, #steps=88
start validation
acc: 0.590909
AUC: 0.871901
Avg Precision: 0.406331
Avg Recall: 1.000000
d_prime: 1.605730
train_loss: 0.138968
valid_loss: 1.096887
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0016064987830557602
Epoch-12 lr: 0.0048194963491672805
epoch 12 training time: 6.636
---------------
2023-09-12 10:54:26.836547
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01137	Per Sample Data Time 0.00592	Per Sample DNN Time 0.00544	Train Loss 0.1889	
start validation
acc: 0.636364
AUC: 0.869146
Avg Precision: 0.375034
Avg Recall: 1.000000
d_prime: 1.587261
train_loss: 0.167804
valid_loss: 1.092366
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0010677557363559865
Epoch-13 lr: 0.0032032672090679592
epoch 13 training time: 6.486
---------------
2023-09-12 10:54:33.322494
current #epochs=14, #steps=104
start validation
acc: 0.681818
AUC: 0.866391
Avg Precision: 0.376314
Avg Recall: 1.000000
d_prime: 1.569060
train_loss: 0.164566
valid_loss: 1.095567
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0010677557363559865
Epoch-14 lr: 0.0032032672090679592
epoch 14 training time: 6.387
---------------
2023-09-12 10:54:39.709627
current #epochs=15, #steps=112
start validation
acc: 0.659091
AUC: 0.860193
Avg Precision: 0.391915
Avg Recall: 1.000000
d_prime: 1.529028
train_loss: 0.164000
valid_loss: 1.106976
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0010677557363559865
Epoch-15 lr: 0.0032032672090679592
epoch 15 training time: 6.365
---------------
2023-09-12 10:54:46.074948
current #epochs=16, #steps=120
start validation
acc: 0.613636
AUC: 0.865702
Avg Precision: 0.420424
Avg Recall: 1.000000
d_prime: 1.564550
train_loss: 0.128821
valid_loss: 1.113979
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0010677557363559865
Epoch-16 lr: 0.0032032672090679592
epoch 16 training time: 7.769
---------------
2023-09-12 10:54:53.844067
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.864325
Avg Precision: 0.401140
Avg Recall: 1.000000
d_prime: 1.555577
train_loss: 0.115179
valid_loss: 1.115372
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0007096814043970197
Epoch-17 lr: 0.0021290442131910586
epoch 17 training time: 6.630
---------------
2023-09-12 10:55:00.473755
current #epochs=18, #steps=136
start validation
acc: 0.636364
AUC: 0.862948
Avg Precision: 0.384491
Avg Recall: 1.000000
d_prime: 1.546667
train_loss: 0.156182
valid_loss: 1.111829
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0007096814043970197
Epoch-18 lr: 0.0021290442131910586
epoch 18 training time: 6.458
---------------
2023-09-12 10:55:06.932346
current #epochs=19, #steps=144
start validation
acc: 0.636364
AUC: 0.860882
Avg Precision: 0.378877
Avg Recall: 1.000000
d_prime: 1.533415
train_loss: 0.135303
valid_loss: 1.107091
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0007096814043970197
Epoch-19 lr: 0.0021290442131910586
epoch 19 training time: 6.470
---------------
2023-09-12 10:55:13.401577
current #epochs=20, #steps=152
start validation
acc: 0.659091
AUC: 0.862259
Avg Precision: 0.382426
Avg Recall: 1.000000
d_prime: 1.542235
train_loss: 0.186411
valid_loss: 1.104347
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0007096814043970197
Epoch-20 lr: 0.0021290442131910586
epoch 20 training time: 6.522
---------------
2023-09-12 10:55:19.923501
current #epochs=21, #steps=160
start validation
acc: 0.659091
AUC: 0.856749
Avg Precision: 0.373214
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.113811
valid_loss: 1.107398
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0004716881198557303
Epoch-21 lr: 0.0014150643595671906
epoch 21 training time: 6.341
---------------
2023-09-12 10:55:26.264661
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.853994
Avg Precision: 0.368580
Avg Recall: 1.000000
d_prime: 1.490185
train_loss: 0.158856
valid_loss: 1.107944
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0004716881198557303
Epoch-22 lr: 0.0014150643595671906
epoch 22 training time: 6.367
---------------
2023-09-12 10:55:32.631651
current #epochs=23, #steps=176
start validation
acc: 0.613636
AUC: 0.853306
Avg Precision: 0.370592
Avg Recall: 1.000000
d_prime: 1.485939
train_loss: 0.126801
valid_loss: 1.109780
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0004716881198557303
Epoch-23 lr: 0.0014150643595671906
epoch 23 training time: 6.508
---------------
2023-09-12 10:55:39.139767
current #epochs=24, #steps=184
start validation
acc: 0.590909
AUC: 0.851240
Avg Precision: 0.372269
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.130999
valid_loss: 1.112432
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0004716881198557303
Epoch-24 lr: 0.0014150643595671906
epoch 24 training time: 7.188
---------------
2023-09-12 10:55:46.327146
current #epochs=25, #steps=192
start validation
acc: 0.613636
AUC: 0.852617
Avg Precision: 0.370592
Avg Recall: 1.000000
d_prime: 1.481705
train_loss: 0.187503
valid_loss: 1.111801
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00031350642842624854
Epoch-25 lr: 0.0009405192852787455
epoch 25 training time: 7.132
---------------
2023-09-12 10:55:53.459010
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03770	Per Sample Data Time 0.03048	Per Sample DNN Time 0.00721	Train Loss 0.0366	
start validation
acc: 0.636364
AUC: 0.853306
Avg Precision: 0.372269
Avg Recall: 1.000000
d_prime: 1.485939
train_loss: 0.097157
valid_loss: 1.107917
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00031350642842624854
Epoch-26 lr: 0.0009405192852787455
epoch 26 training time: 6.513
---------------
2023-09-12 10:55:59.972483
current #epochs=27, #steps=208
start validation
acc: 0.636364
AUC: 0.853306
Avg Precision: 0.376852
Avg Recall: 1.000000
d_prime: 1.485939
train_loss: 0.114185
valid_loss: 1.106223
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00031350642842624854
Epoch-27 lr: 0.0009405192852787455
epoch 27 training time: 6.474
---------------
2023-09-12 10:56:06.445943
current #epochs=28, #steps=216
start validation
acc: 0.636364
AUC: 0.855372
Avg Precision: 0.376852
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.095081
valid_loss: 1.105965
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00031350642842624854
Epoch-28 lr: 0.0009405192852787455
epoch 28 training time: 6.636
---------------
2023-09-12 10:56:13.081589
current #epochs=29, #steps=224
start validation
acc: 0.636364
AUC: 0.855372
Avg Precision: 0.376852
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.089576
valid_loss: 1.105198
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00020837132954428485
Epoch-29 lr: 0.0006251139886328545
epoch 29 training time: 6.611
---------------
2023-09-12 10:56:19.692333
current #epochs=30, #steps=232
start validation
acc: 0.636364
AUC: 0.855372
Avg Precision: 0.376852
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.112984
valid_loss: 1.104201
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00020837132954428485
Epoch-30 lr: 0.0006251139886328545
epoch 30 training time: 7.133
---------------
2023-09-12 10:56:26.825119
current #epochs=31, #steps=240
start validation
acc: 0.636364
AUC: 0.856061
Avg Precision: 0.372269
Avg Recall: 1.000000
d_prime: 1.503007
train_loss: 0.131891
valid_loss: 1.102436
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.00020837132954428485
Epoch-31 lr: 0.0006251139886328545
epoch 31 training time: 8.138
---------------
2023-09-12 10:56:34.962847
current #epochs=32, #steps=248
start validation
acc: 0.613636
AUC: 0.857438
Avg Precision: 0.375887
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.128984
valid_loss: 1.102197
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00020837132954428485
Epoch-32 lr: 0.0006251139886328545
epoch 32 training time: 6.471
---------------
2023-09-12 10:56:41.433890
current #epochs=33, #steps=256
start validation
acc: 0.613636
AUC: 0.860193
Avg Precision: 0.379907
Avg Recall: 1.000000
d_prime: 1.529028
train_loss: 0.127748
valid_loss: 1.103408
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0001384935268919599
Epoch-33 lr: 0.00041548058067587964
epoch 33 training time: 6.524
---------------
2023-09-12 10:56:47.957710
current #epochs=34, #steps=264
start validation
acc: 0.613636
AUC: 0.860882
Avg Precision: 0.379907
Avg Recall: 1.000000
d_prime: 1.533415
train_loss: 0.107957
valid_loss: 1.104773
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0001384935268919599
Epoch-34 lr: 0.00041548058067587964
epoch 34 training time: 7.386
---------------
2023-09-12 10:56:55.343346
current #epochs=35, #steps=272
start validation
acc: 0.613636
AUC: 0.859504
Avg Precision: 0.379907
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.139775
valid_loss: 1.104895
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0001384935268919599
Epoch-35 lr: 0.00041548058067587964
epoch 35 training time: 6.449
---------------
2023-09-12 10:57:01.792345
current #epochs=36, #steps=280
start validation
acc: 0.613636
AUC: 0.858815
Avg Precision: 0.377843
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.087410
valid_loss: 1.104473
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0001384935268919599
Epoch-36 lr: 0.00041548058067587964
epoch 36 training time: 7.189
---------------
2023-09-12 10:57:08.981705
current #epochs=37, #steps=288
start validation
acc: 0.613636
AUC: 0.860193
Avg Precision: 0.377843
Avg Recall: 1.000000
d_prime: 1.529028
train_loss: 0.131616
valid_loss: 1.104164
validation finished
normal learning rate scheduler step
Epoch-37 lr: 9.204940541926919e-05
Epoch-37 lr: 0.00027614821625780755
epoch 37 training time: 6.811
---------------
2023-09-12 10:57:15.792674
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01219	Per Sample Data Time 0.00632	Per Sample DNN Time 0.00587	Train Loss 0.1160	
start validation
acc: 0.613636
AUC: 0.859504
Avg Precision: 0.375887
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.144717
valid_loss: 1.104648
validation finished
normal learning rate scheduler step
Epoch-38 lr: 9.204940541926919e-05
Epoch-38 lr: 0.00027614821625780755
epoch 38 training time: 6.403
---------------
2023-09-12 10:57:22.196134
current #epochs=39, #steps=304
start validation
acc: 0.613636
AUC: 0.859504
Avg Precision: 0.377843
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.092173
valid_loss: 1.104947
validation finished
normal learning rate scheduler step
Epoch-39 lr: 9.204940541926919e-05
Epoch-39 lr: 0.00027614821625780755
epoch 39 training time: 6.335
---------------
2023-09-12 10:57:28.531302
current #epochs=40, #steps=312
start validation
acc: 0.613636
AUC: 0.860193
Avg Precision: 0.377843
Avg Recall: 1.000000
d_prime: 1.529028
train_loss: 0.125485
valid_loss: 1.103889
validation finished
normal learning rate scheduler step
Epoch-40 lr: 9.204940541926919e-05
Epoch-40 lr: 0.00027614821625780755
epoch 40 training time: 6.395
---------------
2023-09-12 10:57:34.926623
current #epochs=41, #steps=320
start validation
acc: 0.613636
AUC: 0.860882
Avg Precision: 0.382090
Avg Recall: 1.000000
d_prime: 1.533415
train_loss: 0.129789
valid_loss: 1.103556
validation finished
normal learning rate scheduler step
Epoch-41 lr: 6.118042646607537e-05
Epoch-41 lr: 0.00018354127939822608
epoch 41 training time: 7.474
---------------
2023-09-12 10:57:42.400690
current #epochs=42, #steps=328
start validation
acc: 0.613636
AUC: 0.861570
Avg Precision: 0.382090
Avg Recall: 1.000000
d_prime: 1.537818
train_loss: 0.086437
valid_loss: 1.103554
validation finished
normal learning rate scheduler step
Epoch-42 lr: 6.118042646607537e-05
Epoch-42 lr: 0.00018354127939822608
epoch 42 training time: 6.540
---------------
2023-09-12 10:57:48.940991
current #epochs=43, #steps=336
start validation
[I 2023-09-12 10:57:55,433] Trial 70 finished with value: 0.7045454545454546 and parameters: {'warmup': 'False', 'num_epochs': 43, 'batch_size': 8, 'lr-adaptschedule': 'False', 'lr': 0.0036366154220321533, 'head-lr': 3, 'lr-scheduler-start': 5, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.6646477094274434}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.613636
AUC: 0.861570
Avg Precision: 0.382090
Avg Recall: 1.000000
d_prime: 1.537818
train_loss: 0.127572
valid_loss: 1.103204
validation finished
normal learning rate scheduler step
Epoch-43 lr: 6.118042646607537e-05
Epoch-43 lr: 0.00018354127939822608
epoch 43 training time: 6.487
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95bc7a7730>
The learning rate scheduler starts at 6 epoch with decay rate of 0.653 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 10:57:55.470868
current #epochs=1, #steps=0
start validation
acc: 0.659091
AUC: 0.874656
Avg Precision: 0.411495
Avg Recall: 1.000000
d_prime: 1.624476
train_loss: 0.258520
valid_loss: 1.111612
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003016064537883152
Epoch-1 lr: 0.006032129075766304
epoch 1 training time: 9.366
---------------
2023-09-12 10:58:04.837585
current #epochs=2, #steps=8
start validation
acc: 0.704545
AUC: 0.856061
Avg Precision: 0.424668
Avg Recall: 1.000000
d_prime: 1.503007
train_loss: 0.307820
valid_loss: 1.115809
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003016064537883152
Epoch-2 lr: 0.006032129075766304
epoch 2 training time: 10.296
---------------
2023-09-12 10:58:15.132979
current #epochs=3, #steps=16
start validation
acc: 0.681818
AUC: 0.846419
Avg Precision: 0.431283
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.204315
valid_loss: 1.142576
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003016064537883152
Epoch-3 lr: 0.006032129075766304
epoch 3 training time: 6.678
---------------
2023-09-12 10:58:21.810891
current #epochs=4, #steps=24
start validation
acc: 0.636364
AUC: 0.858815
Avg Precision: 0.456756
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.191916
valid_loss: 1.131043
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003016064537883152
Epoch-4 lr: 0.006032129075766304
epoch 4 training time: 6.651
---------------
2023-09-12 10:58:28.462226
current #epochs=5, #steps=32
start validation
acc: 0.681818
AUC: 0.862948
Avg Precision: 0.434320
Avg Recall: 1.000000
d_prime: 1.546667
train_loss: 0.166161
valid_loss: 1.124594
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.003016064537883152
Epoch-5 lr: 0.006032129075766304
epoch 5 training time: 6.498
---------------
2023-09-12 10:58:34.960484
current #epochs=6, #steps=40
start validation
acc: 0.636364
AUC: 0.856061
Avg Precision: 0.401237
Avg Recall: 1.000000
d_prime: 1.503007
train_loss: 0.268081
valid_loss: 1.119414
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.001968885994667951
Epoch-6 lr: 0.003937771989335902
epoch 6 training time: 6.402
---------------
2023-09-12 10:58:41.362118
current #epochs=7, #steps=48
start validation
acc: 0.659091
AUC: 0.859504
Avg Precision: 0.430702
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.250487
valid_loss: 1.118566
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.001968885994667951
Epoch-7 lr: 0.003937771989335902
epoch 7 training time: 6.556
---------------
2023-09-12 10:58:47.918292
current #epochs=8, #steps=56
start validation
acc: 0.727273
AUC: 0.867769
Avg Precision: 0.440543
Avg Recall: 1.000000
d_prime: 1.578128
train_loss: 0.253374
valid_loss: 1.124464
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001968885994667951
Epoch-8 lr: 0.003937771989335902
epoch 8 training time: 9.540
---------------
2023-09-12 10:58:57.458761
current #epochs=9, #steps=64
start validation
acc: 0.681818
AUC: 0.859504
Avg Precision: 0.412848
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.224707
valid_loss: 1.125359
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001968885994667951
Epoch-9 lr: 0.003937771989335902
epoch 9 training time: 6.763
---------------
2023-09-12 10:59:04.222023
current #epochs=10, #steps=72
start validation
acc: 0.727273
AUC: 0.860882
Avg Precision: 0.404924
Avg Recall: 1.000000
d_prime: 1.533415
train_loss: 0.179000
valid_loss: 1.110515
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001968885994667951
Epoch-10 lr: 0.003937771989335902
epoch 10 training time: 6.451
---------------
2023-09-12 10:59:10.672653
current #epochs=11, #steps=80
start validation
acc: 0.704545
AUC: 0.870523
Avg Precision: 0.404168
Avg Recall: 1.000000
d_prime: 1.596462
train_loss: 0.191637
valid_loss: 1.107253
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0012852881665192638
Epoch-11 lr: 0.0025705763330385275
epoch 11 training time: 6.729
---------------
2023-09-12 10:59:17.401483
current #epochs=12, #steps=88
start validation
acc: 0.659091
AUC: 0.867080
Avg Precision: 0.397222
Avg Recall: 1.000000
d_prime: 1.573586
train_loss: 0.190022
valid_loss: 1.113561
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0012852881665192638
Epoch-12 lr: 0.0025705763330385275
epoch 12 training time: 7.571
---------------
2023-09-12 10:59:24.972122
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01234	Per Sample Data Time 0.00659	Per Sample DNN Time 0.00575	Train Loss 0.1744	
start validation
acc: 0.750000
AUC: 0.871901
Avg Precision: 0.397861
Avg Recall: 1.000000
d_prime: 1.605730
train_loss: 0.173883
valid_loss: 1.104787
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0012852881665192638
Epoch-13 lr: 0.0025705763330385275
epoch 13 training time: 9.762
---------------
2023-09-12 10:59:34.733415
current #epochs=14, #steps=104
start validation
acc: 0.727273
AUC: 0.871212
Avg Precision: 0.403890
Avg Recall: 1.000000
d_prime: 1.601087
train_loss: 0.148397
valid_loss: 1.108039
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0012852881665192638
Epoch-14 lr: 0.0025705763330385275
epoch 14 training time: 6.417
---------------
2023-09-12 10:59:41.150095
current #epochs=15, #steps=112
start validation
acc: 0.704545
AUC: 0.870523
Avg Precision: 0.443056
Avg Recall: 1.000000
d_prime: 1.596462
train_loss: 0.182017
valid_loss: 1.100959
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0012852881665192638
Epoch-15 lr: 0.0025705763330385275
epoch 15 training time: 7.153
---------------
2023-09-12 10:59:48.302635
current #epochs=16, #steps=120
start validation
acc: 0.704545
AUC: 0.873278
Avg Precision: 0.442328
Avg Recall: 1.000000
d_prime: 1.615068
train_loss: 0.142228
valid_loss: 1.102544
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0008390357163737414
Epoch-16 lr: 0.0016780714327474828
epoch 16 training time: 6.592
---------------
2023-09-12 10:59:54.894328
current #epochs=17, #steps=128
start validation
acc: 0.704545
AUC: 0.867769
Avg Precision: 0.415145
Avg Recall: 1.000000
d_prime: 1.578128
train_loss: 0.154295
valid_loss: 1.113205
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0008390357163737414
Epoch-17 lr: 0.0016780714327474828
epoch 17 training time: 6.514
---------------
2023-09-12 11:00:01.408697
current #epochs=18, #steps=136
start validation
acc: 0.727273
AUC: 0.873967
Avg Precision: 0.424044
Avg Recall: 1.000000
d_prime: 1.619763
train_loss: 0.115957
valid_loss: 1.109711
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0008390357163737414
Epoch-18 lr: 0.0016780714327474828
epoch 18 training time: 6.639
---------------
2023-09-12 11:00:08.047573
current #epochs=19, #steps=144
start validation
acc: 0.704545
AUC: 0.871901
Avg Precision: 0.422789
Avg Recall: 1.000000
d_prime: 1.605730
train_loss: 0.189754
valid_loss: 1.101315
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0008390357163737414
Epoch-19 lr: 0.0016780714327474828
epoch 19 training time: 7.381
---------------
2023-09-12 11:00:15.428297
current #epochs=20, #steps=152
start validation
acc: 0.681818
AUC: 0.876033
Avg Precision: 0.407318
Avg Recall: 1.000000
d_prime: 1.633957
train_loss: 0.172229
valid_loss: 1.101771
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0008390357163737414
Epoch-20 lr: 0.0016780714327474828
epoch 20 training time: 7.312
---------------
2023-09-12 11:00:22.740264
current #epochs=21, #steps=160
start validation
acc: 0.681818
AUC: 0.879477
Avg Precision: 0.407318
Avg Recall: 1.000000
d_prime: 1.657988
train_loss: 0.174463
valid_loss: 1.104360
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0005477222553579359
Epoch-21 lr: 0.0010954445107158718
epoch 21 training time: 7.345
---------------
2023-09-12 11:00:30.085569
current #epochs=22, #steps=168
start validation
acc: 0.659091
AUC: 0.881543
Avg Precision: 0.411901
Avg Recall: 1.000000
d_prime: 1.672638
train_loss: 0.130024
valid_loss: 1.098745
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0005477222553579359
Epoch-22 lr: 0.0010954445107158718
epoch 22 training time: 6.294
---------------
2023-09-12 11:00:36.379714
current #epochs=23, #steps=176
start validation
acc: 0.659091
AUC: 0.875344
Avg Precision: 0.420800
Avg Recall: 1.000000
d_prime: 1.629208
train_loss: 0.191807
valid_loss: 1.101889
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0005477222553579359
Epoch-23 lr: 0.0010954445107158718
epoch 23 training time: 6.499
---------------
2023-09-12 11:00:42.879035
current #epochs=24, #steps=184
start validation
acc: 0.681818
AUC: 0.876033
Avg Precision: 0.413507
Avg Recall: 1.000000
d_prime: 1.633957
train_loss: 0.127416
valid_loss: 1.107181
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0005477222553579359
Epoch-24 lr: 0.0010954445107158718
epoch 24 training time: 6.459
---------------
2023-09-12 11:00:49.338255
current #epochs=25, #steps=192
start validation
acc: 0.659091
AUC: 0.871212
Avg Precision: 0.415818
Avg Recall: 1.000000
d_prime: 1.601087
train_loss: 0.105224
valid_loss: 1.112947
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0005477222553579359
Epoch-25 lr: 0.0010954445107158718
epoch 25 training time: 6.438
---------------
2023-09-12 11:00:55.776037
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03811	Per Sample Data Time 0.03218	Per Sample DNN Time 0.00594	Train Loss 0.0823	
start validation
acc: 0.659091
AUC: 0.870523
Avg Precision: 0.415818
Avg Recall: 1.000000
d_prime: 1.596462
train_loss: 0.138251
valid_loss: 1.112806
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00035755291837987933
Epoch-26 lr: 0.0007151058367597587
epoch 26 training time: 6.563
---------------
2023-09-12 11:01:02.338781
current #epochs=27, #steps=208
start validation
acc: 0.681818
AUC: 0.871212
Avg Precision: 0.413507
Avg Recall: 1.000000
d_prime: 1.601087
train_loss: 0.143340
valid_loss: 1.112825
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00035755291837987933
Epoch-27 lr: 0.0007151058367597587
epoch 27 training time: 6.472
---------------
2023-09-12 11:01:08.811241
current #epochs=28, #steps=216
start validation
acc: 0.704545
AUC: 0.869835
Avg Precision: 0.404693
Avg Recall: 1.000000
d_prime: 1.591853
train_loss: 0.148070
valid_loss: 1.112480
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00035755291837987933
Epoch-28 lr: 0.0007151058367597587
epoch 28 training time: 6.548
---------------
2023-09-12 11:01:15.358867
current #epochs=29, #steps=224
start validation
acc: 0.681818
AUC: 0.866391
Avg Precision: 0.403087
Avg Recall: 1.000000
d_prime: 1.569060
train_loss: 0.100290
valid_loss: 1.112154
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00035755291837987933
Epoch-29 lr: 0.0007151058367597587
epoch 29 training time: 6.547
---------------
2023-09-12 11:01:21.905986
current #epochs=30, #steps=232
start validation
acc: 0.681818
AUC: 0.863636
Avg Precision: 0.404877
Avg Recall: 1.000000
d_prime: 1.551114
train_loss: 0.160531
valid_loss: 1.111308
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00035755291837987933
Epoch-30 lr: 0.0007151058367597587
epoch 30 training time: 6.329
---------------
2023-09-12 11:01:28.234591
current #epochs=31, #steps=240
start validation
acc: 0.681818
AUC: 0.863636
Avg Precision: 0.406698
Avg Recall: 1.000000
d_prime: 1.551114
train_loss: 0.113128
valid_loss: 1.107266
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.00023341043419611036
Epoch-31 lr: 0.0004668208683922207
epoch 31 training time: 7.018
---------------
2023-09-12 11:01:35.252481
current #epochs=32, #steps=248
start validation
acc: 0.704545
AUC: 0.862259
Avg Precision: 0.403741
Avg Recall: 1.000000
d_prime: 1.542235
train_loss: 0.105467
valid_loss: 1.106611
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00023341043419611036
Epoch-32 lr: 0.0004668208683922207
epoch 32 training time: 6.774
---------------
2023-09-12 11:01:42.026582
current #epochs=33, #steps=256
start validation
acc: 0.681818
AUC: 0.866391
Avg Precision: 0.408722
Avg Recall: 1.000000
d_prime: 1.569060
train_loss: 0.129637
valid_loss: 1.105644
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.00023341043419611036
Epoch-33 lr: 0.0004668208683922207
epoch 33 training time: 8.350
---------------
2023-09-12 11:01:50.376697
current #epochs=34, #steps=264
start validation
acc: 0.659091
AUC: 0.867769
Avg Precision: 0.408722
Avg Recall: 1.000000
d_prime: 1.578128
train_loss: 0.111860
valid_loss: 1.104593
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.00023341043419611036
Epoch-34 lr: 0.0004668208683922207
epoch 34 training time: 7.139
---------------
2023-09-12 11:01:57.515659
current #epochs=35, #steps=272
start validation
acc: 0.659091
AUC: 0.869146
Avg Precision: 0.408722
Avg Recall: 1.000000
d_prime: 1.587261
train_loss: 0.083794
valid_loss: 1.103867
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.00023341043419611036
Epoch-35 lr: 0.0004668208683922207
epoch 35 training time: 6.278
---------------
2023-09-12 11:02:03.793372
current #epochs=36, #steps=280
start validation
acc: 0.659091
AUC: 0.869146
Avg Precision: 0.408722
Avg Recall: 1.000000
d_prime: 1.587261
train_loss: 0.116932
valid_loss: 1.103290
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0001523702590331942
Epoch-36 lr: 0.0003047405180663884
epoch 36 training time: 8.855
---------------
2023-09-12 11:02:12.648328
current #epochs=37, #steps=288
start validation
acc: 0.659091
AUC: 0.867769
Avg Precision: 0.403741
Avg Recall: 1.000000
d_prime: 1.578128
train_loss: 0.117680
valid_loss: 1.103054
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0001523702590331942
Epoch-37 lr: 0.0003047405180663884
epoch 37 training time: 6.425
---------------
2023-09-12 11:02:19.072818
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01170	Per Sample Data Time 0.00615	Per Sample DNN Time 0.00555	Train Loss 0.0892	
start validation
acc: 0.681818
AUC: 0.864325
Avg Precision: 0.398759
Avg Recall: 1.000000
d_prime: 1.555577
train_loss: 0.105645
valid_loss: 1.103565
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0001523702590331942
Epoch-38 lr: 0.0003047405180663884
epoch 38 training time: 6.606
---------------
2023-09-12 11:02:25.679076
current #epochs=39, #steps=304
start validation
acc: 0.681818
AUC: 0.863636
Avg Precision: 0.398759
Avg Recall: 1.000000
d_prime: 1.551114
train_loss: 0.151512
valid_loss: 1.103671
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0001523702590331942
Epoch-39 lr: 0.0003047405180663884
epoch 39 training time: 7.664
---------------
2023-09-12 11:02:33.343264
current #epochs=40, #steps=312
start validation
acc: 0.681818
AUC: 0.863636
Avg Precision: 0.398759
Avg Recall: 1.000000
d_prime: 1.551114
train_loss: 0.161924
valid_loss: 1.105103
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0001523702590331942
Epoch-40 lr: 0.0003047405180663884
epoch 40 training time: 6.635
---------------
2023-09-12 11:02:39.978991
current #epochs=41, #steps=320
start validation
acc: 0.681818
AUC: 0.861570
Avg Precision: 0.398759
Avg Recall: 1.000000
d_prime: 1.537818
train_loss: 0.115130
valid_loss: 1.106051
validation finished
normal learning rate scheduler step
Epoch-41 lr: 9.946725782762626e-05
Epoch-41 lr: 0.00019893451565525252
epoch 41 training time: 7.152
---------------
2023-09-12 11:02:47.130818
current #epochs=42, #steps=328
start validation
[I 2023-09-12 11:02:54,458] Trial 71 finished with value: 0.75 and parameters: {'warmup': 'False', 'num_epochs': 42, 'batch_size': 10, 'lr-adaptschedule': 'False', 'lr': 0.003016064537883152, 'head-lr': 2, 'lr-scheduler-start': 6, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.6527996897738232}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.681818
AUC: 0.861570
Avg Precision: 0.398759
Avg Recall: 1.000000
d_prime: 1.537818
train_loss: 0.100165
valid_loss: 1.106212
validation finished
normal learning rate scheduler step
Epoch-42 lr: 9.946725782762626e-05
Epoch-42 lr: 0.00019893451565525252
epoch 42 training time: 7.322
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8ee0af0>
The learning rate scheduler starts at 7 epoch with decay rate of 0.667 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 11:02:54.496651
current #epochs=1, #steps=0
start validation
acc: 0.613636
AUC: 0.813361
Avg Precision: 0.328181
Avg Recall: 1.000000
d_prime: 1.259144
train_loss: 0.238023
valid_loss: 1.161787
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0034001084921580263
Epoch-1 lr: 0.006800216984316053
epoch 1 training time: 9.582
---------------
2023-09-12 11:03:04.079370
current #epochs=2, #steps=8
start validation
acc: 0.659091
AUC: 0.835399
Avg Precision: 0.395710
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.223193
valid_loss: 1.170839
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0034001084921580263
Epoch-2 lr: 0.006800216984316053
epoch 2 training time: 14.284
---------------
2023-09-12 11:03:18.363456
current #epochs=3, #steps=16
start validation
acc: 0.659091
AUC: 0.828512
Avg Precision: 0.365424
Avg Recall: 1.000000
d_prime: 1.341103
train_loss: 0.236016
valid_loss: 1.153350
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0034001084921580263
Epoch-3 lr: 0.006800216984316053
epoch 3 training time: 6.476
---------------
2023-09-12 11:03:24.839761
current #epochs=4, #steps=24
start validation
acc: 0.613636
AUC: 0.806474
Avg Precision: 0.325540
Avg Recall: 1.000000
d_prime: 1.223260
train_loss: 0.190628
valid_loss: 1.159520
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0034001084921580263
Epoch-4 lr: 0.006800216984316053
epoch 4 training time: 6.485
---------------
2023-09-12 11:03:31.325162
current #epochs=5, #steps=32
start validation
acc: 0.636364
AUC: 0.817493
Avg Precision: 0.362689
Avg Recall: 1.000000
d_prime: 1.281069
train_loss: 0.203653
valid_loss: 1.154428
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0034001084921580263
Epoch-5 lr: 0.006800216984316053
epoch 5 training time: 6.475
---------------
2023-09-12 11:03:37.800103
current #epochs=6, #steps=40
start validation
acc: 0.568182
AUC: 0.841598
Avg Precision: 0.410634
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.264339
valid_loss: 1.165472
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0034001084921580263
Epoch-6 lr: 0.006800216984316053
epoch 6 training time: 6.580
---------------
2023-09-12 11:03:44.380284
current #epochs=7, #steps=48
start validation
acc: 0.659091
AUC: 0.845730
Avg Precision: 0.378201
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.215709
valid_loss: 1.129358
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0022691561038063715
Epoch-7 lr: 0.004538312207612743
epoch 7 training time: 6.350
---------------
2023-09-12 11:03:50.730419
current #epochs=8, #steps=56
start validation
acc: 0.636364
AUC: 0.838154
Avg Precision: 0.376970
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.195799
valid_loss: 1.118912
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0022691561038063715
Epoch-8 lr: 0.004538312207612743
epoch 8 training time: 6.489
---------------
2023-09-12 11:03:57.219480
current #epochs=9, #steps=64
start validation
acc: 0.681818
AUC: 0.858127
Avg Precision: 0.400411
Avg Recall: 1.000000
d_prime: 1.515953
train_loss: 0.213115
valid_loss: 1.113719
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0022691561038063715
Epoch-9 lr: 0.004538312207612743
epoch 9 training time: 13.886
---------------
2023-09-12 11:04:11.105515
current #epochs=10, #steps=72
start validation
acc: 0.636364
AUC: 0.867080
Avg Precision: 0.474934
Avg Recall: 1.000000
d_prime: 1.573586
train_loss: 0.114358
valid_loss: 1.104486
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0015143838601966587
Epoch-10 lr: 0.0030287677203933174
epoch 10 training time: 8.379
---------------
2023-09-12 11:04:19.484406
current #epochs=11, #steps=80
start validation
acc: 0.636364
AUC: 0.858127
Avg Precision: 0.464334
Avg Recall: 1.000000
d_prime: 1.515953
train_loss: 0.144758
valid_loss: 1.110931
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0015143838601966587
Epoch-11 lr: 0.0030287677203933174
epoch 11 training time: 6.284
---------------
2023-09-12 11:04:25.768348
current #epochs=12, #steps=88
start validation
acc: 0.636364
AUC: 0.863636
Avg Precision: 0.444592
Avg Recall: 1.000000
d_prime: 1.551114
train_loss: 0.145057
valid_loss: 1.099013
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0015143838601966587
Epoch-12 lr: 0.0030287677203933174
epoch 12 training time: 6.414
---------------
2023-09-12 11:04:32.182540
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01180	Per Sample Data Time 0.00636	Per Sample DNN Time 0.00544	Train Loss 0.1243	
start validation
acc: 0.636364
AUC: 0.865014
Avg Precision: 0.424511
Avg Recall: 1.000000
d_prime: 1.560056
train_loss: 0.130241
valid_loss: 1.105043
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0010106658031050237
Epoch-13 lr: 0.0020213316062100473
epoch 13 training time: 6.449
---------------
2023-09-12 11:04:38.631219
current #epochs=14, #steps=104
start validation
acc: 0.636364
AUC: 0.858815
Avg Precision: 0.392485
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.136666
valid_loss: 1.114430
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0010106658031050237
Epoch-14 lr: 0.0020213316062100473
epoch 14 training time: 6.672
---------------
2023-09-12 11:04:45.303896
current #epochs=15, #steps=112
start validation
acc: 0.636364
AUC: 0.865014
Avg Precision: 0.400040
Avg Recall: 1.000000
d_prime: 1.560056
train_loss: 0.121077
valid_loss: 1.097909
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0010106658031050237
Epoch-15 lr: 0.0020213316062100473
epoch 15 training time: 6.397
---------------
2023-09-12 11:04:51.700810
current #epochs=16, #steps=120
start validation
acc: 0.659091
AUC: 0.872590
Avg Precision: 0.421907
Avg Recall: 1.000000
d_prime: 1.610390
train_loss: 0.157889
valid_loss: 1.088875
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0006744956760390177
Epoch-16 lr: 0.0013489913520780355
epoch 16 training time: 7.197
---------------
2023-09-12 11:04:58.897914
current #epochs=17, #steps=128
start validation
acc: 0.659091
AUC: 0.868457
Avg Precision: 0.405992
Avg Recall: 1.000000
d_prime: 1.582686
train_loss: 0.105259
valid_loss: 1.098827
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0006744956760390177
Epoch-17 lr: 0.0013489913520780355
epoch 17 training time: 6.584
---------------
2023-09-12 11:05:05.482383
current #epochs=18, #steps=136
start validation
acc: 0.659091
AUC: 0.859504
Avg Precision: 0.393066
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.183895
valid_loss: 1.110522
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0006744956760390177
Epoch-18 lr: 0.0013489913520780355
epoch 18 training time: 6.478
---------------
2023-09-12 11:05:11.960682
current #epochs=19, #steps=144
start validation
acc: 0.659091
AUC: 0.871212
Avg Precision: 0.417989
Avg Recall: 1.000000
d_prime: 1.601087
train_loss: 0.124810
valid_loss: 1.105115
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00045014327742922143
Epoch-19 lr: 0.0009002865548584429
epoch 19 training time: 6.418
---------------
2023-09-12 11:05:18.378824
current #epochs=20, #steps=152
start validation
acc: 0.636364
AUC: 0.871212
Avg Precision: 0.427083
Avg Recall: 1.000000
d_prime: 1.601087
train_loss: 0.135488
valid_loss: 1.099250
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00045014327742922143
Epoch-20 lr: 0.0009002865548584429
epoch 20 training time: 7.220
---------------
2023-09-12 11:05:25.598475
current #epochs=21, #steps=160
start validation
acc: 0.636364
AUC: 0.871212
Avg Precision: 0.437500
Avg Recall: 1.000000
d_prime: 1.601087
train_loss: 0.129269
valid_loss: 1.094013
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00045014327742922143
Epoch-21 lr: 0.0009002865548584429
epoch 21 training time: 7.188
---------------
2023-09-12 11:05:32.786845
current #epochs=22, #steps=168
start validation
acc: 0.613636
AUC: 0.873967
Avg Precision: 0.440104
Avg Recall: 1.000000
d_prime: 1.619763
train_loss: 0.118253
valid_loss: 1.095840
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00030041552142285265
Epoch-22 lr: 0.0006008310428457053
epoch 22 training time: 6.316
---------------
2023-09-12 11:05:39.102375
current #epochs=23, #steps=176
start validation
acc: 0.613636
AUC: 0.871901
Avg Precision: 0.431283
Avg Recall: 1.000000
d_prime: 1.605730
train_loss: 0.168418
valid_loss: 1.097670
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00030041552142285265
Epoch-23 lr: 0.0006008310428457053
epoch 23 training time: 6.485
---------------
2023-09-12 11:05:45.587326
current #epochs=24, #steps=184
start validation
acc: 0.659091
AUC: 0.871212
Avg Precision: 0.434055
Avg Recall: 1.000000
d_prime: 1.601087
train_loss: 0.121213
valid_loss: 1.100016
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00030041552142285265
Epoch-24 lr: 0.0006008310428457053
epoch 24 training time: 6.655
---------------
2023-09-12 11:05:52.242550
current #epochs=25, #steps=192
start validation
acc: 0.613636
AUC: 0.871212
Avg Precision: 0.422955
Avg Recall: 1.000000
d_prime: 1.601087
train_loss: 0.114232
valid_loss: 1.101433
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0002004905771939577
Epoch-25 lr: 0.0004009811543879154
epoch 25 training time: 6.698
---------------
2023-09-12 11:05:58.940982
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03695	Per Sample Data Time 0.02956	Per Sample DNN Time 0.00739	Train Loss 0.1035	
start validation
acc: 0.613636
AUC: 0.869146
Avg Precision: 0.422955
Avg Recall: 1.000000
d_prime: 1.587261
train_loss: 0.111669
valid_loss: 1.101575
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0002004905771939577
Epoch-26 lr: 0.0004009811543879154
epoch 26 training time: 7.455
---------------
2023-09-12 11:06:06.395616
current #epochs=27, #steps=208
start validation
acc: 0.613636
AUC: 0.869146
Avg Precision: 0.422955
Avg Recall: 1.000000
d_prime: 1.587261
train_loss: 0.156678
valid_loss: 1.100555
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0002004905771939577
Epoch-27 lr: 0.0004009811543879154
epoch 27 training time: 6.414
---------------
2023-09-12 11:06:12.810025
current #epochs=28, #steps=216
start validation
acc: 0.613636
AUC: 0.871212
Avg Precision: 0.425912
Avg Recall: 1.000000
d_prime: 1.601087
train_loss: 0.116039
valid_loss: 1.098742
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0001338029118907854
Epoch-28 lr: 0.0002676058237815708
epoch 28 training time: 6.295
---------------
2023-09-12 11:06:19.104513
current #epochs=29, #steps=224
start validation
acc: 0.613636
AUC: 0.869835
Avg Precision: 0.425912
Avg Recall: 1.000000
d_prime: 1.591853
train_loss: 0.088416
valid_loss: 1.097324
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0001338029118907854
Epoch-29 lr: 0.0002676058237815708
epoch 29 training time: 6.536
---------------
2023-09-12 11:06:25.640969
current #epochs=30, #steps=232
start validation
acc: 0.636364
AUC: 0.869835
Avg Precision: 0.428122
Avg Recall: 1.000000
d_prime: 1.591853
train_loss: 0.108521
valid_loss: 1.096717
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0001338029118907854
Epoch-30 lr: 0.0002676058237815708
epoch 30 training time: 11.159
---------------
2023-09-12 11:06:36.799338
current #epochs=31, #steps=240
start validation
acc: 0.659091
AUC: 0.872590
Avg Precision: 0.449217
Avg Recall: 1.000000
d_prime: 1.610390
train_loss: 0.105300
valid_loss: 1.096029
validation finished
normal learning rate scheduler step
Epoch-31 lr: 8.929706064506678e-05
Epoch-31 lr: 0.00017859412129013355
epoch 31 training time: 7.795
---------------
2023-09-12 11:06:44.594519
current #epochs=32, #steps=248
start validation
acc: 0.659091
AUC: 0.873278
Avg Precision: 0.449217
Avg Recall: 1.000000
d_prime: 1.615068
train_loss: 0.152533
valid_loss: 1.096036
validation finished
normal learning rate scheduler step
Epoch-32 lr: 8.929706064506678e-05
Epoch-32 lr: 0.00017859412129013355
epoch 32 training time: 6.557
---------------
2023-09-12 11:06:51.151194
current #epochs=33, #steps=256
start validation
acc: 0.659091
AUC: 0.872590
Avg Precision: 0.442670
Avg Recall: 1.000000
d_prime: 1.610390
train_loss: 0.172941
valid_loss: 1.095893
validation finished
normal learning rate scheduler step
Epoch-33 lr: 8.929706064506678e-05
Epoch-33 lr: 0.00017859412129013355
epoch 33 training time: 6.617
---------------
2023-09-12 11:06:57.767758
current #epochs=34, #steps=264
start validation
acc: 0.659091
AUC: 0.871901
Avg Precision: 0.442670
Avg Recall: 1.000000
d_prime: 1.605730
train_loss: 0.152920
valid_loss: 1.095711
validation finished
normal learning rate scheduler step
Epoch-34 lr: 5.95948543059912e-05
Epoch-34 lr: 0.0001191897086119824
epoch 34 training time: 6.573
---------------
2023-09-12 11:07:04.341182
current #epochs=35, #steps=272
start validation
acc: 0.659091
AUC: 0.871212
Avg Precision: 0.442670
Avg Recall: 1.000000
d_prime: 1.601087
train_loss: 0.086001
valid_loss: 1.096198
validation finished
normal learning rate scheduler step
Epoch-35 lr: 5.95948543059912e-05
Epoch-35 lr: 0.0001191897086119824
epoch 35 training time: 6.443
---------------
2023-09-12 11:07:10.783698
current #epochs=36, #steps=280
start validation
acc: 0.659091
AUC: 0.871212
Avg Precision: 0.442670
Avg Recall: 1.000000
d_prime: 1.601087
train_loss: 0.105222
valid_loss: 1.096491
validation finished
normal learning rate scheduler step
Epoch-36 lr: 5.95948543059912e-05
Epoch-36 lr: 0.0001191897086119824
epoch 36 training time: 6.947
---------------
2023-09-12 11:07:17.730540
current #epochs=37, #steps=288
start validation
acc: 0.659091
AUC: 0.869835
Avg Precision: 0.436717
Avg Recall: 1.000000
d_prime: 1.591853
train_loss: 0.211620
valid_loss: 1.096306
validation finished
normal learning rate scheduler step
Epoch-37 lr: 3.9772268360196286e-05
Epoch-37 lr: 7.954453672039257e-05
epoch 37 training time: 7.598
---------------
2023-09-12 11:07:25.328081
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01216	Per Sample Data Time 0.00631	Per Sample DNN Time 0.00585	Train Loss 0.0887	
start validation
acc: 0.659091
AUC: 0.869146
Avg Precision: 0.430765
Avg Recall: 1.000000
d_prime: 1.587261
train_loss: 0.090383
valid_loss: 1.096413
validation finished
normal learning rate scheduler step
Epoch-38 lr: 3.9772268360196286e-05
Epoch-38 lr: 7.954453672039257e-05
epoch 38 training time: 6.462
---------------
2023-09-12 11:07:31.790034
current #epochs=39, #steps=304
start validation
acc: 0.659091
AUC: 0.868457
Avg Precision: 0.430765
Avg Recall: 1.000000
d_prime: 1.582686
train_loss: 0.129526
valid_loss: 1.096645
validation finished
normal learning rate scheduler step
Epoch-39 lr: 3.9772268360196286e-05
Epoch-39 lr: 7.954453672039257e-05
epoch 39 training time: 7.786
---------------
2023-09-12 11:07:39.575606
current #epochs=40, #steps=312
start validation
[I 2023-09-12 11:07:46,170] Trial 72 finished with value: 0.6818181818181818 and parameters: {'warmup': 'False', 'num_epochs': 40, 'batch_size': 10, 'lr-adaptschedule': 'False', 'lr': 0.0034001084921580263, 'head-lr': 2, 'lr-scheduler-start': 7, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.6673775584043653}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.659091
AUC: 0.868457
Avg Precision: 0.434113
Avg Recall: 1.000000
d_prime: 1.582686
train_loss: 0.150248
valid_loss: 1.096844
validation finished
normal learning rate scheduler step
Epoch-40 lr: 2.6543119350430987e-05
Epoch-40 lr: 5.308623870086197e-05
epoch 40 training time: 6.589
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f956e070b50>
The learning rate scheduler starts at 6 epoch with decay rate of 0.682 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 11:07:46.213321
current #epochs=1, #steps=0
start validation
acc: 0.613636
AUC: 0.862948
Avg Precision: 0.365031
Avg Recall: 1.000000
d_prime: 1.546667
train_loss: 0.346177
valid_loss: 1.095967
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003034114113692649
Epoch-1 lr: 0.006068228227385298
epoch 1 training time: 10.127
---------------
2023-09-12 11:07:56.340463
current #epochs=2, #steps=8
start validation
acc: 0.568182
AUC: 0.859504
Avg Precision: 0.429011
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.250524
valid_loss: 1.125091
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003034114113692649
Epoch-2 lr: 0.006068228227385298
epoch 2 training time: 6.414
---------------
2023-09-12 11:08:02.754108
current #epochs=3, #steps=16
start validation
acc: 0.545455
AUC: 0.826446
Avg Precision: 0.383727
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.273749
valid_loss: 1.167661
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003034114113692649
Epoch-3 lr: 0.006068228227385298
epoch 3 training time: 7.437
---------------
2023-09-12 11:08:10.191754
current #epochs=4, #steps=24
start validation
acc: 0.659091
AUC: 0.851240
Avg Precision: 0.411918
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.241439
valid_loss: 1.133092
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003034114113692649
Epoch-4 lr: 0.006068228227385298
epoch 4 training time: 8.975
---------------
2023-09-12 11:08:19.166427
current #epochs=5, #steps=32
start validation
acc: 0.613636
AUC: 0.845730
Avg Precision: 0.403056
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.212150
valid_loss: 1.140913
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.003034114113692649
Epoch-5 lr: 0.006068228227385298
epoch 5 training time: 6.438
---------------
2023-09-12 11:08:25.604168
current #epochs=6, #steps=40
start validation
acc: 0.590909
AUC: 0.840220
Avg Precision: 0.391752
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.121610
valid_loss: 1.155936
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0020701452670652647
Epoch-6 lr: 0.004140290534130529
epoch 6 training time: 6.417
---------------
2023-09-12 11:08:32.021024
current #epochs=7, #steps=48
start validation
acc: 0.613636
AUC: 0.845041
Avg Precision: 0.388040
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.135083
valid_loss: 1.138823
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0020701452670652647
Epoch-7 lr: 0.004140290534130529
epoch 7 training time: 6.508
---------------
2023-09-12 11:08:38.529486
current #epochs=8, #steps=56
start validation
acc: 0.636364
AUC: 0.834711
Avg Precision: 0.368186
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.157973
valid_loss: 1.124619
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0020701452670652647
Epoch-8 lr: 0.004140290534130529
epoch 8 training time: 6.410
---------------
2023-09-12 11:08:44.939275
current #epochs=9, #steps=64
start validation
acc: 0.659091
AUC: 0.832645
Avg Precision: 0.382958
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.148588
valid_loss: 1.132139
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0020701452670652647
Epoch-9 lr: 0.004140290534130529
epoch 9 training time: 7.287
---------------
2023-09-12 11:08:52.226709
current #epochs=10, #steps=72
start validation
acc: 0.636364
AUC: 0.842287
Avg Precision: 0.388393
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.190443
valid_loss: 1.126385
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001412439106166997
Epoch-10 lr: 0.002824878212333994
epoch 10 training time: 6.458
---------------
2023-09-12 11:08:58.684446
current #epochs=11, #steps=80
start validation
acc: 0.636364
AUC: 0.842975
Avg Precision: 0.387128
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.130385
valid_loss: 1.125257
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001412439106166997
Epoch-11 lr: 0.002824878212333994
epoch 11 training time: 6.441
---------------
2023-09-12 11:09:05.125573
current #epochs=12, #steps=88
start validation
acc: 0.636364
AUC: 0.845730
Avg Precision: 0.384373
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.150450
valid_loss: 1.122242
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001412439106166997
Epoch-12 lr: 0.002824878212333994
epoch 12 training time: 7.178
---------------
2023-09-12 11:09:12.303820
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01173	Per Sample Data Time 0.00592	Per Sample DNN Time 0.00581	Train Loss 0.1152	
start validation
acc: 0.659091
AUC: 0.847107
Avg Precision: 0.375448
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.132368
valid_loss: 1.126552
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.001412439106166997
Epoch-13 lr: 0.002824878212333994
epoch 13 training time: 6.453
---------------
2023-09-12 11:09:18.757147
current #epochs=14, #steps=104
start validation
acc: 0.659091
AUC: 0.848485
Avg Precision: 0.353458
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.101658
valid_loss: 1.116744
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0009636928675338852
Epoch-14 lr: 0.0019273857350677703
epoch 14 training time: 6.405
---------------
2023-09-12 11:09:25.161721
current #epochs=15, #steps=112
start validation
acc: 0.659091
AUC: 0.845730
Avg Precision: 0.348476
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.122884
valid_loss: 1.120334
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0009636928675338852
Epoch-15 lr: 0.0019273857350677703
epoch 15 training time: 6.457
---------------
2023-09-12 11:09:31.619264
current #epochs=16, #steps=120
start validation
acc: 0.659091
AUC: 0.845041
Avg Precision: 0.354688
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.098521
valid_loss: 1.124578
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0009636928675338852
Epoch-16 lr: 0.0019273857350677703
epoch 16 training time: 6.382
---------------
2023-09-12 11:09:38.000990
current #epochs=17, #steps=128
start validation
acc: 0.659091
AUC: 0.849174
Avg Precision: 0.378293
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.117648
valid_loss: 1.125458
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0009636928675338852
Epoch-17 lr: 0.0019273857350677703
epoch 17 training time: 8.232
---------------
2023-09-12 11:09:46.232851
current #epochs=18, #steps=136
start validation
acc: 0.681818
AUC: 0.851928
Avg Precision: 0.377546
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.212402
valid_loss: 1.122711
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0006575178631636377
Epoch-18 lr: 0.0013150357263272754
epoch 18 training time: 9.157
---------------
2023-09-12 11:09:55.389634
current #epochs=19, #steps=144
start validation
acc: 0.681818
AUC: 0.848485
Avg Precision: 0.359349
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.116880
valid_loss: 1.118906
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0006575178631636377
Epoch-19 lr: 0.0013150357263272754
epoch 19 training time: 6.606
---------------
2023-09-12 11:10:01.996217
current #epochs=20, #steps=152
start validation
acc: 0.704545
AUC: 0.849174
Avg Precision: 0.363315
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.137271
valid_loss: 1.116236
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0006575178631636377
Epoch-20 lr: 0.0013150357263272754
epoch 20 training time: 10.164
---------------
2023-09-12 11:10:12.160273
current #epochs=21, #steps=160
start validation
acc: 0.704545
AUC: 0.845041
Avg Precision: 0.361638
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.136133
valid_loss: 1.116133
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0006575178631636377
Epoch-21 lr: 0.0013150357263272754
epoch 21 training time: 6.406
---------------
2023-09-12 11:10:18.565992
current #epochs=22, #steps=168
start validation
acc: 0.704545
AUC: 0.851240
Avg Precision: 0.370454
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.132476
valid_loss: 1.118775
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00044861776499977545
Epoch-22 lr: 0.0008972355299995509
epoch 22 training time: 6.702
---------------
2023-09-12 11:10:25.268473
current #epochs=23, #steps=176
start validation
acc: 0.659091
AUC: 0.845041
Avg Precision: 0.373070
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.138637
valid_loss: 1.130389
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00044861776499977545
Epoch-23 lr: 0.0008972355299995509
epoch 23 training time: 6.448
---------------
2023-09-12 11:10:31.716453
current #epochs=24, #steps=184
start validation
acc: 0.659091
AUC: 0.844353
Avg Precision: 0.373542
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.092810
valid_loss: 1.135517
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00044861776499977545
Epoch-24 lr: 0.0008972355299995509
epoch 24 training time: 6.619
---------------
2023-09-12 11:10:38.335287
current #epochs=25, #steps=192
start validation
acc: 0.659091
AUC: 0.845730
Avg Precision: 0.373542
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.117036
valid_loss: 1.135140
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00044861776499977545
Epoch-25 lr: 0.0008972355299995509
epoch 25 training time: 6.334
---------------
2023-09-12 11:10:44.668963
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03648	Per Sample Data Time 0.03099	Per Sample DNN Time 0.00549	Train Loss 0.2313	
start validation
acc: 0.659091
AUC: 0.847107
Avg Precision: 0.371647
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.148281
valid_loss: 1.123258
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00030608734811407904
Epoch-26 lr: 0.0006121746962281581
epoch 26 training time: 9.347
---------------
2023-09-12 11:10:54.015902
current #epochs=27, #steps=208
start validation
acc: 0.659091
AUC: 0.853994
Avg Precision: 0.381960
Avg Recall: 1.000000
d_prime: 1.490185
train_loss: 0.085830
valid_loss: 1.115805
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00030608734811407904
Epoch-27 lr: 0.0006121746962281581
epoch 27 training time: 6.382
---------------
2023-09-12 11:11:00.397603
current #epochs=28, #steps=216
start validation
acc: 0.681818
AUC: 0.858127
Avg Precision: 0.383380
Avg Recall: 1.000000
d_prime: 1.515953
train_loss: 0.096617
valid_loss: 1.106763
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00030608734811407904
Epoch-28 lr: 0.0006121746962281581
epoch 28 training time: 6.782
---------------
2023-09-12 11:11:07.179917
current #epochs=29, #steps=224
start validation
acc: 0.704545
AUC: 0.856749
Avg Precision: 0.384976
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.125706
valid_loss: 1.104025
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00030608734811407904
Epoch-29 lr: 0.0006121746962281581
epoch 29 training time: 6.313
---------------
2023-09-12 11:11:13.492670
current #epochs=30, #steps=232
start validation
acc: 0.704545
AUC: 0.860193
Avg Precision: 0.384976
Avg Recall: 1.000000
d_prime: 1.529028
train_loss: 0.126143
valid_loss: 1.103768
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.000208840291189887
Epoch-30 lr: 0.000417680582379774
epoch 30 training time: 6.502
---------------
2023-09-12 11:11:19.994570
current #epochs=31, #steps=240
start validation
acc: 0.704545
AUC: 0.861570
Avg Precision: 0.380814
Avg Recall: 1.000000
d_prime: 1.537818
train_loss: 0.118446
valid_loss: 1.103604
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.000208840291189887
Epoch-31 lr: 0.000417680582379774
epoch 31 training time: 7.550
---------------
2023-09-12 11:11:27.544667
current #epochs=32, #steps=248
start validation
acc: 0.704545
AUC: 0.862259
Avg Precision: 0.383985
Avg Recall: 1.000000
d_prime: 1.542235
train_loss: 0.101354
valid_loss: 1.105729
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.000208840291189887
Epoch-32 lr: 0.000417680582379774
epoch 32 training time: 6.518
---------------
2023-09-12 11:11:34.062270
current #epochs=33, #steps=256
start validation
acc: 0.704545
AUC: 0.861570
Avg Precision: 0.391871
Avg Recall: 1.000000
d_prime: 1.537818
train_loss: 0.120905
valid_loss: 1.107805
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.000208840291189887
Epoch-33 lr: 0.000417680582379774
epoch 33 training time: 6.437
---------------
2023-09-12 11:11:40.499902
current #epochs=34, #steps=264
start validation
acc: 0.681818
AUC: 0.856749
Avg Precision: 0.382981
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.131252
valid_loss: 1.113967
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0001424896111943239
Epoch-34 lr: 0.0002849792223886478
epoch 34 training time: 6.637
---------------
2023-09-12 11:11:47.136436
current #epochs=35, #steps=272
start validation
acc: 0.659091
AUC: 0.853994
Avg Precision: 0.380530
Avg Recall: 1.000000
d_prime: 1.490185
train_loss: 0.105834
valid_loss: 1.117379
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0001424896111943239
Epoch-35 lr: 0.0002849792223886478
epoch 35 training time: 6.590
---------------
2023-09-12 11:11:53.726388
current #epochs=36, #steps=280
start validation
acc: 0.659091
AUC: 0.851928
Avg Precision: 0.384171
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.117578
valid_loss: 1.119057
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0001424896111943239
Epoch-36 lr: 0.0002849792223886478
epoch 36 training time: 6.456
---------------
2023-09-12 11:12:00.182722
current #epochs=37, #steps=288
start validation
acc: 0.636364
AUC: 0.851240
Avg Precision: 0.384945
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.087889
valid_loss: 1.120569
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0001424896111943239
Epoch-37 lr: 0.0002849792223886478
epoch 37 training time: 7.079
---------------
2023-09-12 11:12:07.261332
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01198	Per Sample Data Time 0.00614	Per Sample DNN Time 0.00584	Train Loss 0.0967	
start validation
acc: 0.681818
AUC: 0.851240
Avg Precision: 0.384945
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.114142
valid_loss: 1.121333
validation finished
normal learning rate scheduler step
Epoch-38 lr: 9.721921561509856e-05
Epoch-38 lr: 0.00019443843123019712
epoch 38 training time: 7.720
---------------
2023-09-12 11:12:14.981630
current #epochs=39, #steps=304
start validation
acc: 0.659091
AUC: 0.851240
Avg Precision: 0.384945
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.099216
valid_loss: 1.121872
validation finished
normal learning rate scheduler step
Epoch-39 lr: 9.721921561509856e-05
Epoch-39 lr: 0.00019443843123019712
epoch 39 training time: 7.493
---------------
2023-09-12 11:12:22.474336
current #epochs=40, #steps=312
start validation
acc: 0.636364
AUC: 0.849174
Avg Precision: 0.379924
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.126085
valid_loss: 1.122128
validation finished
normal learning rate scheduler step
Epoch-40 lr: 9.721921561509856e-05
Epoch-40 lr: 0.00019443843123019712
epoch 40 training time: 6.404
---------------
2023-09-12 11:12:28.878812
current #epochs=41, #steps=320
start validation
acc: 0.636364
AUC: 0.849174
Avg Precision: 0.379924
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.135209
valid_loss: 1.121704
validation finished
normal learning rate scheduler step
Epoch-41 lr: 9.721921561509856e-05
Epoch-41 lr: 0.00019443843123019712
epoch 41 training time: 6.536
---------------
2023-09-12 11:12:35.414353
current #epochs=42, #steps=328
start validation
[I 2023-09-12 11:12:41,727] Trial 73 finished with value: 0.7045454545454546 and parameters: {'warmup': 'False', 'num_epochs': 42, 'batch_size': 16, 'lr-adaptschedule': 'False', 'lr': 0.003034114113692649, 'head-lr': 2, 'lr-scheduler-start': 6, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.682289851170366}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.636364
AUC: 0.847107
Avg Precision: 0.377968
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.105501
valid_loss: 1.122064
validation finished
normal learning rate scheduler step
Epoch-42 lr: 6.633168415292532e-05
Epoch-42 lr: 0.00013266336830585065
epoch 42 training time: 6.308
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8d71610>
The learning rate scheduler starts at 8 epoch with decay rate of 0.656 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 11:12:41.766570
current #epochs=1, #steps=0
start validation
acc: 0.590909
AUC: 0.798209
Avg Precision: 0.331760
Avg Recall: 1.000000
d_prime: 1.181211
train_loss: 0.185063
valid_loss: 1.163073
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003355913875213667
Epoch-1 lr: 0.010067741625641
epoch 1 training time: 10.157
---------------
2023-09-12 11:12:51.923803
current #epochs=2, #steps=8
start validation
acc: 0.681818
AUC: 0.820937
Avg Precision: 0.333676
Avg Recall: 1.000000
d_prime: 1.299578
train_loss: 0.171315
valid_loss: 1.132374
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003355913875213667
Epoch-2 lr: 0.010067741625641
epoch 2 training time: 9.287
---------------
2023-09-12 11:13:01.210702
current #epochs=3, #steps=16
start validation
acc: 0.613636
AUC: 0.803030
Avg Precision: 0.346611
Avg Recall: 1.000000
d_prime: 1.205610
train_loss: 0.171649
valid_loss: 1.162871
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003355913875213667
Epoch-3 lr: 0.010067741625641
epoch 3 training time: 6.765
---------------
2023-09-12 11:13:07.976212
current #epochs=4, #steps=24
start validation
acc: 0.613636
AUC: 0.831267
Avg Precision: 0.370417
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.231217
valid_loss: 1.129403
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003355913875213667
Epoch-4 lr: 0.010067741625641
epoch 4 training time: 6.539
---------------
2023-09-12 11:13:14.514999
current #epochs=5, #steps=32
start validation
acc: 0.613636
AUC: 0.833333
Avg Precision: 0.350800
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.178369
valid_loss: 1.138234
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.003355913875213667
Epoch-5 lr: 0.010067741625641
epoch 5 training time: 7.034
---------------
2023-09-12 11:13:21.548957
current #epochs=6, #steps=40
start validation
acc: 0.659091
AUC: 0.825758
Avg Precision: 0.372812
Avg Recall: 1.000000
d_prime: 1.325871
train_loss: 0.241307
valid_loss: 1.147089
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.003355913875213667
Epoch-6 lr: 0.010067741625641
epoch 6 training time: 7.082
---------------
2023-09-12 11:13:28.630751
current #epochs=7, #steps=48
start validation
acc: 0.613636
AUC: 0.817493
Avg Precision: 0.354644
Avg Recall: 1.000000
d_prime: 1.281069
train_loss: 0.221168
valid_loss: 1.154419
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.003355913875213667
Epoch-7 lr: 0.010067741625641
epoch 7 training time: 6.588
---------------
2023-09-12 11:13:35.218122
current #epochs=8, #steps=56
start validation
acc: 0.681818
AUC: 0.804408
Avg Precision: 0.339513
Avg Recall: 1.000000
d_prime: 1.212647
train_loss: 0.264851
valid_loss: 1.169812
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0022014407255503245
Epoch-8 lr: 0.0066043221766509735
epoch 8 training time: 6.751
---------------
2023-09-12 11:13:41.968882
current #epochs=9, #steps=64
start validation
acc: 0.590909
AUC: 0.775482
Avg Precision: 0.330970
Avg Recall: 1.000000
d_prime: 1.070593
train_loss: 0.226057
valid_loss: 1.201602
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0022014407255503245
Epoch-9 lr: 0.0066043221766509735
epoch 9 training time: 6.772
---------------
2023-09-12 11:13:48.740528
current #epochs=10, #steps=72
start validation
acc: 0.590909
AUC: 0.791322
Avg Precision: 0.346092
Avg Recall: 1.000000
d_prime: 1.146953
train_loss: 0.201315
valid_loss: 1.187367
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0022014407255503245
Epoch-10 lr: 0.0066043221766509735
epoch 10 training time: 6.529
---------------
2023-09-12 11:13:55.269455
current #epochs=11, #steps=80
start validation
acc: 0.545455
AUC: 0.805785
Avg Precision: 0.360825
Avg Recall: 1.000000
d_prime: 1.219715
train_loss: 0.199737
valid_loss: 1.172008
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0022014407255503245
Epoch-11 lr: 0.0066043221766509735
epoch 11 training time: 6.342
---------------
2023-09-12 11:14:01.611339
current #epochs=12, #steps=88
start validation
acc: 0.590909
AUC: 0.796832
Avg Precision: 0.362461
Avg Recall: 1.000000
d_prime: 1.174304
train_loss: 0.193849
valid_loss: 1.186599
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0014441196789661292
Epoch-12 lr: 0.004332359036898388
epoch 12 training time: 8.214
---------------
2023-09-12 11:14:09.825609
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01181	Per Sample Data Time 0.00624	Per Sample DNN Time 0.00557	Train Loss 0.2075	
start validation
acc: 0.613636
AUC: 0.809917
Avg Precision: 0.355060
Avg Recall: 1.000000
d_prime: 1.241102
train_loss: 0.204699
valid_loss: 1.168021
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0014441196789661292
Epoch-13 lr: 0.004332359036898388
epoch 13 training time: 6.538
---------------
2023-09-12 11:14:16.363554
current #epochs=14, #steps=104
start validation
acc: 0.636364
AUC: 0.809229
Avg Precision: 0.345733
Avg Recall: 1.000000
d_prime: 1.237518
train_loss: 0.153389
valid_loss: 1.163145
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0014441196789661292
Epoch-14 lr: 0.004332359036898388
epoch 14 training time: 6.618
---------------
2023-09-12 11:14:22.981033
current #epochs=15, #steps=112
start validation
acc: 0.613636
AUC: 0.809229
Avg Precision: 0.347256
Avg Recall: 1.000000
d_prime: 1.237518
train_loss: 0.189987
valid_loss: 1.171610
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0014441196789661292
Epoch-15 lr: 0.004332359036898388
epoch 15 training time: 6.213
---------------
2023-09-12 11:14:29.194456
current #epochs=16, #steps=120
start validation
acc: 0.590909
AUC: 0.798898
Avg Precision: 0.335597
Avg Recall: 1.000000
d_prime: 1.184675
train_loss: 0.143750
valid_loss: 1.182070
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.000947325823027054
Epoch-16 lr: 0.0028419774690811622
epoch 16 training time: 6.380
---------------
2023-09-12 11:14:35.573867
current #epochs=17, #steps=128
start validation
acc: 0.590909
AUC: 0.815427
Avg Precision: 0.391997
Avg Recall: 1.000000
d_prime: 1.270069
train_loss: 0.138723
valid_loss: 1.171605
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.000947325823027054
Epoch-17 lr: 0.0028419774690811622
epoch 17 training time: 6.791
---------------
2023-09-12 11:14:42.364683
current #epochs=18, #steps=136
start validation
acc: 0.613636
AUC: 0.824380
Avg Precision: 0.394709
Avg Recall: 1.000000
d_prime: 1.318312
train_loss: 0.140939
valid_loss: 1.170751
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.000947325823027054
Epoch-18 lr: 0.0028419774690811622
epoch 18 training time: 6.357
---------------
2023-09-12 11:14:48.721601
current #epochs=19, #steps=144
start validation
acc: 0.568182
AUC: 0.825069
Avg Precision: 0.390176
Avg Recall: 1.000000
d_prime: 1.322087
train_loss: 0.151618
valid_loss: 1.172208
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.000947325823027054
Epoch-19 lr: 0.0028419774690811622
epoch 19 training time: 6.435
---------------
2023-09-12 11:14:55.156291
current #epochs=20, #steps=152
start validation
acc: 0.590909
AUC: 0.829201
Avg Precision: 0.411829
Avg Recall: 1.000000
d_prime: 1.344935
train_loss: 0.153634
valid_loss: 1.161276
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0006214347938367328
Epoch-20 lr: 0.0018643043815101987
epoch 20 training time: 7.645
---------------
2023-09-12 11:15:02.800750
current #epochs=21, #steps=160
start validation
acc: 0.590909
AUC: 0.828512
Avg Precision: 0.401317
Avg Recall: 1.000000
d_prime: 1.341103
train_loss: 0.166916
valid_loss: 1.156504
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0006214347938367328
Epoch-21 lr: 0.0018643043815101987
epoch 21 training time: 6.534
---------------
2023-09-12 11:15:09.334619
current #epochs=22, #steps=168
start validation
acc: 0.590909
AUC: 0.826446
Avg Precision: 0.404954
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.114889
valid_loss: 1.153446
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0006214347938367328
Epoch-22 lr: 0.0018643043815101987
epoch 22 training time: 6.678
---------------
2023-09-12 11:15:16.012677
current #epochs=23, #steps=176
start validation
acc: 0.568182
AUC: 0.825758
Avg Precision: 0.394816
Avg Recall: 1.000000
d_prime: 1.325871
train_loss: 0.124190
valid_loss: 1.152969
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0006214347938367328
Epoch-23 lr: 0.0018643043815101987
epoch 23 training time: 6.460
---------------
2023-09-12 11:15:22.472392
current #epochs=24, #steps=184
start validation
acc: 0.590909
AUC: 0.830579
Avg Precision: 0.399496
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.132644
valid_loss: 1.150327
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0004076540442621017
Epoch-24 lr: 0.0012229621327863054
epoch 24 training time: 7.425
---------------
2023-09-12 11:15:29.897729
current #epochs=25, #steps=192
start validation
[I 2023-09-12 11:15:37,753] Trial 74 finished with value: 0.6818181818181818 and parameters: {'warmup': 'False', 'num_epochs': 25, 'batch_size': 9, 'lr-adaptschedule': 'False', 'lr': 0.003355913875213667, 'head-lr': 3, 'lr-scheduler-start': 8, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.6559884452964877}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.636364
AUC: 0.831267
Avg Precision: 0.399496
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.114208
valid_loss: 1.148087
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0004076540442621017
Epoch-25 lr: 0.0012229621327863054
epoch 25 training time: 7.850
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8ea0670>
The learning rate scheduler starts at 6 epoch with decay rate of 0.707 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 11:15:37.791666
current #epochs=1, #steps=0
start validation
acc: 0.568182
AUC: 0.813361
Avg Precision: 0.359536
Avg Recall: 1.000000
d_prime: 1.259144
train_loss: 0.327702
valid_loss: 1.154509
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003549262248639844
Epoch-1 lr: 0.007098524497279688
epoch 1 training time: 9.393
---------------
2023-09-12 11:15:47.184782
current #epochs=2, #steps=8
start validation
acc: 0.659091
AUC: 0.825069
Avg Precision: 0.395626
Avg Recall: 1.000000
d_prime: 1.322087
train_loss: 0.289884
valid_loss: 1.138793
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003549262248639844
Epoch-2 lr: 0.007098524497279688
epoch 2 training time: 10.156
---------------
2023-09-12 11:15:57.341155
current #epochs=3, #steps=16
start validation
acc: 0.613636
AUC: 0.787879
Avg Precision: 0.370623
Avg Recall: 1.000000
d_prime: 1.130074
train_loss: 0.311049
valid_loss: 1.175352
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003549262248639844
Epoch-3 lr: 0.007098524497279688
epoch 3 training time: 6.547
---------------
2023-09-12 11:16:03.888545
current #epochs=4, #steps=24
start validation
acc: 0.545455
AUC: 0.772039
Avg Precision: 0.357664
Avg Recall: 1.000000
d_prime: 1.054405
train_loss: 0.315249
valid_loss: 1.196722
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003549262248639844
Epoch-4 lr: 0.007098524497279688
epoch 4 training time: 6.448
---------------
2023-09-12 11:16:10.336923
current #epochs=5, #steps=32
start validation
acc: 0.590909
AUC: 0.820248
Avg Precision: 0.371203
Avg Recall: 1.000000
d_prime: 1.295859
train_loss: 0.285558
valid_loss: 1.166426
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.003549262248639844
Epoch-5 lr: 0.007098524497279688
epoch 5 training time: 6.472
---------------
2023-09-12 11:16:16.809089
current #epochs=6, #steps=40
start validation
acc: 0.636364
AUC: 0.820937
Avg Precision: 0.402854
Avg Recall: 1.000000
d_prime: 1.299578
train_loss: 0.236031
valid_loss: 1.167255
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00250804343791441
Epoch-6 lr: 0.00501608687582882
epoch 6 training time: 7.375
---------------
2023-09-12 11:16:24.184293
current #epochs=7, #steps=48
start validation
acc: 0.613636
AUC: 0.822314
Avg Precision: 0.374115
Avg Recall: 1.000000
d_prime: 1.307044
train_loss: 0.208462
valid_loss: 1.157018
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00250804343791441
Epoch-7 lr: 0.00501608687582882
epoch 7 training time: 6.414
---------------
2023-09-12 11:16:30.597938
current #epochs=8, #steps=56
start validation
acc: 0.613636
AUC: 0.818182
Avg Precision: 0.367871
Avg Recall: 1.000000
d_prime: 1.284753
train_loss: 0.179372
valid_loss: 1.156252
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00250804343791441
Epoch-8 lr: 0.00501608687582882
epoch 8 training time: 7.562
---------------
2023-09-12 11:16:38.159513
current #epochs=9, #steps=64
start validation
acc: 0.590909
AUC: 0.820248
Avg Precision: 0.387153
Avg Recall: 1.000000
d_prime: 1.295859
train_loss: 0.166665
valid_loss: 1.152739
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00250804343791441
Epoch-9 lr: 0.00501608687582882
epoch 9 training time: 6.449
---------------
2023-09-12 11:16:44.608890
current #epochs=10, #steps=72
start validation
acc: 0.590909
AUC: 0.823003
Avg Precision: 0.397593
Avg Recall: 1.000000
d_prime: 1.310791
train_loss: 0.181352
valid_loss: 1.160549
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00250804343791441
Epoch-10 lr: 0.00501608687582882
epoch 10 training time: 6.411
---------------
2023-09-12 11:16:51.019498
current #epochs=11, #steps=80
start validation
acc: 0.590909
AUC: 0.820937
Avg Precision: 0.353700
Avg Recall: 1.000000
d_prime: 1.299578
train_loss: 0.188364
valid_loss: 1.153584
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0017722787007007185
Epoch-11 lr: 0.003544557401401437
epoch 11 training time: 6.406
---------------
2023-09-12 11:16:57.426095
current #epochs=12, #steps=88
start validation
acc: 0.613636
AUC: 0.820248
Avg Precision: 0.344885
Avg Recall: 1.000000
d_prime: 1.295859
train_loss: 0.158261
valid_loss: 1.152096
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0017722787007007185
Epoch-12 lr: 0.003544557401401437
epoch 12 training time: 6.511
---------------
2023-09-12 11:17:03.937240
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01184	Per Sample Data Time 0.00603	Per Sample DNN Time 0.00581	Train Loss 0.1916	
start validation
acc: 0.590909
AUC: 0.821625
Avg Precision: 0.351487
Avg Recall: 1.000000
d_prime: 1.303307
train_loss: 0.164981
valid_loss: 1.149708
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0017722787007007185
Epoch-13 lr: 0.003544557401401437
epoch 13 training time: 6.584
---------------
2023-09-12 11:17:10.521513
current #epochs=14, #steps=104
start validation
acc: 0.636364
AUC: 0.826446
Avg Precision: 0.351824
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.128543
valid_loss: 1.148218
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0017722787007007185
Epoch-14 lr: 0.003544557401401437
epoch 14 training time: 6.455
---------------
2023-09-12 11:17:16.976809
current #epochs=15, #steps=112
start validation
acc: 0.590909
AUC: 0.818182
Avg Precision: 0.355768
Avg Recall: 1.000000
d_prime: 1.284753
train_loss: 0.167949
valid_loss: 1.157027
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0017722787007007185
Epoch-15 lr: 0.003544557401401437
epoch 15 training time: 6.686
---------------
2023-09-12 11:17:23.662175
current #epochs=16, #steps=120
start validation
acc: 0.590909
AUC: 0.809229
Avg Precision: 0.352137
Avg Recall: 1.000000
d_prime: 1.237518
train_loss: 0.139929
valid_loss: 1.163134
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0012523594071278668
Epoch-16 lr: 0.0025047188142557335
epoch 16 training time: 6.655
---------------
2023-09-12 11:17:30.318006
current #epochs=17, #steps=128
start validation
acc: 0.613636
AUC: 0.805096
Avg Precision: 0.324496
Avg Recall: 1.000000
d_prime: 1.216177
train_loss: 0.125817
valid_loss: 1.153990
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0012523594071278668
Epoch-17 lr: 0.0025047188142557335
epoch 17 training time: 6.405
---------------
2023-09-12 11:17:36.722726
current #epochs=18, #steps=136
start validation
acc: 0.636364
AUC: 0.800964
Avg Precision: 0.325092
Avg Recall: 1.000000
d_prime: 1.195110
train_loss: 0.127172
valid_loss: 1.150961
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0012523594071278668
Epoch-18 lr: 0.0025047188142557335
epoch 18 training time: 6.441
---------------
2023-09-12 11:17:43.163767
current #epochs=19, #steps=144
start validation
acc: 0.636364
AUC: 0.802342
Avg Precision: 0.328945
Avg Recall: 1.000000
d_prime: 1.202103
train_loss: 0.193222
valid_loss: 1.154523
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0012523594071278668
Epoch-19 lr: 0.0025047188142557335
epoch 19 training time: 8.877
---------------
2023-09-12 11:17:52.041255
current #epochs=20, #steps=152
start validation
[I 2023-09-12 11:18:00,111] Trial 75 finished with value: 0.6590909090909091 and parameters: {'warmup': 'False', 'num_epochs': 20, 'batch_size': 13, 'lr-adaptschedule': 'False', 'lr': 0.003549262248639844, 'head-lr': 2, 'lr-scheduler-start': 6, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.7066379608538501}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.613636
AUC: 0.798898
Avg Precision: 0.332304
Avg Recall: 1.000000
d_prime: 1.184675
train_loss: 0.146840
valid_loss: 1.154864
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0012523594071278668
Epoch-20 lr: 0.0025047188142557335
epoch 20 training time: 8.064
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f957c000e80>
The learning rate scheduler starts at 7 epoch with decay rate of 0.694 every 6 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 11:18:00.151027
current #epochs=1, #steps=0
start validation
acc: 0.568182
AUC: 0.818871
Avg Precision: 0.337540
Avg Recall: 1.000000
d_prime: 1.288446
train_loss: 0.252685
valid_loss: 1.165316
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003141668504403368
Epoch-1 lr: 0.006283337008806736
epoch 1 training time: 10.877
---------------
2023-09-12 11:18:11.028050
current #epochs=2, #steps=8
start validation
acc: 0.636364
AUC: 0.809229
Avg Precision: 0.325595
Avg Recall: 1.000000
d_prime: 1.237518
train_loss: 0.259961
valid_loss: 1.160428
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003141668504403368
Epoch-2 lr: 0.006283337008806736
epoch 2 training time: 9.514
---------------
2023-09-12 11:18:20.541831
current #epochs=3, #steps=16
start validation
acc: 0.636364
AUC: 0.830579
Avg Precision: 0.408953
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.228436
valid_loss: 1.162448
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003141668504403368
Epoch-3 lr: 0.006283337008806736
epoch 3 training time: 6.427
---------------
2023-09-12 11:18:26.969240
current #epochs=4, #steps=24
start validation
acc: 0.590909
AUC: 0.812672
Avg Precision: 0.344615
Avg Recall: 1.000000
d_prime: 1.255520
train_loss: 0.238591
valid_loss: 1.147330
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003141668504403368
Epoch-4 lr: 0.006283337008806736
epoch 4 training time: 6.626
---------------
2023-09-12 11:18:33.595403
current #epochs=5, #steps=32
start validation
acc: 0.568182
AUC: 0.811295
Avg Precision: 0.373500
Avg Recall: 1.000000
d_prime: 1.248295
train_loss: 0.184493
valid_loss: 1.157593
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.003141668504403368
Epoch-5 lr: 0.006283337008806736
epoch 5 training time: 6.368
---------------
2023-09-12 11:18:39.963885
current #epochs=6, #steps=40
start validation
acc: 0.590909
AUC: 0.825758
Avg Precision: 0.417326
Avg Recall: 1.000000
d_prime: 1.325871
train_loss: 0.240412
valid_loss: 1.145610
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.003141668504403368
Epoch-6 lr: 0.006283337008806736
epoch 6 training time: 6.291
---------------
2023-09-12 11:18:46.254860
current #epochs=7, #steps=48
start validation
acc: 0.613636
AUC: 0.847107
Avg Precision: 0.443559
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.161053
valid_loss: 1.129440
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002179189927377987
Epoch-7 lr: 0.004358379854755974
epoch 7 training time: 6.445
---------------
2023-09-12 11:18:52.699607
current #epochs=8, #steps=56
start validation
acc: 0.613636
AUC: 0.838843
Avg Precision: 0.400968
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.225330
valid_loss: 1.138704
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.002179189927377987
Epoch-8 lr: 0.004358379854755974
epoch 8 training time: 6.361
---------------
2023-09-12 11:18:59.060777
current #epochs=9, #steps=64
start validation
acc: 0.636364
AUC: 0.842287
Avg Precision: 0.400383
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.156917
valid_loss: 1.128495
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.002179189927377987
Epoch-9 lr: 0.004358379854755974
epoch 9 training time: 6.590
---------------
2023-09-12 11:19:05.650585
current #epochs=10, #steps=72
start validation
acc: 0.659091
AUC: 0.843664
Avg Precision: 0.389945
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.112185
valid_loss: 1.121738
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.002179189927377987
Epoch-10 lr: 0.004358379854755974
epoch 10 training time: 10.999
---------------
2023-09-12 11:19:16.650029
current #epochs=11, #steps=80
start validation
acc: 0.636364
AUC: 0.842287
Avg Precision: 0.384861
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.158393
valid_loss: 1.117151
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.002179189927377987
Epoch-11 lr: 0.004358379854755974
epoch 11 training time: 8.408
---------------
2023-09-12 11:19:25.057670
current #epochs=12, #steps=88
start validation
acc: 0.613636
AUC: 0.844353
Avg Precision: 0.430357
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.114673
valid_loss: 1.112579
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.002179189927377987
Epoch-12 lr: 0.004358379854755974
epoch 12 training time: 7.417
---------------
2023-09-12 11:19:32.474060
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01200	Per Sample Data Time 0.00616	Per Sample DNN Time 0.00583	Train Loss 0.1944	
start validation
acc: 0.613636
AUC: 0.840909
Avg Precision: 0.426110
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.156489
valid_loss: 1.121267
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0015115753724269936
Epoch-13 lr: 0.003023150744853987
epoch 13 training time: 6.740
---------------
2023-09-12 11:19:39.214220
current #epochs=14, #steps=104
start validation
acc: 0.636364
AUC: 0.840220
Avg Precision: 0.404771
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.166905
valid_loss: 1.121117
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0015115753724269936
Epoch-14 lr: 0.003023150744853987
epoch 14 training time: 6.270
---------------
2023-09-12 11:19:45.483880
current #epochs=15, #steps=112
start validation
acc: 0.636364
AUC: 0.851240
Avg Precision: 0.425214
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.149346
valid_loss: 1.109113
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0015115753724269936
Epoch-15 lr: 0.003023150744853987
epoch 15 training time: 7.283
---------------
2023-09-12 11:19:52.766955
current #epochs=16, #steps=120
start validation
acc: 0.613636
AUC: 0.856749
Avg Precision: 0.422381
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.154421
valid_loss: 1.103414
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0015115753724269936
Epoch-16 lr: 0.003023150744853987
epoch 16 training time: 6.446
---------------
2023-09-12 11:19:59.212675
current #epochs=17, #steps=128
start validation
acc: 0.659091
AUC: 0.856749
Avg Precision: 0.441554
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.167811
valid_loss: 1.104945
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0015115753724269936
Epoch-17 lr: 0.003023150744853987
epoch 17 training time: 6.525
---------------
2023-09-12 11:20:05.737786
current #epochs=18, #steps=136
start validation
acc: 0.659091
AUC: 0.857438
Avg Precision: 0.431059
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.112064
valid_loss: 1.098000
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0015115753724269936
Epoch-18 lr: 0.003023150744853987
epoch 18 training time: 7.115
---------------
2023-09-12 11:20:12.852915
current #epochs=19, #steps=144
start validation
acc: 0.636364
AUC: 0.856749
Avg Precision: 0.408480
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.092862
valid_loss: 1.097691
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0010484905779997616
Epoch-19 lr: 0.002096981155999523
epoch 19 training time: 6.733
---------------
2023-09-12 11:20:19.585929
current #epochs=20, #steps=152
start validation
acc: 0.613636
AUC: 0.847796
Avg Precision: 0.382531
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.083737
valid_loss: 1.106138
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0010484905779997616
Epoch-20 lr: 0.002096981155999523
epoch 20 training time: 8.377
---------------
2023-09-12 11:20:27.963523
current #epochs=21, #steps=160
start validation
acc: 0.613636
AUC: 0.842975
Avg Precision: 0.388809
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.098744
valid_loss: 1.111821
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0010484905779997616
Epoch-21 lr: 0.002096981155999523
epoch 21 training time: 6.553
---------------
2023-09-12 11:20:34.516468
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.843664
Avg Precision: 0.388809
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.089410
valid_loss: 1.111957
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0010484905779997616
Epoch-22 lr: 0.002096981155999523
epoch 22 training time: 6.696
---------------
2023-09-12 11:20:41.212509
current #epochs=23, #steps=176
start validation
acc: 0.659091
AUC: 0.836777
Avg Precision: 0.375294
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.121968
valid_loss: 1.118057
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0010484905779997616
Epoch-23 lr: 0.002096981155999523
epoch 23 training time: 6.521
---------------
2023-09-12 11:20:47.733878
current #epochs=24, #steps=184
start validation
acc: 0.590909
AUC: 0.838843
Avg Precision: 0.383699
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.073984
valid_loss: 1.125010
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0010484905779997616
Epoch-24 lr: 0.002096981155999523
epoch 24 training time: 6.424
---------------
2023-09-12 11:20:54.158171
current #epochs=25, #steps=192
start validation
acc: 0.590909
AUC: 0.839532
Avg Precision: 0.406771
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.145398
valid_loss: 1.132710
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0007272760010565533
Epoch-25 lr: 0.0014545520021131066
epoch 25 training time: 7.252
---------------
2023-09-12 11:21:01.409749
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03627	Per Sample Data Time 0.03080	Per Sample DNN Time 0.00547	Train Loss 0.1260	
start validation
acc: 0.590909
AUC: 0.842975
Avg Precision: 0.410361
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.100975
valid_loss: 1.133297
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0007272760010565533
Epoch-26 lr: 0.0014545520021131066
epoch 26 training time: 6.971
---------------
2023-09-12 11:21:08.380309
current #epochs=27, #steps=208
start validation
acc: 0.590909
AUC: 0.837466
Avg Precision: 0.396837
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.084403
valid_loss: 1.136742
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0007272760010565533
Epoch-27 lr: 0.0014545520021131066
epoch 27 training time: 6.541
---------------
2023-09-12 11:21:14.921259
current #epochs=28, #steps=216
start validation
acc: 0.590909
AUC: 0.831956
Avg Precision: 0.397639
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.114594
valid_loss: 1.140136
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0007272760010565533
Epoch-28 lr: 0.0014545520021131066
epoch 28 training time: 6.605
---------------
2023-09-12 11:21:21.526475
current #epochs=29, #steps=224
start validation
acc: 0.590909
AUC: 0.828512
Avg Precision: 0.389414
Avg Recall: 1.000000
d_prime: 1.341103
train_loss: 0.090481
valid_loss: 1.139964
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0007272760010565533
Epoch-29 lr: 0.0014545520021131066
epoch 29 training time: 6.754
---------------
2023-09-12 11:21:28.280758
current #epochs=30, #steps=232
start validation
acc: 0.636364
AUC: 0.833333
Avg Precision: 0.400411
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.070183
valid_loss: 1.134919
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0007272760010565533
Epoch-30 lr: 0.0014545520021131066
epoch 30 training time: 6.675
---------------
2023-09-12 11:21:34.956235
current #epochs=31, #steps=240
start validation
acc: 0.636364
AUC: 0.839532
Avg Precision: 0.405811
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.116664
valid_loss: 1.132267
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0005044684166088252
Epoch-31 lr: 0.0010089368332176505
epoch 31 training time: 8.018
---------------
2023-09-12 11:21:42.974100
current #epochs=32, #steps=248
start validation
[I 2023-09-12 11:21:49,423] Trial 76 finished with value: 0.6590909090909091 and parameters: {'warmup': 'False', 'num_epochs': 32, 'batch_size': 11, 'lr-adaptschedule': 'False', 'lr': 0.003141668504403368, 'head-lr': 2, 'lr-scheduler-start': 7, 'lr-scheduler-step': 6, 'lr-scheduler-decay': 0.6936409504451634}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.636364
AUC: 0.840220
Avg Precision: 0.405811
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.127485
valid_loss: 1.130730
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0005044684166088252
Epoch-32 lr: 0.0010089368332176505
epoch 32 training time: 6.444
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f956e0687f0>
The learning rate scheduler starts at 5 epoch with decay rate of 0.639 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 11:21:49.462656
current #epochs=1, #steps=0
start validation
acc: 0.590909
AUC: 0.820248
Avg Precision: 0.371076
Avg Recall: 1.000000
d_prime: 1.295859
train_loss: 0.174950
valid_loss: 1.159336
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0028449468404626323
Epoch-1 lr: 0.014224734202313162
epoch 1 training time: 9.240
---------------
2023-09-12 11:21:58.702480
current #epochs=2, #steps=8
start validation
acc: 0.613636
AUC: 0.845730
Avg Precision: 0.402644
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.179122
valid_loss: 1.118882
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0028449468404626323
Epoch-2 lr: 0.014224734202313162
epoch 2 training time: 11.103
---------------
2023-09-12 11:22:09.805844
current #epochs=3, #steps=16
start validation
acc: 0.659091
AUC: 0.843664
Avg Precision: 0.390491
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.176386
valid_loss: 1.120746
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0028449468404626323
Epoch-3 lr: 0.014224734202313162
epoch 3 training time: 8.997
---------------
2023-09-12 11:22:18.802321
current #epochs=4, #steps=24
start validation
acc: 0.659091
AUC: 0.823691
Avg Precision: 0.327509
Avg Recall: 1.000000
d_prime: 1.314547
train_loss: 0.131376
valid_loss: 1.134371
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0028449468404626323
Epoch-4 lr: 0.014224734202313162
epoch 4 training time: 6.294
---------------
2023-09-12 11:22:25.096075
current #epochs=5, #steps=32
start validation
acc: 0.704545
AUC: 0.836088
Avg Precision: 0.382268
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.145294
valid_loss: 1.134769
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.001817404320508637
Epoch-5 lr: 0.009087021602543186
epoch 5 training time: 10.605
---------------
2023-09-12 11:22:35.701362
current #epochs=6, #steps=40
start validation
acc: 0.659091
AUC: 0.846763
Avg Precision: 0.415774
Avg Recall: 1.000000
d_prime: 1.446244
train_loss: 0.131749
valid_loss: 1.127720
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.001817404320508637
Epoch-6 lr: 0.009087021602543186
epoch 6 training time: 7.545
---------------
2023-09-12 11:22:43.246302
current #epochs=7, #steps=48
start validation
acc: 0.681818
AUC: 0.834022
Avg Precision: 0.381416
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.103564
valid_loss: 1.129482
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.001160991276612518
Epoch-7 lr: 0.00580495638306259
epoch 7 training time: 7.116
---------------
2023-09-12 11:22:50.362458
current #epochs=8, #steps=56
start validation
acc: 0.659091
AUC: 0.815427
Avg Precision: 0.364835
Avg Recall: 1.000000
d_prime: 1.270069
train_loss: 0.163820
valid_loss: 1.133522
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001160991276612518
Epoch-8 lr: 0.00580495638306259
epoch 8 training time: 8.345
---------------
2023-09-12 11:22:58.707301
current #epochs=9, #steps=64
start validation
acc: 0.613636
AUC: 0.796143
Avg Precision: 0.342754
Avg Recall: 1.000000
d_prime: 1.170861
train_loss: 0.142475
valid_loss: 1.142375
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0007416625619075931
Epoch-9 lr: 0.003708312809537966
epoch 9 training time: 6.467
---------------
2023-09-12 11:23:05.174097
current #epochs=10, #steps=72
start validation
acc: 0.590909
AUC: 0.794077
Avg Precision: 0.340303
Avg Recall: 1.000000
d_prime: 1.160574
train_loss: 0.135115
valid_loss: 1.151583
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0007416625619075931
Epoch-10 lr: 0.003708312809537966
epoch 10 training time: 6.491
---------------
2023-09-12 11:23:11.665180
current #epochs=11, #steps=80
start validation
acc: 0.613636
AUC: 0.803719
Avg Precision: 0.343561
Avg Recall: 1.000000
d_prime: 1.209125
train_loss: 0.131797
valid_loss: 1.142126
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0004737876733581337
Epoch-11 lr: 0.002368938366790669
epoch 11 training time: 8.091
---------------
2023-09-12 11:23:19.756191
current #epochs=12, #steps=88
start validation
acc: 0.613636
AUC: 0.807851
Avg Precision: 0.342296
Avg Recall: 1.000000
d_prime: 1.230373
train_loss: 0.127028
valid_loss: 1.139032
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0004737876733581337
Epoch-12 lr: 0.002368938366790669
epoch 12 training time: 6.351
---------------
2023-09-12 11:23:26.107247
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01146	Per Sample Data Time 0.00602	Per Sample DNN Time 0.00544	Train Loss 0.1004	
start validation
acc: 0.659091
AUC: 0.811295
Avg Precision: 0.351935
Avg Recall: 1.000000
d_prime: 1.248295
train_loss: 0.093637
valid_loss: 1.134234
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00030266427207644586
Epoch-13 lr: 0.0015133213603822297
epoch 13 training time: 7.984
---------------
2023-09-12 11:23:34.091692
current #epochs=14, #steps=104
start validation
acc: 0.636364
AUC: 0.812672
Avg Precision: 0.366558
Avg Recall: 1.000000
d_prime: 1.255520
train_loss: 0.122662
valid_loss: 1.124452
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.00030266427207644586
Epoch-14 lr: 0.0015133213603822297
epoch 14 training time: 6.380
---------------
2023-09-12 11:23:40.471056
current #epochs=15, #steps=112
start validation
acc: 0.636364
AUC: 0.816804
Avg Precision: 0.369719
Avg Recall: 1.000000
d_prime: 1.277394
train_loss: 0.109327
valid_loss: 1.118477
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.00019334749876939196
Epoch-15 lr: 0.0009667374938469601
epoch 15 training time: 6.900
---------------
2023-09-12 11:23:47.371007
current #epochs=16, #steps=120
start validation
acc: 0.636364
AUC: 0.819559
Avg Precision: 0.374013
Avg Recall: 1.000000
d_prime: 1.292148
train_loss: 0.111483
valid_loss: 1.118394
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.00019334749876939196
Epoch-16 lr: 0.0009667374938469601
epoch 16 training time: 6.990
---------------
2023-09-12 11:23:54.360749
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.823003
Avg Precision: 0.372838
Avg Recall: 1.000000
d_prime: 1.310791
train_loss: 0.139270
valid_loss: 1.121039
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.00012351393517282376
Epoch-17 lr: 0.000617569675864119
epoch 17 training time: 6.492
---------------
2023-09-12 11:24:00.852426
current #epochs=18, #steps=136
start validation
acc: 0.681818
AUC: 0.823691
Avg Precision: 0.372838
Avg Recall: 1.000000
d_prime: 1.314547
train_loss: 0.142814
valid_loss: 1.123943
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00012351393517282376
Epoch-18 lr: 0.000617569675864119
epoch 18 training time: 6.519
---------------
2023-09-12 11:24:07.371067
current #epochs=19, #steps=144
start validation
acc: 0.659091
AUC: 0.823003
Avg Precision: 0.364243
Avg Recall: 1.000000
d_prime: 1.310791
train_loss: 0.087157
valid_loss: 1.126774
validation finished
normal learning rate scheduler step
Epoch-19 lr: 7.890297148385752e-05
Epoch-19 lr: 0.00039451485741928775
epoch 19 training time: 6.421
---------------
2023-09-12 11:24:13.792568
current #epochs=20, #steps=152
start validation
acc: 0.681818
AUC: 0.823003
Avg Precision: 0.360937
Avg Recall: 1.000000
d_prime: 1.310791
train_loss: 0.110501
valid_loss: 1.127757
validation finished
normal learning rate scheduler step
Epoch-20 lr: 7.890297148385752e-05
Epoch-20 lr: 0.00039451485741928775
epoch 20 training time: 6.612
---------------
2023-09-12 11:24:20.405080
current #epochs=21, #steps=160
start validation
acc: 0.681818
AUC: 0.824380
Avg Precision: 0.364556
Avg Recall: 1.000000
d_prime: 1.318312
train_loss: 0.122224
valid_loss: 1.127841
validation finished
normal learning rate scheduler step
Epoch-21 lr: 5.040466810705455e-05
Epoch-21 lr: 0.00025202334053527287
epoch 21 training time: 6.497
---------------
2023-09-12 11:24:26.901913
current #epochs=22, #steps=168
start validation
acc: 0.681818
AUC: 0.825069
Avg Precision: 0.363555
Avg Recall: 1.000000
d_prime: 1.322087
train_loss: 0.150398
valid_loss: 1.127934
validation finished
normal learning rate scheduler step
Epoch-22 lr: 5.040466810705455e-05
Epoch-22 lr: 0.00025202334053527287
epoch 22 training time: 6.469
---------------
2023-09-12 11:24:33.370548
current #epochs=23, #steps=176
start validation
acc: 0.681818
AUC: 0.821625
Avg Precision: 0.363555
Avg Recall: 1.000000
d_prime: 1.303307
train_loss: 0.137998
valid_loss: 1.128330
validation finished
normal learning rate scheduler step
Epoch-23 lr: 3.2199428224348947e-05
Epoch-23 lr: 0.00016099714112174481
epoch 23 training time: 6.624
---------------
2023-09-12 11:24:39.994621
current #epochs=24, #steps=184
start validation
acc: 0.681818
AUC: 0.823003
Avg Precision: 0.363555
Avg Recall: 1.000000
d_prime: 1.310791
train_loss: 0.075365
valid_loss: 1.128283
validation finished
normal learning rate scheduler step
Epoch-24 lr: 3.2199428224348947e-05
Epoch-24 lr: 0.00016099714112174481
epoch 24 training time: 6.459
---------------
2023-09-12 11:24:46.453997
current #epochs=25, #steps=192
start validation
acc: 0.681818
AUC: 0.823003
Avg Precision: 0.363555
Avg Recall: 1.000000
d_prime: 1.310791
train_loss: 0.118655
valid_loss: 1.128139
validation finished
normal learning rate scheduler step
Epoch-25 lr: 2.05695864472896e-05
Epoch-25 lr: 0.00010284793223644806
epoch 25 training time: 6.466
---------------
2023-09-12 11:24:52.919403
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03541	Per Sample Data Time 0.02990	Per Sample DNN Time 0.00551	Train Loss 0.1343	
start validation
acc: 0.681818
AUC: 0.822314
Avg Precision: 0.360783
Avg Recall: 1.000000
d_prime: 1.307044
train_loss: 0.112062
valid_loss: 1.128180
validation finished
normal learning rate scheduler step
Epoch-26 lr: 2.05695864472896e-05
Epoch-26 lr: 0.00010284793223644806
epoch 26 training time: 7.470
---------------
2023-09-12 11:25:00.388771
current #epochs=27, #steps=208
start validation
[I 2023-09-12 11:25:06,753] Trial 77 finished with value: 0.7045454545454546 and parameters: {'warmup': 'False', 'num_epochs': 27, 'batch_size': 14, 'lr-adaptschedule': 'False', 'lr': 0.0028449468404626323, 'head-lr': 5, 'lr-scheduler-start': 5, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.6388183760274055}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.681818
AUC: 0.822314
Avg Precision: 0.360783
Avg Recall: 1.000000
d_prime: 1.307044
train_loss: 0.134396
valid_loss: 1.128305
validation finished
normal learning rate scheduler step
Epoch-27 lr: 1.3140229809812872e-05
Epoch-27 lr: 6.57011490490644e-05
epoch 27 training time: 6.358
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8ea9f10>
The learning rate scheduler starts at 4 epoch with decay rate of 0.667 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 11:25:06.791948
current #epochs=1, #steps=0
start validation
acc: 0.613636
AUC: 0.834711
Avg Precision: 0.372986
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.146348
valid_loss: 1.128763
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0037711453635454312
Epoch-1 lr: 0.0075422907270908624
epoch 1 training time: 10.030
---------------
2023-09-12 11:25:16.822866
current #epochs=2, #steps=8
start validation
acc: 0.522727
AUC: 0.800275
Avg Precision: 0.352783
Avg Recall: 1.000000
d_prime: 1.191624
train_loss: 0.336465
valid_loss: 1.171183
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0037711453635454312
Epoch-2 lr: 0.0075422907270908624
epoch 2 training time: 6.382
---------------
2023-09-12 11:25:23.204380
current #epochs=3, #steps=16
start validation
acc: 0.568182
AUC: 0.822314
Avg Precision: 0.380530
Avg Recall: 1.000000
d_prime: 1.307044
train_loss: 0.327840
valid_loss: 1.149409
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0037711453635454312
Epoch-3 lr: 0.0075422907270908624
epoch 3 training time: 6.398
---------------
2023-09-12 11:25:29.602386
current #epochs=4, #steps=24
start validation
acc: 0.636364
AUC: 0.836088
Avg Precision: 0.395481
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.274899
valid_loss: 1.152724
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002517126371235355
Epoch-4 lr: 0.00503425274247071
epoch 4 training time: 9.120
---------------
2023-09-12 11:25:38.723168
current #epochs=5, #steps=32
start validation
acc: 0.727273
AUC: 0.857438
Avg Precision: 0.419565
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.240012
valid_loss: 1.120719
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002517126371235355
Epoch-5 lr: 0.00503425274247071
epoch 5 training time: 8.958
---------------
2023-09-12 11:25:47.680858
current #epochs=6, #steps=40
start validation
acc: 0.681818
AUC: 0.819559
Avg Precision: 0.311656
Avg Recall: 1.000000
d_prime: 1.292148
train_loss: 0.250689
valid_loss: 1.129741
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002517126371235355
Epoch-6 lr: 0.00503425274247071
epoch 6 training time: 6.452
---------------
2023-09-12 11:25:54.132839
current #epochs=7, #steps=48
start validation
acc: 0.681818
AUC: 0.809917
Avg Precision: 0.312492
Avg Recall: 1.000000
d_prime: 1.241102
train_loss: 0.208443
valid_loss: 1.139969
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0016801063226085152
Epoch-7 lr: 0.0033602126452170304
epoch 7 training time: 6.432
---------------
2023-09-12 11:26:00.565322
current #epochs=8, #steps=56
start validation
acc: 0.659091
AUC: 0.822314
Avg Precision: 0.336008
Avg Recall: 1.000000
d_prime: 1.307044
train_loss: 0.157126
valid_loss: 1.142637
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0016801063226085152
Epoch-8 lr: 0.0033602126452170304
epoch 8 training time: 6.258
---------------
2023-09-12 11:26:06.823292
current #epochs=9, #steps=64
start validation
acc: 0.659091
AUC: 0.822314
Avg Precision: 0.340194
Avg Recall: 1.000000
d_prime: 1.307044
train_loss: 0.143482
valid_loss: 1.140071
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0016801063226085152
Epoch-9 lr: 0.0033602126452170304
epoch 9 training time: 7.334
---------------
2023-09-12 11:26:14.157326
current #epochs=10, #steps=72
start validation
acc: 0.636364
AUC: 0.824380
Avg Precision: 0.340287
Avg Recall: 1.000000
d_prime: 1.318312
train_loss: 0.177786
valid_loss: 1.129926
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001121420556205033
Epoch-10 lr: 0.002242841112410066
epoch 10 training time: 6.431
---------------
2023-09-12 11:26:20.587901
current #epochs=11, #steps=80
start validation
acc: 0.636364
AUC: 0.819559
Avg Precision: 0.337330
Avg Recall: 1.000000
d_prime: 1.292148
train_loss: 0.107938
valid_loss: 1.134939
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001121420556205033
Epoch-11 lr: 0.002242841112410066
epoch 11 training time: 6.289
---------------
2023-09-12 11:26:26.876702
current #epochs=12, #steps=88
start validation
acc: 0.681818
AUC: 0.813361
Avg Precision: 0.334558
Avg Recall: 1.000000
d_prime: 1.259144
train_loss: 0.144856
valid_loss: 1.135304
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001121420556205033
Epoch-12 lr: 0.002242841112410066
epoch 12 training time: 6.295
---------------
2023-09-12 11:26:33.172517
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01183	Per Sample Data Time 0.00605	Per Sample DNN Time 0.00578	Train Loss 0.1247	
start validation
acc: 0.704545
AUC: 0.810606
Avg Precision: 0.328721
Avg Recall: 1.000000
d_prime: 1.244694
train_loss: 0.105287
valid_loss: 1.135031
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0007485145713437313
Epoch-13 lr: 0.0014970291426874625
epoch 13 training time: 7.524
---------------
2023-09-12 11:26:40.695854
current #epochs=14, #steps=104
start validation
acc: 0.659091
AUC: 0.816116
Avg Precision: 0.334879
Avg Recall: 1.000000
d_prime: 1.273727
train_loss: 0.116308
valid_loss: 1.131707
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0007485145713437313
Epoch-14 lr: 0.0014970291426874625
epoch 14 training time: 6.286
---------------
2023-09-12 11:26:46.981478
current #epochs=15, #steps=112
start validation
acc: 0.613636
AUC: 0.826446
Avg Precision: 0.345391
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.147478
valid_loss: 1.133825
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0007485145713437313
Epoch-15 lr: 0.0014970291426874625
epoch 15 training time: 6.434
---------------
2023-09-12 11:26:53.415495
current #epochs=16, #steps=120
start validation
acc: 0.613636
AUC: 0.833333
Avg Precision: 0.352123
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.133935
valid_loss: 1.133715
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0004996110160579695
Epoch-16 lr: 0.000999222032115939
epoch 16 training time: 6.398
---------------
2023-09-12 11:26:59.813099
current #epochs=17, #steps=128
start validation
acc: 0.613636
AUC: 0.838843
Avg Precision: 0.358514
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.097937
valid_loss: 1.131701
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0004996110160579695
Epoch-17 lr: 0.000999222032115939
epoch 17 training time: 7.477
---------------
2023-09-12 11:27:07.290091
current #epochs=18, #steps=136
start validation
acc: 0.613636
AUC: 0.839532
Avg Precision: 0.365472
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.096115
valid_loss: 1.129000
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0004996110160579695
Epoch-18 lr: 0.000999222032115939
epoch 18 training time: 6.395
---------------
2023-09-12 11:27:13.685493
current #epochs=19, #steps=144
start validation
acc: 0.613636
AUC: 0.845730
Avg Precision: 0.370454
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.117705
valid_loss: 1.125749
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00033347536163307463
Epoch-19 lr: 0.0006669507232661493
epoch 19 training time: 7.624
---------------
2023-09-12 11:27:21.309192
current #epochs=20, #steps=152
start validation
acc: 0.613636
AUC: 0.840909
Avg Precision: 0.364058
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.121935
valid_loss: 1.125759
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00033347536163307463
Epoch-20 lr: 0.0006669507232661493
epoch 20 training time: 7.450
---------------
2023-09-12 11:27:28.759372
current #epochs=21, #steps=160
start validation
acc: 0.613636
AUC: 0.836777
Avg Precision: 0.364058
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.118636
valid_loss: 1.126785
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00033347536163307463
Epoch-21 lr: 0.0006669507232661493
epoch 21 training time: 6.421
---------------
2023-09-12 11:27:35.180421
current #epochs=22, #steps=168
start validation
acc: 0.613636
AUC: 0.838154
Avg Precision: 0.357664
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.116905
valid_loss: 1.126286
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0002225847974565212
Epoch-22 lr: 0.0004451695949130424
epoch 22 training time: 6.868
---------------
2023-09-12 11:27:42.048444
current #epochs=23, #steps=176
start validation
acc: 0.613636
AUC: 0.836777
Avg Precision: 0.350123
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.130326
valid_loss: 1.124612
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0002225847974565212
Epoch-23 lr: 0.0004451695949130424
epoch 23 training time: 6.687
---------------
2023-09-12 11:27:48.735389
current #epochs=24, #steps=184
start validation
acc: 0.613636
AUC: 0.835399
Avg Precision: 0.350123
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.074148
valid_loss: 1.123580
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0002225847974565212
Epoch-24 lr: 0.0004451695949130424
epoch 24 training time: 7.423
---------------
2023-09-12 11:27:56.158464
current #epochs=25, #steps=192
start validation
acc: 0.613636
AUC: 0.834711
Avg Precision: 0.345893
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.127524
valid_loss: 1.123302
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00014856867330808742
Epoch-25 lr: 0.00029713734661617483
epoch 25 training time: 6.381
---------------
2023-09-12 11:28:02.539377
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03526	Per Sample Data Time 0.02978	Per Sample DNN Time 0.00548	Train Loss 0.1259	
start validation
acc: 0.613636
AUC: 0.834711
Avg Precision: 0.345893
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.127671
valid_loss: 1.123967
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00014856867330808742
Epoch-26 lr: 0.00029713734661617483
epoch 26 training time: 6.348
---------------
2023-09-12 11:28:08.887445
current #epochs=27, #steps=208
start validation
acc: 0.613636
AUC: 0.833333
Avg Precision: 0.345893
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.113351
valid_loss: 1.125230
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00014856867330808742
Epoch-27 lr: 0.00029713734661617483
epoch 27 training time: 6.345
---------------
2023-09-12 11:28:15.232021
current #epochs=28, #steps=216
start validation
acc: 0.636364
AUC: 0.831267
Avg Precision: 0.347490
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.105707
valid_loss: 1.126601
validation finished
normal learning rate scheduler step
Epoch-28 lr: 9.916513140497291e-05
Epoch-28 lr: 0.00019833026280994582
epoch 28 training time: 6.453
---------------
2023-09-12 11:28:21.684547
current #epochs=29, #steps=224
start validation
[I 2023-09-12 11:28:28,333] Trial 78 finished with value: 0.7272727272727273 and parameters: {'warmup': 'False', 'num_epochs': 29, 'batch_size': 16, 'lr-adaptschedule': 'False', 'lr': 0.0037711453635454312, 'head-lr': 2, 'lr-scheduler-start': 4, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.6674699934846547}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.613636
AUC: 0.834711
Avg Precision: 0.356304
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.118865
valid_loss: 1.126987
validation finished
normal learning rate scheduler step
Epoch-29 lr: 9.916513140497291e-05
Epoch-29 lr: 0.00019833026280994582
epoch 29 training time: 6.643
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8d97e20>
The learning rate scheduler starts at 4 epoch with decay rate of 0.671 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 11:28:28.372646
current #epochs=1, #steps=0
start validation
acc: 0.659091
AUC: 0.829890
Avg Precision: 0.368042
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.325720
valid_loss: 1.148590
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0037846223539214144
Epoch-1 lr: 0.007569244707842829
epoch 1 training time: 9.707
---------------
2023-09-12 11:28:38.079774
current #epochs=2, #steps=8
start validation
acc: 0.568182
AUC: 0.809917
Avg Precision: 0.330783
Avg Recall: 1.000000
d_prime: 1.241102
train_loss: 0.285103
valid_loss: 1.154684
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0037846223539214144
Epoch-2 lr: 0.007569244707842829
epoch 2 training time: 6.450
---------------
2023-09-12 11:28:44.529983
current #epochs=3, #steps=16
start validation
acc: 0.590909
AUC: 0.819559
Avg Precision: 0.381095
Avg Recall: 1.000000
d_prime: 1.292148
train_loss: 0.241488
valid_loss: 1.146002
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0037846223539214144
Epoch-3 lr: 0.007569244707842829
epoch 3 training time: 6.717
---------------
2023-09-12 11:28:51.247163
current #epochs=4, #steps=24
start validation
acc: 0.704545
AUC: 0.833333
Avg Precision: 0.433551
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.168774
valid_loss: 1.137561
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002537789647027905
Epoch-4 lr: 0.00507557929405581
epoch 4 training time: 9.066
---------------
2023-09-12 11:29:00.313672
current #epochs=5, #steps=32
start validation
acc: 0.681818
AUC: 0.829890
Avg Precision: 0.414803
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.161719
valid_loss: 1.141702
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002537789647027905
Epoch-5 lr: 0.00507557929405581
epoch 5 training time: 6.403
---------------
2023-09-12 11:29:06.716024
current #epochs=6, #steps=40
start validation
acc: 0.636364
AUC: 0.832645
Avg Precision: 0.427599
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.140300
valid_loss: 1.132845
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002537789647027905
Epoch-6 lr: 0.00507557929405581
epoch 6 training time: 6.395
---------------
2023-09-12 11:29:13.110762
current #epochs=7, #steps=48
start validation
acc: 0.613636
AUC: 0.826446
Avg Precision: 0.401210
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.147923
valid_loss: 1.142677
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002537789647027905
Epoch-7 lr: 0.00507557929405581
epoch 7 training time: 6.376
---------------
2023-09-12 11:29:19.486709
current #epochs=8, #steps=56
start validation
acc: 0.590909
AUC: 0.834711
Avg Precision: 0.397426
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.162953
valid_loss: 1.127322
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001701722309463416
Epoch-8 lr: 0.003403444618926832
epoch 8 training time: 6.356
---------------
2023-09-12 11:29:25.842702
current #epochs=9, #steps=64
start validation
acc: 0.681818
AUC: 0.851240
Avg Precision: 0.465570
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.159658
valid_loss: 1.108768
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001701722309463416
Epoch-9 lr: 0.003403444618926832
epoch 9 training time: 6.369
---------------
2023-09-12 11:29:32.211485
current #epochs=10, #steps=72
start validation
acc: 0.704545
AUC: 0.856749
Avg Precision: 0.493426
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.168619
valid_loss: 1.111267
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001701722309463416
Epoch-10 lr: 0.003403444618926832
epoch 10 training time: 7.629
---------------
2023-09-12 11:29:39.840736
current #epochs=11, #steps=80
start validation
acc: 0.659091
AUC: 0.848485
Avg Precision: 0.455302
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.135096
valid_loss: 1.121211
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001701722309463416
Epoch-11 lr: 0.003403444618926832
epoch 11 training time: 6.423
---------------
2023-09-12 11:29:46.263926
current #epochs=12, #steps=88
start validation
acc: 0.659091
AUC: 0.838843
Avg Precision: 0.400113
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.116021
valid_loss: 1.126619
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0011410948980412716
Epoch-12 lr: 0.002282189796082543
epoch 12 training time: 6.418
---------------
2023-09-12 11:29:52.682513
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01196	Per Sample Data Time 0.00624	Per Sample DNN Time 0.00572	Train Loss 0.0942	
start validation
acc: 0.636364
AUC: 0.836088
Avg Precision: 0.408447
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.090550
valid_loss: 1.133667
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0011410948980412716
Epoch-13 lr: 0.002282189796082543
epoch 13 training time: 6.377
---------------
2023-09-12 11:29:59.059677
current #epochs=14, #steps=104
start validation
acc: 0.613636
AUC: 0.842975
Avg Precision: 0.427982
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.108898
valid_loss: 1.126331
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0011410948980412716
Epoch-14 lr: 0.002282189796082543
epoch 14 training time: 6.329
---------------
2023-09-12 11:30:05.388715
current #epochs=15, #steps=112
start validation
acc: 0.659091
AUC: 0.836777
Avg Precision: 0.434626
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.170825
valid_loss: 1.124948
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0011410948980412716
Epoch-15 lr: 0.002282189796082543
epoch 15 training time: 6.605
---------------
2023-09-12 11:30:11.994044
current #epochs=16, #steps=120
start validation
acc: 0.636364
AUC: 0.828512
Avg Precision: 0.387946
Avg Recall: 1.000000
d_prime: 1.341103
train_loss: 0.099161
valid_loss: 1.131712
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0007651645389466599
Epoch-16 lr: 0.0015303290778933198
epoch 16 training time: 6.567
---------------
2023-09-12 11:30:18.560803
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.835399
Avg Precision: 0.412114
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.137084
valid_loss: 1.130518
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0007651645389466599
Epoch-17 lr: 0.0015303290778933198
epoch 17 training time: 6.394
---------------
2023-09-12 11:30:24.955137
current #epochs=18, #steps=136
start validation
acc: 0.613636
AUC: 0.839532
Avg Precision: 0.412222
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.100574
valid_loss: 1.124698
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0007651645389466599
Epoch-18 lr: 0.0015303290778933198
epoch 18 training time: 6.297
---------------
2023-09-12 11:30:31.252323
current #epochs=19, #steps=144
start validation
acc: 0.613636
AUC: 0.851240
Avg Precision: 0.416091
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.143088
valid_loss: 1.119420
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0007651645389466599
Epoch-19 lr: 0.0015303290778933198
epoch 19 training time: 6.427
---------------
2023-09-12 11:30:37.679196
current #epochs=20, #steps=152
start validation
acc: 0.613636
AUC: 0.858127
Avg Precision: 0.440015
Avg Recall: 1.000000
d_prime: 1.515953
train_loss: 0.120976
valid_loss: 1.112055
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0005130833313394404
Epoch-20 lr: 0.0010261666626788808
epoch 20 training time: 7.637
---------------
2023-09-12 11:30:45.315917
current #epochs=21, #steps=160
start validation
acc: 0.636364
AUC: 0.859504
Avg Precision: 0.445780
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.079863
valid_loss: 1.110981
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0005130833313394404
Epoch-21 lr: 0.0010261666626788808
epoch 21 training time: 6.462
---------------
2023-09-12 11:30:51.777992
current #epochs=22, #steps=168
start validation
acc: 0.613636
AUC: 0.860193
Avg Precision: 0.445780
Avg Recall: 1.000000
d_prime: 1.529028
train_loss: 0.105658
valid_loss: 1.107829
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0005130833313394404
Epoch-22 lr: 0.0010261666626788808
epoch 22 training time: 6.493
---------------
2023-09-12 11:30:58.270872
current #epochs=23, #steps=176
start validation
acc: 0.613636
AUC: 0.859504
Avg Precision: 0.447186
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.141096
valid_loss: 1.113913
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0005130833313394404
Epoch-23 lr: 0.0010261666626788808
epoch 23 training time: 6.548
---------------
2023-09-12 11:31:04.819143
current #epochs=24, #steps=184
start validation
acc: 0.613636
AUC: 0.856749
Avg Precision: 0.445041
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.094679
valid_loss: 1.115326
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00034404953640530583
Epoch-24 lr: 0.0006880990728106117
epoch 24 training time: 6.378
---------------
2023-09-12 11:31:11.196795
current #epochs=25, #steps=192
start validation
acc: 0.590909
AUC: 0.861570
Avg Precision: 0.445041
Avg Recall: 1.000000
d_prime: 1.537818
train_loss: 0.149938
valid_loss: 1.116072
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00034404953640530583
Epoch-25 lr: 0.0006880990728106117
epoch 25 training time: 6.415
---------------
2023-09-12 11:31:17.611944
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03759	Per Sample Data Time 0.03003	Per Sample DNN Time 0.00756	Train Loss 0.1344	
start validation
acc: 0.636364
AUC: 0.863636
Avg Precision: 0.447672
Avg Recall: 1.000000
d_prime: 1.551114
train_loss: 0.071654
valid_loss: 1.112486
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00034404953640530583
Epoch-26 lr: 0.0006880990728106117
epoch 26 training time: 6.439
---------------
2023-09-12 11:31:24.051006
current #epochs=27, #steps=208
start validation
acc: 0.636364
AUC: 0.862259
Avg Precision: 0.448148
Avg Recall: 1.000000
d_prime: 1.542235
train_loss: 0.095443
valid_loss: 1.111439
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00034404953640530583
Epoch-27 lr: 0.0006880990728106117
epoch 27 training time: 6.259
---------------
2023-09-12 11:31:30.309968
current #epochs=28, #steps=216
start validation
acc: 0.636364
AUC: 0.862948
Avg Precision: 0.436470
Avg Recall: 1.000000
d_prime: 1.546667
train_loss: 0.097390
valid_loss: 1.109481
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0002307034282164115
Epoch-28 lr: 0.000461406856432823
epoch 28 training time: 6.938
---------------
2023-09-12 11:31:37.247721
current #epochs=29, #steps=224
start validation
acc: 0.636364
AUC: 0.859504
Avg Precision: 0.426276
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.119459
valid_loss: 1.108200
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0002307034282164115
Epoch-29 lr: 0.000461406856432823
epoch 29 training time: 6.453
---------------
2023-09-12 11:31:43.700734
current #epochs=30, #steps=232
start validation
acc: 0.636364
AUC: 0.861570
Avg Precision: 0.438062
Avg Recall: 1.000000
d_prime: 1.537818
train_loss: 0.131400
valid_loss: 1.106634
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0002307034282164115
Epoch-30 lr: 0.000461406856432823
epoch 30 training time: 6.323
---------------
2023-09-12 11:31:50.023902
current #epochs=31, #steps=240
start validation
acc: 0.636364
AUC: 0.861570
Avg Precision: 0.438062
Avg Recall: 1.000000
d_prime: 1.537818
train_loss: 0.093426
valid_loss: 1.107005
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0002307034282164115
Epoch-31 lr: 0.000461406856432823
epoch 31 training time: 6.527
---------------
2023-09-12 11:31:56.550563
current #epochs=32, #steps=248
start validation
acc: 0.636364
AUC: 0.862259
Avg Precision: 0.441019
Avg Recall: 1.000000
d_prime: 1.542235
train_loss: 0.174422
valid_loss: 1.106287
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00015469886210834648
Epoch-32 lr: 0.00030939772421669296
epoch 32 training time: 6.460
---------------
2023-09-12 11:32:03.010691
current #epochs=33, #steps=256
start validation
acc: 0.636364
AUC: 0.862259
Avg Precision: 0.441019
Avg Recall: 1.000000
d_prime: 1.542235
train_loss: 0.057202
valid_loss: 1.105039
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.00015469886210834648
Epoch-33 lr: 0.00030939772421669296
epoch 33 training time: 6.359
---------------
2023-09-12 11:32:09.369688
current #epochs=34, #steps=264
start validation
acc: 0.636364
AUC: 0.861570
Avg Precision: 0.441019
Avg Recall: 1.000000
d_prime: 1.537818
train_loss: 0.100087
valid_loss: 1.105811
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.00015469886210834648
Epoch-34 lr: 0.00030939772421669296
epoch 34 training time: 8.328
---------------
2023-09-12 11:32:17.698244
current #epochs=35, #steps=272
start validation
acc: 0.636364
AUC: 0.861570
Avg Precision: 0.441019
Avg Recall: 1.000000
d_prime: 1.537818
train_loss: 0.098816
valid_loss: 1.107046
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.00015469886210834648
Epoch-35 lr: 0.00030939772421669296
epoch 35 training time: 7.026
---------------
2023-09-12 11:32:24.724200
current #epochs=36, #steps=280
start validation
acc: 0.636364
AUC: 0.858815
Avg Precision: 0.441019
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.109412
valid_loss: 1.109894
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.00010373377683476822
Epoch-36 lr: 0.00020746755366953643
epoch 36 training time: 6.449
---------------
2023-09-12 11:32:31.173254
current #epochs=37, #steps=288
start validation
acc: 0.636364
AUC: 0.856749
Avg Precision: 0.441019
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.157614
valid_loss: 1.111355
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.00010373377683476822
Epoch-37 lr: 0.00020746755366953643
epoch 37 training time: 6.504
---------------
2023-09-12 11:32:37.676870
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01200	Per Sample Data Time 0.00628	Per Sample DNN Time 0.00572	Train Loss 0.1465	
start validation
acc: 0.636364
AUC: 0.856061
Avg Precision: 0.441019
Avg Recall: 1.000000
d_prime: 1.503007
train_loss: 0.127466
valid_loss: 1.113063
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.00010373377683476822
Epoch-38 lr: 0.00020746755366953643
epoch 38 training time: 6.382
---------------
2023-09-12 11:32:44.059517
current #epochs=39, #steps=304
start validation
acc: 0.636364
AUC: 0.857438
Avg Precision: 0.444179
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.115597
valid_loss: 1.113880
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.00010373377683476822
Epoch-39 lr: 0.00020746755366953643
epoch 39 training time: 6.353
---------------
2023-09-12 11:32:50.412712
current #epochs=40, #steps=312
start validation
acc: 0.636364
AUC: 0.856061
Avg Precision: 0.444179
Avg Recall: 1.000000
d_prime: 1.503007
train_loss: 0.114947
valid_loss: 1.113724
validation finished
normal learning rate scheduler step
Epoch-40 lr: 6.955898905622863e-05
Epoch-40 lr: 0.00013911797811245726
epoch 40 training time: 6.409
---------------
2023-09-12 11:32:56.821518
current #epochs=41, #steps=320
start validation
acc: 0.636364
AUC: 0.857438
Avg Precision: 0.444179
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.111492
valid_loss: 1.113770
validation finished
normal learning rate scheduler step
Epoch-41 lr: 6.955898905622863e-05
Epoch-41 lr: 0.00013911797811245726
epoch 41 training time: 6.465
---------------
2023-09-12 11:33:03.286090
current #epochs=42, #steps=328
start validation
acc: 0.636364
AUC: 0.858815
Avg Precision: 0.444179
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.104533
valid_loss: 1.113492
validation finished
normal learning rate scheduler step
Epoch-42 lr: 6.955898905622863e-05
Epoch-42 lr: 0.00013911797811245726
epoch 42 training time: 7.150
---------------
2023-09-12 11:33:10.435933
current #epochs=43, #steps=336
start validation
acc: 0.636364
AUC: 0.858815
Avg Precision: 0.444179
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.100853
valid_loss: 1.113587
validation finished
normal learning rate scheduler step
Epoch-43 lr: 6.955898905622863e-05
Epoch-43 lr: 0.00013911797811245726
epoch 43 training time: 6.279
---------------
2023-09-12 11:33:16.714769
current #epochs=44, #steps=344
start validation
[I 2023-09-12 11:33:23,467] Trial 79 finished with value: 0.7045454545454546 and parameters: {'warmup': 'False', 'num_epochs': 44, 'batch_size': 8, 'lr-adaptschedule': 'False', 'lr': 0.0037846223539214144, 'head-lr': 2, 'lr-scheduler-start': 4, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.6705529402156569}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.636364
AUC: 0.859504
Avg Precision: 0.444179
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.099238
valid_loss: 1.113628
validation finished
normal learning rate scheduler step
Epoch-44 lr: 4.664298463008281e-05
Epoch-44 lr: 9.328596926016562e-05
epoch 44 training time: 6.746
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8d222e0>
The learning rate scheduler starts at 3 epoch with decay rate of 0.656 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 11:33:23.509191
current #epochs=1, #steps=0
start validation
acc: 0.522727
AUC: 0.837466
Avg Precision: 0.376453
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.276322
valid_loss: 1.133401
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.004176779015953526
Epoch-1 lr: 0.012530337047860579
epoch 1 training time: 9.074
---------------
2023-09-12 11:33:32.583400
current #epochs=2, #steps=8
start validation
acc: 0.568182
AUC: 0.816116
Avg Precision: 0.382417
Avg Recall: 1.000000
d_prime: 1.273727
train_loss: 0.317570
valid_loss: 1.163726
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.004176779015953526
Epoch-2 lr: 0.012530337047860579
epoch 2 training time: 16.118
---------------
2023-09-12 11:33:48.701463
current #epochs=3, #steps=16
start validation
acc: 0.613636
AUC: 0.812672
Avg Precision: 0.341474
Avg Recall: 1.000000
d_prime: 1.255520
train_loss: 0.260325
valid_loss: 1.155754
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0027411457416894
Epoch-3 lr: 0.0082234372250682
epoch 3 training time: 9.141
---------------
2023-09-12 11:33:57.842591
current #epochs=4, #steps=24
start validation
acc: 0.659091
AUC: 0.851928
Avg Precision: 0.478364
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.304583
valid_loss: 1.126742
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0027411457416894
Epoch-4 lr: 0.0082234372250682
epoch 4 training time: 9.029
---------------
2023-09-12 11:34:06.871809
current #epochs=5, #steps=32
start validation
acc: 0.590909
AUC: 0.803030
Avg Precision: 0.338399
Avg Recall: 1.000000
d_prime: 1.205610
train_loss: 0.152226
valid_loss: 1.170691
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0027411457416894
Epoch-5 lr: 0.0082234372250682
epoch 5 training time: 6.390
---------------
2023-09-12 11:34:13.261773
current #epochs=6, #steps=40
start validation
acc: 0.590909
AUC: 0.803719
Avg Precision: 0.373332
Avg Recall: 1.000000
d_prime: 1.209125
train_loss: 0.196702
valid_loss: 1.154473
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0027411457416894
Epoch-6 lr: 0.0082234372250682
epoch 6 training time: 6.440
---------------
2023-09-12 11:34:19.701301
current #epochs=7, #steps=48
start validation
acc: 0.590909
AUC: 0.810606
Avg Precision: 0.365699
Avg Recall: 1.000000
d_prime: 1.244694
train_loss: 0.111684
valid_loss: 1.143599
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0027411457416894
Epoch-7 lr: 0.0082234372250682
epoch 7 training time: 6.949
---------------
2023-09-12 11:34:26.650760
current #epochs=8, #steps=56
start validation
acc: 0.590909
AUC: 0.808540
Avg Precision: 0.344747
Avg Recall: 1.000000
d_prime: 1.233942
train_loss: 0.115541
valid_loss: 1.142428
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0017989651711239913
Epoch-8 lr: 0.005396895513371974
epoch 8 training time: 6.252
---------------
2023-09-12 11:34:32.902565
current #epochs=9, #steps=64
start validation
acc: 0.613636
AUC: 0.818871
Avg Precision: 0.350793
Avg Recall: 1.000000
d_prime: 1.288446
train_loss: 0.140236
valid_loss: 1.139319
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0017989651711239913
Epoch-9 lr: 0.005396895513371974
epoch 9 training time: 8.164
---------------
2023-09-12 11:34:41.066660
current #epochs=10, #steps=72
start validation
acc: 0.613636
AUC: 0.838154
Avg Precision: 0.389393
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.157219
valid_loss: 1.135058
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0017989651711239913
Epoch-10 lr: 0.005396895513371974
epoch 10 training time: 6.614
---------------
2023-09-12 11:34:47.680870
current #epochs=11, #steps=80
start validation
acc: 0.636364
AUC: 0.851928
Avg Precision: 0.410408
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.167003
valid_loss: 1.115007
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0017989651711239913
Epoch-11 lr: 0.005396895513371974
epoch 11 training time: 6.887
---------------
2023-09-12 11:34:54.567502
current #epochs=12, #steps=88
start validation
acc: 0.636364
AUC: 0.851240
Avg Precision: 0.424193
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.189947
valid_loss: 1.109902
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0017989651711239913
Epoch-12 lr: 0.005396895513371974
epoch 12 training time: 6.602
---------------
2023-09-12 11:35:01.169896
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01223	Per Sample Data Time 0.00644	Per Sample DNN Time 0.00579	Train Loss 0.1566	
start validation
acc: 0.636364
AUC: 0.850551
Avg Precision: 0.380530
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.149478
valid_loss: 1.127025
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0011806288289226887
Epoch-13 lr: 0.003541886486768066
epoch 13 training time: 6.661
---------------
2023-09-12 11:35:07.830521
current #epochs=14, #steps=104
start validation
acc: 0.636364
AUC: 0.842975
Avg Precision: 0.372491
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.140179
valid_loss: 1.131801
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0011806288289226887
Epoch-14 lr: 0.003541886486768066
epoch 14 training time: 6.450
---------------
2023-09-12 11:35:14.280898
current #epochs=15, #steps=112
start validation
acc: 0.636364
AUC: 0.842287
Avg Precision: 0.383102
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.151532
valid_loss: 1.124432
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0011806288289226887
Epoch-15 lr: 0.003541886486768066
epoch 15 training time: 6.449
---------------
2023-09-12 11:35:20.729755
current #epochs=16, #steps=120
start validation
acc: 0.636364
AUC: 0.842287
Avg Precision: 0.384216
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.083637
valid_loss: 1.123729
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0011806288289226887
Epoch-16 lr: 0.003541886486768066
epoch 16 training time: 9.529
---------------
2023-09-12 11:35:30.258617
current #epochs=17, #steps=128
start validation
acc: 0.613636
AUC: 0.837466
Avg Precision: 0.366886
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.132327
valid_loss: 1.136717
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0011806288289226887
Epoch-17 lr: 0.003541886486768066
epoch 17 training time: 6.445
---------------
2023-09-12 11:35:36.703774
current #epochs=18, #steps=136
start validation
acc: 0.636364
AUC: 0.837466
Avg Precision: 0.369337
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.119131
valid_loss: 1.141994
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0007748256909345621
Epoch-18 lr: 0.0023244770728036864
epoch 18 training time: 6.363
---------------
2023-09-12 11:35:43.067401
current #epochs=19, #steps=144
start validation
acc: 0.659091
AUC: 0.849174
Avg Precision: 0.391435
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.140066
valid_loss: 1.126209
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0007748256909345621
Epoch-19 lr: 0.0023244770728036864
epoch 19 training time: 6.894
---------------
2023-09-12 11:35:49.961101
current #epochs=20, #steps=152
start validation
acc: 0.636364
AUC: 0.849862
Avg Precision: 0.403559
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.157443
valid_loss: 1.114661
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0007748256909345621
Epoch-20 lr: 0.0023244770728036864
epoch 20 training time: 6.541
---------------
2023-09-12 11:35:56.502470
current #epochs=21, #steps=160
start validation
acc: 0.659091
AUC: 0.848485
Avg Precision: 0.406331
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.139916
valid_loss: 1.118308
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0007748256909345621
Epoch-21 lr: 0.0023244770728036864
epoch 21 training time: 7.663
---------------
2023-09-12 11:36:04.165405
current #epochs=22, #steps=168
start validation
acc: 0.613636
AUC: 0.844353
Avg Precision: 0.403559
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.099872
valid_loss: 1.124484
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0007748256909345621
Epoch-22 lr: 0.0023244770728036864
epoch 22 training time: 7.470
---------------
2023-09-12 11:36:11.635178
current #epochs=23, #steps=176
start validation
acc: 0.568182
AUC: 0.841598
Avg Precision: 0.409103
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.116171
valid_loss: 1.128918
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0005085043128076408
Epoch-23 lr: 0.0015255129384229226
epoch 23 training time: 6.453
---------------
2023-09-12 11:36:18.088720
current #epochs=24, #steps=184
start validation
acc: 0.568182
AUC: 0.839532
Avg Precision: 0.407476
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.095654
valid_loss: 1.130554
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0005085043128076408
Epoch-24 lr: 0.0015255129384229226
epoch 24 training time: 7.646
---------------
2023-09-12 11:36:25.734416
current #epochs=25, #steps=192
start validation
acc: 0.568182
AUC: 0.836777
Avg Precision: 0.403559
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.088706
valid_loss: 1.130282
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0005085043128076408
Epoch-25 lr: 0.0015255129384229226
epoch 25 training time: 6.771
---------------
2023-09-12 11:36:32.505234
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03618	Per Sample Data Time 0.03035	Per Sample DNN Time 0.00583	Train Loss 0.0481	
start validation
acc: 0.568182
AUC: 0.840220
Avg Precision: 0.407476
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.098025
valid_loss: 1.128142
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0005085043128076408
Epoch-26 lr: 0.0015255129384229226
epoch 26 training time: 6.486
---------------
2023-09-12 11:36:38.991743
current #epochs=27, #steps=208
start validation
acc: 0.590909
AUC: 0.842287
Avg Precision: 0.411707
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.089111
valid_loss: 1.124822
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0005085043128076408
Epoch-27 lr: 0.0015255129384229226
epoch 27 training time: 6.274
---------------
2023-09-12 11:36:45.265352
current #epochs=28, #steps=216
start validation
acc: 0.613636
AUC: 0.843664
Avg Precision: 0.403559
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.064834
valid_loss: 1.119347
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00033372233157639205
Epoch-28 lr: 0.0010011669947291764
epoch 28 training time: 6.680
---------------
2023-09-12 11:36:51.945167
current #epochs=29, #steps=224
start validation
[I 2023-09-12 11:36:58,442] Trial 80 finished with value: 0.6590909090909091 and parameters: {'warmup': 'False', 'num_epochs': 29, 'batch_size': 16, 'lr-adaptschedule': 'False', 'lr': 0.004176779015953526, 'head-lr': 3, 'lr-scheduler-start': 3, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.6562822048328113}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.613636
AUC: 0.847796
Avg Precision: 0.405185
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.109265
valid_loss: 1.116803
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00033372233157639205
Epoch-29 lr: 0.0010011669947291764
epoch 29 training time: 6.491
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c856c160>
The learning rate scheduler starts at 4 epoch with decay rate of 0.680 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 11:36:58.486056
current #epochs=1, #steps=0
start validation
acc: 0.613636
AUC: 0.838843
Avg Precision: 0.370115
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.234650
valid_loss: 1.134421
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003676543849827492
Epoch-1 lr: 0.007353087699654984
epoch 1 training time: 11.594
---------------
2023-09-12 11:37:10.080709
current #epochs=2, #steps=8
start validation
acc: 0.613636
AUC: 0.823003
Avg Precision: 0.377194
Avg Recall: 1.000000
d_prime: 1.310791
train_loss: 0.180476
valid_loss: 1.161946
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003676543849827492
Epoch-2 lr: 0.007353087699654984
epoch 2 training time: 7.125
---------------
2023-09-12 11:37:17.205410
current #epochs=3, #steps=16
start validation
acc: 0.568182
AUC: 0.806474
Avg Precision: 0.356898
Avg Recall: 1.000000
d_prime: 1.223260
train_loss: 0.190655
valid_loss: 1.155447
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003676543849827492
Epoch-3 lr: 0.007353087699654984
epoch 3 training time: 7.320
---------------
2023-09-12 11:37:24.525662
current #epochs=4, #steps=24
start validation
acc: 0.590909
AUC: 0.820937
Avg Precision: 0.341809
Avg Recall: 1.000000
d_prime: 1.299578
train_loss: 0.249078
valid_loss: 1.153785
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002501811922783655
Epoch-4 lr: 0.00500362384556731
epoch 4 training time: 7.775
---------------
2023-09-12 11:37:32.300363
current #epochs=5, #steps=32
start validation
acc: 0.659091
AUC: 0.829201
Avg Precision: 0.341820
Avg Recall: 1.000000
d_prime: 1.344935
train_loss: 0.132628
valid_loss: 1.145589
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002501811922783655
Epoch-5 lr: 0.00500362384556731
epoch 5 training time: 8.865
---------------
2023-09-12 11:37:41.165670
current #epochs=6, #steps=40
start validation
acc: 0.613636
AUC: 0.840220
Avg Precision: 0.390948
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.149091
valid_loss: 1.135844
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002501811922783655
Epoch-6 lr: 0.00500362384556731
epoch 6 training time: 8.584
---------------
2023-09-12 11:37:49.750332
current #epochs=7, #steps=48
start validation
acc: 0.659091
AUC: 0.859504
Avg Precision: 0.402964
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.183188
valid_loss: 1.127055
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0017024311833724309
Epoch-7 lr: 0.0034048623667448617
epoch 7 training time: 7.065
---------------
2023-09-12 11:37:56.815107
current #epochs=8, #steps=56
start validation
acc: 0.681818
AUC: 0.848485
Avg Precision: 0.406470
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.145760
valid_loss: 1.130791
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0017024311833724309
Epoch-8 lr: 0.0034048623667448617
epoch 8 training time: 12.606
---------------
2023-09-12 11:38:09.420687
current #epochs=9, #steps=64
start validation
acc: 0.659091
AUC: 0.835399
Avg Precision: 0.389019
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.161924
valid_loss: 1.135955
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0017024311833724309
Epoch-9 lr: 0.0034048623667448617
epoch 9 training time: 7.955
---------------
2023-09-12 11:38:17.375832
current #epochs=10, #steps=72
start validation
acc: 0.590909
AUC: 0.837466
Avg Precision: 0.387562
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.132010
valid_loss: 1.133894
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0011584691509880073
Epoch-10 lr: 0.0023169383019760147
epoch 10 training time: 6.336
---------------
2023-09-12 11:38:23.711600
current #epochs=11, #steps=80
start validation
acc: 0.659091
AUC: 0.844353
Avg Precision: 0.398836
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.126433
valid_loss: 1.135265
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0011584691509880073
Epoch-11 lr: 0.0023169383019760147
epoch 11 training time: 8.377
---------------
2023-09-12 11:38:32.088575
current #epochs=12, #steps=88
start validation
acc: 0.613636
AUC: 0.844353
Avg Precision: 0.406192
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.153090
valid_loss: 1.127846
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0011584691509880073
Epoch-12 lr: 0.0023169383019760147
epoch 12 training time: 6.718
---------------
2023-09-12 11:38:38.806081
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01174	Per Sample Data Time 0.00598	Per Sample DNN Time 0.00576	Train Loss 0.1526	
start validation
acc: 0.613636
AUC: 0.845730
Avg Precision: 0.407318
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.118585
valid_loss: 1.132160
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0007883142572214515
Epoch-13 lr: 0.001576628514442903
epoch 13 training time: 8.753
---------------
2023-09-12 11:38:47.559059
current #epochs=14, #steps=104
start validation
acc: 0.613636
AUC: 0.847107
Avg Precision: 0.407318
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.152659
valid_loss: 1.126746
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0007883142572214515
Epoch-14 lr: 0.001576628514442903
epoch 14 training time: 7.253
---------------
2023-09-12 11:38:54.812304
current #epochs=15, #steps=112
start validation
acc: 0.636364
AUC: 0.849174
Avg Precision: 0.405569
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.084794
valid_loss: 1.131335
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0007883142572214515
Epoch-15 lr: 0.001576628514442903
epoch 15 training time: 6.457
---------------
2023-09-12 11:39:01.269251
current #epochs=16, #steps=120
start validation
acc: 0.636364
AUC: 0.845730
Avg Precision: 0.403495
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.118412
valid_loss: 1.132739
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0005364315205187904
Epoch-16 lr: 0.0010728630410375807
epoch 16 training time: 6.375
---------------
2023-09-12 11:39:07.644947
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.847796
Avg Precision: 0.406882
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.116308
valid_loss: 1.132192
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0005364315205187904
Epoch-17 lr: 0.0010728630410375807
epoch 17 training time: 6.343
---------------
2023-09-12 11:39:13.987439
current #epochs=18, #steps=136
start validation
acc: 0.636364
AUC: 0.842975
Avg Precision: 0.403087
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.080113
valid_loss: 1.128884
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0005364315205187904
Epoch-18 lr: 0.0010728630410375807
epoch 18 training time: 6.321
---------------
2023-09-12 11:39:20.308356
current #epochs=19, #steps=144
start validation
acc: 0.636364
AUC: 0.842975
Avg Precision: 0.402734
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.109365
valid_loss: 1.127753
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00036503053645174
Epoch-19 lr: 0.00073006107290348
epoch 19 training time: 6.282
---------------
2023-09-12 11:39:26.590079
current #epochs=20, #steps=152
start validation
acc: 0.613636
AUC: 0.845730
Avg Precision: 0.411235
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.147443
valid_loss: 1.126664
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00036503053645174
Epoch-20 lr: 0.00073006107290348
epoch 20 training time: 6.295
---------------
2023-09-12 11:39:32.885078
current #epochs=21, #steps=160
start validation
acc: 0.613636
AUC: 0.845730
Avg Precision: 0.415466
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.093061
valid_loss: 1.124652
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00036503053645174
Epoch-21 lr: 0.00073006107290348
epoch 21 training time: 6.519
---------------
2023-09-12 11:39:39.404052
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.847107
Avg Precision: 0.424632
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.119314
valid_loss: 1.125050
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0002483957177113302
Epoch-22 lr: 0.0004967914354226604
epoch 22 training time: 6.594
---------------
2023-09-12 11:39:45.998097
current #epochs=23, #steps=176
start validation
acc: 0.613636
AUC: 0.847796
Avg Precision: 0.429614
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.132381
valid_loss: 1.127163
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0002483957177113302
Epoch-23 lr: 0.0004967914354226604
epoch 23 training time: 6.577
---------------
2023-09-12 11:39:52.575271
current #epochs=24, #steps=184
start validation
[I 2023-09-12 11:39:59,058] Trial 81 finished with value: 0.6818181818181818 and parameters: {'warmup': 'False', 'num_epochs': 24, 'batch_size': 20, 'lr-adaptschedule': 'False', 'lr': 0.003676543849827492, 'head-lr': 2, 'lr-scheduler-start': 4, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.680479282982316}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.613636
AUC: 0.847796
Avg Precision: 0.427303
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.169759
valid_loss: 1.128584
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0002483957177113302
Epoch-24 lr: 0.0004967914354226604
epoch 24 training time: 6.478
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8e3bd30>
The learning rate scheduler starts at 5 epoch with decay rate of 0.673 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 11:39:59.098204
current #epochs=1, #steps=0
start validation
acc: 0.636364
AUC: 0.821625
Avg Precision: 0.391890
Avg Recall: 1.000000
d_prime: 1.303307
train_loss: 0.336104
valid_loss: 1.172569
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0035400582480343535
Epoch-1 lr: 0.007080116496068707
epoch 1 training time: 8.809
---------------
2023-09-12 11:40:07.907449
current #epochs=2, #steps=8
start validation
acc: 0.613636
AUC: 0.822314
Avg Precision: 0.404456
Avg Recall: 1.000000
d_prime: 1.307044
train_loss: 0.289362
valid_loss: 1.168650
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0035400582480343535
Epoch-2 lr: 0.007080116496068707
epoch 2 training time: 6.513
---------------
2023-09-12 11:40:14.420193
current #epochs=3, #steps=16
start validation
acc: 0.659091
AUC: 0.814050
Avg Precision: 0.375448
Avg Recall: 1.000000
d_prime: 1.262777
train_loss: 0.240494
valid_loss: 1.166176
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0035400582480343535
Epoch-3 lr: 0.007080116496068707
epoch 3 training time: 10.696
---------------
2023-09-12 11:40:25.116324
current #epochs=4, #steps=24
start validation
acc: 0.681818
AUC: 0.803030
Avg Precision: 0.337381
Avg Recall: 1.000000
d_prime: 1.205610
train_loss: 0.179417
valid_loss: 1.158859
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0035400582480343535
Epoch-4 lr: 0.007080116496068707
epoch 4 training time: 9.776
---------------
2023-09-12 11:40:34.892572
current #epochs=5, #steps=32
start validation
acc: 0.636364
AUC: 0.806474
Avg Precision: 0.372886
Avg Recall: 1.000000
d_prime: 1.223260
train_loss: 0.174754
valid_loss: 1.163526
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0023813197869650394
Epoch-5 lr: 0.004762639573930079
epoch 5 training time: 6.417
---------------
2023-09-12 11:40:41.310020
current #epochs=6, #steps=40
start validation
acc: 0.636364
AUC: 0.800964
Avg Precision: 0.361744
Avg Recall: 1.000000
d_prime: 1.195110
train_loss: 0.147829
valid_loss: 1.164237
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0023813197869650394
Epoch-6 lr: 0.004762639573930079
epoch 6 training time: 6.317
---------------
2023-09-12 11:40:47.626972
current #epochs=7, #steps=48
start validation
acc: 0.613636
AUC: 0.807851
Avg Precision: 0.370753
Avg Recall: 1.000000
d_prime: 1.230373
train_loss: 0.163679
valid_loss: 1.161000
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00160186175776625
Epoch-7 lr: 0.0032037235155325
epoch 7 training time: 7.739
---------------
2023-09-12 11:40:55.366216
current #epochs=8, #steps=56
start validation
acc: 0.613636
AUC: 0.827135
Avg Precision: 0.398156
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.108551
valid_loss: 1.141881
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00160186175776625
Epoch-8 lr: 0.0032037235155325
epoch 8 training time: 6.320
---------------
2023-09-12 11:41:01.685752
current #epochs=9, #steps=64
start validation
acc: 0.636364
AUC: 0.838843
Avg Precision: 0.383825
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.166118
valid_loss: 1.128995
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0010775373828578745
Epoch-9 lr: 0.002155074765715749
epoch 9 training time: 8.466
---------------
2023-09-12 11:41:10.151364
current #epochs=10, #steps=72
start validation
acc: 0.659091
AUC: 0.836088
Avg Precision: 0.376186
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.143583
valid_loss: 1.127335
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0010775373828578745
Epoch-10 lr: 0.002155074765715749
epoch 10 training time: 6.365
---------------
2023-09-12 11:41:16.516622
current #epochs=11, #steps=80
start validation
acc: 0.613636
AUC: 0.836777
Avg Precision: 0.377495
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.113664
valid_loss: 1.123245
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0007248358391895814
Epoch-11 lr: 0.0014496716783791628
epoch 11 training time: 6.263
---------------
2023-09-12 11:41:22.780070
current #epochs=12, #steps=88
start validation
acc: 0.659091
AUC: 0.834022
Avg Precision: 0.379092
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.171010
valid_loss: 1.120668
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0007248358391895814
Epoch-12 lr: 0.0014496716783791628
epoch 12 training time: 7.701
---------------
2023-09-12 11:41:30.481581
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01209	Per Sample Data Time 0.00618	Per Sample DNN Time 0.00592	Train Loss 0.1076	
start validation
acc: 0.659091
AUC: 0.831267
Avg Precision: 0.376135
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.115370
valid_loss: 1.121385
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0004875812218971176
Epoch-13 lr: 0.0009751624437942352
epoch 13 training time: 6.472
---------------
2023-09-12 11:41:36.953416
current #epochs=14, #steps=104
start validation
acc: 0.659091
AUC: 0.834711
Avg Precision: 0.381431
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.162015
valid_loss: 1.123406
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0004875812218971176
Epoch-14 lr: 0.0009751624437942352
epoch 14 training time: 6.375
---------------
2023-09-12 11:41:43.328888
current #epochs=15, #steps=112
start validation
acc: 0.613636
AUC: 0.836088
Avg Precision: 0.384388
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.099629
valid_loss: 1.121491
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0003279852279551899
Epoch-15 lr: 0.0006559704559103798
epoch 15 training time: 6.421
---------------
2023-09-12 11:41:49.749962
current #epochs=16, #steps=120
start validation
acc: 0.636364
AUC: 0.833333
Avg Precision: 0.386344
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.149722
valid_loss: 1.121635
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0003279852279551899
Epoch-16 lr: 0.0006559704559103798
epoch 16 training time: 6.246
---------------
2023-09-12 11:41:55.995729
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.832645
Avg Precision: 0.395158
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.115174
valid_loss: 1.121338
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0002206284920864255
Epoch-17 lr: 0.000441256984172851
epoch 17 training time: 7.901
---------------
2023-09-12 11:42:03.896119
current #epochs=18, #steps=136
start validation
acc: 0.636364
AUC: 0.836777
Avg Precision: 0.397222
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.108589
valid_loss: 1.121055
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0002206284920864255
Epoch-18 lr: 0.000441256984172851
epoch 18 training time: 6.450
---------------
2023-09-12 11:42:10.346217
current #epochs=19, #steps=144
start validation
acc: 0.659091
AUC: 0.838843
Avg Precision: 0.401716
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.119105
valid_loss: 1.120862
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00014841196301371317
Epoch-19 lr: 0.00029682392602742633
epoch 19 training time: 6.328
---------------
2023-09-12 11:42:16.673716
current #epochs=20, #steps=152
start validation
acc: 0.659091
AUC: 0.840909
Avg Precision: 0.401716
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.134936
valid_loss: 1.121669
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00014841196301371317
Epoch-20 lr: 0.00029682392602742633
epoch 20 training time: 6.335
---------------
2023-09-12 11:42:23.009167
current #epochs=21, #steps=160
start validation
acc: 0.636364
AUC: 0.841598
Avg Precision: 0.401716
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.100818
valid_loss: 1.122294
validation finished
normal learning rate scheduler step
Epoch-21 lr: 9.98334827804362e-05
Epoch-21 lr: 0.0001996669655608724
epoch 21 training time: 6.491
---------------
2023-09-12 11:42:29.499955
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.842287
Avg Precision: 0.401716
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.130988
valid_loss: 1.122624
validation finished
normal learning rate scheduler step
Epoch-22 lr: 9.98334827804362e-05
Epoch-22 lr: 0.0001996669655608724
epoch 22 training time: 6.400
---------------
2023-09-12 11:42:35.899990
current #epochs=23, #steps=176
start validation
acc: 0.636364
AUC: 0.843664
Avg Precision: 0.401716
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.141331
valid_loss: 1.121984
validation finished
normal learning rate scheduler step
Epoch-23 lr: 6.715580120148893e-05
Epoch-23 lr: 0.00013431160240297786
epoch 23 training time: 6.336
---------------
2023-09-12 11:42:42.236158
current #epochs=24, #steps=184
start validation
acc: 0.636364
AUC: 0.843664
Avg Precision: 0.401716
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.112994
valid_loss: 1.121760
validation finished
normal learning rate scheduler step
Epoch-24 lr: 6.715580120148893e-05
Epoch-24 lr: 0.00013431160240297786
epoch 24 training time: 6.467
---------------
2023-09-12 11:42:48.703120
current #epochs=25, #steps=192
start validation
acc: 0.636364
AUC: 0.842975
Avg Precision: 0.401716
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.094762
valid_loss: 1.121471
validation finished
normal learning rate scheduler step
Epoch-25 lr: 4.517423923727604e-05
Epoch-25 lr: 9.034847847455208e-05
epoch 25 training time: 6.327
---------------
2023-09-12 11:42:55.030103
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03544	Per Sample Data Time 0.02989	Per Sample DNN Time 0.00556	Train Loss 0.0719	
start validation
acc: 0.636364
AUC: 0.844353
Avg Precision: 0.401716
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.139555
valid_loss: 1.121117
validation finished
normal learning rate scheduler step
Epoch-26 lr: 4.517423923727604e-05
Epoch-26 lr: 9.034847847455208e-05
epoch 26 training time: 7.879
---------------
2023-09-12 11:43:02.909064
current #epochs=27, #steps=208
start validation
acc: 0.659091
AUC: 0.844353
Avg Precision: 0.401716
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.102900
valid_loss: 1.120567
validation finished
normal learning rate scheduler step
Epoch-27 lr: 3.0387723088045067e-05
Epoch-27 lr: 6.0775446176090133e-05
epoch 27 training time: 6.303
---------------
2023-09-12 11:43:09.212762
current #epochs=28, #steps=216
start validation
acc: 0.659091
AUC: 0.843664
Avg Precision: 0.401716
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.131205
valid_loss: 1.120273
validation finished
normal learning rate scheduler step
Epoch-28 lr: 3.0387723088045067e-05
Epoch-28 lr: 6.0775446176090133e-05
epoch 28 training time: 7.113
---------------
2023-09-12 11:43:16.325744
current #epochs=29, #steps=224
start validation
[I 2023-09-12 11:43:22,663] Trial 82 finished with value: 0.6818181818181818 and parameters: {'warmup': 'False', 'num_epochs': 29, 'batch_size': 18, 'lr-adaptschedule': 'False', 'lr': 0.0035400582480343535, 'head-lr': 2, 'lr-scheduler-start': 5, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.672678136945144}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.659091
AUC: 0.843664
Avg Precision: 0.401716
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.080286
valid_loss: 1.120144
validation finished
normal learning rate scheduler step
Epoch-29 lr: 2.0441156952871093e-05
Epoch-29 lr: 4.0882313905742185e-05
epoch 29 training time: 6.332
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f957c101fd0>
The learning rate scheduler starts at 4 epoch with decay rate of 0.661 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 11:43:22.702226
current #epochs=1, #steps=0
start validation
acc: 0.613636
AUC: 0.851928
Avg Precision: 0.415600
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.275681
valid_loss: 1.122603
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0033512819355903394
Epoch-1 lr: 0.006702563871180679
epoch 1 training time: 11.137
---------------
2023-09-12 11:43:33.839151
current #epochs=2, #steps=8
start validation
acc: 0.590909
AUC: 0.845041
Avg Precision: 0.432030
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.253180
valid_loss: 1.151525
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0033512819355903394
Epoch-2 lr: 0.006702563871180679
epoch 2 training time: 7.459
---------------
2023-09-12 11:43:41.298003
current #epochs=3, #steps=16
start validation
acc: 0.636364
AUC: 0.852617
Avg Precision: 0.431283
Avg Recall: 1.000000
d_prime: 1.481705
train_loss: 0.209476
valid_loss: 1.141510
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0033512819355903394
Epoch-3 lr: 0.006702563871180679
epoch 3 training time: 9.096
---------------
2023-09-12 11:43:50.393323
current #epochs=4, #steps=24
start validation
acc: 0.613636
AUC: 0.842287
Avg Precision: 0.418062
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.119736
valid_loss: 1.123387
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002216788631636397
Epoch-4 lr: 0.004433577263272794
epoch 4 training time: 6.394
---------------
2023-09-12 11:43:56.787172
current #epochs=5, #steps=32
start validation
acc: 0.636364
AUC: 0.845730
Avg Precision: 0.415351
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.136284
valid_loss: 1.120289
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002216788631636397
Epoch-5 lr: 0.004433577263272794
epoch 5 training time: 6.401
---------------
2023-09-12 11:44:03.187742
current #epochs=6, #steps=40
start validation
acc: 0.613636
AUC: 0.858127
Avg Precision: 0.453194
Avg Recall: 1.000000
d_prime: 1.515953
train_loss: 0.093056
valid_loss: 1.119074
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002216788631636397
Epoch-6 lr: 0.004433577263272794
epoch 6 training time: 6.384
---------------
2023-09-12 11:44:09.571583
current #epochs=7, #steps=48
start validation
acc: 0.613636
AUC: 0.825758
Avg Precision: 0.377576
Avg Recall: 1.000000
d_prime: 1.325871
train_loss: 0.126417
valid_loss: 1.147094
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0014663498720189673
Epoch-7 lr: 0.0029326997440379345
epoch 7 training time: 6.926
---------------
2023-09-12 11:44:16.497834
current #epochs=8, #steps=56
start validation
acc: 0.590909
AUC: 0.818871
Avg Precision: 0.378791
Avg Recall: 1.000000
d_prime: 1.288446
train_loss: 0.154222
valid_loss: 1.154359
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0014663498720189673
Epoch-8 lr: 0.0029326997440379345
epoch 8 training time: 6.291
---------------
2023-09-12 11:44:22.788977
current #epochs=9, #steps=64
start validation
acc: 0.590909
AUC: 0.823003
Avg Precision: 0.386121
Avg Recall: 1.000000
d_prime: 1.310791
train_loss: 0.109091
valid_loss: 1.152247
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0014663498720189673
Epoch-9 lr: 0.0029326997440379345
epoch 9 training time: 7.153
---------------
2023-09-12 11:44:29.941654
current #epochs=10, #steps=72
start validation
acc: 0.590909
AUC: 0.818871
Avg Precision: 0.372592
Avg Recall: 1.000000
d_prime: 1.288446
train_loss: 0.132743
valid_loss: 1.146711
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0009699535248801832
Epoch-10 lr: 0.0019399070497603664
epoch 10 training time: 6.361
---------------
2023-09-12 11:44:36.303257
current #epochs=11, #steps=80
start validation
acc: 0.613636
AUC: 0.809917
Avg Precision: 0.368132
Avg Recall: 1.000000
d_prime: 1.241102
train_loss: 0.108046
valid_loss: 1.153026
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0009699535248801832
Epoch-11 lr: 0.0019399070497603664
epoch 11 training time: 7.450
---------------
2023-09-12 11:44:43.753505
current #epochs=12, #steps=88
start validation
acc: 0.636364
AUC: 0.810606
Avg Precision: 0.368973
Avg Recall: 1.000000
d_prime: 1.244694
train_loss: 0.191219
valid_loss: 1.156889
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0009699535248801832
Epoch-12 lr: 0.0019399070497603664
epoch 12 training time: 6.458
---------------
2023-09-12 11:44:50.211442
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01153	Per Sample Data Time 0.00576	Per Sample DNN Time 0.00577	Train Loss 0.1513	
start validation
acc: 0.590909
AUC: 0.811983
Avg Precision: 0.364177
Avg Recall: 1.000000
d_prime: 1.251903
train_loss: 0.136774
valid_loss: 1.157799
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0006415998380605599
Epoch-13 lr: 0.0012831996761211199
epoch 13 training time: 7.711
---------------
2023-09-12 11:44:57.922411
current #epochs=14, #steps=104
start validation
acc: 0.613636
AUC: 0.810606
Avg Precision: 0.350412
Avg Recall: 1.000000
d_prime: 1.244694
train_loss: 0.078901
valid_loss: 1.154076
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0006415998380605599
Epoch-14 lr: 0.0012831996761211199
epoch 14 training time: 6.498
---------------
2023-09-12 11:45:04.420740
current #epochs=15, #steps=112
start validation
acc: 0.613636
AUC: 0.811983
Avg Precision: 0.350412
Avg Recall: 1.000000
d_prime: 1.251903
train_loss: 0.086008
valid_loss: 1.151785
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0006415998380605599
Epoch-15 lr: 0.0012831996761211199
epoch 15 training time: 6.492
---------------
2023-09-12 11:45:10.912701
current #epochs=16, #steps=120
start validation
acc: 0.590909
AUC: 0.816116
Avg Precision: 0.364284
Avg Recall: 1.000000
d_prime: 1.273727
train_loss: 0.093564
valid_loss: 1.150075
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.00042440214055636043
Epoch-16 lr: 0.0008488042811127209
epoch 16 training time: 6.428
---------------
2023-09-12 11:45:17.340852
current #epochs=17, #steps=128
start validation
acc: 0.590909
AUC: 0.818182
Avg Precision: 0.360996
Avg Recall: 1.000000
d_prime: 1.284753
train_loss: 0.132048
valid_loss: 1.146967
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.00042440214055636043
Epoch-17 lr: 0.0008488042811127209
epoch 17 training time: 6.378
---------------
2023-09-12 11:45:23.718617
current #epochs=18, #steps=136
start validation
acc: 0.613636
AUC: 0.818871
Avg Precision: 0.356771
Avg Recall: 1.000000
d_prime: 1.288446
train_loss: 0.110203
valid_loss: 1.144720
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00042440214055636043
Epoch-18 lr: 0.0008488042811127209
epoch 18 training time: 8.002
---------------
2023-09-12 11:45:31.720817
current #epochs=19, #steps=144
start validation
acc: 0.636364
AUC: 0.827135
Avg Precision: 0.356771
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.061053
valid_loss: 1.139073
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0002807313316245252
Epoch-19 lr: 0.0005614626632490504
epoch 19 training time: 6.409
---------------
2023-09-12 11:45:38.130416
current #epochs=20, #steps=152
start validation
acc: 0.636364
AUC: 0.829890
Avg Precision: 0.362723
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.102947
valid_loss: 1.138030
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0002807313316245252
Epoch-20 lr: 0.0005614626632490504
epoch 20 training time: 6.499
---------------
2023-09-12 11:45:44.629792
current #epochs=21, #steps=160
start validation
acc: 0.613636
AUC: 0.829890
Avg Precision: 0.356771
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.121595
valid_loss: 1.136317
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0002807313316245252
Epoch-21 lr: 0.0005614626632490504
epoch 21 training time: 7.013
---------------
2023-09-12 11:45:51.642518
current #epochs=22, #steps=168
start validation
acc: 0.613636
AUC: 0.831956
Avg Precision: 0.366949
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.097080
valid_loss: 1.135402
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00018569670843875772
Epoch-22 lr: 0.00037139341687751544
epoch 22 training time: 6.414
---------------
2023-09-12 11:45:58.056320
current #epochs=23, #steps=176
start validation
acc: 0.613636
AUC: 0.831267
Avg Precision: 0.360996
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.090656
valid_loss: 1.134322
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00018569670843875772
Epoch-23 lr: 0.00037139341687751544
epoch 23 training time: 6.338
---------------
2023-09-12 11:46:04.394433
current #epochs=24, #steps=184
start validation
acc: 0.613636
AUC: 0.829890
Avg Precision: 0.361503
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.096504
valid_loss: 1.132510
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00018569670843875772
Epoch-24 lr: 0.00037139341687751544
epoch 24 training time: 7.638
---------------
2023-09-12 11:46:12.032709
current #epochs=25, #steps=192
start validation
acc: 0.613636
AUC: 0.831267
Avg Precision: 0.363025
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.093291
valid_loss: 1.131184
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00012283369770464363
Epoch-25 lr: 0.00024566739540928727
epoch 25 training time: 6.402
---------------
2023-09-12 11:46:18.435129
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03619	Per Sample Data Time 0.03072	Per Sample DNN Time 0.00547	Train Loss 0.0479	
start validation
acc: 0.613636
AUC: 0.831956
Avg Precision: 0.366186
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.095191
valid_loss: 1.130216
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00012283369770464363
Epoch-26 lr: 0.00024566739540928727
epoch 26 training time: 6.495
---------------
2023-09-12 11:46:24.930075
current #epochs=27, #steps=208
start validation
acc: 0.636364
AUC: 0.835399
Avg Precision: 0.373735
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.079289
valid_loss: 1.129336
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00012283369770464363
Epoch-27 lr: 0.00024566739540928727
epoch 27 training time: 7.456
---------------
2023-09-12 11:46:32.386154
current #epochs=28, #steps=216
start validation
acc: 0.636364
AUC: 0.834022
Avg Precision: 0.373735
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.102904
valid_loss: 1.128881
validation finished
normal learning rate scheduler step
Epoch-28 lr: 8.125139868470957e-05
Epoch-28 lr: 0.00016250279736941913
epoch 28 training time: 6.545
---------------
2023-09-12 11:46:38.931245
current #epochs=29, #steps=224
start validation
acc: 0.636364
AUC: 0.835399
Avg Precision: 0.377122
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.096457
valid_loss: 1.128363
validation finished
normal learning rate scheduler step
Epoch-29 lr: 8.125139868470957e-05
Epoch-29 lr: 0.00016250279736941913
epoch 29 training time: 6.495
---------------
2023-09-12 11:46:45.426539
current #epochs=30, #steps=232
start validation
acc: 0.636364
AUC: 0.836088
Avg Precision: 0.380760
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.112266
valid_loss: 1.128036
validation finished
normal learning rate scheduler step
Epoch-30 lr: 8.125139868470957e-05
Epoch-30 lr: 0.00016250279736941913
epoch 30 training time: 6.406
---------------
2023-09-12 11:46:51.832686
current #epochs=31, #steps=240
start validation
[I 2023-09-12 11:46:58,311] Trial 83 finished with value: 0.6363636363636364 and parameters: {'warmup': 'False', 'num_epochs': 31, 'batch_size': 12, 'lr-adaptschedule': 'False', 'lr': 0.0033512819355903394, 'head-lr': 2, 'lr-scheduler-start': 4, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.6614748249302107}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.636364
AUC: 0.836088
Avg Precision: 0.380760
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.112021
valid_loss: 1.127889
validation finished
normal learning rate scheduler step
Epoch-31 lr: 5.374575472030301e-05
Epoch-31 lr: 0.00010749150944060602
epoch 31 training time: 6.473
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8dd55b0>
The learning rate scheduler starts at 5 epoch with decay rate of 0.715 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 11:46:58.352044
current #epochs=1, #steps=0
start validation
acc: 0.613636
AUC: 0.862948
Avg Precision: 0.413245
Avg Recall: 1.000000
d_prime: 1.546667
train_loss: 0.261615
valid_loss: 1.116963
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0038596537829075623
Epoch-1 lr: 0.0038596537829075623
epoch 1 training time: 9.055
---------------
2023-09-12 11:47:07.407277
current #epochs=2, #steps=8
start validation
acc: 0.681818
AUC: 0.849862
Avg Precision: 0.366842
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.276269
valid_loss: 1.117229
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0038596537829075623
Epoch-2 lr: 0.0038596537829075623
epoch 2 training time: 9.959
---------------
2023-09-12 11:47:17.365938
current #epochs=3, #steps=16
start validation
acc: 0.613636
AUC: 0.831956
Avg Precision: 0.388935
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.216466
valid_loss: 1.136197
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0038596537829075623
Epoch-3 lr: 0.0038596537829075623
epoch 3 training time: 7.396
---------------
2023-09-12 11:47:24.762109
current #epochs=4, #steps=24
start validation
acc: 0.636364
AUC: 0.854683
Avg Precision: 0.444505
Avg Recall: 1.000000
d_prime: 1.494446
train_loss: 0.186386
valid_loss: 1.121062
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0038596537829075623
Epoch-4 lr: 0.0038596537829075623
epoch 4 training time: 7.384
---------------
2023-09-12 11:47:32.145143
current #epochs=5, #steps=32
start validation
acc: 0.659091
AUC: 0.851928
Avg Precision: 0.448994
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.182905
valid_loss: 1.132550
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002758457313766705
Epoch-5 lr: 0.002758457313766705
epoch 5 training time: 6.292
---------------
2023-09-12 11:47:38.437491
current #epochs=6, #steps=40
start validation
acc: 0.659091
AUC: 0.827824
Avg Precision: 0.381954
Avg Recall: 1.000000
d_prime: 1.337280
train_loss: 0.128049
valid_loss: 1.140406
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002758457313766705
Epoch-6 lr: 0.002758457313766705
epoch 6 training time: 6.482
---------------
2023-09-12 11:47:44.919434
current #epochs=7, #steps=48
start validation
acc: 0.636364
AUC: 0.813361
Avg Precision: 0.406771
Avg Recall: 1.000000
d_prime: 1.259144
train_loss: 0.172607
valid_loss: 1.159253
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002758457313766705
Epoch-7 lr: 0.002758457313766705
epoch 7 training time: 6.358
---------------
2023-09-12 11:47:51.277462
current #epochs=8, #steps=56
start validation
acc: 0.636364
AUC: 0.814050
Avg Precision: 0.393769
Avg Recall: 1.000000
d_prime: 1.262777
train_loss: 0.103524
valid_loss: 1.164331
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001971442823594642
Epoch-8 lr: 0.001971442823594642
epoch 8 training time: 7.800
---------------
2023-09-12 11:47:59.077086
current #epochs=9, #steps=64
start validation
acc: 0.636364
AUC: 0.818871
Avg Precision: 0.390289
Avg Recall: 1.000000
d_prime: 1.288446
train_loss: 0.106513
valid_loss: 1.159097
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001971442823594642
Epoch-9 lr: 0.001971442823594642
epoch 9 training time: 6.249
---------------
2023-09-12 11:48:05.326238
current #epochs=10, #steps=72
start validation
acc: 0.613636
AUC: 0.810606
Avg Precision: 0.378846
Avg Recall: 1.000000
d_prime: 1.244694
train_loss: 0.150380
valid_loss: 1.167419
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001971442823594642
Epoch-10 lr: 0.001971442823594642
epoch 10 training time: 6.372
---------------
2023-09-12 11:48:11.698070
current #epochs=11, #steps=80
start validation
acc: 0.659091
AUC: 0.823691
Avg Precision: 0.405952
Avg Recall: 1.000000
d_prime: 1.314547
train_loss: 0.138431
valid_loss: 1.156372
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0014089711619991088
Epoch-11 lr: 0.0014089711619991088
epoch 11 training time: 6.719
---------------
2023-09-12 11:48:18.417153
current #epochs=12, #steps=88
start validation
acc: 0.613636
AUC: 0.831956
Avg Precision: 0.448829
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.165333
valid_loss: 1.145736
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0014089711619991088
Epoch-12 lr: 0.0014089711619991088
epoch 12 training time: 6.476
---------------
2023-09-12 11:48:24.893228
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01159	Per Sample Data Time 0.00585	Per Sample DNN Time 0.00575	Train Loss 0.0902	
start validation
acc: 0.590909
AUC: 0.833333
Avg Precision: 0.448829
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.101959
valid_loss: 1.145005
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0014089711619991088
Epoch-13 lr: 0.0014089711619991088
epoch 13 training time: 7.482
---------------
2023-09-12 11:48:32.374893
current #epochs=14, #steps=104
start validation
acc: 0.590909
AUC: 0.828512
Avg Precision: 0.391771
Avg Recall: 1.000000
d_prime: 1.341103
train_loss: 0.119441
valid_loss: 1.149124
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0010069780931944012
Epoch-14 lr: 0.0010069780931944012
epoch 14 training time: 6.387
---------------
2023-09-12 11:48:38.762304
current #epochs=15, #steps=112
start validation
acc: 0.590909
AUC: 0.824380
Avg Precision: 0.381563
Avg Recall: 1.000000
d_prime: 1.318312
train_loss: 0.139411
valid_loss: 1.146473
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0010069780931944012
Epoch-15 lr: 0.0010069780931944012
epoch 15 training time: 8.806
---------------
2023-09-12 11:48:47.568316
current #epochs=16, #steps=120
start validation
acc: 0.590909
AUC: 0.818871
Avg Precision: 0.381993
Avg Recall: 1.000000
d_prime: 1.288446
train_loss: 0.100856
valid_loss: 1.146354
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0010069780931944012
Epoch-16 lr: 0.0010069780931944012
epoch 16 training time: 8.096
---------------
2023-09-12 11:48:55.663858
current #epochs=17, #steps=128
start validation
acc: 0.590909
AUC: 0.824380
Avg Precision: 0.383353
Avg Recall: 1.000000
d_prime: 1.318312
train_loss: 0.096858
valid_loss: 1.140834
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.000719677526071377
Epoch-17 lr: 0.000719677526071377
epoch 17 training time: 6.425
---------------
2023-09-12 11:49:02.088792
current #epochs=18, #steps=136
start validation
acc: 0.613636
AUC: 0.825758
Avg Precision: 0.387959
Avg Recall: 1.000000
d_prime: 1.325871
train_loss: 0.064067
valid_loss: 1.141294
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.000719677526071377
Epoch-18 lr: 0.000719677526071377
epoch 18 training time: 6.284
---------------
2023-09-12 11:49:08.372856
current #epochs=19, #steps=144
start validation
acc: 0.636364
AUC: 0.830579
Avg Precision: 0.394507
Avg Recall: 1.000000
d_prime: 1.352630
train_loss: 0.134373
valid_loss: 1.134568
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.000719677526071377
Epoch-19 lr: 0.000719677526071377
epoch 19 training time: 6.499
---------------
2023-09-12 11:49:14.871555
current #epochs=20, #steps=152
start validation
acc: 0.636364
AUC: 0.831956
Avg Precision: 0.392744
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.097973
valid_loss: 1.133384
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0005143465831408391
Epoch-20 lr: 0.0005143465831408391
epoch 20 training time: 6.968
---------------
2023-09-12 11:49:21.840142
current #epochs=21, #steps=160
start validation
acc: 0.636364
AUC: 0.831956
Avg Precision: 0.388389
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.116675
valid_loss: 1.129849
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0005143465831408391
Epoch-21 lr: 0.0005143465831408391
epoch 21 training time: 7.857
---------------
2023-09-12 11:49:29.696913
current #epochs=22, #steps=168
start validation
acc: 0.659091
AUC: 0.833333
Avg Precision: 0.388389
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.139464
valid_loss: 1.128815
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0005143465831408391
Epoch-22 lr: 0.0005143465831408391
epoch 22 training time: 6.403
---------------
2023-09-12 11:49:36.100057
current #epochs=23, #steps=176
start validation
acc: 0.659091
AUC: 0.840909
Avg Precision: 0.403814
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.106241
valid_loss: 1.130718
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00036759853963039827
Epoch-23 lr: 0.00036759853963039827
epoch 23 training time: 7.310
---------------
2023-09-12 11:49:43.409676
current #epochs=24, #steps=184
start validation
acc: 0.636364
AUC: 0.849174
Avg Precision: 0.413318
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.091036
valid_loss: 1.128992
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00036759853963039827
Epoch-24 lr: 0.00036759853963039827
epoch 24 training time: 6.305
---------------
2023-09-12 11:49:49.714144
current #epochs=25, #steps=192
start validation
acc: 0.636364
AUC: 0.851928
Avg Precision: 0.427354
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.124307
valid_loss: 1.127579
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00036759853963039827
Epoch-25 lr: 0.00036759853963039827
epoch 25 training time: 6.510
---------------
2023-09-12 11:49:56.224884
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03604	Per Sample Data Time 0.03055	Per Sample DNN Time 0.00549	Train Loss 0.0988	
start validation
acc: 0.636364
AUC: 0.849862
Avg Precision: 0.429875
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.080738
valid_loss: 1.131195
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.000262719129022386
Epoch-26 lr: 0.000262719129022386
epoch 26 training time: 6.320
---------------
2023-09-12 11:50:02.545181
current #epochs=27, #steps=208
start validation
acc: 0.590909
AUC: 0.850551
Avg Precision: 0.438167
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.104997
valid_loss: 1.134931
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.000262719129022386
Epoch-27 lr: 0.000262719129022386
epoch 27 training time: 6.344
---------------
2023-09-12 11:50:08.889261
current #epochs=28, #steps=216
start validation
acc: 0.590909
AUC: 0.849174
Avg Precision: 0.428411
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.121611
valid_loss: 1.134464
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.000262719129022386
Epoch-28 lr: 0.000262719129022386
epoch 28 training time: 7.181
---------------
2023-09-12 11:50:16.070728
current #epochs=29, #steps=224
start validation
acc: 0.613636
AUC: 0.845041
Avg Precision: 0.409803
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.102998
valid_loss: 1.123348
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00018776282632591132
Epoch-29 lr: 0.00018776282632591132
epoch 29 training time: 6.397
---------------
2023-09-12 11:50:22.467475
current #epochs=30, #steps=232
start validation
acc: 0.613636
AUC: 0.842975
Avg Precision: 0.406986
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.127414
valid_loss: 1.121360
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00018776282632591132
Epoch-30 lr: 0.00018776282632591132
epoch 30 training time: 7.748
---------------
2023-09-12 11:50:30.215629
current #epochs=31, #steps=240
start validation
acc: 0.636364
AUC: 0.842975
Avg Precision: 0.405131
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.103771
valid_loss: 1.120956
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.00018776282632591132
Epoch-31 lr: 0.00018776282632591132
epoch 31 training time: 6.352
---------------
2023-09-12 11:50:36.567636
current #epochs=32, #steps=248
start validation
acc: 0.636364
AUC: 0.842975
Avg Precision: 0.406986
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.121337
valid_loss: 1.121874
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00013419228010188138
Epoch-32 lr: 0.00013419228010188138
epoch 32 training time: 6.266
---------------
2023-09-12 11:50:42.833717
current #epochs=33, #steps=256
start validation
acc: 0.636364
AUC: 0.843664
Avg Precision: 0.408942
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.083761
valid_loss: 1.123052
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.00013419228010188138
Epoch-33 lr: 0.00013419228010188138
epoch 33 training time: 6.247
---------------
2023-09-12 11:50:49.080743
current #epochs=34, #steps=264
start validation
acc: 0.636364
AUC: 0.843664
Avg Precision: 0.405555
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.112462
valid_loss: 1.124251
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.00013419228010188138
Epoch-34 lr: 0.00013419228010188138
epoch 34 training time: 6.421
---------------
2023-09-12 11:50:55.502359
current #epochs=35, #steps=272
start validation
acc: 0.636364
AUC: 0.842287
Avg Precision: 0.409803
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.106129
valid_loss: 1.126270
validation finished
normal learning rate scheduler step
Epoch-35 lr: 9.590592766048888e-05
Epoch-35 lr: 9.590592766048888e-05
epoch 35 training time: 6.328
---------------
2023-09-12 11:51:01.829651
current #epochs=36, #steps=280
start validation
acc: 0.636364
AUC: 0.842975
Avg Precision: 0.411607
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.085190
valid_loss: 1.126962
validation finished
normal learning rate scheduler step
Epoch-36 lr: 9.590592766048888e-05
Epoch-36 lr: 9.590592766048888e-05
epoch 36 training time: 6.259
---------------
2023-09-12 11:51:08.088895
current #epochs=37, #steps=288
start validation
acc: 0.636364
AUC: 0.844353
Avg Precision: 0.416984
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.136361
valid_loss: 1.127383
validation finished
normal learning rate scheduler step
Epoch-37 lr: 9.590592766048888e-05
Epoch-37 lr: 9.590592766048888e-05
epoch 37 training time: 6.439
---------------
2023-09-12 11:51:14.527973
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01213	Per Sample Data Time 0.00607	Per Sample DNN Time 0.00606	Train Loss 0.1649	
start validation
[I 2023-09-12 11:51:21,042] Trial 84 finished with value: 0.6818181818181818 and parameters: {'warmup': 'False', 'num_epochs': 38, 'batch_size': 44, 'lr-adaptschedule': 'False', 'lr': 0.0038596537829075623, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.7146903502025247}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.636364
AUC: 0.845730
Avg Precision: 0.419941
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.131307
valid_loss: 1.127378
validation finished
normal learning rate scheduler step
Epoch-38 lr: 6.85430410261728e-05
Epoch-38 lr: 6.85430410261728e-05
epoch 38 training time: 6.509
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95bc7a78e0>
The learning rate scheduler starts at 5 epoch with decay rate of 0.691 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 11:51:21.081461
current #epochs=1, #steps=0
start validation
acc: 0.590909
AUC: 0.821625
Avg Precision: 0.392549
Avg Recall: 1.000000
d_prime: 1.303307
train_loss: 0.191243
valid_loss: 1.151289
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0029871198355702158
Epoch-1 lr: 0.0029871198355702158
epoch 1 training time: 8.806
---------------
2023-09-12 11:51:29.887502
current #epochs=2, #steps=8
start validation
acc: 0.613636
AUC: 0.860882
Avg Precision: 0.464686
Avg Recall: 1.000000
d_prime: 1.533415
train_loss: 0.185389
valid_loss: 1.115538
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0029871198355702158
Epoch-2 lr: 0.0029871198355702158
epoch 2 training time: 8.884
---------------
2023-09-12 11:51:38.771577
current #epochs=3, #steps=16
start validation
acc: 0.659091
AUC: 0.846419
Avg Precision: 0.403814
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.158206
valid_loss: 1.119551
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0029871198355702158
Epoch-3 lr: 0.0029871198355702158
epoch 3 training time: 8.974
---------------
2023-09-12 11:51:47.746081
current #epochs=4, #steps=24
start validation
acc: 0.613636
AUC: 0.836777
Avg Precision: 0.426576
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.201746
valid_loss: 1.121349
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0029871198355702158
Epoch-4 lr: 0.0029871198355702158
epoch 4 training time: 7.728
---------------
2023-09-12 11:51:55.474146
current #epochs=5, #steps=32
start validation
acc: 0.613636
AUC: 0.839532
Avg Precision: 0.438825
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.158994
valid_loss: 1.125997
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0020639235437806564
Epoch-5 lr: 0.0020639235437806564
epoch 5 training time: 6.458
---------------
2023-09-12 11:52:01.932317
current #epochs=6, #steps=40
start validation
acc: 0.568182
AUC: 0.833333
Avg Precision: 0.445910
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.117470
valid_loss: 1.128658
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0020639235437806564
Epoch-6 lr: 0.0020639235437806564
epoch 6 training time: 6.973
---------------
2023-09-12 11:52:08.904904
current #epochs=7, #steps=48
start validation
acc: 0.568182
AUC: 0.829890
Avg Precision: 0.423327
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.166592
valid_loss: 1.133066
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0020639235437806564
Epoch-7 lr: 0.0020639235437806564
epoch 7 training time: 6.317
---------------
2023-09-12 11:52:15.222373
current #epochs=8, #steps=56
start validation
acc: 0.568182
AUC: 0.818182
Avg Precision: 0.426830
Avg Recall: 1.000000
d_prime: 1.284753
train_loss: 0.102554
valid_loss: 1.146076
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0020639235437806564
Epoch-8 lr: 0.0020639235437806564
epoch 8 training time: 6.203
---------------
2023-09-12 11:52:21.426149
current #epochs=9, #steps=64
start validation
acc: 0.613636
AUC: 0.820937
Avg Precision: 0.435030
Avg Recall: 1.000000
d_prime: 1.299578
train_loss: 0.146994
valid_loss: 1.136333
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0020639235437806564
Epoch-9 lr: 0.0020639235437806564
epoch 9 training time: 9.346
---------------
2023-09-12 11:52:30.772142
current #epochs=10, #steps=72
start validation
acc: 0.590909
AUC: 0.807163
Avg Precision: 0.359543
Avg Recall: 1.000000
d_prime: 1.226813
train_loss: 0.122416
valid_loss: 1.149888
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0014260493816977875
Epoch-10 lr: 0.0014260493816977875
epoch 10 training time: 6.310
---------------
2023-09-12 11:52:37.082313
current #epochs=11, #steps=80
start validation
acc: 0.590909
AUC: 0.808540
Avg Precision: 0.379786
Avg Recall: 1.000000
d_prime: 1.233942
train_loss: 0.134015
valid_loss: 1.149678
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0014260493816977875
Epoch-11 lr: 0.0014260493816977875
epoch 11 training time: 7.168
---------------
2023-09-12 11:52:44.249836
current #epochs=12, #steps=88
start validation
acc: 0.636364
AUC: 0.821625
Avg Precision: 0.405030
Avg Recall: 1.000000
d_prime: 1.303307
train_loss: 0.142041
valid_loss: 1.132453
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0014260493816977875
Epoch-12 lr: 0.0014260493816977875
epoch 12 training time: 7.805
---------------
2023-09-12 11:52:52.054548
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01212	Per Sample Data Time 0.00636	Per Sample DNN Time 0.00576	Train Loss 0.0987	
start validation
acc: 0.659091
AUC: 0.818182
Avg Precision: 0.394335
Avg Recall: 1.000000
d_prime: 1.284753
train_loss: 0.112488
valid_loss: 1.136851
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0014260493816977875
Epoch-13 lr: 0.0014260493816977875
epoch 13 training time: 6.401
---------------
2023-09-12 11:52:58.455273
current #epochs=14, #steps=104
start validation
acc: 0.613636
AUC: 0.823003
Avg Precision: 0.392854
Avg Recall: 1.000000
d_prime: 1.310791
train_loss: 0.075359
valid_loss: 1.129522
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0014260493816977875
Epoch-14 lr: 0.0014260493816977875
epoch 14 training time: 6.341
---------------
2023-09-12 11:53:04.796396
current #epochs=15, #steps=112
start validation
acc: 0.636364
AUC: 0.822314
Avg Precision: 0.382177
Avg Recall: 1.000000
d_prime: 1.307044
train_loss: 0.166491
valid_loss: 1.129492
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0009853159750847654
Epoch-15 lr: 0.0009853159750847654
epoch 15 training time: 6.278
---------------
2023-09-12 11:53:11.074915
current #epochs=16, #steps=120
start validation
acc: 0.590909
AUC: 0.826446
Avg Precision: 0.392186
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.136973
valid_loss: 1.130911
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0009853159750847654
Epoch-16 lr: 0.0009853159750847654
epoch 16 training time: 6.311
---------------
2023-09-12 11:53:17.386207
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.824380
Avg Precision: 0.398947
Avg Recall: 1.000000
d_prime: 1.318312
train_loss: 0.101459
valid_loss: 1.136037
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0009853159750847654
Epoch-17 lr: 0.0009853159750847654
epoch 17 training time: 6.726
---------------
2023-09-12 11:53:24.112433
current #epochs=18, #steps=136
start validation
acc: 0.613636
AUC: 0.825069
Avg Precision: 0.393403
Avg Recall: 1.000000
d_prime: 1.322087
train_loss: 0.103762
valid_loss: 1.135940
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0009853159750847654
Epoch-18 lr: 0.0009853159750847654
epoch 18 training time: 6.318
---------------
2023-09-12 11:53:30.430091
current #epochs=19, #steps=144
start validation
acc: 0.613636
AUC: 0.814738
Avg Precision: 0.380307
Avg Recall: 1.000000
d_prime: 1.266419
train_loss: 0.136885
valid_loss: 1.135926
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0009853159750847654
Epoch-19 lr: 0.0009853159750847654
epoch 19 training time: 8.188
---------------
2023-09-12 11:53:38.618059
current #epochs=20, #steps=152
start validation
acc: 0.636364
AUC: 0.809917
Avg Precision: 0.367485
Avg Recall: 1.000000
d_prime: 1.241102
train_loss: 0.140913
valid_loss: 1.135522
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0006807951977100516
Epoch-20 lr: 0.0006807951977100516
epoch 20 training time: 6.337
---------------
2023-09-12 11:53:44.954688
current #epochs=21, #steps=160
start validation
acc: 0.636364
AUC: 0.803719
Avg Precision: 0.366820
Avg Recall: 1.000000
d_prime: 1.209125
train_loss: 0.104600
valid_loss: 1.132882
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0006807951977100516
Epoch-21 lr: 0.0006807951977100516
epoch 21 training time: 6.416
---------------
2023-09-12 11:53:51.370890
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.816116
Avg Precision: 0.379112
Avg Recall: 1.000000
d_prime: 1.273727
train_loss: 0.114115
valid_loss: 1.125614
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0006807951977100516
Epoch-22 lr: 0.0006807951977100516
epoch 22 training time: 6.468
---------------
2023-09-12 11:53:57.838812
current #epochs=23, #steps=176
start validation
acc: 0.613636
AUC: 0.829890
Avg Precision: 0.396308
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.125975
valid_loss: 1.118863
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0006807951977100516
Epoch-23 lr: 0.0006807951977100516
epoch 23 training time: 6.344
---------------
2023-09-12 11:54:04.183322
current #epochs=24, #steps=184
start validation
acc: 0.659091
AUC: 0.844353
Avg Precision: 0.409394
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.130682
valid_loss: 1.110115
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0006807951977100516
Epoch-24 lr: 0.0006807951977100516
epoch 24 training time: 6.295
---------------
2023-09-12 11:54:10.478790
current #epochs=25, #steps=192
start validation
acc: 0.613636
AUC: 0.842975
Avg Precision: 0.401888
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.081203
valid_loss: 1.108991
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0004703893095666042
Epoch-25 lr: 0.0004703893095666042
epoch 25 training time: 6.185
---------------
2023-09-12 11:54:16.663873
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03548	Per Sample Data Time 0.02999	Per Sample DNN Time 0.00549	Train Loss 0.1001	
start validation
[I 2023-09-12 11:54:23,033] Trial 85 finished with value: 0.6590909090909091 and parameters: {'warmup': 'False', 'num_epochs': 26, 'batch_size': 14, 'lr-adaptschedule': 'False', 'lr': 0.0029871198355702158, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.6909409924582657}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.613636
AUC: 0.845041
Avg Precision: 0.401888
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.116185
valid_loss: 1.108438
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0004703893095666042
Epoch-26 lr: 0.0004703893095666042
epoch 26 training time: 6.363
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f957c110430>
The learning rate scheduler starts at 4 epoch with decay rate of 0.641 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 11:54:23.073045
current #epochs=1, #steps=0
start validation
acc: 0.659091
AUC: 0.842975
Avg Precision: 0.440399
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.143738
valid_loss: 1.110048
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003991579217025469
Epoch-1 lr: 0.003991579217025469
epoch 1 training time: 8.695
---------------
2023-09-12 11:54:31.768348
current #epochs=2, #steps=8
start validation
acc: 0.568182
AUC: 0.774793
Avg Precision: 0.348376
Avg Recall: 1.000000
d_prime: 1.067344
train_loss: 0.259674
valid_loss: 1.202496
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003991579217025469
Epoch-2 lr: 0.003991579217025469
epoch 2 training time: 6.385
---------------
2023-09-12 11:54:38.152989
current #epochs=3, #steps=16
start validation
acc: 0.590909
AUC: 0.797521
Avg Precision: 0.359821
Avg Recall: 1.000000
d_prime: 1.177754
train_loss: 0.250574
valid_loss: 1.174070
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003991579217025469
Epoch-3 lr: 0.003991579217025469
epoch 3 training time: 6.346
---------------
2023-09-12 11:54:44.498520
current #epochs=4, #steps=24
start validation
acc: 0.590909
AUC: 0.811295
Avg Precision: 0.411821
Avg Recall: 1.000000
d_prime: 1.248295
train_loss: 0.188507
valid_loss: 1.147713
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002559992598217435
Epoch-4 lr: 0.002559992598217435
epoch 4 training time: 6.373
---------------
2023-09-12 11:54:50.871883
current #epochs=5, #steps=32
start validation
acc: 0.613636
AUC: 0.828512
Avg Precision: 0.410215
Avg Recall: 1.000000
d_prime: 1.341103
train_loss: 0.217598
valid_loss: 1.124266
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002559992598217435
Epoch-5 lr: 0.002559992598217435
epoch 5 training time: 7.111
---------------
2023-09-12 11:54:57.982981
current #epochs=6, #steps=40
start validation
acc: 0.659091
AUC: 0.827135
Avg Precision: 0.403485
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.197012
valid_loss: 1.125102
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002559992598217435
Epoch-6 lr: 0.002559992598217435
epoch 6 training time: 6.307
---------------
2023-09-12 11:55:04.290727
current #epochs=7, #steps=48
start validation
acc: 0.659091
AUC: 0.824380
Avg Precision: 0.391546
Avg Recall: 1.000000
d_prime: 1.318312
train_loss: 0.143607
valid_loss: 1.129812
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002559992598217435
Epoch-7 lr: 0.002559992598217435
epoch 7 training time: 6.864
---------------
2023-09-12 11:55:11.154400
current #epochs=8, #steps=56
start validation
acc: 0.590909
AUC: 0.832645
Avg Precision: 0.385398
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.123187
valid_loss: 1.122573
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0016418469349110843
Epoch-8 lr: 0.0016418469349110843
epoch 8 training time: 8.493
---------------
2023-09-12 11:55:19.646748
current #epochs=9, #steps=64
start validation
acc: 0.590909
AUC: 0.832645
Avg Precision: 0.410639
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.120540
valid_loss: 1.134445
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0016418469349110843
Epoch-9 lr: 0.0016418469349110843
epoch 9 training time: 6.398
---------------
2023-09-12 11:55:26.045511
current #epochs=10, #steps=72
start validation
acc: 0.590909
AUC: 0.840909
Avg Precision: 0.450567
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.119503
valid_loss: 1.129296
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0016418469349110843
Epoch-10 lr: 0.0016418469349110843
epoch 10 training time: 6.323
---------------
2023-09-12 11:55:32.367970
current #epochs=11, #steps=80
start validation
acc: 0.613636
AUC: 0.844353
Avg Precision: 0.453889
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.119181
valid_loss: 1.123464
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0016418469349110843
Epoch-11 lr: 0.0016418469349110843
epoch 11 training time: 6.718
---------------
2023-09-12 11:55:39.086635
current #epochs=12, #steps=88
start validation
acc: 0.636364
AUC: 0.856749
Avg Precision: 0.447659
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.069918
valid_loss: 1.109757
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0010529957623916398
Epoch-12 lr: 0.0010529957623916398
epoch 12 training time: 6.325
---------------
2023-09-12 11:55:45.411411
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01180	Per Sample Data Time 0.00599	Per Sample DNN Time 0.00580	Train Loss 0.0844	
start validation
acc: 0.613636
AUC: 0.858127
Avg Precision: 0.443851
Avg Recall: 1.000000
d_prime: 1.515953
train_loss: 0.104226
valid_loss: 1.113169
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0010529957623916398
Epoch-13 lr: 0.0010529957623916398
epoch 13 training time: 6.741
---------------
2023-09-12 11:55:52.151912
current #epochs=14, #steps=104
start validation
acc: 0.568182
AUC: 0.848485
Avg Precision: 0.432917
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.139057
valid_loss: 1.127918
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0010529957623916398
Epoch-14 lr: 0.0010529957623916398
epoch 14 training time: 6.309
---------------
2023-09-12 11:55:58.460856
current #epochs=15, #steps=112
start validation
acc: 0.590909
AUC: 0.841598
Avg Precision: 0.407328
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.099560
valid_loss: 1.134465
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0010529957623916398
Epoch-15 lr: 0.0010529957623916398
epoch 15 training time: 6.421
---------------
2023-09-12 11:56:04.881753
current #epochs=16, #steps=120
start validation
acc: 0.636364
AUC: 0.838843
Avg Precision: 0.404985
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.120454
valid_loss: 1.131850
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0006753370561152819
Epoch-16 lr: 0.0006753370561152819
epoch 16 training time: 6.496
---------------
2023-09-12 11:56:11.377302
current #epochs=17, #steps=128
start validation
acc: 0.613636
AUC: 0.829890
Avg Precision: 0.388889
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.131341
valid_loss: 1.131026
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0006753370561152819
Epoch-17 lr: 0.0006753370561152819
epoch 17 training time: 8.377
---------------
2023-09-12 11:56:19.754288
current #epochs=18, #steps=136
start validation
acc: 0.636364
AUC: 0.819559
Avg Precision: 0.368973
Avg Recall: 1.000000
d_prime: 1.292148
train_loss: 0.099095
valid_loss: 1.129519
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0006753370561152819
Epoch-18 lr: 0.0006753370561152819
epoch 18 training time: 6.280
---------------
2023-09-12 11:56:26.034053
current #epochs=19, #steps=144
start validation
acc: 0.636364
AUC: 0.810606
Avg Precision: 0.354167
Avg Recall: 1.000000
d_prime: 1.244694
train_loss: 0.074324
valid_loss: 1.130841
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0006753370561152819
Epoch-19 lr: 0.0006753370561152819
epoch 19 training time: 6.325
---------------
2023-09-12 11:56:32.358861
current #epochs=20, #steps=152
start validation
acc: 0.636364
AUC: 0.816804
Avg Precision: 0.355620
Avg Recall: 1.000000
d_prime: 1.277394
train_loss: 0.068881
valid_loss: 1.130723
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00043312628184426254
Epoch-20 lr: 0.00043312628184426254
epoch 20 training time: 6.344
---------------
2023-09-12 11:56:38.702636
current #epochs=21, #steps=160
start validation
acc: 0.659091
AUC: 0.816116
Avg Precision: 0.358740
Avg Recall: 1.000000
d_prime: 1.273727
train_loss: 0.100019
valid_loss: 1.131231
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00043312628184426254
Epoch-21 lr: 0.00043312628184426254
epoch 21 training time: 6.340
---------------
2023-09-12 11:56:45.042663
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.816804
Avg Precision: 0.357966
Avg Recall: 1.000000
d_prime: 1.277394
train_loss: 0.088152
valid_loss: 1.130657
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00043312628184426254
Epoch-22 lr: 0.00043312628184426254
epoch 22 training time: 6.383
---------------
2023-09-12 11:56:51.426144
current #epochs=23, #steps=176
start validation
acc: 0.636364
AUC: 0.820248
Avg Precision: 0.357278
Avg Recall: 1.000000
d_prime: 1.295859
train_loss: 0.088651
valid_loss: 1.129007
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00043312628184426254
Epoch-23 lr: 0.00043312628184426254
epoch 23 training time: 6.348
---------------
2023-09-12 11:56:57.774032
current #epochs=24, #steps=184
start validation
acc: 0.636364
AUC: 0.820937
Avg Precision: 0.361467
Avg Recall: 1.000000
d_prime: 1.299578
train_loss: 0.070582
valid_loss: 1.129597
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0002777848103039854
Epoch-24 lr: 0.0002777848103039854
epoch 24 training time: 6.483
---------------
2023-09-12 11:57:04.256843
current #epochs=25, #steps=192
start validation
acc: 0.659091
AUC: 0.821625
Avg Precision: 0.361467
Avg Recall: 1.000000
d_prime: 1.303307
train_loss: 0.135905
valid_loss: 1.130214
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0002777848103039854
Epoch-25 lr: 0.0002777848103039854
epoch 25 training time: 6.283
---------------
2023-09-12 11:57:10.540032
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03575	Per Sample Data Time 0.03026	Per Sample DNN Time 0.00549	Train Loss 0.0318	
start validation
acc: 0.659091
AUC: 0.818871
Avg Precision: 0.361467
Avg Recall: 1.000000
d_prime: 1.288446
train_loss: 0.064923
valid_loss: 1.131147
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0002777848103039854
Epoch-26 lr: 0.0002777848103039854
epoch 26 training time: 6.324
---------------
2023-09-12 11:57:16.864555
current #epochs=27, #steps=208
start validation
acc: 0.659091
AUC: 0.817493
Avg Precision: 0.361467
Avg Recall: 1.000000
d_prime: 1.281069
train_loss: 0.106485
valid_loss: 1.131657
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0002777848103039854
Epoch-27 lr: 0.0002777848103039854
epoch 27 training time: 7.642
---------------
2023-09-12 11:57:24.506042
current #epochs=28, #steps=216
start validation
[I 2023-09-12 11:57:30,905] Trial 86 finished with value: 0.6590909090909091 and parameters: {'warmup': 'False', 'num_epochs': 28, 'batch_size': 10, 'lr-adaptschedule': 'False', 'lr': 0.003991579217025469, 'head-lr': 1, 'lr-scheduler-start': 4, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.6413483132936906}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.659091
AUC: 0.818871
Avg Precision: 0.365086
Avg Recall: 1.000000
d_prime: 1.288446
train_loss: 0.081730
valid_loss: 1.131398
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00017815681954706883
Epoch-28 lr: 0.00017815681954706883
epoch 28 training time: 6.393
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8da02e0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.726 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 11:57:30.944334
current #epochs=1, #steps=0
start validation
acc: 0.636364
AUC: 0.811983
Avg Precision: 0.332304
Avg Recall: 1.000000
d_prime: 1.251903
train_loss: 0.171593
valid_loss: 1.151363
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003167289384440438
Epoch-1 lr: 0.003167289384440438
epoch 1 training time: 9.043
---------------
2023-09-12 11:57:39.987830
current #epochs=2, #steps=8
start validation
acc: 0.704545
AUC: 0.822314
Avg Precision: 0.380824
Avg Recall: 1.000000
d_prime: 1.307044
train_loss: 0.200889
valid_loss: 1.134209
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003167289384440438
Epoch-2 lr: 0.003167289384440438
epoch 2 training time: 10.215
---------------
2023-09-12 11:57:50.203042
current #epochs=3, #steps=16
start validation
acc: 0.636364
AUC: 0.827824
Avg Precision: 0.370032
Avg Recall: 1.000000
d_prime: 1.337280
train_loss: 0.150401
valid_loss: 1.144415
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003167289384440438
Epoch-3 lr: 0.003167289384440438
epoch 3 training time: 6.290
---------------
2023-09-12 11:57:56.492821
current #epochs=4, #steps=24
start validation
acc: 0.613636
AUC: 0.816116
Avg Precision: 0.333995
Avg Recall: 1.000000
d_prime: 1.273727
train_loss: 0.191839
valid_loss: 1.131435
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003167289384440438
Epoch-4 lr: 0.003167289384440438
epoch 4 training time: 8.271
---------------
2023-09-12 11:58:04.764297
current #epochs=5, #steps=32
start validation
acc: 0.613636
AUC: 0.823691
Avg Precision: 0.369796
Avg Recall: 1.000000
d_prime: 1.314547
train_loss: 0.170689
valid_loss: 1.136054
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.003167289384440438
Epoch-5 lr: 0.003167289384440438
epoch 5 training time: 6.771
---------------
2023-09-12 11:58:11.535262
current #epochs=6, #steps=40
start validation
acc: 0.545455
AUC: 0.833333
Avg Precision: 0.389654
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.176182
valid_loss: 1.137946
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002299987355455286
Epoch-6 lr: 0.002299987355455286
epoch 6 training time: 6.368
---------------
2023-09-12 11:58:17.902934
current #epochs=7, #steps=48
start validation
acc: 0.613636
AUC: 0.848485
Avg Precision: 0.432898
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.162079
valid_loss: 1.116656
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002299987355455286
Epoch-7 lr: 0.002299987355455286
epoch 7 training time: 8.202
---------------
2023-09-12 11:58:26.105172
current #epochs=8, #steps=56
start validation
acc: 0.613636
AUC: 0.837466
Avg Precision: 0.448994
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.129806
valid_loss: 1.127470
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.002299987355455286
Epoch-8 lr: 0.002299987355455286
epoch 8 training time: 8.063
---------------
2023-09-12 11:58:34.168758
current #epochs=9, #steps=64
start validation
acc: 0.681818
AUC: 0.842287
Avg Precision: 0.426806
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.131115
valid_loss: 1.135145
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.002299987355455286
Epoch-9 lr: 0.002299987355455286
epoch 9 training time: 10.157
---------------
2023-09-12 11:58:44.325356
current #epochs=10, #steps=72
start validation
acc: 0.681818
AUC: 0.845041
Avg Precision: 0.402995
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.099525
valid_loss: 1.120126
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.002299987355455286
Epoch-10 lr: 0.002299987355455286
epoch 10 training time: 6.336
---------------
2023-09-12 11:58:50.661091
current #epochs=11, #steps=80
start validation
acc: 0.636364
AUC: 0.858815
Avg Precision: 0.425104
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.112108
valid_loss: 1.103330
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0016701795109854698
Epoch-11 lr: 0.0016701795109854698
epoch 11 training time: 8.141
---------------
2023-09-12 11:58:58.801993
current #epochs=12, #steps=88
start validation
acc: 0.613636
AUC: 0.861570
Avg Precision: 0.471211
Avg Recall: 1.000000
d_prime: 1.537818
train_loss: 0.104007
valid_loss: 1.100901
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0016701795109854698
Epoch-12 lr: 0.0016701795109854698
epoch 12 training time: 7.795
---------------
2023-09-12 11:59:06.597102
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01146	Per Sample Data Time 0.00600	Per Sample DNN Time 0.00546	Train Loss 0.1132	
start validation
acc: 0.636364
AUC: 0.860882
Avg Precision: 0.489751
Avg Recall: 1.000000
d_prime: 1.533415
train_loss: 0.107926
valid_loss: 1.116228
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0016701795109854698
Epoch-13 lr: 0.0016701795109854698
epoch 13 training time: 6.294
---------------
2023-09-12 11:59:12.891448
current #epochs=14, #steps=104
start validation
acc: 0.636364
AUC: 0.858815
Avg Precision: 0.479807
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.128417
valid_loss: 1.109615
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0016701795109854698
Epoch-14 lr: 0.0016701795109854698
epoch 14 training time: 6.294
---------------
2023-09-12 11:59:19.185710
current #epochs=15, #steps=112
start validation
acc: 0.613636
AUC: 0.846419
Avg Precision: 0.432870
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.154314
valid_loss: 1.123340
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0016701795109854698
Epoch-15 lr: 0.0016701795109854698
epoch 15 training time: 6.595
---------------
2023-09-12 11:59:25.780754
current #epochs=16, #steps=120
start validation
acc: 0.636364
AUC: 0.826446
Avg Precision: 0.372699
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.132736
valid_loss: 1.132651
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0012128325802745455
Epoch-16 lr: 0.0012128325802745455
epoch 16 training time: 9.753
---------------
2023-09-12 11:59:35.533929
current #epochs=17, #steps=128
start validation
acc: 0.613636
AUC: 0.829201
Avg Precision: 0.371911
Avg Recall: 1.000000
d_prime: 1.344935
train_loss: 0.100561
valid_loss: 1.132489
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0012128325802745455
Epoch-17 lr: 0.0012128325802745455
epoch 17 training time: 7.352
---------------
2023-09-12 11:59:42.885593
current #epochs=18, #steps=136
start validation
acc: 0.590909
AUC: 0.837466
Avg Precision: 0.384337
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.061692
valid_loss: 1.131464
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0012128325802745455
Epoch-18 lr: 0.0012128325802745455
epoch 18 training time: 6.662
---------------
2023-09-12 11:59:49.547686
current #epochs=19, #steps=144
start validation
acc: 0.636364
AUC: 0.842975
Avg Precision: 0.391703
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.137242
valid_loss: 1.131639
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0012128325802745455
Epoch-19 lr: 0.0012128325802745455
epoch 19 training time: 7.558
---------------
2023-09-12 11:59:57.106034
current #epochs=20, #steps=152
start validation
acc: 0.636364
AUC: 0.847796
Avg Precision: 0.417513
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.082310
valid_loss: 1.131700
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0012128325802745455
Epoch-20 lr: 0.0012128325802745455
epoch 20 training time: 6.299
---------------
2023-09-12 12:00:03.404504
current #epochs=21, #steps=160
start validation
acc: 0.636364
AUC: 0.861570
Avg Precision: 0.465132
Avg Recall: 1.000000
d_prime: 1.537818
train_loss: 0.116792
valid_loss: 1.120233
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0008807214183267567
Epoch-21 lr: 0.0008807214183267567
epoch 21 training time: 6.252
---------------
2023-09-12 12:00:09.656143
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.862948
Avg Precision: 0.452155
Avg Recall: 1.000000
d_prime: 1.546667
train_loss: 0.134165
valid_loss: 1.105421
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0008807214183267567
Epoch-22 lr: 0.0008807214183267567
epoch 22 training time: 6.392
---------------
2023-09-12 12:00:16.047965
current #epochs=23, #steps=176
start validation
acc: 0.659091
AUC: 0.865014
Avg Precision: 0.437155
Avg Recall: 1.000000
d_prime: 1.560056
train_loss: 0.054714
valid_loss: 1.100837
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0008807214183267567
Epoch-23 lr: 0.0008807214183267567
epoch 23 training time: 6.353
---------------
2023-09-12 12:00:22.400859
current #epochs=24, #steps=184
start validation
acc: 0.704545
AUC: 0.866391
Avg Precision: 0.425846
Avg Recall: 1.000000
d_prime: 1.569060
train_loss: 0.092432
valid_loss: 1.097206
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0008807214183267567
Epoch-24 lr: 0.0008807214183267567
epoch 24 training time: 6.406
---------------
2023-09-12 12:00:28.807141
current #epochs=25, #steps=192
start validation
acc: 0.659091
AUC: 0.863636
Avg Precision: 0.431037
Avg Recall: 1.000000
d_prime: 1.551114
train_loss: 0.094787
valid_loss: 1.099364
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0008807214183267567
Epoch-25 lr: 0.0008807214183267567
epoch 25 training time: 6.334
---------------
2023-09-12 12:00:35.140780
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03691	Per Sample Data Time 0.03092	Per Sample DNN Time 0.00599	Train Loss 0.0728	
start validation
acc: 0.659091
AUC: 0.856749
Avg Precision: 0.427876
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.091782
valid_loss: 1.111935
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0006395525889681392
Epoch-26 lr: 0.0006395525889681392
epoch 26 training time: 6.321
---------------
2023-09-12 12:00:41.462002
current #epochs=27, #steps=208
start validation
acc: 0.659091
AUC: 0.849862
Avg Precision: 0.412500
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.099254
valid_loss: 1.118107
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0006395525889681392
Epoch-27 lr: 0.0006395525889681392
epoch 27 training time: 7.251
---------------
2023-09-12 12:00:48.713417
current #epochs=28, #steps=216
start validation
acc: 0.659091
AUC: 0.851240
Avg Precision: 0.421983
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.132015
valid_loss: 1.118786
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0006395525889681392
Epoch-28 lr: 0.0006395525889681392
epoch 28 training time: 9.360
---------------
2023-09-12 12:00:58.073145
current #epochs=29, #steps=224
start validation
acc: 0.636364
AUC: 0.844353
Avg Precision: 0.425369
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.102627
valid_loss: 1.126958
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0006395525889681392
Epoch-29 lr: 0.0006395525889681392
epoch 29 training time: 6.420
---------------
2023-09-12 12:01:04.493725
current #epochs=30, #steps=232
start validation
acc: 0.636364
AUC: 0.845041
Avg Precision: 0.425369
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.092522
valid_loss: 1.126597
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0006395525889681392
Epoch-30 lr: 0.0006395525889681392
epoch 30 training time: 6.351
---------------
2023-09-12 12:01:10.844751
current #epochs=31, #steps=240
start validation
acc: 0.636364
AUC: 0.848485
Avg Precision: 0.425846
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.128401
valid_loss: 1.125553
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.00046442326204913087
Epoch-31 lr: 0.00046442326204913087
epoch 31 training time: 6.276
---------------
2023-09-12 12:01:17.120757
current #epochs=32, #steps=248
start validation
acc: 0.636364
AUC: 0.845730
Avg Precision: 0.419298
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.094488
valid_loss: 1.125877
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00046442326204913087
Epoch-32 lr: 0.00046442326204913087
epoch 32 training time: 7.782
---------------
2023-09-12 12:01:24.902255
current #epochs=33, #steps=256
start validation
[I 2023-09-12 12:01:31,269] Trial 87 finished with value: 0.7045454545454546 and parameters: {'warmup': 'False', 'num_epochs': 33, 'batch_size': 16, 'lr-adaptschedule': 'True', 'lr': 0.003167289384440438, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.7261689969834009}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.659091
AUC: 0.857438
Avg Precision: 0.440399
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.115388
valid_loss: 1.112262
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.00046442326204913087
Epoch-33 lr: 0.00046442326204913087
epoch 33 training time: 6.361
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8e7d130>
The learning rate scheduler starts at 3 epoch with decay rate of 0.684 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 12:01:31.308877
current #epochs=1, #steps=0
start validation
acc: 0.636364
AUC: 0.858815
Avg Precision: 0.434540
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.176687
valid_loss: 1.103664
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003691934028680604
Epoch-1 lr: 0.007383868057361208
epoch 1 training time: 11.915
---------------
2023-09-12 12:01:43.224534
current #epochs=2, #steps=8
start validation
acc: 0.659091
AUC: 0.848485
Avg Precision: 0.403039
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.188693
valid_loss: 1.108938
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003691934028680604
Epoch-2 lr: 0.007383868057361208
epoch 2 training time: 9.409
---------------
2023-09-12 12:01:52.633674
current #epochs=3, #steps=16
start validation
acc: 0.659091
AUC: 0.878099
Avg Precision: 0.471825
Avg Recall: 1.000000
d_prime: 1.648318
train_loss: 0.160172
valid_loss: 1.080945
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.00252557985552572
Epoch-3 lr: 0.00505115971105144
epoch 3 training time: 6.313
---------------
2023-09-12 12:01:58.946300
current #epochs=4, #steps=24
start validation
acc: 0.659091
AUC: 0.865702
Avg Precision: 0.439409
Avg Recall: 1.000000
d_prime: 1.564550
train_loss: 0.166516
valid_loss: 1.105123
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00252557985552572
Epoch-4 lr: 0.00505115971105144
epoch 4 training time: 7.733
---------------
2023-09-12 12:02:06.679380
current #epochs=5, #steps=32
start validation
acc: 0.659091
AUC: 0.865014
Avg Precision: 0.424821
Avg Recall: 1.000000
d_prime: 1.560056
train_loss: 0.138199
valid_loss: 1.106581
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0017276997793259155
Epoch-5 lr: 0.003455399558651831
epoch 5 training time: 6.365
---------------
2023-09-12 12:02:13.044133
current #epochs=6, #steps=40
start validation
acc: 0.613636
AUC: 0.849174
Avg Precision: 0.387473
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.143645
valid_loss: 1.117189
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0017276997793259155
Epoch-6 lr: 0.003455399558651831
epoch 6 training time: 6.363
---------------
2023-09-12 12:02:19.406652
current #epochs=7, #steps=48
start validation
acc: 0.659091
AUC: 0.850551
Avg Precision: 0.372436
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.119600
valid_loss: 1.120756
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0011818856255730928
Epoch-7 lr: 0.0023637712511461856
epoch 7 training time: 7.766
---------------
2023-09-12 12:02:27.172993
current #epochs=8, #steps=56
start validation
acc: 0.681818
AUC: 0.854683
Avg Precision: 0.391915
Avg Recall: 1.000000
d_prime: 1.494446
train_loss: 0.113120
valid_loss: 1.124689
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0011818856255730928
Epoch-8 lr: 0.0023637712511461856
epoch 8 training time: 9.963
---------------
2023-09-12 12:02:37.136006
current #epochs=9, #steps=64
start validation
acc: 0.681818
AUC: 0.848485
Avg Precision: 0.396146
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.156207
valid_loss: 1.127931
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0008085048390069839
Epoch-9 lr: 0.0016170096780139679
epoch 9 training time: 6.410
---------------
2023-09-12 12:02:43.546004
current #epochs=10, #steps=72
start validation
acc: 0.681818
AUC: 0.850551
Avg Precision: 0.400729
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.144314
valid_loss: 1.120133
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0008085048390069839
Epoch-10 lr: 0.0016170096780139679
epoch 10 training time: 6.259
---------------
2023-09-12 12:02:49.804974
current #epochs=11, #steps=80
start validation
acc: 0.659091
AUC: 0.853306
Avg Precision: 0.414352
Avg Recall: 1.000000
d_prime: 1.485939
train_loss: 0.103796
valid_loss: 1.117325
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0005530823461709685
Epoch-11 lr: 0.001106164692341937
epoch 11 training time: 7.703
---------------
2023-09-12 12:02:57.507990
current #epochs=12, #steps=88
start validation
acc: 0.659091
AUC: 0.851240
Avg Precision: 0.414352
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.118056
valid_loss: 1.118467
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0005530823461709685
Epoch-12 lr: 0.001106164692341937
epoch 12 training time: 6.293
---------------
2023-09-12 12:03:03.801357
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01199	Per Sample Data Time 0.00624	Per Sample DNN Time 0.00574	Train Loss 0.1447	
start validation
acc: 0.659091
AUC: 0.854683
Avg Precision: 0.414352
Avg Recall: 1.000000
d_prime: 1.494446
train_loss: 0.133294
valid_loss: 1.118508
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0003783528148349656
Epoch-13 lr: 0.0007567056296699312
epoch 13 training time: 7.644
---------------
2023-09-12 12:03:11.445470
current #epochs=14, #steps=104
start validation
acc: 0.659091
AUC: 0.854683
Avg Precision: 0.414352
Avg Recall: 1.000000
d_prime: 1.494446
train_loss: 0.091589
valid_loss: 1.117898
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0003783528148349656
Epoch-14 lr: 0.0007567056296699312
epoch 14 training time: 7.701
---------------
2023-09-12 12:03:19.146711
current #epochs=15, #steps=112
start validation
acc: 0.659091
AUC: 0.855372
Avg Precision: 0.427179
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.073141
valid_loss: 1.116753
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0002588237601228571
Epoch-15 lr: 0.0005176475202457142
epoch 15 training time: 7.601
---------------
2023-09-12 12:03:26.747308
current #epochs=16, #steps=120
start validation
acc: 0.659091
AUC: 0.857438
Avg Precision: 0.438617
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.105417
valid_loss: 1.115584
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0002588237601228571
Epoch-16 lr: 0.0005176475202457142
epoch 16 training time: 8.366
---------------
2023-09-12 12:03:35.113720
current #epochs=17, #steps=128
start validation
acc: 0.659091
AUC: 0.857438
Avg Precision: 0.440083
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.080978
valid_loss: 1.114932
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.00017705627175882026
Epoch-17 lr: 0.0003541125435176405
epoch 17 training time: 8.647
---------------
2023-09-12 12:03:43.760772
current #epochs=18, #steps=136
start validation
acc: 0.659091
AUC: 0.858815
Avg Precision: 0.435327
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.096426
valid_loss: 1.115147
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00017705627175882026
Epoch-18 lr: 0.0003541125435176405
epoch 18 training time: 7.788
---------------
2023-09-12 12:03:51.549101
current #epochs=19, #steps=144
start validation
acc: 0.659091
AUC: 0.858127
Avg Precision: 0.424632
Avg Recall: 1.000000
d_prime: 1.515953
train_loss: 0.081959
valid_loss: 1.115566
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00012112073232477834
Epoch-19 lr: 0.00024224146464955668
epoch 19 training time: 8.612
---------------
2023-09-12 12:04:00.160995
current #epochs=20, #steps=152
start validation
acc: 0.659091
AUC: 0.858127
Avg Precision: 0.424632
Avg Recall: 1.000000
d_prime: 1.515953
train_loss: 0.096346
valid_loss: 1.115910
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00012112073232477834
Epoch-20 lr: 0.00024224146464955668
epoch 20 training time: 6.245
---------------
2023-09-12 12:04:06.405980
current #epochs=21, #steps=160
start validation
acc: 0.659091
AUC: 0.858815
Avg Precision: 0.435049
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.139798
valid_loss: 1.116762
validation finished
normal learning rate scheduler step
Epoch-21 lr: 8.2856323885967e-05
Epoch-21 lr: 0.000165712647771934
epoch 21 training time: 6.354
---------------
2023-09-12 12:04:12.760604
current #epochs=22, #steps=168
start validation
acc: 0.659091
AUC: 0.858815
Avg Precision: 0.435049
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.099686
valid_loss: 1.117168
validation finished
normal learning rate scheduler step
Epoch-22 lr: 8.2856323885967e-05
Epoch-22 lr: 0.000165712647771934
epoch 22 training time: 6.339
---------------
2023-09-12 12:04:19.099728
current #epochs=23, #steps=176
start validation
[I 2023-09-12 12:04:25,354] Trial 88 finished with value: 0.6818181818181818 and parameters: {'warmup': 'False', 'num_epochs': 23, 'batch_size': 20, 'lr-adaptschedule': 'True', 'lr': 0.003691934028680604, 'head-lr': 2, 'lr-scheduler-start': 3, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.684080440199061}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.659091
AUC: 0.858127
Avg Precision: 0.435049
Avg Recall: 1.000000
d_prime: 1.515953
train_loss: 0.089576
valid_loss: 1.116827
validation finished
normal learning rate scheduler step
Epoch-23 lr: 5.668039051718828e-05
Epoch-23 lr: 0.00011336078103437656
epoch 23 training time: 6.248
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f956e06f580>
The learning rate scheduler starts at 6 epoch with decay rate of 0.702 every 6 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 12:04:25.393856
current #epochs=1, #steps=0
start validation
acc: 0.659091
AUC: 0.847796
Avg Precision: 0.429571
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.119079
valid_loss: 1.129701
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002916954424502987
Epoch-1 lr: 0.011667817698011947
epoch 1 training time: 12.869
---------------
2023-09-12 12:04:38.262746
current #epochs=2, #steps=8
start validation
acc: 0.613636
AUC: 0.842975
Avg Precision: 0.405174
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.147215
valid_loss: 1.139995
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002916954424502987
Epoch-2 lr: 0.011667817698011947
epoch 2 training time: 6.441
---------------
2023-09-12 12:04:44.703308
current #epochs=3, #steps=16
start validation
acc: 0.590909
AUC: 0.842975
Avg Precision: 0.434091
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.199245
valid_loss: 1.128119
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002916954424502987
Epoch-3 lr: 0.011667817698011947
epoch 3 training time: 6.500
---------------
2023-09-12 12:04:51.203785
current #epochs=4, #steps=24
start validation
acc: 0.636364
AUC: 0.829890
Avg Precision: 0.396493
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.192624
valid_loss: 1.142923
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002916954424502987
Epoch-4 lr: 0.011667817698011947
epoch 4 training time: 6.520
---------------
2023-09-12 12:04:57.724005
current #epochs=5, #steps=32
start validation
acc: 0.636364
AUC: 0.820937
Avg Precision: 0.377968
Avg Recall: 1.000000
d_prime: 1.299578
train_loss: 0.153706
valid_loss: 1.149698
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002916954424502987
Epoch-5 lr: 0.011667817698011947
epoch 5 training time: 6.346
---------------
2023-09-12 12:05:04.070390
current #epochs=6, #steps=40
start validation
acc: 0.681818
AUC: 0.825069
Avg Precision: 0.386626
Avg Recall: 1.000000
d_prime: 1.322087
train_loss: 0.201692
valid_loss: 1.139162
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0020488877270196243
Epoch-6 lr: 0.008195550908078497
epoch 6 training time: 10.400
---------------
2023-09-12 12:05:14.470804
current #epochs=7, #steps=48
start validation
acc: 0.613636
AUC: 0.841598
Avg Precision: 0.420396
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.137424
valid_loss: 1.130194
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0020488877270196243
Epoch-7 lr: 0.008195550908078497
epoch 7 training time: 6.380
---------------
2023-09-12 12:05:20.850652
current #epochs=8, #steps=56
start validation
acc: 0.613636
AUC: 0.862948
Avg Precision: 0.465412
Avg Recall: 1.000000
d_prime: 1.546667
train_loss: 0.104147
valid_loss: 1.123893
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0020488877270196243
Epoch-8 lr: 0.008195550908078497
epoch 8 training time: 6.405
---------------
2023-09-12 12:05:27.255504
current #epochs=9, #steps=64
start validation
acc: 0.636364
AUC: 0.869146
Avg Precision: 0.450854
Avg Recall: 1.000000
d_prime: 1.587261
train_loss: 0.145558
valid_loss: 1.092768
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0020488877270196243
Epoch-9 lr: 0.008195550908078497
epoch 9 training time: 6.414
---------------
2023-09-12 12:05:33.669718
current #epochs=10, #steps=72
start validation
acc: 0.636364
AUC: 0.843664
Avg Precision: 0.374942
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.160243
valid_loss: 1.123535
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0020488877270196243
Epoch-10 lr: 0.008195550908078497
epoch 10 training time: 6.357
---------------
2023-09-12 12:05:40.026684
current #epochs=11, #steps=80
start validation
acc: 0.613636
AUC: 0.823691
Avg Precision: 0.348552
Avg Recall: 1.000000
d_prime: 1.314547
train_loss: 0.112765
valid_loss: 1.136764
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0020488877270196243
Epoch-11 lr: 0.008195550908078497
epoch 11 training time: 6.263
---------------
2023-09-12 12:05:46.289437
current #epochs=12, #steps=88
start validation
acc: 0.636364
AUC: 0.827824
Avg Precision: 0.364799
Avg Recall: 1.000000
d_prime: 1.337280
train_loss: 0.110306
valid_loss: 1.137325
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0014391520425098584
Epoch-12 lr: 0.005756608170039434
epoch 12 training time: 6.350
---------------
2023-09-12 12:05:52.639777
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01176	Per Sample Data Time 0.00602	Per Sample DNN Time 0.00574	Train Loss 0.0747	
start validation
acc: 0.613636
AUC: 0.833333
Avg Precision: 0.364211
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.089483
valid_loss: 1.137619
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0014391520425098584
Epoch-13 lr: 0.005756608170039434
epoch 13 training time: 6.299
---------------
2023-09-12 12:05:58.938780
current #epochs=14, #steps=104
start validation
acc: 0.613636
AUC: 0.837466
Avg Precision: 0.379116
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.116429
valid_loss: 1.134331
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0014391520425098584
Epoch-14 lr: 0.005756608170039434
epoch 14 training time: 7.547
---------------
2023-09-12 12:06:06.485727
current #epochs=15, #steps=112
start validation
acc: 0.636364
AUC: 0.861570
Avg Precision: 0.400361
Avg Recall: 1.000000
d_prime: 1.537818
train_loss: 0.091374
valid_loss: 1.112916
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0014391520425098584
Epoch-15 lr: 0.005756608170039434
epoch 15 training time: 7.505
---------------
2023-09-12 12:06:13.990377
current #epochs=16, #steps=120
start validation
acc: 0.659091
AUC: 0.857438
Avg Precision: 0.384087
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.118661
valid_loss: 1.116841
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0014391520425098584
Epoch-16 lr: 0.005756608170039434
epoch 16 training time: 6.460
---------------
2023-09-12 12:06:20.450724
current #epochs=17, #steps=128
start validation
acc: 0.659091
AUC: 0.850551
Avg Precision: 0.389168
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.134901
valid_loss: 1.128209
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0014391520425098584
Epoch-17 lr: 0.005756608170039434
epoch 17 training time: 6.263
---------------
2023-09-12 12:06:26.713590
current #epochs=18, #steps=136
start validation
acc: 0.659091
AUC: 0.845730
Avg Precision: 0.387617
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.115214
valid_loss: 1.125481
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001010869738808514
Epoch-18 lr: 0.004043478955234056
epoch 18 training time: 6.320
---------------
2023-09-12 12:06:33.033937
current #epochs=19, #steps=144
start validation
acc: 0.659091
AUC: 0.845730
Avg Precision: 0.377658
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.116023
valid_loss: 1.124732
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.001010869738808514
Epoch-19 lr: 0.004043478955234056
epoch 19 training time: 6.387
---------------
2023-09-12 12:06:39.421072
current #epochs=20, #steps=152
start validation
acc: 0.636364
AUC: 0.840909
Avg Precision: 0.366592
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.141071
valid_loss: 1.129453
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.001010869738808514
Epoch-20 lr: 0.004043478955234056
epoch 20 training time: 8.719
---------------
2023-09-12 12:06:48.139799
current #epochs=21, #steps=160
start validation
acc: 0.613636
AUC: 0.834711
Avg Precision: 0.374702
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.047868
valid_loss: 1.129410
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.001010869738808514
Epoch-21 lr: 0.004043478955234056
epoch 21 training time: 6.366
---------------
2023-09-12 12:06:54.505661
current #epochs=22, #steps=168
start validation
acc: 0.613636
AUC: 0.838843
Avg Precision: 0.386639
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.118894
valid_loss: 1.122730
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.001010869738808514
Epoch-22 lr: 0.004043478955234056
epoch 22 training time: 8.944
---------------
2023-09-12 12:07:03.449557
current #epochs=23, #steps=176
start validation
acc: 0.636364
AUC: 0.840909
Avg Precision: 0.381250
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.087513
valid_loss: 1.122492
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.001010869738808514
Epoch-23 lr: 0.004043478955234056
epoch 23 training time: 6.761
---------------
2023-09-12 12:07:10.210309
current #epochs=24, #steps=184
start validation
acc: 0.636364
AUC: 0.838843
Avg Precision: 0.373496
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.093352
valid_loss: 1.119914
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0007100414679304416
Epoch-24 lr: 0.0028401658717217663
epoch 24 training time: 7.150
---------------
2023-09-12 12:07:17.360012
current #epochs=25, #steps=192
start validation
acc: 0.681818
AUC: 0.836777
Avg Precision: 0.373496
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.079489
valid_loss: 1.118468
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0007100414679304416
Epoch-25 lr: 0.0028401658717217663
epoch 25 training time: 6.333
---------------
2023-09-12 12:07:23.693577
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03349	Per Sample Data Time 0.02790	Per Sample DNN Time 0.00559	Train Loss 0.1679	
start validation
acc: 0.659091
AUC: 0.839532
Avg Precision: 0.380376
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.086618
valid_loss: 1.113666
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0007100414679304416
Epoch-26 lr: 0.0028401658717217663
epoch 26 training time: 6.208
---------------
2023-09-12 12:07:29.901099
current #epochs=27, #steps=208
start validation
acc: 0.636364
AUC: 0.845730
Avg Precision: 0.395119
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.065497
valid_loss: 1.109599
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0007100414679304416
Epoch-27 lr: 0.0028401658717217663
epoch 27 training time: 7.203
---------------
2023-09-12 12:07:37.104577
current #epochs=28, #steps=216
start validation
acc: 0.636364
AUC: 0.845730
Avg Precision: 0.389390
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.096478
valid_loss: 1.108629
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0007100414679304416
Epoch-28 lr: 0.0028401658717217663
epoch 28 training time: 6.396
---------------
2023-09-12 12:07:43.500005
current #epochs=29, #steps=224
start validation
acc: 0.636364
AUC: 0.849174
Avg Precision: 0.370501
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.088780
valid_loss: 1.110543
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0007100414679304416
Epoch-29 lr: 0.0028401658717217663
epoch 29 training time: 7.307
---------------
2023-09-12 12:07:50.807312
current #epochs=30, #steps=232
start validation
acc: 0.636364
AUC: 0.851240
Avg Precision: 0.371076
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.121049
valid_loss: 1.111595
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0004987377372430352
Epoch-30 lr: 0.001994950948972141
epoch 30 training time: 6.352
---------------
2023-09-12 12:07:57.159008
current #epochs=31, #steps=240
start validation
acc: 0.613636
AUC: 0.851240
Avg Precision: 0.361344
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.124508
valid_loss: 1.112848
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0004987377372430352
Epoch-31 lr: 0.001994950948972141
epoch 31 training time: 7.315
---------------
2023-09-12 12:08:04.473609
current #epochs=32, #steps=248
start validation
acc: 0.636364
AUC: 0.848485
Avg Precision: 0.358681
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.131568
valid_loss: 1.113100
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0004987377372430352
Epoch-32 lr: 0.001994950948972141
epoch 32 training time: 6.513
---------------
2023-09-12 12:08:10.987276
current #epochs=33, #steps=256
start validation
acc: 0.636364
AUC: 0.847796
Avg Precision: 0.355376
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.078480
valid_loss: 1.114565
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0004987377372430352
Epoch-33 lr: 0.001994950948972141
epoch 33 training time: 8.042
---------------
2023-09-12 12:08:19.028959
current #epochs=34, #steps=264
start validation
acc: 0.659091
AUC: 0.846419
Avg Precision: 0.352604
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.054756
valid_loss: 1.117401
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0004987377372430352
Epoch-34 lr: 0.001994950948972141
epoch 34 training time: 6.363
---------------
2023-09-12 12:08:25.391707
current #epochs=35, #steps=272
start validation
acc: 0.659091
AUC: 0.847107
Avg Precision: 0.363021
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.058933
valid_loss: 1.119046
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0004987377372430352
Epoch-35 lr: 0.001994950948972141
epoch 35 training time: 6.371
---------------
2023-09-12 12:08:31.762294
current #epochs=36, #steps=280
start validation
acc: 0.636364
AUC: 0.847796
Avg Precision: 0.375521
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.045473
valid_loss: 1.120546
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.000350316624851931
Epoch-36 lr: 0.001401266499407724
epoch 36 training time: 6.378
---------------
2023-09-12 12:08:38.140648
current #epochs=37, #steps=288
start validation
acc: 0.636364
AUC: 0.849174
Avg Precision: 0.370736
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.053145
valid_loss: 1.121177
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.000350316624851931
Epoch-37 lr: 0.001401266499407724
epoch 37 training time: 6.954
---------------
2023-09-12 12:08:45.094791
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01211	Per Sample Data Time 0.00622	Per Sample DNN Time 0.00589	Train Loss 0.0470	
start validation
acc: 0.636364
AUC: 0.845730
Avg Precision: 0.363021
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.091392
valid_loss: 1.123147
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.000350316624851931
Epoch-38 lr: 0.001401266499407724
epoch 38 training time: 6.734
---------------
2023-09-12 12:08:51.829452
current #epochs=39, #steps=304
start validation
acc: 0.636364
AUC: 0.838843
Avg Precision: 0.366369
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.082753
valid_loss: 1.125387
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.000350316624851931
Epoch-39 lr: 0.001401266499407724
epoch 39 training time: 9.003
---------------
2023-09-12 12:09:00.832381
current #epochs=40, #steps=312
start validation
acc: 0.636364
AUC: 0.836088
Avg Precision: 0.361573
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.110172
valid_loss: 1.124182
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.000350316624851931
Epoch-40 lr: 0.001401266499407724
epoch 40 training time: 6.231
---------------
2023-09-12 12:09:07.063627
current #epochs=41, #steps=320
start validation
[I 2023-09-12 12:09:13,387] Trial 89 finished with value: 0.6818181818181818 and parameters: {'warmup': 'False', 'num_epochs': 41, 'batch_size': 18, 'lr-adaptschedule': 'False', 'lr': 0.002916954424502987, 'head-lr': 4, 'lr-scheduler-start': 6, 'lr-scheduler-step': 6, 'lr-scheduler-decay': 0.702406492816126}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.613636
AUC: 0.835399
Avg Precision: 0.361573
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.089534
valid_loss: 1.122480
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.000350316624851931
Epoch-41 lr: 0.001401266499407724
epoch 41 training time: 6.318
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f956e0683a0>
The learning rate scheduler starts at 4 epoch with decay rate of 0.671 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 12:09:13.427397
current #epochs=1, #steps=0
start validation
acc: 0.704545
AUC: 0.850551
Avg Precision: 0.379460
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.167446
valid_loss: 1.114258
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0028034807442768326
Epoch-1 lr: 0.0028034807442768326
epoch 1 training time: 8.930
---------------
2023-09-12 12:09:22.357624
current #epochs=2, #steps=8
start validation
acc: 0.636364
AUC: 0.851240
Avg Precision: 0.409751
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.144202
valid_loss: 1.117153
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0028034807442768326
Epoch-2 lr: 0.0028034807442768326
epoch 2 training time: 8.932
---------------
2023-09-12 12:09:31.289587
current #epochs=3, #steps=16
start validation
acc: 0.659091
AUC: 0.851928
Avg Precision: 0.409506
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.104084
valid_loss: 1.111417
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0028034807442768326
Epoch-3 lr: 0.0028034807442768326
epoch 3 training time: 6.378
---------------
2023-09-12 12:09:37.667288
current #epochs=4, #steps=24
start validation
acc: 0.681818
AUC: 0.866391
Avg Precision: 0.375448
Avg Recall: 1.000000
d_prime: 1.569060
train_loss: 0.139816
valid_loss: 1.093216
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00188202653672583
Epoch-4 lr: 0.00188202653672583
epoch 4 training time: 6.354
---------------
2023-09-12 12:09:44.021250
current #epochs=5, #steps=32
start validation
acc: 0.659091
AUC: 0.865014
Avg Precision: 0.425293
Avg Recall: 1.000000
d_prime: 1.560056
train_loss: 0.175851
valid_loss: 1.100250
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00188202653672583
Epoch-5 lr: 0.00188202653672583
epoch 5 training time: 6.321
---------------
2023-09-12 12:09:50.342650
current #epochs=6, #steps=40
start validation
acc: 0.659091
AUC: 0.864325
Avg Precision: 0.405555
Avg Recall: 1.000000
d_prime: 1.555577
train_loss: 0.134459
valid_loss: 1.121266
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00188202653672583
Epoch-6 lr: 0.00188202653672583
epoch 6 training time: 6.826
---------------
2023-09-12 12:09:57.168637
current #epochs=7, #steps=48
start validation
acc: 0.636364
AUC: 0.862259
Avg Precision: 0.408915
Avg Recall: 1.000000
d_prime: 1.542235
train_loss: 0.147324
valid_loss: 1.109601
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0012634379216518925
Epoch-7 lr: 0.0012634379216518925
epoch 7 training time: 6.361
---------------
2023-09-12 12:10:03.530166
current #epochs=8, #steps=56
start validation
acc: 0.636364
AUC: 0.856749
Avg Precision: 0.401376
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.123762
valid_loss: 1.108477
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0012634379216518925
Epoch-8 lr: 0.0012634379216518925
epoch 8 training time: 6.288
---------------
2023-09-12 12:10:09.818362
current #epochs=9, #steps=64
start validation
acc: 0.659091
AUC: 0.847796
Avg Precision: 0.417086
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.154545
valid_loss: 1.122150
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0012634379216518925
Epoch-9 lr: 0.0012634379216518925
epoch 9 training time: 6.377
---------------
2023-09-12 12:10:16.195190
current #epochs=10, #steps=72
start validation
acc: 0.613636
AUC: 0.847796
Avg Precision: 0.410608
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.123302
valid_loss: 1.120118
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0008481683710183497
Epoch-10 lr: 0.0008481683710183497
epoch 10 training time: 6.746
---------------
2023-09-12 12:10:22.940745
current #epochs=11, #steps=80
start validation
acc: 0.613636
AUC: 0.855372
Avg Precision: 0.416512
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.116359
valid_loss: 1.114549
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0008481683710183497
Epoch-11 lr: 0.0008481683710183497
epoch 11 training time: 7.041
---------------
2023-09-12 12:10:29.981639
current #epochs=12, #steps=88
start validation
acc: 0.613636
AUC: 0.853994
Avg Precision: 0.416394
Avg Recall: 1.000000
d_prime: 1.490185
train_loss: 0.120259
valid_loss: 1.109891
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0008481683710183497
Epoch-12 lr: 0.0008481683710183497
epoch 12 training time: 6.241
---------------
2023-09-12 12:10:36.222537
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01165	Per Sample Data Time 0.00620	Per Sample DNN Time 0.00544	Train Loss 0.0876	
start validation
acc: 0.681818
AUC: 0.857438
Avg Precision: 0.443419
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.087952
valid_loss: 1.097814
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0005693905282305829
Epoch-13 lr: 0.0005693905282305829
epoch 13 training time: 6.354
---------------
2023-09-12 12:10:42.576694
current #epochs=14, #steps=104
start validation
acc: 0.681818
AUC: 0.857438
Avg Precision: 0.438081
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.106960
valid_loss: 1.092381
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0005693905282305829
Epoch-14 lr: 0.0005693905282305829
epoch 14 training time: 6.314
---------------
2023-09-12 12:10:48.890331
current #epochs=15, #steps=112
start validation
acc: 0.681818
AUC: 0.856749
Avg Precision: 0.440476
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.116699
valid_loss: 1.093257
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0005693905282305829
Epoch-15 lr: 0.0005693905282305829
epoch 15 training time: 6.639
---------------
2023-09-12 12:10:55.529071
current #epochs=16, #steps=120
start validation
acc: 0.681818
AUC: 0.858127
Avg Precision: 0.440476
Avg Recall: 1.000000
d_prime: 1.515953
train_loss: 0.097978
valid_loss: 1.094122
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0003822419990142361
Epoch-16 lr: 0.0003822419990142361
epoch 16 training time: 6.387
---------------
2023-09-12 12:11:01.916446
current #epochs=17, #steps=128
start validation
acc: 0.704545
AUC: 0.864325
Avg Precision: 0.448994
Avg Recall: 1.000000
d_prime: 1.555577
train_loss: 0.087476
valid_loss: 1.091542
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0003822419990142361
Epoch-17 lr: 0.0003822419990142361
epoch 17 training time: 8.332
---------------
2023-09-12 12:11:10.248559
current #epochs=18, #steps=136
start validation
acc: 0.681818
AUC: 0.865014
Avg Precision: 0.451058
Avg Recall: 1.000000
d_prime: 1.560056
train_loss: 0.089424
valid_loss: 1.091002
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0003822419990142361
Epoch-18 lr: 0.0003822419990142361
epoch 18 training time: 7.077
---------------
2023-09-12 12:11:17.325954
current #epochs=19, #steps=144
start validation
acc: 0.681818
AUC: 0.862259
Avg Precision: 0.449603
Avg Recall: 1.000000
d_prime: 1.542235
train_loss: 0.070081
valid_loss: 1.090825
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00025660585936412053
Epoch-19 lr: 0.00025660585936412053
epoch 19 training time: 6.370
---------------
2023-09-12 12:11:23.695983
current #epochs=20, #steps=152
start validation
acc: 0.681818
AUC: 0.864325
Avg Precision: 0.449603
Avg Recall: 1.000000
d_prime: 1.555577
train_loss: 0.075961
valid_loss: 1.089782
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00025660585936412053
Epoch-20 lr: 0.00025660585936412053
epoch 20 training time: 8.708
---------------
2023-09-12 12:11:32.403805
current #epochs=21, #steps=160
start validation
acc: 0.681818
AUC: 0.865702
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.564550
train_loss: 0.058569
valid_loss: 1.090049
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00025660585936412053
Epoch-21 lr: 0.00025660585936412053
epoch 21 training time: 6.473
---------------
2023-09-12 12:11:38.876828
current #epochs=22, #steps=168
start validation
acc: 0.704545
AUC: 0.863636
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.551114
train_loss: 0.108074
valid_loss: 1.090005
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00017226408199468013
Epoch-22 lr: 0.00017226408199468013
epoch 22 training time: 7.217
---------------
2023-09-12 12:11:46.094207
current #epochs=23, #steps=176
start validation
acc: 0.704545
AUC: 0.865014
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.560056
train_loss: 0.068105
valid_loss: 1.089921
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00017226408199468013
Epoch-23 lr: 0.00017226408199468013
epoch 23 training time: 6.379
---------------
2023-09-12 12:11:52.472994
current #epochs=24, #steps=184
start validation
acc: 0.704545
AUC: 0.865702
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.564550
train_loss: 0.063191
valid_loss: 1.089237
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00017226408199468013
Epoch-24 lr: 0.00017226408199468013
epoch 24 training time: 7.958
---------------
2023-09-12 12:12:00.430871
current #epochs=25, #steps=192
start validation
acc: 0.704545
AUC: 0.867080
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.573586
train_loss: 0.094997
valid_loss: 1.089139
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0001156439452279285
Epoch-25 lr: 0.0001156439452279285
epoch 25 training time: 6.403
---------------
2023-09-12 12:12:06.833588
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03472	Per Sample Data Time 0.02921	Per Sample DNN Time 0.00551	Train Loss 0.0693	
start validation
acc: 0.704545
AUC: 0.867080
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.573586
train_loss: 0.114370
valid_loss: 1.089254
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0001156439452279285
Epoch-26 lr: 0.0001156439452279285
epoch 26 training time: 7.679
---------------
2023-09-12 12:12:14.513057
current #epochs=27, #steps=208
start validation
acc: 0.704545
AUC: 0.866391
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.569060
train_loss: 0.057512
valid_loss: 1.090147
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0001156439452279285
Epoch-27 lr: 0.0001156439452279285
epoch 27 training time: 6.278
---------------
2023-09-12 12:12:20.791056
current #epochs=28, #steps=216
start validation
acc: 0.704545
AUC: 0.864325
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.555577
train_loss: 0.130761
valid_loss: 1.090209
validation finished
normal learning rate scheduler step
Epoch-28 lr: 7.76338393530761e-05
Epoch-28 lr: 7.76338393530761e-05
epoch 28 training time: 6.508
---------------
2023-09-12 12:12:27.299451
current #epochs=29, #steps=224
start validation
acc: 0.704545
AUC: 0.865014
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.560056
train_loss: 0.104075
valid_loss: 1.089763
validation finished
normal learning rate scheduler step
Epoch-29 lr: 7.76338393530761e-05
Epoch-29 lr: 7.76338393530761e-05
epoch 29 training time: 6.267
---------------
2023-09-12 12:12:33.565903
current #epochs=30, #steps=232
start validation
acc: 0.704545
AUC: 0.862259
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.542235
train_loss: 0.061468
valid_loss: 1.089649
validation finished
normal learning rate scheduler step
Epoch-30 lr: 7.76338393530761e-05
Epoch-30 lr: 7.76338393530761e-05
epoch 30 training time: 6.315
---------------
2023-09-12 12:12:39.881114
current #epochs=31, #steps=240
start validation
acc: 0.704545
AUC: 0.862259
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.542235
train_loss: 0.094314
valid_loss: 1.089354
validation finished
normal learning rate scheduler step
Epoch-31 lr: 5.211697854842537e-05
Epoch-31 lr: 5.211697854842537e-05
epoch 31 training time: 6.226
---------------
2023-09-12 12:12:46.107429
current #epochs=32, #steps=248
start validation
acc: 0.704545
AUC: 0.860882
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.533415
train_loss: 0.065260
valid_loss: 1.089105
validation finished
normal learning rate scheduler step
Epoch-32 lr: 5.211697854842537e-05
Epoch-32 lr: 5.211697854842537e-05
epoch 32 training time: 6.256
---------------
2023-09-12 12:12:52.363699
current #epochs=33, #steps=256
start validation
acc: 0.704545
AUC: 0.860193
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.529028
train_loss: 0.082424
valid_loss: 1.088838
validation finished
normal learning rate scheduler step
Epoch-33 lr: 5.211697854842537e-05
Epoch-33 lr: 5.211697854842537e-05
epoch 33 training time: 6.265
---------------
2023-09-12 12:12:58.629137
current #epochs=34, #steps=264
start validation
acc: 0.704545
AUC: 0.860193
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.529028
train_loss: 0.105757
valid_loss: 1.088918
validation finished
normal learning rate scheduler step
Epoch-34 lr: 3.498705558878696e-05
Epoch-34 lr: 3.498705558878696e-05
epoch 34 training time: 8.611
---------------
2023-09-12 12:13:07.240553
current #epochs=35, #steps=272
start validation
acc: 0.704545
AUC: 0.860193
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.529028
train_loss: 0.138133
valid_loss: 1.089111
validation finished
normal learning rate scheduler step
Epoch-35 lr: 3.498705558878696e-05
Epoch-35 lr: 3.498705558878696e-05
epoch 35 training time: 6.367
---------------
2023-09-12 12:13:13.607577
current #epochs=36, #steps=280
start validation
acc: 0.704545
AUC: 0.858815
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.098909
valid_loss: 1.089164
validation finished
normal learning rate scheduler step
Epoch-36 lr: 3.498705558878696e-05
Epoch-36 lr: 3.498705558878696e-05
epoch 36 training time: 6.426
---------------
2023-09-12 12:13:20.033828
current #epochs=37, #steps=288
start validation
acc: 0.704545
AUC: 0.859504
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.061177
valid_loss: 1.089041
validation finished
normal learning rate scheduler step
Epoch-37 lr: 2.348743332531223e-05
Epoch-37 lr: 2.348743332531223e-05
epoch 37 training time: 6.324
---------------
2023-09-12 12:13:26.357671
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01172	Per Sample Data Time 0.00589	Per Sample DNN Time 0.00583	Train Loss 0.0608	
start validation
acc: 0.704545
AUC: 0.859504
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.087343
valid_loss: 1.089026
validation finished
normal learning rate scheduler step
Epoch-38 lr: 2.348743332531223e-05
Epoch-38 lr: 2.348743332531223e-05
epoch 38 training time: 6.300
---------------
2023-09-12 12:13:32.657236
current #epochs=39, #steps=304
start validation
acc: 0.704545
AUC: 0.860193
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.529028
train_loss: 0.091018
valid_loss: 1.088883
validation finished
normal learning rate scheduler step
Epoch-39 lr: 2.348743332531223e-05
Epoch-39 lr: 2.348743332531223e-05
epoch 39 training time: 6.248
---------------
2023-09-12 12:13:38.905133
current #epochs=40, #steps=312
start validation
acc: 0.704545
AUC: 0.859504
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.117109
valid_loss: 1.088820
validation finished
normal learning rate scheduler step
Epoch-40 lr: 1.576753216088837e-05
Epoch-40 lr: 1.576753216088837e-05
epoch 40 training time: 6.303
---------------
2023-09-12 12:13:45.208352
current #epochs=41, #steps=320
start validation
acc: 0.704545
AUC: 0.859504
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.087309
valid_loss: 1.088833
validation finished
normal learning rate scheduler step
Epoch-41 lr: 1.576753216088837e-05
Epoch-41 lr: 1.576753216088837e-05
epoch 41 training time: 6.397
---------------
2023-09-12 12:13:51.605227
current #epochs=42, #steps=328
start validation
acc: 0.704545
AUC: 0.859504
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.077052
valid_loss: 1.088880
validation finished
normal learning rate scheduler step
Epoch-42 lr: 1.576753216088837e-05
Epoch-42 lr: 1.576753216088837e-05
epoch 42 training time: 6.495
---------------
2023-09-12 12:13:58.100581
current #epochs=43, #steps=336
start validation
acc: 0.704545
AUC: 0.860193
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.529028
train_loss: 0.071603
valid_loss: 1.088899
validation finished
normal learning rate scheduler step
Epoch-43 lr: 1.0585025064306133e-05
Epoch-43 lr: 1.0585025064306133e-05
epoch 43 training time: 6.364
---------------
2023-09-12 12:14:04.464157
current #epochs=44, #steps=344
start validation
acc: 0.704545
AUC: 0.860193
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.529028
train_loss: 0.062692
valid_loss: 1.088892
validation finished
normal learning rate scheduler step
Epoch-44 lr: 1.0585025064306133e-05
Epoch-44 lr: 1.0585025064306133e-05
epoch 44 training time: 6.175
---------------
2023-09-12 12:14:10.638962
current #epochs=45, #steps=352
start validation
acc: 0.704545
AUC: 0.860193
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.529028
train_loss: 0.088187
valid_loss: 1.088895
validation finished
normal learning rate scheduler step
Epoch-45 lr: 1.0585025064306133e-05
Epoch-45 lr: 1.0585025064306133e-05
epoch 45 training time: 6.262
---------------
2023-09-12 12:14:16.901211
current #epochs=46, #steps=360
start validation
acc: 0.704545
AUC: 0.859504
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.109347
valid_loss: 1.088995
validation finished
normal learning rate scheduler step
Epoch-46 lr: 7.105915781159019e-06
Epoch-46 lr: 7.105915781159019e-06
epoch 46 training time: 8.050
---------------
2023-09-12 12:14:24.951033
current #epochs=47, #steps=368
start validation
acc: 0.704545
AUC: 0.859504
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.095255
valid_loss: 1.089035
validation finished
normal learning rate scheduler step
Epoch-47 lr: 7.105915781159019e-06
Epoch-47 lr: 7.105915781159019e-06
epoch 47 training time: 6.354
---------------
2023-09-12 12:14:31.305256
current #epochs=48, #steps=376
start validation
acc: 0.704545
AUC: 0.859504
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.059892
valid_loss: 1.089099
validation finished
normal learning rate scheduler step
Epoch-48 lr: 7.105915781159019e-06
Epoch-48 lr: 7.105915781159019e-06
epoch 48 training time: 6.369
---------------
2023-09-12 12:14:37.674472
current #epochs=49, #steps=384
start validation
[I 2023-09-12 12:14:44,005] Trial 90 finished with value: 0.7045454545454546 and parameters: {'warmup': 'False', 'num_epochs': 49, 'batch_size': 21, 'lr-adaptschedule': 'True', 'lr': 0.0028034807442768326, 'head-lr': 1, 'lr-scheduler-start': 4, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.6713178039720423}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.704545
AUC: 0.859504
Avg Precision: 0.451786
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.096489
valid_loss: 1.089192
validation finished
normal learning rate scheduler step
Epoch-49 lr: 4.7703277774179525e-06
Epoch-49 lr: 4.7703277774179525e-06
epoch 49 training time: 6.325
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8dd5d30>
The learning rate scheduler starts at 6 epoch with decay rate of 0.648 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 12:14:44.045180
current #epochs=1, #steps=0
start validation
acc: 0.704545
AUC: 0.896006
Avg Precision: 0.509259
Avg Recall: 1.000000
d_prime: 1.780657
train_loss: 0.162750
valid_loss: 1.090064
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0026928227860666923
Epoch-1 lr: 0.0026928227860666923
epoch 1 training time: 8.880
---------------
2023-09-12 12:14:52.924956
current #epochs=2, #steps=8
start validation
acc: 0.704545
AUC: 0.874656
Avg Precision: 0.474702
Avg Recall: 1.000000
d_prime: 1.624476
train_loss: 0.148694
valid_loss: 1.087438
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0026928227860666923
Epoch-2 lr: 0.0026928227860666923
epoch 2 training time: 6.323
---------------
2023-09-12 12:14:59.248272
current #epochs=3, #steps=16
start validation
acc: 0.704545
AUC: 0.845730
Avg Precision: 0.388620
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.190739
valid_loss: 1.113572
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0026928227860666923
Epoch-3 lr: 0.0026928227860666923
epoch 3 training time: 6.227
---------------
2023-09-12 12:15:05.475028
current #epochs=4, #steps=24
start validation
acc: 0.681818
AUC: 0.826446
Avg Precision: 0.361726
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.130875
valid_loss: 1.141288
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0026928227860666923
Epoch-4 lr: 0.0026928227860666923
epoch 4 training time: 7.662
---------------
2023-09-12 12:15:13.136662
current #epochs=5, #steps=32
start validation
acc: 0.681818
AUC: 0.838154
Avg Precision: 0.395773
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.149004
valid_loss: 1.134692
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0026928227860666923
Epoch-5 lr: 0.0026928227860666923
epoch 5 training time: 7.704
---------------
2023-09-12 12:15:20.841312
current #epochs=6, #steps=40
start validation
acc: 0.704545
AUC: 0.848485
Avg Precision: 0.405797
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.173127
valid_loss: 1.103484
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.001743805026804912
Epoch-6 lr: 0.001743805026804912
epoch 6 training time: 6.377
---------------
2023-09-12 12:15:27.217951
current #epochs=7, #steps=48
start validation
acc: 0.659091
AUC: 0.832645
Avg Precision: 0.384037
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.122518
valid_loss: 1.117054
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.001743805026804912
Epoch-7 lr: 0.001743805026804912
epoch 7 training time: 6.334
---------------
2023-09-12 12:15:33.551723
current #epochs=8, #steps=56
start validation
acc: 0.636364
AUC: 0.845730
Avg Precision: 0.417799
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.115106
valid_loss: 1.114675
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001743805026804912
Epoch-8 lr: 0.001743805026804912
epoch 8 training time: 6.294
---------------
2023-09-12 12:15:39.846098
current #epochs=9, #steps=64
start validation
acc: 0.681818
AUC: 0.855372
Avg Precision: 0.437442
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.136461
valid_loss: 1.113520
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001743805026804912
Epoch-9 lr: 0.001743805026804912
epoch 9 training time: 6.984
---------------
2023-09-12 12:15:46.829774
current #epochs=10, #steps=72
start validation
acc: 0.681818
AUC: 0.850551
Avg Precision: 0.419113
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.107592
valid_loss: 1.117579
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001743805026804912
Epoch-10 lr: 0.001743805026804912
epoch 10 training time: 6.366
---------------
2023-09-12 12:15:53.196049
current #epochs=11, #steps=80
start validation
acc: 0.659091
AUC: 0.849174
Avg Precision: 0.372109
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.125407
valid_loss: 1.115611
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001129244741705319
Epoch-11 lr: 0.001129244741705319
epoch 11 training time: 6.334
---------------
2023-09-12 12:15:59.529727
current #epochs=12, #steps=88
start validation
acc: 0.659091
AUC: 0.847796
Avg Precision: 0.365208
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.133753
valid_loss: 1.113922
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001129244741705319
Epoch-12 lr: 0.001129244741705319
epoch 12 training time: 7.638
---------------
2023-09-12 12:16:07.167846
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01167	Per Sample Data Time 0.00606	Per Sample DNN Time 0.00560	Train Loss 0.1058	
start validation
acc: 0.659091
AUC: 0.844353
Avg Precision: 0.367187
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.102245
valid_loss: 1.114011
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.001129244741705319
Epoch-13 lr: 0.001129244741705319
epoch 13 training time: 6.673
---------------
2023-09-12 12:16:13.840579
current #epochs=14, #steps=104
start validation
acc: 0.681818
AUC: 0.853994
Avg Precision: 0.369718
Avg Recall: 1.000000
d_prime: 1.490185
train_loss: 0.099804
valid_loss: 1.108246
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.001129244741705319
Epoch-14 lr: 0.001129244741705319
epoch 14 training time: 7.350
---------------
2023-09-12 12:16:21.190864
current #epochs=15, #steps=112
start validation
acc: 0.681818
AUC: 0.857438
Avg Precision: 0.372169
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.075299
valid_loss: 1.104083
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.001129244741705319
Epoch-15 lr: 0.001129244741705319
epoch 15 training time: 6.329
---------------
2023-09-12 12:16:27.520178
current #epochs=16, #steps=120
start validation
acc: 0.704545
AUC: 0.863636
Avg Precision: 0.395481
Avg Recall: 1.000000
d_prime: 1.551114
train_loss: 0.103333
valid_loss: 1.093702
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0007312707940781587
Epoch-16 lr: 0.0007312707940781587
epoch 16 training time: 6.296
---------------
2023-09-12 12:16:33.815714
current #epochs=17, #steps=128
start validation
acc: 0.704545
AUC: 0.870523
Avg Precision: 0.406975
Avg Recall: 1.000000
d_prime: 1.596462
train_loss: 0.101318
valid_loss: 1.086447
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0007312707940781587
Epoch-17 lr: 0.0007312707940781587
epoch 17 training time: 7.624
---------------
2023-09-12 12:16:41.439849
current #epochs=18, #steps=136
start validation
acc: 0.704545
AUC: 0.869835
Avg Precision: 0.401042
Avg Recall: 1.000000
d_prime: 1.591853
train_loss: 0.104220
valid_loss: 1.084212
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0007312707940781587
Epoch-18 lr: 0.0007312707940781587
epoch 18 training time: 6.369
---------------
2023-09-12 12:16:47.809047
current #epochs=19, #steps=144
start validation
acc: 0.727273
AUC: 0.865014
Avg Precision: 0.401042
Avg Recall: 1.000000
d_prime: 1.560056
train_loss: 0.093612
valid_loss: 1.085405
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0007312707940781587
Epoch-19 lr: 0.0007312707940781587
epoch 19 training time: 10.293
---------------
2023-09-12 12:16:58.101792
current #epochs=20, #steps=152
start validation
acc: 0.704545
AUC: 0.858815
Avg Precision: 0.398085
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.076725
valid_loss: 1.087223
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0007312707940781587
Epoch-20 lr: 0.0007312707940781587
epoch 20 training time: 6.352
---------------
2023-09-12 12:17:04.454192
current #epochs=21, #steps=160
start validation
acc: 0.704545
AUC: 0.860193
Avg Precision: 0.400266
Avg Recall: 1.000000
d_prime: 1.529028
train_loss: 0.084801
valid_loss: 1.091246
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00047355276896321187
Epoch-21 lr: 0.00047355276896321187
epoch 21 training time: 6.400
---------------
2023-09-12 12:17:10.854221
current #epochs=22, #steps=168
start validation
acc: 0.681818
AUC: 0.857438
Avg Precision: 0.420251
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.100145
valid_loss: 1.092394
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00047355276896321187
Epoch-22 lr: 0.00047355276896321187
epoch 22 training time: 6.293
---------------
2023-09-12 12:17:17.146944
current #epochs=23, #steps=176
start validation
acc: 0.727273
AUC: 0.858815
Avg Precision: 0.420251
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.106802
valid_loss: 1.090196
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00047355276896321187
Epoch-23 lr: 0.00047355276896321187
epoch 23 training time: 6.279
---------------
2023-09-12 12:17:23.426243
current #epochs=24, #steps=184
start validation
acc: 0.727273
AUC: 0.860882
Avg Precision: 0.427757
Avg Recall: 1.000000
d_prime: 1.533415
train_loss: 0.116983
valid_loss: 1.089816
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00047355276896321187
Epoch-24 lr: 0.00047355276896321187
epoch 24 training time: 6.221
---------------
2023-09-12 12:17:29.647313
current #epochs=25, #steps=192
start validation
acc: 0.704545
AUC: 0.858815
Avg Precision: 0.439252
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.097825
valid_loss: 1.095645
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00047355276896321187
Epoch-25 lr: 0.00047355276896321187
epoch 25 training time: 6.216
---------------
2023-09-12 12:17:35.863694
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03533	Per Sample Data Time 0.02975	Per Sample DNN Time 0.00558	Train Loss 0.0326	
start validation
acc: 0.727273
AUC: 0.858127
Avg Precision: 0.463805
Avg Recall: 1.000000
d_prime: 1.515953
train_loss: 0.094969
valid_loss: 1.100297
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00030666098907370954
Epoch-26 lr: 0.00030666098907370954
epoch 26 training time: 6.279
---------------
2023-09-12 12:17:42.142527
current #epochs=27, #steps=208
start validation
acc: 0.704545
AUC: 0.849174
Avg Precision: 0.438863
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.098808
valid_loss: 1.104508
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00030666098907370954
Epoch-27 lr: 0.00030666098907370954
epoch 27 training time: 8.711
---------------
2023-09-12 12:17:50.853947
current #epochs=28, #steps=216
start validation
acc: 0.681818
AUC: 0.846419
Avg Precision: 0.441635
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.061642
valid_loss: 1.107895
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00030666098907370954
Epoch-28 lr: 0.00030666098907370954
epoch 28 training time: 8.561
---------------
2023-09-12 12:17:59.415102
current #epochs=29, #steps=224
start validation
acc: 0.681818
AUC: 0.845730
Avg Precision: 0.441635
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.087768
valid_loss: 1.108345
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00030666098907370954
Epoch-29 lr: 0.00030666098907370954
epoch 29 training time: 6.479
---------------
2023-09-12 12:18:05.894147
current #epochs=30, #steps=232
start validation
acc: 0.681818
AUC: 0.845730
Avg Precision: 0.427757
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.061412
valid_loss: 1.107772
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00030666098907370954
Epoch-30 lr: 0.00030666098907370954
epoch 30 training time: 6.354
---------------
2023-09-12 12:18:12.247437
current #epochs=31, #steps=240
start validation
acc: 0.681818
AUC: 0.846419
Avg Precision: 0.417647
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.108073
valid_loss: 1.105374
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.00019858602542976875
Epoch-31 lr: 0.00019858602542976875
epoch 31 training time: 9.712
---------------
2023-09-12 12:18:21.959961
current #epochs=32, #steps=248
start validation
acc: 0.681818
AUC: 0.848485
Avg Precision: 0.417647
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.055712
valid_loss: 1.103832
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00019858602542976875
Epoch-32 lr: 0.00019858602542976875
epoch 32 training time: 6.244
---------------
2023-09-12 12:18:28.203750
current #epochs=33, #steps=256
start validation
acc: 0.681818
AUC: 0.849862
Avg Precision: 0.417647
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.076456
valid_loss: 1.103253
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.00019858602542976875
Epoch-33 lr: 0.00019858602542976875
epoch 33 training time: 6.377
---------------
2023-09-12 12:18:34.580446
current #epochs=34, #steps=264
start validation
acc: 0.681818
AUC: 0.853306
Avg Precision: 0.420808
Avg Recall: 1.000000
d_prime: 1.485939
train_loss: 0.059057
valid_loss: 1.101722
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.00019858602542976875
Epoch-34 lr: 0.00019858602542976875
epoch 34 training time: 6.360
---------------
2023-09-12 12:18:40.940879
current #epochs=35, #steps=272
start validation
acc: 0.704545
AUC: 0.853306
Avg Precision: 0.430918
Avg Recall: 1.000000
d_prime: 1.485939
train_loss: 0.100478
valid_loss: 1.099596
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.00019858602542976875
Epoch-35 lr: 0.00019858602542976875
epoch 35 training time: 8.521
---------------
2023-09-12 12:18:49.461596
current #epochs=36, #steps=280
start validation
acc: 0.681818
AUC: 0.853306
Avg Precision: 0.433522
Avg Recall: 1.000000
d_prime: 1.485939
train_loss: 0.071982
valid_loss: 1.098067
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0001285993683615028
Epoch-36 lr: 0.0001285993683615028
epoch 36 training time: 6.499
---------------
2023-09-12 12:18:55.960873
current #epochs=37, #steps=288
start validation
acc: 0.681818
AUC: 0.853306
Avg Precision: 0.433522
Avg Recall: 1.000000
d_prime: 1.485939
train_loss: 0.085944
valid_loss: 1.097636
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0001285993683615028
Epoch-37 lr: 0.0001285993683615028
epoch 37 training time: 8.486
---------------
2023-09-12 12:19:04.446760
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01144	Per Sample Data Time 0.00600	Per Sample DNN Time 0.00544	Train Loss 0.1125	
start validation
acc: 0.681818
AUC: 0.853994
Avg Precision: 0.439360
Avg Recall: 1.000000
d_prime: 1.490185
train_loss: 0.095160
valid_loss: 1.096729
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0001285993683615028
Epoch-38 lr: 0.0001285993683615028
epoch 38 training time: 6.256
---------------
2023-09-12 12:19:10.702853
current #epochs=39, #steps=304
start validation
acc: 0.704545
AUC: 0.855372
Avg Precision: 0.441964
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.077560
valid_loss: 1.095272
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0001285993683615028
Epoch-39 lr: 0.0001285993683615028
epoch 39 training time: 9.072
---------------
2023-09-12 12:19:19.775167
current #epochs=40, #steps=312
start validation
acc: 0.704545
AUC: 0.855372
Avg Precision: 0.441964
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.050549
valid_loss: 1.093981
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0001285993683615028
Epoch-40 lr: 0.0001285993683615028
epoch 40 training time: 6.259
---------------
2023-09-12 12:19:26.034048
current #epochs=41, #steps=320
start validation
acc: 0.704545
AUC: 0.856061
Avg Precision: 0.444736
Avg Recall: 1.000000
d_prime: 1.503007
train_loss: 0.070112
valid_loss: 1.093279
validation finished
normal learning rate scheduler step
Epoch-41 lr: 8.327775082454727e-05
Epoch-41 lr: 8.327775082454727e-05
epoch 41 training time: 6.345
---------------
2023-09-12 12:19:32.378847
current #epochs=42, #steps=328
start validation
acc: 0.704545
AUC: 0.857438
Avg Precision: 0.444736
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.098760
valid_loss: 1.093242
validation finished
normal learning rate scheduler step
Epoch-42 lr: 8.327775082454727e-05
Epoch-42 lr: 8.327775082454727e-05
epoch 42 training time: 6.426
---------------
2023-09-12 12:19:38.805002
current #epochs=43, #steps=336
start validation
acc: 0.704545
AUC: 0.857438
Avg Precision: 0.444736
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.086088
valid_loss: 1.093209
validation finished
normal learning rate scheduler step
Epoch-43 lr: 8.327775082454727e-05
Epoch-43 lr: 8.327775082454727e-05
epoch 43 training time: 7.682
---------------
2023-09-12 12:19:46.487616
current #epochs=44, #steps=344
start validation
acc: 0.704545
AUC: 0.857438
Avg Precision: 0.444736
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.094582
valid_loss: 1.093236
validation finished
normal learning rate scheduler step
Epoch-44 lr: 8.327775082454727e-05
Epoch-44 lr: 8.327775082454727e-05
epoch 44 training time: 6.307
---------------
2023-09-12 12:19:52.794537
current #epochs=45, #steps=352
start validation
acc: 0.704545
AUC: 0.857438
Avg Precision: 0.444736
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.055263
valid_loss: 1.093400
validation finished
normal learning rate scheduler step
Epoch-45 lr: 8.327775082454727e-05
Epoch-45 lr: 8.327775082454727e-05
epoch 45 training time: 6.428
---------------
2023-09-12 12:19:59.222345
current #epochs=46, #steps=360
start validation
[I 2023-09-12 12:20:05,598] Trial 91 finished with value: 0.7272727272727273 and parameters: {'warmup': 'False', 'num_epochs': 46, 'batch_size': 13, 'lr-adaptschedule': 'True', 'lr': 0.0026928227860666923, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.6475751155359258}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.704545
AUC: 0.857438
Avg Precision: 0.444736
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.169607
valid_loss: 1.092930
validation finished
normal learning rate scheduler step
Epoch-46 lr: 5.3928599111778237e-05
Epoch-46 lr: 5.3928599111778237e-05
epoch 46 training time: 6.370
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8dd5250>
The learning rate scheduler starts at 7 epoch with decay rate of 0.650 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 12:20:05.641471
current #epochs=1, #steps=0
start validation
acc: 0.659091
AUC: 0.868457
Avg Precision: 0.413514
Avg Recall: 1.000000
d_prime: 1.582686
train_loss: 0.142690
valid_loss: 1.085941
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0026074426222685793
Epoch-1 lr: 0.0026074426222685793
epoch 1 training time: 8.840
---------------
2023-09-12 12:20:14.481617
current #epochs=2, #steps=8
start validation
acc: 0.613636
AUC: 0.811983
Avg Precision: 0.328568
Avg Recall: 1.000000
d_prime: 1.251903
train_loss: 0.148493
valid_loss: 1.124529
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0026074426222685793
Epoch-2 lr: 0.0026074426222685793
epoch 2 training time: 8.192
---------------
2023-09-12 12:20:22.673390
current #epochs=3, #steps=16
start validation
acc: 0.636364
AUC: 0.821625
Avg Precision: 0.374033
Avg Recall: 1.000000
d_prime: 1.303307
train_loss: 0.171901
valid_loss: 1.134297
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0026074426222685793
Epoch-3 lr: 0.0026074426222685793
epoch 3 training time: 7.251
---------------
2023-09-12 12:20:29.924185
current #epochs=4, #steps=24
start validation
acc: 0.659091
AUC: 0.838154
Avg Precision: 0.374713
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.090822
valid_loss: 1.141167
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0026074426222685793
Epoch-4 lr: 0.0026074426222685793
epoch 4 training time: 6.360
---------------
2023-09-12 12:20:36.284484
current #epochs=5, #steps=32
start validation
acc: 0.613636
AUC: 0.842287
Avg Precision: 0.382861
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.166631
valid_loss: 1.127844
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0026074426222685793
Epoch-5 lr: 0.0026074426222685793
epoch 5 training time: 6.357
---------------
2023-09-12 12:20:42.641051
current #epochs=6, #steps=40
start validation
acc: 0.636364
AUC: 0.816116
Avg Precision: 0.360529
Avg Recall: 1.000000
d_prime: 1.273727
train_loss: 0.115783
valid_loss: 1.140765
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0026074426222685793
Epoch-6 lr: 0.0026074426222685793
epoch 6 training time: 6.227
---------------
2023-09-12 12:20:48.867980
current #epochs=7, #steps=48
start validation
acc: 0.613636
AUC: 0.807163
Avg Precision: 0.354337
Avg Recall: 1.000000
d_prime: 1.226813
train_loss: 0.143159
valid_loss: 1.150556
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0016957261346788142
Epoch-7 lr: 0.0016957261346788142
epoch 7 training time: 6.371
---------------
2023-09-12 12:20:55.238944
current #epochs=8, #steps=56
start validation
acc: 0.568182
AUC: 0.809229
Avg Precision: 0.358584
Avg Recall: 1.000000
d_prime: 1.237518
train_loss: 0.121028
valid_loss: 1.150004
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0016957261346788142
Epoch-8 lr: 0.0016957261346788142
epoch 8 training time: 6.699
---------------
2023-09-12 12:21:01.938069
current #epochs=9, #steps=64
start validation
acc: 0.613636
AUC: 0.814050
Avg Precision: 0.355794
Avg Recall: 1.000000
d_prime: 1.262777
train_loss: 0.189561
valid_loss: 1.147962
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0016957261346788142
Epoch-9 lr: 0.0016957261346788142
epoch 9 training time: 6.313
---------------
2023-09-12 12:21:08.251151
current #epochs=10, #steps=72
start validation
acc: 0.636364
AUC: 0.829890
Avg Precision: 0.387718
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.122452
valid_loss: 1.139262
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0016957261346788142
Epoch-10 lr: 0.0016957261346788142
epoch 10 training time: 6.344
---------------
2023-09-12 12:21:14.595362
current #epochs=11, #steps=80
start validation
acc: 0.636364
AUC: 0.841598
Avg Precision: 0.417098
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.113293
valid_loss: 1.131425
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0016957261346788142
Epoch-11 lr: 0.0016957261346788142
epoch 11 training time: 7.877
---------------
2023-09-12 12:21:22.472578
current #epochs=12, #steps=88
start validation
acc: 0.659091
AUC: 0.858815
Avg Precision: 0.434220
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.108928
valid_loss: 1.116177
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0011027997698875396
Epoch-12 lr: 0.0011027997698875396
epoch 12 training time: 6.333
---------------
2023-09-12 12:21:28.805443
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01157	Per Sample Data Time 0.00611	Per Sample DNN Time 0.00546	Train Loss 0.1136	
start validation
acc: 0.659091
AUC: 0.864325
Avg Precision: 0.443519
Avg Recall: 1.000000
d_prime: 1.555577
train_loss: 0.118624
valid_loss: 1.105958
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0011027997698875396
Epoch-13 lr: 0.0011027997698875396
epoch 13 training time: 6.223
---------------
2023-09-12 12:21:35.028902
current #epochs=14, #steps=104
start validation
acc: 0.659091
AUC: 0.865014
Avg Precision: 0.444036
Avg Recall: 1.000000
d_prime: 1.560056
train_loss: 0.101285
valid_loss: 1.097877
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0011027997698875396
Epoch-14 lr: 0.0011027997698875396
epoch 14 training time: 6.590
---------------
2023-09-12 12:21:41.619132
current #epochs=15, #steps=112
start validation
acc: 0.636364
AUC: 0.858815
Avg Precision: 0.457923
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.099591
valid_loss: 1.100214
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0011027997698875396
Epoch-15 lr: 0.0011027997698875396
epoch 15 training time: 6.349
---------------
2023-09-12 12:21:47.968443
current #epochs=16, #steps=120
start validation
acc: 0.659091
AUC: 0.855372
Avg Precision: 0.454103
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.120166
valid_loss: 1.101887
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0011027997698875396
Epoch-16 lr: 0.0011027997698875396
epoch 16 training time: 6.398
---------------
2023-09-12 12:21:54.366369
current #epochs=17, #steps=128
start validation
acc: 0.681818
AUC: 0.866391
Avg Precision: 0.466707
Avg Recall: 1.000000
d_prime: 1.569060
train_loss: 0.105247
valid_loss: 1.090512
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0007171956058189569
Epoch-17 lr: 0.0007171956058189569
epoch 17 training time: 10.554
---------------
2023-09-12 12:22:04.920839
current #epochs=18, #steps=136
start validation
acc: 0.659091
AUC: 0.867769
Avg Precision: 0.466707
Avg Recall: 1.000000
d_prime: 1.578128
train_loss: 0.138750
valid_loss: 1.090119
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0007171956058189569
Epoch-18 lr: 0.0007171956058189569
epoch 18 training time: 6.250
---------------
2023-09-12 12:22:11.171016
current #epochs=19, #steps=144
start validation
acc: 0.704545
AUC: 0.861570
Avg Precision: 0.455248
Avg Recall: 1.000000
d_prime: 1.537818
train_loss: 0.114905
valid_loss: 1.089590
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0007171956058189569
Epoch-19 lr: 0.0007171956058189569
epoch 19 training time: 9.085
---------------
2023-09-12 12:22:20.256478
current #epochs=20, #steps=152
start validation
acc: 0.636364
AUC: 0.852617
Avg Precision: 0.447693
Avg Recall: 1.000000
d_prime: 1.481705
train_loss: 0.086429
valid_loss: 1.102574
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0007171956058189569
Epoch-20 lr: 0.0007171956058189569
epoch 20 training time: 6.443
---------------
2023-09-12 12:22:26.699611
current #epochs=21, #steps=160
start validation
acc: 0.636364
AUC: 0.849862
Avg Precision: 0.451140
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.067130
valid_loss: 1.108589
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0007171956058189569
Epoch-21 lr: 0.0007171956058189569
epoch 21 training time: 6.299
---------------
2023-09-12 12:22:32.998773
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.853994
Avg Precision: 0.458926
Avg Recall: 1.000000
d_prime: 1.490185
train_loss: 0.082519
valid_loss: 1.098184
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.000466421512817757
Epoch-22 lr: 0.000466421512817757
epoch 22 training time: 6.388
---------------
2023-09-12 12:22:39.387217
current #epochs=23, #steps=176
start validation
acc: 0.659091
AUC: 0.856749
Avg Precision: 0.462313
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.092738
valid_loss: 1.093403
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.000466421512817757
Epoch-23 lr: 0.000466421512817757
epoch 23 training time: 7.249
---------------
2023-09-12 12:22:46.636026
current #epochs=24, #steps=184
start validation
acc: 0.659091
AUC: 0.865014
Avg Precision: 0.441777
Avg Recall: 1.000000
d_prime: 1.560056
train_loss: 0.143118
valid_loss: 1.088249
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.000466421512817757
Epoch-24 lr: 0.000466421512817757
epoch 24 training time: 6.224
---------------
2023-09-12 12:22:52.859960
current #epochs=25, #steps=192
start validation
acc: 0.681818
AUC: 0.866391
Avg Precision: 0.449082
Avg Recall: 1.000000
d_prime: 1.569060
train_loss: 0.117927
valid_loss: 1.087234
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.000466421512817757
Epoch-25 lr: 0.000466421512817757
epoch 25 training time: 6.328
---------------
2023-09-12 12:22:59.188103
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03410	Per Sample Data Time 0.02848	Per Sample DNN Time 0.00562	Train Loss 0.1080	
start validation
acc: 0.704545
AUC: 0.865014
Avg Precision: 0.454458
Avg Recall: 1.000000
d_prime: 1.560056
train_loss: 0.065805
valid_loss: 1.087741
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.000466421512817757
Epoch-26 lr: 0.000466421512817757
epoch 26 training time: 8.760
---------------
2023-09-12 12:23:07.948394
current #epochs=27, #steps=208
start validation
acc: 0.659091
AUC: 0.862259
Avg Precision: 0.460500
Avg Recall: 1.000000
d_prime: 1.542235
train_loss: 0.075924
valid_loss: 1.090235
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0003033329064680876
Epoch-27 lr: 0.0003033329064680876
epoch 27 training time: 9.800
---------------
2023-09-12 12:23:17.748840
current #epochs=28, #steps=216
start validation
acc: 0.659091
AUC: 0.862259
Avg Precision: 0.460500
Avg Recall: 1.000000
d_prime: 1.542235
train_loss: 0.090454
valid_loss: 1.092455
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0003033329064680876
Epoch-28 lr: 0.0003033329064680876
epoch 28 training time: 9.886
---------------
2023-09-12 12:23:27.634284
current #epochs=29, #steps=224
start validation
acc: 0.659091
AUC: 0.862948
Avg Precision: 0.460500
Avg Recall: 1.000000
d_prime: 1.546667
train_loss: 0.060311
valid_loss: 1.093535
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0003033329064680876
Epoch-29 lr: 0.0003033329064680876
epoch 29 training time: 6.901
---------------
2023-09-12 12:23:34.535933
current #epochs=30, #steps=232
start validation
acc: 0.659091
AUC: 0.862948
Avg Precision: 0.460500
Avg Recall: 1.000000
d_prime: 1.546667
train_loss: 0.051443
valid_loss: 1.094157
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0003033329064680876
Epoch-30 lr: 0.0003033329064680876
epoch 30 training time: 8.455
---------------
2023-09-12 12:23:42.991233
current #epochs=31, #steps=240
start validation
acc: 0.636364
AUC: 0.864325
Avg Precision: 0.470610
Avg Recall: 1.000000
d_prime: 1.555577
train_loss: 0.098757
valid_loss: 1.092862
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0003033329064680876
Epoch-31 lr: 0.0003033329064680876
epoch 31 training time: 7.157
---------------
2023-09-12 12:23:50.148692
current #epochs=32, #steps=248
start validation
acc: 0.636364
AUC: 0.866391
Avg Precision: 0.482068
Avg Recall: 1.000000
d_prime: 1.569060
train_loss: 0.079511
valid_loss: 1.091830
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00019726974339266513
Epoch-32 lr: 0.00019726974339266513
epoch 32 training time: 7.093
---------------
2023-09-12 12:23:57.241435
current #epochs=33, #steps=256
start validation
acc: 0.659091
AUC: 0.866391
Avg Precision: 0.482068
Avg Recall: 1.000000
d_prime: 1.569060
train_loss: 0.080208
valid_loss: 1.092644
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.00019726974339266513
Epoch-33 lr: 0.00019726974339266513
epoch 33 training time: 7.754
---------------
2023-09-12 12:24:04.995051
current #epochs=34, #steps=264
start validation
acc: 0.659091
AUC: 0.865014
Avg Precision: 0.466027
Avg Recall: 1.000000
d_prime: 1.560056
train_loss: 0.064376
valid_loss: 1.093605
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.00019726974339266513
Epoch-34 lr: 0.00019726974339266513
epoch 34 training time: 6.466
---------------
2023-09-12 12:24:11.461007
current #epochs=35, #steps=272
start validation
acc: 0.659091
AUC: 0.862948
Avg Precision: 0.466027
Avg Recall: 1.000000
d_prime: 1.546667
train_loss: 0.101580
valid_loss: 1.095973
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.00019726974339266513
Epoch-35 lr: 0.00019726974339266513
epoch 35 training time: 6.614
---------------
2023-09-12 12:24:18.074637
current #epochs=36, #steps=280
start validation
acc: 0.636364
AUC: 0.864325
Avg Precision: 0.461796
Avg Recall: 1.000000
d_prime: 1.555577
train_loss: 0.087630
valid_loss: 1.096532
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.00019726974339266513
Epoch-36 lr: 0.00019726974339266513
epoch 36 training time: 8.369
---------------
2023-09-12 12:24:26.443415
current #epochs=37, #steps=288
start validation
acc: 0.659091
AUC: 0.863636
Avg Precision: 0.457879
Avg Recall: 1.000000
d_prime: 1.551114
train_loss: 0.068589
valid_loss: 1.095613
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0001282925486434228
Epoch-37 lr: 0.0001282925486434228
epoch 37 training time: 6.302
---------------
2023-09-12 12:24:32.745540
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01167	Per Sample Data Time 0.00588	Per Sample DNN Time 0.00579	Train Loss 0.0651	
start validation
acc: 0.636364
AUC: 0.864325
Avg Precision: 0.461796
Avg Recall: 1.000000
d_prime: 1.555577
train_loss: 0.048895
valid_loss: 1.095066
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0001282925486434228
Epoch-38 lr: 0.0001282925486434228
epoch 38 training time: 7.357
---------------
2023-09-12 12:24:40.102375
current #epochs=39, #steps=304
start validation
acc: 0.636364
AUC: 0.863636
Avg Precision: 0.461796
Avg Recall: 1.000000
d_prime: 1.551114
train_loss: 0.065616
valid_loss: 1.094383
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0001282925486434228
Epoch-39 lr: 0.0001282925486434228
epoch 39 training time: 6.319
---------------
2023-09-12 12:24:46.421826
current #epochs=40, #steps=312
start validation
acc: 0.636364
AUC: 0.862948
Avg Precision: 0.451686
Avg Recall: 1.000000
d_prime: 1.546667
train_loss: 0.083217
valid_loss: 1.094013
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0001282925486434228
Epoch-40 lr: 0.0001282925486434228
epoch 40 training time: 6.758
---------------
2023-09-12 12:24:53.179896
current #epochs=41, #steps=320
start validation
acc: 0.613636
AUC: 0.865014
Avg Precision: 0.461796
Avg Recall: 1.000000
d_prime: 1.560056
train_loss: 0.035909
valid_loss: 1.094470
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0001282925486434228
Epoch-41 lr: 0.0001282925486434228
epoch 41 training time: 6.304
---------------
2023-09-12 12:24:59.484291
current #epochs=42, #steps=328
start validation
acc: 0.613636
AUC: 0.864325
Avg Precision: 0.461796
Avg Recall: 1.000000
d_prime: 1.555577
train_loss: 0.093731
valid_loss: 1.094955
validation finished
normal learning rate scheduler step
Epoch-42 lr: 8.343386955526898e-05
Epoch-42 lr: 8.343386955526898e-05
epoch 42 training time: 6.335
---------------
2023-09-12 12:25:05.819811
current #epochs=43, #steps=336
start validation
acc: 0.613636
AUC: 0.861570
Avg Precision: 0.459192
Avg Recall: 1.000000
d_prime: 1.537818
train_loss: 0.069493
valid_loss: 1.095510
validation finished
normal learning rate scheduler step
Epoch-43 lr: 8.343386955526898e-05
Epoch-43 lr: 8.343386955526898e-05
epoch 43 training time: 6.286
---------------
2023-09-12 12:25:12.105342
current #epochs=44, #steps=344
start validation
[I 2023-09-12 12:25:18,526] Trial 92 finished with value: 0.7045454545454546 and parameters: {'warmup': 'False', 'num_epochs': 44, 'batch_size': 12, 'lr-adaptschedule': 'True', 'lr': 0.0026074426222685793, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.650340728573143}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.613636
AUC: 0.860882
Avg Precision: 0.459192
Avg Recall: 1.000000
d_prime: 1.533415
train_loss: 0.082927
valid_loss: 1.095920
validation finished
normal learning rate scheduler step
Epoch-44 lr: 8.343386955526898e-05
Epoch-44 lr: 8.343386955526898e-05
epoch 44 training time: 6.414
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8ec6100>
The learning rate scheduler starts at 6 epoch with decay rate of 0.636 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 12:25:18.567021
current #epochs=1, #steps=0
start validation
acc: 0.636364
AUC: 0.836777
Avg Precision: 0.379880
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.114493
valid_loss: 1.125175
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003252185471604528
Epoch-1 lr: 0.003252185471604528
epoch 1 training time: 9.604
---------------
2023-09-12 12:25:28.171375
current #epochs=2, #steps=8
start validation
acc: 0.613636
AUC: 0.847107
Avg Precision: 0.429347
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.192067
valid_loss: 1.115618
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003252185471604528
Epoch-2 lr: 0.003252185471604528
epoch 2 training time: 6.418
---------------
2023-09-12 12:25:34.589145
current #epochs=3, #steps=16
start validation
acc: 0.727273
AUC: 0.853306
Avg Precision: 0.440492
Avg Recall: 1.000000
d_prime: 1.485939
train_loss: 0.175435
valid_loss: 1.102167
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003252185471604528
Epoch-3 lr: 0.003252185471604528
epoch 3 training time: 8.732
---------------
2023-09-12 12:25:43.321427
current #epochs=4, #steps=24
start validation
acc: 0.636364
AUC: 0.845730
Avg Precision: 0.397655
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.157060
valid_loss: 1.125209
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003252185471604528
Epoch-4 lr: 0.003252185471604528
epoch 4 training time: 6.283
---------------
2023-09-12 12:25:49.604378
current #epochs=5, #steps=32
start validation
acc: 0.681818
AUC: 0.840220
Avg Precision: 0.372883
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.146148
valid_loss: 1.130622
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.003252185471604528
Epoch-5 lr: 0.003252185471604528
epoch 5 training time: 6.259
---------------
2023-09-12 12:25:55.863050
current #epochs=6, #steps=40
start validation
acc: 0.636364
AUC: 0.840220
Avg Precision: 0.383070
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.114185
valid_loss: 1.111695
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0020674268289454243
Epoch-6 lr: 0.0020674268289454243
epoch 6 training time: 6.266
---------------
2023-09-12 12:26:02.128847
current #epochs=7, #steps=48
start validation
acc: 0.590909
AUC: 0.840909
Avg Precision: 0.390381
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.159258
valid_loss: 1.124625
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0020674268289454243
Epoch-7 lr: 0.0020674268289454243
epoch 7 training time: 8.011
---------------
2023-09-12 12:26:10.139449
current #epochs=8, #steps=56
start validation
acc: 0.590909
AUC: 0.837466
Avg Precision: 0.398806
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.141729
valid_loss: 1.126710
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0020674268289454243
Epoch-8 lr: 0.0020674268289454243
epoch 8 training time: 6.355
---------------
2023-09-12 12:26:16.495132
current #epochs=9, #steps=64
start validation
acc: 0.636364
AUC: 0.837466
Avg Precision: 0.394544
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.129705
valid_loss: 1.126571
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0020674268289454243
Epoch-9 lr: 0.0020674268289454243
epoch 9 training time: 8.162
---------------
2023-09-12 12:26:24.656692
current #epochs=10, #steps=72
start validation
acc: 0.659091
AUC: 0.842975
Avg Precision: 0.392371
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.119927
valid_loss: 1.114172
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0013142711971265734
Epoch-10 lr: 0.0013142711971265734
epoch 10 training time: 7.812
---------------
2023-09-12 12:26:32.468946
current #epochs=11, #steps=80
start validation
acc: 0.659091
AUC: 0.848485
Avg Precision: 0.422811
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.130274
valid_loss: 1.113976
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0013142711971265734
Epoch-11 lr: 0.0013142711971265734
epoch 11 training time: 6.663
---------------
2023-09-12 12:26:39.131767
current #epochs=12, #steps=88
start validation
acc: 0.636364
AUC: 0.846419
Avg Precision: 0.420888
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.170180
valid_loss: 1.112722
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0013142711971265734
Epoch-12 lr: 0.0013142711971265734
epoch 12 training time: 6.239
---------------
2023-09-12 12:26:45.370828
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01216	Per Sample Data Time 0.00641	Per Sample DNN Time 0.00575	Train Loss 0.1224	
start validation
acc: 0.659091
AUC: 0.838154
Avg Precision: 0.417774
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.115837
valid_loss: 1.117752
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0013142711971265734
Epoch-13 lr: 0.0013142711971265734
epoch 13 training time: 6.407
---------------
2023-09-12 12:26:51.777523
current #epochs=14, #steps=104
start validation
acc: 0.636364
AUC: 0.832645
Avg Precision: 0.391085
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.136614
valid_loss: 1.129653
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0008354872614657909
Epoch-14 lr: 0.0008354872614657909
epoch 14 training time: 8.121
---------------
2023-09-12 12:26:59.898574
current #epochs=15, #steps=112
start validation
acc: 0.613636
AUC: 0.838154
Avg Precision: 0.391085
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.151689
valid_loss: 1.123886
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0008354872614657909
Epoch-15 lr: 0.0008354872614657909
epoch 15 training time: 6.375
---------------
2023-09-12 12:27:06.274117
current #epochs=16, #steps=120
start validation
acc: 0.590909
AUC: 0.843664
Avg Precision: 0.403914
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.086724
valid_loss: 1.116989
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0008354872614657909
Epoch-16 lr: 0.0008354872614657909
epoch 16 training time: 6.344
---------------
2023-09-12 12:27:12.617518
current #epochs=17, #steps=128
start validation
acc: 0.613636
AUC: 0.848485
Avg Precision: 0.407059
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.111060
valid_loss: 1.118338
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0008354872614657909
Epoch-17 lr: 0.0008354872614657909
epoch 17 training time: 7.894
---------------
2023-09-12 12:27:20.511196
current #epochs=18, #steps=136
start validation
acc: 0.613636
AUC: 0.846419
Avg Precision: 0.419648
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.078110
valid_loss: 1.121669
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0005311224696986042
Epoch-18 lr: 0.0005311224696986042
epoch 18 training time: 6.500
---------------
2023-09-12 12:27:27.011242
current #epochs=19, #steps=144
start validation
acc: 0.636364
AUC: 0.840909
Avg Precision: 0.417647
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.105659
valid_loss: 1.121337
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0005311224696986042
Epoch-19 lr: 0.0005311224696986042
epoch 19 training time: 7.600
---------------
2023-09-12 12:27:34.611196
current #epochs=20, #steps=152
start validation
acc: 0.659091
AUC: 0.843664
Avg Precision: 0.402931
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.100116
valid_loss: 1.121742
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0005311224696986042
Epoch-20 lr: 0.0005311224696986042
epoch 20 training time: 6.238
---------------
2023-09-12 12:27:40.849826
current #epochs=21, #steps=160
start validation
acc: 0.659091
AUC: 0.842975
Avg Precision: 0.410758
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.078217
valid_loss: 1.122324
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0005311224696986042
Epoch-21 lr: 0.0005311224696986042
epoch 21 training time: 6.514
---------------
2023-09-12 12:27:47.364079
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.843664
Avg Precision: 0.408447
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.069788
valid_loss: 1.119323
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00033763659941845204
Epoch-22 lr: 0.00033763659941845204
epoch 22 training time: 8.121
---------------
2023-09-12 12:27:55.485482
current #epochs=23, #steps=176
start validation
acc: 0.636364
AUC: 0.841598
Avg Precision: 0.432898
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.080943
valid_loss: 1.120612
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00033763659941845204
Epoch-23 lr: 0.00033763659941845204
epoch 23 training time: 6.430
---------------
2023-09-12 12:28:01.915698
current #epochs=24, #steps=184
start validation
acc: 0.636364
AUC: 0.841598
Avg Precision: 0.430244
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.073978
valid_loss: 1.120032
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00033763659941845204
Epoch-24 lr: 0.00033763659941845204
epoch 24 training time: 6.345
---------------
2023-09-12 12:28:08.260692
current #epochs=25, #steps=192
start validation
acc: 0.681818
AUC: 0.847796
Avg Precision: 0.445850
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.058339
valid_loss: 1.115192
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00033763659941845204
Epoch-25 lr: 0.00033763659941845204
epoch 25 training time: 6.618
---------------
2023-09-12 12:28:14.879025
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03604	Per Sample Data Time 0.02994	Per Sample DNN Time 0.00610	Train Loss 0.1781	
start validation
acc: 0.659091
AUC: 0.851240
Avg Precision: 0.451284
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.095332
valid_loss: 1.110751
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0002146368865387053
Epoch-26 lr: 0.0002146368865387053
epoch 26 training time: 6.361
---------------
2023-09-12 12:28:21.240618
current #epochs=27, #steps=208
start validation
acc: 0.659091
AUC: 0.851928
Avg Precision: 0.454922
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.111033
valid_loss: 1.108346
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0002146368865387053
Epoch-27 lr: 0.0002146368865387053
epoch 27 training time: 6.349
---------------
2023-09-12 12:28:27.590217
current #epochs=28, #steps=216
start validation
acc: 0.659091
AUC: 0.855372
Avg Precision: 0.458839
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.079650
valid_loss: 1.108755
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0002146368865387053
Epoch-28 lr: 0.0002146368865387053
epoch 28 training time: 6.272
---------------
2023-09-12 12:28:33.861963
current #epochs=29, #steps=224
start validation
acc: 0.659091
AUC: 0.853994
Avg Precision: 0.448423
Avg Recall: 1.000000
d_prime: 1.490185
train_loss: 0.057974
valid_loss: 1.108474
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0002146368865387053
Epoch-29 lr: 0.0002146368865387053
epoch 29 training time: 6.230
---------------
2023-09-12 12:28:40.092301
current #epochs=30, #steps=232
start validation
acc: 0.659091
AUC: 0.854683
Avg Precision: 0.448423
Avg Recall: 1.000000
d_prime: 1.494446
train_loss: 0.132837
valid_loss: 1.108606
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00013644549537099548
Epoch-30 lr: 0.00013644549537099548
epoch 30 training time: 6.376
---------------
2023-09-12 12:28:46.468602
current #epochs=31, #steps=240
start validation
acc: 0.659091
AUC: 0.853306
Avg Precision: 0.448423
Avg Recall: 1.000000
d_prime: 1.485939
train_loss: 0.082541
valid_loss: 1.108882
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.00013644549537099548
Epoch-31 lr: 0.00013644549537099548
epoch 31 training time: 7.613
---------------
2023-09-12 12:28:54.081708
current #epochs=32, #steps=248
start validation
acc: 0.659091
AUC: 0.855372
Avg Precision: 0.448423
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.046860
valid_loss: 1.107785
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00013644549537099548
Epoch-32 lr: 0.00013644549537099548
epoch 32 training time: 6.316
---------------
2023-09-12 12:29:00.397666
current #epochs=33, #steps=256
start validation
acc: 0.659091
AUC: 0.853994
Avg Precision: 0.443839
Avg Recall: 1.000000
d_prime: 1.490185
train_loss: 0.114125
valid_loss: 1.108842
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.00013644549537099548
Epoch-33 lr: 0.00013644549537099548
epoch 33 training time: 6.390
---------------
2023-09-12 12:29:06.787738
current #epochs=34, #steps=264
start validation
acc: 0.659091
AUC: 0.853994
Avg Precision: 0.439609
Avg Recall: 1.000000
d_prime: 1.490185
train_loss: 0.070508
valid_loss: 1.107367
validation finished
normal learning rate scheduler step
Epoch-34 lr: 8.673892687909025e-05
Epoch-34 lr: 8.673892687909025e-05
epoch 34 training time: 6.446
---------------
2023-09-12 12:29:13.234144
current #epochs=35, #steps=272
start validation
acc: 0.659091
AUC: 0.854683
Avg Precision: 0.439609
Avg Recall: 1.000000
d_prime: 1.494446
train_loss: 0.077893
valid_loss: 1.106721
validation finished
normal learning rate scheduler step
Epoch-35 lr: 8.673892687909025e-05
Epoch-35 lr: 8.673892687909025e-05
epoch 35 training time: 6.358
---------------
2023-09-12 12:29:19.592551
current #epochs=36, #steps=280
start validation
acc: 0.659091
AUC: 0.856749
Avg Precision: 0.439609
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.092128
valid_loss: 1.106248
validation finished
normal learning rate scheduler step
Epoch-36 lr: 8.673892687909025e-05
Epoch-36 lr: 8.673892687909025e-05
epoch 36 training time: 6.172
---------------
2023-09-12 12:29:25.763954
current #epochs=37, #steps=288
start validation
acc: 0.659091
AUC: 0.857438
Avg Precision: 0.439609
Avg Recall: 1.000000
d_prime: 1.511624
train_loss: 0.074551
valid_loss: 1.106161
validation finished
normal learning rate scheduler step
Epoch-37 lr: 8.673892687909025e-05
Epoch-37 lr: 8.673892687909025e-05
epoch 37 training time: 6.294
---------------
2023-09-12 12:29:32.058415
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01189	Per Sample Data Time 0.00613	Per Sample DNN Time 0.00575	Train Loss 0.0582	
start validation
acc: 0.659091
AUC: 0.856749
Avg Precision: 0.439609
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.054297
valid_loss: 1.106176
validation finished
normal learning rate scheduler step
Epoch-38 lr: 5.514026986145181e-05
Epoch-38 lr: 5.514026986145181e-05
epoch 38 training time: 6.377
---------------
2023-09-12 12:29:38.435373
current #epochs=39, #steps=304
start validation
acc: 0.659091
AUC: 0.856061
Avg Precision: 0.439609
Avg Recall: 1.000000
d_prime: 1.503007
train_loss: 0.091500
valid_loss: 1.105838
validation finished
normal learning rate scheduler step
Epoch-39 lr: 5.514026986145181e-05
Epoch-39 lr: 5.514026986145181e-05
epoch 39 training time: 6.790
---------------
2023-09-12 12:29:45.225209
current #epochs=40, #steps=312
start validation
acc: 0.659091
AUC: 0.855372
Avg Precision: 0.439609
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.063680
valid_loss: 1.105767
validation finished
normal learning rate scheduler step
Epoch-40 lr: 5.514026986145181e-05
Epoch-40 lr: 5.514026986145181e-05
epoch 40 training time: 6.467
---------------
2023-09-12 12:29:51.691949
current #epochs=41, #steps=320
start validation
acc: 0.659091
AUC: 0.855372
Avg Precision: 0.439609
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.114385
valid_loss: 1.105946
validation finished
normal learning rate scheduler step
Epoch-41 lr: 5.514026986145181e-05
Epoch-41 lr: 5.514026986145181e-05
epoch 41 training time: 6.544
---------------
2023-09-12 12:29:58.236478
current #epochs=42, #steps=328
start validation
acc: 0.659091
AUC: 0.855372
Avg Precision: 0.439609
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.101643
valid_loss: 1.106079
validation finished
normal learning rate scheduler step
Epoch-42 lr: 3.505288190424544e-05
Epoch-42 lr: 3.505288190424544e-05
epoch 42 training time: 6.410
---------------
2023-09-12 12:30:04.646530
current #epochs=43, #steps=336
start validation
acc: 0.659091
AUC: 0.856061
Avg Precision: 0.439609
Avg Recall: 1.000000
d_prime: 1.503007
train_loss: 0.110546
valid_loss: 1.106101
validation finished
normal learning rate scheduler step
Epoch-43 lr: 3.505288190424544e-05
Epoch-43 lr: 3.505288190424544e-05
epoch 43 training time: 6.350
---------------
2023-09-12 12:30:10.996458
current #epochs=44, #steps=344
start validation
acc: 0.659091
AUC: 0.855372
Avg Precision: 0.439609
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.083811
valid_loss: 1.106327
validation finished
normal learning rate scheduler step
Epoch-44 lr: 3.505288190424544e-05
Epoch-44 lr: 3.505288190424544e-05
epoch 44 training time: 6.198
---------------
2023-09-12 12:30:17.194411
current #epochs=45, #steps=352
start validation
acc: 0.659091
AUC: 0.855372
Avg Precision: 0.439609
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.076311
valid_loss: 1.106726
validation finished
normal learning rate scheduler step
Epoch-45 lr: 3.505288190424544e-05
Epoch-45 lr: 3.505288190424544e-05
epoch 45 training time: 7.368
---------------
2023-09-12 12:30:24.562052
current #epochs=46, #steps=360
start validation
[I 2023-09-12 12:30:30,862] Trial 93 finished with value: 0.7272727272727273 and parameters: {'warmup': 'False', 'num_epochs': 46, 'batch_size': 13, 'lr-adaptschedule': 'True', 'lr': 0.003252185471604528, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.6357038511476468}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.659091
AUC: 0.855372
Avg Precision: 0.439609
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.075022
valid_loss: 1.106910
validation finished
normal learning rate scheduler step
Epoch-46 lr: 2.2283252020352487e-05
Epoch-46 lr: 2.2283252020352487e-05
epoch 46 training time: 6.294
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8d225e0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.629 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 12:30:30.905734
current #epochs=1, #steps=0
start validation
acc: 0.681818
AUC: 0.847107
Avg Precision: 0.408638
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.192186
valid_loss: 1.108635
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0034546647633151547
Epoch-1 lr: 0.0034546647633151547
epoch 1 training time: 8.749
---------------
2023-09-12 12:30:39.655572
current #epochs=2, #steps=8
start validation
acc: 0.659091
AUC: 0.827135
Avg Precision: 0.376186
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.155623
valid_loss: 1.138549
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0034546647633151547
Epoch-2 lr: 0.0034546647633151547
epoch 2 training time: 6.284
---------------
2023-09-12 12:30:45.939388
current #epochs=3, #steps=16
start validation
acc: 0.613636
AUC: 0.809229
Avg Precision: 0.305788
Avg Recall: 1.000000
d_prime: 1.237518
train_loss: 0.203327
valid_loss: 1.163200
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0034546647633151547
Epoch-3 lr: 0.0034546647633151547
epoch 3 training time: 6.273
---------------
2023-09-12 12:30:52.212678
current #epochs=4, #steps=24
start validation
acc: 0.636364
AUC: 0.801653
Avg Precision: 0.319469
Avg Recall: 1.000000
d_prime: 1.198603
train_loss: 0.170252
valid_loss: 1.146293
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0034546647633151547
Epoch-4 lr: 0.0034546647633151547
epoch 4 training time: 6.542
---------------
2023-09-12 12:30:58.755251
current #epochs=5, #steps=32
start validation
acc: 0.636364
AUC: 0.833333
Avg Precision: 0.399526
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.147808
valid_loss: 1.135112
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0034546647633151547
Epoch-5 lr: 0.0034546647633151547
epoch 5 training time: 6.305
---------------
2023-09-12 12:31:05.060302
current #epochs=6, #steps=40
start validation
acc: 0.636364
AUC: 0.852617
Avg Precision: 0.407649
Avg Recall: 1.000000
d_prime: 1.481705
train_loss: 0.119148
valid_loss: 1.105171
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002174356421976352
Epoch-6 lr: 0.002174356421976352
epoch 6 training time: 6.197
---------------
2023-09-12 12:31:11.257589
current #epochs=7, #steps=48
start validation
acc: 0.681818
AUC: 0.845730
Avg Precision: 0.373847
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.153516
valid_loss: 1.119255
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002174356421976352
Epoch-7 lr: 0.002174356421976352
epoch 7 training time: 7.025
---------------
2023-09-12 12:31:18.282101
current #epochs=8, #steps=56
start validation
acc: 0.659091
AUC: 0.843664
Avg Precision: 0.396018
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.105371
valid_loss: 1.123355
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.002174356421976352
Epoch-8 lr: 0.002174356421976352
epoch 8 training time: 6.500
---------------
2023-09-12 12:31:24.781709
current #epochs=9, #steps=64
start validation
acc: 0.659091
AUC: 0.840909
Avg Precision: 0.399179
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.097466
valid_loss: 1.129455
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.002174356421976352
Epoch-9 lr: 0.002174356421976352
epoch 9 training time: 6.419
---------------
2023-09-12 12:31:31.201058
current #epochs=10, #steps=72
start validation
acc: 0.636364
AUC: 0.844353
Avg Precision: 0.420007
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.143110
valid_loss: 1.121145
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0013685339023323648
Epoch-10 lr: 0.0013685339023323648
epoch 10 training time: 6.299
---------------
2023-09-12 12:31:37.499598
current #epochs=11, #steps=80
start validation
acc: 0.659091
AUC: 0.849862
Avg Precision: 0.435691
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.116959
valid_loss: 1.120091
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0013685339023323648
Epoch-11 lr: 0.0013685339023323648
epoch 11 training time: 7.440
---------------
2023-09-12 12:31:44.939525
current #epochs=12, #steps=88
start validation
acc: 0.659091
AUC: 0.848485
Avg Precision: 0.418632
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.075468
valid_loss: 1.123197
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0013685339023323648
Epoch-12 lr: 0.0013685339023323648
epoch 12 training time: 6.387
---------------
2023-09-12 12:31:51.327198
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01177	Per Sample Data Time 0.00601	Per Sample DNN Time 0.00576	Train Loss 0.0875	
start validation
acc: 0.636364
AUC: 0.844353
Avg Precision: 0.404450
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.074540
valid_loss: 1.118281
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0013685339023323648
Epoch-13 lr: 0.0013685339023323648
epoch 13 training time: 6.345
---------------
2023-09-12 12:31:57.672421
current #epochs=14, #steps=104
start validation
acc: 0.659091
AUC: 0.858815
Avg Precision: 0.422889
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.107128
valid_loss: 1.107645
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0008613514430769895
Epoch-14 lr: 0.0008613514430769895
epoch 14 training time: 6.354
---------------
2023-09-12 12:32:04.026733
current #epochs=15, #steps=112
start validation
acc: 0.681818
AUC: 0.866391
Avg Precision: 0.441554
Avg Recall: 1.000000
d_prime: 1.569060
train_loss: 0.107589
valid_loss: 1.104889
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0008613514430769895
Epoch-15 lr: 0.0008613514430769895
epoch 15 training time: 6.322
---------------
2023-09-12 12:32:10.348866
current #epochs=16, #steps=120
start validation
acc: 0.659091
AUC: 0.860193
Avg Precision: 0.433513
Avg Recall: 1.000000
d_prime: 1.529028
train_loss: 0.086679
valid_loss: 1.108221
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0008613514430769895
Epoch-16 lr: 0.0008613514430769895
epoch 16 training time: 7.438
---------------
2023-09-12 12:32:17.787221
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.854683
Avg Precision: 0.429913
Avg Recall: 1.000000
d_prime: 1.494446
train_loss: 0.104772
valid_loss: 1.111087
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0008613514430769895
Epoch-17 lr: 0.0008613514430769895
epoch 17 training time: 6.393
---------------
2023-09-12 12:32:24.180198
current #epochs=18, #steps=136
start validation
acc: 0.636364
AUC: 0.860882
Avg Precision: 0.433513
Avg Recall: 1.000000
d_prime: 1.533415
train_loss: 0.119769
valid_loss: 1.112604
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0005421322096780812
Epoch-18 lr: 0.0005421322096780812
epoch 18 training time: 6.211
---------------
2023-09-12 12:32:30.392105
current #epochs=19, #steps=144
start validation
acc: 0.659091
AUC: 0.853306
Avg Precision: 0.423716
Avg Recall: 1.000000
d_prime: 1.485939
train_loss: 0.102031
valid_loss: 1.118253
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0005421322096780812
Epoch-19 lr: 0.0005421322096780812
epoch 19 training time: 6.329
---------------
2023-09-12 12:32:36.720564
current #epochs=20, #steps=152
start validation
acc: 0.659091
AUC: 0.855372
Avg Precision: 0.420555
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.121441
valid_loss: 1.115612
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0005421322096780812
Epoch-20 lr: 0.0005421322096780812
epoch 20 training time: 6.316
---------------
2023-09-12 12:32:43.036908
current #epochs=21, #steps=160
start validation
acc: 0.636364
AUC: 0.859504
Avg Precision: 0.420370
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.119893
valid_loss: 1.111223
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0005421322096780812
Epoch-21 lr: 0.0005421322096780812
epoch 21 training time: 6.364
---------------
2023-09-12 12:32:49.400936
current #epochs=22, #steps=168
start validation
acc: 0.659091
AUC: 0.861570
Avg Precision: 0.438274
Avg Recall: 1.000000
d_prime: 1.537818
train_loss: 0.106148
valid_loss: 1.106243
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0003412165093965819
Epoch-22 lr: 0.0003412165093965819
epoch 22 training time: 6.352
---------------
2023-09-12 12:32:55.753677
current #epochs=23, #steps=176
start validation
acc: 0.659091
AUC: 0.862259
Avg Precision: 0.446458
Avg Recall: 1.000000
d_prime: 1.542235
train_loss: 0.162838
valid_loss: 1.105843
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0003412165093965819
Epoch-23 lr: 0.0003412165093965819
epoch 23 training time: 7.618
---------------
2023-09-12 12:33:03.371513
current #epochs=24, #steps=184
start validation
acc: 0.636364
AUC: 0.861570
Avg Precision: 0.440760
Avg Recall: 1.000000
d_prime: 1.537818
train_loss: 0.106020
valid_loss: 1.106959
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0003412165093965819
Epoch-24 lr: 0.0003412165093965819
epoch 24 training time: 6.320
---------------
2023-09-12 12:33:09.691275
current #epochs=25, #steps=192
start validation
acc: 0.636364
AUC: 0.864325
Avg Precision: 0.445522
Avg Recall: 1.000000
d_prime: 1.555577
train_loss: 0.097412
valid_loss: 1.109805
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0003412165093965819
Epoch-25 lr: 0.0003412165093965819
epoch 25 training time: 7.298
---------------
2023-09-12 12:33:16.988814
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03575	Per Sample Data Time 0.03024	Per Sample DNN Time 0.00551	Train Loss 0.0924	
start validation
acc: 0.659091
AUC: 0.858127
Avg Precision: 0.433547
Avg Recall: 1.000000
d_prime: 1.515953
train_loss: 0.087120
valid_loss: 1.113382
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00021476072479427704
Epoch-26 lr: 0.00021476072479427704
epoch 26 training time: 6.276
---------------
2023-09-12 12:33:23.264924
current #epochs=27, #steps=208
start validation
acc: 0.659091
AUC: 0.847796
Avg Precision: 0.429630
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.110249
valid_loss: 1.116943
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00021476072479427704
Epoch-27 lr: 0.00021476072479427704
epoch 27 training time: 6.428
---------------
2023-09-12 12:33:29.692939
current #epochs=28, #steps=216
start validation
acc: 0.659091
AUC: 0.849174
Avg Precision: 0.429630
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.097265
valid_loss: 1.118310
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00021476072479427704
Epoch-28 lr: 0.00021476072479427704
epoch 28 training time: 6.397
---------------
2023-09-12 12:33:36.089496
current #epochs=29, #steps=224
start validation
acc: 0.636364
AUC: 0.849174
Avg Precision: 0.429630
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.085064
valid_loss: 1.117642
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00021476072479427704
Epoch-29 lr: 0.00021476072479427704
epoch 29 training time: 6.280
---------------
2023-09-12 12:33:42.369496
current #epochs=30, #steps=232
start validation
acc: 0.636364
AUC: 0.848485
Avg Precision: 0.429630
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.093994
valid_loss: 1.117838
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00013516980463731693
Epoch-30 lr: 0.00013516980463731693
epoch 30 training time: 6.269
---------------
2023-09-12 12:33:48.638660
current #epochs=31, #steps=240
start validation
acc: 0.636364
AUC: 0.851240
Avg Precision: 0.433547
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.073922
valid_loss: 1.117336
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.00013516980463731693
Epoch-31 lr: 0.00013516980463731693
epoch 31 training time: 6.231
---------------
2023-09-12 12:33:54.869313
current #epochs=32, #steps=248
start validation
acc: 0.613636
AUC: 0.851240
Avg Precision: 0.431096
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.111208
valid_loss: 1.116707
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00013516980463731693
Epoch-32 lr: 0.00013516980463731693
epoch 32 training time: 6.283
---------------
2023-09-12 12:34:01.152234
current #epochs=33, #steps=256
start validation
acc: 0.613636
AUC: 0.852617
Avg Precision: 0.431096
Avg Recall: 1.000000
d_prime: 1.481705
train_loss: 0.064945
valid_loss: 1.116234
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.00013516980463731693
Epoch-33 lr: 0.00013516980463731693
epoch 33 training time: 6.327
---------------
2023-09-12 12:34:07.479205
current #epochs=34, #steps=264
start validation
acc: 0.613636
AUC: 0.853306
Avg Precision: 0.433547
Avg Recall: 1.000000
d_prime: 1.485939
train_loss: 0.083032
valid_loss: 1.117541
validation finished
normal learning rate scheduler step
Epoch-34 lr: 8.507550020234105e-05
Epoch-34 lr: 8.507550020234105e-05
epoch 34 training time: 6.401
---------------
2023-09-12 12:34:13.880467
current #epochs=35, #steps=272
start validation
acc: 0.613636
AUC: 0.851240
Avg Precision: 0.433547
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.106650
valid_loss: 1.118092
validation finished
normal learning rate scheduler step
Epoch-35 lr: 8.507550020234105e-05
Epoch-35 lr: 8.507550020234105e-05
epoch 35 training time: 6.358
---------------
2023-09-12 12:34:20.238744
current #epochs=36, #steps=280
start validation
acc: 0.613636
AUC: 0.849862
Avg Precision: 0.425992
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.082174
valid_loss: 1.118196
validation finished
normal learning rate scheduler step
Epoch-36 lr: 8.507550020234105e-05
Epoch-36 lr: 8.507550020234105e-05
epoch 36 training time: 6.255
---------------
2023-09-12 12:34:26.493336
current #epochs=37, #steps=288
start validation
acc: 0.613636
AUC: 0.847796
Avg Precision: 0.423541
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.066200
valid_loss: 1.118856
validation finished
normal learning rate scheduler step
Epoch-37 lr: 8.507550020234105e-05
Epoch-37 lr: 8.507550020234105e-05
epoch 37 training time: 6.276
---------------
2023-09-12 12:34:32.769352
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01178	Per Sample Data Time 0.00598	Per Sample DNN Time 0.00580	Train Loss 0.0645	
start validation
acc: 0.613636
AUC: 0.846419
Avg Precision: 0.423541
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.070028
valid_loss: 1.119748
validation finished
normal learning rate scheduler step
Epoch-38 lr: 5.354628390637142e-05
Epoch-38 lr: 5.354628390637142e-05
epoch 38 training time: 6.402
---------------
2023-09-12 12:34:39.171719
current #epochs=39, #steps=304
start validation
acc: 0.613636
AUC: 0.846419
Avg Precision: 0.423541
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.079795
valid_loss: 1.119785
validation finished
normal learning rate scheduler step
Epoch-39 lr: 5.354628390637142e-05
Epoch-39 lr: 5.354628390637142e-05
epoch 39 training time: 6.352
---------------
2023-09-12 12:34:45.524225
current #epochs=40, #steps=312
start validation
acc: 0.613636
AUC: 0.847107
Avg Precision: 0.423541
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.104092
valid_loss: 1.119720
validation finished
normal learning rate scheduler step
Epoch-40 lr: 5.354628390637142e-05
Epoch-40 lr: 5.354628390637142e-05
epoch 40 training time: 6.286
---------------
2023-09-12 12:34:51.810256
current #epochs=41, #steps=320
start validation
acc: 0.613636
AUC: 0.846419
Avg Precision: 0.423541
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.065304
valid_loss: 1.119070
validation finished
normal learning rate scheduler step
Epoch-41 lr: 5.354628390637142e-05
Epoch-41 lr: 5.354628390637142e-05
epoch 41 training time: 6.403
---------------
2023-09-12 12:34:58.212822
current #epochs=42, #steps=328
start validation
acc: 0.613636
AUC: 0.845041
Avg Precision: 0.423541
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.075247
valid_loss: 1.119030
validation finished
normal learning rate scheduler step
Epoch-42 lr: 3.3701882602658305e-05
Epoch-42 lr: 3.3701882602658305e-05
epoch 42 training time: 6.255
---------------
2023-09-12 12:35:04.467846
current #epochs=43, #steps=336
start validation
acc: 0.613636
AUC: 0.845730
Avg Precision: 0.423541
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.111705
valid_loss: 1.119040
validation finished
normal learning rate scheduler step
Epoch-43 lr: 3.3701882602658305e-05
Epoch-43 lr: 3.3701882602658305e-05
epoch 43 training time: 6.315
---------------
2023-09-12 12:35:10.783492
current #epochs=44, #steps=344
start validation
acc: 0.613636
AUC: 0.845041
Avg Precision: 0.423541
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.083566
valid_loss: 1.118765
validation finished
normal learning rate scheduler step
Epoch-44 lr: 3.3701882602658305e-05
Epoch-44 lr: 3.3701882602658305e-05
epoch 44 training time: 6.441
---------------
2023-09-12 12:35:17.223907
current #epochs=45, #steps=352
start validation
acc: 0.613636
AUC: 0.845730
Avg Precision: 0.423541
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.086706
valid_loss: 1.118454
validation finished
normal learning rate scheduler step
Epoch-45 lr: 3.3701882602658305e-05
Epoch-45 lr: 3.3701882602658305e-05
epoch 45 training time: 6.296
---------------
2023-09-12 12:35:23.520188
current #epochs=46, #steps=360
start validation
[I 2023-09-12 12:35:29,854] Trial 94 finished with value: 0.6818181818181818 and parameters: {'warmup': 'False', 'num_epochs': 46, 'batch_size': 9, 'lr-adaptschedule': 'True', 'lr': 0.0034546647633151547, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.629397226922187}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.613636
AUC: 0.846419
Avg Precision: 0.423541
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.175724
valid_loss: 1.118055
validation finished
normal learning rate scheduler step
Epoch-46 lr: 2.1211871452170236e-05
Epoch-46 lr: 2.1211871452170236e-05
epoch 46 training time: 6.328
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8d2e0a0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.617 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 12:35:29.894608
current #epochs=1, #steps=0
start validation
acc: 0.681818
AUC: 0.836088
Avg Precision: 0.369377
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.228885
valid_loss: 1.123575
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003100252618378559
Epoch-1 lr: 0.003100252618378559
epoch 1 training time: 8.862
---------------
2023-09-12 12:35:38.757175
current #epochs=2, #steps=8
start validation
acc: 0.681818
AUC: 0.855372
Avg Precision: 0.401744
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.147170
valid_loss: 1.113327
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003100252618378559
Epoch-2 lr: 0.003100252618378559
epoch 2 training time: 7.779
---------------
2023-09-12 12:35:46.536794
current #epochs=3, #steps=16
start validation
acc: 0.659091
AUC: 0.844353
Avg Precision: 0.424504
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.130727
valid_loss: 1.109918
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003100252618378559
Epoch-3 lr: 0.003100252618378559
epoch 3 training time: 7.227
---------------
2023-09-12 12:35:53.763542
current #epochs=4, #steps=24
start validation
acc: 0.727273
AUC: 0.870523
Avg Precision: 0.492996
Avg Recall: 1.000000
d_prime: 1.596462
train_loss: 0.082304
valid_loss: 1.081306
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003100252618378559
Epoch-4 lr: 0.003100252618378559
epoch 4 training time: 10.585
---------------
2023-09-12 12:36:04.348357
current #epochs=5, #steps=32
start validation
acc: 0.613636
AUC: 0.832645
Avg Precision: 0.369162
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.091330
valid_loss: 1.119108
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.003100252618378559
Epoch-5 lr: 0.003100252618378559
epoch 5 training time: 7.313
---------------
2023-09-12 12:36:11.661269
current #epochs=6, #steps=40
start validation
acc: 0.636364
AUC: 0.839532
Avg Precision: 0.362830
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.172140
valid_loss: 1.126759
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.001914057999210474
Epoch-6 lr: 0.001914057999210474
epoch 6 training time: 8.195
---------------
2023-09-12 12:36:19.856629
current #epochs=7, #steps=48
start validation
acc: 0.704545
AUC: 0.834022
Avg Precision: 0.347264
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.197344
valid_loss: 1.115558
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.001914057999210474
Epoch-7 lr: 0.001914057999210474
epoch 7 training time: 6.277
---------------
2023-09-12 12:36:26.133974
current #epochs=8, #steps=56
start validation
acc: 0.681818
AUC: 0.837466
Avg Precision: 0.375741
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.143027
valid_loss: 1.131056
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001914057999210474
Epoch-8 lr: 0.001914057999210474
epoch 8 training time: 6.308
---------------
2023-09-12 12:36:32.441701
current #epochs=9, #steps=64
start validation
acc: 0.681818
AUC: 0.844353
Avg Precision: 0.358513
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.138714
valid_loss: 1.119286
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001914057999210474
Epoch-9 lr: 0.001914057999210474
epoch 9 training time: 6.528
---------------
2023-09-12 12:36:38.969998
current #epochs=10, #steps=72
start validation
acc: 0.636364
AUC: 0.848485
Avg Precision: 0.348577
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.127227
valid_loss: 1.114425
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0011817159681192966
Epoch-10 lr: 0.0011817159681192966
epoch 10 training time: 6.329
---------------
2023-09-12 12:36:45.299432
current #epochs=11, #steps=80
start validation
acc: 0.613636
AUC: 0.851240
Avg Precision: 0.358925
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.171077
valid_loss: 1.100837
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0011817159681192966
Epoch-11 lr: 0.0011817159681192966
epoch 11 training time: 8.773
---------------
2023-09-12 12:36:54.072457
current #epochs=12, #steps=88
start validation
acc: 0.659091
AUC: 0.862948
Avg Precision: 0.390572
Avg Recall: 1.000000
d_prime: 1.546667
train_loss: 0.146747
valid_loss: 1.094276
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0011817159681192966
Epoch-12 lr: 0.0011817159681192966
epoch 12 training time: 6.502
---------------
2023-09-12 12:37:00.574560
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01136	Per Sample Data Time 0.00592	Per Sample DNN Time 0.00544	Train Loss 0.1150	
start validation
acc: 0.681818
AUC: 0.865014
Avg Precision: 0.443215
Avg Recall: 1.000000
d_prime: 1.560056
train_loss: 0.104015
valid_loss: 1.087612
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0011817159681192966
Epoch-13 lr: 0.0011817159681192966
epoch 13 training time: 7.066
---------------
2023-09-12 12:37:07.640783
current #epochs=14, #steps=104
start validation
acc: 0.681818
AUC: 0.865014
Avg Precision: 0.460348
Avg Recall: 1.000000
d_prime: 1.560056
train_loss: 0.124913
valid_loss: 1.082589
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0007295769667816474
Epoch-14 lr: 0.0007295769667816474
epoch 14 training time: 6.406
---------------
2023-09-12 12:37:14.046952
current #epochs=15, #steps=112
start validation
acc: 0.681818
AUC: 0.863636
Avg Precision: 0.462952
Avg Recall: 1.000000
d_prime: 1.551114
train_loss: 0.088635
valid_loss: 1.089431
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0007295769667816474
Epoch-15 lr: 0.0007295769667816474
epoch 15 training time: 7.766
---------------
2023-09-12 12:37:21.813732
current #epochs=16, #steps=120
start validation
acc: 0.681818
AUC: 0.865014
Avg Precision: 0.464807
Avg Recall: 1.000000
d_prime: 1.560056
train_loss: 0.095975
valid_loss: 1.084835
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0007295769667816474
Epoch-16 lr: 0.0007295769667816474
epoch 16 training time: 7.676
---------------
2023-09-12 12:37:29.489758
current #epochs=17, #steps=128
start validation
acc: 0.681818
AUC: 0.862259
Avg Precision: 0.462299
Avg Recall: 1.000000
d_prime: 1.542235
train_loss: 0.078272
valid_loss: 1.096076
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0007295769667816474
Epoch-17 lr: 0.0007295769667816474
epoch 17 training time: 7.502
---------------
2023-09-12 12:37:36.991923
current #epochs=18, #steps=136
start validation
acc: 0.659091
AUC: 0.846419
Avg Precision: 0.403370
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.106039
valid_loss: 1.109488
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00045043188449542384
Epoch-18 lr: 0.00045043188449542384
epoch 18 training time: 7.837
---------------
2023-09-12 12:37:44.829531
current #epochs=19, #steps=144
start validation
acc: 0.681818
AUC: 0.844353
Avg Precision: 0.392201
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.085319
valid_loss: 1.112198
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00045043188449542384
Epoch-19 lr: 0.00045043188449542384
epoch 19 training time: 6.370
---------------
2023-09-12 12:37:51.199158
current #epochs=20, #steps=152
start validation
acc: 0.636364
AUC: 0.841598
Avg Precision: 0.378284
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.074444
valid_loss: 1.113001
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00045043188449542384
Epoch-20 lr: 0.00045043188449542384
epoch 20 training time: 6.508
---------------
2023-09-12 12:37:57.706842
current #epochs=21, #steps=160
start validation
acc: 0.681818
AUC: 0.840909
Avg Precision: 0.382885
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.088796
valid_loss: 1.115403
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00045043188449542384
Epoch-21 lr: 0.00045043188449542384
epoch 21 training time: 6.309
---------------
2023-09-12 12:38:04.016213
current #epochs=22, #steps=168
start validation
acc: 0.681818
AUC: 0.838154
Avg Precision: 0.384562
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.115054
valid_loss: 1.118539
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00027809112925411306
Epoch-22 lr: 0.00027809112925411306
epoch 22 training time: 6.884
---------------
2023-09-12 12:38:10.900499
current #epochs=23, #steps=176
start validation
acc: 0.681818
AUC: 0.836777
Avg Precision: 0.384562
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.096066
valid_loss: 1.120010
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00027809112925411306
Epoch-23 lr: 0.00027809112925411306
epoch 23 training time: 11.127
---------------
2023-09-12 12:38:22.027602
current #epochs=24, #steps=184
start validation
acc: 0.681818
AUC: 0.836777
Avg Precision: 0.384562
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.137538
valid_loss: 1.120021
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00027809112925411306
Epoch-24 lr: 0.00027809112925411306
epoch 24 training time: 6.407
---------------
2023-09-12 12:38:28.435077
current #epochs=25, #steps=192
start validation
acc: 0.681818
AUC: 0.837466
Avg Precision: 0.384562
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.084652
valid_loss: 1.118473
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00027809112925411306
Epoch-25 lr: 0.00027809112925411306
epoch 25 training time: 8.524
---------------
2023-09-12 12:38:36.958579
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03678	Per Sample Data Time 0.02899	Per Sample DNN Time 0.00779	Train Loss 0.1040	
start validation
acc: 0.681818
AUC: 0.838154
Avg Precision: 0.382606
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.078676
valid_loss: 1.118066
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00017169005754656672
Epoch-26 lr: 0.00017169005754656672
epoch 26 training time: 6.757
---------------
2023-09-12 12:38:43.715542
current #epochs=27, #steps=208
start validation
acc: 0.681818
AUC: 0.838843
Avg Precision: 0.382606
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.094993
valid_loss: 1.117891
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00017169005754656672
Epoch-27 lr: 0.00017169005754656672
epoch 27 training time: 6.324
---------------
2023-09-12 12:38:50.039549
current #epochs=28, #steps=216
start validation
acc: 0.681818
AUC: 0.838154
Avg Precision: 0.391593
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.078485
valid_loss: 1.118173
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00017169005754656672
Epoch-28 lr: 0.00017169005754656672
epoch 28 training time: 6.620
---------------
2023-09-12 12:38:56.659520
current #epochs=29, #steps=224
start validation
acc: 0.681818
AUC: 0.838154
Avg Precision: 0.391593
Avg Recall: 1.000000
d_prime: 1.395688
train_loss: 0.059032
valid_loss: 1.118127
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00017169005754656672
Epoch-29 lr: 0.00017169005754656672
epoch 29 training time: 7.092
---------------
2023-09-12 12:39:03.750936
current #epochs=30, #steps=232
start validation
acc: 0.681818
AUC: 0.838843
Avg Precision: 0.401703
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.078741
valid_loss: 1.118105
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00010599933891960854
Epoch-30 lr: 0.00010599933891960854
epoch 30 training time: 6.808
---------------
2023-09-12 12:39:10.559101
current #epochs=31, #steps=240
start validation
acc: 0.681818
AUC: 0.841598
Avg Precision: 0.407277
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.076434
valid_loss: 1.118487
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.00010599933891960854
Epoch-31 lr: 0.00010599933891960854
epoch 31 training time: 6.292
---------------
2023-09-12 12:39:16.851050
current #epochs=32, #steps=248
start validation
acc: 0.681818
AUC: 0.841598
Avg Precision: 0.410234
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.096029
valid_loss: 1.119022
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00010599933891960854
Epoch-32 lr: 0.00010599933891960854
epoch 32 training time: 7.326
---------------
2023-09-12 12:39:24.177411
current #epochs=33, #steps=256
start validation
acc: 0.681818
AUC: 0.842975
Avg Precision: 0.415460
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.084974
valid_loss: 1.119289
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.00010599933891960854
Epoch-33 lr: 0.00010599933891960854
epoch 33 training time: 7.083
---------------
2023-09-12 12:39:31.259958
current #epochs=34, #steps=264
start validation
acc: 0.681818
AUC: 0.842975
Avg Precision: 0.415460
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.089586
valid_loss: 1.119316
validation finished
normal learning rate scheduler step
Epoch-34 lr: 6.544269372352318e-05
Epoch-34 lr: 6.544269372352318e-05
epoch 34 training time: 7.792
---------------
2023-09-12 12:39:39.051647
current #epochs=35, #steps=272
start validation
acc: 0.681818
AUC: 0.842975
Avg Precision: 0.415460
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.111958
valid_loss: 1.119016
validation finished
normal learning rate scheduler step
Epoch-35 lr: 6.544269372352318e-05
Epoch-35 lr: 6.544269372352318e-05
epoch 35 training time: 8.615
---------------
2023-09-12 12:39:47.667088
current #epochs=36, #steps=280
start validation
acc: 0.681818
AUC: 0.843664
Avg Precision: 0.415460
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.134073
valid_loss: 1.118599
validation finished
normal learning rate scheduler step
Epoch-36 lr: 6.544269372352318e-05
Epoch-36 lr: 6.544269372352318e-05
epoch 36 training time: 8.477
---------------
2023-09-12 12:39:56.144384
current #epochs=37, #steps=288
start validation
acc: 0.681818
AUC: 0.840909
Avg Precision: 0.403285
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.102589
valid_loss: 1.118142
validation finished
normal learning rate scheduler step
Epoch-37 lr: 6.544269372352318e-05
Epoch-37 lr: 6.544269372352318e-05
epoch 37 training time: 7.505
---------------
2023-09-12 12:40:03.649497
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01187	Per Sample Data Time 0.00604	Per Sample DNN Time 0.00583	Train Loss 0.0584	
start validation
acc: 0.681818
AUC: 0.841598
Avg Precision: 0.405241
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.059564
valid_loss: 1.117309
validation finished
normal learning rate scheduler step
Epoch-38 lr: 4.0403517658152176e-05
Epoch-38 lr: 4.0403517658152176e-05
epoch 38 training time: 9.843
---------------
2023-09-12 12:40:13.492511
current #epochs=39, #steps=304
start validation
acc: 0.681818
AUC: 0.841598
Avg Precision: 0.405241
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.105280
valid_loss: 1.117196
validation finished
normal learning rate scheduler step
Epoch-39 lr: 4.0403517658152176e-05
Epoch-39 lr: 4.0403517658152176e-05
epoch 39 training time: 7.114
---------------
2023-09-12 12:40:20.606481
current #epochs=40, #steps=312
start validation
acc: 0.681818
AUC: 0.840909
Avg Precision: 0.405241
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.086446
valid_loss: 1.117324
validation finished
normal learning rate scheduler step
Epoch-40 lr: 4.0403517658152176e-05
Epoch-40 lr: 4.0403517658152176e-05
epoch 40 training time: 8.333
---------------
2023-09-12 12:40:28.939257
current #epochs=41, #steps=320
start validation
acc: 0.681818
AUC: 0.840909
Avg Precision: 0.405241
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.124089
valid_loss: 1.117435
validation finished
normal learning rate scheduler step
Epoch-41 lr: 4.0403517658152176e-05
Epoch-41 lr: 4.0403517658152176e-05
epoch 41 training time: 8.814
---------------
2023-09-12 12:40:37.753571
current #epochs=42, #steps=328
start validation
acc: 0.681818
AUC: 0.840909
Avg Precision: 0.405241
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.078950
valid_loss: 1.117983
validation finished
normal learning rate scheduler step
Epoch-42 lr: 2.4944636998734017e-05
Epoch-42 lr: 2.4944636998734017e-05
epoch 42 training time: 6.531
---------------
2023-09-12 12:40:44.284558
current #epochs=43, #steps=336
start validation
[I 2023-09-12 12:40:50,727] Trial 95 finished with value: 0.7272727272727273 and parameters: {'warmup': 'False', 'num_epochs': 43, 'batch_size': 13, 'lr-adaptschedule': 'True', 'lr': 0.003100252618378559, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.6173877534571786}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.681818
AUC: 0.840220
Avg Precision: 0.405241
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.101137
valid_loss: 1.118070
validation finished
normal learning rate scheduler step
Epoch-43 lr: 2.4944636998734017e-05
Epoch-43 lr: 2.4944636998734017e-05
epoch 43 training time: 6.437
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8d50460>
The learning rate scheduler starts at 6 epoch with decay rate of 0.614 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 12:40:50.768014
current #epochs=1, #steps=0
start validation
acc: 0.636364
AUC: 0.805785
Avg Precision: 0.357966
Avg Recall: 1.000000
d_prime: 1.219715
train_loss: 0.113688
valid_loss: 1.176245
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0031076420417219157
Epoch-1 lr: 0.0031076420417219157
epoch 1 training time: 9.021
---------------
2023-09-12 12:40:59.789655
current #epochs=2, #steps=8
start validation
acc: 0.659091
AUC: 0.796832
Avg Precision: 0.353212
Avg Recall: 1.000000
d_prime: 1.174304
train_loss: 0.175539
valid_loss: 1.148232
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0031076420417219157
Epoch-2 lr: 0.0031076420417219157
epoch 2 training time: 9.191
---------------
2023-09-12 12:41:08.980667
current #epochs=3, #steps=16
start validation
acc: 0.613636
AUC: 0.845730
Avg Precision: 0.447370
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.240679
valid_loss: 1.123930
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0031076420417219157
Epoch-3 lr: 0.0031076420417219157
epoch 3 training time: 6.439
---------------
2023-09-12 12:41:15.419273
current #epochs=4, #steps=24
start validation
acc: 0.636364
AUC: 0.825758
Avg Precision: 0.311844
Avg Recall: 1.000000
d_prime: 1.325871
train_loss: 0.150758
valid_loss: 1.138142
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0031076420417219157
Epoch-4 lr: 0.0031076420417219157
epoch 4 training time: 6.621
---------------
2023-09-12 12:41:22.040747
current #epochs=5, #steps=32
start validation
acc: 0.659091
AUC: 0.818871
Avg Precision: 0.326947
Avg Recall: 1.000000
d_prime: 1.288446
train_loss: 0.159016
valid_loss: 1.153982
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0031076420417219157
Epoch-5 lr: 0.0031076420417219157
epoch 5 training time: 6.695
---------------
2023-09-12 12:41:28.735804
current #epochs=6, #steps=40
start validation
acc: 0.590909
AUC: 0.811983
Avg Precision: 0.351280
Avg Recall: 1.000000
d_prime: 1.251903
train_loss: 0.132469
valid_loss: 1.149110
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0019091843101120471
Epoch-6 lr: 0.0019091843101120471
epoch 6 training time: 6.365
---------------
2023-09-12 12:41:35.101128
current #epochs=7, #steps=48
start validation
acc: 0.613636
AUC: 0.822314
Avg Precision: 0.387681
Avg Recall: 1.000000
d_prime: 1.307044
train_loss: 0.109685
valid_loss: 1.141452
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0019091843101120471
Epoch-7 lr: 0.0019091843101120471
epoch 7 training time: 6.555
---------------
2023-09-12 12:41:41.656733
current #epochs=8, #steps=56
start validation
acc: 0.636364
AUC: 0.819559
Avg Precision: 0.373512
Avg Recall: 1.000000
d_prime: 1.292148
train_loss: 0.112721
valid_loss: 1.147865
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0019091843101120471
Epoch-8 lr: 0.0019091843101120471
epoch 8 training time: 6.452
---------------
2023-09-12 12:41:48.108460
current #epochs=9, #steps=64
start validation
acc: 0.659091
AUC: 0.834022
Avg Precision: 0.423735
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.145877
valid_loss: 1.132633
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0019091843101120471
Epoch-9 lr: 0.0019091843101120471
epoch 9 training time: 7.090
---------------
2023-09-12 12:41:55.197975
current #epochs=10, #steps=72
start validation
acc: 0.659091
AUC: 0.853994
Avg Precision: 0.447953
Avg Recall: 1.000000
d_prime: 1.490185
train_loss: 0.119252
valid_loss: 1.107918
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0011729100974442865
Epoch-10 lr: 0.0011729100974442865
epoch 10 training time: 6.553
---------------
2023-09-12 12:42:01.750587
current #epochs=11, #steps=80
start validation
acc: 0.636364
AUC: 0.846419
Avg Precision: 0.453388
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.172783
valid_loss: 1.111749
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0011729100974442865
Epoch-11 lr: 0.0011729100974442865
epoch 11 training time: 6.793
---------------
2023-09-12 12:42:08.543540
current #epochs=12, #steps=88
start validation
acc: 0.613636
AUC: 0.842975
Avg Precision: 0.470168
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.108947
valid_loss: 1.112483
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0011729100974442865
Epoch-12 lr: 0.0011729100974442865
epoch 12 training time: 7.255
---------------
2023-09-12 12:42:15.798474
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01218	Per Sample Data Time 0.00645	Per Sample DNN Time 0.00573	Train Loss 0.0818	
start validation
acc: 0.636364
AUC: 0.835399
Avg Precision: 0.424034
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.088230
valid_loss: 1.125088
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0011729100974442865
Epoch-13 lr: 0.0011729100974442865
epoch 13 training time: 6.408
---------------
2023-09-12 12:42:22.206019
current #epochs=14, #steps=104
start validation
acc: 0.613636
AUC: 0.839532
Avg Precision: 0.406760
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.092926
valid_loss: 1.123774
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0007205789872670945
Epoch-14 lr: 0.0007205789872670945
epoch 14 training time: 6.420
---------------
2023-09-12 12:42:28.626030
current #epochs=15, #steps=112
start validation
acc: 0.613636
AUC: 0.839532
Avg Precision: 0.397024
Avg Recall: 1.000000
d_prime: 1.403656
train_loss: 0.109729
valid_loss: 1.120375
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0007205789872670945
Epoch-15 lr: 0.0007205789872670945
epoch 15 training time: 7.083
---------------
2023-09-12 12:42:35.709231
current #epochs=16, #steps=120
start validation
acc: 0.613636
AUC: 0.835399
Avg Precision: 0.377623
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.080278
valid_loss: 1.119531
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0007205789872670945
Epoch-16 lr: 0.0007205789872670945
epoch 16 training time: 6.427
---------------
2023-09-12 12:42:42.136605
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.835399
Avg Precision: 0.374033
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.138840
valid_loss: 1.120898
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0007205789872670945
Epoch-17 lr: 0.0007205789872670945
epoch 17 training time: 6.704
---------------
2023-09-12 12:42:48.840733
current #epochs=18, #steps=136
start validation
acc: 0.636364
AUC: 0.833333
Avg Precision: 0.389428
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.078181
valid_loss: 1.130364
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.000442688726119979
Epoch-18 lr: 0.000442688726119979
epoch 18 training time: 6.231
---------------
2023-09-12 12:42:55.071608
current #epochs=19, #steps=144
start validation
acc: 0.636364
AUC: 0.836088
Avg Precision: 0.398438
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.123023
valid_loss: 1.133937
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.000442688726119979
Epoch-19 lr: 0.000442688726119979
epoch 19 training time: 7.891
---------------
2023-09-12 12:43:02.962708
current #epochs=20, #steps=152
start validation
acc: 0.613636
AUC: 0.840220
Avg Precision: 0.410714
Avg Recall: 1.000000
d_prime: 1.407657
train_loss: 0.088629
valid_loss: 1.131695
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.000442688726119979
Epoch-20 lr: 0.000442688726119979
epoch 20 training time: 6.989
---------------
2023-09-12 12:43:09.951441
current #epochs=21, #steps=160
start validation
acc: 0.613636
AUC: 0.843664
Avg Precision: 0.426113
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.066220
valid_loss: 1.130175
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.000442688726119979
Epoch-21 lr: 0.000442688726119979
epoch 21 training time: 6.313
---------------
2023-09-12 12:43:16.264255
current #epochs=22, #steps=168
start validation
acc: 0.613636
AUC: 0.845041
Avg Precision: 0.421073
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.066903
valid_loss: 1.128168
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0002719664487816781
Epoch-22 lr: 0.0002719664487816781
epoch 22 training time: 6.864
---------------
2023-09-12 12:43:23.128302
current #epochs=23, #steps=176
start validation
acc: 0.613636
AUC: 0.846419
Avg Precision: 0.416091
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.068016
valid_loss: 1.128886
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0002719664487816781
Epoch-23 lr: 0.0002719664487816781
epoch 23 training time: 7.618
---------------
2023-09-12 12:43:30.746532
current #epochs=24, #steps=184
start validation
acc: 0.613636
AUC: 0.844353
Avg Precision: 0.396949
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.060517
valid_loss: 1.129723
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0002719664487816781
Epoch-24 lr: 0.0002719664487816781
epoch 24 training time: 6.274
---------------
2023-09-12 12:43:37.019999
current #epochs=25, #steps=192
start validation
acc: 0.636364
AUC: 0.842975
Avg Precision: 0.396949
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.132786
valid_loss: 1.130451
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0002719664487816781
Epoch-25 lr: 0.0002719664487816781
epoch 25 training time: 6.333
---------------
2023-09-12 12:43:43.353455
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03474	Per Sample Data Time 0.02915	Per Sample DNN Time 0.00559	Train Loss 0.0448	
start validation
acc: 0.636364
AUC: 0.840909
Avg Precision: 0.392366
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.085761
valid_loss: 1.130456
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00016708297478276125
Epoch-26 lr: 0.00016708297478276125
epoch 26 training time: 6.771
---------------
2023-09-12 12:43:50.124562
current #epochs=27, #steps=208
start validation
acc: 0.636364
AUC: 0.838843
Avg Precision: 0.392366
Avg Recall: 1.000000
d_prime: 1.399667
train_loss: 0.072543
valid_loss: 1.130512
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00016708297478276125
Epoch-27 lr: 0.00016708297478276125
epoch 27 training time: 6.255
---------------
2023-09-12 12:43:56.379711
current #epochs=28, #steps=216
start validation
acc: 0.659091
AUC: 0.840909
Avg Precision: 0.392366
Avg Recall: 1.000000
d_prime: 1.411670
train_loss: 0.051564
valid_loss: 1.128776
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00016708297478276125
Epoch-28 lr: 0.00016708297478276125
epoch 28 training time: 7.946
---------------
2023-09-12 12:44:04.326176
current #epochs=29, #steps=224
start validation
acc: 0.659091
AUC: 0.843664
Avg Precision: 0.389762
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.088681
valid_loss: 1.128051
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00016708297478276125
Epoch-29 lr: 0.00016708297478276125
epoch 29 training time: 6.559
---------------
2023-09-12 12:44:10.885284
current #epochs=30, #steps=232
start validation
acc: 0.636364
AUC: 0.841598
Avg Precision: 0.389762
Avg Recall: 1.000000
d_prime: 1.415693
train_loss: 0.060793
valid_loss: 1.127539
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0001026476632956555
Epoch-30 lr: 0.0001026476632956555
epoch 30 training time: 6.359
---------------
2023-09-12 12:44:17.244555
current #epochs=31, #steps=240
start validation
acc: 0.636364
AUC: 0.842975
Avg Precision: 0.389762
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.092735
valid_loss: 1.127328
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0001026476632956555
Epoch-31 lr: 0.0001026476632956555
epoch 31 training time: 7.828
---------------
2023-09-12 12:44:25.072597
current #epochs=32, #steps=248
start validation
acc: 0.659091
AUC: 0.845730
Avg Precision: 0.393399
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.051303
valid_loss: 1.127381
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0001026476632956555
Epoch-32 lr: 0.0001026476632956555
epoch 32 training time: 6.876
---------------
2023-09-12 12:44:31.948772
current #epochs=33, #steps=256
start validation
acc: 0.659091
AUC: 0.845730
Avg Precision: 0.393399
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.079280
valid_loss: 1.127919
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0001026476632956555
Epoch-33 lr: 0.0001026476632956555
epoch 33 training time: 6.398
---------------
2023-09-12 12:44:38.347021
current #epochs=34, #steps=264
start validation
acc: 0.659091
AUC: 0.843664
Avg Precision: 0.393399
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.090672
valid_loss: 1.128406
validation finished
normal learning rate scheduler step
Epoch-34 lr: 6.306173800028228e-05
Epoch-34 lr: 6.306173800028228e-05
epoch 34 training time: 6.307
---------------
2023-09-12 12:44:44.653555
current #epochs=35, #steps=272
start validation
acc: 0.659091
AUC: 0.843664
Avg Precision: 0.393399
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.077561
valid_loss: 1.128206
validation finished
normal learning rate scheduler step
Epoch-35 lr: 6.306173800028228e-05
Epoch-35 lr: 6.306173800028228e-05
epoch 35 training time: 6.152
---------------
2023-09-12 12:44:50.805531
current #epochs=36, #steps=280
start validation
acc: 0.659091
AUC: 0.845041
Avg Precision: 0.393399
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.042907
valid_loss: 1.128133
validation finished
normal learning rate scheduler step
Epoch-36 lr: 6.306173800028228e-05
Epoch-36 lr: 6.306173800028228e-05
epoch 36 training time: 7.574
---------------
2023-09-12 12:44:58.379396
current #epochs=37, #steps=288
start validation
acc: 0.659091
AUC: 0.845041
Avg Precision: 0.393399
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.059642
valid_loss: 1.127712
validation finished
normal learning rate scheduler step
Epoch-37 lr: 6.306173800028228e-05
Epoch-37 lr: 6.306173800028228e-05
epoch 37 training time: 6.832
---------------
2023-09-12 12:45:05.211072
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01176	Per Sample Data Time 0.00632	Per Sample DNN Time 0.00544	Train Loss 0.0626	
start validation
acc: 0.659091
AUC: 0.844353
Avg Precision: 0.393399
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.065827
valid_loss: 1.127133
validation finished
normal learning rate scheduler step
Epoch-38 lr: 3.8742068469322486e-05
Epoch-38 lr: 3.8742068469322486e-05
epoch 38 training time: 6.379
---------------
2023-09-12 12:45:11.590051
current #epochs=39, #steps=304
start validation
acc: 0.659091
AUC: 0.843664
Avg Precision: 0.393399
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.071990
valid_loss: 1.126830
validation finished
normal learning rate scheduler step
Epoch-39 lr: 3.8742068469322486e-05
Epoch-39 lr: 3.8742068469322486e-05
epoch 39 training time: 6.332
---------------
2023-09-12 12:45:17.922372
current #epochs=40, #steps=312
start validation
acc: 0.659091
AUC: 0.843664
Avg Precision: 0.393399
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.081127
valid_loss: 1.126794
validation finished
normal learning rate scheduler step
Epoch-40 lr: 3.8742068469322486e-05
Epoch-40 lr: 3.8742068469322486e-05
epoch 40 training time: 6.416
---------------
2023-09-12 12:45:24.338030
current #epochs=41, #steps=320
start validation
acc: 0.659091
AUC: 0.842287
Avg Precision: 0.389762
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.076291
valid_loss: 1.127079
validation finished
normal learning rate scheduler step
Epoch-41 lr: 3.8742068469322486e-05
Epoch-41 lr: 3.8742068469322486e-05
epoch 41 training time: 6.262
---------------
2023-09-12 12:45:30.600480
current #epochs=42, #steps=328
start validation
[I 2023-09-12 12:45:36,785] Trial 96 finished with value: 0.6590909090909091 and parameters: {'warmup': 'False', 'num_epochs': 42, 'batch_size': 13, 'lr-adaptschedule': 'True', 'lr': 0.0031076420417219157, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.6143514228730751}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.659091
AUC: 0.842975
Avg Precision: 0.394345
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.079241
valid_loss: 1.127582
validation finished
normal learning rate scheduler step
Epoch-42 lr: 2.3801244889174367e-05
Epoch-42 lr: 2.3801244889174367e-05
epoch 42 training time: 6.178
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95bc797460>
The learning rate scheduler starts at 7 epoch with decay rate of 0.636 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 12:45:36.826061
current #epochs=1, #steps=0
start validation
acc: 0.659091
AUC: 0.825069
Avg Precision: 0.375889
Avg Recall: 1.000000
d_prime: 1.322087
train_loss: 0.123648
valid_loss: 1.147550
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003221228082561986
Epoch-1 lr: 0.009663684247685957
epoch 1 training time: 8.868
---------------
2023-09-12 12:45:45.694131
current #epochs=2, #steps=8
start validation
acc: 0.613636
AUC: 0.823691
Avg Precision: 0.378321
Avg Recall: 1.000000
d_prime: 1.314547
train_loss: 0.207611
valid_loss: 1.132613
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003221228082561986
Epoch-2 lr: 0.009663684247685957
epoch 2 training time: 9.051
---------------
2023-09-12 12:45:54.745294
current #epochs=3, #steps=16
start validation
acc: 0.659091
AUC: 0.842975
Avg Precision: 0.392526
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.206935
valid_loss: 1.125520
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003221228082561986
Epoch-3 lr: 0.009663684247685957
epoch 3 training time: 8.666
---------------
2023-09-12 12:46:03.411756
current #epochs=4, #steps=24
start validation
acc: 0.704545
AUC: 0.826446
Avg Precision: 0.449647
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.200647
valid_loss: 1.112764
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003221228082561986
Epoch-4 lr: 0.009663684247685957
epoch 4 training time: 10.036
---------------
2023-09-12 12:46:13.447898
current #epochs=5, #steps=32
start validation
acc: 0.636364
AUC: 0.823691
Avg Precision: 0.379010
Avg Recall: 1.000000
d_prime: 1.314547
train_loss: 0.183726
valid_loss: 1.133964
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.003221228082561986
Epoch-5 lr: 0.009663684247685957
epoch 5 training time: 6.731
---------------
2023-09-12 12:46:20.178691
current #epochs=6, #steps=40
start validation
acc: 0.613636
AUC: 0.815427
Avg Precision: 0.370238
Avg Recall: 1.000000
d_prime: 1.270069
train_loss: 0.242178
valid_loss: 1.140857
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.003221228082561986
Epoch-6 lr: 0.009663684247685957
epoch 6 training time: 6.396
---------------
2023-09-12 12:46:26.575347
current #epochs=7, #steps=48
start validation
acc: 0.636364
AUC: 0.827135
Avg Precision: 0.396726
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.153798
valid_loss: 1.148652
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002047302646556722
Epoch-7 lr: 0.006141907939670166
epoch 7 training time: 6.380
---------------
2023-09-12 12:46:32.954852
current #epochs=8, #steps=56
start validation
acc: 0.659091
AUC: 0.813361
Avg Precision: 0.396165
Avg Recall: 1.000000
d_prime: 1.259144
train_loss: 0.170003
valid_loss: 1.154013
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.002047302646556722
Epoch-8 lr: 0.006141907939670166
epoch 8 training time: 6.469
---------------
2023-09-12 12:46:39.424316
current #epochs=9, #steps=64
start validation
acc: 0.522727
AUC: 0.816804
Avg Precision: 0.381359
Avg Recall: 1.000000
d_prime: 1.277394
train_loss: 0.200217
valid_loss: 1.152596
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.002047302646556722
Epoch-9 lr: 0.006141907939670166
epoch 9 training time: 6.525
---------------
2023-09-12 12:46:45.948822
current #epochs=10, #steps=72
start validation
acc: 0.568182
AUC: 0.810606
Avg Precision: 0.343990
Avg Recall: 1.000000
d_prime: 1.244694
train_loss: 0.131820
valid_loss: 1.141284
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.002047302646556722
Epoch-10 lr: 0.006141907939670166
epoch 10 training time: 6.354
---------------
2023-09-12 12:46:52.303278
current #epochs=11, #steps=80
start validation
acc: 0.545455
AUC: 0.810606
Avg Precision: 0.364216
Avg Recall: 1.000000
d_prime: 1.244694
train_loss: 0.113652
valid_loss: 1.147845
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.002047302646556722
Epoch-11 lr: 0.006141907939670166
epoch 11 training time: 6.416
---------------
2023-09-12 12:46:58.719344
current #epochs=12, #steps=88
start validation
acc: 0.590909
AUC: 0.819559
Avg Precision: 0.370724
Avg Recall: 1.000000
d_prime: 1.292148
train_loss: 0.171983
valid_loss: 1.139567
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0013011956990218816
Epoch-12 lr: 0.0039035870970656446
epoch 12 training time: 6.268
---------------
2023-09-12 12:47:04.987121
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01183	Per Sample Data Time 0.00638	Per Sample DNN Time 0.00545	Train Loss 0.1285	
start validation
acc: 0.590909
AUC: 0.827135
Avg Precision: 0.375521
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.131729
valid_loss: 1.138113
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0013011956990218816
Epoch-13 lr: 0.0039035870970656446
epoch 13 training time: 6.342
---------------
2023-09-12 12:47:11.328686
current #epochs=14, #steps=104
start validation
acc: 0.613636
AUC: 0.833333
Avg Precision: 0.390425
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.095378
valid_loss: 1.134496
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0013011956990218816
Epoch-14 lr: 0.0039035870970656446
epoch 14 training time: 6.931
---------------
2023-09-12 12:47:18.259323
current #epochs=15, #steps=112
start validation
acc: 0.636364
AUC: 0.847107
Avg Precision: 0.448239
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.083275
valid_loss: 1.126110
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0013011956990218816
Epoch-15 lr: 0.0039035870970656446
epoch 15 training time: 6.516
---------------
2023-09-12 12:47:24.775072
current #epochs=16, #steps=120
start validation
acc: 0.659091
AUC: 0.850551
Avg Precision: 0.432668
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.062993
valid_loss: 1.120603
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0013011956990218816
Epoch-16 lr: 0.0039035870970656446
epoch 16 training time: 6.413
---------------
2023-09-12 12:47:31.187851
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.850551
Avg Precision: 0.485049
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.105759
valid_loss: 1.118660
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0008269955836771953
Epoch-17 lr: 0.002480986751031586
epoch 17 training time: 6.292
---------------
2023-09-12 12:47:37.479716
current #epochs=18, #steps=136
start validation
acc: 0.636364
AUC: 0.845730
Avg Precision: 0.450980
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.096237
valid_loss: 1.123592
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0008269955836771953
Epoch-18 lr: 0.002480986751031586
epoch 18 training time: 7.389
---------------
2023-09-12 12:47:44.868914
current #epochs=19, #steps=144
start validation
acc: 0.636364
AUC: 0.842975
Avg Precision: 0.415128
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.097396
valid_loss: 1.127316
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0008269955836771953
Epoch-19 lr: 0.002480986751031586
epoch 19 training time: 6.743
---------------
2023-09-12 12:47:51.612057
current #epochs=20, #steps=152
start validation
acc: 0.590909
AUC: 0.836088
Avg Precision: 0.400968
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.086685
valid_loss: 1.132434
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0008269955836771953
Epoch-20 lr: 0.002480986751031586
epoch 20 training time: 6.627
---------------
2023-09-12 12:47:58.239069
current #epochs=21, #steps=160
start validation
acc: 0.590909
AUC: 0.825069
Avg Precision: 0.376158
Avg Recall: 1.000000
d_prime: 1.322087
train_loss: 0.111717
valid_loss: 1.139958
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0008269955836771953
Epoch-21 lr: 0.002480986751031586
epoch 21 training time: 6.495
---------------
2023-09-12 12:48:04.734328
current #epochs=22, #steps=168
start validation
acc: 0.568182
AUC: 0.825758
Avg Precision: 0.382738
Avg Recall: 1.000000
d_prime: 1.325871
train_loss: 0.113517
valid_loss: 1.135525
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0005256101721944623
Epoch-22 lr: 0.001576830516583387
epoch 22 training time: 7.107
---------------
2023-09-12 12:48:11.841359
current #epochs=23, #steps=176
start validation
acc: 0.613636
AUC: 0.825758
Avg Precision: 0.370238
Avg Recall: 1.000000
d_prime: 1.325871
train_loss: 0.138281
valid_loss: 1.130167
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0005256101721944623
Epoch-23 lr: 0.001576830516583387
epoch 23 training time: 6.431
---------------
2023-09-12 12:48:18.272383
current #epochs=24, #steps=184
start validation
acc: 0.590909
AUC: 0.831267
Avg Precision: 0.382073
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.080989
valid_loss: 1.126370
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0005256101721944623
Epoch-24 lr: 0.001576830516583387
epoch 24 training time: 9.075
---------------
2023-09-12 12:48:27.347399
current #epochs=25, #steps=192
start validation
acc: 0.613636
AUC: 0.836088
Avg Precision: 0.387974
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.073172
valid_loss: 1.128029
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0005256101721944623
Epoch-25 lr: 0.001576830516583387
epoch 25 training time: 7.284
---------------
2023-09-12 12:48:34.631781
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03445	Per Sample Data Time 0.02835	Per Sample DNN Time 0.00610	Train Loss 0.0148	
start validation
acc: 0.590909
AUC: 0.837466
Avg Precision: 0.395211
Avg Recall: 1.000000
d_prime: 1.391720
train_loss: 0.085826
valid_loss: 1.128964
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0005256101721944623
Epoch-26 lr: 0.001576830516583387
epoch 26 training time: 6.458
---------------
2023-09-12 12:48:41.089585
current #epochs=27, #steps=208
start validation
acc: 0.590909
AUC: 0.834711
Avg Precision: 0.392439
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.062416
valid_loss: 1.129492
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0003340598892752109
Epoch-27 lr: 0.0010021796678256329
epoch 27 training time: 7.042
---------------
2023-09-12 12:48:48.131620
current #epochs=28, #steps=216
start validation
acc: 0.590909
AUC: 0.834711
Avg Precision: 0.387384
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.101103
valid_loss: 1.130598
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0003340598892752109
Epoch-28 lr: 0.0010021796678256329
epoch 28 training time: 8.469
---------------
2023-09-12 12:48:56.600339
current #epochs=29, #steps=224
start validation
acc: 0.590909
AUC: 0.831956
Avg Precision: 0.371289
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.101573
valid_loss: 1.132105
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0003340598892752109
Epoch-29 lr: 0.0010021796678256329
epoch 29 training time: 6.323
---------------
2023-09-12 12:49:02.923034
current #epochs=30, #steps=232
start validation
acc: 0.590909
AUC: 0.832645
Avg Precision: 0.379116
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.134391
valid_loss: 1.133748
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0003340598892752109
Epoch-30 lr: 0.0010021796678256329
epoch 30 training time: 9.590
---------------
2023-09-12 12:49:12.513311
current #epochs=31, #steps=240
start validation
acc: 0.590909
AUC: 0.832645
Avg Precision: 0.370040
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.095074
valid_loss: 1.134151
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0003340598892752109
Epoch-31 lr: 0.0010021796678256329
epoch 31 training time: 6.577
---------------
2023-09-12 12:49:19.090029
current #epochs=32, #steps=248
start validation
acc: 0.590909
AUC: 0.832645
Avg Precision: 0.367729
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.103081
valid_loss: 1.133413
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00021231706600472437
Epoch-32 lr: 0.0006369511980141732
epoch 32 training time: 8.170
---------------
2023-09-12 12:49:27.260000
current #epochs=33, #steps=256
start validation
acc: 0.590909
AUC: 0.831956
Avg Precision: 0.370040
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.115049
valid_loss: 1.132378
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.00021231706600472437
Epoch-33 lr: 0.0006369511980141732
epoch 33 training time: 6.432
---------------
2023-09-12 12:49:33.692083
current #epochs=34, #steps=264
start validation
acc: 0.613636
AUC: 0.833333
Avg Precision: 0.370040
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.045525
valid_loss: 1.131102
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.00021231706600472437
Epoch-34 lr: 0.0006369511980141732
epoch 34 training time: 6.445
---------------
2023-09-12 12:49:40.137895
current #epochs=35, #steps=272
start validation
acc: 0.613636
AUC: 0.833333
Avg Precision: 0.370040
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.078407
valid_loss: 1.130445
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.00021231706600472437
Epoch-35 lr: 0.0006369511980141732
epoch 35 training time: 6.256
---------------
2023-09-12 12:49:46.393393
current #epochs=36, #steps=280
start validation
acc: 0.613636
AUC: 0.832645
Avg Precision: 0.370040
Avg Recall: 1.000000
d_prime: 1.364248
train_loss: 0.095529
valid_loss: 1.130816
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.00021231706600472437
Epoch-36 lr: 0.0006369511980141732
epoch 36 training time: 6.374
---------------
2023-09-12 12:49:52.767539
current #epochs=37, #steps=288
start validation
acc: 0.613636
AUC: 0.831267
Avg Precision: 0.375474
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.090624
valid_loss: 1.130829
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.00013494148194402686
Epoch-37 lr: 0.0004048244458320806
epoch 37 training time: 6.450
---------------
2023-09-12 12:49:59.216883
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01209	Per Sample Data Time 0.00625	Per Sample DNN Time 0.00584	Train Loss 0.0851	
start validation
acc: 0.613636
AUC: 0.829201
Avg Precision: 0.370391
Avg Recall: 1.000000
d_prime: 1.344935
train_loss: 0.086239
valid_loss: 1.131312
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.00013494148194402686
Epoch-38 lr: 0.0004048244458320806
epoch 38 training time: 6.353
---------------
2023-09-12 12:50:05.570566
current #epochs=39, #steps=304
start validation
acc: 0.613636
AUC: 0.829890
Avg Precision: 0.373163
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.053173
valid_loss: 1.131354
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.00013494148194402686
Epoch-39 lr: 0.0004048244458320806
epoch 39 training time: 8.413
---------------
2023-09-12 12:50:13.982861
current #epochs=40, #steps=312
start validation
acc: 0.613636
AUC: 0.833333
Avg Precision: 0.384384
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.078981
valid_loss: 1.130824
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.00013494148194402686
Epoch-40 lr: 0.0004048244458320806
epoch 40 training time: 11.171
---------------
2023-09-12 12:50:25.153779
current #epochs=41, #steps=320
start validation
acc: 0.613636
AUC: 0.833333
Avg Precision: 0.384384
Avg Recall: 1.000000
d_prime: 1.368141
train_loss: 0.077177
valid_loss: 1.130392
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.00013494148194402686
Epoch-41 lr: 0.0004048244458320806
epoch 41 training time: 6.376
---------------
2023-09-12 12:50:31.529434
current #epochs=42, #steps=328
start validation
acc: 0.613636
AUC: 0.834022
Avg Precision: 0.384384
Avg Recall: 1.000000
d_prime: 1.372044
train_loss: 0.059871
valid_loss: 1.129998
validation finished
normal learning rate scheduler step
Epoch-42 lr: 8.576420111629154e-05
Epoch-42 lr: 0.0002572926033488746
epoch 42 training time: 6.404
---------------
2023-09-12 12:50:37.933389
current #epochs=43, #steps=336
start validation
acc: 0.613636
AUC: 0.836088
Avg Precision: 0.384384
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.054855
valid_loss: 1.129791
validation finished
normal learning rate scheduler step
Epoch-43 lr: 8.576420111629154e-05
Epoch-43 lr: 0.0002572926033488746
epoch 43 training time: 6.304
---------------
2023-09-12 12:50:44.237911
current #epochs=44, #steps=344
start validation
acc: 0.613636
AUC: 0.835399
Avg Precision: 0.384384
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.054130
valid_loss: 1.129666
validation finished
normal learning rate scheduler step
Epoch-44 lr: 8.576420111629154e-05
Epoch-44 lr: 0.0002572926033488746
epoch 44 training time: 8.346
---------------
2023-09-12 12:50:52.584061
current #epochs=45, #steps=352
start validation
acc: 0.613636
AUC: 0.836088
Avg Precision: 0.384384
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.092388
valid_loss: 1.129585
validation finished
normal learning rate scheduler step
Epoch-45 lr: 8.576420111629154e-05
Epoch-45 lr: 0.0002572926033488746
epoch 45 training time: 7.188
---------------
2023-09-12 12:50:59.772083
current #epochs=46, #steps=360
start validation
acc: 0.613636
AUC: 0.835399
Avg Precision: 0.384384
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.084120
valid_loss: 1.129427
validation finished
normal learning rate scheduler step
Epoch-46 lr: 8.576420111629154e-05
Epoch-46 lr: 0.0002572926033488746
epoch 46 training time: 6.193
---------------
2023-09-12 12:51:05.965415
current #epochs=47, #steps=368
start validation
acc: 0.613636
AUC: 0.836777
Avg Precision: 0.387545
Avg Recall: 1.000000
d_prime: 1.387764
train_loss: 0.084917
valid_loss: 1.129511
validation finished
normal learning rate scheduler step
Epoch-47 lr: 5.450879957111136e-05
Epoch-47 lr: 0.00016352639871333407
epoch 47 training time: 9.308
---------------
2023-09-12 12:51:15.273075
current #epochs=48, #steps=376
start validation
[I 2023-09-12 12:51:21,667] Trial 97 finished with value: 0.7045454545454546 and parameters: {'warmup': 'False', 'num_epochs': 48, 'batch_size': 11, 'lr-adaptschedule': 'True', 'lr': 0.003221228082561986, 'head-lr': 3, 'lr-scheduler-start': 7, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.6355658755242228}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.613636
AUC: 0.836088
Avg Precision: 0.387545
Avg Recall: 1.000000
d_prime: 1.383818
train_loss: 0.095603
valid_loss: 1.129379
validation finished
normal learning rate scheduler step
Epoch-48 lr: 5.450879957111136e-05
Epoch-48 lr: 0.00016352639871333407
epoch 48 training time: 6.388
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8e67c70>
The learning rate scheduler starts at 6 epoch with decay rate of 0.644 every 6 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 12:51:21.708543
current #epochs=1, #steps=0
start validation
acc: 0.613636
AUC: 0.855372
Avg Precision: 0.442361
Avg Recall: 1.000000
d_prime: 1.498720
train_loss: 0.166211
valid_loss: 1.113300
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0030501468688659546
Epoch-1 lr: 0.0030501468688659546
epoch 1 training time: 10.314
---------------
2023-09-12 12:51:32.022859
current #epochs=2, #steps=8
start validation
acc: 0.590909
AUC: 0.827135
Avg Precision: 0.375448
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.181441
valid_loss: 1.135120
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0030501468688659546
Epoch-2 lr: 0.0030501468688659546
epoch 2 training time: 7.440
---------------
2023-09-12 12:51:39.463239
current #epochs=3, #steps=16
start validation
acc: 0.590909
AUC: 0.809229
Avg Precision: 0.363248
Avg Recall: 1.000000
d_prime: 1.237518
train_loss: 0.123714
valid_loss: 1.152619
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0030501468688659546
Epoch-3 lr: 0.0030501468688659546
epoch 3 training time: 6.426
---------------
2023-09-12 12:51:45.889267
current #epochs=4, #steps=24
start validation
acc: 0.522727
AUC: 0.796143
Avg Precision: 0.353169
Avg Recall: 1.000000
d_prime: 1.170861
train_loss: 0.173108
valid_loss: 1.163687
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0030501468688659546
Epoch-4 lr: 0.0030501468688659546
epoch 4 training time: 7.281
---------------
2023-09-12 12:51:53.170117
current #epochs=5, #steps=32
start validation
acc: 0.590909
AUC: 0.800964
Avg Precision: 0.358008
Avg Recall: 1.000000
d_prime: 1.195110
train_loss: 0.136566
valid_loss: 1.161282
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0030501468688659546
Epoch-5 lr: 0.0030501468688659546
epoch 5 training time: 6.407
---------------
2023-09-12 12:51:59.576888
current #epochs=6, #steps=40
start validation
acc: 0.590909
AUC: 0.831267
Avg Precision: 0.381988
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.156752
valid_loss: 1.129864
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0019636836379523285
Epoch-6 lr: 0.0019636836379523285
epoch 6 training time: 7.306
---------------
2023-09-12 12:52:06.882973
current #epochs=7, #steps=48
start validation
acc: 0.613636
AUC: 0.831956
Avg Precision: 0.400609
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.112709
valid_loss: 1.128855
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0019636836379523285
Epoch-7 lr: 0.0019636836379523285
epoch 7 training time: 7.225
---------------
2023-09-12 12:52:14.107737
current #epochs=8, #steps=56
start validation
acc: 0.613636
AUC: 0.834711
Avg Precision: 0.386824
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.089672
valid_loss: 1.131438
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0019636836379523285
Epoch-8 lr: 0.0019636836379523285
epoch 8 training time: 10.019
---------------
2023-09-12 12:52:24.126823
current #epochs=9, #steps=64
start validation
acc: 0.613636
AUC: 0.829890
Avg Precision: 0.388889
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.081431
valid_loss: 1.134117
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0019636836379523285
Epoch-9 lr: 0.0019636836379523285
epoch 9 training time: 7.391
---------------
2023-09-12 12:52:31.517584
current #epochs=10, #steps=72
start validation
acc: 0.636364
AUC: 0.824380
Avg Precision: 0.382062
Avg Recall: 1.000000
d_prime: 1.318312
train_loss: 0.069880
valid_loss: 1.145694
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0019636836379523285
Epoch-10 lr: 0.0019636836379523285
epoch 10 training time: 12.519
---------------
2023-09-12 12:52:44.037144
current #epochs=11, #steps=80
start validation
acc: 0.636364
AUC: 0.819559
Avg Precision: 0.365424
Avg Recall: 1.000000
d_prime: 1.292148
train_loss: 0.136226
valid_loss: 1.147642
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0019636836379523285
Epoch-11 lr: 0.0019636836379523285
epoch 11 training time: 6.422
---------------
2023-09-12 12:52:50.459137
current #epochs=12, #steps=88
start validation
acc: 0.636364
AUC: 0.821625
Avg Precision: 0.364423
Avg Recall: 1.000000
d_prime: 1.303307
train_loss: 0.100421
valid_loss: 1.146396
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0012642189362492482
Epoch-12 lr: 0.0012642189362492482
epoch 12 training time: 7.084
---------------
2023-09-12 12:52:57.543430
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01210	Per Sample Data Time 0.00635	Per Sample DNN Time 0.00575	Train Loss 0.1185	
start validation
acc: 0.613636
AUC: 0.826446
Avg Precision: 0.401910
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.103061
valid_loss: 1.142968
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0012642189362492482
Epoch-13 lr: 0.0012642189362492482
epoch 13 training time: 6.663
---------------
2023-09-12 12:53:04.205999
current #epochs=14, #steps=104
start validation
acc: 0.590909
AUC: 0.835399
Avg Precision: 0.406403
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.062890
valid_loss: 1.140662
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0012642189362492482
Epoch-14 lr: 0.0012642189362492482
epoch 14 training time: 6.398
---------------
2023-09-12 12:53:10.603792
current #epochs=15, #steps=112
start validation
acc: 0.590909
AUC: 0.835399
Avg Precision: 0.406403
Avg Recall: 1.000000
d_prime: 1.379883
train_loss: 0.093375
valid_loss: 1.138229
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0012642189362492482
Epoch-15 lr: 0.0012642189362492482
epoch 15 training time: 7.540
---------------
2023-09-12 12:53:18.144048
current #epochs=16, #steps=120
start validation
acc: 0.613636
AUC: 0.829890
Avg Precision: 0.392599
Avg Recall: 1.000000
d_prime: 1.348778
train_loss: 0.065831
valid_loss: 1.136990
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0012642189362492482
Epoch-16 lr: 0.0012642189362492482
epoch 16 training time: 6.527
---------------
2023-09-12 12:53:24.670936
current #epochs=17, #steps=128
start validation
acc: 0.613636
AUC: 0.834711
Avg Precision: 0.392599
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.057633
valid_loss: 1.155468
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0012642189362492482
Epoch-17 lr: 0.0012642189362492482
epoch 17 training time: 8.865
---------------
2023-09-12 12:53:33.536122
current #epochs=18, #steps=136
start validation
acc: 0.636364
AUC: 0.827135
Avg Precision: 0.374093
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.117296
valid_loss: 1.168501
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0008139037714027032
Epoch-18 lr: 0.0008139037714027032
epoch 18 training time: 7.804
---------------
2023-09-12 12:53:41.340023
current #epochs=19, #steps=144
start validation
acc: 0.659091
AUC: 0.827135
Avg Precision: 0.367059
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.095709
valid_loss: 1.169890
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0008139037714027032
Epoch-19 lr: 0.0008139037714027032
epoch 19 training time: 9.760
---------------
2023-09-12 12:53:51.099745
current #epochs=20, #steps=152
start validation
acc: 0.659091
AUC: 0.826446
Avg Precision: 0.367830
Avg Recall: 1.000000
d_prime: 1.329664
train_loss: 0.117906
valid_loss: 1.166672
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0008139037714027032
Epoch-20 lr: 0.0008139037714027032
epoch 20 training time: 7.234
---------------
2023-09-12 12:53:58.333331
current #epochs=21, #steps=160
start validation
acc: 0.636364
AUC: 0.831267
Avg Precision: 0.382992
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.120254
valid_loss: 1.151620
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0008139037714027032
Epoch-21 lr: 0.0008139037714027032
epoch 21 training time: 6.390
---------------
2023-09-12 12:54:04.723142
current #epochs=22, #steps=168
start validation
acc: 0.636364
AUC: 0.834711
Avg Precision: 0.388368
Avg Recall: 1.000000
d_prime: 1.375958
train_loss: 0.109089
valid_loss: 1.137245
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0008139037714027032
Epoch-22 lr: 0.0008139037714027032
epoch 22 training time: 7.386
---------------
2023-09-12 12:54:12.108887
current #epochs=23, #steps=176
start validation
acc: 0.613636
AUC: 0.843664
Avg Precision: 0.396761
Avg Recall: 1.000000
d_prime: 1.427834
train_loss: 0.057523
valid_loss: 1.128793
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0008139037714027032
Epoch-23 lr: 0.0008139037714027032
epoch 23 training time: 6.312
---------------
2023-09-12 12:54:18.420954
current #epochs=24, #steps=184
start validation
acc: 0.636364
AUC: 0.847796
Avg Precision: 0.406779
Avg Recall: 1.000000
d_prime: 1.452436
train_loss: 0.060528
valid_loss: 1.123661
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0005239910035431868
Epoch-24 lr: 0.0005239910035431868
epoch 24 training time: 6.473
---------------
2023-09-12 12:54:24.894007
current #epochs=25, #steps=192
start validation
acc: 0.636364
AUC: 0.845730
Avg Precision: 0.406779
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.096348
valid_loss: 1.122458
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0005239910035431868
Epoch-25 lr: 0.0005239910035431868
epoch 25 training time: 7.410
---------------
2023-09-12 12:54:32.304135
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03517	Per Sample Data Time 0.02931	Per Sample DNN Time 0.00586	Train Loss 0.0531	
start validation
acc: 0.636364
AUC: 0.842975
Avg Precision: 0.402871
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.091071
valid_loss: 1.123394
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0005239910035431868
Epoch-26 lr: 0.0005239910035431868
epoch 26 training time: 6.385
---------------
2023-09-12 12:54:38.689230
current #epochs=27, #steps=208
start validation
acc: 0.636364
AUC: 0.842287
Avg Precision: 0.397658
Avg Recall: 1.000000
d_prime: 1.419728
train_loss: 0.091709
valid_loss: 1.124715
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0005239910035431868
Epoch-27 lr: 0.0005239910035431868
epoch 27 training time: 7.724
---------------
2023-09-12 12:54:46.413004
current #epochs=28, #steps=216
start validation
acc: 0.659091
AUC: 0.848485
Avg Precision: 0.405806
Avg Recall: 1.000000
d_prime: 1.456579
train_loss: 0.063452
valid_loss: 1.121554
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0005239910035431868
Epoch-28 lr: 0.0005239910035431868
epoch 28 training time: 7.793
---------------
2023-09-12 12:54:54.206142
current #epochs=29, #steps=224
start validation
acc: 0.659091
AUC: 0.846419
Avg Precision: 0.398748
Avg Recall: 1.000000
d_prime: 1.444186
train_loss: 0.102807
valid_loss: 1.118798
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0005239910035431868
Epoch-29 lr: 0.0005239910035431868
epoch 29 training time: 7.842
---------------
2023-09-12 12:55:02.048377
current #epochs=30, #steps=232
start validation
acc: 0.659091
AUC: 0.847107
Avg Precision: 0.395362
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.072161
valid_loss: 1.117265
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0003373452506811718
Epoch-30 lr: 0.0003373452506811718
epoch 30 training time: 8.145
---------------
2023-09-12 12:55:10.193516
current #epochs=31, #steps=240
start validation
acc: 0.636364
AUC: 0.842975
Avg Precision: 0.400813
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.080547
valid_loss: 1.116253
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0003373452506811718
Epoch-31 lr: 0.0003373452506811718
epoch 31 training time: 6.242
---------------
2023-09-12 12:55:16.435791
current #epochs=32, #steps=248
start validation
acc: 0.659091
AUC: 0.842975
Avg Precision: 0.405306
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.078317
valid_loss: 1.114808
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0003373452506811718
Epoch-32 lr: 0.0003373452506811718
epoch 32 training time: 7.123
---------------
2023-09-12 12:55:23.558429
current #epochs=33, #steps=256
start validation
acc: 0.659091
AUC: 0.844353
Avg Precision: 0.400223
Avg Recall: 1.000000
d_prime: 1.431904
train_loss: 0.097937
valid_loss: 1.114883
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0003373452506811718
Epoch-33 lr: 0.0003373452506811718
epoch 33 training time: 6.294
---------------
2023-09-12 12:55:29.852231
current #epochs=34, #steps=264
start validation
acc: 0.636364
AUC: 0.845041
Avg Precision: 0.400223
Avg Recall: 1.000000
d_prime: 1.435986
train_loss: 0.085682
valid_loss: 1.115314
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0003373452506811718
Epoch-34 lr: 0.0003373452506811718
epoch 34 training time: 7.936
---------------
2023-09-12 12:55:37.788364
current #epochs=35, #steps=272
start validation
acc: 0.636364
AUC: 0.845730
Avg Precision: 0.412009
Avg Recall: 1.000000
d_prime: 1.440080
train_loss: 0.089682
valid_loss: 1.115025
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0003373452506811718
Epoch-35 lr: 0.0003373452506811718
epoch 35 training time: 6.753
---------------
2023-09-12 12:55:44.541230
current #epochs=36, #steps=280
start validation
acc: 0.636364
AUC: 0.849174
Avg Precision: 0.419246
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.103894
valid_loss: 1.113912
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.00021718277105450953
Epoch-36 lr: 0.00021718277105450953
epoch 36 training time: 8.858
---------------
2023-09-12 12:55:53.399267
current #epochs=37, #steps=288
start validation
acc: 0.636364
AUC: 0.852617
Avg Precision: 0.438016
Avg Recall: 1.000000
d_prime: 1.481705
train_loss: 0.102694
valid_loss: 1.114599
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.00021718277105450953
Epoch-37 lr: 0.00021718277105450953
epoch 37 training time: 8.167
---------------
2023-09-12 12:56:01.566257
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01190	Per Sample Data Time 0.00632	Per Sample DNN Time 0.00557	Train Loss 0.0689	
start validation
acc: 0.636364
AUC: 0.851928
Avg Precision: 0.435951
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.054621
valid_loss: 1.115155
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.00021718277105450953
Epoch-38 lr: 0.00021718277105450953
epoch 38 training time: 6.641
---------------
2023-09-12 12:56:08.207180
current #epochs=39, #steps=304
start validation
acc: 0.636364
AUC: 0.851240
Avg Precision: 0.435951
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.062984
valid_loss: 1.115322
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.00021718277105450953
Epoch-39 lr: 0.00021718277105450953
epoch 39 training time: 6.532
---------------
2023-09-12 12:56:14.739246
current #epochs=40, #steps=312
start validation
acc: 0.636364
AUC: 0.851240
Avg Precision: 0.433995
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.083616
valid_loss: 1.116409
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.00021718277105450953
Epoch-40 lr: 0.00021718277105450953
epoch 40 training time: 6.462
---------------
2023-09-12 12:56:21.201426
current #epochs=41, #steps=320
start validation
acc: 0.636364
AUC: 0.849862
Avg Precision: 0.429530
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.111380
valid_loss: 1.118604
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.00021718277105450953
Epoch-41 lr: 0.00021718277105450953
epoch 41 training time: 7.259
---------------
2023-09-12 12:56:28.460734
current #epochs=42, #steps=328
start validation
acc: 0.636364
AUC: 0.851240
Avg Precision: 0.429530
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.094416
valid_loss: 1.119081
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.00013982220276607588
Epoch-42 lr: 0.00013982220276607588
epoch 42 training time: 6.363
---------------
2023-09-12 12:56:34.823699
current #epochs=43, #steps=336
start validation
acc: 0.636364
AUC: 0.850551
Avg Precision: 0.431486
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.066843
valid_loss: 1.118879
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.00013982220276607588
Epoch-43 lr: 0.00013982220276607588
epoch 43 training time: 6.268
---------------
2023-09-12 12:56:41.091352
current #epochs=44, #steps=344
start validation
acc: 0.636364
AUC: 0.851928
Avg Precision: 0.438723
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.031481
valid_loss: 1.118113
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.00013982220276607588
Epoch-44 lr: 0.00013982220276607588
epoch 44 training time: 6.461
---------------
2023-09-12 12:56:47.552133
current #epochs=45, #steps=352
start validation
[I 2023-09-12 12:56:55,115] Trial 98 finished with value: 0.6590909090909091 and parameters: {'warmup': 'False', 'num_epochs': 45, 'batch_size': 14, 'lr-adaptschedule': 'True', 'lr': 0.0030501468688659546, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 6, 'lr-scheduler-decay': 0.6437996996132933}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.636364
AUC: 0.851928
Avg Precision: 0.438723
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.058399
valid_loss: 1.117585
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.00013982220276607588
Epoch-45 lr: 0.00013982220276607588
epoch 45 training time: 7.557
running on cuda
Total parameter number is : 86.996 million
Total trainable parameter number is : 86.996 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.005 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f95c8e1ce20>
The learning rate scheduler starts at 6 epoch with decay rate of 0.632 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-12 12:56:55.155847
current #epochs=1, #steps=0
start validation
acc: 0.590909
AUC: 0.823691
Avg Precision: 0.364730
Avg Recall: 1.000000
d_prime: 1.314547
train_loss: 0.228745
valid_loss: 1.143721
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0029091133317276953
Epoch-1 lr: 0.014545566658638476
epoch 1 training time: 11.885
---------------
2023-09-12 12:57:07.040948
current #epochs=2, #steps=8
start validation
acc: 0.613636
AUC: 0.810606
Avg Precision: 0.400079
Avg Recall: 1.000000
d_prime: 1.244694
train_loss: 0.237338
valid_loss: 1.162277
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0029091133317276953
Epoch-2 lr: 0.014545566658638476
epoch 2 training time: 12.672
---------------
2023-09-12 12:57:19.712830
current #epochs=3, #steps=16
start validation
acc: 0.613636
AUC: 0.805096
Avg Precision: 0.381756
Avg Recall: 1.000000
d_prime: 1.216177
train_loss: 0.213932
valid_loss: 1.150735
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0029091133317276953
Epoch-3 lr: 0.014545566658638476
epoch 3 training time: 6.260
---------------
2023-09-12 12:57:25.972835
current #epochs=4, #steps=24
start validation
acc: 0.590909
AUC: 0.827135
Avg Precision: 0.420888
Avg Recall: 1.000000
d_prime: 1.333468
train_loss: 0.123829
valid_loss: 1.134858
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0029091133317276953
Epoch-4 lr: 0.014545566658638476
epoch 4 training time: 6.341
---------------
2023-09-12 12:57:32.314360
current #epochs=5, #steps=32
start validation
acc: 0.568182
AUC: 0.818182
Avg Precision: 0.441665
Avg Recall: 1.000000
d_prime: 1.284753
train_loss: 0.220761
valid_loss: 1.170205
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0029091133317276953
Epoch-5 lr: 0.014545566658638476
epoch 5 training time: 6.857
---------------
2023-09-12 12:57:39.171159
current #epochs=6, #steps=40
start validation
acc: 0.613636
AUC: 0.818871
Avg Precision: 0.355357
Avg Recall: 1.000000
d_prime: 1.288446
train_loss: 0.123005
valid_loss: 1.141782
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0018378794074853408
Epoch-6 lr: 0.009189397037426704
epoch 6 training time: 6.898
---------------
2023-09-12 12:57:46.069436
current #epochs=7, #steps=48
start validation
acc: 0.590909
AUC: 0.817493
Avg Precision: 0.346281
Avg Recall: 1.000000
d_prime: 1.281069
train_loss: 0.116980
valid_loss: 1.137797
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0018378794074853408
Epoch-7 lr: 0.009189397037426704
epoch 7 training time: 6.379
---------------
2023-09-12 12:57:52.449635
current #epochs=8, #steps=56
start validation
acc: 0.681818
AUC: 0.818871
Avg Precision: 0.367896
Avg Recall: 1.000000
d_prime: 1.288446
train_loss: 0.168135
valid_loss: 1.132467
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0018378794074853408
Epoch-8 lr: 0.009189397037426704
epoch 8 training time: 10.473
---------------
2023-09-12 12:58:02.921510
current #epochs=9, #steps=64
start validation
acc: 0.590909
AUC: 0.822314
Avg Precision: 0.390289
Avg Recall: 1.000000
d_prime: 1.307044
train_loss: 0.122668
valid_loss: 1.172682
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0018378794074853408
Epoch-9 lr: 0.009189397037426704
epoch 9 training time: 8.247
---------------
2023-09-12 12:58:11.168876
current #epochs=10, #steps=72
start validation
acc: 0.590909
AUC: 0.831956
Avg Precision: 0.413823
Avg Recall: 1.000000
d_prime: 1.360365
train_loss: 0.130801
valid_loss: 1.163248
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001161110046700251
Epoch-10 lr: 0.005805550233501255
epoch 10 training time: 6.406
---------------
2023-09-12 12:58:17.574746
current #epochs=11, #steps=80
start validation
acc: 0.568182
AUC: 0.831267
Avg Precision: 0.402717
Avg Recall: 1.000000
d_prime: 1.356492
train_loss: 0.109705
valid_loss: 1.145028
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001161110046700251
Epoch-11 lr: 0.005805550233501255
epoch 11 training time: 6.359
---------------
2023-09-12 12:58:23.933516
current #epochs=12, #steps=88
start validation
acc: 0.590909
AUC: 0.842975
Avg Precision: 0.413362
Avg Recall: 1.000000
d_prime: 1.423775
train_loss: 0.108569
valid_loss: 1.129666
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001161110046700251
Epoch-12 lr: 0.005805550233501255
epoch 12 training time: 6.341
---------------
2023-09-12 12:58:30.274682
current #epochs=13, #steps=96
Epoch: [13][4/8]	Per Sample Total Time 0.01154	Per Sample Data Time 0.00610	Per Sample DNN Time 0.00544	Train Loss 0.1196	
start validation
acc: 0.636364
AUC: 0.851928
Avg Precision: 0.419444
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.129789
valid_loss: 1.121378
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.001161110046700251
Epoch-13 lr: 0.005805550233501255
epoch 13 training time: 8.536
---------------
2023-09-12 12:58:38.810283
current #epochs=14, #steps=104
start validation
acc: 0.659091
AUC: 0.851240
Avg Precision: 0.429141
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.074767
valid_loss: 1.125253
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0007335500550565979
Epoch-14 lr: 0.003667750275282989
epoch 14 training time: 7.541
---------------
2023-09-12 12:58:46.351009
current #epochs=15, #steps=112
start validation
acc: 0.659091
AUC: 0.849174
Avg Precision: 0.429141
Avg Recall: 1.000000
d_prime: 1.460735
train_loss: 0.130368
valid_loss: 1.128302
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0007335500550565979
Epoch-15 lr: 0.003667750275282989
epoch 15 training time: 6.325
---------------
2023-09-12 12:58:52.676448
current #epochs=16, #steps=120
start validation
acc: 0.636364
AUC: 0.856749
Avg Precision: 0.426184
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.111133
valid_loss: 1.122964
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0007335500550565979
Epoch-16 lr: 0.003667750275282989
epoch 16 training time: 7.220
---------------
2023-09-12 12:58:59.896727
current #epochs=17, #steps=128
start validation
acc: 0.636364
AUC: 0.858127
Avg Precision: 0.422253
Avg Recall: 1.000000
d_prime: 1.515953
train_loss: 0.099943
valid_loss: 1.121743
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0007335500550565979
Epoch-17 lr: 0.003667750275282989
epoch 17 training time: 7.855
---------------
2023-09-12 12:59:07.751491
current #epochs=18, #steps=136
start validation
acc: 0.636364
AUC: 0.849862
Avg Precision: 0.417659
Avg Recall: 1.000000
d_prime: 1.464903
train_loss: 0.120938
valid_loss: 1.125663
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00046343211378003954
Epoch-18 lr: 0.0023171605689001973
epoch 18 training time: 6.408
---------------
2023-09-12 12:59:14.160016
current #epochs=19, #steps=144
start validation
acc: 0.613636
AUC: 0.847107
Avg Precision: 0.415208
Avg Recall: 1.000000
d_prime: 1.448305
train_loss: 0.107025
valid_loss: 1.126665
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00046343211378003954
Epoch-19 lr: 0.0023171605689001973
epoch 19 training time: 7.231
---------------
2023-09-12 12:59:21.390510
current #epochs=20, #steps=152
start validation
acc: 0.613636
AUC: 0.850551
Avg Precision: 0.436756
Avg Recall: 1.000000
d_prime: 1.469084
train_loss: 0.082956
valid_loss: 1.128357
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00046343211378003954
Epoch-20 lr: 0.0023171605689001973
epoch 20 training time: 7.084
---------------
2023-09-12 12:59:28.474063
current #epochs=21, #steps=160
start validation
acc: 0.613636
AUC: 0.853994
Avg Precision: 0.448250
Avg Recall: 1.000000
d_prime: 1.490185
train_loss: 0.058460
valid_loss: 1.127462
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00046343211378003954
Epoch-21 lr: 0.0023171605689001973
epoch 21 training time: 6.296
---------------
2023-09-12 12:59:34.769999
current #epochs=22, #steps=168
start validation
acc: 0.613636
AUC: 0.854683
Avg Precision: 0.448250
Avg Recall: 1.000000
d_prime: 1.494446
train_loss: 0.097070
valid_loss: 1.125460
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0002927807347326349
Epoch-22 lr: 0.0014639036736631742
epoch 22 training time: 6.313
---------------
2023-09-12 12:59:41.082867
current #epochs=23, #steps=176
start validation
acc: 0.636364
AUC: 0.853994
Avg Precision: 0.448250
Avg Recall: 1.000000
d_prime: 1.490185
train_loss: 0.094386
valid_loss: 1.123607
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0002927807347326349
Epoch-23 lr: 0.0014639036736631742
epoch 23 training time: 6.286
---------------
2023-09-12 12:59:47.369674
current #epochs=24, #steps=184
start validation
acc: 0.636364
AUC: 0.853306
Avg Precision: 0.448250
Avg Recall: 1.000000
d_prime: 1.485939
train_loss: 0.080330
valid_loss: 1.119685
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0002927807347326349
Epoch-24 lr: 0.0014639036736631742
epoch 24 training time: 6.447
---------------
2023-09-12 12:59:53.816584
current #epochs=25, #steps=192
start validation
acc: 0.613636
AUC: 0.851928
Avg Precision: 0.448250
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.110287
valid_loss: 1.118477
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0002927807347326349
Epoch-25 lr: 0.0014639036736631742
epoch 25 training time: 6.333
---------------
2023-09-12 13:00:00.149387
current #epochs=26, #steps=200
Epoch: [26][0/8]	Per Sample Total Time 0.03565	Per Sample Data Time 0.03015	Per Sample DNN Time 0.00551	Train Loss 0.1593	
start validation
acc: 0.613636
AUC: 0.851240
Avg Precision: 0.444864
Avg Recall: 1.000000
d_prime: 1.473278
train_loss: 0.094700
valid_loss: 1.117697
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0001849689654249282
Epoch-26 lr: 0.0009248448271246408
epoch 26 training time: 6.220
---------------
2023-09-12 13:00:06.369881
current #epochs=27, #steps=208
start validation
acc: 0.613636
AUC: 0.851928
Avg Precision: 0.444864
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.091168
valid_loss: 1.117206
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0001849689654249282
Epoch-27 lr: 0.0009248448271246408
epoch 27 training time: 6.372
---------------
2023-09-12 13:00:12.742040
current #epochs=28, #steps=216
start validation
acc: 0.613636
AUC: 0.851928
Avg Precision: 0.444864
Avg Recall: 1.000000
d_prime: 1.477485
train_loss: 0.104371
valid_loss: 1.116687
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0001849689654249282
Epoch-28 lr: 0.0009248448271246408
epoch 28 training time: 7.743
---------------
2023-09-12 13:00:20.484848
current #epochs=29, #steps=224
start validation
acc: 0.613636
AUC: 0.853994
Avg Precision: 0.441703
Avg Recall: 1.000000
d_prime: 1.490185
train_loss: 0.074697
valid_loss: 1.116257
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0001849689654249282
Epoch-29 lr: 0.0009248448271246408
epoch 29 training time: 6.651
---------------
2023-09-12 13:00:27.135539
current #epochs=30, #steps=232
start validation
acc: 0.613636
AUC: 0.856061
Avg Precision: 0.444864
Avg Recall: 1.000000
d_prime: 1.503007
train_loss: 0.059123
valid_loss: 1.114265
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00011685713611454593
Epoch-30 lr: 0.0005842856805727295
epoch 30 training time: 6.340
---------------
2023-09-12 13:00:33.475600
current #epochs=31, #steps=240
start validation
acc: 0.613636
AUC: 0.856749
Avg Precision: 0.444864
Avg Recall: 1.000000
d_prime: 1.507308
train_loss: 0.099353
valid_loss: 1.113920
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.00011685713611454593
Epoch-31 lr: 0.0005842856805727295
epoch 31 training time: 7.957
---------------
2023-09-12 13:00:41.432675
current #epochs=32, #steps=248
start validation
acc: 0.613636
AUC: 0.858127
Avg Precision: 0.444864
Avg Recall: 1.000000
d_prime: 1.515953
train_loss: 0.095716
valid_loss: 1.114824
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00011685713611454593
Epoch-32 lr: 0.0005842856805727295
epoch 32 training time: 6.460
---------------
2023-09-12 13:00:47.892670
current #epochs=33, #steps=256
start validation
acc: 0.613636
AUC: 0.858815
Avg Precision: 0.444864
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.089365
valid_loss: 1.115590
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.00011685713611454593
Epoch-33 lr: 0.0005842856805727295
epoch 33 training time: 7.368
---------------
2023-09-12 13:00:55.260126
current #epochs=34, #steps=264
start validation
acc: 0.613636
AUC: 0.860193
Avg Precision: 0.444864
Avg Recall: 1.000000
d_prime: 1.529028
train_loss: 0.084845
valid_loss: 1.115065
validation finished
normal learning rate scheduler step
Epoch-34 lr: 7.382638611576056e-05
Epoch-34 lr: 0.00036913193057880274
epoch 34 training time: 12.611
---------------
2023-09-12 13:01:07.871762
current #epochs=35, #steps=272
start validation
acc: 0.613636
AUC: 0.859504
Avg Precision: 0.444864
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.109635
valid_loss: 1.114256
validation finished
normal learning rate scheduler step
Epoch-35 lr: 7.382638611576056e-05
Epoch-35 lr: 0.00036913193057880274
epoch 35 training time: 6.400
---------------
2023-09-12 13:01:14.271336
current #epochs=36, #steps=280
start validation
acc: 0.636364
AUC: 0.859504
Avg Precision: 0.444864
Avg Recall: 1.000000
d_prime: 1.524655
train_loss: 0.111875
valid_loss: 1.113241
validation finished
normal learning rate scheduler step
Epoch-36 lr: 7.382638611576056e-05
Epoch-36 lr: 0.00036913193057880274
epoch 36 training time: 7.207
---------------
2023-09-12 13:01:21.478277
current #epochs=37, #steps=288
start validation
acc: 0.636364
AUC: 0.858815
Avg Precision: 0.444864
Avg Recall: 1.000000
d_prime: 1.520297
train_loss: 0.087978
valid_loss: 1.112911
validation finished
normal learning rate scheduler step
Epoch-37 lr: 7.382638611576056e-05
Epoch-37 lr: 0.00036913193057880274
epoch 37 training time: 6.398
---------------
2023-09-12 13:01:27.875899
current #epochs=38, #steps=296
Epoch: [38][4/8]	Per Sample Total Time 0.01165	Per Sample Data Time 0.00582	Per Sample DNN Time 0.00583	Train Loss 0.0671	
start validation
acc: 0.636364
AUC: 0.860882
Avg Precision: 0.448250
Avg Recall: 1.000000
d_prime: 1.533415
train_loss: 0.078691
valid_loss: 1.112214
validation finished
normal learning rate scheduler step
Epoch-38 lr: 4.664101370386851e-05
Epoch-38 lr: 0.0002332050685193425
epoch 38 training time: 6.262
---------------
2023-09-12 13:01:34.138349
current #epochs=39, #steps=304
start validation
[I 2023-09-12 13:01:41,099] Trial 99 finished with value: 0.6818181818181818 and parameters: {'warmup': 'False', 'num_epochs': 39, 'batch_size': 9, 'lr-adaptschedule': 'False', 'lr': 0.0029091133317276953, 'head-lr': 5, 'lr-scheduler-start': 6, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.6317661768075021}. Best is trial 57 with value: 0.7727272727272727.
acc: 0.636364
AUC: 0.860882
Avg Precision: 0.448250
Avg Recall: 1.000000
d_prime: 1.533415
train_loss: 0.074142
valid_loss: 1.111925
validation finished
normal learning rate scheduler step
Epoch-39 lr: 4.664101370386851e-05
Epoch-39 lr: 0.0002332050685193425
epoch 39 training time: 6.954
Best hyperparameters: {'warmup': 'False', 'num_epochs': 37, 'batch_size': 19, 'lr-adaptschedule': 'False', 'lr': 0.0032123112290088555, 'head-lr': 5, 'lr-scheduler-start': 3, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.7161942934734695}
