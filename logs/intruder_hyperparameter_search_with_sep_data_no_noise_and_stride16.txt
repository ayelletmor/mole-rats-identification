/usr/local/lib/python3.8/dist-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
[I 2023-09-24 10:18:40,794] A new study created in memory with name: no-name-ab1739fb-164d-4221-b425-59dc0e55030b
I am process 3445337, running on amorgenstern-titanx8-25nlt: starting (Sun Sep 24 10:18:36 2023)
balanced sampler is not used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process ours
use dataset mean -0.023 and std 0.413 to normalize the input.
number of classes is 6
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process ours
use dataset mean -0.023 and std 0.413 to normalize the input.
number of classes is 6
Now train with ours with 1919 training samples, evaluate with 213 samples
now load a SSL pretrained models from SSAST-Base-Patch-400.pth
pretraining patch split stride: frequency=16, time=16
pretraining patch shape: frequency=16, time=16
pretraining patch array dimension: frequency=8, time=64
pretraining number of patches=512
fine-tuning patch split stride: frequncey=16, time=16
fine-tuning number of patches=256

Creating experiment directory: intruder_hyperparameter_search_sep_data
Now starting fine-tuning for 50 epochs
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa6150b5820>
The learning rate scheduler starts at 7 epoch with decay rate of 0.863 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 10:18:40.878067
current #epochs=1, #steps=0
[1695550735.773418] [amorgenstern-titanx8-25nlt:3445337:f]        vfs_fuse.c:281  UCX  ERROR inotify_add_watch(/tmp) failed: No space left on device
start validation
acc: 0.220657
AUC: 0.507580
Avg Precision: 0.175524
Avg Recall: 1.000000
d_prime: 0.026872
train_loss: 2.516796
valid_loss: 1.650891
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0029227461631594243
Epoch-1 lr: 0.0058454923263188486
epoch 1 training time: 31.624
---------------
2023-09-24 10:19:12.502304
current #epochs=2, #steps=39
start validation
acc: 0.220657
AUC: 0.514920
Avg Precision: 0.178033
Avg Recall: 1.000000
d_prime: 0.052903
train_loss: 1.735730
valid_loss: 1.636496
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0029227461631594243
Epoch-2 lr: 0.0058454923263188486
epoch 2 training time: 15.017
---------------
2023-09-24 10:19:27.518962
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00704	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00556	Train Loss 1.6832	
start validation
acc: 0.436620
AUC: 0.512690
Avg Precision: 0.176512
Avg Recall: 1.000000
d_prime: 0.044992
train_loss: 1.679804
valid_loss: 1.673571
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0029227461631594243
Epoch-3 lr: 0.0058454923263188486
epoch 3 training time: 17.424
---------------
2023-09-24 10:19:44.942893
current #epochs=4, #steps=117
start validation
acc: 0.436620
AUC: 0.508499
Avg Precision: 0.175285
Avg Recall: 1.000000
d_prime: 0.030130
train_loss: 1.692763
valid_loss: 1.703537
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0029227461631594243
Epoch-4 lr: 0.0058454923263188486
epoch 4 training time: 15.135
---------------
2023-09-24 10:20:00.077942
current #epochs=5, #steps=156
start validation
acc: 0.436620
AUC: 0.533964
Avg Precision: 0.177394
Avg Recall: 1.000000
d_prime: 0.120544
train_loss: 1.589168
valid_loss: 1.667655
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0029227461631594243
Epoch-5 lr: 0.0058454923263188486
epoch 5 training time: 14.974
---------------
2023-09-24 10:20:15.051562
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01102	Per Sample Data Time 0.00539	Per Sample DNN Time 0.00563	Train Loss 1.5469	
start validation
acc: 0.436620
AUC: 0.531804
Avg Precision: 0.182013
Avg Recall: 1.000000
d_prime: 0.112861
train_loss: 1.547195
valid_loss: 1.688409
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0029227461631594243
Epoch-6 lr: 0.0058454923263188486
epoch 6 training time: 15.122
---------------
2023-09-24 10:20:30.173498
current #epochs=7, #steps=234
start validation
acc: 0.436620
AUC: 0.531397
Avg Precision: 0.182872
Avg Recall: 1.000000
d_prime: 0.111415
train_loss: 1.567731
valid_loss: 1.682572
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002522745929706131
Epoch-7 lr: 0.005045491859412262
epoch 7 training time: 15.872
---------------
2023-09-24 10:20:46.045022
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00684	Per Sample Data Time 0.00124	Per Sample DNN Time 0.00559	Train Loss 1.5638	
start validation
[I 2023-09-24 10:21:02,236] Trial 0 finished with value: 0.18521512078138858 and parameters: {'warmup': 'True', 'num_epochs': 8, 'batch_size': 64, 'lr-adaptschedule': 'True', 'lr': 0.0029227461631594243, 'head-lr': 2, 'lr-scheduler-start': 7, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.8631423287813329}. Best is trial 0 with value: 0.18521512078138858.
acc: 0.436620
AUC: 0.527363
Avg Precision: 0.185215
Avg Recall: 1.000000
d_prime: 0.097076
train_loss: 1.567773
valid_loss: 1.677894
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.002522745929706131
Epoch-8 lr: 0.005045491859412262
epoch 8 training time: 16.188
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa6080e1400>
The learning rate scheduler starts at 4 epoch with decay rate of 0.618 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 10:21:02.245435
current #epochs=1, #steps=0
start validation
acc: 0.436620
AUC: 0.665935
Avg Precision: 0.176758
Avg Recall: 1.000000
d_prime: 0.606298
train_loss: 2.151856
valid_loss: 1.723870
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.004047277404516512
Epoch-1 lr: 0.016189109618066046
epoch 1 training time: 17.414
---------------
2023-09-24 10:21:19.659953
current #epochs=2, #steps=39
start validation
acc: 0.436620
AUC: 0.499591
Avg Precision: 0.178320
Avg Recall: 1.000000
d_prime: -0.001450
train_loss: 1.551043
valid_loss: 1.708239
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.004047277404516512
Epoch-2 lr: 0.016189109618066046
epoch 2 training time: 15.032
---------------
2023-09-24 10:21:34.691990
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00701	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00553	Train Loss 1.5396	
start validation
acc: 0.436620
AUC: 0.555616
Avg Precision: 0.181344
Avg Recall: 1.000000
d_prime: 0.197796
train_loss: 1.558153
valid_loss: 1.718124
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.004047277404516512
Epoch-3 lr: 0.016189109618066046
epoch 3 training time: 15.010
---------------
2023-09-24 10:21:49.701433
current #epochs=4, #steps=117
start validation
acc: 0.436620
AUC: 0.500586
Avg Precision: 0.181322
Avg Recall: 1.000000
d_prime: 0.002079
train_loss: 1.552244
valid_loss: 1.652636
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002500650515483459
Epoch-4 lr: 0.010002602061933836
epoch 4 training time: 15.056
---------------
2023-09-24 10:22:04.757764
current #epochs=5, #steps=156
start validation
acc: 0.436620
AUC: 0.500695
Avg Precision: 0.181664
Avg Recall: 1.000000
d_prime: 0.002462
train_loss: 1.524620
valid_loss: 1.674087
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002500650515483459
Epoch-5 lr: 0.010002602061933836
epoch 5 training time: 15.471
---------------
2023-09-24 10:22:20.228414
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01076	Per Sample Data Time 0.00505	Per Sample DNN Time 0.00571	Train Loss 1.5614	
start validation
acc: 0.436620
AUC: 0.505837
Avg Precision: 0.182043
Avg Recall: 1.000000
d_prime: 0.020693
train_loss: 1.514582
valid_loss: 1.672697
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002500650515483459
Epoch-6 lr: 0.010002602061933836
epoch 6 training time: 15.047
---------------
2023-09-24 10:22:35.275228
current #epochs=7, #steps=234
start validation
acc: 0.436620
AUC: 0.514263
Avg Precision: 0.182475
Avg Recall: 1.000000
d_prime: 0.050573
train_loss: 1.514776
valid_loss: 1.677567
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002500650515483459
Epoch-7 lr: 0.010002602061933836
epoch 7 training time: 15.114
---------------
2023-09-24 10:22:50.388918
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00684	Per Sample Data Time 0.00126	Per Sample DNN Time 0.00558	Train Loss 1.5341	
start validation
acc: 0.436620
AUC: 0.520376
Avg Precision: 0.182995
Avg Recall: 1.000000
d_prime: 0.072264
train_loss: 1.518561
valid_loss: 1.675562
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0015450517411061187
Epoch-8 lr: 0.006180206964424475
epoch 8 training time: 15.736
---------------
2023-09-24 10:23:06.124809
current #epochs=9, #steps=312
start validation
acc: 0.436620
AUC: 0.520462
Avg Precision: 0.182905
Avg Recall: 1.000000
d_prime: 0.072567
train_loss: 1.509913
valid_loss: 1.685351
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0015450517411061187
Epoch-9 lr: 0.006180206964424475
epoch 9 training time: 15.192
---------------
2023-09-24 10:23:21.316705
current #epochs=10, #steps=351
start validation
acc: 0.436620
AUC: 0.518826
Avg Precision: 0.183087
Avg Recall: 1.000000
d_prime: 0.066763
train_loss: 1.514045
valid_loss: 1.680876
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0015450517411061187
Epoch-10 lr: 0.006180206964424475
epoch 10 training time: 14.980
---------------
2023-09-24 10:23:36.296671
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00855	Per Sample Data Time 0.00288	Per Sample DNN Time 0.00567	Train Loss 1.5309	
start validation
acc: 0.436620
AUC: 0.517009
Avg Precision: 0.182812
Avg Recall: 1.000000
d_prime: 0.060315
train_loss: 1.514485
valid_loss: 1.680939
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0015450517411061187
Epoch-11 lr: 0.006180206964424475
epoch 11 training time: 15.004
---------------
2023-09-24 10:23:51.300880
current #epochs=12, #steps=429
start validation
acc: 0.436620
AUC: 0.517509
Avg Precision: 0.182812
Avg Recall: 1.000000
d_prime: 0.062087
train_loss: 1.512679
valid_loss: 1.685538
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0009546255535966115
Epoch-12 lr: 0.003818502214386446
epoch 12 training time: 15.048
---------------
2023-09-24 10:24:06.349119
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00659	Per Sample Data Time 0.00108	Per Sample DNN Time 0.00551	Train Loss 1.5042	
start validation
acc: 0.436620
AUC: 0.518061
Avg Precision: 0.182812
Avg Recall: 1.000000
d_prime: 0.064047
train_loss: 1.510758
valid_loss: 1.675665
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0009546255535966115
Epoch-13 lr: 0.003818502214386446
epoch 13 training time: 15.026
---------------
2023-09-24 10:24:21.375255
current #epochs=14, #steps=507
start validation
acc: 0.436620
AUC: 0.518926
Avg Precision: 0.182812
Avg Recall: 1.000000
d_prime: 0.067117
train_loss: 1.508976
valid_loss: 1.674553
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0009546255535966115
Epoch-14 lr: 0.003818502214386446
epoch 14 training time: 14.971
---------------
2023-09-24 10:24:36.346494
current #epochs=15, #steps=546
start validation
acc: 0.436620
AUC: 0.519713
Avg Precision: 0.182995
Avg Recall: 1.000000
d_prime: 0.069911
train_loss: 1.508166
valid_loss: 1.671141
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0009546255535966115
Epoch-15 lr: 0.003818502214386446
epoch 15 training time: 14.968
---------------
2023-09-24 10:24:51.314315
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00778	Per Sample Data Time 0.00206	Per Sample DNN Time 0.00572	Train Loss 1.5128	
start validation
acc: 0.436620
AUC: 0.520407
Avg Precision: 0.183454
Avg Recall: 1.000000
d_prime: 0.072371
train_loss: 1.511636
valid_loss: 1.672108
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.000589824873390467
Epoch-16 lr: 0.002359299493561868
epoch 16 training time: 15.153
---------------
2023-09-24 10:25:06.467047
current #epochs=17, #steps=624
start validation
acc: 0.436620
AUC: 0.520687
Avg Precision: 0.183345
Avg Recall: 1.000000
d_prime: 0.073366
train_loss: 1.508998
valid_loss: 1.673130
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.000589824873390467
Epoch-17 lr: 0.002359299493561868
epoch 17 training time: 14.946
---------------
2023-09-24 10:25:21.413037
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00645	Per Sample Data Time 0.00094	Per Sample DNN Time 0.00551	Train Loss 1.5119	
start validation
acc: 0.436620
AUC: 0.519246
Avg Precision: 0.182894
Avg Recall: 1.000000
d_prime: 0.068252
train_loss: 1.509347
valid_loss: 1.680971
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.000589824873390467
Epoch-18 lr: 0.002359299493561868
epoch 18 training time: 15.002
---------------
2023-09-24 10:25:36.415447
current #epochs=19, #steps=702
start validation
acc: 0.436620
AUC: 0.521301
Avg Precision: 0.183159
Avg Recall: 1.000000
d_prime: 0.075547
train_loss: 1.508478
valid_loss: 1.671869
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.000589824873390467
Epoch-19 lr: 0.002359299493561868
epoch 19 training time: 14.990
---------------
2023-09-24 10:25:51.405041
current #epochs=20, #steps=741
start validation
acc: 0.436620
AUC: 0.521893
Avg Precision: 0.183159
Avg Recall: 1.000000
d_prime: 0.077647
train_loss: 1.509958
valid_loss: 1.669329
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0003644291523093744
Epoch-20 lr: 0.0014577166092374976
epoch 20 training time: 15.080
---------------
2023-09-24 10:26:06.484676
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00162	Per Sample DNN Time 0.00549	Train Loss 1.5327	
start validation
acc: 0.436620
AUC: 0.520041
Avg Precision: 0.182894
Avg Recall: 1.000000
d_prime: 0.071075
train_loss: 1.515521
valid_loss: 1.679373
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0003644291523093744
Epoch-21 lr: 0.0014577166092374976
epoch 21 training time: 15.062
---------------
2023-09-24 10:26:21.546397
current #epochs=22, #steps=819
start validation
acc: 0.436620
AUC: 0.520398
Avg Precision: 0.183263
Avg Recall: 1.000000
d_prime: 0.072340
train_loss: 1.502694
valid_loss: 1.673473
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0003644291523093744
Epoch-22 lr: 0.0014577166092374976
epoch 22 training time: 14.934
---------------
2023-09-24 10:26:36.480669
current #epochs=23, #steps=858
start validation
acc: 0.436620
AUC: 0.519407
Avg Precision: 0.182894
Avg Recall: 1.000000
d_prime: 0.068823
train_loss: 1.507657
valid_loss: 1.677589
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0003644291523093744
Epoch-23 lr: 0.0014577166092374976
epoch 23 training time: 15.172
---------------
2023-09-24 10:26:51.653036
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01371	Per Sample Data Time 0.00753	Per Sample DNN Time 0.00618	Train Loss 1.5868	
start validation
acc: 0.436620
AUC: 0.520294
Avg Precision: 0.182995
Avg Recall: 1.000000
d_prime: 0.071971
train_loss: 1.511235
valid_loss: 1.672942
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00022516616888248667
Epoch-24 lr: 0.0009006646755299467
epoch 24 training time: 14.979
---------------
2023-09-24 10:27:06.632364
current #epochs=25, #steps=936
start validation
acc: 0.436620
AUC: 0.520018
Avg Precision: 0.182812
Avg Recall: 1.000000
d_prime: 0.070990
train_loss: 1.506507
valid_loss: 1.676503
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00022516616888248667
Epoch-25 lr: 0.0009006646755299467
epoch 25 training time: 15.038
---------------
2023-09-24 10:27:21.670233
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00688	Per Sample Data Time 0.00135	Per Sample DNN Time 0.00553	Train Loss 1.4936	
start validation
acc: 0.436620
AUC: 0.520836
Avg Precision: 0.183263
Avg Recall: 1.000000
d_prime: 0.073896
train_loss: 1.509532
valid_loss: 1.675461
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00022516616888248667
Epoch-26 lr: 0.0009006646755299467
epoch 26 training time: 15.033
---------------
2023-09-24 10:27:36.702584
current #epochs=27, #steps=1014
start validation
acc: 0.436620
AUC: 0.519575
Avg Precision: 0.182894
Avg Recall: 1.000000
d_prime: 0.069420
train_loss: 1.505452
valid_loss: 1.676604
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00022516616888248667
Epoch-27 lr: 0.0009006646755299467
epoch 27 training time: 15.012
---------------
2023-09-24 10:27:51.715034
current #epochs=28, #steps=1053
start validation
acc: 0.436620
AUC: 0.521491
Avg Precision: 0.183263
Avg Recall: 1.000000
d_prime: 0.076220
train_loss: 1.508683
valid_loss: 1.675116
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00013912115232256716
Epoch-28 lr: 0.0005564846092902686
epoch 28 training time: 14.975
---------------
2023-09-24 10:28:06.690324
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00921	Per Sample Data Time 0.00349	Per Sample DNN Time 0.00572	Train Loss 1.5120	
start validation
acc: 0.436620
AUC: 0.519753
Avg Precision: 0.182894
Avg Recall: 1.000000
d_prime: 0.070052
train_loss: 1.507293
valid_loss: 1.676409
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00013912115232256716
Epoch-29 lr: 0.0005564846092902686
epoch 29 training time: 14.938
---------------
2023-09-24 10:28:21.628580
current #epochs=30, #steps=1131
start validation
acc: 0.436620
AUC: 0.519071
Avg Precision: 0.182894
Avg Recall: 1.000000
d_prime: 0.067632
train_loss: 1.511895
valid_loss: 1.676378
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00013912115232256716
Epoch-30 lr: 0.0005564846092902686
epoch 30 training time: 15.109
---------------
2023-09-24 10:28:36.737595
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00666	Per Sample Data Time 0.00109	Per Sample DNN Time 0.00557	Train Loss 1.4950	
start validation
acc: 0.436620
AUC: 0.521471
Avg Precision: 0.183263
Avg Recall: 1.000000
d_prime: 0.076149
train_loss: 1.504956
valid_loss: 1.674307
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.00013912115232256716
Epoch-31 lr: 0.0005564846092902686
epoch 31 training time: 14.977
---------------
2023-09-24 10:28:51.714567
current #epochs=32, #steps=1209
start validation
acc: 0.436620
AUC: 0.519120
Avg Precision: 0.182894
Avg Recall: 1.000000
d_prime: 0.067805
train_loss: 1.507407
valid_loss: 1.676673
validation finished
normal learning rate scheduler step
Epoch-32 lr: 8.595738480437562e-05
Epoch-32 lr: 0.0003438295392175025
epoch 32 training time: 15.014
---------------
2023-09-24 10:29:06.728383
current #epochs=33, #steps=1248
start validation
acc: 0.436620
AUC: 0.520507
Avg Precision: 0.182976
Avg Recall: 1.000000
d_prime: 0.072727
train_loss: 1.511381
valid_loss: 1.675833
validation finished
normal learning rate scheduler step
Epoch-33 lr: 8.595738480437562e-05
Epoch-33 lr: 0.0003438295392175025
epoch 33 training time: 14.972
---------------
2023-09-24 10:29:21.700736
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00796	Per Sample Data Time 0.00233	Per Sample DNN Time 0.00563	Train Loss 1.5088	
start validation
acc: 0.436620
AUC: 0.519615
Avg Precision: 0.183159
Avg Recall: 1.000000
d_prime: 0.069560
train_loss: 1.508018
valid_loss: 1.676192
validation finished
normal learning rate scheduler step
Epoch-34 lr: 8.595738480437562e-05
Epoch-34 lr: 0.0003438295392175025
epoch 34 training time: 15.000
---------------
2023-09-24 10:29:36.700834
current #epochs=35, #steps=1326
start validation
acc: 0.436620
AUC: 0.518868
Avg Precision: 0.182976
Avg Recall: 1.000000
d_prime: 0.066910
train_loss: 1.511952
valid_loss: 1.676701
validation finished
normal learning rate scheduler step
Epoch-35 lr: 8.595738480437562e-05
Epoch-35 lr: 0.0003438295392175025
epoch 35 training time: 14.934
---------------
2023-09-24 10:29:51.635012
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00652	Per Sample Data Time 0.00099	Per Sample DNN Time 0.00552	Train Loss 1.5061	
start validation
acc: 0.436620
AUC: 0.519552
Avg Precision: 0.182976
Avg Recall: 1.000000
d_prime: 0.069337
train_loss: 1.507526
valid_loss: 1.676200
validation finished
normal learning rate scheduler step
Epoch-36 lr: 5.310962336824299e-05
Epoch-36 lr: 0.00021243849347297197
epoch 36 training time: 15.024
---------------
2023-09-24 10:30:06.659574
current #epochs=37, #steps=1404
start validation
acc: 0.436620
AUC: 0.520391
Avg Precision: 0.183345
Avg Recall: 1.000000
d_prime: 0.072316
train_loss: 1.507743
valid_loss: 1.675469
validation finished
normal learning rate scheduler step
Epoch-37 lr: 5.310962336824299e-05
Epoch-37 lr: 0.00021243849347297197
epoch 37 training time: 15.039
---------------
2023-09-24 10:30:21.698594
current #epochs=38, #steps=1443
start validation
acc: 0.436620
AUC: 0.520434
Avg Precision: 0.183263
Avg Recall: 1.000000
d_prime: 0.072467
train_loss: 1.507387
valid_loss: 1.675194
validation finished
normal learning rate scheduler step
Epoch-38 lr: 5.310962336824299e-05
Epoch-38 lr: 0.00021243849347297197
epoch 38 training time: 15.123
---------------
2023-09-24 10:30:36.821877
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00738	Per Sample Data Time 0.00175	Per Sample DNN Time 0.00563	Train Loss 1.5058	
start validation
acc: 0.436620
AUC: 0.519061
Avg Precision: 0.183076
Avg Recall: 1.000000
d_prime: 0.067596
train_loss: 1.507203
valid_loss: 1.676739
validation finished
normal learning rate scheduler step
Epoch-39 lr: 5.310962336824299e-05
Epoch-39 lr: 0.00021243849347297197
epoch 39 training time: 15.067
---------------
2023-09-24 10:30:51.888473
current #epochs=40, #steps=1521
start validation
acc: 0.436620
AUC: 0.521305
Avg Precision: 0.183263
Avg Recall: 1.000000
d_prime: 0.075561
train_loss: 1.507143
valid_loss: 1.674920
validation finished
normal learning rate scheduler step
Epoch-40 lr: 3.281430793568116e-05
Epoch-40 lr: 0.00013125723174272464
epoch 40 training time: 15.093
---------------
2023-09-24 10:31:06.981063
current #epochs=41, #steps=1560
start validation
acc: 0.436620
AUC: 0.520627
Avg Precision: 0.183263
Avg Recall: 1.000000
d_prime: 0.073153
train_loss: 1.508650
valid_loss: 1.675670
validation finished
normal learning rate scheduler step
Epoch-41 lr: 3.281430793568116e-05
Epoch-41 lr: 0.00013125723174272464
epoch 41 training time: 15.076
---------------
2023-09-24 10:31:22.057490
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02117	Per Sample Data Time 0.01522	Per Sample DNN Time 0.00595	Train Loss 1.4736	
start validation
acc: 0.436620
AUC: 0.520383
Avg Precision: 0.182894
Avg Recall: 1.000000
d_prime: 0.072288
train_loss: 1.506198
valid_loss: 1.675925
validation finished
normal learning rate scheduler step
Epoch-42 lr: 3.281430793568116e-05
Epoch-42 lr: 0.00013125723174272464
epoch 42 training time: 15.005
---------------
2023-09-24 10:31:37.062471
current #epochs=43, #steps=1638
start validation
acc: 0.436620
AUC: 0.519857
Avg Precision: 0.182894
Avg Recall: 1.000000
d_prime: 0.070419
train_loss: 1.509811
valid_loss: 1.676101
validation finished
normal learning rate scheduler step
Epoch-43 lr: 3.281430793568116e-05
Epoch-43 lr: 0.00013125723174272464
epoch 43 training time: 14.979
---------------
2023-09-24 10:31:52.040867
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00703	Per Sample Data Time 0.00139	Per Sample DNN Time 0.00564	Train Loss 1.5008	
start validation
acc: 0.436620
AUC: 0.520082
Avg Precision: 0.182894
Avg Recall: 1.000000
d_prime: 0.071218
train_loss: 1.503681
valid_loss: 1.675957
validation finished
normal learning rate scheduler step
Epoch-44 lr: 2.0274645855266403e-05
Epoch-44 lr: 8.109858342106561e-05
epoch 44 training time: 15.115
---------------
2023-09-24 10:32:07.155772
current #epochs=45, #steps=1716
start validation
[I 2023-09-24 10:32:22,091] Trial 1 finished with value: 0.18326305209645 and parameters: {'warmup': 'False', 'num_epochs': 45, 'batch_size': 32, 'lr-adaptschedule': 'True', 'lr': 0.004047277404516512, 'head-lr': 4, 'lr-scheduler-start': 4, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.6178599254631985}. Best is trial 0 with value: 0.18521512078138858.
acc: 0.436620
AUC: 0.520534
Avg Precision: 0.183263
Avg Recall: 1.000000
d_prime: 0.072823
train_loss: 1.508073
valid_loss: 1.675704
validation finished
normal learning rate scheduler step
Epoch-45 lr: 2.0274645855266403e-05
Epoch-45 lr: 8.109858342106561e-05
epoch 45 training time: 14.931
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa609ead040>
The learning rate scheduler starts at 5 epoch with decay rate of 0.893 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 10:32:22.097605
current #epochs=1, #steps=0
start validation
acc: 0.436620
AUC: 0.520968
Avg Precision: 0.183537
Avg Recall: 1.000000
d_prime: 0.074365
train_loss: 1.506591
valid_loss: 1.675193
validation finished
normal learning rate scheduler step
Epoch-1 lr: 7.994812228689861e-05
Epoch-1 lr: 0.00023984436686069584
epoch 1 training time: 17.442
---------------
2023-09-24 10:32:39.539856
current #epochs=2, #steps=39
start validation
acc: 0.436620
AUC: 0.519958
Avg Precision: 0.183263
Avg Recall: 1.000000
d_prime: 0.070778
train_loss: 1.505122
valid_loss: 1.675886
validation finished
normal learning rate scheduler step
Epoch-2 lr: 7.994812228689861e-05
Epoch-2 lr: 0.00023984436686069584
epoch 2 training time: 15.041
---------------
2023-09-24 10:32:54.581091
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00702	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00554	Train Loss 1.5236	
start validation
acc: 0.436620
AUC: 0.520903
Avg Precision: 0.183851
Avg Recall: 1.000000
d_prime: 0.074134
train_loss: 1.509693
valid_loss: 1.674983
validation finished
normal learning rate scheduler step
Epoch-3 lr: 7.994812228689861e-05
Epoch-3 lr: 0.00023984436686069584
epoch 3 training time: 15.114
---------------
2023-09-24 10:33:09.695408
current #epochs=4, #steps=117
start validation
acc: 0.436620
AUC: 0.521449
Avg Precision: 0.184222
Avg Recall: 1.000000
d_prime: 0.076071
train_loss: 1.503597
valid_loss: 1.675139
validation finished
normal learning rate scheduler step
Epoch-4 lr: 7.994812228689861e-05
Epoch-4 lr: 0.00023984436686069584
epoch 4 training time: 15.082
---------------
2023-09-24 10:33:24.777657
current #epochs=5, #steps=156
start validation
acc: 0.436620
AUC: 0.522090
Avg Precision: 0.183985
Avg Recall: 1.000000
d_prime: 0.078346
train_loss: 1.511405
valid_loss: 1.675735
validation finished
normal learning rate scheduler step
Epoch-5 lr: 7.139442998561547e-05
Epoch-5 lr: 0.00021418328995684643
epoch 5 training time: 15.024
---------------
2023-09-24 10:33:39.801972
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01067	Per Sample Data Time 0.00499	Per Sample DNN Time 0.00568	Train Loss 1.4838	
start validation
acc: 0.436620
AUC: 0.522322
Avg Precision: 0.183789
Avg Recall: 1.000000
d_prime: 0.079172
train_loss: 1.513206
valid_loss: 1.675975
validation finished
normal learning rate scheduler step
Epoch-6 lr: 7.139442998561547e-05
Epoch-6 lr: 0.00021418328995684643
epoch 6 training time: 14.957
---------------
2023-09-24 10:33:54.758925
current #epochs=7, #steps=234
start validation
acc: 0.436620
AUC: 0.521745
Avg Precision: 0.184071
Avg Recall: 1.000000
d_prime: 0.077123
train_loss: 1.509537
valid_loss: 1.676125
validation finished
normal learning rate scheduler step
Epoch-7 lr: 7.139442998561547e-05
Epoch-7 lr: 0.00021418328995684643
epoch 7 training time: 15.158
---------------
2023-09-24 10:34:09.916849
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00682	Per Sample Data Time 0.00123	Per Sample DNN Time 0.00559	Train Loss 1.5138	
start validation
acc: 0.436620
AUC: 0.521943
Avg Precision: 0.184478
Avg Recall: 1.000000
d_prime: 0.077825
train_loss: 1.507970
valid_loss: 1.676088
validation finished
normal learning rate scheduler step
Epoch-8 lr: 7.139442998561547e-05
Epoch-8 lr: 0.00021418328995684643
epoch 8 training time: 15.014
---------------
2023-09-24 10:34:24.930814
current #epochs=9, #steps=312
start validation
acc: 0.436620
AUC: 0.522851
Avg Precision: 0.185127
Avg Recall: 1.000000
d_prime: 0.081050
train_loss: 1.504086
valid_loss: 1.675770
validation finished
normal learning rate scheduler step
Epoch-9 lr: 7.139442998561547e-05
Epoch-9 lr: 0.00021418328995684643
epoch 9 training time: 15.125
---------------
2023-09-24 10:34:40.055802
current #epochs=10, #steps=351
start validation
acc: 0.436620
AUC: 0.523313
Avg Precision: 0.185442
Avg Recall: 1.000000
d_prime: 0.082688
train_loss: 1.503305
valid_loss: 1.674138
validation finished
normal learning rate scheduler step
Epoch-10 lr: 7.139442998561547e-05
Epoch-10 lr: 0.00021418328995684643
epoch 10 training time: 15.046
---------------
2023-09-24 10:34:55.101690
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00855	Per Sample Data Time 0.00288	Per Sample DNN Time 0.00567	Train Loss 1.4538	
start validation
acc: 0.436620
AUC: 0.520396
Avg Precision: 0.183684
Avg Recall: 1.000000
d_prime: 0.072333
train_loss: 1.507620
valid_loss: 1.675555
validation finished
normal learning rate scheduler step
Epoch-11 lr: 7.139442998561547e-05
Epoch-11 lr: 0.00021418328995684643
epoch 11 training time: 15.044
---------------
2023-09-24 10:35:10.146346
current #epochs=12, #steps=429
start validation
acc: 0.436620
AUC: 0.519446
Avg Precision: 0.182619
Avg Recall: 1.000000
d_prime: 0.068962
train_loss: 1.509179
valid_loss: 1.677245
validation finished
normal learning rate scheduler step
Epoch-12 lr: 7.139442998561547e-05
Epoch-12 lr: 0.00021418328995684643
epoch 12 training time: 15.078
---------------
2023-09-24 10:35:25.223786
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00654	Per Sample Data Time 0.00103	Per Sample DNN Time 0.00550	Train Loss 1.5136	
start validation
acc: 0.436620
AUC: 0.543182
Avg Precision: 0.186203
Avg Recall: 1.000000
d_prime: 0.153378
train_loss: 1.510053
valid_loss: 1.675829
validation finished
normal learning rate scheduler step
Epoch-13 lr: 7.139442998561547e-05
Epoch-13 lr: 0.00021418328995684643
epoch 13 training time: 14.908
---------------
2023-09-24 10:35:40.132587
current #epochs=14, #steps=507
start validation
acc: 0.436620
AUC: 0.533378
Avg Precision: 0.186127
Avg Recall: 1.000000
d_prime: 0.118460
train_loss: 1.509671
valid_loss: 1.676074
validation finished
normal learning rate scheduler step
Epoch-14 lr: 7.139442998561547e-05
Epoch-14 lr: 0.00021418328995684643
epoch 14 training time: 15.193
---------------
2023-09-24 10:35:55.325448
current #epochs=15, #steps=546
start validation
acc: 0.436620
AUC: 0.528612
Avg Precision: 0.185753
Avg Recall: 1.000000
d_prime: 0.101514
train_loss: 1.508000
valid_loss: 1.675329
validation finished
normal learning rate scheduler step
Epoch-15 lr: 6.375590179190789e-05
Epoch-15 lr: 0.0001912677053757237
epoch 15 training time: 15.158
---------------
2023-09-24 10:36:10.483659
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00766	Per Sample Data Time 0.00202	Per Sample DNN Time 0.00564	Train Loss 1.5505	
start validation
acc: 0.436620
AUC: 0.529810
Avg Precision: 0.185852
Avg Recall: 1.000000
d_prime: 0.105772
train_loss: 1.509086
valid_loss: 1.676397
validation finished
normal learning rate scheduler step
Epoch-16 lr: 6.375590179190789e-05
Epoch-16 lr: 0.0001912677053757237
epoch 16 training time: 17.210
---------------
2023-09-24 10:36:27.693280
current #epochs=17, #steps=624
start validation
acc: 0.436620
AUC: 0.529189
Avg Precision: 0.185365
Avg Recall: 1.000000
d_prime: 0.103566
train_loss: 1.513153
valid_loss: 1.676201
validation finished
normal learning rate scheduler step
Epoch-17 lr: 6.375590179190789e-05
Epoch-17 lr: 0.0001912677053757237
epoch 17 training time: 16.290
---------------
2023-09-24 10:36:43.983232
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00647	Per Sample Data Time 0.00094	Per Sample DNN Time 0.00553	Train Loss 1.5114	
start validation
acc: 0.436620
AUC: 0.526727
Avg Precision: 0.185735
Avg Recall: 1.000000
d_prime: 0.094815
train_loss: 1.508185
valid_loss: 1.675633
validation finished
normal learning rate scheduler step
Epoch-18 lr: 6.375590179190789e-05
Epoch-18 lr: 0.0001912677053757237
epoch 18 training time: 16.432
---------------
2023-09-24 10:37:00.415352
current #epochs=19, #steps=702
start validation
acc: 0.436620
AUC: 0.524280
Avg Precision: 0.178486
Avg Recall: 1.000000
d_prime: 0.086123
train_loss: 1.507314
valid_loss: 1.676317
validation finished
normal learning rate scheduler step
Epoch-19 lr: 6.375590179190789e-05
Epoch-19 lr: 0.0001912677053757237
epoch 19 training time: 14.964
---------------
2023-09-24 10:37:15.379039
current #epochs=20, #steps=741
start validation
acc: 0.436620
AUC: 0.528634
Avg Precision: 0.175694
Avg Recall: 1.000000
d_prime: 0.101592
train_loss: 1.509128
valid_loss: 1.676558
validation finished
normal learning rate scheduler step
Epoch-20 lr: 6.375590179190789e-05
Epoch-20 lr: 0.0001912677053757237
epoch 20 training time: 15.021
---------------
2023-09-24 10:37:30.400619
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00725	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00566	Train Loss 1.5427	
start validation
acc: 0.436620
AUC: 0.534460
Avg Precision: 0.176345
Avg Recall: 1.000000
d_prime: 0.122311
train_loss: 1.506165
valid_loss: 1.675465
validation finished
normal learning rate scheduler step
Epoch-21 lr: 6.375590179190789e-05
Epoch-21 lr: 0.0001912677053757237
epoch 21 training time: 15.174
---------------
2023-09-24 10:37:45.574530
current #epochs=22, #steps=819
start validation
acc: 0.436620
AUC: 0.543022
Avg Precision: 0.180716
Avg Recall: 1.000000
d_prime: 0.152807
train_loss: 1.508760
valid_loss: 1.674180
validation finished
normal learning rate scheduler step
Epoch-22 lr: 6.375590179190789e-05
Epoch-22 lr: 0.0001912677053757237
epoch 22 training time: 17.419
---------------
2023-09-24 10:38:02.993100
current #epochs=23, #steps=858
start validation
acc: 0.436620
AUC: 0.546910
Avg Precision: 0.185290
Avg Recall: 1.000000
d_prime: 0.166675
train_loss: 1.507352
valid_loss: 1.675876
validation finished
normal learning rate scheduler step
Epoch-23 lr: 6.375590179190789e-05
Epoch-23 lr: 0.0001912677053757237
epoch 23 training time: 15.159
---------------
2023-09-24 10:38:18.151832
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01335	Per Sample Data Time 0.00761	Per Sample DNN Time 0.00574	Train Loss 1.4698	
start validation
acc: 0.436620
AUC: 0.604819
Avg Precision: 0.185982
Avg Recall: 1.000000
d_prime: 0.375955
train_loss: 1.505489
valid_loss: 1.677121
validation finished
normal learning rate scheduler step
Epoch-24 lr: 6.375590179190789e-05
Epoch-24 lr: 0.0001912677053757237
epoch 24 training time: 16.263
---------------
2023-09-24 10:38:34.415031
current #epochs=25, #steps=936
start validation
[I 2023-09-24 10:38:51,574] Trial 2 finished with value: 0.17921266969172825 and parameters: {'warmup': 'True', 'num_epochs': 25, 'batch_size': 52, 'lr-adaptschedule': 'False', 'lr': 7.994812228689861e-05, 'head-lr': 3, 'lr-scheduler-start': 5, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.8930094659310734}. Best is trial 0 with value: 0.18521512078138858.
acc: 0.436620
AUC: 0.580009
Avg Precision: 0.179213
Avg Recall: 1.000000
d_prime: 0.285553
train_loss: 1.538066
valid_loss: 1.675305
validation finished
normal learning rate scheduler step
Epoch-25 lr: 5.693462380914563e-05
Epoch-25 lr: 0.0001708038714274369
epoch 25 training time: 17.155
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa63ceaf610>
The learning rate scheduler starts at 5 epoch with decay rate of 0.761 every 8 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 10:38:51.580592
current #epochs=1, #steps=0
start validation
acc: 0.436620
AUC: 0.551999
Avg Precision: 0.171242
Avg Recall: 1.000000
d_prime: 0.184858
train_loss: 1.533322
valid_loss: 1.694249
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0013716786457431524
Epoch-1 lr: 0.006858393228715762
epoch 1 training time: 18.592
---------------
2023-09-24 10:39:10.172431
current #epochs=2, #steps=39
start validation
acc: 0.436620
AUC: 0.613667
Avg Precision: 0.229253
Avg Recall: 1.000000
d_prime: 0.408550
train_loss: 1.528197
valid_loss: 1.664879
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0013716786457431524
Epoch-2 lr: 0.006858393228715762
epoch 2 training time: 14.950
---------------
2023-09-24 10:39:25.122585
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00554	Train Loss 1.5165	
start validation
acc: 0.436620
AUC: 0.603031
Avg Precision: 0.251839
Avg Recall: 1.000000
d_prime: 0.369392
train_loss: 1.514788
valid_loss: 1.676206
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0013716786457431524
Epoch-3 lr: 0.006858393228715762
epoch 3 training time: 17.744
---------------
2023-09-24 10:39:42.866787
current #epochs=4, #steps=117
start validation
acc: 0.431925
AUC: 0.640921
Avg Precision: 0.206890
Avg Recall: 1.000000
d_prime: 0.510419
train_loss: 1.507177
valid_loss: 1.674676
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0013716786457431524
Epoch-4 lr: 0.006858393228715762
epoch 4 training time: 17.106
---------------
2023-09-24 10:39:59.972781
current #epochs=5, #steps=156
start validation
acc: 0.441315
AUC: 0.646526
Avg Precision: 0.200023
Avg Recall: 1.000000
d_prime: 0.531684
train_loss: 1.469089
valid_loss: 1.667816
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.001043506005409491
Epoch-5 lr: 0.005217530027047455
epoch 5 training time: 17.455
---------------
2023-09-24 10:40:17.427734
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01088	Per Sample Data Time 0.00515	Per Sample DNN Time 0.00573	Train Loss 1.4446	
start validation
acc: 0.399061
AUC: 0.585411
Avg Precision: 0.176214
Avg Recall: 1.000000
d_prime: 0.305124
train_loss: 1.424317
valid_loss: 1.658243
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.001043506005409491
Epoch-6 lr: 0.005217530027047455
epoch 6 training time: 15.053
---------------
2023-09-24 10:40:32.480559
current #epochs=7, #steps=234
start validation
acc: 0.403756
AUC: 0.635441
Avg Precision: 0.202087
Avg Recall: 1.000000
d_prime: 0.489739
train_loss: 1.424997
valid_loss: 1.658525
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.001043506005409491
Epoch-7 lr: 0.005217530027047455
epoch 7 training time: 15.065
---------------
2023-09-24 10:40:47.546197
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00675	Per Sample Data Time 0.00123	Per Sample DNN Time 0.00552	Train Loss 1.3987	
start validation
acc: 0.460094
AUC: 0.613847
Avg Precision: 0.188945
Avg Recall: 1.000000
d_prime: 0.409215
train_loss: 1.398804
valid_loss: 1.647639
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001043506005409491
Epoch-8 lr: 0.005217530027047455
epoch 8 training time: 17.527
---------------
2023-09-24 10:41:05.073472
current #epochs=9, #steps=312
start validation
acc: 0.422535
AUC: 0.639445
Avg Precision: 0.189273
Avg Recall: 1.000000
d_prime: 0.504840
train_loss: 1.390918
valid_loss: 1.641759
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.001043506005409491
Epoch-9 lr: 0.005217530027047455
epoch 9 training time: 16.446
---------------
2023-09-24 10:41:21.519096
current #epochs=10, #steps=351
start validation
acc: 0.403756
AUC: 0.663698
Avg Precision: 0.207472
Avg Recall: 1.000000
d_prime: 0.597613
train_loss: 1.391938
valid_loss: 1.659437
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.001043506005409491
Epoch-10 lr: 0.005217530027047455
epoch 10 training time: 15.233
---------------
2023-09-24 10:41:36.752401
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00872	Per Sample Data Time 0.00283	Per Sample DNN Time 0.00589	Train Loss 1.3141	
start validation
acc: 0.478873
AUC: 0.654125
Avg Precision: 0.191965
Avg Recall: 1.000000
d_prime: 0.560710
train_loss: 1.377994
valid_loss: 1.633270
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001043506005409491
Epoch-11 lr: 0.005217530027047455
epoch 11 training time: 17.401
---------------
2023-09-24 10:41:54.154039
current #epochs=12, #steps=429
start validation
acc: 0.469484
AUC: 0.666761
Avg Precision: 0.212450
Avg Recall: 1.000000
d_prime: 0.609508
train_loss: 1.337770
valid_loss: 1.597683
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001043506005409491
Epoch-12 lr: 0.005217530027047455
epoch 12 training time: 15.058
---------------
2023-09-24 10:42:09.211538
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00656	Per Sample Data Time 0.00104	Per Sample DNN Time 0.00552	Train Loss 1.3017	
start validation
acc: 0.450704
AUC: 0.693499
Avg Precision: 0.229836
Avg Recall: 1.000000
d_prime: 0.715299
train_loss: 1.297873
valid_loss: 1.619013
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0007938483162254978
Epoch-13 lr: 0.003969241581127489
epoch 13 training time: 15.303
---------------
2023-09-24 10:42:24.515057
current #epochs=14, #steps=507
start validation
acc: 0.502347
AUC: 0.710507
Avg Precision: 0.232650
Avg Recall: 1.000000
d_prime: 0.784700
train_loss: 1.283428
valid_loss: 1.603961
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0007938483162254978
Epoch-14 lr: 0.003969241581127489
epoch 14 training time: 17.345
---------------
2023-09-24 10:42:41.859705
current #epochs=15, #steps=546
start validation
acc: 0.469484
AUC: 0.690020
Avg Precision: 0.223753
Avg Recall: 1.000000
d_prime: 0.701317
train_loss: 1.289978
valid_loss: 1.588196
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0007938483162254978
Epoch-15 lr: 0.003969241581127489
epoch 15 training time: 15.079
---------------
2023-09-24 10:42:56.939166
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00753	Per Sample Data Time 0.00197	Per Sample DNN Time 0.00556	Train Loss 1.2613	
start validation
acc: 0.516432
AUC: 0.716279
Avg Precision: 0.255459
Avg Recall: 1.000000
d_prime: 0.808681
train_loss: 1.254929
valid_loss: 1.612406
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0007938483162254978
Epoch-16 lr: 0.003969241581127489
epoch 16 training time: 19.417
---------------
2023-09-24 10:43:16.355810
current #epochs=17, #steps=624
start validation
acc: 0.582160
AUC: 0.707085
Avg Precision: 0.185891
Avg Recall: 1.000000
d_prime: 0.770588
train_loss: 1.237869
valid_loss: 1.570480
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0007938483162254978
Epoch-17 lr: 0.003969241581127489
epoch 17 training time: 17.356
---------------
2023-09-24 10:43:33.712159
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00639	Per Sample Data Time 0.00092	Per Sample DNN Time 0.00547	Train Loss 1.2472	
start validation
acc: 0.521127
AUC: 0.721398
Avg Precision: 0.242856
Avg Recall: 1.000000
d_prime: 0.830145
train_loss: 1.248920
valid_loss: 1.560442
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0007938483162254978
Epoch-18 lr: 0.003969241581127489
epoch 18 training time: 14.928
---------------
2023-09-24 10:43:48.639879
current #epochs=19, #steps=702
start validation
acc: 0.539906
AUC: 0.710424
Avg Precision: 0.206559
Avg Recall: 1.000000
d_prime: 0.784357
train_loss: 1.239083
valid_loss: 1.568359
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0007938483162254978
Epoch-19 lr: 0.003969241581127489
epoch 19 training time: 15.522
---------------
2023-09-24 10:44:04.162052
current #epochs=20, #steps=741
start validation
acc: 0.558685
AUC: 0.707749
Avg Precision: 0.222009
Avg Recall: 1.000000
d_prime: 0.773322
train_loss: 1.204892
valid_loss: 1.587053
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0007938483162254978
Epoch-20 lr: 0.003969241581127489
epoch 20 training time: 15.093
---------------
2023-09-24 10:44:19.254949
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00722	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00568	Train Loss 1.2212	
start validation
acc: 0.572770
AUC: 0.725221
Avg Precision: 0.207698
Avg Recall: 1.000000
d_prime: 0.846297
train_loss: 1.196614
valid_loss: 1.554705
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0006039209605954857
Epoch-21 lr: 0.003019604802977429
epoch 21 training time: 15.032
---------------
2023-09-24 10:44:34.287714
current #epochs=22, #steps=819
start validation
acc: 0.549296
AUC: 0.715734
Avg Precision: 0.222401
Avg Recall: 1.000000
d_prime: 0.806406
train_loss: 1.164252
valid_loss: 1.574184
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0006039209605954857
Epoch-22 lr: 0.003019604802977429
epoch 22 training time: 14.905
---------------
2023-09-24 10:44:49.192547
current #epochs=23, #steps=858
start validation
acc: 0.525822
AUC: 0.717301
Avg Precision: 0.215874
Avg Recall: 1.000000
d_prime: 0.812950
train_loss: 1.136766
valid_loss: 1.577822
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0006039209605954857
Epoch-23 lr: 0.003019604802977429
epoch 23 training time: 15.001
---------------
2023-09-24 10:45:04.193730
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01327	Per Sample Data Time 0.00741	Per Sample DNN Time 0.00586	Train Loss 1.1721	
start validation
acc: 0.530516
AUC: 0.722783
Avg Precision: 0.243187
Avg Recall: 1.000000
d_prime: 0.835982
train_loss: 1.144170
valid_loss: 1.566254
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0006039209605954857
Epoch-24 lr: 0.003019604802977429
epoch 24 training time: 15.022
---------------
2023-09-24 10:45:19.215420
current #epochs=25, #steps=936
start validation
acc: 0.577465
AUC: 0.738699
Avg Precision: 0.269929
Avg Recall: 1.000000
d_prime: 0.904163
train_loss: 1.101079
valid_loss: 1.547623
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0006039209605954857
Epoch-25 lr: 0.003019604802977429
epoch 25 training time: 15.046
---------------
2023-09-24 10:45:34.262065
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00683	Per Sample Data Time 0.00128	Per Sample DNN Time 0.00555	Train Loss 1.0817	
start validation
acc: 0.577465
AUC: 0.730664
Avg Precision: 0.291589
Avg Recall: 1.000000
d_prime: 0.869489
train_loss: 1.103652
valid_loss: 1.549321
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0006039209605954857
Epoch-26 lr: 0.003019604802977429
epoch 26 training time: 15.124
---------------
2023-09-24 10:45:49.385873
current #epochs=27, #steps=1014
start validation
acc: 0.624413
AUC: 0.740025
Avg Precision: 0.284931
Avg Recall: 1.000000
d_prime: 0.909938
train_loss: 1.092587
valid_loss: 1.544771
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0006039209605954857
Epoch-27 lr: 0.003019604802977429
epoch 27 training time: 18.401
---------------
2023-09-24 10:46:07.786437
current #epochs=28, #steps=1053
start validation
acc: 0.544601
AUC: 0.722778
Avg Precision: 0.243308
Avg Recall: 1.000000
d_prime: 0.835962
train_loss: 1.088769
valid_loss: 1.543872
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0006039209605954857
Epoch-28 lr: 0.003019604802977429
epoch 28 training time: 15.091
---------------
2023-09-24 10:46:22.877259
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00929	Per Sample Data Time 0.00360	Per Sample DNN Time 0.00569	Train Loss 1.1495	
start validation
acc: 0.563380
AUC: 0.732060
Avg Precision: 0.247313
Avg Recall: 1.000000
d_prime: 0.875475
train_loss: 1.092448
valid_loss: 1.544948
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00045943352047492784
Epoch-29 lr: 0.0022971676023746395
epoch 29 training time: 15.032
---------------
2023-09-24 10:46:37.908782
current #epochs=30, #steps=1131
start validation
acc: 0.586854
AUC: 0.750542
Avg Precision: 0.270859
Avg Recall: 1.000000
d_prime: 0.956284
train_loss: 1.112327
valid_loss: 1.533464
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00045943352047492784
Epoch-30 lr: 0.0022971676023746395
epoch 30 training time: 15.017
---------------
2023-09-24 10:46:52.925638
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00664	Per Sample Data Time 0.00113	Per Sample DNN Time 0.00551	Train Loss 1.0635	
start validation
acc: 0.600939
AUC: 0.753325
Avg Precision: 0.240000
Avg Recall: 1.000000
d_prime: 0.968724
train_loss: 1.064404
valid_loss: 1.530282
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.00045943352047492784
Epoch-31 lr: 0.0022971676023746395
epoch 31 training time: 15.062
---------------
2023-09-24 10:47:07.987924
current #epochs=32, #steps=1209
start validation
acc: 0.516432
AUC: 0.728207
Avg Precision: 0.247971
Avg Recall: 1.000000
d_prime: 0.858992
train_loss: 1.082889
valid_loss: 1.542884
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00045943352047492784
Epoch-32 lr: 0.0022971676023746395
epoch 32 training time: 15.165
---------------
2023-09-24 10:47:23.153656
current #epochs=33, #steps=1248
start validation
acc: 0.615023
AUC: 0.768352
Avg Precision: 0.263836
Avg Recall: 1.000000
d_prime: 1.037227
train_loss: 1.063966
valid_loss: 1.513150
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.00045943352047492784
Epoch-33 lr: 0.0022971676023746395
epoch 33 training time: 15.056
---------------
2023-09-24 10:47:38.208981
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00785	Per Sample Data Time 0.00224	Per Sample DNN Time 0.00561	Train Loss 1.0470	
start validation
[I 2023-09-24 10:47:55,595] Trial 3 finished with value: 0.2995228476139806 and parameters: {'warmup': 'True', 'num_epochs': 34, 'batch_size': 39, 'lr-adaptschedule': 'False', 'lr': 0.0013716786457431524, 'head-lr': 5, 'lr-scheduler-start': 5, 'lr-scheduler-step': 8, 'lr-scheduler-decay': 0.7607510758061973}. Best is trial 3 with value: 0.2995228476139806.
acc: 0.633803
AUC: 0.755663
Avg Precision: 0.299523
Avg Recall: 1.000000
d_prime: 0.979227
train_loss: 1.051895
valid_loss: 1.525335
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.00045943352047492784
Epoch-34 lr: 0.0022971676023746395
epoch 34 training time: 17.382
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f4da610>
The learning rate scheduler starts at 4 epoch with decay rate of 0.665 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 10:47:55.601619
current #epochs=1, #steps=0
start validation
acc: 0.619718
AUC: 0.752468
Avg Precision: 0.284125
Avg Recall: 1.000000
d_prime: 0.964886
train_loss: 1.047539
valid_loss: 1.525808
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0006448931735261035
Epoch-1 lr: 0.003224465867630518
epoch 1 training time: 17.597
---------------
2023-09-24 10:48:13.198830
current #epochs=2, #steps=39
start validation
acc: 0.643192
AUC: 0.767575
Avg Precision: 0.288479
Avg Recall: 1.000000
d_prime: 1.033627
train_loss: 1.026560
valid_loss: 1.525473
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0006448931735261035
Epoch-2 lr: 0.003224465867630518
epoch 2 training time: 17.397
---------------
2023-09-24 10:48:30.595425
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00704	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00556	Train Loss 1.0087	
start validation
acc: 0.553991
AUC: 0.780275
Avg Precision: 0.263249
Avg Recall: 1.000000
d_prime: 1.093361
train_loss: 1.022459
valid_loss: 1.554133
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0006448931735261035
Epoch-3 lr: 0.003224465867630518
epoch 3 training time: 15.041
---------------
2023-09-24 10:48:45.636357
current #epochs=4, #steps=117
start validation
acc: 0.633803
AUC: 0.771951
Avg Precision: 0.291883
Avg Recall: 1.000000
d_prime: 1.053995
train_loss: 0.983481
valid_loss: 1.522741
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00042906832266341173
Epoch-4 lr: 0.002145341613317059
epoch 4 training time: 15.211
---------------
2023-09-24 10:49:00.846787
current #epochs=5, #steps=156
start validation
acc: 0.624413
AUC: 0.781803
Avg Precision: 0.271833
Avg Recall: 1.000000
d_prime: 1.100677
train_loss: 0.966172
valid_loss: 1.515425
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00028547305673370065
Epoch-5 lr: 0.0014273652836685033
epoch 5 training time: 15.058
---------------
2023-09-24 10:49:15.905112
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01073	Per Sample Data Time 0.00505	Per Sample DNN Time 0.00568	Train Loss 0.9647	
start validation
acc: 0.629108
AUC: 0.800874
Avg Precision: 0.291383
Avg Recall: 1.000000
d_prime: 1.194651
train_loss: 0.940995
valid_loss: 1.497757
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00018993447387355227
Epoch-6 lr: 0.0009496723693677613
epoch 6 training time: 15.051
---------------
2023-09-24 10:49:30.955886
current #epochs=7, #steps=234
start validation
acc: 0.661972
AUC: 0.801235
Avg Precision: 0.313879
Avg Recall: 1.000000
d_prime: 1.196482
train_loss: 0.926363
valid_loss: 1.484056
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00012636955927954784
Epoch-7 lr: 0.0006318477963977393
epoch 7 training time: 17.544
---------------
2023-09-24 10:49:48.500096
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00674	Per Sample Data Time 0.00123	Per Sample DNN Time 0.00552	Train Loss 0.9427	
start validation
acc: 0.666667
AUC: 0.802477
Avg Precision: 0.312127
Avg Recall: 1.000000
d_prime: 1.202794
train_loss: 0.941235
valid_loss: 1.494480
validation finished
normal learning rate scheduler step
Epoch-8 lr: 8.407776211883787e-05
Epoch-8 lr: 0.00042038881059418943
epoch 8 training time: 18.146
---------------
2023-09-24 10:50:06.645849
current #epochs=9, #steps=312
start validation
acc: 0.657277
AUC: 0.797106
Avg Precision: 0.318241
Avg Recall: 1.000000
d_prime: 1.175675
train_loss: 0.893566
valid_loss: 1.484877
validation finished
normal learning rate scheduler step
Epoch-9 lr: 5.5939659228169646e-05
Epoch-9 lr: 0.00027969829614084827
epoch 9 training time: 15.024
---------------
2023-09-24 10:50:21.669917
current #epochs=10, #steps=351
start validation
acc: 0.661972
AUC: 0.806641
Avg Precision: 0.315454
Avg Recall: 1.000000
d_prime: 1.224124
train_loss: 0.892062
valid_loss: 1.483914
validation finished
normal learning rate scheduler step
Epoch-10 lr: 3.721846771017504e-05
Epoch-10 lr: 0.00018609233855087522
epoch 10 training time: 15.020
---------------
2023-09-24 10:50:36.689596
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00864	Per Sample Data Time 0.00286	Per Sample DNN Time 0.00578	Train Loss 0.9184	
start validation
acc: 0.666667
AUC: 0.806159
Avg Precision: 0.320260
Avg Recall: 1.000000
d_prime: 1.221639
train_loss: 0.901619
valid_loss: 1.484340
validation finished
normal learning rate scheduler step
Epoch-11 lr: 2.4762652433102184e-05
Epoch-11 lr: 0.00012381326216551091
epoch 11 training time: 15.345
---------------
2023-09-24 10:50:52.034557
current #epochs=12, #steps=429
start validation
acc: 0.671362
AUC: 0.804825
Avg Precision: 0.324854
Avg Recall: 1.000000
d_prime: 1.214785
train_loss: 0.900808
valid_loss: 1.483217
validation finished
normal learning rate scheduler step
Epoch-12 lr: 1.6475394965144782e-05
Epoch-12 lr: 8.23769748257239e-05
epoch 12 training time: 17.729
---------------
2023-09-24 10:51:09.763744
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00661	Per Sample Data Time 0.00104	Per Sample DNN Time 0.00556	Train Loss 0.8937	
start validation
acc: 0.676056
AUC: 0.805357
Avg Precision: 0.326415
Avg Recall: 1.000000
d_prime: 1.217514
train_loss: 0.898041
valid_loss: 1.482967
validation finished
normal learning rate scheduler step
Epoch-13 lr: 1.0961614067427795e-05
Epoch-13 lr: 5.480807033713897e-05
epoch 13 training time: 17.473
---------------
2023-09-24 10:51:27.236712
current #epochs=14, #steps=507
start validation
acc: 0.676056
AUC: 0.805634
Avg Precision: 0.325933
Avg Recall: 1.000000
d_prime: 1.218936
train_loss: 0.882203
valid_loss: 1.482532
validation finished
normal learning rate scheduler step
Epoch-14 lr: 7.293116991576476e-06
Epoch-14 lr: 3.6465584957882375e-05
epoch 14 training time: 15.083
---------------
2023-09-24 10:51:42.319877
current #epochs=15, #steps=546
start validation
acc: 0.676056
AUC: 0.805112
Avg Precision: 0.327462
Avg Recall: 1.000000
d_prime: 1.216257
train_loss: 0.907803
valid_loss: 1.482654
validation finished
normal learning rate scheduler step
Epoch-15 lr: 4.852347028972052e-06
Epoch-15 lr: 2.4261735144860253e-05
epoch 15 training time: 15.135
---------------
2023-09-24 10:51:57.454895
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00769	Per Sample Data Time 0.00209	Per Sample DNN Time 0.00561	Train Loss 0.9232	
start validation
acc: 0.676056
AUC: 0.804864
Avg Precision: 0.327093
Avg Recall: 1.000000
d_prime: 1.214986
train_loss: 0.889464
valid_loss: 1.482977
validation finished
normal learning rate scheduler step
Epoch-16 lr: 3.228423692745996e-06
Epoch-16 lr: 1.6142118463729978e-05
epoch 16 training time: 15.115
---------------
2023-09-24 10:52:12.570215
current #epochs=17, #steps=624
start validation
acc: 0.676056
AUC: 0.805016
Avg Precision: 0.327234
Avg Recall: 1.000000
d_prime: 1.215766
train_loss: 0.891858
valid_loss: 1.482839
validation finished
normal learning rate scheduler step
Epoch-17 lr: 2.147974882598556e-06
Epoch-17 lr: 1.0739874412992778e-05
epoch 17 training time: 15.173
---------------
2023-09-24 10:52:27.742888
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00644	Per Sample Data Time 0.00094	Per Sample DNN Time 0.00551	Train Loss 0.9087	
start validation
acc: 0.676056
AUC: 0.805177
Avg Precision: 0.327054
Avg Recall: 1.000000
d_prime: 1.216590
train_loss: 0.905561
valid_loss: 1.482900
validation finished
normal learning rate scheduler step
Epoch-18 lr: 1.4291172830385003e-06
Epoch-18 lr: 7.1455864151925e-06
epoch 18 training time: 14.989
---------------
2023-09-24 10:52:42.732111
current #epochs=19, #steps=702
start validation
acc: 0.676056
AUC: 0.805333
Avg Precision: 0.327921
Avg Recall: 1.000000
d_prime: 1.217392
train_loss: 0.895897
valid_loss: 1.482990
validation finished
normal learning rate scheduler step
Epoch-19 lr: 9.50838031312796e-07
Epoch-19 lr: 4.754190156563979e-06
epoch 19 training time: 15.186
---------------
2023-09-24 10:52:57.917779
current #epochs=20, #steps=741
start validation
acc: 0.676056
AUC: 0.805290
Avg Precision: 0.328062
Avg Recall: 1.000000
d_prime: 1.217171
train_loss: 0.891308
valid_loss: 1.482932
validation finished
normal learning rate scheduler step
Epoch-20 lr: 6.326233490568159e-07
Epoch-20 lr: 3.1631167452840787e-06
epoch 20 training time: 15.083
---------------
2023-09-24 10:53:13.001134
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00560	Train Loss 0.9669	
start validation
acc: 0.676056
AUC: 0.805493
Avg Precision: 0.329627
Avg Recall: 1.000000
d_prime: 1.218216
train_loss: 0.908468
valid_loss: 1.482927
validation finished
normal learning rate scheduler step
Epoch-21 lr: 4.209048109059119e-07
Epoch-21 lr: 2.104524054529559e-06
epoch 21 training time: 15.032
---------------
2023-09-24 10:53:28.032862
current #epochs=22, #steps=819
start validation
acc: 0.676056
AUC: 0.805500
Avg Precision: 0.329807
Avg Recall: 1.000000
d_prime: 1.218249
train_loss: 0.887473
valid_loss: 1.482892
validation finished
normal learning rate scheduler step
Epoch-22 lr: 2.800416078664694e-07
Epoch-22 lr: 1.4002080393323467e-06
epoch 22 training time: 14.990
---------------
2023-09-24 10:53:43.022598
current #epochs=23, #steps=858
start validation
acc: 0.676056
AUC: 0.805486
Avg Precision: 0.329807
Avg Recall: 1.000000
d_prime: 1.218176
train_loss: 0.896259
valid_loss: 1.482882
validation finished
normal learning rate scheduler step
Epoch-23 lr: 1.8632075496511252e-07
Epoch-23 lr: 9.316037748255624e-07
epoch 23 training time: 15.053
---------------
2023-09-24 10:53:58.075510
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01338	Per Sample Data Time 0.00783	Per Sample DNN Time 0.00555	Train Loss 0.8729	
start validation
acc: 0.676056
AUC: 0.805469
Avg Precision: 0.329768
Avg Recall: 1.000000
d_prime: 1.218089
train_loss: 0.892938
valid_loss: 1.482892
validation finished
normal learning rate scheduler step
Epoch-24 lr: 1.2396523500651608e-07
Epoch-24 lr: 6.198261750325802e-07
epoch 24 training time: 15.090
---------------
2023-09-24 10:54:13.165289
current #epochs=25, #steps=936
start validation
acc: 0.676056
AUC: 0.805484
Avg Precision: 0.329768
Avg Recall: 1.000000
d_prime: 1.218165
train_loss: 0.883966
valid_loss: 1.482879
validation finished
normal learning rate scheduler step
Epoch-25 lr: 8.24780872807123e-08
Epoch-25 lr: 4.123904364035614e-07
epoch 25 training time: 14.952
---------------
2023-09-24 10:54:28.117216
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00686	Per Sample Data Time 0.00127	Per Sample DNN Time 0.00559	Train Loss 0.9232	
start validation
acc: 0.676056
AUC: 0.805484
Avg Precision: 0.329768
Avg Recall: 1.000000
d_prime: 1.218165
train_loss: 0.906954
valid_loss: 1.482880
validation finished
normal learning rate scheduler step
Epoch-26 lr: 5.4875343729451434e-08
Epoch-26 lr: 2.743767186472571e-07
epoch 26 training time: 15.006
---------------
2023-09-24 10:54:43.123112
current #epochs=27, #steps=1014
start validation
acc: 0.676056
AUC: 0.805585
Avg Precision: 0.329807
Avg Recall: 1.000000
d_prime: 1.218688
train_loss: 0.895171
valid_loss: 1.482881
validation finished
normal learning rate scheduler step
Epoch-27 lr: 3.6510344125422575e-08
Epoch-27 lr: 1.8255172062711283e-07
epoch 27 training time: 16.568
---------------
2023-09-24 10:54:59.691237
current #epochs=28, #steps=1053
start validation
acc: 0.676056
AUC: 0.805529
Avg Precision: 0.329807
Avg Recall: 1.000000
d_prime: 1.218396
train_loss: 0.894759
valid_loss: 1.482880
validation finished
normal learning rate scheduler step
Epoch-28 lr: 2.4291514869206348e-08
Epoch-28 lr: 1.2145757434603172e-07
epoch 28 training time: 14.991
---------------
2023-09-24 10:55:14.682376
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00940	Per Sample Data Time 0.00362	Per Sample DNN Time 0.00578	Train Loss 0.9149	
start validation
acc: 0.676056
AUC: 0.805462
Avg Precision: 0.329768
Avg Recall: 1.000000
d_prime: 1.218056
train_loss: 0.884125
valid_loss: 1.482880
validation finished
normal learning rate scheduler step
Epoch-29 lr: 1.6161931879190236e-08
Epoch-29 lr: 8.080965939595116e-08
epoch 29 training time: 15.212
---------------
2023-09-24 10:55:29.894032
current #epochs=30, #steps=1131
start validation
acc: 0.676056
AUC: 0.805462
Avg Precision: 0.329768
Avg Recall: 1.000000
d_prime: 1.218056
train_loss: 0.915055
valid_loss: 1.482879
validation finished
normal learning rate scheduler step
Epoch-30 lr: 1.0753056920246318e-08
Epoch-30 lr: 5.376528460123157e-08
epoch 30 training time: 15.077
---------------
2023-09-24 10:55:44.971062
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00664	Per Sample Data Time 0.00112	Per Sample DNN Time 0.00552	Train Loss 0.8727	
start validation
acc: 0.676056
AUC: 0.805498
Avg Precision: 0.329768
Avg Recall: 1.000000
d_prime: 1.218238
train_loss: 0.883971
valid_loss: 1.482879
validation finished
normal learning rate scheduler step
Epoch-31 lr: 7.15435716437697e-09
Epoch-31 lr: 3.577178582188484e-08
epoch 31 training time: 15.068
---------------
2023-09-24 10:56:00.039421
current #epochs=32, #steps=1209
start validation
acc: 0.676056
AUC: 0.805498
Avg Precision: 0.329768
Avg Recall: 1.000000
d_prime: 1.218238
train_loss: 0.897707
valid_loss: 1.482879
validation finished
normal learning rate scheduler step
Epoch-32 lr: 4.760025620165657e-09
Epoch-32 lr: 2.3800128100828277e-08
epoch 32 training time: 15.039
---------------
2023-09-24 10:56:15.079172
current #epochs=33, #steps=1248
start validation
acc: 0.676056
AUC: 0.805498
Avg Precision: 0.329768
Avg Recall: 1.000000
d_prime: 1.218238
train_loss: 0.900345
valid_loss: 1.482879
validation finished
normal learning rate scheduler step
Epoch-33 lr: 3.166999268285284e-09
Epoch-33 lr: 1.5834996341426416e-08
epoch 33 training time: 15.310
---------------
2023-09-24 10:56:30.388956
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00795	Per Sample Data Time 0.00230	Per Sample DNN Time 0.00565	Train Loss 0.8979	
start validation
acc: 0.676056
AUC: 0.805498
Avg Precision: 0.329768
Avg Recall: 1.000000
d_prime: 1.218238
train_loss: 0.888596
valid_loss: 1.482879
validation finished
normal learning rate scheduler step
Epoch-34 lr: 2.107107222874668e-09
Epoch-34 lr: 1.0535536114373335e-08
epoch 34 training time: 15.228
---------------
2023-09-24 10:56:45.616391
current #epochs=35, #steps=1326
start validation
acc: 0.676056
AUC: 0.805498
Avg Precision: 0.329768
Avg Recall: 1.000000
d_prime: 1.218238
train_loss: 0.887045
valid_loss: 1.482879
validation finished
normal learning rate scheduler step
Epoch-35 lr: 1.4019267049261117e-09
Epoch-35 lr: 7.009633524630555e-09
epoch 35 training time: 15.124
---------------
2023-09-24 10:57:00.740627
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00650	Per Sample Data Time 0.00096	Per Sample DNN Time 0.00555	Train Loss 0.9228	
start validation
acc: 0.676056
AUC: 0.805498
Avg Precision: 0.329768
Avg Recall: 1.000000
d_prime: 1.218238
train_loss: 0.915658
valid_loss: 1.482879
validation finished
normal learning rate scheduler step
Epoch-36 lr: 9.327472587292668e-10
Epoch-36 lr: 4.663736293646332e-09
epoch 36 training time: 15.118
---------------
2023-09-24 10:57:15.858427
current #epochs=37, #steps=1404
start validation
acc: 0.676056
AUC: 0.805498
Avg Precision: 0.329768
Avg Recall: 1.000000
d_prime: 1.218238
train_loss: 0.891642
valid_loss: 1.482879
validation finished
normal learning rate scheduler step
Epoch-37 lr: 6.205869719221991e-10
Epoch-37 lr: 3.102934859610994e-09
epoch 37 training time: 15.107
---------------
2023-09-24 10:57:30.966179
current #epochs=38, #steps=1443
start validation
acc: 0.676056
AUC: 0.805498
Avg Precision: 0.329768
Avg Recall: 1.000000
d_prime: 1.218238
train_loss: 0.897963
valid_loss: 1.482879
validation finished
normal learning rate scheduler step
Epoch-38 lr: 4.128966192237817e-10
Epoch-38 lr: 2.0644830961189075e-09
epoch 38 training time: 14.976
---------------
2023-09-24 10:57:45.942140
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00729	Per Sample Data Time 0.00173	Per Sample DNN Time 0.00556	Train Loss 0.8611	
start validation
acc: 0.676056
AUC: 0.805498
Avg Precision: 0.329768
Avg Recall: 1.000000
d_prime: 1.218238
train_loss: 0.882640
valid_loss: 1.482879
validation finished
normal learning rate scheduler step
Epoch-39 lr: 2.7471349847769853e-10
Epoch-39 lr: 1.3735674923884921e-09
epoch 39 training time: 15.052
---------------
2023-09-24 10:58:00.994508
current #epochs=40, #steps=1521
start validation
acc: 0.676056
AUC: 0.805498
Avg Precision: 0.329768
Avg Recall: 1.000000
d_prime: 1.218238
train_loss: 0.888707
valid_loss: 1.482879
validation finished
normal learning rate scheduler step
Epoch-40 lr: 1.827757911598559e-10
Epoch-40 lr: 9.138789557992792e-10
epoch 40 training time: 16.996
---------------
2023-09-24 10:58:17.990364
current #epochs=41, #steps=1560
start validation
acc: 0.676056
AUC: 0.805498
Avg Precision: 0.329768
Avg Recall: 1.000000
d_prime: 1.218238
train_loss: 0.887877
valid_loss: 1.482879
validation finished
normal learning rate scheduler step
Epoch-41 lr: 1.216066557312737e-10
Epoch-41 lr: 6.080332786563682e-10
epoch 41 training time: 15.943
---------------
2023-09-24 10:58:33.932816
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02055	Per Sample Data Time 0.01469	Per Sample DNN Time 0.00586	Train Loss 0.9382	
start validation
acc: 0.676056
AUC: 0.805498
Avg Precision: 0.329768
Avg Recall: 1.000000
d_prime: 1.218238
train_loss: 0.875627
valid_loss: 1.482879
validation finished
normal learning rate scheduler step
Epoch-42 lr: 8.090884807173813e-11
Epoch-42 lr: 4.045442403586905e-10
epoch 42 training time: 14.969
---------------
2023-09-24 10:58:48.902405
current #epochs=43, #steps=1638
start validation
[I 2023-09-24 10:59:04,016] Trial 4 finished with value: 0.3297683463043474 and parameters: {'warmup': 'True', 'num_epochs': 43, 'batch_size': 47, 'lr-adaptschedule': 'False', 'lr': 0.0006448931735261035, 'head-lr': 5, 'lr-scheduler-start': 4, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.6653323996552496}. Best is trial 4 with value: 0.3297683463043474.
acc: 0.676056
AUC: 0.805498
Avg Precision: 0.329768
Avg Recall: 1.000000
d_prime: 1.218238
train_loss: 0.889318
valid_loss: 1.482879
validation finished
normal learning rate scheduler step
Epoch-43 lr: 5.383127804091154e-11
Epoch-43 lr: 2.691563902045576e-10
epoch 43 training time: 15.109
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa6150c6130>
The learning rate scheduler starts at 7 epoch with decay rate of 0.906 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 10:59:04.021901
current #epochs=1, #steps=0
start validation
acc: 0.370892
AUC: 0.710178
Avg Precision: 0.220162
Avg Recall: 1.000000
d_prime: 0.783341
train_loss: 1.480803
valid_loss: 1.633832
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.004489041370214458
Epoch-1 lr: 0.008978082740428916
epoch 1 training time: 18.140
---------------
2023-09-24 10:59:22.162652
current #epochs=2, #steps=39
start validation
acc: 0.446009
AUC: 0.714301
Avg Precision: 0.249151
Avg Recall: 1.000000
d_prime: 0.800435
train_loss: 1.320438
valid_loss: 1.605587
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.004489041370214458
Epoch-2 lr: 0.008978082740428916
epoch 2 training time: 17.506
---------------
2023-09-24 10:59:39.668950
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00702	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00558	Train Loss 1.3672	
start validation
acc: 0.525822
AUC: 0.710221
Avg Precision: 0.229201
Avg Recall: 1.000000
d_prime: 0.783516
train_loss: 1.325334
valid_loss: 1.571069
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.004489041370214458
Epoch-3 lr: 0.008978082740428916
epoch 3 training time: 17.454
---------------
2023-09-24 10:59:57.123231
current #epochs=4, #steps=117
start validation
acc: 0.507042
AUC: 0.719169
Avg Precision: 0.273933
Avg Recall: 1.000000
d_prime: 0.820776
train_loss: 1.272943
valid_loss: 1.574975
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.004489041370214458
Epoch-4 lr: 0.008978082740428916
epoch 4 training time: 15.115
---------------
2023-09-24 11:00:12.238494
current #epochs=5, #steps=156
start validation
acc: 0.469484
AUC: 0.656711
Avg Precision: 0.211535
Avg Recall: 1.000000
d_prime: 0.570638
train_loss: 1.261909
valid_loss: 1.626690
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.004489041370214458
Epoch-5 lr: 0.008978082740428916
epoch 5 training time: 15.090
---------------
2023-09-24 11:00:27.328428
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01126	Per Sample Data Time 0.00531	Per Sample DNN Time 0.00595	Train Loss 1.2716	
start validation
acc: 0.577465
AUC: 0.756709
Avg Precision: 0.248423
Avg Recall: 1.000000
d_prime: 0.983946
train_loss: 1.260396
valid_loss: 1.547459
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.004489041370214458
Epoch-6 lr: 0.008978082740428916
epoch 6 training time: 17.588
---------------
2023-09-24 11:00:44.915798
current #epochs=7, #steps=234
start validation
acc: 0.549296
AUC: 0.721112
Avg Precision: 0.226090
Avg Recall: 1.000000
d_prime: 0.828939
train_loss: 1.226620
valid_loss: 1.572461
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.004068320114378678
Epoch-7 lr: 0.008136640228757356
epoch 7 training time: 15.113
---------------
2023-09-24 11:01:00.028854
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00680	Per Sample Data Time 0.00123	Per Sample DNN Time 0.00557	Train Loss 1.1902	
start validation
acc: 0.558685
AUC: 0.734919
Avg Precision: 0.233818
Avg Recall: 1.000000
d_prime: 0.887785
train_loss: 1.194069
valid_loss: 1.569696
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.004068320114378678
Epoch-8 lr: 0.008136640228757356
epoch 8 training time: 15.119
---------------
2023-09-24 11:01:15.148446
current #epochs=9, #steps=312
start validation
acc: 0.577465
AUC: 0.734121
Avg Precision: 0.275139
Avg Recall: 1.000000
d_prime: 0.884342
train_loss: 1.186202
valid_loss: 1.548625
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.004068320114378678
Epoch-9 lr: 0.008136640228757356
epoch 9 training time: 15.035
---------------
2023-09-24 11:01:30.182849
current #epochs=10, #steps=351
start validation
acc: 0.605634
AUC: 0.748592
Avg Precision: 0.266758
Avg Recall: 1.000000
d_prime: 0.947618
train_loss: 1.179239
valid_loss: 1.527022
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.003687029632401767
Epoch-10 lr: 0.007374059264803534
epoch 10 training time: 17.415
---------------
2023-09-24 11:01:47.597603
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00862	Per Sample Data Time 0.00286	Per Sample DNN Time 0.00576	Train Loss 1.1872	
start validation
acc: 0.539906
AUC: 0.746859
Avg Precision: 0.260548
Avg Recall: 1.000000
d_prime: 0.939942
train_loss: 1.145109
valid_loss: 1.536817
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.003687029632401767
Epoch-11 lr: 0.007374059264803534
epoch 11 training time: 15.194
---------------
2023-09-24 11:02:02.791167
current #epochs=12, #steps=429
start validation
acc: 0.624413
AUC: 0.734073
Avg Precision: 0.311875
Avg Recall: 1.000000
d_prime: 0.884136
train_loss: 1.207208
valid_loss: 1.564388
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.003687029632401767
Epoch-12 lr: 0.007374059264803534
epoch 12 training time: 17.563
---------------
2023-09-24 11:02:20.354484
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00662	Per Sample Data Time 0.00105	Per Sample DNN Time 0.00557	Train Loss 1.1458	
start validation
acc: 0.572770
AUC: 0.709058
Avg Precision: 0.302967
Avg Recall: 1.000000
d_prime: 0.778715
train_loss: 1.145393
valid_loss: 1.545629
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.003341474399264385
Epoch-13 lr: 0.00668294879852877
epoch 13 training time: 15.074
---------------
2023-09-24 11:02:35.428603
current #epochs=14, #steps=507
start validation
acc: 0.615023
AUC: 0.757855
Avg Precision: 0.304121
Avg Recall: 1.000000
d_prime: 0.989129
train_loss: 1.113186
valid_loss: 1.507024
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.003341474399264385
Epoch-14 lr: 0.00668294879852877
epoch 14 training time: 15.123
---------------
2023-09-24 11:02:50.551840
current #epochs=15, #steps=546
start validation
acc: 0.572770
AUC: 0.731757
Avg Precision: 0.296062
Avg Recall: 1.000000
d_prime: 0.874174
train_loss: 1.113475
valid_loss: 1.522001
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.003341474399264385
Epoch-15 lr: 0.00668294879852877
epoch 15 training time: 15.151
---------------
2023-09-24 11:03:05.703191
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00774	Per Sample Data Time 0.00209	Per Sample DNN Time 0.00565	Train Loss 1.2118	
start validation
acc: 0.619718
AUC: 0.778405
Avg Precision: 0.315897
Avg Recall: 1.000000
d_prime: 1.084445
train_loss: 1.115543
valid_loss: 1.488911
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0030283052413836993
Epoch-16 lr: 0.006056610482767399
epoch 16 training time: 15.335
---------------
2023-09-24 11:03:21.037776
current #epochs=17, #steps=624
start validation
acc: 0.643192
AUC: 0.787133
Avg Precision: 0.313694
Avg Recall: 1.000000
d_prime: 1.126437
train_loss: 1.053228
valid_loss: 1.494506
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0030283052413836993
Epoch-17 lr: 0.006056610482767399
epoch 17 training time: 17.894
---------------
2023-09-24 11:03:38.932535
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00646	Per Sample Data Time 0.00095	Per Sample DNN Time 0.00550	Train Loss 1.0503	
start validation
acc: 0.629108
AUC: 0.741571
Avg Precision: 0.316639
Avg Recall: 1.000000
d_prime: 0.916689
train_loss: 1.046306
valid_loss: 1.494450
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0030283052413836993
Epoch-18 lr: 0.006056610482767399
epoch 18 training time: 15.073
---------------
2023-09-24 11:03:54.005058
current #epochs=19, #steps=702
start validation
acc: 0.615023
AUC: 0.770462
Avg Precision: 0.388506
Avg Recall: 1.000000
d_prime: 1.047040
train_loss: 1.112135
valid_loss: 1.517232
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0027444868759164726
Epoch-19 lr: 0.005488973751832945
epoch 19 training time: 14.983
---------------
2023-09-24 11:04:08.987904
current #epochs=20, #steps=741
start validation
acc: 0.629108
AUC: 0.755474
Avg Precision: 0.380197
Avg Recall: 1.000000
d_prime: 0.978377
train_loss: 1.071958
valid_loss: 1.500481
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0027444868759164726
Epoch-20 lr: 0.005488973751832945
epoch 20 training time: 16.144
---------------
2023-09-24 11:04:25.132245
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00566	Train Loss 0.9981	
start validation
acc: 0.671362
AUC: 0.819953
Avg Precision: 0.377538
Avg Recall: 1.000000
d_prime: 1.294270
train_loss: 1.042212
valid_loss: 1.478291
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0027444868759164726
Epoch-21 lr: 0.005488973751832945
epoch 21 training time: 17.505
---------------
2023-09-24 11:04:42.636881
current #epochs=22, #steps=819
start validation
acc: 0.647887
AUC: 0.768392
Avg Precision: 0.345989
Avg Recall: 1.000000
d_prime: 1.037412
train_loss: 1.032802
valid_loss: 1.488756
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.002487268492338681
Epoch-22 lr: 0.004974536984677362
epoch 22 training time: 15.062
---------------
2023-09-24 11:04:57.699559
current #epochs=23, #steps=858
start validation
acc: 0.596244
AUC: 0.785443
Avg Precision: 0.366883
Avg Recall: 1.000000
d_prime: 1.118231
train_loss: 0.996992
valid_loss: 1.502460
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.002487268492338681
Epoch-23 lr: 0.004974536984677362
epoch 23 training time: 15.128
---------------
2023-09-24 11:05:12.827617
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01376	Per Sample Data Time 0.00793	Per Sample DNN Time 0.00584	Train Loss 0.9778	
start validation
acc: 0.633803
AUC: 0.780527
Avg Precision: 0.338033
Avg Recall: 1.000000
d_prime: 1.094564
train_loss: 1.069359
valid_loss: 1.494000
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.002487268492338681
Epoch-24 lr: 0.004974536984677362
epoch 24 training time: 15.052
---------------
2023-09-24 11:05:27.879332
current #epochs=25, #steps=936
start validation
acc: 0.671362
AUC: 0.792390
Avg Precision: 0.375760
Avg Recall: 1.000000
d_prime: 1.152220
train_loss: 1.063856
valid_loss: 1.468422
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0022541570911738694
Epoch-25 lr: 0.004508314182347739
epoch 25 training time: 15.069
---------------
2023-09-24 11:05:42.948250
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00689	Per Sample Data Time 0.00132	Per Sample DNN Time 0.00557	Train Loss 1.0101	
start validation
acc: 0.704225
AUC: 0.824117
Avg Precision: 0.378692
Avg Recall: 1.000000
d_prime: 1.316871
train_loss: 1.025375
valid_loss: 1.473491
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0022541570911738694
Epoch-26 lr: 0.004508314182347739
epoch 26 training time: 17.665
---------------
2023-09-24 11:06:00.613270
current #epochs=27, #steps=1014
start validation
acc: 0.638498
AUC: 0.804238
Avg Precision: 0.371895
Avg Recall: 1.000000
d_prime: 1.211778
train_loss: 0.958317
valid_loss: 1.464435
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0022541570911738694
Epoch-27 lr: 0.004508314182347739
epoch 27 training time: 16.431
---------------
2023-09-24 11:06:17.044152
current #epochs=28, #steps=1053
start validation
acc: 0.713615
AUC: 0.832789
Avg Precision: 0.390268
Avg Recall: 1.000000
d_prime: 1.365062
train_loss: 0.941376
valid_loss: 1.444274
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0020428933214651722
Epoch-28 lr: 0.0040857866429303445
epoch 28 training time: 17.368
---------------
2023-09-24 11:06:34.412023
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00914	Per Sample Data Time 0.00344	Per Sample DNN Time 0.00570	Train Loss 0.8716	
start validation
acc: 0.676056
AUC: 0.820414
Avg Precision: 0.380269
Avg Recall: 1.000000
d_prime: 1.296757
train_loss: 0.985509
valid_loss: 1.472398
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0020428933214651722
Epoch-29 lr: 0.0040857866429303445
epoch 29 training time: 15.047
---------------
2023-09-24 11:06:49.458755
current #epochs=30, #steps=1131
start validation
acc: 0.666667
AUC: 0.842988
Avg Precision: 0.368430
Avg Recall: 1.000000
d_prime: 1.423852
train_loss: 0.966781
valid_loss: 1.465682
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0020428933214651722
Epoch-30 lr: 0.0040857866429303445
epoch 30 training time: 15.056
---------------
2023-09-24 11:07:04.514385
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00666	Per Sample Data Time 0.00113	Per Sample DNN Time 0.00553	Train Loss 0.9653	
start validation
acc: 0.690141
AUC: 0.830184
Avg Precision: 0.403370
Avg Recall: 1.000000
d_prime: 1.350424
train_loss: 0.946196
valid_loss: 1.441212
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0018514295828041282
Epoch-31 lr: 0.0037028591656082565
epoch 31 training time: 15.089
---------------
2023-09-24 11:07:19.603341
current #epochs=32, #steps=1209
start validation
acc: 0.676056
AUC: 0.850329
Avg Precision: 0.406107
Avg Recall: 1.000000
d_prime: 1.467738
train_loss: 0.954025
valid_loss: 1.444874
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0018514295828041282
Epoch-32 lr: 0.0037028591656082565
epoch 32 training time: 15.065
---------------
2023-09-24 11:07:34.667908
current #epochs=33, #steps=1248
start validation
acc: 0.619718
AUC: 0.780764
Avg Precision: 0.306862
Avg Recall: 1.000000
d_prime: 1.095699
train_loss: 0.969959
valid_loss: 1.510520
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0018514295828041282
Epoch-33 lr: 0.0037028591656082565
epoch 33 training time: 15.090
---------------
2023-09-24 11:07:49.757466
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00787	Per Sample Data Time 0.00230	Per Sample DNN Time 0.00557	Train Loss 1.1862	
start validation
acc: 0.596244
AUC: 0.779453
Avg Precision: 0.275169
Avg Recall: 1.000000
d_prime: 1.089433
train_loss: 1.198918
valid_loss: 1.530423
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0016779101796778311
Epoch-34 lr: 0.0033558203593556622
epoch 34 training time: 15.154
---------------
2023-09-24 11:08:04.911468
current #epochs=35, #steps=1326
start validation
acc: 0.647887
AUC: 0.812850
Avg Precision: 0.225564
Avg Recall: 1.000000
d_prime: 1.256457
train_loss: 1.138599
valid_loss: 1.523749
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0016779101796778311
Epoch-35 lr: 0.0033558203593556622
epoch 35 training time: 14.965
---------------
2023-09-24 11:08:19.876583
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00655	Per Sample Data Time 0.00096	Per Sample DNN Time 0.00559	Train Loss 1.0399	
start validation
acc: 0.685446
AUC: 0.816614
Avg Precision: 0.340820
Avg Recall: 1.000000
d_prime: 1.276377
train_loss: 1.037191
valid_loss: 1.474006
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0016779101796778311
Epoch-36 lr: 0.0033558203593556622
epoch 36 training time: 15.100
---------------
2023-09-24 11:08:34.976526
current #epochs=37, #steps=1404
start validation
acc: 0.638498
AUC: 0.820382
Avg Precision: 0.330657
Avg Recall: 1.000000
d_prime: 1.296582
train_loss: 1.012085
valid_loss: 1.479891
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0015206533357873565
Epoch-37 lr: 0.003041306671574713
epoch 37 training time: 15.284
---------------
2023-09-24 11:08:50.260933
current #epochs=38, #steps=1443
start validation
acc: 0.638498
AUC: 0.820759
Avg Precision: 0.287284
Avg Recall: 1.000000
d_prime: 1.298619
train_loss: 0.978547
valid_loss: 1.477689
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0015206533357873565
Epoch-38 lr: 0.003041306671574713
epoch 38 training time: 16.007
---------------
2023-09-24 11:09:06.268181
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00731	Per Sample Data Time 0.00179	Per Sample DNN Time 0.00552	Train Loss 0.9355	
start validation
acc: 0.633803
AUC: 0.817770
Avg Precision: 0.355763
Avg Recall: 1.000000
d_prime: 1.282549
train_loss: 0.964939
valid_loss: 1.475804
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0015206533357873565
Epoch-39 lr: 0.003041306671574713
epoch 39 training time: 15.201
---------------
2023-09-24 11:09:21.468762
current #epochs=40, #steps=1521
start validation
acc: 0.671362
AUC: 0.817999
Avg Precision: 0.372150
Avg Recall: 1.000000
d_prime: 1.283776
train_loss: 0.941076
valid_loss: 1.468474
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0013781348940175135
Epoch-40 lr: 0.002756269788035027
epoch 40 training time: 15.134
---------------
2023-09-24 11:09:36.602481
current #epochs=41, #steps=1560
start validation
acc: 0.685446
AUC: 0.835165
Avg Precision: 0.388685
Avg Recall: 1.000000
d_prime: 1.378547
train_loss: 0.936421
valid_loss: 1.462198
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.0013781348940175135
Epoch-41 lr: 0.002756269788035027
epoch 41 training time: 15.911
---------------
2023-09-24 11:09:52.513431
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02166	Per Sample Data Time 0.01511	Per Sample DNN Time 0.00655	Train Loss 0.8490	
start validation
acc: 0.676056
AUC: 0.830469
Avg Precision: 0.370687
Avg Recall: 1.000000
d_prime: 1.352015
train_loss: 0.934869
valid_loss: 1.455510
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.0013781348940175135
Epoch-42 lr: 0.002756269788035027
epoch 42 training time: 15.083
---------------
2023-09-24 11:10:07.597002
current #epochs=43, #steps=1638
start validation
acc: 0.704225
AUC: 0.836558
Avg Precision: 0.391694
Avg Recall: 1.000000
d_prime: 1.386506
train_loss: 0.918365
valid_loss: 1.448160
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.001248973544075564
Epoch-43 lr: 0.002497947088151128
epoch 43 training time: 15.116
---------------
2023-09-24 11:10:22.712368
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00701	Per Sample Data Time 0.00136	Per Sample DNN Time 0.00565	Train Loss 0.8999	
start validation
[I 2023-09-24 11:10:37,745] Trial 5 finished with value: 0.3728198970676548 and parameters: {'warmup': 'True', 'num_epochs': 44, 'batch_size': 16, 'lr-adaptschedule': 'True', 'lr': 0.004489041370214458, 'head-lr': 2, 'lr-scheduler-start': 7, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.9062781513604805}. Best is trial 5 with value: 0.3728198970676548.
acc: 0.647887
AUC: 0.834851
Avg Precision: 0.372820
Avg Recall: 1.000000
d_prime: 1.376757
train_loss: 0.895246
valid_loss: 1.448341
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.001248973544075564
Epoch-44 lr: 0.002497947088151128
epoch 44 training time: 15.028
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f55bac0>
The learning rate scheduler starts at 7 epoch with decay rate of 0.786 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 11:10:37.751781
current #epochs=1, #steps=0
start validation
acc: 0.629108
AUC: 0.808249
Avg Precision: 0.325524
Avg Recall: 1.000000
d_prime: 1.232433
train_loss: 0.997136
valid_loss: 1.488626
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0027288439144708488
Epoch-1 lr: 0.0027288439144708488
epoch 1 training time: 17.521
---------------
2023-09-24 11:10:55.272635
current #epochs=2, #steps=39
start validation
acc: 0.638498
AUC: 0.834810
Avg Precision: 0.387495
Avg Recall: 1.000000
d_prime: 1.376525
train_loss: 0.976831
valid_loss: 1.455308
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0027288439144708488
Epoch-2 lr: 0.0027288439144708488
epoch 2 training time: 17.640
---------------
2023-09-24 11:11:12.912987
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00558	Train Loss 0.9318	
start validation
acc: 0.647887
AUC: 0.806808
Avg Precision: 0.398640
Avg Recall: 1.000000
d_prime: 1.224981
train_loss: 0.920386
valid_loss: 1.460422
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0027288439144708488
Epoch-3 lr: 0.0027288439144708488
epoch 3 training time: 17.520
---------------
2023-09-24 11:11:30.432736
current #epochs=4, #steps=117
start validation
acc: 0.690141
AUC: 0.841793
Avg Precision: 0.402516
Avg Recall: 1.000000
d_prime: 1.416839
train_loss: 0.928663
valid_loss: 1.441373
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0027288439144708488
Epoch-4 lr: 0.0027288439144708488
epoch 4 training time: 17.440
---------------
2023-09-24 11:11:47.872755
current #epochs=5, #steps=156
start validation
acc: 0.619718
AUC: 0.829761
Avg Precision: 0.400949
Avg Recall: 1.000000
d_prime: 1.348058
train_loss: 0.886459
valid_loss: 1.440951
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0027288439144708488
Epoch-5 lr: 0.0027288439144708488
epoch 5 training time: 15.202
---------------
2023-09-24 11:12:03.074909
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01119	Per Sample Data Time 0.00529	Per Sample DNN Time 0.00591	Train Loss 0.8009	
start validation
acc: 0.676056
AUC: 0.822596
Avg Precision: 0.399610
Avg Recall: 1.000000
d_prime: 1.308579
train_loss: 0.858977
valid_loss: 1.453870
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0027288439144708488
Epoch-6 lr: 0.0027288439144708488
epoch 6 training time: 15.082
---------------
2023-09-24 11:12:18.157280
current #epochs=7, #steps=234
start validation
acc: 0.638498
AUC: 0.819193
Avg Precision: 0.362976
Avg Recall: 1.000000
d_prime: 1.290176
train_loss: 0.904280
valid_loss: 1.450205
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002144214020355384
Epoch-7 lr: 0.002144214020355384
epoch 7 training time: 15.017
---------------
2023-09-24 11:12:33.173862
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00679	Per Sample Data Time 0.00122	Per Sample DNN Time 0.00557	Train Loss 0.9555	
start validation
acc: 0.666667
AUC: 0.822646
Avg Precision: 0.378715
Avg Recall: 1.000000
d_prime: 1.308848
train_loss: 0.941724
valid_loss: 1.452959
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.002144214020355384
Epoch-8 lr: 0.002144214020355384
epoch 8 training time: 15.070
---------------
2023-09-24 11:12:48.243927
current #epochs=9, #steps=312
start validation
acc: 0.638498
AUC: 0.833856
Avg Precision: 0.389539
Avg Recall: 1.000000
d_prime: 1.371100
train_loss: 0.906520
valid_loss: 1.442832
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.002144214020355384
Epoch-9 lr: 0.002144214020355384
epoch 9 training time: 15.130
---------------
2023-09-24 11:13:03.374578
current #epochs=10, #steps=351
start validation
acc: 0.666667
AUC: 0.847738
Avg Precision: 0.401185
Avg Recall: 1.000000
d_prime: 1.452089
train_loss: 0.843540
valid_loss: 1.428634
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.002144214020355384
Epoch-10 lr: 0.002144214020355384
epoch 10 training time: 15.088
---------------
2023-09-24 11:13:18.462441
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00850	Per Sample Data Time 0.00283	Per Sample DNN Time 0.00567	Train Loss 0.8251	
start validation
acc: 0.671362
AUC: 0.835131
Avg Precision: 0.395669
Avg Recall: 1.000000
d_prime: 1.378351
train_loss: 0.869421
valid_loss: 1.442075
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0016848357433371676
Epoch-11 lr: 0.0016848357433371676
epoch 11 training time: 15.092
---------------
2023-09-24 11:13:33.554566
current #epochs=12, #steps=429
start validation
acc: 0.633803
AUC: 0.836455
Avg Precision: 0.389720
Avg Recall: 1.000000
d_prime: 1.385916
train_loss: 0.861608
valid_loss: 1.441256
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0016848357433371676
Epoch-12 lr: 0.0016848357433371676
epoch 12 training time: 15.121
---------------
2023-09-24 11:13:48.675825
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00657	Per Sample Data Time 0.00107	Per Sample DNN Time 0.00550	Train Loss 0.8125	
start validation
acc: 0.647887
AUC: 0.840798
Avg Precision: 0.376934
Avg Recall: 1.000000
d_prime: 1.411024
train_loss: 0.796833
valid_loss: 1.432570
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0016848357433371676
Epoch-13 lr: 0.0016848357433371676
epoch 13 training time: 14.975
---------------
2023-09-24 11:14:03.650615
current #epochs=14, #steps=507
start validation
acc: 0.568075
AUC: 0.837278
Avg Precision: 0.404105
Avg Recall: 1.000000
d_prime: 1.390642
train_loss: 0.787546
valid_loss: 1.446978
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0016848357433371676
Epoch-14 lr: 0.0016848357433371676
epoch 14 training time: 15.077
---------------
2023-09-24 11:14:18.727141
current #epochs=15, #steps=546
start validation
acc: 0.671362
AUC: 0.851959
Avg Precision: 0.378007
Avg Recall: 1.000000
d_prime: 1.477675
train_loss: 0.832141
valid_loss: 1.440855
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0013238750680102456
Epoch-15 lr: 0.0013238750680102456
epoch 15 training time: 15.081
---------------
2023-09-24 11:14:33.808432
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00761	Per Sample Data Time 0.00201	Per Sample DNN Time 0.00560	Train Loss 0.7857	
start validation
acc: 0.657277
AUC: 0.848774
Avg Precision: 0.375495
Avg Recall: 1.000000
d_prime: 1.458320
train_loss: 0.793977
valid_loss: 1.445016
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0013238750680102456
Epoch-16 lr: 0.0013238750680102456
epoch 16 training time: 15.117
---------------
2023-09-24 11:14:48.925749
current #epochs=17, #steps=624
start validation
acc: 0.680751
AUC: 0.854174
Avg Precision: 0.388839
Avg Recall: 1.000000
d_prime: 1.491293
train_loss: 0.791996
valid_loss: 1.430415
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0013238750680102456
Epoch-17 lr: 0.0013238750680102456
epoch 17 training time: 15.794
---------------
2023-09-24 11:15:04.720087
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00647	Per Sample Data Time 0.00094	Per Sample DNN Time 0.00554	Train Loss 0.7702	
start validation
acc: 0.652582
AUC: 0.849596
Avg Precision: 0.402021
Avg Recall: 1.000000
d_prime: 1.463289
train_loss: 0.768066
valid_loss: 1.442245
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0013238750680102456
Epoch-18 lr: 0.0013238750680102456
epoch 18 training time: 15.110
---------------
2023-09-24 11:15:19.830195
current #epochs=19, #steps=702
start validation
acc: 0.661972
AUC: 0.865377
Avg Precision: 0.402362
Avg Recall: 1.000000
d_prime: 1.562425
train_loss: 0.743007
valid_loss: 1.432175
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.001040246921772715
Epoch-19 lr: 0.001040246921772715
epoch 19 training time: 14.967
---------------
2023-09-24 11:15:34.796788
current #epochs=20, #steps=741
start validation
acc: 0.666667
AUC: 0.856032
Avg Precision: 0.417124
Avg Recall: 1.000000
d_prime: 1.502831
train_loss: 0.750783
valid_loss: 1.437413
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.001040246921772715
Epoch-20 lr: 0.001040246921772715
epoch 20 training time: 15.101
---------------
2023-09-24 11:15:49.897678
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00163	Per Sample DNN Time 0.00558	Train Loss 0.7565	
start validation
acc: 0.680751
AUC: 0.848982
Avg Precision: 0.427275
Avg Recall: 1.000000
d_prime: 1.459580
train_loss: 0.763838
valid_loss: 1.438440
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.001040246921772715
Epoch-21 lr: 0.001040246921772715
epoch 21 training time: 15.199
---------------
2023-09-24 11:16:05.096390
current #epochs=22, #steps=819
start validation
acc: 0.666667
AUC: 0.852905
Avg Precision: 0.425270
Avg Recall: 1.000000
d_prime: 1.483473
train_loss: 0.749582
valid_loss: 1.436619
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.001040246921772715
Epoch-22 lr: 0.001040246921772715
epoch 22 training time: 15.032
---------------
2023-09-24 11:16:20.128708
current #epochs=23, #steps=858
start validation
acc: 0.666667
AUC: 0.858586
Avg Precision: 0.408389
Avg Recall: 1.000000
d_prime: 1.518849
train_loss: 0.724578
valid_loss: 1.428046
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0008173835163192561
Epoch-23 lr: 0.0008173835163192561
epoch 23 training time: 15.161
---------------
2023-09-24 11:16:35.289687
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01429	Per Sample Data Time 0.00827	Per Sample DNN Time 0.00602	Train Loss 0.7037	
start validation
acc: 0.661972
AUC: 0.855241
Avg Precision: 0.414811
Avg Recall: 1.000000
d_prime: 1.497906
train_loss: 0.730108
valid_loss: 1.440411
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0008173835163192561
Epoch-24 lr: 0.0008173835163192561
epoch 24 training time: 15.135
---------------
2023-09-24 11:16:50.425032
current #epochs=25, #steps=936
start validation
acc: 0.657277
AUC: 0.850398
Avg Precision: 0.405346
Avg Recall: 1.000000
d_prime: 1.468155
train_loss: 0.696589
valid_loss: 1.436729
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0008173835163192561
Epoch-25 lr: 0.0008173835163192561
epoch 25 training time: 14.943
---------------
2023-09-24 11:17:05.368093
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00688	Per Sample Data Time 0.00131	Per Sample DNN Time 0.00558	Train Loss 0.7048	
start validation
acc: 0.671362
AUC: 0.867108
Avg Precision: 0.407132
Avg Recall: 1.000000
d_prime: 1.573771
train_loss: 0.710691
valid_loss: 1.437553
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0008173835163192561
Epoch-26 lr: 0.0008173835163192561
epoch 26 training time: 15.078
---------------
2023-09-24 11:17:20.446568
current #epochs=27, #steps=1014
start validation
acc: 0.633803
AUC: 0.845805
Avg Precision: 0.392043
Avg Recall: 1.000000
d_prime: 1.440526
train_loss: 0.709313
valid_loss: 1.442806
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0006422665607237521
Epoch-27 lr: 0.0006422665607237521
epoch 27 training time: 15.150
---------------
2023-09-24 11:17:35.596826
current #epochs=28, #steps=1053
start validation
acc: 0.666667
AUC: 0.860843
Avg Precision: 0.409637
Avg Recall: 1.000000
d_prime: 1.533170
train_loss: 0.698424
valid_loss: 1.421461
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0006422665607237521
Epoch-28 lr: 0.0006422665607237521
epoch 28 training time: 14.984
---------------
2023-09-24 11:17:50.580471
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00937	Per Sample Data Time 0.00349	Per Sample DNN Time 0.00588	Train Loss 0.6445	
start validation
acc: 0.647887
AUC: 0.846691
Avg Precision: 0.406741
Avg Recall: 1.000000
d_prime: 1.445815
train_loss: 0.709856
valid_loss: 1.444943
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0006422665607237521
Epoch-29 lr: 0.0006422665607237521
epoch 29 training time: 15.197
---------------
2023-09-24 11:18:05.777865
current #epochs=30, #steps=1131
start validation
acc: 0.671362
AUC: 0.851447
Avg Precision: 0.410257
Avg Recall: 1.000000
d_prime: 1.474544
train_loss: 0.688082
valid_loss: 1.433175
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0006422665607237521
Epoch-30 lr: 0.0006422665607237521
epoch 30 training time: 15.194
---------------
2023-09-24 11:18:20.971430
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00663	Per Sample Data Time 0.00110	Per Sample DNN Time 0.00552	Train Loss 0.6949	
start validation
acc: 0.666667
AUC: 0.859861
Avg Precision: 0.389746
Avg Recall: 1.000000
d_prime: 1.526917
train_loss: 0.700332
valid_loss: 1.430027
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0005046668140329848
Epoch-31 lr: 0.0005046668140329848
epoch 31 training time: 15.191
---------------
2023-09-24 11:18:36.162300
current #epochs=32, #steps=1209
start validation
acc: 0.676056
AUC: 0.846896
Avg Precision: 0.384787
Avg Recall: 1.000000
d_prime: 1.447037
train_loss: 0.703180
valid_loss: 1.438370
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0005046668140329848
Epoch-32 lr: 0.0005046668140329848
epoch 32 training time: 15.050
---------------
2023-09-24 11:18:51.212377
current #epochs=33, #steps=1248
start validation
acc: 0.704225
AUC: 0.853092
Avg Precision: 0.382539
Avg Recall: 1.000000
d_prime: 1.484621
train_loss: 0.681292
valid_loss: 1.422485
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0005046668140329848
Epoch-33 lr: 0.0005046668140329848
epoch 33 training time: 19.039
---------------
2023-09-24 11:19:10.251612
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00795	Per Sample Data Time 0.00228	Per Sample DNN Time 0.00566	Train Loss 0.6994	
start validation
acc: 0.671362
AUC: 0.855934
Avg Precision: 0.410070
Avg Recall: 1.000000
d_prime: 1.502217
train_loss: 0.681835
valid_loss: 1.427373
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0005046668140329848
Epoch-34 lr: 0.0005046668140329848
epoch 34 training time: 15.139
---------------
2023-09-24 11:19:25.390887
current #epochs=35, #steps=1326
start validation
acc: 0.671362
AUC: 0.864114
Avg Precision: 0.398037
Avg Recall: 1.000000
d_prime: 1.554205
train_loss: 0.670691
valid_loss: 1.425917
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.00039654655677418704
Epoch-35 lr: 0.00039654655677418704
epoch 35 training time: 15.173
---------------
2023-09-24 11:19:40.563588
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00647	Per Sample Data Time 0.00096	Per Sample DNN Time 0.00551	Train Loss 0.7032	
start validation
acc: 0.708920
AUC: 0.865069
Avg Precision: 0.402082
Avg Recall: 1.000000
d_prime: 1.560414
train_loss: 0.698930
valid_loss: 1.428170
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.00039654655677418704
Epoch-36 lr: 0.00039654655677418704
epoch 36 training time: 18.129
---------------
2023-09-24 11:19:58.693129
current #epochs=37, #steps=1404
start validation
acc: 0.718310
AUC: 0.864156
Avg Precision: 0.416776
Avg Recall: 1.000000
d_prime: 1.554479
train_loss: 0.690076
valid_loss: 1.423465
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.00039654655677418704
Epoch-37 lr: 0.00039654655677418704
epoch 37 training time: 17.567
---------------
2023-09-24 11:20:16.259990
current #epochs=38, #steps=1443
start validation
acc: 0.699531
AUC: 0.869575
Avg Precision: 0.412175
Avg Recall: 1.000000
d_prime: 1.590118
train_loss: 0.672836
valid_loss: 1.420800
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.00039654655677418704
Epoch-38 lr: 0.00039654655677418704
epoch 38 training time: 15.022
---------------
2023-09-24 11:20:31.282459
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00744	Per Sample Data Time 0.00185	Per Sample DNN Time 0.00559	Train Loss 0.6959	
start validation
acc: 0.699531
AUC: 0.869822
Avg Precision: 0.426556
Avg Recall: 1.000000
d_prime: 1.591766
train_loss: 0.684509
valid_loss: 1.419671
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.00031159007748662035
Epoch-39 lr: 0.00031159007748662035
epoch 39 training time: 15.137
---------------
2023-09-24 11:20:46.418984
current #epochs=40, #steps=1521
start validation
acc: 0.671362
AUC: 0.865768
Avg Precision: 0.410061
Avg Recall: 1.000000
d_prime: 1.564979
train_loss: 0.655585
valid_loss: 1.420795
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.00031159007748662035
Epoch-40 lr: 0.00031159007748662035
epoch 40 training time: 15.081
---------------
2023-09-24 11:21:01.499949
current #epochs=41, #steps=1560
start validation
acc: 0.671362
AUC: 0.864909
Avg Precision: 0.387039
Avg Recall: 1.000000
d_prime: 1.559371
train_loss: 0.637548
valid_loss: 1.422966
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.00031159007748662035
Epoch-41 lr: 0.00031159007748662035
epoch 41 training time: 15.064
---------------
2023-09-24 11:21:16.563684
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02121	Per Sample Data Time 0.01494	Per Sample DNN Time 0.00627	Train Loss 0.5471	
start validation
acc: 0.680751
AUC: 0.864074
Avg Precision: 0.387044
Avg Recall: 1.000000
d_prime: 1.553949
train_loss: 0.704818
valid_loss: 1.432712
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.00031159007748662035
Epoch-42 lr: 0.00031159007748662035
epoch 42 training time: 16.341
---------------
2023-09-24 11:21:32.904134
current #epochs=43, #steps=1638
start validation
acc: 0.671362
AUC: 0.856267
Avg Precision: 0.400373
Avg Recall: 1.000000
d_prime: 1.504294
train_loss: 0.681847
valid_loss: 1.436002
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.0002448347482270661
Epoch-43 lr: 0.0002448347482270661
epoch 43 training time: 15.265
---------------
2023-09-24 11:21:48.169575
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00689	Per Sample Data Time 0.00138	Per Sample DNN Time 0.00551	Train Loss 0.6726	
start validation
acc: 0.680751
AUC: 0.858154
Avg Precision: 0.403300
Avg Recall: 1.000000
d_prime: 1.516128
train_loss: 0.666471
valid_loss: 1.429762
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.0002448347482270661
Epoch-44 lr: 0.0002448347482270661
epoch 44 training time: 16.339
---------------
2023-09-24 11:22:04.508818
current #epochs=45, #steps=1716
start validation
acc: 0.680751
AUC: 0.862628
Avg Precision: 0.409850
Avg Recall: 1.000000
d_prime: 1.544608
train_loss: 0.637289
valid_loss: 1.423387
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.0002448347482270661
Epoch-45 lr: 0.0002448347482270661
epoch 45 training time: 15.108
---------------
2023-09-24 11:22:19.616191
current #epochs=46, #steps=1755
start validation
[I 2023-09-24 11:22:34,698] Trial 6 finished with value: 0.4134264498245008 and parameters: {'warmup': 'False', 'num_epochs': 46, 'batch_size': 21, 'lr-adaptschedule': 'False', 'lr': 0.0027288439144708488, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.785759130078779}. Best is trial 6 with value: 0.4134264498245008.
acc: 0.718310
AUC: 0.865633
Avg Precision: 0.413426
Avg Recall: 1.000000
d_prime: 1.564094
train_loss: 0.643671
valid_loss: 1.419721
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.0002448347482270661
Epoch-46 lr: 0.0002448347482270661
epoch 46 training time: 15.077
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f4ddf70>
The learning rate scheduler starts at 3 epoch with decay rate of 0.904 every 7 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 11:22:34.704706
current #epochs=1, #steps=0
start validation
acc: 0.690141
AUC: 0.859360
Avg Precision: 0.414153
Avg Recall: 1.000000
d_prime: 1.523740
train_loss: 0.636528
valid_loss: 1.425343
validation finished
normal learning rate scheduler step
Epoch-1 lr: 9.007571663004883e-05
Epoch-1 lr: 0.00045037858315024416
epoch 1 training time: 17.419
---------------
2023-09-24 11:22:52.123862
current #epochs=2, #steps=39
start validation
acc: 0.690141
AUC: 0.863836
Avg Precision: 0.410649
Avg Recall: 1.000000
d_prime: 1.552405
train_loss: 0.652751
valid_loss: 1.422578
validation finished
normal learning rate scheduler step
Epoch-2 lr: 9.007571663004883e-05
Epoch-2 lr: 0.00045037858315024416
epoch 2 training time: 15.288
---------------
2023-09-24 11:23:07.411585
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00552	Train Loss 0.6335	
start validation
acc: 0.690141
AUC: 0.866162
Avg Precision: 0.407100
Avg Recall: 1.000000
d_prime: 1.567556
train_loss: 0.639505
valid_loss: 1.420370
validation finished
normal learning rate scheduler step
Epoch-3 lr: 8.140431537806181e-05
Epoch-3 lr: 0.000407021576890309
epoch 3 training time: 15.156
---------------
2023-09-24 11:23:22.567374
current #epochs=4, #steps=117
start validation
acc: 0.694836
AUC: 0.865255
Avg Precision: 0.403427
Avg Recall: 1.000000
d_prime: 1.561629
train_loss: 0.616415
valid_loss: 1.424264
validation finished
normal learning rate scheduler step
Epoch-4 lr: 8.140431537806181e-05
Epoch-4 lr: 0.000407021576890309
epoch 4 training time: 17.406
---------------
2023-09-24 11:23:39.973316
current #epochs=5, #steps=156
start validation
acc: 0.690141
AUC: 0.865532
Avg Precision: 0.406711
Avg Recall: 1.000000
d_prime: 1.563433
train_loss: 0.624305
valid_loss: 1.422148
validation finished
normal learning rate scheduler step
Epoch-5 lr: 8.140431537806181e-05
Epoch-5 lr: 0.000407021576890309
epoch 5 training time: 15.796
---------------
2023-09-24 11:23:55.769160
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01105	Per Sample Data Time 0.00515	Per Sample DNN Time 0.00590	Train Loss 0.7050	
start validation
acc: 0.708920
AUC: 0.864098
Avg Precision: 0.405388
Avg Recall: 1.000000
d_prime: 1.554106
train_loss: 0.627149
valid_loss: 1.422858
validation finished
normal learning rate scheduler step
Epoch-6 lr: 8.140431537806181e-05
Epoch-6 lr: 0.000407021576890309
epoch 6 training time: 19.072
---------------
2023-09-24 11:24:14.841505
current #epochs=7, #steps=234
start validation
acc: 0.685446
AUC: 0.866085
Avg Precision: 0.413785
Avg Recall: 1.000000
d_prime: 1.567055
train_loss: 0.633418
valid_loss: 1.420961
validation finished
normal learning rate scheduler step
Epoch-7 lr: 8.140431537806181e-05
Epoch-7 lr: 0.000407021576890309
epoch 7 training time: 15.118
---------------
2023-09-24 11:24:29.959829
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00678	Per Sample Data Time 0.00125	Per Sample DNN Time 0.00553	Train Loss 0.6245	
start validation
acc: 0.690141
AUC: 0.865804
Avg Precision: 0.406862
Avg Recall: 1.000000
d_prime: 1.565213
train_loss: 0.624173
valid_loss: 1.422654
validation finished
normal learning rate scheduler step
Epoch-8 lr: 8.140431537806181e-05
Epoch-8 lr: 0.000407021576890309
epoch 8 training time: 16.258
---------------
2023-09-24 11:24:46.217763
current #epochs=9, #steps=312
start validation
acc: 0.685446
AUC: 0.863370
Avg Precision: 0.413161
Avg Recall: 1.000000
d_prime: 1.549390
train_loss: 0.626692
valid_loss: 1.422804
validation finished
normal learning rate scheduler step
Epoch-9 lr: 8.140431537806181e-05
Epoch-9 lr: 0.000407021576890309
epoch 9 training time: 15.114
---------------
2023-09-24 11:25:01.331735
current #epochs=10, #steps=351
start validation
acc: 0.690141
AUC: 0.865541
Avg Precision: 0.410288
Avg Recall: 1.000000
d_prime: 1.563496
train_loss: 0.628618
valid_loss: 1.421586
validation finished
normal learning rate scheduler step
Epoch-10 lr: 7.356769182739233e-05
Epoch-10 lr: 0.0003678384591369615
epoch 10 training time: 15.841
---------------
2023-09-24 11:25:17.172611
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00858	Per Sample Data Time 0.00287	Per Sample DNN Time 0.00570	Train Loss 0.6457	
start validation
acc: 0.680751
AUC: 0.863053
Avg Precision: 0.412884
Avg Recall: 1.000000
d_prime: 1.547345
train_loss: 0.633339
valid_loss: 1.425038
validation finished
normal learning rate scheduler step
Epoch-11 lr: 7.356769182739233e-05
Epoch-11 lr: 0.0003678384591369615
epoch 11 training time: 15.497
---------------
2023-09-24 11:25:32.670050
current #epochs=12, #steps=429
start validation
acc: 0.713615
AUC: 0.868592
Avg Precision: 0.410434
Avg Recall: 1.000000
d_prime: 1.583578
train_loss: 0.628776
valid_loss: 1.419886
validation finished
normal learning rate scheduler step
Epoch-12 lr: 7.356769182739233e-05
Epoch-12 lr: 0.0003678384591369615
epoch 12 training time: 17.491
---------------
2023-09-24 11:25:50.160801
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00660	Per Sample Data Time 0.00105	Per Sample DNN Time 0.00555	Train Loss 0.6171	
start validation
acc: 0.699531
AUC: 0.865718
Avg Precision: 0.405995
Avg Recall: 1.000000
d_prime: 1.564652
train_loss: 0.626009
valid_loss: 1.423815
validation finished
normal learning rate scheduler step
Epoch-13 lr: 7.356769182739233e-05
Epoch-13 lr: 0.0003678384591369615
epoch 13 training time: 15.096
---------------
2023-09-24 11:26:05.256811
current #epochs=14, #steps=507
start validation
acc: 0.694836
AUC: 0.866113
Avg Precision: 0.407070
Avg Recall: 1.000000
d_prime: 1.567234
train_loss: 0.602003
valid_loss: 1.421237
validation finished
normal learning rate scheduler step
Epoch-14 lr: 7.356769182739233e-05
Epoch-14 lr: 0.0003678384591369615
epoch 14 training time: 15.689
---------------
2023-09-24 11:26:20.945922
current #epochs=15, #steps=546
start validation
acc: 0.690141
AUC: 0.864782
Avg Precision: 0.406304
Avg Recall: 1.000000
d_prime: 1.558546
train_loss: 0.598225
valid_loss: 1.422190
validation finished
normal learning rate scheduler step
Epoch-15 lr: 7.356769182739233e-05
Epoch-15 lr: 0.0003678384591369615
epoch 15 training time: 15.049
---------------
2023-09-24 11:26:35.994935
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00773	Per Sample Data Time 0.00207	Per Sample DNN Time 0.00566	Train Loss 0.6237	
start validation
acc: 0.704225
AUC: 0.864705
Avg Precision: 0.413368
Avg Recall: 1.000000
d_prime: 1.558043
train_loss: 0.620104
valid_loss: 1.421898
validation finished
normal learning rate scheduler step
Epoch-16 lr: 7.356769182739233e-05
Epoch-16 lr: 0.0003678384591369615
epoch 16 training time: 15.281
---------------
2023-09-24 11:26:51.275441
current #epochs=17, #steps=624
start validation
acc: 0.713615
AUC: 0.867920
Avg Precision: 0.412979
Avg Recall: 1.000000
d_prime: 1.579127
train_loss: 0.610638
valid_loss: 1.420122
validation finished
normal learning rate scheduler step
Epoch-17 lr: 6.648548367091529e-05
Epoch-17 lr: 0.00033242741835457634
epoch 17 training time: 15.054
---------------
2023-09-24 11:27:06.329282
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00644	Per Sample Data Time 0.00093	Per Sample DNN Time 0.00551	Train Loss 0.6178	
start validation
acc: 0.699531
AUC: 0.865826
Avg Precision: 0.406405
Avg Recall: 1.000000
d_prime: 1.565355
train_loss: 0.617342
valid_loss: 1.422577
validation finished
normal learning rate scheduler step
Epoch-18 lr: 6.648548367091529e-05
Epoch-18 lr: 0.00033242741835457634
epoch 18 training time: 15.075
---------------
2023-09-24 11:27:21.404419
current #epochs=19, #steps=702
start validation
acc: 0.694836
AUC: 0.864438
Avg Precision: 0.403000
Avg Recall: 1.000000
d_prime: 1.556309
train_loss: 0.634189
valid_loss: 1.423751
validation finished
normal learning rate scheduler step
Epoch-19 lr: 6.648548367091529e-05
Epoch-19 lr: 0.00033242741835457634
epoch 19 training time: 14.995
---------------
2023-09-24 11:27:36.399875
current #epochs=20, #steps=741
start validation
acc: 0.694836
AUC: 0.866907
Avg Precision: 0.409938
Avg Recall: 1.000000
d_prime: 1.572450
train_loss: 0.607757
valid_loss: 1.422109
validation finished
normal learning rate scheduler step
Epoch-20 lr: 6.648548367091529e-05
Epoch-20 lr: 0.00033242741835457634
epoch 20 training time: 15.086
---------------
2023-09-24 11:27:51.486243
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00724	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00565	Train Loss 0.5861	
start validation
acc: 0.690141
AUC: 0.866699
Avg Precision: 0.409425
Avg Recall: 1.000000
d_prime: 1.571078
train_loss: 0.591021
valid_loss: 1.423167
validation finished
normal learning rate scheduler step
Epoch-21 lr: 6.648548367091529e-05
Epoch-21 lr: 0.00033242741835457634
epoch 21 training time: 15.047
---------------
2023-09-24 11:28:06.533187
current #epochs=22, #steps=819
start validation
acc: 0.690141
AUC: 0.866823
Avg Precision: 0.403861
Avg Recall: 1.000000
d_prime: 1.571899
train_loss: 0.600742
valid_loss: 1.422304
validation finished
normal learning rate scheduler step
Epoch-22 lr: 6.648548367091529e-05
Epoch-22 lr: 0.00033242741835457634
epoch 22 training time: 15.202
---------------
2023-09-24 11:28:21.735436
current #epochs=23, #steps=858
start validation
acc: 0.713615
AUC: 0.867566
Avg Precision: 0.407321
Avg Recall: 1.000000
d_prime: 1.576788
train_loss: 0.630388
valid_loss: 1.421478
validation finished
normal learning rate scheduler step
Epoch-23 lr: 6.648548367091529e-05
Epoch-23 lr: 0.00033242741835457634
epoch 23 training time: 15.159
---------------
2023-09-24 11:28:36.894410
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01372	Per Sample Data Time 0.00773	Per Sample DNN Time 0.00599	Train Loss 0.6021	
start validation
acc: 0.713615
AUC: 0.867604
Avg Precision: 0.406401
Avg Recall: 1.000000
d_prime: 1.577038
train_loss: 0.611573
valid_loss: 1.421295
validation finished
normal learning rate scheduler step
Epoch-24 lr: 6.008506491309646e-05
Epoch-24 lr: 0.0003004253245654822
epoch 24 training time: 15.128
---------------
2023-09-24 11:28:52.021772
current #epochs=25, #steps=936
start validation
acc: 0.718310
AUC: 0.868021
Avg Precision: 0.406293
Avg Recall: 1.000000
d_prime: 1.579796
train_loss: 0.605230
valid_loss: 1.421353
validation finished
normal learning rate scheduler step
Epoch-25 lr: 6.008506491309646e-05
Epoch-25 lr: 0.0003004253245654822
epoch 25 training time: 17.722
---------------
2023-09-24 11:29:09.743721
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00686	Per Sample Data Time 0.00132	Per Sample DNN Time 0.00554	Train Loss 0.6029	
start validation
acc: 0.713615
AUC: 0.869147
Avg Precision: 0.406263
Avg Recall: 1.000000
d_prime: 1.587271
train_loss: 0.608855
valid_loss: 1.420895
validation finished
normal learning rate scheduler step
Epoch-26 lr: 6.008506491309646e-05
Epoch-26 lr: 0.0003004253245654822
epoch 26 training time: 15.161
---------------
2023-09-24 11:29:24.905159
current #epochs=27, #steps=1014
start validation
acc: 0.713615
AUC: 0.868299
Avg Precision: 0.406651
Avg Recall: 1.000000
d_prime: 1.581634
train_loss: 0.615395
valid_loss: 1.420390
validation finished
normal learning rate scheduler step
Epoch-27 lr: 6.008506491309646e-05
Epoch-27 lr: 0.0003004253245654822
epoch 27 training time: 16.178
---------------
2023-09-24 11:29:41.082937
current #epochs=28, #steps=1053
start validation
acc: 0.694836
AUC: 0.866700
Avg Precision: 0.409424
Avg Recall: 1.000000
d_prime: 1.571087
train_loss: 0.610288
valid_loss: 1.422122
validation finished
normal learning rate scheduler step
Epoch-28 lr: 6.008506491309646e-05
Epoch-28 lr: 0.0003004253245654822
epoch 28 training time: 15.295
---------------
2023-09-24 11:29:56.378063
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00942	Per Sample Data Time 0.00352	Per Sample DNN Time 0.00589	Train Loss 0.6426	
start validation
acc: 0.699531
AUC: 0.864786
Avg Precision: 0.406038
Avg Recall: 1.000000
d_prime: 1.558570
train_loss: 0.604061
valid_loss: 1.423457
validation finished
normal learning rate scheduler step
Epoch-29 lr: 6.008506491309646e-05
Epoch-29 lr: 0.0003004253245654822
epoch 29 training time: 15.135
---------------
2023-09-24 11:30:11.512841
current #epochs=30, #steps=1131
start validation
acc: 0.718310
AUC: 0.868304
Avg Precision: 0.406698
Avg Recall: 1.000000
d_prime: 1.581672
train_loss: 0.591923
valid_loss: 1.419888
validation finished
normal learning rate scheduler step
Epoch-30 lr: 6.008506491309646e-05
Epoch-30 lr: 0.0003004253245654822
epoch 30 training time: 16.508
---------------
2023-09-24 11:30:28.021103
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00666	Per Sample Data Time 0.00114	Per Sample DNN Time 0.00552	Train Loss 0.5948	
start validation
acc: 0.708920
AUC: 0.867342
Avg Precision: 0.406828
Avg Recall: 1.000000
d_prime: 1.575315
train_loss: 0.597503
valid_loss: 1.422151
validation finished
normal learning rate scheduler step
Epoch-31 lr: 5.430080111142124e-05
Epoch-31 lr: 0.0002715040055571061
epoch 31 training time: 15.089
---------------
2023-09-24 11:30:43.110636
current #epochs=32, #steps=1209
start validation
acc: 0.713615
AUC: 0.869389
Avg Precision: 0.407250
Avg Recall: 1.000000
d_prime: 1.588877
train_loss: 0.573277
valid_loss: 1.419694
validation finished
normal learning rate scheduler step
Epoch-32 lr: 5.430080111142124e-05
Epoch-32 lr: 0.0002715040055571061
epoch 32 training time: 15.862
---------------
2023-09-24 11:30:58.972886
current #epochs=33, #steps=1248
start validation
acc: 0.713615
AUC: 0.867706
Avg Precision: 0.407395
Avg Recall: 1.000000
d_prime: 1.577718
train_loss: 0.614958
valid_loss: 1.421149
validation finished
normal learning rate scheduler step
Epoch-33 lr: 5.430080111142124e-05
Epoch-33 lr: 0.0002715040055571061
epoch 33 training time: 15.216
---------------
2023-09-24 11:31:14.189412
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00794	Per Sample Data Time 0.00230	Per Sample DNN Time 0.00563	Train Loss 0.6112	
start validation
acc: 0.708920
AUC: 0.865984
Avg Precision: 0.406989
Avg Recall: 1.000000
d_prime: 1.566389
train_loss: 0.593000
valid_loss: 1.422300
validation finished
normal learning rate scheduler step
Epoch-34 lr: 5.430080111142124e-05
Epoch-34 lr: 0.0002715040055571061
epoch 34 training time: 17.135
---------------
2023-09-24 11:31:31.324559
current #epochs=35, #steps=1326
start validation
acc: 0.704225
AUC: 0.869399
Avg Precision: 0.407171
Avg Recall: 1.000000
d_prime: 1.588946
train_loss: 0.598429
valid_loss: 1.420764
validation finished
normal learning rate scheduler step
Epoch-35 lr: 5.430080111142124e-05
Epoch-35 lr: 0.0002715040055571061
epoch 35 training time: 15.055
---------------
2023-09-24 11:31:46.379302
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00645	Per Sample Data Time 0.00095	Per Sample DNN Time 0.00550	Train Loss 0.5785	
start validation
acc: 0.708920
AUC: 0.863927
Avg Precision: 0.406298
Avg Recall: 1.000000
d_prime: 1.552998
train_loss: 0.597104
valid_loss: 1.423619
validation finished
normal learning rate scheduler step
Epoch-36 lr: 5.430080111142124e-05
Epoch-36 lr: 0.0002715040055571061
epoch 36 training time: 15.000
---------------
2023-09-24 11:32:01.378925
current #epochs=37, #steps=1404
start validation
acc: 0.708920
AUC: 0.866679
Avg Precision: 0.409802
Avg Recall: 1.000000
d_prime: 1.570947
train_loss: 0.598881
valid_loss: 1.422914
validation finished
normal learning rate scheduler step
Epoch-37 lr: 5.430080111142124e-05
Epoch-37 lr: 0.0002715040055571061
epoch 37 training time: 17.355
---------------
2023-09-24 11:32:18.734373
current #epochs=38, #steps=1443
start validation
acc: 0.699531
AUC: 0.867544
Avg Precision: 0.406407
Avg Recall: 1.000000
d_prime: 1.576647
train_loss: 0.584420
valid_loss: 1.421476
validation finished
normal learning rate scheduler step
Epoch-38 lr: 4.9073376314176844e-05
Epoch-38 lr: 0.0002453668815708841
epoch 38 training time: 15.078
---------------
2023-09-24 11:32:33.812255
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00731	Per Sample Data Time 0.00168	Per Sample DNN Time 0.00563	Train Loss 0.6081	
start validation
acc: 0.694836
AUC: 0.866750
Avg Precision: 0.410160
Avg Recall: 1.000000
d_prime: 1.571419
train_loss: 0.586025
valid_loss: 1.419248
validation finished
normal learning rate scheduler step
Epoch-39 lr: 4.9073376314176844e-05
Epoch-39 lr: 0.0002453668815708841
epoch 39 training time: 15.211
---------------
2023-09-24 11:32:49.023063
current #epochs=40, #steps=1521
start validation
acc: 0.699531
AUC: 0.868593
Avg Precision: 0.409994
Avg Recall: 1.000000
d_prime: 1.583586
train_loss: 0.599121
valid_loss: 1.420158
validation finished
normal learning rate scheduler step
Epoch-40 lr: 4.9073376314176844e-05
Epoch-40 lr: 0.0002453668815708841
epoch 40 training time: 15.389
---------------
2023-09-24 11:33:04.411829
current #epochs=41, #steps=1560
start validation
acc: 0.699531
AUC: 0.867787
Avg Precision: 0.407066
Avg Recall: 1.000000
d_prime: 1.578247
train_loss: 0.583948
valid_loss: 1.421683
validation finished
normal learning rate scheduler step
Epoch-41 lr: 4.9073376314176844e-05
Epoch-41 lr: 0.0002453668815708841
epoch 41 training time: 15.056
---------------
2023-09-24 11:33:19.467428
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02133	Per Sample Data Time 0.01488	Per Sample DNN Time 0.00644	Train Loss 0.6414	
start validation
acc: 0.704225
AUC: 0.867137
Avg Precision: 0.407182
Avg Recall: 1.000000
d_prime: 1.573962
train_loss: 0.584396
valid_loss: 1.421157
validation finished
normal learning rate scheduler step
Epoch-42 lr: 4.9073376314176844e-05
Epoch-42 lr: 0.0002453668815708841
epoch 42 training time: 15.134
---------------
2023-09-24 11:33:34.601486
current #epochs=43, #steps=1638
start validation
acc: 0.699531
AUC: 0.869085
Avg Precision: 0.410675
Avg Recall: 1.000000
d_prime: 1.586853
train_loss: 0.587994
valid_loss: 1.420157
validation finished
normal learning rate scheduler step
Epoch-43 lr: 4.9073376314176844e-05
Epoch-43 lr: 0.0002453668815708841
epoch 43 training time: 17.029
---------------
2023-09-24 11:33:51.630541
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00561	Train Loss 0.5923	
start validation
[I 2023-09-24 11:34:06,762] Trial 7 finished with value: 0.4102242153810402 and parameters: {'warmup': 'False', 'num_epochs': 44, 'batch_size': 52, 'lr-adaptschedule': 'True', 'lr': 9.007571663004883e-05, 'head-lr': 5, 'lr-scheduler-start': 3, 'lr-scheduler-step': 7, 'lr-scheduler-decay': 0.9037320869996355}. Best is trial 6 with value: 0.4134264498245008.
acc: 0.694836
AUC: 0.868937
Avg Precision: 0.410224
Avg Recall: 1.000000
d_prime: 1.585873
train_loss: 0.612449
valid_loss: 1.420844
validation finished
normal learning rate scheduler step
Epoch-44 lr: 4.9073376314176844e-05
Epoch-44 lr: 0.0002453668815708841
epoch 44 training time: 15.128
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f5a1700>
The learning rate scheduler starts at 6 epoch with decay rate of 0.932 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 11:34:06.768531
current #epochs=1, #steps=0
start validation
acc: 0.671362
AUC: 0.833008
Avg Precision: 0.419572
Avg Recall: 1.000000
d_prime: 1.366298
train_loss: 0.887230
valid_loss: 1.456114
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0026249379664101285
Epoch-1 lr: 0.0026249379664101285
epoch 1 training time: 18.430
---------------
2023-09-24 11:34:25.198425
current #epochs=2, #steps=39
start validation
acc: 0.676056
AUC: 0.863063
Avg Precision: 0.386111
Avg Recall: 1.000000
d_prime: 1.547410
train_loss: 0.790473
valid_loss: 1.437515
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0026249379664101285
Epoch-2 lr: 0.0026249379664101285
epoch 2 training time: 17.659
---------------
2023-09-24 11:34:42.858091
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00696	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00550	Train Loss 0.7645	
start validation
acc: 0.690141
AUC: 0.862071
Avg Precision: 0.399595
Avg Recall: 1.000000
d_prime: 1.541025
train_loss: 0.762676
valid_loss: 1.439057
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0026249379664101285
Epoch-3 lr: 0.0026249379664101285
epoch 3 training time: 18.745
---------------
2023-09-24 11:35:01.602967
current #epochs=4, #steps=117
start validation
acc: 0.685446
AUC: 0.866605
Avg Precision: 0.388650
Avg Recall: 1.000000
d_prime: 1.570466
train_loss: 0.786550
valid_loss: 1.405762
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0026249379664101285
Epoch-4 lr: 0.0026249379664101285
epoch 4 training time: 15.057
---------------
2023-09-24 11:35:16.659778
current #epochs=5, #steps=156
start validation
acc: 0.629108
AUC: 0.860916
Avg Precision: 0.366859
Avg Recall: 1.000000
d_prime: 1.533636
train_loss: 0.795121
valid_loss: 1.439846
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0026249379664101285
Epoch-5 lr: 0.0026249379664101285
epoch 5 training time: 15.059
---------------
2023-09-24 11:35:31.718851
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01111	Per Sample Data Time 0.00510	Per Sample DNN Time 0.00601	Train Loss 0.7780	
start validation
acc: 0.666667
AUC: 0.826535
Avg Precision: 0.399422
Avg Recall: 1.000000
d_prime: 1.330153
train_loss: 0.770786
valid_loss: 1.449231
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0024472566290931652
Epoch-6 lr: 0.0024472566290931652
epoch 6 training time: 15.103
---------------
2023-09-24 11:35:46.822446
current #epochs=7, #steps=234
start validation
acc: 0.643192
AUC: 0.862125
Avg Precision: 0.397730
Avg Recall: 1.000000
d_prime: 1.541374
train_loss: 0.809197
valid_loss: 1.419369
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0024472566290931652
Epoch-7 lr: 0.0024472566290931652
epoch 7 training time: 15.116
---------------
2023-09-24 11:36:01.938119
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00679	Per Sample Data Time 0.00126	Per Sample DNN Time 0.00553	Train Loss 0.8005	
start validation
acc: 0.624413
AUC: 0.853902
Avg Precision: 0.411366
Avg Recall: 1.000000
d_prime: 1.489614
train_loss: 0.801990
valid_loss: 1.454295
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0024472566290931652
Epoch-8 lr: 0.0024472566290931652
epoch 8 training time: 15.031
---------------
2023-09-24 11:36:16.969102
current #epochs=9, #steps=312
start validation
acc: 0.657277
AUC: 0.870820
Avg Precision: 0.409450
Avg Recall: 1.000000
d_prime: 1.598451
train_loss: 0.798494
valid_loss: 1.422113
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0024472566290931652
Epoch-9 lr: 0.0024472566290931652
epoch 9 training time: 14.883
---------------
2023-09-24 11:36:31.852118
current #epochs=10, #steps=351
start validation
acc: 0.732394
AUC: 0.864122
Avg Precision: 0.405378
Avg Recall: 1.000000
d_prime: 1.554262
train_loss: 0.717788
valid_loss: 1.427346
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0024472566290931652
Epoch-10 lr: 0.0024472566290931652
epoch 10 training time: 17.439
---------------
2023-09-24 11:36:49.291088
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00860	Per Sample Data Time 0.00291	Per Sample DNN Time 0.00569	Train Loss 0.7673	
start validation
acc: 0.633803
AUC: 0.858703
Avg Precision: 0.397623
Avg Recall: 1.000000
d_prime: 1.519590
train_loss: 0.780798
valid_loss: 1.444997
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0022816024931938115
Epoch-11 lr: 0.0022816024931938115
epoch 11 training time: 15.081
---------------
2023-09-24 11:37:04.372575
current #epochs=12, #steps=429
start validation
acc: 0.694836
AUC: 0.868418
Avg Precision: 0.408419
Avg Recall: 1.000000
d_prime: 1.582424
train_loss: 0.738167
valid_loss: 1.421573
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0022816024931938115
Epoch-12 lr: 0.0022816024931938115
epoch 12 training time: 15.213
---------------
2023-09-24 11:37:19.585310
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00658	Per Sample Data Time 0.00104	Per Sample DNN Time 0.00554	Train Loss 0.7063	
start validation
acc: 0.657277
AUC: 0.875313
Avg Precision: 0.406599
Avg Recall: 1.000000
d_prime: 1.628990
train_loss: 0.704615
valid_loss: 1.422852
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0022816024931938115
Epoch-13 lr: 0.0022816024931938115
epoch 13 training time: 15.153
---------------
2023-09-24 11:37:34.738558
current #epochs=14, #steps=507
start validation
acc: 0.727700
AUC: 0.853371
Avg Precision: 0.423408
Avg Recall: 1.000000
d_prime: 1.486342
train_loss: 0.756941
valid_loss: 1.429516
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0022816024931938115
Epoch-14 lr: 0.0022816024931938115
epoch 14 training time: 15.088
---------------
2023-09-24 11:37:49.826732
current #epochs=15, #steps=546
start validation
acc: 0.723005
AUC: 0.857260
Avg Precision: 0.461651
Avg Recall: 1.000000
d_prime: 1.510506
train_loss: 0.718622
valid_loss: 1.421616
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0022816024931938115
Epoch-15 lr: 0.0022816024931938115
epoch 15 training time: 15.086
---------------
2023-09-24 11:38:04.913025
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00760	Per Sample Data Time 0.00208	Per Sample DNN Time 0.00552	Train Loss 0.6956	
start validation
acc: 0.713615
AUC: 0.879388
Avg Precision: 0.405887
Avg Recall: 1.000000
d_prime: 1.657360
train_loss: 0.732446
valid_loss: 1.406743
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.002127161440717887
Epoch-16 lr: 0.002127161440717887
epoch 16 training time: 14.960
---------------
2023-09-24 11:38:19.873716
current #epochs=17, #steps=624
start validation
acc: 0.652582
AUC: 0.867933
Avg Precision: 0.430374
Avg Recall: 1.000000
d_prime: 1.579217
train_loss: 0.732433
valid_loss: 1.424207
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.002127161440717887
Epoch-17 lr: 0.002127161440717887
epoch 17 training time: 15.112
---------------
2023-09-24 11:38:34.985204
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00646	Per Sample Data Time 0.00092	Per Sample DNN Time 0.00555	Train Loss 0.7035	
start validation
acc: 0.704225
AUC: 0.870116
Avg Precision: 0.420848
Avg Recall: 1.000000
d_prime: 1.593736
train_loss: 0.698613
valid_loss: 1.424424
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.002127161440717887
Epoch-18 lr: 0.002127161440717887
epoch 18 training time: 15.177
---------------
2023-09-24 11:38:50.162075
current #epochs=19, #steps=702
start validation
acc: 0.699531
AUC: 0.874144
Avg Precision: 0.445115
Avg Recall: 1.000000
d_prime: 1.620972
train_loss: 0.703595
valid_loss: 1.420917
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.002127161440717887
Epoch-19 lr: 0.002127161440717887
epoch 19 training time: 15.187
---------------
2023-09-24 11:39:05.349610
current #epochs=20, #steps=741
start validation
acc: 0.676056
AUC: 0.866709
Avg Precision: 0.424689
Avg Recall: 1.000000
d_prime: 1.571145
train_loss: 0.707746
valid_loss: 1.421438
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.002127161440717887
Epoch-20 lr: 0.002127161440717887
epoch 20 training time: 15.156
---------------
2023-09-24 11:39:20.505913
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00557	Train Loss 0.6726	
start validation
acc: 0.615023
AUC: 0.846566
Avg Precision: 0.448142
Avg Recall: 1.000000
d_prime: 1.445064
train_loss: 0.693896
valid_loss: 1.447321
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.001983174461096907
Epoch-21 lr: 0.001983174461096907
epoch 21 training time: 14.948
---------------
2023-09-24 11:39:35.453198
current #epochs=22, #steps=819
start validation
acc: 0.671362
AUC: 0.871449
Avg Precision: 0.446127
Avg Recall: 1.000000
d_prime: 1.602685
train_loss: 0.704602
valid_loss: 1.419884
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.001983174461096907
Epoch-22 lr: 0.001983174461096907
epoch 22 training time: 15.113
---------------
2023-09-24 11:39:50.565885
current #epochs=23, #steps=858
start validation
acc: 0.699531
AUC: 0.861817
Avg Precision: 0.463586
Avg Recall: 1.000000
d_prime: 1.539396
train_loss: 0.717694
valid_loss: 1.427770
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.001983174461096907
Epoch-23 lr: 0.001983174461096907
epoch 23 training time: 15.158
---------------
2023-09-24 11:40:05.724458
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01406	Per Sample Data Time 0.00820	Per Sample DNN Time 0.00586	Train Loss 0.6940	
start validation
acc: 0.708920
AUC: 0.868292
Avg Precision: 0.431627
Avg Recall: 1.000000
d_prime: 1.581589
train_loss: 0.691921
valid_loss: 1.423823
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.001983174461096907
Epoch-24 lr: 0.001983174461096907
epoch 24 training time: 15.342
---------------
2023-09-24 11:40:21.065918
current #epochs=25, #steps=936
start validation
acc: 0.676056
AUC: 0.863009
Avg Precision: 0.471244
Avg Recall: 1.000000
d_prime: 1.547063
train_loss: 0.713830
valid_loss: 1.436251
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.001983174461096907
Epoch-25 lr: 0.001983174461096907
epoch 25 training time: 15.221
---------------
2023-09-24 11:40:36.286436
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00693	Per Sample Data Time 0.00132	Per Sample DNN Time 0.00561	Train Loss 0.7667	
start validation
acc: 0.699531
AUC: 0.873716
Avg Precision: 0.444038
Avg Recall: 1.000000
d_prime: 1.618051
train_loss: 0.750583
valid_loss: 1.414850
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0018489339209814193
Epoch-26 lr: 0.0018489339209814193
epoch 26 training time: 15.085
---------------
2023-09-24 11:40:51.371446
current #epochs=27, #steps=1014
start validation
acc: 0.708920
AUC: 0.869679
Avg Precision: 0.456166
Avg Recall: 1.000000
d_prime: 1.590812
train_loss: 0.691529
valid_loss: 1.420164
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0018489339209814193
Epoch-27 lr: 0.0018489339209814193
epoch 27 training time: 15.094
---------------
2023-09-24 11:41:06.465651
current #epochs=28, #steps=1053
start validation
acc: 0.699531
AUC: 0.861094
Avg Precision: 0.485440
Avg Recall: 1.000000
d_prime: 1.534774
train_loss: 0.678634
valid_loss: 1.428126
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0018489339209814193
Epoch-28 lr: 0.0018489339209814193
epoch 28 training time: 16.205
---------------
2023-09-24 11:41:22.671037
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00933	Per Sample Data Time 0.00351	Per Sample DNN Time 0.00582	Train Loss 0.6560	
start validation
acc: 0.680751
AUC: 0.871382
Avg Precision: 0.435755
Avg Recall: 1.000000
d_prime: 1.602229
train_loss: 0.635660
valid_loss: 1.419716
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0018489339209814193
Epoch-29 lr: 0.0018489339209814193
epoch 29 training time: 15.141
---------------
2023-09-24 11:41:37.812109
current #epochs=30, #steps=1131
start validation
acc: 0.694836
AUC: 0.860296
Avg Precision: 0.414673
Avg Recall: 1.000000
d_prime: 1.529687
train_loss: 0.733428
valid_loss: 1.428811
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0018489339209814193
Epoch-30 lr: 0.0018489339209814193
epoch 30 training time: 15.101
---------------
2023-09-24 11:41:52.913263
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00665	Per Sample Data Time 0.00112	Per Sample DNN Time 0.00553	Train Loss 0.7569	
start validation
acc: 0.699531
AUC: 0.875240
Avg Precision: 0.437817
Avg Recall: 1.000000
d_prime: 1.628489
train_loss: 0.741441
valid_loss: 1.423097
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0017237800865310148
Epoch-31 lr: 0.0017237800865310148
epoch 31 training time: 15.165
---------------
2023-09-24 11:42:08.078085
current #epochs=32, #steps=1209
start validation
acc: 0.680751
AUC: 0.871030
Avg Precision: 0.440140
Avg Recall: 1.000000
d_prime: 1.599866
train_loss: 0.706639
valid_loss: 1.420708
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0017237800865310148
Epoch-32 lr: 0.0017237800865310148
epoch 32 training time: 15.173
---------------
2023-09-24 11:42:23.250409
current #epochs=33, #steps=1248
start validation
[I 2023-09-24 11:42:39,192] Trial 8 finished with value: 0.46217870562073454 and parameters: {'warmup': 'False', 'num_epochs': 33, 'batch_size': 17, 'lr-adaptschedule': 'True', 'lr': 0.0026249379664101285, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.9323102718652203}. Best is trial 8 with value: 0.46217870562073454.
acc: 0.680751
AUC: 0.865965
Avg Precision: 0.462179
Avg Recall: 1.000000
d_prime: 1.566266
train_loss: 0.738817
valid_loss: 1.420794
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0017237800865310148
Epoch-33 lr: 0.0017237800865310148
epoch 33 training time: 15.932
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa60a23a700>
The learning rate scheduler starts at 5 epoch with decay rate of 0.752 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 11:42:39.198321
current #epochs=1, #steps=0
start validation
acc: 0.680751
AUC: 0.852992
Avg Precision: 0.391634
Avg Recall: 1.000000
d_prime: 1.484011
train_loss: 0.966683
valid_loss: 1.419337
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.004864159668288726
Epoch-1 lr: 0.014592479004866179
epoch 1 training time: 17.488
---------------
2023-09-24 11:42:56.686309
current #epochs=2, #steps=39
start validation
acc: 0.652582
AUC: 0.850230
Avg Precision: 0.360192
Avg Recall: 1.000000
d_prime: 1.467137
train_loss: 0.879046
valid_loss: 1.436566
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.004864159668288726
Epoch-2 lr: 0.014592479004866179
epoch 2 training time: 15.165
---------------
2023-09-24 11:43:11.851544
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00702	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00556	Train Loss 0.7779	
start validation
acc: 0.694836
AUC: 0.856635
Avg Precision: 0.416537
Avg Recall: 1.000000
d_prime: 1.506595
train_loss: 0.829665
valid_loss: 1.434955
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.004864159668288726
Epoch-3 lr: 0.014592479004866179
epoch 3 training time: 18.392
---------------
2023-09-24 11:43:30.243461
current #epochs=4, #steps=117
start validation
acc: 0.685446
AUC: 0.865001
Avg Precision: 0.388255
Avg Recall: 1.000000
d_prime: 1.559972
train_loss: 0.773560
valid_loss: 1.427994
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.004864159668288726
Epoch-4 lr: 0.014592479004866179
epoch 4 training time: 15.042
---------------
2023-09-24 11:43:45.285304
current #epochs=5, #steps=156
start validation
acc: 0.661972
AUC: 0.861333
Avg Precision: 0.439057
Avg Recall: 1.000000
d_prime: 1.536300
train_loss: 0.750796
valid_loss: 1.436548
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0036566794758663406
Epoch-5 lr: 0.010970038427599022
epoch 5 training time: 17.537
---------------
2023-09-24 11:44:02.822324
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01138	Per Sample Data Time 0.00546	Per Sample DNN Time 0.00592	Train Loss 0.7367	
start validation
acc: 0.638498
AUC: 0.862284
Avg Precision: 0.416225
Avg Recall: 1.000000
d_prime: 1.542396
train_loss: 0.755951
valid_loss: 1.438037
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0036566794758663406
Epoch-6 lr: 0.010970038427599022
epoch 6 training time: 17.145
---------------
2023-09-24 11:44:19.967380
current #epochs=7, #steps=234
start validation
acc: 0.704225
AUC: 0.865383
Avg Precision: 0.406135
Avg Recall: 1.000000
d_prime: 1.562462
train_loss: 0.738748
valid_loss: 1.430358
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0036566794758663406
Epoch-7 lr: 0.010970038427599022
epoch 7 training time: 18.378
---------------
2023-09-24 11:44:38.345286
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00680	Per Sample Data Time 0.00124	Per Sample DNN Time 0.00556	Train Loss 0.6725	
start validation
acc: 0.704225
AUC: 0.865264
Avg Precision: 0.434464
Avg Recall: 1.000000
d_prime: 1.561687
train_loss: 0.696537
valid_loss: 1.435237
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0036566794758663406
Epoch-8 lr: 0.010970038427599022
epoch 8 training time: 15.155
---------------
2023-09-24 11:44:53.499934
current #epochs=9, #steps=312
start validation
acc: 0.657277
AUC: 0.875926
Avg Precision: 0.431127
Avg Recall: 1.000000
d_prime: 1.633215
train_loss: 0.733432
valid_loss: 1.410788
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0036566794758663406
Epoch-9 lr: 0.010970038427599022
epoch 9 training time: 15.141
---------------
2023-09-24 11:45:08.640543
current #epochs=10, #steps=351
start validation
acc: 0.708920
AUC: 0.881526
Avg Precision: 0.423894
Avg Recall: 1.000000
d_prime: 1.672517
train_loss: 0.729287
valid_loss: 1.425230
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0036566794758663406
Epoch-10 lr: 0.010970038427599022
epoch 10 training time: 17.373
---------------
2023-09-24 11:45:26.013943
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00865	Per Sample Data Time 0.00290	Per Sample DNN Time 0.00575	Train Loss 0.6881	
start validation
acc: 0.661972
AUC: 0.872504
Avg Precision: 0.400112
Avg Recall: 1.000000
d_prime: 1.609809
train_loss: 0.710004
valid_loss: 1.416071
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0036566794758663406
Epoch-11 lr: 0.010970038427599022
epoch 11 training time: 16.884
---------------
2023-09-24 11:45:42.897935
current #epochs=12, #steps=429
start validation
acc: 0.690141
AUC: 0.878202
Avg Precision: 0.418332
Avg Recall: 1.000000
d_prime: 1.649038
train_loss: 0.705819
valid_loss: 1.398892
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0036566794758663406
Epoch-12 lr: 0.010970038427599022
epoch 12 training time: 16.299
---------------
2023-09-24 11:45:59.197051
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00656	Per Sample Data Time 0.00101	Per Sample DNN Time 0.00555	Train Loss 0.7347	
start validation
acc: 0.727700
AUC: 0.891176
Avg Precision: 0.424467
Avg Recall: 1.000000
d_prime: 1.743450
train_loss: 0.736911
valid_loss: 1.405303
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0036566794758663406
Epoch-13 lr: 0.010970038427599022
epoch 13 training time: 17.350
---------------
2023-09-24 11:46:16.546682
current #epochs=14, #steps=507
start validation
acc: 0.704225
AUC: 0.866211
Avg Precision: 0.453664
Avg Recall: 1.000000
d_prime: 1.567879
train_loss: 0.710425
valid_loss: 1.426381
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0036566794758663406
Epoch-14 lr: 0.010970038427599022
epoch 14 training time: 15.103
---------------
2023-09-24 11:46:31.649336
current #epochs=15, #steps=546
start validation
acc: 0.643192
AUC: 0.868001
Avg Precision: 0.423181
Avg Recall: 1.000000
d_prime: 1.579662
train_loss: 0.735935
valid_loss: 1.421490
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0027489444633971754
Epoch-15 lr: 0.008246833390191527
epoch 15 training time: 15.203
---------------
2023-09-24 11:46:46.852437
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00775	Per Sample Data Time 0.00205	Per Sample DNN Time 0.00569	Train Loss 0.6466	
start validation
acc: 0.699531
AUC: 0.867866
Avg Precision: 0.444156
Avg Recall: 1.000000
d_prime: 1.578773
train_loss: 0.687904
valid_loss: 1.423733
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0027489444633971754
Epoch-16 lr: 0.008246833390191527
epoch 16 training time: 16.396
---------------
2023-09-24 11:47:03.248789
current #epochs=17, #steps=624
start validation
acc: 0.647887
AUC: 0.866677
Avg Precision: 0.426343
Avg Recall: 1.000000
d_prime: 1.570934
train_loss: 0.643518
valid_loss: 1.414679
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0027489444633971754
Epoch-17 lr: 0.008246833390191527
epoch 17 training time: 15.131
---------------
2023-09-24 11:47:18.380106
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00651	Per Sample Data Time 0.00096	Per Sample DNN Time 0.00555	Train Loss 0.6379	
start validation
acc: 0.666667
AUC: 0.872728
Avg Precision: 0.414529
Avg Recall: 1.000000
d_prime: 1.611329
train_loss: 0.639427
valid_loss: 1.419729
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0027489444633971754
Epoch-18 lr: 0.008246833390191527
epoch 18 training time: 15.175
---------------
2023-09-24 11:47:33.555099
current #epochs=19, #steps=702
start validation
acc: 0.690141
AUC: 0.872319
Avg Precision: 0.377164
Avg Recall: 1.000000
d_prime: 1.608559
train_loss: 0.740618
valid_loss: 1.415184
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0027489444633971754
Epoch-19 lr: 0.008246833390191527
epoch 19 training time: 15.156
---------------
2023-09-24 11:47:48.711560
current #epochs=20, #steps=741
start validation
[I 2023-09-24 11:48:04,804] Trial 9 finished with value: 0.3784740279282579 and parameters: {'warmup': 'False', 'num_epochs': 20, 'batch_size': 55, 'lr-adaptschedule': 'False', 'lr': 0.004864159668288726, 'head-lr': 3, 'lr-scheduler-start': 5, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.7517597540445886}. Best is trial 8 with value: 0.46217870562073454.
acc: 0.624413
AUC: 0.847432
Avg Precision: 0.378474
Avg Recall: 1.000000
d_prime: 1.450251
train_loss: 0.679803
valid_loss: 1.431178
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0027489444633971754
Epoch-20 lr: 0.008246833390191527
epoch 20 training time: 16.084
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f4a75b0>
The learning rate scheduler starts at 10 epoch with decay rate of 0.949 every 6 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 11:48:04.834346
current #epochs=1, #steps=0
start validation
[I 2023-09-24 11:48:22,265] Trial 10 finished with value: 0.4005254780145258 and parameters: {'warmup': 'False', 'num_epochs': 1, 'batch_size': 8, 'lr-adaptschedule': 'True', 'lr': 0.0018391428484773162, 'head-lr': 1, 'lr-scheduler-start': 10, 'lr-scheduler-step': 6, 'lr-scheduler-decay': 0.9492779382428048}. Best is trial 8 with value: 0.46217870562073454.
acc: 0.690141
AUC: 0.890162
Avg Precision: 0.400525
Avg Recall: 1.000000
d_prime: 1.735791
train_loss: 0.650145
valid_loss: 1.403983
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0018391428484773162
Epoch-1 lr: 0.0018391428484773162
epoch 1 training time: 17.425
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa6015c4a30>
The learning rate scheduler starts at 9 epoch with decay rate of 0.822 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 11:48:22.297951
current #epochs=1, #steps=0
start validation
acc: 0.680751
AUC: 0.883527
Avg Precision: 0.384230
Avg Recall: 1.000000
d_prime: 1.686883
train_loss: 0.677720
valid_loss: 1.408462
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0027469923919797388
Epoch-1 lr: 0.0027469923919797388
epoch 1 training time: 18.383
---------------
2023-09-24 11:48:40.681254
current #epochs=2, #steps=39
start validation
acc: 0.690141
AUC: 0.891710
Avg Precision: 0.428494
Avg Recall: 1.000000
d_prime: 1.747508
train_loss: 0.674885
valid_loss: 1.419091
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0027469923919797388
Epoch-2 lr: 0.0027469923919797388
epoch 2 training time: 17.514
---------------
2023-09-24 11:48:58.194835
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00560	Train Loss 0.6410	
start validation
acc: 0.643192
AUC: 0.865943
Avg Precision: 0.423671
Avg Recall: 1.000000
d_prime: 1.566120
train_loss: 0.620104
valid_loss: 1.421228
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0027469923919797388
Epoch-3 lr: 0.0027469923919797388
epoch 3 training time: 15.068
---------------
2023-09-24 11:49:13.263017
current #epochs=4, #steps=117
start validation
acc: 0.680751
AUC: 0.872749
Avg Precision: 0.436470
Avg Recall: 1.000000
d_prime: 1.611473
train_loss: 0.642901
valid_loss: 1.419833
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0027469923919797388
Epoch-4 lr: 0.0027469923919797388
epoch 4 training time: 16.313
---------------
2023-09-24 11:49:29.576115
current #epochs=5, #steps=156
start validation
acc: 0.661972
AUC: 0.871875
Avg Precision: 0.461904
Avg Recall: 1.000000
d_prime: 1.605554
train_loss: 0.616822
valid_loss: 1.418934
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0027469923919797388
Epoch-5 lr: 0.0027469923919797388
epoch 5 training time: 15.136
---------------
2023-09-24 11:49:44.712247
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01108	Per Sample Data Time 0.00524	Per Sample DNN Time 0.00584	Train Loss 0.6179	
start validation
acc: 0.680751
AUC: 0.880626
Avg Precision: 0.421635
Avg Recall: 1.000000
d_prime: 1.666119
train_loss: 0.577537
valid_loss: 1.401032
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0027469923919797388
Epoch-6 lr: 0.0027469923919797388
epoch 6 training time: 15.067
---------------
2023-09-24 11:49:59.779742
current #epochs=7, #steps=234
start validation
acc: 0.615023
AUC: 0.867824
Avg Precision: 0.400445
Avg Recall: 1.000000
d_prime: 1.578493
train_loss: 0.641809
valid_loss: 1.425818
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0027469923919797388
Epoch-7 lr: 0.0027469923919797388
epoch 7 training time: 15.188
---------------
2023-09-24 11:50:14.967930
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00681	Per Sample Data Time 0.00125	Per Sample DNN Time 0.00557	Train Loss 0.6391	
start validation
acc: 0.699531
AUC: 0.883144
Avg Precision: 0.437860
Avg Recall: 1.000000
d_prime: 1.684114
train_loss: 0.618623
valid_loss: 1.415501
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0027469923919797388
Epoch-8 lr: 0.0027469923919797388
epoch 8 training time: 18.661
---------------
2023-09-24 11:50:33.628681
current #epochs=9, #steps=312
start validation
acc: 0.633803
AUC: 0.879849
Avg Precision: 0.472769
Avg Recall: 1.000000
d_prime: 1.660617
train_loss: 0.631543
valid_loss: 1.434108
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0022578578623218956
Epoch-9 lr: 0.0022578578623218956
epoch 9 training time: 15.028
---------------
2023-09-24 11:50:48.656347
current #epochs=10, #steps=351
start validation
acc: 0.699531
AUC: 0.883024
Avg Precision: 0.467992
Avg Recall: 1.000000
d_prime: 1.683257
train_loss: 0.669201
valid_loss: 1.409133
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0022578578623218956
Epoch-10 lr: 0.0022578578623218956
epoch 10 training time: 14.976
---------------
2023-09-24 11:51:03.631993
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00866	Per Sample Data Time 0.00290	Per Sample DNN Time 0.00576	Train Loss 0.6060	
start validation
acc: 0.671362
AUC: 0.879516
Avg Precision: 0.488654
Avg Recall: 1.000000
d_prime: 1.658267
train_loss: 0.612525
valid_loss: 1.407345
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001855819528780989
Epoch-11 lr: 0.001855819528780989
epoch 11 training time: 15.829
---------------
2023-09-24 11:51:19.460829
current #epochs=12, #steps=429
start validation
acc: 0.680751
AUC: 0.873723
Avg Precision: 0.465791
Avg Recall: 1.000000
d_prime: 1.618101
train_loss: 0.559300
valid_loss: 1.421919
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001855819528780989
Epoch-12 lr: 0.001855819528780989
epoch 12 training time: 15.175
---------------
2023-09-24 11:51:34.635351
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00654	Per Sample Data Time 0.00103	Per Sample DNN Time 0.00551	Train Loss 0.5720	
start validation
acc: 0.666667
AUC: 0.863382
Avg Precision: 0.436031
Avg Recall: 1.000000
d_prime: 1.549471
train_loss: 0.577384
valid_loss: 1.429786
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0015253688821063095
Epoch-13 lr: 0.0015253688821063095
epoch 13 training time: 14.997
---------------
2023-09-24 11:51:49.632044
current #epochs=14, #steps=507
start validation
acc: 0.718310
AUC: 0.876914
Avg Precision: 0.479177
Avg Recall: 1.000000
d_prime: 1.640062
train_loss: 0.593105
valid_loss: 1.408706
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0015253688821063095
Epoch-14 lr: 0.0015253688821063095
epoch 14 training time: 17.416
---------------
2023-09-24 11:52:07.047951
current #epochs=15, #steps=546
start validation
acc: 0.713615
AUC: 0.884587
Avg Precision: 0.487992
Avg Recall: 1.000000
d_prime: 1.694555
train_loss: 0.561664
valid_loss: 1.397404
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0012537588867957427
Epoch-15 lr: 0.0012537588867957427
epoch 15 training time: 15.157
---------------
2023-09-24 11:52:22.204852
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00761	Per Sample Data Time 0.00206	Per Sample DNN Time 0.00555	Train Loss 0.5384	
start validation
acc: 0.704225
AUC: 0.883035
Avg Precision: 0.492925
Avg Recall: 1.000000
d_prime: 1.683333
train_loss: 0.542913
valid_loss: 1.403283
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0012537588867957427
Epoch-16 lr: 0.0012537588867957427
epoch 16 training time: 15.171
---------------
2023-09-24 11:52:37.376577
current #epochs=17, #steps=624
start validation
acc: 0.708920
AUC: 0.884389
Avg Precision: 0.500241
Avg Recall: 1.000000
d_prime: 1.693120
train_loss: 0.525977
valid_loss: 1.393768
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0010305122679890534
Epoch-17 lr: 0.0010305122679890534
epoch 17 training time: 15.042
---------------
2023-09-24 11:52:52.418260
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00649	Per Sample Data Time 0.00093	Per Sample DNN Time 0.00556	Train Loss 0.5080	
start validation
acc: 0.713615
AUC: 0.881258
Avg Precision: 0.482139
Avg Recall: 1.000000
d_prime: 1.670605
train_loss: 0.512483
valid_loss: 1.396668
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0010305122679890534
Epoch-18 lr: 0.0010305122679890534
epoch 18 training time: 15.095
---------------
2023-09-24 11:53:07.513383
current #epochs=19, #steps=702
start validation
acc: 0.694836
AUC: 0.878718
Avg Precision: 0.481627
Avg Recall: 1.000000
d_prime: 1.652652
train_loss: 0.515593
valid_loss: 1.401342
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0008470173537034733
Epoch-19 lr: 0.0008470173537034733
epoch 19 training time: 15.082
---------------
2023-09-24 11:53:22.595108
current #epochs=20, #steps=741
start validation
acc: 0.676056
AUC: 0.879885
Avg Precision: 0.472447
Avg Recall: 1.000000
d_prime: 1.660870
train_loss: 0.512955
valid_loss: 1.399457
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0008470173537034733
Epoch-20 lr: 0.0008470173537034733
epoch 20 training time: 15.064
---------------
2023-09-24 11:53:37.659102
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00161	Per Sample DNN Time 0.00547	Train Loss 0.5006	
start validation
acc: 0.704225
AUC: 0.885538
Avg Precision: 0.460395
Avg Recall: 1.000000
d_prime: 1.701492
train_loss: 0.511338
valid_loss: 1.398054
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.000696195882145923
Epoch-21 lr: 0.000696195882145923
epoch 21 training time: 14.966
---------------
2023-09-24 11:53:52.625006
current #epochs=22, #steps=819
start validation
acc: 0.704225
AUC: 0.883302
Avg Precision: 0.480836
Avg Recall: 1.000000
d_prime: 1.685254
train_loss: 0.491776
valid_loss: 1.391760
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.000696195882145923
Epoch-22 lr: 0.000696195882145923
epoch 22 training time: 15.824
---------------
2023-09-24 11:54:08.449382
current #epochs=23, #steps=858
start validation
acc: 0.704225
AUC: 0.885997
Avg Precision: 0.442088
Avg Recall: 1.000000
d_prime: 1.704853
train_loss: 0.491859
valid_loss: 1.393427
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0005722299598676479
Epoch-23 lr: 0.0005722299598676479
epoch 23 training time: 15.160
---------------
2023-09-24 11:54:23.609458
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01345	Per Sample Data Time 0.00781	Per Sample DNN Time 0.00564	Train Loss 0.5407	
start validation
acc: 0.708920
AUC: 0.884146
Avg Precision: 0.478711
Avg Recall: 1.000000
d_prime: 1.691355
train_loss: 0.485680
valid_loss: 1.391273
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0005722299598676479
Epoch-24 lr: 0.0005722299598676479
epoch 24 training time: 19.963
---------------
2023-09-24 11:54:43.572739
current #epochs=25, #steps=936
start validation
acc: 0.661972
AUC: 0.880324
Avg Precision: 0.475077
Avg Recall: 1.000000
d_prime: 1.663973
train_loss: 0.489292
valid_loss: 1.401084
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0004703376382532192
Epoch-25 lr: 0.0004703376382532192
epoch 25 training time: 15.107
---------------
2023-09-24 11:54:58.679374
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00681	Per Sample Data Time 0.00129	Per Sample DNN Time 0.00552	Train Loss 0.4742	
start validation
acc: 0.699531
AUC: 0.883447
Avg Precision: 0.459629
Avg Recall: 1.000000
d_prime: 1.686304
train_loss: 0.475228
valid_loss: 1.392834
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0004703376382532192
Epoch-26 lr: 0.0004703376382532192
epoch 26 training time: 15.069
---------------
2023-09-24 11:55:13.748661
current #epochs=27, #steps=1014
start validation
acc: 0.708920
AUC: 0.882973
Avg Precision: 0.457774
Avg Recall: 1.000000
d_prime: 1.682889
train_loss: 0.487848
valid_loss: 1.390396
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00038658845127364854
Epoch-27 lr: 0.00038658845127364854
epoch 27 training time: 14.941
---------------
2023-09-24 11:55:28.690013
current #epochs=28, #steps=1053
start validation
acc: 0.699531
AUC: 0.885185
Avg Precision: 0.459515
Avg Recall: 1.000000
d_prime: 1.698916
train_loss: 0.462021
valid_loss: 1.390454
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00038658845127364854
Epoch-28 lr: 0.00038658845127364854
epoch 28 training time: 15.108
---------------
2023-09-24 11:55:43.797796
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00918	Per Sample Data Time 0.00354	Per Sample DNN Time 0.00563	Train Loss 0.4515	
start validation
acc: 0.699531
AUC: 0.885890
Avg Precision: 0.466653
Avg Recall: 1.000000
d_prime: 1.704063
train_loss: 0.479049
valid_loss: 1.387623
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00031775179892725764
Epoch-29 lr: 0.00031775179892725764
epoch 29 training time: 15.089
---------------
2023-09-24 11:55:58.887168
current #epochs=30, #steps=1131
start validation
acc: 0.690141
AUC: 0.890203
Avg Precision: 0.460188
Avg Recall: 1.000000
d_prime: 1.736099
train_loss: 0.466175
valid_loss: 1.390954
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00031775179892725764
Epoch-30 lr: 0.00031775179892725764
epoch 30 training time: 15.080
---------------
2023-09-24 11:56:13.967122
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00664	Per Sample Data Time 0.00110	Per Sample DNN Time 0.00555	Train Loss 0.4564	
start validation
acc: 0.704225
AUC: 0.889820
Avg Precision: 0.460178
Avg Recall: 1.000000
d_prime: 1.733219
train_loss: 0.462504
valid_loss: 1.387543
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0002611723278045855
Epoch-31 lr: 0.0002611723278045855
epoch 31 training time: 15.004
---------------
2023-09-24 11:56:28.970908
current #epochs=32, #steps=1209
start validation
acc: 0.685446
AUC: 0.888485
Avg Precision: 0.477877
Avg Recall: 1.000000
d_prime: 1.723234
train_loss: 0.455050
valid_loss: 1.387932
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0002611723278045855
Epoch-32 lr: 0.0002611723278045855
epoch 32 training time: 15.162
---------------
2023-09-24 11:56:44.133334
current #epochs=33, #steps=1248
start validation
[I 2023-09-24 11:56:59,142] Trial 11 finished with value: 0.47135951318996194 and parameters: {'warmup': 'False', 'num_epochs': 33, 'batch_size': 23, 'lr-adaptschedule': 'False', 'lr': 0.0027469923919797388, 'head-lr': 1, 'lr-scheduler-start': 9, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.8219381564048209}. Best is trial 11 with value: 0.47135951318996194.
acc: 0.676056
AUC: 0.889121
Avg Precision: 0.471360
Avg Recall: 1.000000
d_prime: 1.727977
train_loss: 0.471702
valid_loss: 1.387252
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.00021466750161965658
Epoch-33 lr: 0.00021466750161965658
epoch 33 training time: 15.003
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa609ea0490>
The learning rate scheduler starts at 9 epoch with decay rate of 0.825 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 11:56:59.174653
current #epochs=1, #steps=0
start validation
acc: 0.680751
AUC: 0.869250
Avg Precision: 0.435465
Avg Recall: 1.000000
d_prime: 1.587951
train_loss: 0.659201
valid_loss: 1.405175
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003277088101328141
Epoch-1 lr: 0.003277088101328141
epoch 1 training time: 17.695
---------------
2023-09-24 11:57:16.870178
current #epochs=2, #steps=39
start validation
acc: 0.671362
AUC: 0.890514
Avg Precision: 0.487068
Avg Recall: 1.000000
d_prime: 1.738445
train_loss: 0.590751
valid_loss: 1.401993
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003277088101328141
Epoch-2 lr: 0.003277088101328141
epoch 2 training time: 15.049
---------------
2023-09-24 11:57:31.919089
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00563	Train Loss 0.5664	
start validation
acc: 0.647887
AUC: 0.882480
Avg Precision: 0.419973
Avg Recall: 1.000000
d_prime: 1.679345
train_loss: 0.573063
valid_loss: 1.414091
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003277088101328141
Epoch-3 lr: 0.003277088101328141
epoch 3 training time: 15.160
---------------
2023-09-24 11:57:47.078613
current #epochs=4, #steps=117
start validation
acc: 0.671362
AUC: 0.873464
Avg Precision: 0.458003
Avg Recall: 1.000000
d_prime: 1.616334
train_loss: 0.653150
valid_loss: 1.408709
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003277088101328141
Epoch-4 lr: 0.003277088101328141
epoch 4 training time: 15.083
---------------
2023-09-24 11:58:02.161651
current #epochs=5, #steps=156
start validation
acc: 0.690141
AUC: 0.879332
Avg Precision: 0.492803
Avg Recall: 1.000000
d_prime: 1.656971
train_loss: 0.577979
valid_loss: 1.398602
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.003277088101328141
Epoch-5 lr: 0.003277088101328141
epoch 5 training time: 17.498
---------------
2023-09-24 11:58:19.659740
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01075	Per Sample Data Time 0.00507	Per Sample DNN Time 0.00568	Train Loss 0.6116	
start validation
acc: 0.685446
AUC: 0.843754
Avg Precision: 0.381510
Avg Recall: 1.000000
d_prime: 1.428363
train_loss: 0.667773
valid_loss: 1.448434
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.003277088101328141
Epoch-6 lr: 0.003277088101328141
epoch 6 training time: 15.030
---------------
2023-09-24 11:58:34.689277
current #epochs=7, #steps=234
start validation
acc: 0.713615
AUC: 0.872576
Avg Precision: 0.455879
Avg Recall: 1.000000
d_prime: 1.610296
train_loss: 0.710978
valid_loss: 1.414590
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.003277088101328141
Epoch-7 lr: 0.003277088101328141
epoch 7 training time: 17.483
---------------
2023-09-24 11:58:52.172266
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00677	Per Sample Data Time 0.00119	Per Sample DNN Time 0.00559	Train Loss 0.6862	
start validation
acc: 0.690141
AUC: 0.875198
Avg Precision: 0.457402
Avg Recall: 1.000000
d_prime: 1.628202
train_loss: 0.651972
valid_loss: 1.397329
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.003277088101328141
Epoch-8 lr: 0.003277088101328141
epoch 8 training time: 15.041
---------------
2023-09-24 11:59:07.213890
current #epochs=9, #steps=312
start validation
acc: 0.727700
AUC: 0.874525
Avg Precision: 0.425260
Avg Recall: 1.000000
d_prime: 1.623584
train_loss: 0.634035
valid_loss: 1.399989
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0027020242259838093
Epoch-9 lr: 0.0027020242259838093
epoch 9 training time: 17.336
---------------
2023-09-24 11:59:24.550137
current #epochs=10, #steps=351
start validation
acc: 0.732394
AUC: 0.869838
Avg Precision: 0.414276
Avg Recall: 1.000000
d_prime: 1.591872
train_loss: 0.632974
valid_loss: 1.409980
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.002227872639385092
Epoch-10 lr: 0.002227872639385092
epoch 10 training time: 17.837
---------------
2023-09-24 11:59:42.386591
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00854	Per Sample Data Time 0.00292	Per Sample DNN Time 0.00563	Train Loss 0.6386	
start validation
acc: 0.699531
AUC: 0.854003
Avg Precision: 0.481655
Avg Recall: 1.000000
d_prime: 1.490241
train_loss: 0.634196
valid_loss: 1.420121
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0018369252390820112
Epoch-11 lr: 0.0018369252390820112
epoch 11 training time: 15.078
---------------
2023-09-24 11:59:57.464734
current #epochs=12, #steps=429
start validation
acc: 0.718310
AUC: 0.868146
Avg Precision: 0.416189
Avg Recall: 1.000000
d_prime: 1.580622
train_loss: 0.612202
valid_loss: 1.412687
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0015145813429029017
Epoch-12 lr: 0.0015145813429029017
epoch 12 training time: 15.073
---------------
2023-09-24 12:00:12.537796
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00667	Per Sample Data Time 0.00107	Per Sample DNN Time 0.00560	Train Loss 0.5924	
start validation
acc: 0.718310
AUC: 0.865486
Avg Precision: 0.432782
Avg Recall: 1.000000
d_prime: 1.563134
train_loss: 0.599213
valid_loss: 1.411615
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0012488023984122203
Epoch-13 lr: 0.0012488023984122203
epoch 13 training time: 15.206
---------------
2023-09-24 12:00:27.743756
current #epochs=14, #steps=507
start validation
acc: 0.732394
AUC: 0.870171
Avg Precision: 0.428106
Avg Recall: 1.000000
d_prime: 1.594100
train_loss: 0.529266
valid_loss: 1.401512
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0010296623800284672
Epoch-14 lr: 0.0010296623800284672
epoch 14 training time: 15.101
---------------
2023-09-24 12:00:42.845060
current #epochs=15, #steps=546
start validation
acc: 0.699531
AUC: 0.863270
Avg Precision: 0.417395
Avg Recall: 1.000000
d_prime: 1.548747
train_loss: 0.551272
valid_loss: 1.408643
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0008489770825183202
Epoch-15 lr: 0.0008489770825183202
epoch 15 training time: 15.164
---------------
2023-09-24 12:00:58.008889
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00771	Per Sample Data Time 0.00202	Per Sample DNN Time 0.00569	Train Loss 0.5202	
start validation
acc: 0.708920
AUC: 0.869624
Avg Precision: 0.427857
Avg Recall: 1.000000
d_prime: 1.590446
train_loss: 0.526717
valid_loss: 1.404319
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0006999984661199253
Epoch-16 lr: 0.0006999984661199253
epoch 16 training time: 15.089
---------------
2023-09-24 12:01:13.098581
current #epochs=17, #steps=624
start validation
acc: 0.713615
AUC: 0.870105
Avg Precision: 0.439385
Avg Recall: 1.000000
d_prime: 1.593656
train_loss: 0.505292
valid_loss: 1.401850
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.000577162638026421
Epoch-17 lr: 0.000577162638026421
epoch 17 training time: 16.620
---------------
2023-09-24 12:01:29.718747
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00643	Per Sample Data Time 0.00093	Per Sample DNN Time 0.00550	Train Loss 0.4936	
start validation
acc: 0.708920
AUC: 0.872755
Avg Precision: 0.434983
Avg Recall: 1.000000
d_prime: 1.611510
train_loss: 0.497698
valid_loss: 1.404431
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.000475882058113749
Epoch-18 lr: 0.000475882058113749
epoch 18 training time: 15.070
---------------
2023-09-24 12:01:44.789172
current #epochs=19, #steps=702
start validation
acc: 0.704225
AUC: 0.875418
Avg Precision: 0.435824
Avg Recall: 1.000000
d_prime: 1.629713
train_loss: 0.527371
valid_loss: 1.399923
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0003923742084362202
Epoch-19 lr: 0.0003923742084362202
epoch 19 training time: 15.063
---------------
2023-09-24 12:01:59.852162
current #epochs=20, #steps=741
start validation
acc: 0.704225
AUC: 0.878049
Avg Precision: 0.439741
Avg Recall: 1.000000
d_prime: 1.647970
train_loss: 0.515653
valid_loss: 1.398081
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0003235203278228032
Epoch-20 lr: 0.0003235203278228032
epoch 20 training time: 15.452
---------------
2023-09-24 12:02:15.304486
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00731	Per Sample Data Time 0.00166	Per Sample DNN Time 0.00566	Train Loss 0.5014	
start validation
acc: 0.699531
AUC: 0.881789
Avg Precision: 0.426226
Avg Recall: 1.000000
d_prime: 1.674397
train_loss: 0.501196
valid_loss: 1.397668
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00026674893574608443
Epoch-21 lr: 0.00026674893574608443
epoch 21 training time: 15.207
---------------
2023-09-24 12:02:30.511374
current #epochs=22, #steps=819
start validation
acc: 0.713615
AUC: 0.883984
Avg Precision: 0.426292
Avg Recall: 1.000000
d_prime: 1.690182
train_loss: 0.488826
valid_loss: 1.395420
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00021993979543888603
Epoch-22 lr: 0.00021993979543888603
epoch 22 training time: 15.591
---------------
2023-09-24 12:02:46.103013
current #epochs=23, #steps=858
start validation
acc: 0.699531
AUC: 0.882081
Avg Precision: 0.432003
Avg Recall: 1.000000
d_prime: 1.676482
train_loss: 0.471316
valid_loss: 1.395467
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00018134472957652317
Epoch-23 lr: 0.00018134472957652317
epoch 23 training time: 15.066
---------------
2023-09-24 12:03:01.169035
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01371	Per Sample Data Time 0.00800	Per Sample DNN Time 0.00571	Train Loss 0.3908	
start validation
acc: 0.704225
AUC: 0.882163
Avg Precision: 0.429678
Avg Recall: 1.000000
d_prime: 1.677073
train_loss: 0.456780
valid_loss: 1.395806
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00014952233123414091
Epoch-24 lr: 0.00014952233123414091
epoch 24 training time: 15.091
---------------
2023-09-24 12:03:16.259877
current #epochs=25, #steps=936
start validation
acc: 0.708920
AUC: 0.883048
Avg Precision: 0.426983
Avg Recall: 1.000000
d_prime: 1.683426
train_loss: 0.486195
valid_loss: 1.394936
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00012328413177432909
Epoch-25 lr: 0.00012328413177432909
epoch 25 training time: 15.064
---------------
2023-09-24 12:03:31.323582
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00692	Per Sample Data Time 0.00133	Per Sample DNN Time 0.00559	Train Loss 0.4645	
start validation
acc: 0.694836
AUC: 0.883368
Avg Precision: 0.434729
Avg Recall: 1.000000
d_prime: 1.685736
train_loss: 0.473267
valid_loss: 1.395451
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00010165021520129768
Epoch-26 lr: 0.00010165021520129768
epoch 26 training time: 15.089
---------------
2023-09-24 12:03:46.412510
current #epochs=27, #steps=1014
start validation
acc: 0.708920
AUC: 0.883107
Avg Precision: 0.426933
Avg Recall: 1.000000
d_prime: 1.683853
train_loss: 0.478740
valid_loss: 1.395539
validation finished
normal learning rate scheduler step
Epoch-27 lr: 8.381262131434888e-05
Epoch-27 lr: 8.381262131434888e-05
epoch 27 training time: 15.134
---------------
2023-09-24 12:04:01.545851
current #epochs=28, #steps=1053
start validation
acc: 0.704225
AUC: 0.881908
Avg Precision: 0.429895
Avg Recall: 1.000000
d_prime: 1.675245
train_loss: 0.460081
valid_loss: 1.396148
validation finished
normal learning rate scheduler step
Epoch-28 lr: 6.910517088106244e-05
Epoch-28 lr: 6.910517088106244e-05
epoch 28 training time: 16.274
---------------
2023-09-24 12:04:17.820441
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00924	Per Sample Data Time 0.00343	Per Sample DNN Time 0.00582	Train Loss 0.4509	
start validation
acc: 0.690141
AUC: 0.882675
Avg Precision: 0.427159
Avg Recall: 1.000000
d_prime: 1.680747
train_loss: 0.473059
valid_loss: 1.395749
validation finished
normal learning rate scheduler step
Epoch-29 lr: 5.6978585893283144e-05
Epoch-29 lr: 5.6978585893283144e-05
epoch 29 training time: 15.170
---------------
2023-09-24 12:04:32.990518
current #epochs=30, #steps=1131
start validation
acc: 0.699531
AUC: 0.883420
Avg Precision: 0.429318
Avg Recall: 1.000000
d_prime: 1.686107
train_loss: 0.456508
valid_loss: 1.395452
validation finished
normal learning rate scheduler step
Epoch-30 lr: 4.697997572404427e-05
Epoch-30 lr: 4.697997572404427e-05
epoch 30 training time: 15.060
---------------
2023-09-24 12:04:48.050239
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00665	Per Sample Data Time 0.00110	Per Sample DNN Time 0.00555	Train Loss 0.4583	
start validation
acc: 0.694836
AUC: 0.883755
Avg Precision: 0.429946
Avg Recall: 1.000000
d_prime: 1.688525
train_loss: 0.470835
valid_loss: 1.394527
validation finished
normal learning rate scheduler step
Epoch-31 lr: 3.8735923056524513e-05
Epoch-31 lr: 3.8735923056524513e-05
epoch 31 training time: 15.581
---------------
2023-09-24 12:05:03.631009
current #epochs=32, #steps=1209
start validation
acc: 0.694836
AUC: 0.883900
Avg Precision: 0.430068
Avg Recall: 1.000000
d_prime: 1.689573
train_loss: 0.465460
valid_loss: 1.395243
validation finished
normal learning rate scheduler step
Epoch-32 lr: 3.1938537896541495e-05
Epoch-32 lr: 3.1938537896541495e-05
epoch 32 training time: 15.053
---------------
2023-09-24 12:05:18.684442
current #epochs=33, #steps=1248
start validation
acc: 0.699531
AUC: 0.883803
Avg Precision: 0.428701
Avg Recall: 1.000000
d_prime: 1.688875
train_loss: 0.459368
valid_loss: 1.395158
validation finished
normal learning rate scheduler step
Epoch-33 lr: 2.6333958828870634e-05
Epoch-33 lr: 2.6333958828870634e-05
epoch 33 training time: 15.124
---------------
2023-09-24 12:05:33.808278
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00802	Per Sample Data Time 0.00231	Per Sample DNN Time 0.00572	Train Loss 0.4571	
start validation
[I 2023-09-24 12:05:50,051] Trial 12 finished with value: 0.4287012078621047 and parameters: {'warmup': 'False', 'num_epochs': 34, 'batch_size': 24, 'lr-adaptschedule': 'True', 'lr': 0.003277088101328141, 'head-lr': 1, 'lr-scheduler-start': 9, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.8245198610585815}. Best is trial 11 with value: 0.47135951318996194.
acc: 0.694836
AUC: 0.883755
Avg Precision: 0.428701
Avg Recall: 1.000000
d_prime: 1.688524
train_loss: 0.472481
valid_loss: 1.395132
validation finished
normal learning rate scheduler step
Epoch-34 lr: 2.171287207470282e-05
Epoch-34 lr: 2.171287207470282e-05
epoch 34 training time: 16.238
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67ec6af70>
The learning rate scheduler starts at 9 epoch with decay rate of 0.840 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 12:05:50.082033
current #epochs=1, #steps=0
start validation
acc: 0.708920
AUC: 0.869032
Avg Precision: 0.421018
Avg Recall: 1.000000
d_prime: 1.586503
train_loss: 0.584140
valid_loss: 1.399852
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0021683462142702867
Epoch-1 lr: 0.004336692428540573
epoch 1 training time: 17.502
---------------
2023-09-24 12:06:07.584449
current #epochs=2, #steps=39
start validation
acc: 0.708920
AUC: 0.891931
Avg Precision: 0.431558
Avg Recall: 1.000000
d_prime: 1.749188
train_loss: 0.563574
valid_loss: 1.400683
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0021683462142702867
Epoch-2 lr: 0.004336692428540573
epoch 2 training time: 15.064
---------------
2023-09-24 12:06:22.648762
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00561	Train Loss 0.5215	
start validation
acc: 0.727700
AUC: 0.882292
Avg Precision: 0.450346
Avg Recall: 1.000000
d_prime: 1.678000
train_loss: 0.518059
valid_loss: 1.401208
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0021683462142702867
Epoch-3 lr: 0.004336692428540573
epoch 3 training time: 18.720
---------------
2023-09-24 12:06:41.368685
current #epochs=4, #steps=117
start validation
acc: 0.685446
AUC: 0.889841
Avg Precision: 0.415500
Avg Recall: 1.000000
d_prime: 1.733374
train_loss: 0.524494
valid_loss: 1.403511
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0021683462142702867
Epoch-4 lr: 0.004336692428540573
epoch 4 training time: 16.473
---------------
2023-09-24 12:06:57.842145
current #epochs=5, #steps=156
start validation
acc: 0.723005
AUC: 0.901008
Avg Precision: 0.418672
Avg Recall: 1.000000
d_prime: 1.820543
train_loss: 0.522336
valid_loss: 1.387873
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0021683462142702867
Epoch-5 lr: 0.004336692428540573
epoch 5 training time: 15.070
---------------
2023-09-24 12:07:12.911985
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01100	Per Sample Data Time 0.00528	Per Sample DNN Time 0.00571	Train Loss 0.4836	
start validation
acc: 0.741784
AUC: 0.894464
Avg Precision: 0.459259
Avg Recall: 1.000000
d_prime: 1.768645
train_loss: 0.486387
valid_loss: 1.393641
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0021683462142702867
Epoch-6 lr: 0.004336692428540573
epoch 6 training time: 17.518
---------------
2023-09-24 12:07:30.429789
current #epochs=7, #steps=234
start validation
acc: 0.723005
AUC: 0.885047
Avg Precision: 0.456933
Avg Recall: 1.000000
d_prime: 1.697903
train_loss: 0.483132
valid_loss: 1.394743
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0021683462142702867
Epoch-7 lr: 0.004336692428540573
epoch 7 training time: 15.153
---------------
2023-09-24 12:07:45.582710
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00682	Per Sample Data Time 0.00126	Per Sample DNN Time 0.00557	Train Loss 0.4908	
start validation
acc: 0.732394
AUC: 0.888286
Avg Precision: 0.461047
Avg Recall: 1.000000
d_prime: 1.721750
train_loss: 0.508348
valid_loss: 1.391446
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0021683462142702867
Epoch-8 lr: 0.004336692428540573
epoch 8 training time: 15.093
---------------
2023-09-24 12:08:00.675618
current #epochs=9, #steps=312
start validation
acc: 0.727700
AUC: 0.888515
Avg Precision: 0.470911
Avg Recall: 1.000000
d_prime: 1.723457
train_loss: 0.488259
valid_loss: 1.387936
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0018217864845370313
Epoch-9 lr: 0.0036435729690740626
epoch 9 training time: 16.425
---------------
2023-09-24 12:08:17.101133
current #epochs=10, #steps=351
start validation
acc: 0.685446
AUC: 0.877790
Avg Precision: 0.430705
Avg Recall: 1.000000
d_prime: 1.646157
train_loss: 0.475609
valid_loss: 1.403970
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0018217864845370313
Epoch-10 lr: 0.0036435729690740626
epoch 10 training time: 14.952
---------------
2023-09-24 12:08:32.052829
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00866	Per Sample Data Time 0.00297	Per Sample DNN Time 0.00569	Train Loss 0.5039	
start validation
acc: 0.718310
AUC: 0.891838
Avg Precision: 0.469005
Avg Recall: 1.000000
d_prime: 1.748480
train_loss: 0.469931
valid_loss: 1.391361
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0015306162703167337
Epoch-11 lr: 0.0030612325406334673
epoch 11 training time: 15.153
---------------
2023-09-24 12:08:47.206041
current #epochs=12, #steps=429
start validation
acc: 0.694836
AUC: 0.889539
Avg Precision: 0.432540
Avg Recall: 1.000000
d_prime: 1.731110
train_loss: 0.450241
valid_loss: 1.386929
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0015306162703167337
Epoch-12 lr: 0.0030612325406334673
epoch 12 training time: 15.484
---------------
2023-09-24 12:09:02.689381
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00660	Per Sample Data Time 0.00106	Per Sample DNN Time 0.00554	Train Loss 0.4882	
start validation
acc: 0.704225
AUC: 0.891696
Avg Precision: 0.439626
Avg Recall: 1.000000
d_prime: 1.747400
train_loss: 0.478404
valid_loss: 1.392228
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0012859828453243125
Epoch-13 lr: 0.002571965690648625
epoch 13 training time: 15.096
---------------
2023-09-24 12:09:17.784964
current #epochs=14, #steps=507
start validation
acc: 0.676056
AUC: 0.890119
Avg Precision: 0.441026
Avg Recall: 1.000000
d_prime: 1.735470
train_loss: 0.447216
valid_loss: 1.398282
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0012859828453243125
Epoch-14 lr: 0.002571965690648625
epoch 14 training time: 15.024
---------------
2023-09-24 12:09:32.809353
current #epochs=15, #steps=546
start validation
acc: 0.704225
AUC: 0.893686
Avg Precision: 0.476223
Avg Recall: 1.000000
d_prime: 1.762633
train_loss: 0.410219
valid_loss: 1.384206
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.001080448385751316
Epoch-15 lr: 0.002160896771502632
epoch 15 training time: 15.091
---------------
2023-09-24 12:09:47.900829
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00765	Per Sample Data Time 0.00215	Per Sample DNN Time 0.00550	Train Loss 0.3995	
start validation
acc: 0.727700
AUC: 0.892748
Avg Precision: 0.424545
Avg Recall: 1.000000
d_prime: 1.755431
train_loss: 0.425019
valid_loss: 1.392909
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.001080448385751316
Epoch-16 lr: 0.002160896771502632
epoch 16 training time: 15.041
---------------
2023-09-24 12:10:02.941876
current #epochs=17, #steps=624
start validation
acc: 0.694836
AUC: 0.891111
Avg Precision: 0.450569
Avg Recall: 1.000000
d_prime: 1.742959
train_loss: 0.424051
valid_loss: 1.394320
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0009077638310005802
Epoch-17 lr: 0.0018155276620011604
epoch 17 training time: 15.063
---------------
2023-09-24 12:10:18.005121
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00647	Per Sample Data Time 0.00094	Per Sample DNN Time 0.00552	Train Loss 0.3934	
start validation
acc: 0.708920
AUC: 0.899173
Avg Precision: 0.445931
Avg Recall: 1.000000
d_prime: 1.805743
train_loss: 0.395364
valid_loss: 1.386322
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0009077638310005802
Epoch-18 lr: 0.0018155276620011604
epoch 18 training time: 15.941
---------------
2023-09-24 12:10:33.946297
current #epochs=19, #steps=702
start validation
acc: 0.690141
AUC: 0.892694
Avg Precision: 0.436186
Avg Recall: 1.000000
d_prime: 1.755014
train_loss: 0.388861
valid_loss: 1.388289
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.000762678887524865
Epoch-19 lr: 0.00152535777504973
epoch 19 training time: 15.260
---------------
2023-09-24 12:10:49.206221
current #epochs=20, #steps=741
start validation
acc: 0.671362
AUC: 0.884392
Avg Precision: 0.438523
Avg Recall: 1.000000
d_prime: 1.693144
train_loss: 0.381465
valid_loss: 1.393813
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.000762678887524865
Epoch-20 lr: 0.00152535777504973
epoch 20 training time: 15.627
---------------
2023-09-24 12:11:04.832913
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00555	Train Loss 0.4305	
start validation
acc: 0.727700
AUC: 0.892301
Avg Precision: 0.461248
Avg Recall: 1.000000
d_prime: 1.752012
train_loss: 0.402294
valid_loss: 1.382187
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0006407823991345982
Epoch-21 lr: 0.0012815647982691964
epoch 21 training time: 14.995
---------------
2023-09-24 12:11:19.827941
current #epochs=22, #steps=819
start validation
acc: 0.727700
AUC: 0.892636
Avg Precision: 0.446139
Avg Recall: 1.000000
d_prime: 1.754570
train_loss: 0.383142
valid_loss: 1.382081
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0006407823991345982
Epoch-22 lr: 0.0012815647982691964
epoch 22 training time: 15.014
---------------
2023-09-24 12:11:34.841753
current #epochs=23, #steps=858
start validation
acc: 0.723005
AUC: 0.890798
Avg Precision: 0.452688
Avg Recall: 1.000000
d_prime: 1.740594
train_loss: 0.377522
valid_loss: 1.386733
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0005383682304006415
Epoch-23 lr: 0.001076736460801283
epoch 23 training time: 15.193
---------------
2023-09-24 12:11:50.034995
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01358	Per Sample Data Time 0.00768	Per Sample DNN Time 0.00591	Train Loss 0.3434	
start validation
acc: 0.713615
AUC: 0.888810
Avg Precision: 0.456917
Avg Recall: 1.000000
d_prime: 1.725657
train_loss: 0.353447
valid_loss: 1.386985
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0005383682304006415
Epoch-24 lr: 0.001076736460801283
epoch 24 training time: 15.148
---------------
2023-09-24 12:12:05.183185
current #epochs=25, #steps=936
start validation
acc: 0.718310
AUC: 0.888702
Avg Precision: 0.486870
Avg Recall: 1.000000
d_prime: 1.724855
train_loss: 0.363245
valid_loss: 1.387110
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0004523225854770028
Epoch-25 lr: 0.0009046451709540057
epoch 25 training time: 15.183
---------------
2023-09-24 12:12:20.366726
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00690	Per Sample Data Time 0.00133	Per Sample DNN Time 0.00557	Train Loss 0.3327	
start validation
acc: 0.708920
AUC: 0.889132
Avg Precision: 0.449278
Avg Recall: 1.000000
d_prime: 1.728063
train_loss: 0.334775
valid_loss: 1.387195
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0004523225854770028
Epoch-26 lr: 0.0009046451709540057
epoch 26 training time: 15.822
---------------
2023-09-24 12:12:36.188835
current #epochs=27, #steps=1014
start validation
acc: 0.708920
AUC: 0.892478
Avg Precision: 0.472960
Avg Recall: 1.000000
d_prime: 1.753361
train_loss: 0.379696
valid_loss: 1.384675
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0003800293363899742
Epoch-27 lr: 0.0007600586727799484
epoch 27 training time: 15.138
---------------
2023-09-24 12:12:51.327014
current #epochs=28, #steps=1053
start validation
acc: 0.708920
AUC: 0.894032
Avg Precision: 0.453944
Avg Recall: 1.000000
d_prime: 1.765308
train_loss: 0.361557
valid_loss: 1.387200
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0003800293363899742
Epoch-28 lr: 0.0007600586727799484
epoch 28 training time: 14.984
---------------
2023-09-24 12:13:06.310992
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00930	Per Sample Data Time 0.00358	Per Sample DNN Time 0.00571	Train Loss 0.3441	
start validation
acc: 0.723005
AUC: 0.898470
Avg Precision: 0.459742
Avg Recall: 1.000000
d_prime: 1.800124
train_loss: 0.320397
valid_loss: 1.379884
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00031929048239919683
Epoch-29 lr: 0.0006385809647983937
epoch 29 training time: 15.118
---------------
2023-09-24 12:13:21.428563
current #epochs=30, #steps=1131
start validation
acc: 0.704225
AUC: 0.896453
Avg Precision: 0.459629
Avg Recall: 1.000000
d_prime: 1.784169
train_loss: 0.351486
valid_loss: 1.380968
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00031929048239919683
Epoch-30 lr: 0.0006385809647983937
epoch 30 training time: 15.174
---------------
2023-09-24 12:13:36.602972
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00660	Per Sample Data Time 0.00110	Per Sample DNN Time 0.00550	Train Loss 0.3455	
start validation
acc: 0.727700
AUC: 0.895907
Avg Precision: 0.450659
Avg Recall: 1.000000
d_prime: 1.779882
train_loss: 0.340070
valid_loss: 1.382568
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.00026825932208059225
Epoch-31 lr: 0.0005365186441611845
epoch 31 training time: 15.412
---------------
2023-09-24 12:13:52.015160
current #epochs=32, #steps=1209
start validation
[I 2023-09-24 12:14:07,109] Trial 13 finished with value: 0.4636425793450898 and parameters: {'warmup': 'False', 'num_epochs': 32, 'batch_size': 30, 'lr-adaptschedule': 'False', 'lr': 0.0021683462142702867, 'head-lr': 2, 'lr-scheduler-start': 9, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.8401732493397587}. Best is trial 11 with value: 0.47135951318996194.
acc: 0.727700
AUC: 0.891278
Avg Precision: 0.463643
Avg Recall: 1.000000
d_prime: 1.744224
train_loss: 0.319679
valid_loss: 1.384988
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00026825932208059225
Epoch-32 lr: 0.0005365186441611845
epoch 32 training time: 15.089
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa609ecd0d0>
The learning rate scheduler starts at 9 epoch with decay rate of 0.839 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 12:14:07.142534
current #epochs=1, #steps=0
start validation
acc: 0.718310
AUC: 0.887416
Avg Precision: 0.473488
Avg Recall: 1.000000
d_prime: 1.715301
train_loss: 0.513639
valid_loss: 1.398720
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.001988874435279466
Epoch-1 lr: 0.003977748870558932
epoch 1 training time: 17.460
---------------
2023-09-24 12:14:24.602773
current #epochs=2, #steps=39
start validation
acc: 0.723005
AUC: 0.895863
Avg Precision: 0.458981
Avg Recall: 1.000000
d_prime: 1.779542
train_loss: 0.416979
valid_loss: 1.382481
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.001988874435279466
Epoch-2 lr: 0.003977748870558932
epoch 2 training time: 18.493
---------------
2023-09-24 12:14:43.095976
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00703	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00557	Train Loss 0.4201	
start validation
acc: 0.723005
AUC: 0.892662
Avg Precision: 0.482839
Avg Recall: 1.000000
d_prime: 1.754771
train_loss: 0.418869
valid_loss: 1.398431
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.001988874435279466
Epoch-3 lr: 0.003977748870558932
epoch 3 training time: 16.373
---------------
2023-09-24 12:14:59.468912
current #epochs=4, #steps=117
start validation
acc: 0.694836
AUC: 0.897242
Avg Precision: 0.447333
Avg Recall: 1.000000
d_prime: 1.790384
train_loss: 0.429080
valid_loss: 1.394640
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.001988874435279466
Epoch-4 lr: 0.003977748870558932
epoch 4 training time: 15.066
---------------
2023-09-24 12:15:14.534769
current #epochs=5, #steps=156
start validation
acc: 0.718310
AUC: 0.883865
Avg Precision: 0.429745
Avg Recall: 1.000000
d_prime: 1.689320
train_loss: 0.426684
valid_loss: 1.391594
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.001988874435279466
Epoch-5 lr: 0.003977748870558932
epoch 5 training time: 15.054
---------------
2023-09-24 12:15:29.588615
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01085	Per Sample Data Time 0.00513	Per Sample DNN Time 0.00572	Train Loss 0.3928	
start validation
acc: 0.727700
AUC: 0.879075
Avg Precision: 0.448259
Avg Recall: 1.000000
d_prime: 1.655158
train_loss: 0.404069
valid_loss: 1.391531
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.001988874435279466
Epoch-6 lr: 0.003977748870558932
epoch 6 training time: 17.455
---------------
2023-09-24 12:15:47.043683
current #epochs=7, #steps=234
start validation
acc: 0.704225
AUC: 0.888002
Avg Precision: 0.460541
Avg Recall: 1.000000
d_prime: 1.719644
train_loss: 0.428226
valid_loss: 1.388440
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.001988874435279466
Epoch-7 lr: 0.003977748870558932
epoch 7 training time: 15.861
---------------
2023-09-24 12:16:02.905097
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00683	Per Sample Data Time 0.00121	Per Sample DNN Time 0.00561	Train Loss 0.4594	
start validation
acc: 0.727700
AUC: 0.899759
Avg Precision: 0.487775
Avg Recall: 1.000000
d_prime: 1.810447
train_loss: 0.443229
valid_loss: 1.377032
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.001988874435279466
Epoch-8 lr: 0.003977748870558932
epoch 8 training time: 15.095
---------------
2023-09-24 12:16:18.000252
current #epochs=9, #steps=312
start validation
acc: 0.727700
AUC: 0.890003
Avg Precision: 0.468255
Avg Recall: 1.000000
d_prime: 1.734598
train_loss: 0.431969
valid_loss: 1.387287
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0016679923682421534
Epoch-9 lr: 0.003335984736484307
epoch 9 training time: 17.186
---------------
2023-09-24 12:16:35.186378
current #epochs=10, #steps=351
start validation
acc: 0.755869
AUC: 0.893854
Avg Precision: 0.449628
Avg Recall: 1.000000
d_prime: 1.763933
train_loss: 0.401332
valid_loss: 1.386905
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0016679923682421534
Epoch-10 lr: 0.003335984736484307
epoch 10 training time: 17.613
---------------
2023-09-24 12:16:52.799600
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00846	Per Sample Data Time 0.00282	Per Sample DNN Time 0.00564	Train Loss 0.4000	
start validation
acc: 0.741784
AUC: 0.902699
Avg Precision: 0.458487
Avg Recall: 1.000000
d_prime: 1.834359
train_loss: 0.390402
valid_loss: 1.375184
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0013988809404768322
Epoch-11 lr: 0.0027977618809536644
epoch 11 training time: 15.726
---------------
2023-09-24 12:17:08.525225
current #epochs=12, #steps=429
start validation
acc: 0.704225
AUC: 0.901982
Avg Precision: 0.452334
Avg Recall: 1.000000
d_prime: 1.828473
train_loss: 0.371049
valid_loss: 1.371926
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0013988809404768322
Epoch-12 lr: 0.0027977618809536644
epoch 12 training time: 15.039
---------------
2023-09-24 12:17:23.564374
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00661	Per Sample Data Time 0.00107	Per Sample DNN Time 0.00554	Train Loss 0.3840	
start validation
acc: 0.708920
AUC: 0.895676
Avg Precision: 0.464967
Avg Recall: 1.000000
d_prime: 1.778078
train_loss: 0.387416
valid_loss: 1.387955
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0011731875534248578
Epoch-13 lr: 0.0023463751068497156
epoch 13 training time: 15.127
---------------
2023-09-24 12:17:38.691184
current #epochs=14, #steps=507
start validation
acc: 0.732394
AUC: 0.900490
Avg Precision: 0.466962
Avg Recall: 1.000000
d_prime: 1.816347
train_loss: 0.334300
valid_loss: 1.379716
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0011731875534248578
Epoch-14 lr: 0.0023463751068497156
epoch 14 training time: 16.460
---------------
2023-09-24 12:17:55.151282
current #epochs=15, #steps=546
start validation
acc: 0.718310
AUC: 0.894699
Avg Precision: 0.475767
Avg Recall: 1.000000
d_prime: 1.770471
train_loss: 0.347778
valid_loss: 1.381382
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0009839072044557594
Epoch-15 lr: 0.001967814408911519
epoch 15 training time: 16.221
---------------
2023-09-24 12:18:11.372854
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00776	Per Sample Data Time 0.00210	Per Sample DNN Time 0.00566	Train Loss 0.3091	
start validation
acc: 0.680751
AUC: 0.889301
Avg Precision: 0.463549
Avg Recall: 1.000000
d_prime: 1.729327
train_loss: 0.318261
valid_loss: 1.382982
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0009839072044557594
Epoch-16 lr: 0.001967814408911519
epoch 16 training time: 15.186
---------------
2023-09-24 12:18:26.558369
current #epochs=17, #steps=624
start validation
acc: 0.699531
AUC: 0.891985
Avg Precision: 0.452023
Avg Recall: 1.000000
d_prime: 1.749600
train_loss: 0.314575
valid_loss: 1.377198
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0008251650677284075
Epoch-17 lr: 0.001650330135456815
epoch 17 training time: 15.149
---------------
2023-09-24 12:18:41.707445
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00646	Per Sample Data Time 0.00095	Per Sample DNN Time 0.00551	Train Loss 0.3500	
start validation
[I 2023-09-24 12:18:56,792] Trial 14 finished with value: 0.47138807158347623 and parameters: {'warmup': 'False', 'num_epochs': 18, 'batch_size': 32, 'lr-adaptschedule': 'False', 'lr': 0.001988874435279466, 'head-lr': 2, 'lr-scheduler-start': 9, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.8386614753825704}. Best is trial 14 with value: 0.47138807158347623.
acc: 0.661972
AUC: 0.890797
Avg Precision: 0.471388
Avg Recall: 1.000000
d_prime: 1.740586
train_loss: 0.349337
valid_loss: 1.384127
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0008251650677284075
Epoch-18 lr: 0.001650330135456815
epoch 18 training time: 15.079
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67ec6ad60>
The learning rate scheduler starts at 9 epoch with decay rate of 0.812 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 12:18:56.824504
current #epochs=1, #steps=0
start validation
acc: 0.713615
AUC: 0.897386
Avg Precision: 0.449072
Avg Recall: 1.000000
d_prime: 1.791522
train_loss: 0.398988
valid_loss: 1.373955
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0015656476773958053
Epoch-1 lr: 0.0031312953547916107
epoch 1 training time: 18.860
---------------
2023-09-24 12:19:15.684868
current #epochs=2, #steps=39
start validation
acc: 0.690141
AUC: 0.893392
Avg Precision: 0.461751
Avg Recall: 1.000000
d_prime: 1.760369
train_loss: 0.377841
valid_loss: 1.379929
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0015656476773958053
Epoch-2 lr: 0.0031312953547916107
epoch 2 training time: 16.293
---------------
2023-09-24 12:19:31.978105
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00701	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00556	Train Loss 0.3578	
start validation
acc: 0.690141
AUC: 0.891803
Avg Precision: 0.435083
Avg Recall: 1.000000
d_prime: 1.748217
train_loss: 0.341327
valid_loss: 1.380015
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0015656476773958053
Epoch-3 lr: 0.0031312953547916107
epoch 3 training time: 15.517
---------------
2023-09-24 12:19:47.494997
current #epochs=4, #steps=117
start validation
acc: 0.718310
AUC: 0.903506
Avg Precision: 0.452028
Avg Recall: 1.000000
d_prime: 1.841012
train_loss: 0.341226
valid_loss: 1.375337
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0015656476773958053
Epoch-4 lr: 0.0031312953547916107
epoch 4 training time: 17.445
---------------
2023-09-24 12:20:04.939691
current #epochs=5, #steps=156
start validation
acc: 0.708920
AUC: 0.900838
Avg Precision: 0.455933
Avg Recall: 1.000000
d_prime: 1.819159
train_loss: 0.348332
valid_loss: 1.379210
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0015656476773958053
Epoch-5 lr: 0.0031312953547916107
epoch 5 training time: 16.125
---------------
2023-09-24 12:20:21.065491
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01084	Per Sample Data Time 0.00521	Per Sample DNN Time 0.00563	Train Loss 0.3911	
start validation
acc: 0.704225
AUC: 0.893352
Avg Precision: 0.444666
Avg Recall: 1.000000
d_prime: 1.760064
train_loss: 0.361468
valid_loss: 1.384383
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0015656476773958053
Epoch-6 lr: 0.0031312953547916107
epoch 6 training time: 16.589
---------------
2023-09-24 12:20:37.654560
current #epochs=7, #steps=234
start validation
acc: 0.699531
AUC: 0.903839
Avg Precision: 0.454186
Avg Recall: 1.000000
d_prime: 1.843772
train_loss: 0.352767
valid_loss: 1.374456
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0015656476773958053
Epoch-7 lr: 0.0031312953547916107
epoch 7 training time: 15.120
---------------
2023-09-24 12:20:52.774037
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00662	Per Sample Data Time 0.00119	Per Sample DNN Time 0.00543	Train Loss 0.3184	
start validation
acc: 0.708920
AUC: 0.906597
Avg Precision: 0.451218
Avg Recall: 1.000000
d_prime: 1.866885
train_loss: 0.321999
valid_loss: 1.367026
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0015656476773958053
Epoch-8 lr: 0.0031312953547916107
epoch 8 training time: 14.874
---------------
2023-09-24 12:21:07.647942
current #epochs=9, #steps=312
start validation
acc: 0.727700
AUC: 0.910539
Avg Precision: 0.475658
Avg Recall: 1.000000
d_prime: 1.900817
train_loss: 0.336739
valid_loss: 1.369159
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0012716310068673724
Epoch-9 lr: 0.002543262013734745
epoch 9 training time: 20.662
---------------
2023-09-24 12:21:28.310321
current #epochs=10, #steps=351
start validation
acc: 0.727700
AUC: 0.901733
Avg Precision: 0.451432
Avg Recall: 1.000000
d_prime: 1.826442
train_loss: 0.305803
valid_loss: 1.371267
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0012716310068673724
Epoch-10 lr: 0.002543262013734745
epoch 10 training time: 15.162
---------------
2023-09-24 12:21:43.472291
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00857	Per Sample Data Time 0.00288	Per Sample DNN Time 0.00569	Train Loss 0.3406	
start validation
acc: 0.723005
AUC: 0.901783
Avg Precision: 0.431485
Avg Recall: 1.000000
d_prime: 1.826851
train_loss: 0.310616
valid_loss: 1.370985
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0010328284204503874
Epoch-11 lr: 0.0020656568409007747
epoch 11 training time: 16.173
---------------
2023-09-24 12:21:59.645327
current #epochs=12, #steps=429
start validation
acc: 0.694836
AUC: 0.889234
Avg Precision: 0.465017
Avg Recall: 1.000000
d_prime: 1.728828
train_loss: 0.325466
valid_loss: 1.369840
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0010328284204503874
Epoch-12 lr: 0.0020656568409007747
epoch 12 training time: 15.156
---------------
2023-09-24 12:22:14.801131
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00658	Per Sample Data Time 0.00104	Per Sample DNN Time 0.00554	Train Loss 0.3096	
start validation
acc: 0.708920
AUC: 0.893270
Avg Precision: 0.474701
Avg Recall: 1.000000
d_prime: 1.759435
train_loss: 0.306119
valid_loss: 1.373293
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0008388711350456238
Epoch-13 lr: 0.0016777422700912476
epoch 13 training time: 15.114
---------------
2023-09-24 12:22:29.915051
current #epochs=14, #steps=507
start validation
acc: 0.708920
AUC: 0.893821
Avg Precision: 0.444959
Avg Recall: 1.000000
d_prime: 1.763674
train_loss: 0.309100
valid_loss: 1.373492
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0008388711350456238
Epoch-14 lr: 0.0016777422700912476
epoch 14 training time: 14.976
---------------
2023-09-24 12:22:44.891099
current #epochs=15, #steps=546
start validation
acc: 0.704225
AUC: 0.887224
Avg Precision: 0.452869
Avg Recall: 1.000000
d_prime: 1.713880
train_loss: 0.301523
valid_loss: 1.376411
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0006813375457908753
Epoch-15 lr: 0.0013626750915817507
epoch 15 training time: 14.906
---------------
2023-09-24 12:22:59.797045
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00761	Per Sample Data Time 0.00195	Per Sample DNN Time 0.00566	Train Loss 0.2902	
start validation
[I 2023-09-24 12:23:14,829] Trial 15 finished with value: 0.44299445981993096 and parameters: {'warmup': 'False', 'num_epochs': 16, 'batch_size': 39, 'lr-adaptschedule': 'False', 'lr': 0.0015656476773958053, 'head-lr': 2, 'lr-scheduler-start': 9, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.8122076411102396}. Best is trial 14 with value: 0.47138807158347623.
acc: 0.704225
AUC: 0.894752
Avg Precision: 0.442994
Avg Recall: 1.000000
d_prime: 1.770881
train_loss: 0.296858
valid_loss: 1.374093
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0006813375457908753
Epoch-16 lr: 0.0013626750915817507
epoch 16 training time: 15.025
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f539220>
The learning rate scheduler starts at 10 epoch with decay rate of 0.866 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 12:23:14.859721
current #epochs=1, #steps=0
start validation
acc: 0.741784
AUC: 0.896050
Avg Precision: 0.477914
Avg Recall: 1.000000
d_prime: 1.781002
train_loss: 0.505762
valid_loss: 1.394101
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0032764438126830753
Epoch-1 lr: 0.006552887625366151
epoch 1 training time: 19.157
---------------
2023-09-24 12:23:34.017184
current #epochs=2, #steps=39
start validation
acc: 0.751174
AUC: 0.905860
Avg Precision: 0.491462
Avg Recall: 1.000000
d_prime: 1.860660
train_loss: 0.411383
valid_loss: 1.375148
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0032764438126830753
Epoch-2 lr: 0.006552887625366151
epoch 2 training time: 17.471
---------------
2023-09-24 12:23:51.488540
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00693	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00547	Train Loss 0.4055	
start validation
acc: 0.708920
AUC: 0.898291
Avg Precision: 0.439783
Avg Recall: 1.000000
d_prime: 1.798699
train_loss: 0.411598
valid_loss: 1.371323
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0032764438126830753
Epoch-3 lr: 0.006552887625366151
epoch 3 training time: 16.220
---------------
2023-09-24 12:24:07.708628
current #epochs=4, #steps=117
start validation
acc: 0.727700
AUC: 0.887671
Avg Precision: 0.449105
Avg Recall: 1.000000
d_prime: 1.717184
train_loss: 0.429741
valid_loss: 1.378133
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0032764438126830753
Epoch-4 lr: 0.006552887625366151
epoch 4 training time: 15.303
---------------
2023-09-24 12:24:23.011469
current #epochs=5, #steps=156
start validation
acc: 0.727700
AUC: 0.858683
Avg Precision: 0.492288
Avg Recall: 1.000000
d_prime: 1.519462
train_loss: 0.577147
valid_loss: 1.424205
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0032764438126830753
Epoch-5 lr: 0.006552887625366151
epoch 5 training time: 15.835
---------------
2023-09-24 12:24:38.846890
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01106	Per Sample Data Time 0.00510	Per Sample DNN Time 0.00596	Train Loss 0.6317	
start validation
acc: 0.704225
AUC: 0.870942
Avg Precision: 0.458126
Avg Recall: 1.000000
d_prime: 1.599273
train_loss: 0.650807
valid_loss: 1.411763
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0032764438126830753
Epoch-6 lr: 0.006552887625366151
epoch 6 training time: 15.085
---------------
2023-09-24 12:24:53.932116
current #epochs=7, #steps=234
start validation
acc: 0.624413
AUC: 0.891536
Avg Precision: 0.512678
Avg Recall: 1.000000
d_prime: 1.746182
train_loss: 0.570109
valid_loss: 1.384799
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0032764438126830753
Epoch-7 lr: 0.006552887625366151
epoch 7 training time: 15.162
---------------
2023-09-24 12:25:09.094359
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00678	Per Sample Data Time 0.00123	Per Sample DNN Time 0.00556	Train Loss 0.5403	
start validation
acc: 0.727700
AUC: 0.885506
Avg Precision: 0.495978
Avg Recall: 1.000000
d_prime: 1.701257
train_loss: 0.534277
valid_loss: 1.388903
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0032764438126830753
Epoch-8 lr: 0.006552887625366151
epoch 8 training time: 15.125
---------------
2023-09-24 12:25:24.218826
current #epochs=9, #steps=312
start validation
acc: 0.732394
AUC: 0.883988
Avg Precision: 0.467938
Avg Recall: 1.000000
d_prime: 1.690211
train_loss: 0.524642
valid_loss: 1.398725
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0032764438126830753
Epoch-9 lr: 0.006552887625366151
epoch 9 training time: 16.081
---------------
2023-09-24 12:25:40.300453
current #epochs=10, #steps=351
start validation
acc: 0.666667
AUC: 0.883059
Avg Precision: 0.503052
Avg Recall: 1.000000
d_prime: 1.683506
train_loss: 0.534580
valid_loss: 1.381398
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0028375354383473566
Epoch-10 lr: 0.005675070876694713
epoch 10 training time: 14.966
---------------
2023-09-24 12:25:55.266657
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00866	Per Sample Data Time 0.00291	Per Sample DNN Time 0.00575	Train Loss 0.5599	
start validation
acc: 0.713615
AUC: 0.896352
Avg Precision: 0.476328
Avg Recall: 1.000000
d_prime: 1.783371
train_loss: 0.498386
valid_loss: 1.380471
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0028375354383473566
Epoch-11 lr: 0.005675070876694713
epoch 11 training time: 15.159
---------------
2023-09-24 12:26:10.425506
current #epochs=12, #steps=429
start validation
acc: 0.723005
AUC: 0.880417
Avg Precision: 0.472957
Avg Recall: 1.000000
d_prime: 1.664636
train_loss: 0.469433
valid_loss: 1.388055
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.002457422688803467
Epoch-12 lr: 0.004914845377606934
epoch 12 training time: 15.106
---------------
2023-09-24 12:26:25.531688
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00653	Per Sample Data Time 0.00104	Per Sample DNN Time 0.00549	Train Loss 0.4494	
start validation
acc: 0.718310
AUC: 0.886867
Avg Precision: 0.506459
Avg Recall: 1.000000
d_prime: 1.711247
train_loss: 0.452232
valid_loss: 1.377422
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.002457422688803467
Epoch-13 lr: 0.004914845377606934
epoch 13 training time: 15.017
---------------
2023-09-24 12:26:40.547998
current #epochs=14, #steps=507
start validation
acc: 0.737089
AUC: 0.880888
Avg Precision: 0.480205
Avg Recall: 1.000000
d_prime: 1.667979
train_loss: 0.444695
valid_loss: 1.382065
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.002128229374630565
Epoch-14 lr: 0.00425645874926113
epoch 14 training time: 14.882
---------------
2023-09-24 12:26:55.430016
current #epochs=15, #steps=546
start validation
acc: 0.699531
AUC: 0.880730
Avg Precision: 0.495883
Avg Recall: 1.000000
d_prime: 1.666856
train_loss: 0.410023
valid_loss: 1.373931
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.002128229374630565
Epoch-15 lr: 0.00425645874926113
epoch 15 training time: 15.108
---------------
2023-09-24 12:27:10.538345
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00765	Per Sample Data Time 0.00201	Per Sample DNN Time 0.00564	Train Loss 0.3783	
start validation
[I 2023-09-24 12:27:26,387] Trial 16 finished with value: 0.45704861670839597 and parameters: {'warmup': 'False', 'num_epochs': 16, 'batch_size': 27, 'lr-adaptschedule': 'False', 'lr': 0.0032764438126830753, 'head-lr': 2, 'lr-scheduler-start': 10, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.8660412326813878}. Best is trial 14 with value: 0.47138807158347623.
acc: 0.751174
AUC: 0.890609
Avg Precision: 0.457049
Avg Recall: 1.000000
d_prime: 1.739159
train_loss: 0.408264
valid_loss: 1.376253
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0018431343910337936
Epoch-16 lr: 0.0036862687820675873
epoch 16 training time: 15.841
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa6150c6880>
The learning rate scheduler starts at 8 epoch with decay rate of 0.732 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 12:27:26.420322
current #epochs=1, #steps=0
start validation
acc: 0.690141
AUC: 0.888686
Avg Precision: 0.474065
Avg Recall: 1.000000
d_prime: 1.724730
train_loss: 0.514103
valid_loss: 1.389030
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0022768098643053134
Epoch-1 lr: 0.00683042959291594
epoch 1 training time: 17.384
---------------
2023-09-24 12:27:43.804628
current #epochs=2, #steps=39
start validation
acc: 0.713615
AUC: 0.901972
Avg Precision: 0.492377
Avg Recall: 1.000000
d_prime: 1.828395
train_loss: 0.413503
valid_loss: 1.366421
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0022768098643053134
Epoch-2 lr: 0.00683042959291594
epoch 2 training time: 17.486
---------------
2023-09-24 12:28:01.290599
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00557	Train Loss 0.4113	
start validation
acc: 0.699531
AUC: 0.896523
Avg Precision: 0.499718
Avg Recall: 1.000000
d_prime: 1.784720
train_loss: 0.386704
valid_loss: 1.363896
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0022768098643053134
Epoch-3 lr: 0.00683042959291594
epoch 3 training time: 15.169
---------------
2023-09-24 12:28:16.459360
current #epochs=4, #steps=117
start validation
acc: 0.676056
AUC: 0.898350
Avg Precision: 0.493714
Avg Recall: 1.000000
d_prime: 1.799173
train_loss: 0.366200
valid_loss: 1.358346
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0022768098643053134
Epoch-4 lr: 0.00683042959291594
epoch 4 training time: 15.083
---------------
2023-09-24 12:28:31.542684
current #epochs=5, #steps=156
start validation
acc: 0.718310
AUC: 0.885331
Avg Precision: 0.494448
Avg Recall: 1.000000
d_prime: 1.699980
train_loss: 0.400345
valid_loss: 1.372858
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0022768098643053134
Epoch-5 lr: 0.00683042959291594
epoch 5 training time: 17.475
---------------
2023-09-24 12:28:49.017606
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01104	Per Sample Data Time 0.00517	Per Sample DNN Time 0.00587	Train Loss 0.4281	
start validation
acc: 0.708920
AUC: 0.897802
Avg Precision: 0.450416
Avg Recall: 1.000000
d_prime: 1.794815
train_loss: 0.385763
valid_loss: 1.360186
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0022768098643053134
Epoch-6 lr: 0.00683042959291594
epoch 6 training time: 15.111
---------------
2023-09-24 12:29:04.128739
current #epochs=7, #steps=234
start validation
acc: 0.718310
AUC: 0.886011
Avg Precision: 0.447664
Avg Recall: 1.000000
d_prime: 1.704954
train_loss: 0.371872
valid_loss: 1.366149
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0022768098643053134
Epoch-7 lr: 0.00683042959291594
epoch 7 training time: 15.073
---------------
2023-09-24 12:29:19.201586
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00672	Per Sample Data Time 0.00119	Per Sample DNN Time 0.00553	Train Loss 0.3808	
start validation
acc: 0.708920
AUC: 0.885366
Avg Precision: 0.453024
Avg Recall: 1.000000
d_prime: 1.700234
train_loss: 0.382431
valid_loss: 1.371216
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0016661269366477788
Epoch-8 lr: 0.0049983808099433365
epoch 8 training time: 15.086
---------------
2023-09-24 12:29:34.287696
current #epochs=9, #steps=312
start validation
acc: 0.713615
AUC: 0.901086
Avg Precision: 0.442229
Avg Recall: 1.000000
d_prime: 1.821178
train_loss: 0.341349
valid_loss: 1.369701
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0016661269366477788
Epoch-9 lr: 0.0049983808099433365
epoch 9 training time: 15.097
---------------
2023-09-24 12:29:49.384544
current #epochs=10, #steps=351
start validation
acc: 0.713615
AUC: 0.895068
Avg Precision: 0.457430
Avg Recall: 1.000000
d_prime: 1.773340
train_loss: 0.325761
valid_loss: 1.360594
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0016661269366477788
Epoch-10 lr: 0.0049983808099433365
epoch 10 training time: 14.981
---------------
2023-09-24 12:30:04.366226
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00847	Per Sample Data Time 0.00276	Per Sample DNN Time 0.00570	Train Loss 0.3280	
start validation
acc: 0.732394
AUC: 0.902353
Avg Precision: 0.469970
Avg Recall: 1.000000
d_prime: 1.831511
train_loss: 0.347346
valid_loss: 1.366193
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0012192405753961811
Epoch-11 lr: 0.0036577217261885434
epoch 11 training time: 17.391
---------------
2023-09-24 12:30:21.756516
current #epochs=12, #steps=429
start validation
acc: 0.671362
AUC: 0.904621
Avg Precision: 0.456429
Avg Recall: 1.000000
d_prime: 1.850268
train_loss: 0.331772
valid_loss: 1.359028
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0012192405753961811
Epoch-12 lr: 0.0036577217261885434
epoch 12 training time: 15.109
---------------
2023-09-24 12:30:36.865285
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00665	Per Sample Data Time 0.00106	Per Sample DNN Time 0.00559	Train Loss 0.2724	
start validation
acc: 0.718310
AUC: 0.902623
Avg Precision: 0.481976
Avg Recall: 1.000000
d_prime: 1.833727
train_loss: 0.271781
valid_loss: 1.351179
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0012192405753961811
Epoch-13 lr: 0.0036577217261885434
epoch 13 training time: 15.127
---------------
2023-09-24 12:30:51.992865
current #epochs=14, #steps=507
start validation
acc: 0.727700
AUC: 0.903337
Avg Precision: 0.454608
Avg Recall: 1.000000
d_prime: 1.839612
train_loss: 0.281733
valid_loss: 1.354553
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0008922174823506072
Epoch-14 lr: 0.0026766524470518216
epoch 14 training time: 15.178
---------------
2023-09-24 12:31:07.170740
current #epochs=15, #steps=546
start validation
acc: 0.699531
AUC: 0.901127
Avg Precision: 0.457107
Avg Recall: 1.000000
d_prime: 1.821504
train_loss: 0.258938
valid_loss: 1.345912
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0008922174823506072
Epoch-15 lr: 0.0026766524470518216
epoch 15 training time: 15.011
---------------
2023-09-24 12:31:22.182190
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00764	Per Sample Data Time 0.00203	Per Sample DNN Time 0.00560	Train Loss 0.2858	
start validation
acc: 0.718310
AUC: 0.906256
Avg Precision: 0.431731
Avg Recall: 1.000000
d_prime: 1.863996
train_loss: 0.240966
valid_loss: 1.355857
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0008922174823506072
Epoch-16 lr: 0.0026766524470518216
epoch 16 training time: 15.213
---------------
2023-09-24 12:31:37.395946
current #epochs=17, #steps=624
start validation
acc: 0.708920
AUC: 0.903118
Avg Precision: 0.454570
Avg Recall: 1.000000
d_prime: 1.837804
train_loss: 0.264537
valid_loss: 1.354059
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0006529080903933879
Epoch-17 lr: 0.0019587242711801636
epoch 17 training time: 15.379
---------------
2023-09-24 12:31:52.775181
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00648	Per Sample Data Time 0.00098	Per Sample DNN Time 0.00550	Train Loss 0.2424	
start validation
acc: 0.690141
AUC: 0.908588
Avg Precision: 0.450949
Avg Recall: 1.000000
d_prime: 1.883890
train_loss: 0.242369
valid_loss: 1.351591
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0006529080903933879
Epoch-18 lr: 0.0019587242711801636
epoch 18 training time: 15.177
---------------
2023-09-24 12:32:07.952725
current #epochs=19, #steps=702
start validation
acc: 0.685446
AUC: 0.902596
Avg Precision: 0.438286
Avg Recall: 1.000000
d_prime: 1.833509
train_loss: 0.235969
valid_loss: 1.349336
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0006529080903933879
Epoch-19 lr: 0.0019587242711801636
epoch 19 training time: 15.069
---------------
2023-09-24 12:32:23.021438
current #epochs=20, #steps=741
start validation
acc: 0.718310
AUC: 0.907820
Avg Precision: 0.445160
Avg Recall: 1.000000
d_prime: 1.877299
train_loss: 0.212300
valid_loss: 1.347471
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00047778594673806804
Epoch-20 lr: 0.001433357840214204
epoch 20 training time: 15.069
---------------
2023-09-24 12:32:38.090915
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00704	Per Sample Data Time 0.00157	Per Sample DNN Time 0.00547	Train Loss 0.1937	
start validation
acc: 0.694836
AUC: 0.903295
Avg Precision: 0.434258
Avg Recall: 1.000000
d_prime: 1.839264
train_loss: 0.219697
valid_loss: 1.352840
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00047778594673806804
Epoch-21 lr: 0.001433357840214204
epoch 21 training time: 14.973
---------------
2023-09-24 12:32:53.064435
current #epochs=22, #steps=819
start validation
acc: 0.699531
AUC: 0.900776
Avg Precision: 0.446459
Avg Recall: 1.000000
d_prime: 1.818661
train_loss: 0.188696
valid_loss: 1.354105
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00047778594673806804
Epoch-22 lr: 0.001433357840214204
epoch 22 training time: 15.253
---------------
2023-09-24 12:33:08.316672
current #epochs=23, #steps=858
start validation
acc: 0.727700
AUC: 0.903185
Avg Precision: 0.440874
Avg Recall: 1.000000
d_prime: 1.838354
train_loss: 0.197584
valid_loss: 1.354425
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0003496348326191668
Epoch-23 lr: 0.0010489044978575003
epoch 23 training time: 15.150
---------------
2023-09-24 12:33:23.466727
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01358	Per Sample Data Time 0.00770	Per Sample DNN Time 0.00588	Train Loss 0.1787	
start validation
acc: 0.732394
AUC: 0.894530
Avg Precision: 0.441386
Avg Recall: 1.000000
d_prime: 1.769160
train_loss: 0.209483
valid_loss: 1.356418
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0003496348326191668
Epoch-24 lr: 0.0010489044978575003
epoch 24 training time: 15.102
---------------
2023-09-24 12:33:38.569048
current #epochs=25, #steps=936
start validation
acc: 0.713615
AUC: 0.900864
Avg Precision: 0.446286
Avg Recall: 1.000000
d_prime: 1.819370
train_loss: 0.189702
valid_loss: 1.351610
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0003496348326191668
Epoch-25 lr: 0.0010489044978575003
epoch 25 training time: 15.141
---------------
2023-09-24 12:33:53.710335
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00684	Per Sample Data Time 0.00132	Per Sample DNN Time 0.00552	Train Loss 0.1958	
start validation
[I 2023-09-24 12:34:08,770] Trial 17 finished with value: 0.446162957951383 and parameters: {'warmup': 'False', 'num_epochs': 26, 'batch_size': 9, 'lr-adaptschedule': 'False', 'lr': 0.0022768098643053134, 'head-lr': 3, 'lr-scheduler-start': 8, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.7317813238463535}. Best is trial 14 with value: 0.47138807158347623.
acc: 0.723005
AUC: 0.899871
Avg Precision: 0.446163
Avg Recall: 1.000000
d_prime: 1.811351
train_loss: 0.198877
valid_loss: 1.350261
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0002558562406768521
Epoch-26 lr: 0.0007675687220305563
epoch 26 training time: 15.055
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa6150c67f0>
The learning rate scheduler starts at 8 epoch with decay rate of 0.824 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 12:34:08.806833
current #epochs=1, #steps=0
start validation
acc: 0.718310
AUC: 0.902402
Avg Precision: 0.404075
Avg Recall: 1.000000
d_prime: 1.831912
train_loss: 0.286738
valid_loss: 1.351670
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0011727588836569175
Epoch-1 lr: 0.00469103553462767
epoch 1 training time: 17.462
---------------
2023-09-24 12:34:26.269237
current #epochs=2, #steps=39
start validation
acc: 0.732394
AUC: 0.898279
Avg Precision: 0.459457
Avg Recall: 1.000000
d_prime: 1.798606
train_loss: 0.256584
valid_loss: 1.357721
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0011727588836569175
Epoch-2 lr: 0.00469103553462767
epoch 2 training time: 17.572
---------------
2023-09-24 12:34:43.841451
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00561	Train Loss 0.2076	
start validation
acc: 0.713615
AUC: 0.902776
Avg Precision: 0.477723
Avg Recall: 1.000000
d_prime: 1.834991
train_loss: 0.212404
valid_loss: 1.344722
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0011727588836569175
Epoch-3 lr: 0.00469103553462767
epoch 3 training time: 15.188
---------------
2023-09-24 12:34:59.029787
current #epochs=4, #steps=117
start validation
acc: 0.741784
AUC: 0.908554
Avg Precision: 0.483154
Avg Recall: 1.000000
d_prime: 1.883597
train_loss: 0.227220
valid_loss: 1.341362
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0011727588836569175
Epoch-4 lr: 0.00469103553462767
epoch 4 training time: 17.437
---------------
2023-09-24 12:35:16.466714
current #epochs=5, #steps=156
start validation
acc: 0.676056
AUC: 0.880822
Avg Precision: 0.440970
Avg Recall: 1.000000
d_prime: 1.667510
train_loss: 0.263977
valid_loss: 1.368408
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0011727588836569175
Epoch-5 lr: 0.00469103553462767
epoch 5 training time: 15.112
---------------
2023-09-24 12:35:31.578590
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01133	Per Sample Data Time 0.00532	Per Sample DNN Time 0.00602	Train Loss 0.2648	
start validation
acc: 0.727700
AUC: 0.903427
Avg Precision: 0.447476
Avg Recall: 1.000000
d_prime: 1.840353
train_loss: 0.246668
valid_loss: 1.348052
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0011727588836569175
Epoch-6 lr: 0.00469103553462767
epoch 6 training time: 15.217
---------------
2023-09-24 12:35:46.795757
current #epochs=7, #steps=234
start validation
acc: 0.723005
AUC: 0.915062
Avg Precision: 0.495271
Avg Recall: 1.000000
d_prime: 1.941154
train_loss: 0.210453
valid_loss: 1.339099
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0011727588836569175
Epoch-7 lr: 0.00469103553462767
epoch 7 training time: 15.193
---------------
2023-09-24 12:36:01.988707
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00681	Per Sample Data Time 0.00126	Per Sample DNN Time 0.00555	Train Loss 0.1901	
start validation
acc: 0.727700
AUC: 0.909294
Avg Precision: 0.463367
Avg Recall: 1.000000
d_prime: 1.889986
train_loss: 0.218914
valid_loss: 1.363284
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0009665622495677156
Epoch-8 lr: 0.0038662489982708623
epoch 8 training time: 15.120
---------------
2023-09-24 12:36:17.108315
current #epochs=9, #steps=312
start validation
acc: 0.727700
AUC: 0.901007
Avg Precision: 0.448548
Avg Recall: 1.000000
d_prime: 1.820532
train_loss: 0.218334
valid_loss: 1.353108
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0007966194887189694
Epoch-9 lr: 0.0031864779548758776
epoch 9 training time: 15.531
---------------
2023-09-24 12:36:32.638875
current #epochs=10, #steps=351
start validation
[I 2023-09-24 12:36:47,653] Trial 18 finished with value: 0.45057632002712095 and parameters: {'warmup': 'False', 'num_epochs': 10, 'batch_size': 36, 'lr-adaptschedule': 'False', 'lr': 0.0011727588836569175, 'head-lr': 4, 'lr-scheduler-start': 8, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.8241781520799605}. Best is trial 14 with value: 0.47138807158347623.
acc: 0.732394
AUC: 0.893296
Avg Precision: 0.450576
Avg Recall: 1.000000
d_prime: 1.759635
train_loss: 0.236416
valid_loss: 1.356047
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0006565563781232831
Epoch-10 lr: 0.0026262255124931324
epoch 10 training time: 15.008
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f492eb0>
The learning rate scheduler starts at 8 epoch with decay rate of 0.795 every 6 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 12:36:47.684312
current #epochs=1, #steps=0
start validation
acc: 0.751174
AUC: 0.909302
Avg Precision: 0.499849
Avg Recall: 1.000000
d_prime: 1.890050
train_loss: 0.313866
valid_loss: 1.343329
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0020413357566955734
Epoch-1 lr: 0.0020413357566955734
epoch 1 training time: 18.081
---------------
2023-09-24 12:37:05.765997
current #epochs=2, #steps=39
start validation
acc: 0.723005
AUC: 0.915642
Avg Precision: 0.504368
Avg Recall: 1.000000
d_prime: 1.946444
train_loss: 0.316680
valid_loss: 1.353057
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0020413357566955734
Epoch-2 lr: 0.0020413357566955734
epoch 2 training time: 15.118
---------------
2023-09-24 12:37:20.884141
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00556	Train Loss 0.2669	
start validation
acc: 0.699531
AUC: 0.911494
Avg Precision: 0.496629
Avg Recall: 1.000000
d_prime: 1.909202
train_loss: 0.281702
valid_loss: 1.360468
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0020413357566955734
Epoch-3 lr: 0.0020413357566955734
epoch 3 training time: 15.118
---------------
2023-09-24 12:37:36.002456
current #epochs=4, #steps=117
start validation
acc: 0.708920
AUC: 0.903053
Avg Precision: 0.488563
Avg Recall: 1.000000
d_prime: 1.837268
train_loss: 0.282247
valid_loss: 1.346701
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0020413357566955734
Epoch-4 lr: 0.0020413357566955734
epoch 4 training time: 15.839
---------------
2023-09-24 12:37:51.841180
current #epochs=5, #steps=156
start validation
acc: 0.690141
AUC: 0.905821
Avg Precision: 0.477213
Avg Recall: 1.000000
d_prime: 1.860327
train_loss: 0.306667
valid_loss: 1.364277
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0020413357566955734
Epoch-5 lr: 0.0020413357566955734
epoch 5 training time: 15.029
---------------
2023-09-24 12:38:06.870062
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01072	Per Sample Data Time 0.00516	Per Sample DNN Time 0.00556	Train Loss 0.3119	
start validation
acc: 0.708920
AUC: 0.897713
Avg Precision: 0.476173
Avg Recall: 1.000000
d_prime: 1.794107
train_loss: 0.270676
valid_loss: 1.350190
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0020413357566955734
Epoch-6 lr: 0.0020413357566955734
epoch 6 training time: 16.523
---------------
2023-09-24 12:38:23.393541
current #epochs=7, #steps=234
start validation
acc: 0.694836
AUC: 0.919053
Avg Precision: 0.490897
Avg Recall: 1.000000
d_prime: 1.978101
train_loss: 0.244117
valid_loss: 1.335463
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0020413357566955734
Epoch-7 lr: 0.0020413357566955734
epoch 7 training time: 15.172
---------------
2023-09-24 12:38:38.565907
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00682	Per Sample Data Time 0.00125	Per Sample DNN Time 0.00557	Train Loss 0.2617	
start validation
acc: 0.680751
AUC: 0.912679
Avg Precision: 0.458956
Avg Recall: 1.000000
d_prime: 1.919703
train_loss: 0.272586
valid_loss: 1.346500
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00162206999774817
Epoch-8 lr: 0.00162206999774817
epoch 8 training time: 15.154
---------------
2023-09-24 12:38:53.719840
current #epochs=9, #steps=312
start validation
acc: 0.704225
AUC: 0.914961
Avg Precision: 0.487906
Avg Recall: 1.000000
d_prime: 1.940237
train_loss: 0.221303
valid_loss: 1.337770
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00162206999774817
Epoch-9 lr: 0.00162206999774817
epoch 9 training time: 15.077
---------------
2023-09-24 12:39:08.796742
current #epochs=10, #steps=351
start validation
acc: 0.704225
AUC: 0.895912
Avg Precision: 0.459269
Avg Recall: 1.000000
d_prime: 1.779923
train_loss: 0.257772
valid_loss: 1.353764
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00162206999774817
Epoch-10 lr: 0.00162206999774817
epoch 10 training time: 16.217
---------------
2023-09-24 12:39:25.013155
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00864	Per Sample Data Time 0.00292	Per Sample DNN Time 0.00571	Train Loss 0.2669	
start validation
acc: 0.723005
AUC: 0.900569
Avg Precision: 0.487876
Avg Recall: 1.000000
d_prime: 1.816986
train_loss: 0.274305
valid_loss: 1.341883
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00162206999774817
Epoch-11 lr: 0.00162206999774817
epoch 11 training time: 16.343
---------------
2023-09-24 12:39:41.356612
current #epochs=12, #steps=429
start validation
acc: 0.708920
AUC: 0.901849
Avg Precision: 0.452994
Avg Recall: 1.000000
d_prime: 1.827389
train_loss: 0.268655
valid_loss: 1.351223
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00162206999774817
Epoch-12 lr: 0.00162206999774817
epoch 12 training time: 15.102
---------------
2023-09-24 12:39:56.458382
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00662	Per Sample Data Time 0.00110	Per Sample DNN Time 0.00553	Train Loss 0.2467	
start validation
acc: 0.737089
AUC: 0.906391
Avg Precision: 0.478312
Avg Recall: 1.000000
d_prime: 1.865140
train_loss: 0.237404
valid_loss: 1.343318
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00162206999774817
Epoch-13 lr: 0.00162206999774817
epoch 13 training time: 15.090
---------------
2023-09-24 12:40:11.548611
current #epochs=14, #steps=507
start validation
acc: 0.737089
AUC: 0.915108
Avg Precision: 0.493961
Avg Recall: 1.000000
d_prime: 1.941572
train_loss: 0.228933
valid_loss: 1.340377
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0012889163720199942
Epoch-14 lr: 0.0012889163720199942
epoch 14 training time: 15.022
---------------
2023-09-24 12:40:26.570631
current #epochs=15, #steps=546
start validation
acc: 0.718310
AUC: 0.907146
Avg Precision: 0.469521
Avg Recall: 1.000000
d_prime: 1.871546
train_loss: 0.178983
valid_loss: 1.343151
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0012889163720199942
Epoch-15 lr: 0.0012889163720199942
epoch 15 training time: 15.177
---------------
2023-09-24 12:40:41.747748
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00767	Per Sample Data Time 0.00206	Per Sample DNN Time 0.00561	Train Loss 0.1822	
start validation
acc: 0.657277
AUC: 0.903313
Avg Precision: 0.471063
Avg Recall: 1.000000
d_prime: 1.839412
train_loss: 0.201092
valid_loss: 1.355542
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0012889163720199942
Epoch-16 lr: 0.0012889163720199942
epoch 16 training time: 15.100
---------------
2023-09-24 12:40:56.847405
current #epochs=17, #steps=624
start validation
acc: 0.732394
AUC: 0.916942
Avg Precision: 0.485429
Avg Recall: 1.000000
d_prime: 1.958390
train_loss: 0.187549
valid_loss: 1.331764
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0012889163720199942
Epoch-17 lr: 0.0012889163720199942
epoch 17 training time: 15.030
---------------
2023-09-24 12:41:11.877268
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00648	Per Sample Data Time 0.00097	Per Sample DNN Time 0.00551	Train Loss 0.1956	
start validation
acc: 0.704225
AUC: 0.903634
Avg Precision: 0.478707
Avg Recall: 1.000000
d_prime: 1.842072
train_loss: 0.193189
valid_loss: 1.338718
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0012889163720199942
Epoch-18 lr: 0.0012889163720199942
epoch 18 training time: 15.178
---------------
2023-09-24 12:41:27.055299
current #epochs=19, #steps=702
start validation
acc: 0.694836
AUC: 0.901444
Avg Precision: 0.471040
Avg Recall: 1.000000
d_prime: 1.824086
train_loss: 0.231651
valid_loss: 1.330698
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0012889163720199942
Epoch-19 lr: 0.0012889163720199942
epoch 19 training time: 15.171
---------------
2023-09-24 12:41:42.226343
current #epochs=20, #steps=741
start validation
acc: 0.723005
AUC: 0.903893
Avg Precision: 0.433763
Avg Recall: 1.000000
d_prime: 1.844219
train_loss: 0.216802
valid_loss: 1.342046
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0010241884853104258
Epoch-20 lr: 0.0010241884853104258
epoch 20 training time: 15.834
---------------
2023-09-24 12:41:58.059940
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00161	Per Sample DNN Time 0.00560	Train Loss 0.1818	
start validation
acc: 0.704225
AUC: 0.909761
Avg Precision: 0.466405
Avg Recall: 1.000000
d_prime: 1.894034
train_loss: 0.178917
valid_loss: 1.336477
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0010241884853104258
Epoch-21 lr: 0.0010241884853104258
epoch 21 training time: 15.118
---------------
2023-09-24 12:42:13.177548
current #epochs=22, #steps=819
start validation
acc: 0.676056
AUC: 0.896920
Avg Precision: 0.458578
Avg Recall: 1.000000
d_prime: 1.787838
train_loss: 0.194539
valid_loss: 1.348928
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0010241884853104258
Epoch-22 lr: 0.0010241884853104258
epoch 22 training time: 18.395
---------------
2023-09-24 12:42:31.572981
current #epochs=23, #steps=858
start validation
acc: 0.723005
AUC: 0.906745
Avg Precision: 0.459452
Avg Recall: 1.000000
d_prime: 1.868141
train_loss: 0.199397
valid_loss: 1.343431
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0010241884853104258
Epoch-23 lr: 0.0010241884853104258
epoch 23 training time: 14.926
---------------
2023-09-24 12:42:46.499127
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01348	Per Sample Data Time 0.00759	Per Sample DNN Time 0.00588	Train Loss 0.1598	
start validation
acc: 0.708920
AUC: 0.908124
Avg Precision: 0.459617
Avg Recall: 1.000000
d_prime: 1.879905
train_loss: 0.189468
valid_loss: 1.334476
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0010241884853104258
Epoch-24 lr: 0.0010241884853104258
epoch 24 training time: 15.041
---------------
2023-09-24 12:43:01.540120
current #epochs=25, #steps=936
start validation
acc: 0.704225
AUC: 0.913254
Avg Precision: 0.475230
Avg Recall: 1.000000
d_prime: 1.924845
train_loss: 0.206570
valid_loss: 1.338750
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0010241884853104258
Epoch-25 lr: 0.0010241884853104258
epoch 25 training time: 15.785
---------------
2023-09-24 12:43:17.324916
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00690	Per Sample Data Time 0.00137	Per Sample DNN Time 0.00552	Train Loss 0.1739	
start validation
[I 2023-09-24 12:43:32,519] Trial 19 finished with value: 0.45303137060000437 and parameters: {'warmup': 'False', 'num_epochs': 26, 'batch_size': 44, 'lr-adaptschedule': 'False', 'lr': 0.0020413357566955734, 'head-lr': 1, 'lr-scheduler-start': 8, 'lr-scheduler-step': 6, 'lr-scheduler-decay': 0.7946120536162592}. Best is trial 14 with value: 0.47138807158347623.
acc: 0.746479
AUC: 0.901720
Avg Precision: 0.453031
Avg Recall: 1.000000
d_prime: 1.826336
train_loss: 0.191359
valid_loss: 1.349530
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0008138325156026434
Epoch-26 lr: 0.0008138325156026434
epoch 26 training time: 15.188
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa63ceaee80>
The learning rate scheduler starts at 10 epoch with decay rate of 0.721 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 12:43:32.550954
current #epochs=1, #steps=0
start validation
acc: 0.699531
AUC: 0.897215
Avg Precision: 0.475134
Avg Recall: 1.000000
d_prime: 1.790173
train_loss: 0.382197
valid_loss: 1.374994
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.003395942448770041
Epoch-1 lr: 0.006791884897540082
epoch 1 training time: 17.934
---------------
2023-09-24 12:43:50.485834
current #epochs=2, #steps=39
start validation
acc: 0.713615
AUC: 0.917415
Avg Precision: 0.462250
Avg Recall: 1.000000
d_prime: 1.962778
train_loss: 0.339914
valid_loss: 1.348634
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.003395942448770041
Epoch-2 lr: 0.006791884897540082
epoch 2 training time: 18.150
---------------
2023-09-24 12:44:08.635831
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00563	Train Loss 0.3283	
start validation
acc: 0.732394
AUC: 0.910598
Avg Precision: 0.479460
Avg Recall: 1.000000
d_prime: 1.901331
train_loss: 0.339492
valid_loss: 1.363994
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.003395942448770041
Epoch-3 lr: 0.006791884897540082
epoch 3 training time: 18.093
---------------
2023-09-24 12:44:26.728872
current #epochs=4, #steps=117
start validation
acc: 0.704225
AUC: 0.905235
Avg Precision: 0.473920
Avg Recall: 1.000000
d_prime: 1.855407
train_loss: 0.349493
valid_loss: 1.349019
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.003395942448770041
Epoch-4 lr: 0.006791884897540082
epoch 4 training time: 16.075
---------------
2023-09-24 12:44:42.803398
current #epochs=5, #steps=156
start validation
acc: 0.638498
AUC: 0.891797
Avg Precision: 0.462514
Avg Recall: 1.000000
d_prime: 1.748167
train_loss: 0.292487
valid_loss: 1.363940
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.003395942448770041
Epoch-5 lr: 0.006791884897540082
epoch 5 training time: 15.095
---------------
2023-09-24 12:44:57.898897
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01091	Per Sample Data Time 0.00505	Per Sample DNN Time 0.00586	Train Loss 0.3093	
start validation
acc: 0.727700
AUC: 0.905112
Avg Precision: 0.492408
Avg Recall: 1.000000
d_prime: 1.854375
train_loss: 0.325503
valid_loss: 1.354202
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.003395942448770041
Epoch-6 lr: 0.006791884897540082
epoch 6 training time: 14.963
---------------
2023-09-24 12:45:12.861761
current #epochs=7, #steps=234
start validation
acc: 0.741784
AUC: 0.904114
Avg Precision: 0.418110
Avg Recall: 1.000000
d_prime: 1.846049
train_loss: 0.330164
valid_loss: 1.355443
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.003395942448770041
Epoch-7 lr: 0.006791884897540082
epoch 7 training time: 17.452
---------------
2023-09-24 12:45:30.313403
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00680	Per Sample Data Time 0.00122	Per Sample DNN Time 0.00558	Train Loss 0.2850	
start validation
acc: 0.708920
AUC: 0.913643
Avg Precision: 0.447731
Avg Recall: 1.000000
d_prime: 1.928334
train_loss: 0.294518
valid_loss: 1.354464
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.003395942448770041
Epoch-8 lr: 0.006791884897540082
epoch 8 training time: 15.179
---------------
2023-09-24 12:45:45.492400
current #epochs=9, #steps=312
start validation
acc: 0.741784
AUC: 0.914594
Avg Precision: 0.455450
Avg Recall: 1.000000
d_prime: 1.936905
train_loss: 0.257416
valid_loss: 1.354785
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.003395942448770041
Epoch-9 lr: 0.006791884897540082
epoch 9 training time: 16.007
---------------
2023-09-24 12:46:01.499681
current #epochs=10, #steps=351
start validation
acc: 0.699531
AUC: 0.905725
Avg Precision: 0.462907
Avg Recall: 1.000000
d_prime: 1.859518
train_loss: 0.239499
valid_loss: 1.335422
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0024472010944226728
Epoch-10 lr: 0.0048944021888453456
epoch 10 training time: 15.397
---------------
2023-09-24 12:46:16.896667
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00873	Per Sample Data Time 0.00278	Per Sample DNN Time 0.00595	Train Loss 0.2898	
start validation
acc: 0.727700
AUC: 0.917806
Avg Precision: 0.475490
Avg Recall: 1.000000
d_prime: 1.966416
train_loss: 0.248984
valid_loss: 1.334552
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0024472010944226728
Epoch-11 lr: 0.0048944021888453456
epoch 11 training time: 15.368
---------------
2023-09-24 12:46:32.265019
current #epochs=12, #steps=429
start validation
acc: 0.723005
AUC: 0.914337
Avg Precision: 0.441093
Avg Recall: 1.000000
d_prime: 1.934583
train_loss: 0.219151
valid_loss: 1.344304
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0024472010944226728
Epoch-12 lr: 0.0048944021888453456
epoch 12 training time: 15.046
---------------
2023-09-24 12:46:47.310977
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00653	Per Sample Data Time 0.00102	Per Sample DNN Time 0.00550	Train Loss 0.2189	
start validation
acc: 0.746479
AUC: 0.906035
Avg Precision: 0.461022
Avg Recall: 1.000000
d_prime: 1.862131
train_loss: 0.217038
valid_loss: 1.343734
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0017635143371503772
Epoch-13 lr: 0.0035270286743007543
epoch 13 training time: 17.694
---------------
2023-09-24 12:47:05.004773
current #epochs=14, #steps=507
start validation
acc: 0.718310
AUC: 0.901818
Avg Precision: 0.457494
Avg Recall: 1.000000
d_prime: 1.827138
train_loss: 0.232923
valid_loss: 1.345831
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0017635143371503772
Epoch-14 lr: 0.0035270286743007543
epoch 14 training time: 15.134
---------------
2023-09-24 12:47:20.138317
current #epochs=15, #steps=546
start validation
acc: 0.718310
AUC: 0.907535
Avg Precision: 0.469269
Avg Recall: 1.000000
d_prime: 1.874860
train_loss: 0.225919
valid_loss: 1.356360
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0017635143371503772
Epoch-15 lr: 0.0035270286743007543
epoch 15 training time: 15.158
---------------
2023-09-24 12:47:35.296617
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00759	Per Sample Data Time 0.00206	Per Sample DNN Time 0.00552	Train Loss 0.1444	
start validation
acc: 0.661972
AUC: 0.900627
Avg Precision: 0.470303
Avg Recall: 1.000000
d_prime: 1.817451
train_loss: 0.167086
valid_loss: 1.355537
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0012708325541463605
Epoch-16 lr: 0.002541665108292721
epoch 16 training time: 15.811
---------------
2023-09-24 12:47:51.107415
current #epochs=17, #steps=624
start validation
acc: 0.713615
AUC: 0.912251
Avg Precision: 0.471076
Avg Recall: 1.000000
d_prime: 1.915906
train_loss: 0.177704
valid_loss: 1.341938
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0012708325541463605
Epoch-17 lr: 0.002541665108292721
epoch 17 training time: 15.034
---------------
2023-09-24 12:48:06.141936
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00650	Per Sample Data Time 0.00094	Per Sample DNN Time 0.00556	Train Loss 0.1681	
start validation
acc: 0.741784
AUC: 0.911503
Avg Precision: 0.470129
Avg Recall: 1.000000
d_prime: 1.909289
train_loss: 0.168516
valid_loss: 1.338057
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0012708325541463605
Epoch-18 lr: 0.002541665108292721
epoch 18 training time: 16.311
---------------
2023-09-24 12:48:22.452806
current #epochs=19, #steps=702
start validation
acc: 0.732394
AUC: 0.911196
Avg Precision: 0.486622
Avg Recall: 1.000000
d_prime: 1.906581
train_loss: 0.167643
valid_loss: 1.340768
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.000915793734508464
Epoch-19 lr: 0.001831587469016928
epoch 19 training time: 15.116
---------------
2023-09-24 12:48:37.568571
current #epochs=20, #steps=741
start validation
acc: 0.704225
AUC: 0.914029
Avg Precision: 0.491180
Avg Recall: 1.000000
d_prime: 1.931805
train_loss: 0.136318
valid_loss: 1.346003
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.000915793734508464
Epoch-20 lr: 0.001831587469016928
epoch 20 training time: 14.986
---------------
2023-09-24 12:48:52.554909
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00548	Train Loss 0.1410	
start validation
acc: 0.718310
AUC: 0.912304
Avg Precision: 0.463866
Avg Recall: 1.000000
d_prime: 1.916370
train_loss: 0.150578
valid_loss: 1.337679
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.000915793734508464
Epoch-21 lr: 0.001831587469016928
epoch 21 training time: 14.978
---------------
2023-09-24 12:49:07.533234
current #epochs=22, #steps=819
start validation
acc: 0.723005
AUC: 0.907028
Avg Precision: 0.449537
Avg Recall: 1.000000
d_prime: 1.870547
train_loss: 0.133849
valid_loss: 1.346128
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0006599438780731528
Epoch-22 lr: 0.0013198877561463056
epoch 22 training time: 16.173
---------------
2023-09-24 12:49:23.706302
current #epochs=23, #steps=858
start validation
acc: 0.713615
AUC: 0.909925
Avg Precision: 0.461346
Avg Recall: 1.000000
d_prime: 1.895457
train_loss: 0.140270
valid_loss: 1.336035
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0006599438780731528
Epoch-23 lr: 0.0013198877561463056
epoch 23 training time: 15.239
---------------
2023-09-24 12:49:38.945917
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01363	Per Sample Data Time 0.00777	Per Sample DNN Time 0.00586	Train Loss 0.1899	
start validation
acc: 0.718310
AUC: 0.910718
Avg Precision: 0.483365
Avg Recall: 1.000000
d_prime: 1.902387
train_loss: 0.135963
valid_loss: 1.339109
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0006599438780731528
Epoch-24 lr: 0.0013198877561463056
epoch 24 training time: 15.065
---------------
2023-09-24 12:49:54.010949
current #epochs=25, #steps=936
start validation
acc: 0.718310
AUC: 0.910504
Avg Precision: 0.483829
Avg Recall: 1.000000
d_prime: 1.900508
train_loss: 0.133868
valid_loss: 1.339002
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0004755720702107589
Epoch-25 lr: 0.0009511441404215179
epoch 25 training time: 15.044
---------------
2023-09-24 12:50:09.055491
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00688	Per Sample Data Time 0.00131	Per Sample DNN Time 0.00558	Train Loss 0.1215	
start validation
acc: 0.708920
AUC: 0.908300
Avg Precision: 0.463141
Avg Recall: 1.000000
d_prime: 1.881414
train_loss: 0.118208
valid_loss: 1.345462
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0004755720702107589
Epoch-26 lr: 0.0009511441404215179
epoch 26 training time: 15.571
---------------
2023-09-24 12:50:24.626317
current #epochs=27, #steps=1014
start validation
acc: 0.723005
AUC: 0.905328
Avg Precision: 0.465949
Avg Recall: 1.000000
d_prime: 1.856185
train_loss: 0.131860
valid_loss: 1.346387
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0004755720702107589
Epoch-27 lr: 0.0009511441404215179
epoch 27 training time: 15.767
---------------
2023-09-24 12:50:40.392914
current #epochs=28, #steps=1053
start validation
acc: 0.704225
AUC: 0.911592
Avg Precision: 0.439041
Avg Recall: 1.000000
d_prime: 1.910071
train_loss: 0.139035
valid_loss: 1.339615
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00034270913251729094
Epoch-28 lr: 0.0006854182650345819
epoch 28 training time: 15.290
---------------
2023-09-24 12:50:55.683513
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00919	Per Sample Data Time 0.00341	Per Sample DNN Time 0.00578	Train Loss 0.1329	
start validation
acc: 0.723005
AUC: 0.907393
Avg Precision: 0.461565
Avg Recall: 1.000000
d_prime: 1.873653
train_loss: 0.123069
valid_loss: 1.343036
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00034270913251729094
Epoch-29 lr: 0.0006854182650345819
epoch 29 training time: 16.681
---------------
2023-09-24 12:51:12.364461
current #epochs=30, #steps=1131
start validation
acc: 0.708920
AUC: 0.906783
Avg Precision: 0.478203
Avg Recall: 1.000000
d_prime: 1.868464
train_loss: 0.133600
valid_loss: 1.345665
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00034270913251729094
Epoch-30 lr: 0.0006854182650345819
epoch 30 training time: 15.008
---------------
2023-09-24 12:51:27.372482
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00662	Per Sample Data Time 0.00107	Per Sample DNN Time 0.00555	Train Loss 0.1519	
start validation
acc: 0.723005
AUC: 0.910126
Avg Precision: 0.460112
Avg Recall: 1.000000
d_prime: 1.897209
train_loss: 0.143319
valid_loss: 1.343944
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0002469647754097587
Epoch-31 lr: 0.0004939295508195174
epoch 31 training time: 15.028
---------------
2023-09-24 12:51:42.400628
current #epochs=32, #steps=1209
start validation
acc: 0.727700
AUC: 0.909410
Avg Precision: 0.448603
Avg Recall: 1.000000
d_prime: 1.890987
train_loss: 0.138004
valid_loss: 1.340115
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0002469647754097587
Epoch-32 lr: 0.0004939295508195174
epoch 32 training time: 15.334
---------------
2023-09-24 12:51:57.734935
current #epochs=33, #steps=1248
start validation
acc: 0.718310
AUC: 0.904544
Avg Precision: 0.463942
Avg Recall: 1.000000
d_prime: 1.849633
train_loss: 0.130255
valid_loss: 1.340392
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0002469647754097587
Epoch-33 lr: 0.0004939295508195174
epoch 33 training time: 15.185
---------------
2023-09-24 12:52:12.920097
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00800	Per Sample Data Time 0.00232	Per Sample DNN Time 0.00568	Train Loss 0.1213	
start validation
acc: 0.732394
AUC: 0.906847
Avg Precision: 0.457276
Avg Recall: 1.000000
d_prime: 1.869002
train_loss: 0.122919
valid_loss: 1.339006
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0001779689961723308
Epoch-34 lr: 0.0003559379923446616
epoch 34 training time: 15.036
---------------
2023-09-24 12:52:27.955889
current #epochs=35, #steps=1326
start validation
acc: 0.727700
AUC: 0.906367
Avg Precision: 0.447648
Avg Recall: 1.000000
d_prime: 1.864940
train_loss: 0.120970
valid_loss: 1.339468
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0001779689961723308
Epoch-35 lr: 0.0003559379923446616
epoch 35 training time: 15.211
---------------
2023-09-24 12:52:43.167089
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00649	Per Sample Data Time 0.00098	Per Sample DNN Time 0.00550	Train Loss 0.1380	
start validation
acc: 0.732394
AUC: 0.904737
Avg Precision: 0.451020
Avg Recall: 1.000000
d_prime: 1.851237
train_loss: 0.137371
valid_loss: 1.341633
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0001779689961723308
Epoch-36 lr: 0.0003559379923446616
epoch 36 training time: 15.013
---------------
2023-09-24 12:52:58.180118
current #epochs=37, #steps=1404
start validation
acc: 0.751174
AUC: 0.907743
Avg Precision: 0.453567
Avg Recall: 1.000000
d_prime: 1.876643
train_loss: 0.105468
valid_loss: 1.334858
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.00012824891139246876
Epoch-37 lr: 0.0002564978227849375
epoch 37 training time: 17.525
---------------
2023-09-24 12:53:15.705293
current #epochs=38, #steps=1443
start validation
[I 2023-09-24 12:53:30,902] Trial 20 finished with value: 0.4379205778911414 and parameters: {'warmup': 'False', 'num_epochs': 38, 'batch_size': 16, 'lr-adaptschedule': 'False', 'lr': 0.003395942448770041, 'head-lr': 2, 'lr-scheduler-start': 10, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.7206250198112197}. Best is trial 14 with value: 0.47138807158347623.
acc: 0.741784
AUC: 0.908655
Avg Precision: 0.437921
Avg Recall: 1.000000
d_prime: 1.884465
train_loss: 0.129102
valid_loss: 1.335827
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.00012824891139246876
Epoch-38 lr: 0.0002564978227849375
epoch 38 training time: 15.193
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f500be0>
The learning rate scheduler starts at 9 epoch with decay rate of 0.848 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 12:53:30.934570
current #epochs=1, #steps=0
start validation
acc: 0.671362
AUC: 0.888091
Avg Precision: 0.470829
Avg Recall: 1.000000
d_prime: 1.720307
train_loss: 0.254538
valid_loss: 1.353876
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0021541362295288626
Epoch-1 lr: 0.004308272459057725
epoch 1 training time: 17.419
---------------
2023-09-24 12:53:48.354061
current #epochs=2, #steps=39
start validation
acc: 0.737089
AUC: 0.908114
Avg Precision: 0.493290
Avg Recall: 1.000000
d_prime: 1.879811
train_loss: 0.217980
valid_loss: 1.343525
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0021541362295288626
Epoch-2 lr: 0.004308272459057725
epoch 2 training time: 17.367
---------------
2023-09-24 12:54:05.720777
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00557	Train Loss 0.1492	
start validation
acc: 0.690141
AUC: 0.906065
Avg Precision: 0.437841
Avg Recall: 1.000000
d_prime: 1.862388
train_loss: 0.196298
valid_loss: 1.344775
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0021541362295288626
Epoch-3 lr: 0.004308272459057725
epoch 3 training time: 15.183
---------------
2023-09-24 12:54:20.904118
current #epochs=4, #steps=117
start validation
acc: 0.690141
AUC: 0.906330
Avg Precision: 0.422888
Avg Recall: 1.000000
d_prime: 1.864628
train_loss: 0.212436
valid_loss: 1.348095
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0021541362295288626
Epoch-4 lr: 0.004308272459057725
epoch 4 training time: 14.987
---------------
2023-09-24 12:54:35.890905
current #epochs=5, #steps=156
start validation
acc: 0.690141
AUC: 0.896839
Avg Precision: 0.459950
Avg Recall: 1.000000
d_prime: 1.787208
train_loss: 0.211996
valid_loss: 1.356231
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0021541362295288626
Epoch-5 lr: 0.004308272459057725
epoch 5 training time: 15.179
---------------
2023-09-24 12:54:51.069819
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01124	Per Sample Data Time 0.00553	Per Sample DNN Time 0.00571	Train Loss 0.2340	
start validation
acc: 0.699531
AUC: 0.897176
Avg Precision: 0.460410
Avg Recall: 1.000000
d_prime: 1.789858
train_loss: 0.239343
valid_loss: 1.362223
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0021541362295288626
Epoch-6 lr: 0.004308272459057725
epoch 6 training time: 15.517
---------------
2023-09-24 12:55:06.586647
current #epochs=7, #steps=234
start validation
acc: 0.727700
AUC: 0.904038
Avg Precision: 0.486573
Avg Recall: 1.000000
d_prime: 1.845418
train_loss: 0.223620
valid_loss: 1.327365
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0021541362295288626
Epoch-7 lr: 0.004308272459057725
epoch 7 training time: 15.237
---------------
2023-09-24 12:55:21.823389
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00682	Per Sample Data Time 0.00123	Per Sample DNN Time 0.00558	Train Loss 0.2354	
start validation
acc: 0.718310
AUC: 0.901954
Avg Precision: 0.457938
Avg Recall: 1.000000
d_prime: 1.828248
train_loss: 0.216862
valid_loss: 1.350938
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0021541362295288626
Epoch-8 lr: 0.004308272459057725
epoch 8 training time: 15.119
---------------
2023-09-24 12:55:36.942088
current #epochs=9, #steps=312
start validation
acc: 0.708920
AUC: 0.910467
Avg Precision: 0.461099
Avg Recall: 1.000000
d_prime: 1.900192
train_loss: 0.155382
valid_loss: 1.328501
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0018274233499263963
Epoch-9 lr: 0.0036548466998527927
epoch 9 training time: 15.016
---------------
2023-09-24 12:55:51.958440
current #epochs=10, #steps=351
start validation
acc: 0.723005
AUC: 0.900199
Avg Precision: 0.434919
Avg Recall: 1.000000
d_prime: 1.813991
train_loss: 0.173114
valid_loss: 1.358415
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0018274233499263963
Epoch-10 lr: 0.0036548466998527927
epoch 10 training time: 14.947
---------------
2023-09-24 12:56:06.905027
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00838	Per Sample Data Time 0.00278	Per Sample DNN Time 0.00560	Train Loss 0.1551	
start validation
acc: 0.699531
AUC: 0.885197
Avg Precision: 0.469798
Avg Recall: 1.000000
d_prime: 1.699002
train_loss: 0.182533
valid_loss: 1.345138
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0015502622601480498
Epoch-11 lr: 0.0031005245202960995
epoch 11 training time: 14.996
---------------
2023-09-24 12:56:21.900873
current #epochs=12, #steps=429
start validation
acc: 0.718310
AUC: 0.909186
Avg Precision: 0.466915
Avg Recall: 1.000000
d_prime: 1.889051
train_loss: 0.209776
valid_loss: 1.339135
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0015502622601480498
Epoch-12 lr: 0.0031005245202960995
epoch 12 training time: 15.263
---------------
2023-09-24 12:56:37.164062
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00656	Per Sample Data Time 0.00100	Per Sample DNN Time 0.00557	Train Loss 0.1461	
start validation
acc: 0.699531
AUC: 0.905388
Avg Precision: 0.430804
Avg Recall: 1.000000
d_prime: 1.856687
train_loss: 0.151321
valid_loss: 1.351024
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0013151375543801267
Epoch-13 lr: 0.0026302751087602535
epoch 13 training time: 15.086
---------------
2023-09-24 12:56:52.250406
current #epochs=14, #steps=507
start validation
acc: 0.694836
AUC: 0.903408
Avg Precision: 0.424158
Avg Recall: 1.000000
d_prime: 1.840203
train_loss: 0.182873
valid_loss: 1.355386
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0013151375543801267
Epoch-14 lr: 0.0026302751087602535
epoch 14 training time: 15.315
---------------
2023-09-24 12:57:07.565488
current #epochs=15, #steps=546
start validation
acc: 0.690141
AUC: 0.885670
Avg Precision: 0.427081
Avg Recall: 1.000000
d_prime: 1.702457
train_loss: 0.172018
valid_loss: 1.363242
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0011156736710959895
Epoch-15 lr: 0.002231347342191979
epoch 15 training time: 15.138
---------------
2023-09-24 12:57:22.702889
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00771	Per Sample Data Time 0.00209	Per Sample DNN Time 0.00562	Train Loss 0.1086	
start validation
acc: 0.718310
AUC: 0.895510
Avg Precision: 0.449059
Avg Recall: 1.000000
d_prime: 1.776782
train_loss: 0.122067
valid_loss: 1.345468
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0011156736710959895
Epoch-16 lr: 0.002231347342191979
epoch 16 training time: 15.080
---------------
2023-09-24 12:57:37.782829
current #epochs=17, #steps=624
start validation
acc: 0.704225
AUC: 0.894956
Avg Precision: 0.452044
Avg Recall: 1.000000
d_prime: 1.772467
train_loss: 0.136238
valid_loss: 1.351024
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0009464620154988189
Epoch-17 lr: 0.0018929240309976379
epoch 17 training time: 15.028
---------------
2023-09-24 12:57:52.811191
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00639	Per Sample Data Time 0.00092	Per Sample DNN Time 0.00548	Train Loss 0.1376	
start validation
acc: 0.699531
AUC: 0.897209
Avg Precision: 0.445532
Avg Recall: 1.000000
d_prime: 1.790120
train_loss: 0.136564
valid_loss: 1.336289
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0009464620154988189
Epoch-18 lr: 0.0018929240309976379
epoch 18 training time: 14.864
---------------
2023-09-24 12:58:07.675726
current #epochs=19, #steps=702
start validation
acc: 0.699531
AUC: 0.893979
Avg Precision: 0.431361
Avg Recall: 1.000000
d_prime: 1.764894
train_loss: 0.127579
valid_loss: 1.345493
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0008029143019052344
Epoch-19 lr: 0.0016058286038104688
epoch 19 training time: 15.854
---------------
2023-09-24 12:58:23.529630
current #epochs=20, #steps=741
start validation
acc: 0.718310
AUC: 0.899166
Avg Precision: 0.462728
Avg Recall: 1.000000
d_prime: 1.805685
train_loss: 0.109616
valid_loss: 1.340511
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0008029143019052344
Epoch-20 lr: 0.0016058286038104688
epoch 20 training time: 15.148
---------------
2023-09-24 12:58:38.677643
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00551	Train Loss 0.1338	
start validation
acc: 0.704225
AUC: 0.897141
Avg Precision: 0.447316
Avg Recall: 1.000000
d_prime: 1.789584
train_loss: 0.122706
valid_loss: 1.344642
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.000681138139351747
Epoch-21 lr: 0.001362276278703494
epoch 21 training time: 14.965
---------------
2023-09-24 12:58:53.641999
current #epochs=22, #steps=819
start validation
acc: 0.713615
AUC: 0.907057
Avg Precision: 0.471383
Avg Recall: 1.000000
d_prime: 1.870786
train_loss: 0.150482
valid_loss: 1.353115
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.000681138139351747
Epoch-22 lr: 0.001362276278703494
epoch 22 training time: 15.171
---------------
2023-09-24 12:59:08.812651
current #epochs=23, #steps=858
start validation
acc: 0.713615
AUC: 0.904075
Avg Precision: 0.467544
Avg Recall: 1.000000
d_prime: 1.845728
train_loss: 0.133875
valid_loss: 1.351827
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0005778314868456765
Epoch-23 lr: 0.001155662973691353
epoch 23 training time: 15.018
---------------
2023-09-24 12:59:23.830244
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01360	Per Sample Data Time 0.00774	Per Sample DNN Time 0.00586	Train Loss 0.0885	
start validation
acc: 0.737089
AUC: 0.906536
Avg Precision: 0.461203
Avg Recall: 1.000000
d_prime: 1.866367
train_loss: 0.123051
valid_loss: 1.336946
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0005778314868456765
Epoch-24 lr: 0.001155662973691353
epoch 24 training time: 14.997
---------------
2023-09-24 12:59:38.827094
current #epochs=25, #steps=936
start validation
acc: 0.737089
AUC: 0.905430
Avg Precision: 0.481271
Avg Recall: 1.000000
d_prime: 1.857045
train_loss: 0.109911
valid_loss: 1.341445
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0004901931163450256
Epoch-25 lr: 0.0009803862326900512
epoch 25 training time: 15.191
---------------
2023-09-24 12:59:54.017952
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00689	Per Sample Data Time 0.00128	Per Sample DNN Time 0.00561	Train Loss 0.1401	
start validation
acc: 0.723005
AUC: 0.900363
Avg Precision: 0.463741
Avg Recall: 1.000000
d_prime: 1.815320
train_loss: 0.138853
valid_loss: 1.343219
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0004901931163450256
Epoch-26 lr: 0.0009803862326900512
epoch 26 training time: 15.963
---------------
2023-09-24 13:00:09.980913
current #epochs=27, #steps=1014
start validation
acc: 0.737089
AUC: 0.898201
Avg Precision: 0.468479
Avg Recall: 1.000000
d_prime: 1.797983
train_loss: 0.129081
valid_loss: 1.341567
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0004158466556119375
Epoch-27 lr: 0.000831693311223875
epoch 27 training time: 15.124
---------------
2023-09-24 13:00:25.104562
current #epochs=28, #steps=1053
start validation
acc: 0.732394
AUC: 0.896789
Avg Precision: 0.478120
Avg Recall: 1.000000
d_prime: 1.786811
train_loss: 0.116805
valid_loss: 1.340947
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0004158466556119375
Epoch-28 lr: 0.000831693311223875
epoch 28 training time: 15.390
---------------
2023-09-24 13:00:40.494989
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00933	Per Sample Data Time 0.00355	Per Sample DNN Time 0.00577	Train Loss 0.1044	
start validation
[I 2023-09-24 13:00:57,412] Trial 21 finished with value: 0.4705295866567086 and parameters: {'warmup': 'False', 'num_epochs': 29, 'batch_size': 30, 'lr-adaptschedule': 'False', 'lr': 0.0021541362295288626, 'head-lr': 2, 'lr-scheduler-start': 9, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.8483323036287623}. Best is trial 14 with value: 0.47138807158347623.
acc: 0.713615
AUC: 0.897901
Avg Precision: 0.470530
Avg Recall: 1.000000
d_prime: 1.795598
train_loss: 0.128715
valid_loss: 1.340099
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0003527761513115915
Epoch-29 lr: 0.000705552302623183
epoch 29 training time: 16.911
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f583fa0>
The learning rate scheduler starts at 9 epoch with decay rate of 0.856 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 13:00:57.444058
current #epochs=1, #steps=0
start validation
acc: 0.676056
AUC: 0.897064
Avg Precision: 0.493869
Avg Recall: 1.000000
d_prime: 1.788974
train_loss: 0.305605
valid_loss: 1.358476
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002394908685616785
Epoch-1 lr: 0.00478981737123357
epoch 1 training time: 19.207
---------------
2023-09-24 13:01:16.651151
current #epochs=2, #steps=39
start validation
acc: 0.680751
AUC: 0.897509
Avg Precision: 0.469080
Avg Recall: 1.000000
d_prime: 1.792493
train_loss: 0.209137
valid_loss: 1.361922
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002394908685616785
Epoch-2 lr: 0.00478981737123357
epoch 2 training time: 17.646
---------------
2023-09-24 13:01:34.296910
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00700	Per Sample Data Time 0.00143	Per Sample DNN Time 0.00557	Train Loss 0.1377	
start validation
acc: 0.685446
AUC: 0.899078
Avg Precision: 0.464301
Avg Recall: 1.000000
d_prime: 1.804982
train_loss: 0.144627
valid_loss: 1.355334
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002394908685616785
Epoch-3 lr: 0.00478981737123357
epoch 3 training time: 19.289
---------------
2023-09-24 13:01:53.586604
current #epochs=4, #steps=117
start validation
acc: 0.676056
AUC: 0.898495
Avg Precision: 0.462429
Avg Recall: 1.000000
d_prime: 1.800322
train_loss: 0.212563
valid_loss: 1.343491
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002394908685616785
Epoch-4 lr: 0.00478981737123357
epoch 4 training time: 14.994
---------------
2023-09-24 13:02:08.580441
current #epochs=5, #steps=156
start validation
acc: 0.666667
AUC: 0.906149
Avg Precision: 0.485750
Avg Recall: 1.000000
d_prime: 1.863098
train_loss: 0.176518
valid_loss: 1.329695
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002394908685616785
Epoch-5 lr: 0.00478981737123357
epoch 5 training time: 15.025
---------------
2023-09-24 13:02:23.605369
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01095	Per Sample Data Time 0.00519	Per Sample DNN Time 0.00577	Train Loss 0.1469	
start validation
acc: 0.690141
AUC: 0.891484
Avg Precision: 0.486971
Avg Recall: 1.000000
d_prime: 1.745789
train_loss: 0.217123
valid_loss: 1.340474
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002394908685616785
Epoch-6 lr: 0.00478981737123357
epoch 6 training time: 18.179
---------------
2023-09-24 13:02:41.784239
current #epochs=7, #steps=234
start validation
acc: 0.694836
AUC: 0.900699
Avg Precision: 0.467897
Avg Recall: 1.000000
d_prime: 1.818034
train_loss: 0.224113
valid_loss: 1.342586
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002394908685616785
Epoch-7 lr: 0.00478981737123357
epoch 7 training time: 17.619
---------------
2023-09-24 13:02:59.402989
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00678	Per Sample Data Time 0.00120	Per Sample DNN Time 0.00558	Train Loss 0.2293	
start validation
acc: 0.690141
AUC: 0.884499
Avg Precision: 0.454949
Avg Recall: 1.000000
d_prime: 1.693921
train_loss: 0.219753
valid_loss: 1.355593
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.002394908685616785
Epoch-8 lr: 0.00478981737123357
epoch 8 training time: 15.058
---------------
2023-09-24 13:03:14.460991
current #epochs=9, #steps=312
start validation
acc: 0.685446
AUC: 0.901953
Avg Precision: 0.435565
Avg Recall: 1.000000
d_prime: 1.828242
train_loss: 0.191886
valid_loss: 1.337808
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0020503481625893084
Epoch-9 lr: 0.004100696325178617
epoch 9 training time: 15.233
---------------
2023-09-24 13:03:29.694343
current #epochs=10, #steps=351
start validation
acc: 0.690141
AUC: 0.905986
Avg Precision: 0.464406
Avg Recall: 1.000000
d_prime: 1.861721
train_loss: 0.187137
valid_loss: 1.338501
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0020503481625893084
Epoch-10 lr: 0.004100696325178617
epoch 10 training time: 14.966
---------------
2023-09-24 13:03:44.660344
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00847	Per Sample Data Time 0.00284	Per Sample DNN Time 0.00563	Train Loss 0.1762	
start validation
acc: 0.699531
AUC: 0.888769
Avg Precision: 0.464904
Avg Recall: 1.000000
d_prime: 1.725349
train_loss: 0.194172
valid_loss: 1.371548
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0020503481625893084
Epoch-11 lr: 0.004100696325178617
epoch 11 training time: 17.436
---------------
2023-09-24 13:04:02.096992
current #epochs=12, #steps=429
start validation
acc: 0.727700
AUC: 0.899116
Avg Precision: 0.470248
Avg Recall: 1.000000
d_prime: 1.805289
train_loss: 0.144273
valid_loss: 1.365214
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.001755360282870523
Epoch-12 lr: 0.003510720565741046
epoch 12 training time: 17.472
---------------
2023-09-24 13:04:19.568796
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00658	Per Sample Data Time 0.00105	Per Sample DNN Time 0.00552	Train Loss 0.1462	
start validation
acc: 0.676056
AUC: 0.904583
Avg Precision: 0.449914
Avg Recall: 1.000000
d_prime: 1.849955
train_loss: 0.159499
valid_loss: 1.350540
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.001755360282870523
Epoch-13 lr: 0.003510720565741046
epoch 13 training time: 15.025
---------------
2023-09-24 13:04:34.593693
current #epochs=14, #steps=507
start validation
acc: 0.704225
AUC: 0.909063
Avg Precision: 0.457248
Avg Recall: 1.000000
d_prime: 1.887982
train_loss: 0.189969
valid_loss: 1.336545
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.001755360282870523
Epoch-14 lr: 0.003510720565741046
epoch 14 training time: 15.095
---------------
2023-09-24 13:04:49.688476
current #epochs=15, #steps=546
start validation
acc: 0.713615
AUC: 0.911054
Avg Precision: 0.456152
Avg Recall: 1.000000
d_prime: 1.905335
train_loss: 0.160110
valid_loss: 1.341365
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0015028129265558668
Epoch-15 lr: 0.0030056258531117337
epoch 15 training time: 15.078
---------------
2023-09-24 13:05:04.766025
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00758	Per Sample Data Time 0.00204	Per Sample DNN Time 0.00554	Train Loss 0.1469	
start validation
acc: 0.732394
AUC: 0.912907
Avg Precision: 0.442522
Avg Recall: 1.000000
d_prime: 1.921742
train_loss: 0.137731
valid_loss: 1.328272
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0015028129265558668
Epoch-16 lr: 0.0030056258531117337
epoch 16 training time: 17.517
---------------
2023-09-24 13:05:22.283201
current #epochs=17, #steps=624
start validation
acc: 0.690141
AUC: 0.905699
Avg Precision: 0.448427
Avg Recall: 1.000000
d_prime: 1.859303
train_loss: 0.149370
valid_loss: 1.341764
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0015028129265558668
Epoch-17 lr: 0.0030056258531117337
epoch 17 training time: 15.164
---------------
2023-09-24 13:05:37.446917
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00645	Per Sample Data Time 0.00094	Per Sample DNN Time 0.00551	Train Loss 0.1366	
start validation
acc: 0.690141
AUC: 0.907127
Avg Precision: 0.440236
Avg Recall: 1.000000
d_prime: 1.871386
train_loss: 0.134511
valid_loss: 1.346348
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0012866000867526716
Epoch-18 lr: 0.0025732001735053432
epoch 18 training time: 15.007
---------------
2023-09-24 13:05:52.454266
current #epochs=19, #steps=702
start validation
acc: 0.708920
AUC: 0.913480
Avg Precision: 0.457470
Avg Recall: 1.000000
d_prime: 1.926866
train_loss: 0.128109
valid_loss: 1.344556
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0012866000867526716
Epoch-19 lr: 0.0025732001735053432
epoch 19 training time: 15.054
---------------
2023-09-24 13:06:07.508205
current #epochs=20, #steps=741
start validation
acc: 0.661972
AUC: 0.900592
Avg Precision: 0.464094
Avg Recall: 1.000000
d_prime: 1.817166
train_loss: 0.124141
valid_loss: 1.359530
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0012866000867526716
Epoch-20 lr: 0.0025732001735053432
epoch 20 training time: 15.254
---------------
2023-09-24 13:06:22.762368
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00160	Per Sample DNN Time 0.00556	Train Loss 0.1426	
start validation
acc: 0.694836
AUC: 0.897107
Avg Precision: 0.453538
Avg Recall: 1.000000
d_prime: 1.789321
train_loss: 0.128959
valid_loss: 1.350969
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.001101494240554395
Epoch-21 lr: 0.00220298848110879
epoch 21 training time: 15.161
---------------
2023-09-24 13:06:37.923366
current #epochs=22, #steps=819
start validation
[I 2023-09-24 13:06:53,077] Trial 22 finished with value: 0.4646741183428688 and parameters: {'warmup': 'False', 'num_epochs': 22, 'batch_size': 32, 'lr-adaptschedule': 'False', 'lr': 0.002394908685616785, 'head-lr': 2, 'lr-scheduler-start': 9, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.8561279078835782}. Best is trial 14 with value: 0.47138807158347623.
acc: 0.704225
AUC: 0.913801
Avg Precision: 0.464674
Avg Recall: 1.000000
d_prime: 1.929750
train_loss: 0.140965
valid_loss: 1.336002
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.001101494240554395
Epoch-22 lr: 0.00220298848110879
epoch 22 training time: 15.147
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67ec45760>
The learning rate scheduler starts at 8 epoch with decay rate of 0.798 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 13:06:53.108903
current #epochs=1, #steps=0
start validation
acc: 0.685446
AUC: 0.893050
Avg Precision: 0.450783
Avg Recall: 1.000000
d_prime: 1.757746
train_loss: 0.213690
valid_loss: 1.368844
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0017786102116328722
Epoch-1 lr: 0.0017786102116328722
epoch 1 training time: 17.618
---------------
2023-09-24 13:07:10.727363
current #epochs=2, #steps=39
start validation
acc: 0.718310
AUC: 0.904152
Avg Precision: 0.426162
Avg Recall: 1.000000
d_prime: 1.846364
train_loss: 0.155807
valid_loss: 1.356096
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0017786102116328722
Epoch-2 lr: 0.0017786102116328722
epoch 2 training time: 17.674
---------------
2023-09-24 13:07:28.401420
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00561	Train Loss 0.1286	
start validation
acc: 0.690141
AUC: 0.912577
Avg Precision: 0.464316
Avg Recall: 1.000000
d_prime: 1.918798
train_loss: 0.132419
valid_loss: 1.345000
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0017786102116328722
Epoch-3 lr: 0.0017786102116328722
epoch 3 training time: 15.209
---------------
2023-09-24 13:07:43.610293
current #epochs=4, #steps=117
start validation
acc: 0.718310
AUC: 0.918911
Avg Precision: 0.450590
Avg Recall: 1.000000
d_prime: 1.976767
train_loss: 0.151356
valid_loss: 1.330265
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0017786102116328722
Epoch-4 lr: 0.0017786102116328722
epoch 4 training time: 15.080
---------------
2023-09-24 13:07:58.689845
current #epochs=5, #steps=156
start validation
acc: 0.718310
AUC: 0.908188
Avg Precision: 0.460024
Avg Recall: 1.000000
d_prime: 1.880449
train_loss: 0.120168
valid_loss: 1.332861
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0017786102116328722
Epoch-5 lr: 0.0017786102116328722
epoch 5 training time: 15.011
---------------
2023-09-24 13:08:13.701211
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01108	Per Sample Data Time 0.00536	Per Sample DNN Time 0.00572	Train Loss 0.1966	
start validation
acc: 0.699531
AUC: 0.899409
Avg Precision: 0.449390
Avg Recall: 1.000000
d_prime: 1.807635
train_loss: 0.143181
valid_loss: 1.344561
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0017786102116328722
Epoch-6 lr: 0.0017786102116328722
epoch 6 training time: 15.029
---------------
2023-09-24 13:08:28.730588
current #epochs=7, #steps=234
start validation
acc: 0.741784
AUC: 0.910149
Avg Precision: 0.458774
Avg Recall: 1.000000
d_prime: 1.897414
train_loss: 0.145641
valid_loss: 1.337535
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0017786102116328722
Epoch-7 lr: 0.0017786102116328722
epoch 7 training time: 17.395
---------------
2023-09-24 13:08:46.126237
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00677	Per Sample Data Time 0.00123	Per Sample DNN Time 0.00554	Train Loss 0.1472	
start validation
acc: 0.755869
AUC: 0.920326
Avg Precision: 0.459687
Avg Recall: 1.000000
d_prime: 1.990175
train_loss: 0.140157
valid_loss: 1.333377
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0014191319448982884
Epoch-8 lr: 0.0014191319448982884
epoch 8 training time: 17.537
---------------
2023-09-24 13:09:03.662830
current #epochs=9, #steps=312
start validation
acc: 0.708920
AUC: 0.900776
Avg Precision: 0.448298
Avg Recall: 1.000000
d_prime: 1.818662
train_loss: 0.153947
valid_loss: 1.361317
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0014191319448982884
Epoch-9 lr: 0.0014191319448982884
epoch 9 training time: 15.116
---------------
2023-09-24 13:09:18.779280
current #epochs=10, #steps=351
start validation
acc: 0.723005
AUC: 0.902613
Avg Precision: 0.452766
Avg Recall: 1.000000
d_prime: 1.833646
train_loss: 0.153766
valid_loss: 1.349391
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0011323085091150375
Epoch-10 lr: 0.0011323085091150375
epoch 10 training time: 15.141
---------------
2023-09-24 13:09:33.920600
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00853	Per Sample Data Time 0.00284	Per Sample DNN Time 0.00569	Train Loss 0.1578	
start validation
acc: 0.699531
AUC: 0.909857
Avg Precision: 0.417549
Avg Recall: 1.000000
d_prime: 1.894871
train_loss: 0.149289
valid_loss: 1.338738
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0011323085091150375
Epoch-11 lr: 0.0011323085091150375
epoch 11 training time: 14.961
---------------
2023-09-24 13:09:48.881360
current #epochs=12, #steps=429
start validation
acc: 0.708920
AUC: 0.895232
Avg Precision: 0.465215
Avg Recall: 1.000000
d_prime: 1.774613
train_loss: 0.125798
valid_loss: 1.357780
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0009034554992743898
Epoch-12 lr: 0.0009034554992743898
epoch 12 training time: 15.156
---------------
2023-09-24 13:10:04.037833
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00665	Per Sample Data Time 0.00104	Per Sample DNN Time 0.00561	Train Loss 0.1272	
start validation
acc: 0.708920
AUC: 0.900035
Avg Precision: 0.429961
Avg Recall: 1.000000
d_prime: 1.812666
train_loss: 0.121896
valid_loss: 1.358031
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0009034554992743898
Epoch-13 lr: 0.0009034554992743898
epoch 13 training time: 15.125
---------------
2023-09-24 13:10:19.162655
current #epochs=14, #steps=507
start validation
acc: 0.718310
AUC: 0.910310
Avg Precision: 0.481182
Avg Recall: 1.000000
d_prime: 1.898819
train_loss: 0.119866
valid_loss: 1.349753
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0007208564031785541
Epoch-14 lr: 0.0007208564031785541
epoch 14 training time: 15.064
---------------
2023-09-24 13:10:34.226786
current #epochs=15, #steps=546
start validation
acc: 0.671362
AUC: 0.906273
Avg Precision: 0.468643
Avg Recall: 1.000000
d_prime: 1.864146
train_loss: 0.129522
valid_loss: 1.341014
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0007208564031785541
Epoch-15 lr: 0.0007208564031785541
epoch 15 training time: 14.983
---------------
2023-09-24 13:10:49.209709
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00765	Per Sample Data Time 0.00203	Per Sample DNN Time 0.00563	Train Loss 0.1323	
start validation
acc: 0.694836
AUC: 0.900767
Avg Precision: 0.458608
Avg Recall: 1.000000
d_prime: 1.818589
train_loss: 0.111886
valid_loss: 1.349754
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0005751627550232038
Epoch-16 lr: 0.0005751627550232038
epoch 16 training time: 15.698
---------------
2023-09-24 13:11:04.908082
current #epochs=17, #steps=624
start validation
acc: 0.704225
AUC: 0.911020
Avg Precision: 0.466797
Avg Recall: 1.000000
d_prime: 1.905031
train_loss: 0.102521
valid_loss: 1.335549
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0005751627550232038
Epoch-17 lr: 0.0005751627550232038
epoch 17 training time: 15.218
---------------
2023-09-24 13:11:20.126465
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00644	Per Sample Data Time 0.00092	Per Sample DNN Time 0.00552	Train Loss 0.1162	
start validation
acc: 0.694836
AUC: 0.908856
Avg Precision: 0.454101
Avg Recall: 1.000000
d_prime: 1.886195
train_loss: 0.115598
valid_loss: 1.340562
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00045891552507155953
Epoch-18 lr: 0.00045891552507155953
epoch 18 training time: 15.070
---------------
2023-09-24 13:11:35.196737
current #epochs=19, #steps=702
start validation
acc: 0.708920
AUC: 0.904725
Avg Precision: 0.469262
Avg Recall: 1.000000
d_prime: 1.851143
train_loss: 0.118840
valid_loss: 1.339804
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00045891552507155953
Epoch-19 lr: 0.00045891552507155953
epoch 19 training time: 15.204
---------------
2023-09-24 13:11:50.400420
current #epochs=20, #steps=741
start validation
acc: 0.723005
AUC: 0.906662
Avg Precision: 0.477464
Avg Recall: 1.000000
d_prime: 1.867437
train_loss: 0.110600
valid_loss: 1.343931
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0003661632421647483
Epoch-20 lr: 0.0003661632421647483
epoch 20 training time: 15.062
---------------
2023-09-24 13:12:05.462432
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00167	Per Sample DNN Time 0.00550	Train Loss 0.1035	
start validation
acc: 0.704225
AUC: 0.906090
Avg Precision: 0.459192
Avg Recall: 1.000000
d_prime: 1.862600
train_loss: 0.096785
valid_loss: 1.338325
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0003661632421647483
Epoch-21 lr: 0.0003661632421647483
epoch 21 training time: 15.191
---------------
2023-09-24 13:12:20.652947
current #epochs=22, #steps=819
start validation
acc: 0.699531
AUC: 0.903826
Avg Precision: 0.455347
Avg Recall: 1.000000
d_prime: 1.843659
train_loss: 0.083145
valid_loss: 1.347448
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00029215729821233105
Epoch-22 lr: 0.00029215729821233105
epoch 22 training time: 15.073
---------------
2023-09-24 13:12:35.726254
current #epochs=23, #steps=858
start validation
acc: 0.723005
AUC: 0.905338
Avg Precision: 0.458708
Avg Recall: 1.000000
d_prime: 1.856268
train_loss: 0.086360
valid_loss: 1.336460
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00029215729821233105
Epoch-23 lr: 0.00029215729821233105
epoch 23 training time: 15.083
---------------
2023-09-24 13:12:50.808728
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01430	Per Sample Data Time 0.00839	Per Sample DNN Time 0.00590	Train Loss 0.1243	
start validation
acc: 0.704225
AUC: 0.907746
Avg Precision: 0.461080
Avg Recall: 1.000000
d_prime: 1.876663
train_loss: 0.113431
valid_loss: 1.342170
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00023310883526731678
Epoch-24 lr: 0.00023310883526731678
epoch 24 training time: 15.194
---------------
2023-09-24 13:13:06.002978
current #epochs=25, #steps=936
start validation
acc: 0.723005
AUC: 0.909493
Avg Precision: 0.471157
Avg Recall: 1.000000
d_prime: 1.891705
train_loss: 0.100982
valid_loss: 1.341907
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00023310883526731678
Epoch-25 lr: 0.00023310883526731678
epoch 25 training time: 15.141
---------------
2023-09-24 13:13:21.144061
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00690	Per Sample Data Time 0.00133	Per Sample DNN Time 0.00558	Train Loss 0.1183	
start validation
acc: 0.694836
AUC: 0.908656
Avg Precision: 0.465711
Avg Recall: 1.000000
d_prime: 1.884475
train_loss: 0.109395
valid_loss: 1.344361
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00018599476861328506
Epoch-26 lr: 0.00018599476861328506
epoch 26 training time: 16.260
---------------
2023-09-24 13:13:37.403904
current #epochs=27, #steps=1014
start validation
acc: 0.699531
AUC: 0.906555
Avg Precision: 0.471780
Avg Recall: 1.000000
d_prime: 1.866528
train_loss: 0.084990
valid_loss: 1.342507
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00018599476861328506
Epoch-27 lr: 0.00018599476861328506
epoch 27 training time: 15.193
---------------
2023-09-24 13:13:52.596823
current #epochs=28, #steps=1053
start validation
acc: 0.690141
AUC: 0.905265
Avg Precision: 0.465089
Avg Recall: 1.000000
d_prime: 1.855657
train_loss: 0.089858
valid_loss: 1.347469
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0001484030148914726
Epoch-28 lr: 0.0001484030148914726
epoch 28 training time: 15.729
---------------
2023-09-24 13:14:08.326005
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00937	Per Sample Data Time 0.00360	Per Sample DNN Time 0.00578	Train Loss 0.0702	
start validation
[I 2023-09-24 13:14:23,544] Trial 23 finished with value: 0.4637103769566457 and parameters: {'warmup': 'False', 'num_epochs': 29, 'batch_size': 23, 'lr-adaptschedule': 'False', 'lr': 0.0017786102116328722, 'head-lr': 1, 'lr-scheduler-start': 8, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.7978881126491674}. Best is trial 14 with value: 0.47138807158347623.
acc: 0.690141
AUC: 0.904838
Avg Precision: 0.463710
Avg Recall: 1.000000
d_prime: 1.852087
train_loss: 0.094577
valid_loss: 1.341678
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0001484030148914726
Epoch-29 lr: 0.0001484030148914726
epoch 29 training time: 15.211
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa6015c4280>
The learning rate scheduler starts at 10 epoch with decay rate of 0.839 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 13:14:23.576273
current #epochs=1, #steps=0
start validation
acc: 0.723005
AUC: 0.898334
Avg Precision: 0.459538
Avg Recall: 1.000000
d_prime: 1.799043
train_loss: 0.233249
valid_loss: 1.352533
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.002345727501231712
Epoch-1 lr: 0.007037182503695136
epoch 1 training time: 17.463
---------------
2023-09-24 13:14:41.039553
current #epochs=2, #steps=39
start validation
acc: 0.718310
AUC: 0.905670
Avg Precision: 0.487800
Avg Recall: 1.000000
d_prime: 1.859063
train_loss: 0.184903
valid_loss: 1.353242
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.002345727501231712
Epoch-2 lr: 0.007037182503695136
epoch 2 training time: 15.029
---------------
2023-09-24 13:14:56.068861
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00558	Train Loss 0.1752	
start validation
acc: 0.661972
AUC: 0.878529
Avg Precision: 0.441456
Avg Recall: 1.000000
d_prime: 1.651325
train_loss: 0.185189
valid_loss: 1.359521
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.002345727501231712
Epoch-3 lr: 0.007037182503695136
epoch 3 training time: 15.095
---------------
2023-09-24 13:15:11.163669
current #epochs=4, #steps=117
start validation
acc: 0.657277
AUC: 0.884250
Avg Precision: 0.443480
Avg Recall: 1.000000
d_prime: 1.692115
train_loss: 0.159672
valid_loss: 1.345582
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.002345727501231712
Epoch-4 lr: 0.007037182503695136
epoch 4 training time: 15.151
---------------
2023-09-24 13:15:26.314522
current #epochs=5, #steps=156
start validation
acc: 0.737089
AUC: 0.904441
Avg Precision: 0.484056
Avg Recall: 1.000000
d_prime: 1.848774
train_loss: 0.143875
valid_loss: 1.327740
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.002345727501231712
Epoch-5 lr: 0.007037182503695136
epoch 5 training time: 17.640
---------------
2023-09-24 13:15:43.955024
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01083	Per Sample Data Time 0.00506	Per Sample DNN Time 0.00576	Train Loss 0.1216	
start validation
acc: 0.666667
AUC: 0.906899
Avg Precision: 0.467898
Avg Recall: 1.000000
d_prime: 1.869444
train_loss: 0.165798
valid_loss: 1.333624
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.002345727501231712
Epoch-6 lr: 0.007037182503695136
epoch 6 training time: 15.255
---------------
2023-09-24 13:15:59.210478
current #epochs=7, #steps=234
start validation
acc: 0.699531
AUC: 0.897588
Avg Precision: 0.475715
Avg Recall: 1.000000
d_prime: 1.793119
train_loss: 0.221078
valid_loss: 1.345839
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.002345727501231712
Epoch-7 lr: 0.007037182503695136
epoch 7 training time: 15.014
---------------
2023-09-24 13:16:14.224123
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00688	Per Sample Data Time 0.00119	Per Sample DNN Time 0.00569	Train Loss 0.2190	
start validation
acc: 0.713615
AUC: 0.903813
Avg Precision: 0.456446
Avg Recall: 1.000000
d_prime: 1.843554
train_loss: 0.210899
valid_loss: 1.357075
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.002345727501231712
Epoch-8 lr: 0.007037182503695136
epoch 8 training time: 15.259
---------------
2023-09-24 13:16:29.483552
current #epochs=9, #steps=312
start validation
acc: 0.657277
AUC: 0.902970
Avg Precision: 0.483919
Avg Recall: 1.000000
d_prime: 1.836584
train_loss: 0.167362
valid_loss: 1.345019
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.002345727501231712
Epoch-9 lr: 0.007037182503695136
epoch 9 training time: 14.953
---------------
2023-09-24 13:16:44.436753
current #epochs=10, #steps=351
start validation
acc: 0.732394
AUC: 0.898611
Avg Precision: 0.419631
Avg Recall: 1.000000
d_prime: 1.801252
train_loss: 0.189533
valid_loss: 1.351810
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0019680693455629886
Epoch-10 lr: 0.005904208036688965
epoch 10 training time: 15.022
---------------
2023-09-24 13:16:59.458654
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00857	Per Sample Data Time 0.00289	Per Sample DNN Time 0.00568	Train Loss 0.1501	
start validation
acc: 0.694836
AUC: 0.887578
Avg Precision: 0.453791
Avg Recall: 1.000000
d_prime: 1.716501
train_loss: 0.181400
valid_loss: 1.358694
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0019680693455629886
Epoch-11 lr: 0.005904208036688965
epoch 11 training time: 16.433
---------------
2023-09-24 13:17:15.891316
current #epochs=12, #steps=429
start validation
acc: 0.661972
AUC: 0.892309
Avg Precision: 0.457181
Avg Recall: 1.000000
d_prime: 1.752073
train_loss: 0.198556
valid_loss: 1.360591
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0019680693455629886
Epoch-12 lr: 0.005904208036688965
epoch 12 training time: 15.180
---------------
2023-09-24 13:17:31.071344
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00657	Per Sample Data Time 0.00103	Per Sample DNN Time 0.00554	Train Loss 0.1725	
start validation
acc: 0.694836
AUC: 0.897547
Avg Precision: 0.452618
Avg Recall: 1.000000
d_prime: 1.792795
train_loss: 0.178849
valid_loss: 1.359253
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0019680693455629886
Epoch-13 lr: 0.005904208036688965
epoch 13 training time: 15.064
---------------
2023-09-24 13:17:46.134882
current #epochs=14, #steps=507
start validation
acc: 0.690141
AUC: 0.898408
Avg Precision: 0.479522
Avg Recall: 1.000000
d_prime: 1.799634
train_loss: 0.129058
valid_loss: 1.357233
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0019680693455629886
Epoch-14 lr: 0.005904208036688965
epoch 14 training time: 15.108
---------------
2023-09-24 13:18:01.243130
current #epochs=15, #steps=546
start validation
acc: 0.680751
AUC: 0.895826
Avg Precision: 0.427438
Avg Recall: 1.000000
d_prime: 1.779254
train_loss: 0.133573
valid_loss: 1.340674
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0016512135134668926
Epoch-15 lr: 0.004953640540400678
epoch 15 training time: 15.163
---------------
2023-09-24 13:18:16.405771
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00761	Per Sample Data Time 0.00199	Per Sample DNN Time 0.00562	Train Loss 0.1748	
start validation
acc: 0.661972
AUC: 0.892753
Avg Precision: 0.453533
Avg Recall: 1.000000
d_prime: 1.755469
train_loss: 0.166865
valid_loss: 1.353086
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0016512135134668926
Epoch-16 lr: 0.004953640540400678
epoch 16 training time: 14.967
---------------
2023-09-24 13:18:31.372527
current #epochs=17, #steps=624
start validation
acc: 0.694836
AUC: 0.903573
Avg Precision: 0.498297
Avg Recall: 1.000000
d_prime: 1.841565
train_loss: 0.123732
valid_loss: 1.330431
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0016512135134668926
Epoch-17 lr: 0.004953640540400678
epoch 17 training time: 15.880
---------------
2023-09-24 13:18:47.252953
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00646	Per Sample Data Time 0.00094	Per Sample DNN Time 0.00553	Train Loss 0.1522	
start validation
acc: 0.723005
AUC: 0.913229
Avg Precision: 0.459648
Avg Recall: 1.000000
d_prime: 1.924622
train_loss: 0.152254
valid_loss: 1.328425
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0016512135134668926
Epoch-18 lr: 0.004953640540400678
epoch 18 training time: 15.084
---------------
2023-09-24 13:19:02.336905
current #epochs=19, #steps=702
start validation
acc: 0.723005
AUC: 0.902653
Avg Precision: 0.460493
Avg Recall: 1.000000
d_prime: 1.833980
train_loss: 0.151054
valid_loss: 1.351019
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0016512135134668926
Epoch-19 lr: 0.004953640540400678
epoch 19 training time: 15.029
---------------
2023-09-24 13:19:17.365453
current #epochs=20, #steps=741
start validation
acc: 0.699531
AUC: 0.911393
Avg Precision: 0.474707
Avg Recall: 1.000000
d_prime: 1.908319
train_loss: 0.145334
valid_loss: 1.346056
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0013853709338050443
Epoch-20 lr: 0.004156112801415133
epoch 20 training time: 16.092
---------------
2023-09-24 13:19:33.457913
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00562	Train Loss 0.1355	
start validation
acc: 0.699531
AUC: 0.895287
Avg Precision: 0.472657
Avg Recall: 1.000000
d_prime: 1.775044
train_loss: 0.130067
valid_loss: 1.346457
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0013853709338050443
Epoch-21 lr: 0.004156112801415133
epoch 21 training time: 14.999
---------------
2023-09-24 13:19:48.457268
current #epochs=22, #steps=819
start validation
acc: 0.699531
AUC: 0.899859
Avg Precision: 0.463434
Avg Recall: 1.000000
d_prime: 1.811250
train_loss: 0.108861
valid_loss: 1.351005
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.0013853709338050443
Epoch-22 lr: 0.004156112801415133
epoch 22 training time: 15.227
---------------
2023-09-24 13:20:03.684378
current #epochs=23, #steps=858
start validation
acc: 0.685446
AUC: 0.895002
Avg Precision: 0.477667
Avg Recall: 1.000000
d_prime: 1.772826
train_loss: 0.101540
valid_loss: 1.348818
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.0013853709338050443
Epoch-23 lr: 0.004156112801415133
epoch 23 training time: 14.989
---------------
2023-09-24 13:20:18.673165
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01368	Per Sample Data Time 0.00753	Per Sample DNN Time 0.00615	Train Loss 0.1331	
start validation
acc: 0.723005
AUC: 0.902526
Avg Precision: 0.456049
Avg Recall: 1.000000
d_prime: 1.832932
train_loss: 0.144955
valid_loss: 1.353528
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0013853709338050443
Epoch-24 lr: 0.004156112801415133
epoch 24 training time: 14.945
---------------
2023-09-24 13:20:33.617981
current #epochs=25, #steps=936
start validation
acc: 0.671362
AUC: 0.892346
Avg Precision: 0.472280
Avg Recall: 1.000000
d_prime: 1.752354
train_loss: 0.143704
valid_loss: 1.362506
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0011623285593164703
Epoch-25 lr: 0.003486985677949411
epoch 25 training time: 15.143
---------------
2023-09-24 13:20:48.760953
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00687	Per Sample Data Time 0.00128	Per Sample DNN Time 0.00559	Train Loss 0.1314	
start validation
acc: 0.713615
AUC: 0.898645
Avg Precision: 0.477950
Avg Recall: 1.000000
d_prime: 1.801519
train_loss: 0.122817
valid_loss: 1.353336
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0011623285593164703
Epoch-26 lr: 0.003486985677949411
epoch 26 training time: 16.638
---------------
2023-09-24 13:21:05.398788
current #epochs=27, #steps=1014
start validation
acc: 0.704225
AUC: 0.884730
Avg Precision: 0.471955
Avg Recall: 1.000000
d_prime: 1.695597
train_loss: 0.115307
valid_loss: 1.360608
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0011623285593164703
Epoch-27 lr: 0.003486985677949411
epoch 27 training time: 15.224
---------------
2023-09-24 13:21:20.622560
current #epochs=28, #steps=1053
start validation
acc: 0.713615
AUC: 0.891831
Avg Precision: 0.460633
Avg Recall: 1.000000
d_prime: 1.748424
train_loss: 0.110048
valid_loss: 1.357053
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0011623285593164703
Epoch-28 lr: 0.003486985677949411
epoch 28 training time: 15.030
---------------
2023-09-24 13:21:35.652699
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00948	Per Sample Data Time 0.00364	Per Sample DNN Time 0.00584	Train Loss 0.1147	
start validation
acc: 0.713615
AUC: 0.892467
Avg Precision: 0.471311
Avg Recall: 1.000000
d_prime: 1.753280
train_loss: 0.128815
valid_loss: 1.345708
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0011623285593164703
Epoch-29 lr: 0.003486985677949411
epoch 29 training time: 15.243
---------------
2023-09-24 13:21:50.896242
current #epochs=30, #steps=1131
start validation
acc: 0.685446
AUC: 0.881078
Avg Precision: 0.461156
Avg Recall: 1.000000
d_prime: 1.669329
train_loss: 0.122871
valid_loss: 1.367193
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0009751956294420289
Epoch-30 lr: 0.0029255868883260867
epoch 30 training time: 15.079
---------------
2023-09-24 13:22:05.975037
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00664	Per Sample Data Time 0.00110	Per Sample DNN Time 0.00554	Train Loss 0.1238	
start validation
acc: 0.680751
AUC: 0.881890
Avg Precision: 0.436908
Avg Recall: 1.000000
d_prime: 1.675116
train_loss: 0.133571
valid_loss: 1.348750
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0009751956294420289
Epoch-31 lr: 0.0029255868883260867
epoch 31 training time: 15.009
---------------
2023-09-24 13:22:20.984427
current #epochs=32, #steps=1209
start validation
acc: 0.690141
AUC: 0.887562
Avg Precision: 0.484465
Avg Recall: 1.000000
d_prime: 1.716379
train_loss: 0.119562
valid_loss: 1.345129
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0009751956294420289
Epoch-32 lr: 0.0029255868883260867
epoch 32 training time: 14.974
---------------
2023-09-24 13:22:35.957959
current #epochs=33, #steps=1248
start validation
acc: 0.704225
AUC: 0.898925
Avg Precision: 0.484291
Avg Recall: 1.000000
d_prime: 1.803756
train_loss: 0.119040
valid_loss: 1.336510
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0009751956294420289
Epoch-33 lr: 0.0029255868883260867
epoch 33 training time: 15.170
---------------
2023-09-24 13:22:51.128433
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00782	Per Sample Data Time 0.00232	Per Sample DNN Time 0.00550	Train Loss 0.1218	
start validation
acc: 0.685446
AUC: 0.892264
Avg Precision: 0.442132
Avg Recall: 1.000000
d_prime: 1.751727
train_loss: 0.111086
valid_loss: 1.345576
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0009751956294420289
Epoch-34 lr: 0.0029255868883260867
epoch 34 training time: 15.030
---------------
2023-09-24 13:23:06.158353
current #epochs=35, #steps=1326
start validation
acc: 0.713615
AUC: 0.899245
Avg Precision: 0.484116
Avg Recall: 1.000000
d_prime: 1.806317
train_loss: 0.100940
valid_loss: 1.335065
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0008181907844044481
Epoch-35 lr: 0.0024545723532133443
epoch 35 training time: 14.954
---------------
2023-09-24 13:23:21.112164
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00661	Per Sample Data Time 0.00100	Per Sample DNN Time 0.00561	Train Loss 0.0955	
start validation
acc: 0.704225
AUC: 0.899347
Avg Precision: 0.470971
Avg Recall: 1.000000
d_prime: 1.807140
train_loss: 0.092904
valid_loss: 1.334251
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0008181907844044481
Epoch-36 lr: 0.0024545723532133443
epoch 36 training time: 15.190
---------------
2023-09-24 13:23:36.302050
current #epochs=37, #steps=1404
start validation
acc: 0.699531
AUC: 0.887669
Avg Precision: 0.453617
Avg Recall: 1.000000
d_prime: 1.717170
train_loss: 0.108103
valid_loss: 1.346815
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.0008181907844044481
Epoch-37 lr: 0.0024545723532133443
epoch 37 training time: 15.091
---------------
2023-09-24 13:23:51.393623
current #epochs=38, #steps=1443
start validation
acc: 0.690141
AUC: 0.891151
Avg Precision: 0.472776
Avg Recall: 1.000000
d_prime: 1.743264
train_loss: 0.121280
valid_loss: 1.351493
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.0008181907844044481
Epoch-38 lr: 0.0024545723532133443
epoch 38 training time: 15.870
---------------
2023-09-24 13:24:07.263916
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00737	Per Sample Data Time 0.00177	Per Sample DNN Time 0.00560	Train Loss 0.1236	
start validation
acc: 0.699531
AUC: 0.899818
Avg Precision: 0.436063
Avg Recall: 1.000000
d_prime: 1.810924
train_loss: 0.127639
valid_loss: 1.343779
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.0008181907844044481
Epoch-39 lr: 0.0024545723532133443
epoch 39 training time: 15.109
---------------
2023-09-24 13:24:22.372982
current #epochs=40, #steps=1521
start validation
[I 2023-09-24 13:24:37,452] Trial 24 finished with value: 0.46231784020842454 and parameters: {'warmup': 'False', 'num_epochs': 40, 'batch_size': 36, 'lr-adaptschedule': 'False', 'lr': 0.002345727501231712, 'head-lr': 3, 'lr-scheduler-start': 10, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.8390016933039238}. Best is trial 14 with value: 0.47138807158347623.
acc: 0.723005
AUC: 0.897403
Avg Precision: 0.462318
Avg Recall: 1.000000
d_prime: 1.791657
train_loss: 0.087692
valid_loss: 1.344507
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.0006864634535609976
Epoch-40 lr: 0.002059390360682993
epoch 40 training time: 15.073
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa609ecd040>
The learning rate scheduler starts at 9 epoch with decay rate of 0.875 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 13:24:37.485901
current #epochs=1, #steps=0
start validation
acc: 0.690141
AUC: 0.884612
Avg Precision: 0.479463
Avg Recall: 1.000000
d_prime: 1.694744
train_loss: 0.299936
valid_loss: 1.390453
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.00290404625815596
Epoch-1 lr: 0.00580809251631192
epoch 1 training time: 17.548
---------------
2023-09-24 13:24:55.034173
current #epochs=2, #steps=39
start validation
acc: 0.699531
AUC: 0.928487
Avg Precision: 0.497331
Avg Recall: 1.000000
d_prime: 2.071281
train_loss: 0.188316
valid_loss: 1.330149
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.00290404625815596
Epoch-2 lr: 0.00580809251631192
epoch 2 training time: 17.560
---------------
2023-09-24 13:25:12.594144
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00703	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00557	Train Loss 0.1485	
start validation
acc: 0.699531
AUC: 0.903916
Avg Precision: 0.471111
Avg Recall: 1.000000
d_prime: 1.844410
train_loss: 0.157489
valid_loss: 1.354812
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.00290404625815596
Epoch-3 lr: 0.00580809251631192
epoch 3 training time: 15.644
---------------
2023-09-24 13:25:28.238547
current #epochs=4, #steps=117
start validation
acc: 0.727700
AUC: 0.907047
Avg Precision: 0.466914
Avg Recall: 1.000000
d_prime: 1.870701
train_loss: 0.161663
valid_loss: 1.331091
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00290404625815596
Epoch-4 lr: 0.00580809251631192
epoch 4 training time: 17.447
---------------
2023-09-24 13:25:45.685923
current #epochs=5, #steps=156
start validation
acc: 0.657277
AUC: 0.889504
Avg Precision: 0.462000
Avg Recall: 1.000000
d_prime: 1.730847
train_loss: 0.243412
valid_loss: 1.372417
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00290404625815596
Epoch-5 lr: 0.00580809251631192
epoch 5 training time: 15.011
---------------
2023-09-24 13:26:00.696730
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01078	Per Sample Data Time 0.00523	Per Sample DNN Time 0.00556	Train Loss 0.2531	
start validation
acc: 0.746479
AUC: 0.917944
Avg Precision: 0.461548
Avg Recall: 1.000000
d_prime: 1.967697
train_loss: 0.220241
valid_loss: 1.329368
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00290404625815596
Epoch-6 lr: 0.00580809251631192
epoch 6 training time: 17.640
---------------
2023-09-24 13:26:18.336560
current #epochs=7, #steps=234
start validation
acc: 0.694836
AUC: 0.901783
Avg Precision: 0.458430
Avg Recall: 1.000000
d_prime: 1.826851
train_loss: 0.160424
valid_loss: 1.340432
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00290404625815596
Epoch-7 lr: 0.00580809251631192
epoch 7 training time: 15.087
---------------
2023-09-24 13:26:33.423390
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00677	Per Sample Data Time 0.00120	Per Sample DNN Time 0.00557	Train Loss 0.2263	
start validation
acc: 0.708920
AUC: 0.911088
Avg Precision: 0.480992
Avg Recall: 1.000000
d_prime: 1.905634
train_loss: 0.221652
valid_loss: 1.330953
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00290404625815596
Epoch-8 lr: 0.00580809251631192
epoch 8 training time: 16.598
---------------
2023-09-24 13:26:50.021071
current #epochs=9, #steps=312
start validation
acc: 0.685446
AUC: 0.905491
Avg Precision: 0.452329
Avg Recall: 1.000000
d_prime: 1.857551
train_loss: 0.152919
valid_loss: 1.342144
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0025403402609418214
Epoch-9 lr: 0.005080680521883643
epoch 9 training time: 15.219
---------------
2023-09-24 13:27:05.239620
current #epochs=10, #steps=351
start validation
acc: 0.713615
AUC: 0.908817
Avg Precision: 0.444184
Avg Recall: 1.000000
d_prime: 1.885862
train_loss: 0.175136
valid_loss: 1.334209
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.002222185209081263
Epoch-10 lr: 0.004444370418162526
epoch 10 training time: 15.154
---------------
2023-09-24 13:27:20.394071
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00856	Per Sample Data Time 0.00290	Per Sample DNN Time 0.00565	Train Loss 0.1454	
start validation
acc: 0.737089
AUC: 0.911765
Avg Precision: 0.459395
Avg Recall: 1.000000
d_prime: 1.911597
train_loss: 0.140062
valid_loss: 1.330227
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.001943876251297435
Epoch-11 lr: 0.00388775250259487
epoch 11 training time: 14.995
---------------
2023-09-24 13:27:35.389429
current #epochs=12, #steps=429
start validation
acc: 0.727700
AUC: 0.904830
Avg Precision: 0.451704
Avg Recall: 1.000000
d_prime: 1.852019
train_loss: 0.138360
valid_loss: 1.336817
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0017004230182597654
Epoch-12 lr: 0.003400846036519531
epoch 12 training time: 15.187
---------------
2023-09-24 13:27:50.576682
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00658	Per Sample Data Time 0.00104	Per Sample DNN Time 0.00554	Train Loss 0.0941	
start validation
acc: 0.690141
AUC: 0.901300
Avg Precision: 0.474310
Avg Recall: 1.000000
d_prime: 1.822911
train_loss: 0.089604
valid_loss: 1.337706
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0014874601400669243
Epoch-13 lr: 0.0029749202801338487
epoch 13 training time: 15.106
---------------
2023-09-24 13:28:05.682547
current #epochs=14, #steps=507
start validation
acc: 0.718310
AUC: 0.908571
Avg Precision: 0.466182
Avg Recall: 1.000000
d_prime: 1.883741
train_loss: 0.135546
valid_loss: 1.342017
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0013011689706201774
Epoch-14 lr: 0.002602337941240355
epoch 14 training time: 14.973
---------------
2023-09-24 13:28:20.655986
current #epochs=15, #steps=546
start validation
acc: 0.760563
AUC: 0.906491
Avg Precision: 0.476763
Avg Recall: 1.000000
d_prime: 1.865984
train_loss: 0.097361
valid_loss: 1.324278
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0011382091153236539
Epoch-15 lr: 0.0022764182306473078
epoch 15 training time: 17.300
---------------
2023-09-24 13:28:37.956308
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00780	Per Sample Data Time 0.00202	Per Sample DNN Time 0.00578	Train Loss 0.1106	
start validation
acc: 0.676056
AUC: 0.899450
Avg Precision: 0.459810
Avg Recall: 1.000000
d_prime: 1.807967
train_loss: 0.103199
valid_loss: 1.350890
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0009956585343319168
Epoch-16 lr: 0.0019913170686638336
epoch 16 training time: 15.146
---------------
2023-09-24 13:28:53.102678
current #epochs=17, #steps=624
start validation
acc: 0.708920
AUC: 0.887558
Avg Precision: 0.465980
Avg Recall: 1.000000
d_prime: 1.716351
train_loss: 0.113171
valid_loss: 1.344677
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0008709611473337135
Epoch-17 lr: 0.001741922294667427
epoch 17 training time: 15.189
---------------
2023-09-24 13:29:08.292120
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00647	Per Sample Data Time 0.00096	Per Sample DNN Time 0.00552	Train Loss 0.1194	
start validation
acc: 0.699531
AUC: 0.895907
Avg Precision: 0.452337
Avg Recall: 1.000000
d_prime: 1.779888
train_loss: 0.118018
valid_loss: 1.344566
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0007618810003711349
Epoch-18 lr: 0.0015237620007422699
epoch 18 training time: 15.122
---------------
2023-09-24 13:29:23.414078
current #epochs=19, #steps=702
start validation
[I 2023-09-24 13:29:38,407] Trial 25 finished with value: 0.4681137810602097 and parameters: {'warmup': 'False', 'num_epochs': 19, 'batch_size': 28, 'lr-adaptschedule': 'False', 'lr': 0.00290404625815596, 'head-lr': 2, 'lr-scheduler-start': 9, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.8747588829920745}. Best is trial 14 with value: 0.47138807158347623.
acc: 0.713615
AUC: 0.902669
Avg Precision: 0.468114
Avg Recall: 1.000000
d_prime: 1.834108
train_loss: 0.137211
valid_loss: 1.345397
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0006664621728575383
Epoch-19 lr: 0.0013329243457150767
epoch 19 training time: 14.985
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f4924c0>
The learning rate scheduler starts at 8 epoch with decay rate of 0.814 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 13:29:38.443139
current #epochs=1, #steps=0
start validation
acc: 0.699531
AUC: 0.897083
Avg Precision: 0.460615
Avg Recall: 1.000000
d_prime: 1.789129
train_loss: 0.145981
valid_loss: 1.334538
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0011442536217630293
Epoch-1 lr: 0.0011442536217630293
epoch 1 training time: 17.284
---------------
2023-09-24 13:29:55.727965
current #epochs=2, #steps=39
start validation
acc: 0.732394
AUC: 0.904264
Avg Precision: 0.453868
Avg Recall: 1.000000
d_prime: 1.847299
train_loss: 0.096881
valid_loss: 1.317468
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0011442536217630293
Epoch-2 lr: 0.0011442536217630293
epoch 2 training time: 17.470
---------------
2023-09-24 13:30:13.197410
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00561	Train Loss 0.1232	
start validation
acc: 0.732394
AUC: 0.899550
Avg Precision: 0.430645
Avg Recall: 1.000000
d_prime: 1.808764
train_loss: 0.102369
valid_loss: 1.326356
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0011442536217630293
Epoch-3 lr: 0.0011442536217630293
epoch 3 training time: 15.077
---------------
2023-09-24 13:30:28.275258
current #epochs=4, #steps=117
start validation
acc: 0.704225
AUC: 0.900553
Avg Precision: 0.456664
Avg Recall: 1.000000
d_prime: 1.816849
train_loss: 0.129493
valid_loss: 1.350170
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0011442536217630293
Epoch-4 lr: 0.0011442536217630293
epoch 4 training time: 15.073
---------------
2023-09-24 13:30:43.348402
current #epochs=5, #steps=156
start validation
acc: 0.727700
AUC: 0.902988
Avg Precision: 0.456764
Avg Recall: 1.000000
d_prime: 1.836735
train_loss: 0.104334
valid_loss: 1.345833
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0011442536217630293
Epoch-5 lr: 0.0011442536217630293
epoch 5 training time: 15.544
---------------
2023-09-24 13:30:58.892377
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01094	Per Sample Data Time 0.00527	Per Sample DNN Time 0.00567	Train Loss 0.1155	
start validation
acc: 0.741784
AUC: 0.904955
Avg Precision: 0.458558
Avg Recall: 1.000000
d_prime: 1.853064
train_loss: 0.103047
valid_loss: 1.330235
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0011442536217630293
Epoch-6 lr: 0.0011442536217630293
epoch 6 training time: 18.241
---------------
2023-09-24 13:31:17.133416
current #epochs=7, #steps=234
start validation
acc: 0.727700
AUC: 0.898334
Avg Precision: 0.478693
Avg Recall: 1.000000
d_prime: 1.799046
train_loss: 0.123408
valid_loss: 1.346912
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0011442536217630293
Epoch-7 lr: 0.0011442536217630293
epoch 7 training time: 15.030
---------------
2023-09-24 13:31:32.163482
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00680	Per Sample Data Time 0.00124	Per Sample DNN Time 0.00556	Train Loss 0.1039	
start validation
acc: 0.718310
AUC: 0.890864
Avg Precision: 0.466631
Avg Recall: 1.000000
d_prime: 1.741086
train_loss: 0.101553
valid_loss: 1.356541
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.000930984582007665
Epoch-8 lr: 0.000930984582007665
epoch 8 training time: 15.140
---------------
2023-09-24 13:31:47.303078
current #epochs=9, #steps=312
start validation
acc: 0.718310
AUC: 0.897518
Avg Precision: 0.459574
Avg Recall: 1.000000
d_prime: 1.792569
train_loss: 0.094367
valid_loss: 1.353842
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.000930984582007665
Epoch-9 lr: 0.000930984582007665
epoch 9 training time: 15.005
---------------
2023-09-24 13:32:02.308638
current #epochs=10, #steps=351
start validation
acc: 0.699531
AUC: 0.904241
Avg Precision: 0.482337
Avg Recall: 1.000000
d_prime: 1.847109
train_loss: 0.100438
valid_loss: 1.347204
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0007574651942989294
Epoch-10 lr: 0.0007574651942989294
epoch 10 training time: 15.079
---------------
2023-09-24 13:32:17.387787
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00870	Per Sample Data Time 0.00297	Per Sample DNN Time 0.00573	Train Loss 0.1166	
start validation
acc: 0.718310
AUC: 0.907633
Avg Precision: 0.441838
Avg Recall: 1.000000
d_prime: 1.875701
train_loss: 0.121613
valid_loss: 1.341286
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0007574651942989294
Epoch-11 lr: 0.0007574651942989294
epoch 11 training time: 15.214
---------------
2023-09-24 13:32:32.601731
current #epochs=12, #steps=429
start validation
acc: 0.755869
AUC: 0.905523
Avg Precision: 0.497397
Avg Recall: 1.000000
d_prime: 1.857826
train_loss: 0.081678
valid_loss: 1.333161
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.000616286812545292
Epoch-12 lr: 0.000616286812545292
epoch 12 training time: 17.462
---------------
2023-09-24 13:32:50.063525
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00653	Per Sample Data Time 0.00103	Per Sample DNN Time 0.00550	Train Loss 0.1086	
start validation
acc: 0.718310
AUC: 0.908783
Avg Precision: 0.481280
Avg Recall: 1.000000
d_prime: 1.885567
train_loss: 0.107828
valid_loss: 1.340919
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.000616286812545292
Epoch-13 lr: 0.000616286812545292
epoch 13 training time: 14.986
---------------
2023-09-24 13:33:05.049513
current #epochs=14, #steps=507
start validation
acc: 0.723005
AUC: 0.902787
Avg Precision: 0.497361
Avg Recall: 1.000000
d_prime: 1.835081
train_loss: 0.083399
valid_loss: 1.341365
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0005014216338597153
Epoch-14 lr: 0.0005014216338597153
epoch 14 training time: 15.108
---------------
2023-09-24 13:33:20.157532
current #epochs=15, #steps=546
start validation
acc: 0.746479
AUC: 0.903369
Avg Precision: 0.483278
Avg Recall: 1.000000
d_prime: 1.839874
train_loss: 0.090616
valid_loss: 1.334344
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0005014216338597153
Epoch-15 lr: 0.0005014216338597153
epoch 15 training time: 15.045
---------------
2023-09-24 13:33:35.202747
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00759	Per Sample Data Time 0.00205	Per Sample DNN Time 0.00554	Train Loss 0.0764	
start validation
acc: 0.718310
AUC: 0.902319
Avg Precision: 0.474006
Avg Recall: 1.000000
d_prime: 1.831239
train_loss: 0.097054
valid_loss: 1.330221
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.00040796533332289797
Epoch-16 lr: 0.00040796533332289797
epoch 16 training time: 14.986
---------------
2023-09-24 13:33:50.188497
current #epochs=17, #steps=624
start validation
acc: 0.708920
AUC: 0.892831
Avg Precision: 0.440332
Avg Recall: 1.000000
d_prime: 1.756062
train_loss: 0.135256
valid_loss: 1.349615
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.00040796533332289797
Epoch-17 lr: 0.00040796533332289797
epoch 17 training time: 15.025
---------------
2023-09-24 13:34:05.213972
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00649	Per Sample Data Time 0.00095	Per Sample DNN Time 0.00554	Train Loss 0.0953	
start validation
acc: 0.713615
AUC: 0.892854
Avg Precision: 0.451099
Avg Recall: 1.000000
d_prime: 1.756242
train_loss: 0.094127
valid_loss: 1.344780
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0003319276671652895
Epoch-18 lr: 0.0003319276671652895
epoch 18 training time: 16.263
---------------
2023-09-24 13:34:21.476710
current #epochs=19, #steps=702
start validation
acc: 0.727700
AUC: 0.895113
Avg Precision: 0.449488
Avg Recall: 1.000000
d_prime: 1.773686
train_loss: 0.085277
valid_loss: 1.342663
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0003319276671652895
Epoch-19 lr: 0.0003319276671652895
epoch 19 training time: 15.120
---------------
2023-09-24 13:34:36.596873
current #epochs=20, #steps=741
start validation
acc: 0.732394
AUC: 0.889640
Avg Precision: 0.452975
Avg Recall: 1.000000
d_prime: 1.731872
train_loss: 0.091573
valid_loss: 1.350661
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0002700621038861376
Epoch-20 lr: 0.0002700621038861376
epoch 20 training time: 15.067
---------------
2023-09-24 13:34:51.663589
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00732	Per Sample Data Time 0.00170	Per Sample DNN Time 0.00562	Train Loss 0.0814	
start validation
acc: 0.708920
AUC: 0.893727
Avg Precision: 0.453449
Avg Recall: 1.000000
d_prime: 1.762951
train_loss: 0.082435
valid_loss: 1.350870
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0002700621038861376
Epoch-21 lr: 0.0002700621038861376
epoch 21 training time: 15.157
---------------
2023-09-24 13:35:06.820329
current #epochs=22, #steps=819
start validation
acc: 0.718310
AUC: 0.897515
Avg Precision: 0.471963
Avg Recall: 1.000000
d_prime: 1.792542
train_loss: 0.064111
valid_loss: 1.346809
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00021972720917864423
Epoch-22 lr: 0.00021972720917864423
epoch 22 training time: 15.026
---------------
2023-09-24 13:35:21.846814
current #epochs=23, #steps=858
start validation
acc: 0.732394
AUC: 0.896221
Avg Precision: 0.471061
Avg Recall: 1.000000
d_prime: 1.782344
train_loss: 0.087453
valid_loss: 1.354792
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00021972720917864423
Epoch-23 lr: 0.00021972720917864423
epoch 23 training time: 15.179
---------------
2023-09-24 13:35:37.026234
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01376	Per Sample Data Time 0.00776	Per Sample DNN Time 0.00600	Train Loss 0.0991	
start validation
acc: 0.708920
AUC: 0.895635
Avg Precision: 0.474507
Avg Recall: 1.000000
d_prime: 1.777756
train_loss: 0.079001
valid_loss: 1.350568
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00017877386630221656
Epoch-24 lr: 0.00017877386630221656
epoch 24 training time: 15.177
---------------
2023-09-24 13:35:52.203224
current #epochs=25, #steps=936
start validation
acc: 0.704225
AUC: 0.893340
Avg Precision: 0.478548
Avg Recall: 1.000000
d_prime: 1.759972
train_loss: 0.076258
valid_loss: 1.352161
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00017877386630221656
Epoch-25 lr: 0.00017877386630221656
epoch 25 training time: 15.126
---------------
2023-09-24 13:36:07.328757
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00691	Per Sample Data Time 0.00136	Per Sample DNN Time 0.00555	Train Loss 0.0751	
start validation
acc: 0.713615
AUC: 0.893802
Avg Precision: 0.477228
Avg Recall: 1.000000
d_prime: 1.763531
train_loss: 0.073529
valid_loss: 1.351346
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00014545351662232403
Epoch-26 lr: 0.00014545351662232403
epoch 26 training time: 15.088
---------------
2023-09-24 13:36:22.416851
current #epochs=27, #steps=1014
start validation
acc: 0.713615
AUC: 0.892658
Avg Precision: 0.476307
Avg Recall: 1.000000
d_prime: 1.754742
train_loss: 0.069012
valid_loss: 1.349769
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00014545351662232403
Epoch-27 lr: 0.00014545351662232403
epoch 27 training time: 15.019
---------------
2023-09-24 13:36:37.435943
current #epochs=28, #steps=1053
start validation
acc: 0.694836
AUC: 0.892953
Avg Precision: 0.468607
Avg Recall: 1.000000
d_prime: 1.757000
train_loss: 0.084693
valid_loss: 1.350655
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00011834350252309992
Epoch-28 lr: 0.00011834350252309992
epoch 28 training time: 15.015
---------------
2023-09-24 13:36:52.450560
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00934	Per Sample Data Time 0.00358	Per Sample DNN Time 0.00576	Train Loss 0.0614	
start validation
acc: 0.708920
AUC: 0.896091
Avg Precision: 0.476052
Avg Recall: 1.000000
d_prime: 1.781329
train_loss: 0.073532
valid_loss: 1.349998
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00011834350252309992
Epoch-29 lr: 0.00011834350252309992
epoch 29 training time: 15.154
---------------
2023-09-24 13:37:07.604370
current #epochs=30, #steps=1131
start validation
acc: 0.694836
AUC: 0.898053
Avg Precision: 0.476895
Avg Recall: 1.000000
d_prime: 1.796804
train_loss: 0.061190
valid_loss: 1.349311
validation finished
normal learning rate scheduler step
Epoch-30 lr: 9.628632510687238e-05
Epoch-30 lr: 9.628632510687238e-05
epoch 30 training time: 15.139
---------------
2023-09-24 13:37:22.743300
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00663	Per Sample Data Time 0.00111	Per Sample DNN Time 0.00552	Train Loss 0.0875	
start validation
acc: 0.713615
AUC: 0.897119
Avg Precision: 0.475557
Avg Recall: 1.000000
d_prime: 1.789413
train_loss: 0.086282
valid_loss: 1.346139
validation finished
normal learning rate scheduler step
Epoch-31 lr: 9.628632510687238e-05
Epoch-31 lr: 9.628632510687238e-05
epoch 31 training time: 15.202
---------------
2023-09-24 13:37:37.945870
current #epochs=32, #steps=1209
start validation
acc: 0.718310
AUC: 0.897115
Avg Precision: 0.477915
Avg Recall: 1.000000
d_prime: 1.789380
train_loss: 0.069384
valid_loss: 1.348868
validation finished
normal learning rate scheduler step
Epoch-32 lr: 7.834022320555088e-05
Epoch-32 lr: 7.834022320555088e-05
epoch 32 training time: 15.417
---------------
2023-09-24 13:37:53.362839
current #epochs=33, #steps=1248
start validation
acc: 0.704225
AUC: 0.897326
Avg Precision: 0.479219
Avg Recall: 1.000000
d_prime: 1.791044
train_loss: 0.084146
valid_loss: 1.350390
validation finished
normal learning rate scheduler step
Epoch-33 lr: 7.834022320555088e-05
Epoch-33 lr: 7.834022320555088e-05
epoch 33 training time: 15.222
---------------
2023-09-24 13:38:08.585029
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00784	Per Sample Data Time 0.00227	Per Sample DNN Time 0.00557	Train Loss 0.1111	
start validation
acc: 0.718310
AUC: 0.897929
Avg Precision: 0.478259
Avg Recall: 1.000000
d_prime: 1.795827
train_loss: 0.086458
valid_loss: 1.346394
validation finished
normal learning rate scheduler step
Epoch-34 lr: 6.373896360759016e-05
Epoch-34 lr: 6.373896360759016e-05
epoch 34 training time: 14.911
---------------
2023-09-24 13:38:23.495902
current #epochs=35, #steps=1326
start validation
acc: 0.723005
AUC: 0.898500
Avg Precision: 0.477039
Avg Recall: 1.000000
d_prime: 1.800362
train_loss: 0.091845
valid_loss: 1.342959
validation finished
normal learning rate scheduler step
Epoch-35 lr: 6.373896360759016e-05
Epoch-35 lr: 6.373896360759016e-05
epoch 35 training time: 15.136
---------------
2023-09-24 13:38:38.632074
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00650	Per Sample Data Time 0.00096	Per Sample DNN Time 0.00553	Train Loss 0.0771	
start validation
acc: 0.727700
AUC: 0.900043
Avg Precision: 0.476929
Avg Recall: 1.000000
d_prime: 1.812735
train_loss: 0.076968
valid_loss: 1.343433
validation finished
normal learning rate scheduler step
Epoch-36 lr: 5.1859125689621965e-05
Epoch-36 lr: 5.1859125689621965e-05
epoch 36 training time: 16.653
---------------
2023-09-24 13:38:55.284679
current #epochs=37, #steps=1404
start validation
acc: 0.727700
AUC: 0.899158
Avg Precision: 0.477339
Avg Recall: 1.000000
d_prime: 1.805623
train_loss: 0.078886
valid_loss: 1.342925
validation finished
normal learning rate scheduler step
Epoch-37 lr: 5.1859125689621965e-05
Epoch-37 lr: 5.1859125689621965e-05
epoch 37 training time: 15.133
---------------
2023-09-24 13:39:10.418197
current #epochs=38, #steps=1443
start validation
[I 2023-09-24 13:39:25,572] Trial 26 finished with value: 0.4691406198866462 and parameters: {'warmup': 'False', 'num_epochs': 38, 'batch_size': 26, 'lr-adaptschedule': 'False', 'lr': 0.0011442536217630293, 'head-lr': 1, 'lr-scheduler-start': 8, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.813617334741955}. Best is trial 14 with value: 0.47138807158347623.
acc: 0.732394
AUC: 0.898789
Avg Precision: 0.469141
Avg Recall: 1.000000
d_prime: 1.802670
train_loss: 0.097441
valid_loss: 1.342540
validation finished
normal learning rate scheduler step
Epoch-38 lr: 4.219348362563827e-05
Epoch-38 lr: 4.219348362563827e-05
epoch 38 training time: 15.148
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa609ecdca0>
The learning rate scheduler starts at 9 epoch with decay rate of 0.776 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 13:39:25.605530
current #epochs=1, #steps=0
start validation
acc: 0.699531
AUC: 0.880667
Avg Precision: 0.473577
Avg Recall: 1.000000
d_prime: 1.666409
train_loss: 0.175765
valid_loss: 1.373281
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0018887929359512367
Epoch-1 lr: 0.0037775858719024734
epoch 1 training time: 17.525
---------------
2023-09-24 13:39:43.130876
current #epochs=2, #steps=39
start validation
acc: 0.690141
AUC: 0.892003
Avg Precision: 0.438227
Avg Recall: 1.000000
d_prime: 1.749733
train_loss: 0.192983
valid_loss: 1.354023
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0018887929359512367
Epoch-2 lr: 0.0037775858719024734
epoch 2 training time: 15.135
---------------
2023-09-24 13:39:58.266374
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00560	Train Loss 0.0914	
start validation
acc: 0.713615
AUC: 0.902438
Avg Precision: 0.478075
Avg Recall: 1.000000
d_prime: 1.832213
train_loss: 0.100636
valid_loss: 1.340299
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0018887929359512367
Epoch-3 lr: 0.0037775858719024734
epoch 3 training time: 17.508
---------------
2023-09-24 13:40:15.774210
current #epochs=4, #steps=117
start validation
acc: 0.746479
AUC: 0.895367
Avg Precision: 0.468604
Avg Recall: 1.000000
d_prime: 1.775668
train_loss: 0.090266
valid_loss: 1.341032
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0018887929359512367
Epoch-4 lr: 0.0037775858719024734
epoch 4 training time: 17.306
---------------
2023-09-24 13:40:33.080496
current #epochs=5, #steps=156
start validation
acc: 0.704225
AUC: 0.886208
Avg Precision: 0.455435
Avg Recall: 1.000000
d_prime: 1.706401
train_loss: 0.145592
valid_loss: 1.359888
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0018887929359512367
Epoch-5 lr: 0.0037775858719024734
epoch 5 training time: 15.110
---------------
2023-09-24 13:40:48.190238
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01101	Per Sample Data Time 0.00534	Per Sample DNN Time 0.00566	Train Loss 0.1185	
start validation
acc: 0.718310
AUC: 0.899156
Avg Precision: 0.465048
Avg Recall: 1.000000
d_prime: 1.805606
train_loss: 0.111031
valid_loss: 1.347870
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0018887929359512367
Epoch-6 lr: 0.0037775858719024734
epoch 6 training time: 15.023
---------------
2023-09-24 13:41:03.212859
current #epochs=7, #steps=234
start validation
acc: 0.708920
AUC: 0.889175
Avg Precision: 0.459737
Avg Recall: 1.000000
d_prime: 1.728386
train_loss: 0.129150
valid_loss: 1.366339
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0018887929359512367
Epoch-7 lr: 0.0037775858719024734
epoch 7 training time: 15.189
---------------
2023-09-24 13:41:18.401359
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00683	Per Sample Data Time 0.00123	Per Sample DNN Time 0.00560	Train Loss 0.1042	
start validation
acc: 0.713615
AUC: 0.892850
Avg Precision: 0.473632
Avg Recall: 1.000000
d_prime: 1.756208
train_loss: 0.110901
valid_loss: 1.359777
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0018887929359512367
Epoch-8 lr: 0.0037775858719024734
epoch 8 training time: 15.138
---------------
2023-09-24 13:41:33.539367
current #epochs=9, #steps=312
start validation
acc: 0.737089
AUC: 0.900640
Avg Precision: 0.480588
Avg Recall: 1.000000
d_prime: 1.817558
train_loss: 0.116484
valid_loss: 1.336667
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0014653478128689235
Epoch-9 lr: 0.002930695625737847
epoch 9 training time: 15.005
---------------
2023-09-24 13:41:48.544463
current #epochs=10, #steps=351
start validation
acc: 0.718310
AUC: 0.897658
Avg Precision: 0.453061
Avg Recall: 1.000000
d_prime: 1.793673
train_loss: 0.149173
valid_loss: 1.343545
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0014653478128689235
Epoch-10 lr: 0.002930695625737847
epoch 10 training time: 15.015
---------------
2023-09-24 13:42:03.559486
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00856	Per Sample Data Time 0.00288	Per Sample DNN Time 0.00568	Train Loss 0.2139	
start validation
acc: 0.704225
AUC: 0.890183
Avg Precision: 0.468269
Avg Recall: 1.000000
d_prime: 1.735952
train_loss: 0.153970
valid_loss: 1.354587
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0014653478128689235
Epoch-11 lr: 0.002930695625737847
epoch 11 training time: 15.072
---------------
2023-09-24 13:42:18.631606
current #epochs=12, #steps=429
start validation
acc: 0.699531
AUC: 0.885493
Avg Precision: 0.452235
Avg Recall: 1.000000
d_prime: 1.701160
train_loss: 0.127645
valid_loss: 1.369623
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0014653478128689235
Epoch-12 lr: 0.002930695625737847
epoch 12 training time: 15.042
---------------
2023-09-24 13:42:33.674154
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00656	Per Sample Data Time 0.00103	Per Sample DNN Time 0.00553	Train Loss 0.1342	
start validation
acc: 0.718310
AUC: 0.895678
Avg Precision: 0.442906
Avg Recall: 1.000000
d_prime: 1.778095
train_loss: 0.124005
valid_loss: 1.344491
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0011368340974858312
Epoch-13 lr: 0.0022736681949716625
epoch 13 training time: 15.026
---------------
2023-09-24 13:42:48.699689
current #epochs=14, #steps=507
start validation
acc: 0.737089
AUC: 0.898284
Avg Precision: 0.473658
Avg Recall: 1.000000
d_prime: 1.798642
train_loss: 0.118146
valid_loss: 1.339182
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0011368340974858312
Epoch-14 lr: 0.0022736681949716625
epoch 14 training time: 15.167
---------------
2023-09-24 13:43:03.866550
current #epochs=15, #steps=546
start validation
acc: 0.694836
AUC: 0.896766
Avg Precision: 0.478239
Avg Recall: 1.000000
d_prime: 1.786626
train_loss: 0.097406
valid_loss: 1.342823
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0011368340974858312
Epoch-15 lr: 0.0022736681949716625
epoch 15 training time: 15.089
---------------
2023-09-24 13:43:18.955624
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00758	Per Sample Data Time 0.00198	Per Sample DNN Time 0.00560	Train Loss 0.1089	
start validation
acc: 0.694836
AUC: 0.895790
Avg Precision: 0.414522
Avg Recall: 1.000000
d_prime: 1.778967
train_loss: 0.109524
valid_loss: 1.353855
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0011368340974858312
Epoch-16 lr: 0.0022736681949716625
epoch 16 training time: 15.017
---------------
2023-09-24 13:43:33.972686
current #epochs=17, #steps=624
start validation
acc: 0.723005
AUC: 0.893420
Avg Precision: 0.465709
Avg Recall: 1.000000
d_prime: 1.760585
train_loss: 0.104582
valid_loss: 1.357203
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.000881969286647463
Epoch-17 lr: 0.001763938573294926
epoch 17 training time: 15.153
---------------
2023-09-24 13:43:49.125433
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00644	Per Sample Data Time 0.00093	Per Sample DNN Time 0.00552	Train Loss 0.1068	
start validation
acc: 0.713615
AUC: 0.903981
Avg Precision: 0.480277
Avg Recall: 1.000000
d_prime: 1.844948
train_loss: 0.112011
valid_loss: 1.339236
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.000881969286647463
Epoch-18 lr: 0.001763938573294926
epoch 18 training time: 15.100
---------------
2023-09-24 13:44:04.225270
current #epochs=19, #steps=702
start validation
acc: 0.690141
AUC: 0.902913
Avg Precision: 0.454976
Avg Recall: 1.000000
d_prime: 1.836114
train_loss: 0.096564
valid_loss: 1.330900
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.000881969286647463
Epoch-19 lr: 0.001763938573294926
epoch 19 training time: 15.126
---------------
2023-09-24 13:44:19.351770
current #epochs=20, #steps=741
start validation
acc: 0.708920
AUC: 0.905860
Avg Precision: 0.480691
Avg Recall: 1.000000
d_prime: 1.860657
train_loss: 0.086257
valid_loss: 1.327508
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.000881969286647463
Epoch-20 lr: 0.001763938573294926
epoch 20 training time: 15.109
---------------
2023-09-24 13:44:34.460330
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00728	Per Sample Data Time 0.00161	Per Sample DNN Time 0.00567	Train Loss 0.0927	
start validation
acc: 0.694836
AUC: 0.904172
Avg Precision: 0.479373
Avg Recall: 1.000000
d_prime: 1.846529
train_loss: 0.096307
valid_loss: 1.336666
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.000684242163662873
Epoch-21 lr: 0.001368484327325746
epoch 21 training time: 15.182
---------------
2023-09-24 13:44:49.642231
current #epochs=22, #steps=819
start validation
acc: 0.718310
AUC: 0.910609
Avg Precision: 0.488748
Avg Recall: 1.000000
d_prime: 1.901435
train_loss: 0.090287
valid_loss: 1.339136
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.000684242163662873
Epoch-22 lr: 0.001368484327325746
epoch 22 training time: 15.093
---------------
2023-09-24 13:45:04.734784
current #epochs=23, #steps=858
start validation
acc: 0.699531
AUC: 0.897697
Avg Precision: 0.471881
Avg Recall: 1.000000
d_prime: 1.793982
train_loss: 0.103311
valid_loss: 1.341637
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.000684242163662873
Epoch-23 lr: 0.001368484327325746
epoch 23 training time: 15.084
---------------
2023-09-24 13:45:19.819199
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01379	Per Sample Data Time 0.00814	Per Sample DNN Time 0.00565	Train Loss 0.1128	
start validation
acc: 0.704225
AUC: 0.892096
Avg Precision: 0.471349
Avg Recall: 1.000000
d_prime: 1.750442
train_loss: 0.093823
valid_loss: 1.346153
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.000684242163662873
Epoch-24 lr: 0.001368484327325746
epoch 24 training time: 15.143
---------------
2023-09-24 13:45:34.962602
current #epochs=25, #steps=936
start validation
acc: 0.708920
AUC: 0.899025
Avg Precision: 0.485249
Avg Recall: 1.000000
d_prime: 1.804561
train_loss: 0.079446
valid_loss: 1.335621
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0005308431320933194
Epoch-25 lr: 0.0010616862641866388
epoch 25 training time: 15.014
---------------
2023-09-24 13:45:49.975947
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00679	Per Sample Data Time 0.00131	Per Sample DNN Time 0.00549	Train Loss 0.1041	
start validation
acc: 0.718310
AUC: 0.902179
Avg Precision: 0.464440
Avg Recall: 1.000000
d_prime: 1.830091
train_loss: 0.096799
valid_loss: 1.334230
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.0005308431320933194
Epoch-26 lr: 0.0010616862641866388
epoch 26 training time: 16.675
---------------
2023-09-24 13:46:06.651234
current #epochs=27, #steps=1014
start validation
acc: 0.699531
AUC: 0.903058
Avg Precision: 0.453508
Avg Recall: 1.000000
d_prime: 1.837309
train_loss: 0.093805
valid_loss: 1.327517
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.0005308431320933194
Epoch-27 lr: 0.0010616862641866388
epoch 27 training time: 14.973
---------------
2023-09-24 13:46:21.624132
current #epochs=28, #steps=1053
start validation
acc: 0.699531
AUC: 0.899840
Avg Precision: 0.466277
Avg Recall: 1.000000
d_prime: 1.811097
train_loss: 0.076572
valid_loss: 1.340020
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.0005308431320933194
Epoch-28 lr: 0.0010616862641866388
epoch 28 training time: 15.114
---------------
2023-09-24 13:46:36.737946
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00936	Per Sample Data Time 0.00358	Per Sample DNN Time 0.00578	Train Loss 0.0917	
start validation
acc: 0.723005
AUC: 0.902263
Avg Precision: 0.467195
Avg Recall: 1.000000
d_prime: 1.830776
train_loss: 0.082786
valid_loss: 1.330535
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.0004118343561030329
Epoch-29 lr: 0.0008236687122060658
epoch 29 training time: 15.240
---------------
2023-09-24 13:46:51.977512
current #epochs=30, #steps=1131
start validation
acc: 0.690141
AUC: 0.898655
Avg Precision: 0.459173
Avg Recall: 1.000000
d_prime: 1.801599
train_loss: 0.084682
valid_loss: 1.344694
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.0004118343561030329
Epoch-30 lr: 0.0008236687122060658
epoch 30 training time: 15.228
---------------
2023-09-24 13:47:07.205858
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00662	Per Sample Data Time 0.00112	Per Sample DNN Time 0.00550	Train Loss 0.1012	
start validation
acc: 0.727700
AUC: 0.899313
Avg Precision: 0.461901
Avg Recall: 1.000000
d_prime: 1.806867
train_loss: 0.096192
valid_loss: 1.337495
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.0004118343561030329
Epoch-31 lr: 0.0008236687122060658
epoch 31 training time: 15.126
---------------
2023-09-24 13:47:22.331799
current #epochs=32, #steps=1209
start validation
acc: 0.699531
AUC: 0.901064
Avg Precision: 0.470986
Avg Recall: 1.000000
d_prime: 1.820995
train_loss: 0.081655
valid_loss: 1.337613
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.0004118343561030329
Epoch-32 lr: 0.0008236687122060658
epoch 32 training time: 15.137
---------------
2023-09-24 13:47:37.469059
current #epochs=33, #steps=1248
start validation
acc: 0.704225
AUC: 0.900997
Avg Precision: 0.474070
Avg Recall: 1.000000
d_prime: 1.820454
train_loss: 0.084112
valid_loss: 1.343077
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.0003195059455662009
Epoch-33 lr: 0.0006390118911324018
epoch 33 training time: 15.148
---------------
2023-09-24 13:47:52.617239
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00791	Per Sample Data Time 0.00227	Per Sample DNN Time 0.00564	Train Loss 0.0768	
start validation
acc: 0.690141
AUC: 0.902724
Avg Precision: 0.454228
Avg Recall: 1.000000
d_prime: 1.834559
train_loss: 0.070447
valid_loss: 1.340471
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.0003195059455662009
Epoch-34 lr: 0.0006390118911324018
epoch 34 training time: 14.976
---------------
2023-09-24 13:48:07.592798
current #epochs=35, #steps=1326
start validation
acc: 0.690141
AUC: 0.900945
Avg Precision: 0.457349
Avg Recall: 1.000000
d_prime: 1.820032
train_loss: 0.084680
valid_loss: 1.338860
validation finished
normal learning rate scheduler step
Epoch-35 lr: 0.0003195059455662009
Epoch-35 lr: 0.0006390118911324018
epoch 35 training time: 15.119
---------------
2023-09-24 13:48:22.711820
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00654	Per Sample Data Time 0.00096	Per Sample DNN Time 0.00557	Train Loss 0.0926	
start validation
acc: 0.685446
AUC: 0.895855
Avg Precision: 0.458011
Avg Recall: 1.000000
d_prime: 1.779475
train_loss: 0.091355
valid_loss: 1.347898
validation finished
normal learning rate scheduler step
Epoch-36 lr: 0.0003195059455662009
Epoch-36 lr: 0.0006390118911324018
epoch 36 training time: 15.051
---------------
2023-09-24 13:48:37.762877
current #epochs=37, #steps=1404
start validation
acc: 0.708920
AUC: 0.897340
Avg Precision: 0.465297
Avg Recall: 1.000000
d_prime: 1.791160
train_loss: 0.078708
valid_loss: 1.346276
validation finished
normal learning rate scheduler step
Epoch-37 lr: 0.00024787647688774344
Epoch-37 lr: 0.0004957529537754869
epoch 37 training time: 15.134
---------------
2023-09-24 13:48:52.897214
current #epochs=38, #steps=1443
start validation
acc: 0.699531
AUC: 0.897022
Avg Precision: 0.468557
Avg Recall: 1.000000
d_prime: 1.788648
train_loss: 0.075788
valid_loss: 1.344665
validation finished
normal learning rate scheduler step
Epoch-38 lr: 0.00024787647688774344
Epoch-38 lr: 0.0004957529537754869
epoch 38 training time: 16.504
---------------
2023-09-24 13:49:09.401033
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00742	Per Sample Data Time 0.00181	Per Sample DNN Time 0.00562	Train Loss 0.0665	
start validation
acc: 0.708920
AUC: 0.899162
Avg Precision: 0.472186
Avg Recall: 1.000000
d_prime: 1.805658
train_loss: 0.069965
valid_loss: 1.341272
validation finished
normal learning rate scheduler step
Epoch-39 lr: 0.00024787647688774344
Epoch-39 lr: 0.0004957529537754869
epoch 39 training time: 15.142
---------------
2023-09-24 13:49:24.542556
current #epochs=40, #steps=1521
start validation
acc: 0.704225
AUC: 0.899147
Avg Precision: 0.484179
Avg Recall: 1.000000
d_prime: 1.805533
train_loss: 0.061960
valid_loss: 1.345302
validation finished
normal learning rate scheduler step
Epoch-40 lr: 0.00024787647688774344
Epoch-40 lr: 0.0004957529537754869
epoch 40 training time: 15.151
---------------
2023-09-24 13:49:39.693376
current #epochs=41, #steps=1560
start validation
acc: 0.694836
AUC: 0.899861
Avg Precision: 0.493611
Avg Recall: 1.000000
d_prime: 1.811270
train_loss: 0.095005
valid_loss: 1.345268
validation finished
normal learning rate scheduler step
Epoch-41 lr: 0.00019230549117136604
Epoch-41 lr: 0.0003846109823427321
epoch 41 training time: 15.045
---------------
2023-09-24 13:49:54.738528
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02305	Per Sample Data Time 0.01563	Per Sample DNN Time 0.00742	Train Loss 0.1988	
start validation
acc: 0.713615
AUC: 0.906596
Avg Precision: 0.476843
Avg Recall: 1.000000
d_prime: 1.866878
train_loss: 0.081478
valid_loss: 1.334480
validation finished
normal learning rate scheduler step
Epoch-42 lr: 0.00019230549117136604
Epoch-42 lr: 0.0003846109823427321
epoch 42 training time: 15.302
---------------
2023-09-24 13:50:10.040551
current #epochs=43, #steps=1638
start validation
acc: 0.713615
AUC: 0.902424
Avg Precision: 0.477428
Avg Recall: 1.000000
d_prime: 1.832094
train_loss: 0.090285
valid_loss: 1.339933
validation finished
normal learning rate scheduler step
Epoch-43 lr: 0.00019230549117136604
Epoch-43 lr: 0.0003846109823427321
epoch 43 training time: 15.051
---------------
2023-09-24 13:50:25.091414
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00558	Train Loss 0.0933	
start validation
acc: 0.694836
AUC: 0.901754
Avg Precision: 0.471039
Avg Recall: 1.000000
d_prime: 1.826614
train_loss: 0.097970
valid_loss: 1.340455
validation finished
normal learning rate scheduler step
Epoch-44 lr: 0.00019230549117136604
Epoch-44 lr: 0.0003846109823427321
epoch 44 training time: 15.120
---------------
2023-09-24 13:50:40.211320
current #epochs=45, #steps=1716
start validation
acc: 0.713615
AUC: 0.901131
Avg Precision: 0.491025
Avg Recall: 1.000000
d_prime: 1.821543
train_loss: 0.071369
valid_loss: 1.340026
validation finished
normal learning rate scheduler step
Epoch-45 lr: 0.00014919286573291188
Epoch-45 lr: 0.00029838573146582375
epoch 45 training time: 15.079
---------------
2023-09-24 13:50:55.290679
current #epochs=46, #steps=1755
start validation
acc: 0.708920
AUC: 0.901615
Avg Precision: 0.488350
Avg Recall: 1.000000
d_prime: 1.825479
train_loss: 0.082538
valid_loss: 1.339852
validation finished
normal learning rate scheduler step
Epoch-46 lr: 0.00014919286573291188
Epoch-46 lr: 0.00029838573146582375
epoch 46 training time: 15.113
---------------
2023-09-24 13:51:10.403211
current #epochs=47, #steps=1794
Epoch: [47][6/39]	Per Sample Total Time 0.01007	Per Sample Data Time 0.00437	Per Sample DNN Time 0.00570	Train Loss 0.1019	
start validation
acc: 0.699531
AUC: 0.901457
Avg Precision: 0.474840
Avg Recall: 1.000000
d_prime: 1.824194
train_loss: 0.095916
valid_loss: 1.336551
validation finished
normal learning rate scheduler step
Epoch-47 lr: 0.00014919286573291188
Epoch-47 lr: 0.00029838573146582375
epoch 47 training time: 15.023
---------------
2023-09-24 13:51:25.426305
current #epochs=48, #steps=1833
start validation
acc: 0.704225
AUC: 0.903233
Avg Precision: 0.474164
Avg Recall: 1.000000
d_prime: 1.838751
train_loss: 0.082039
valid_loss: 1.335358
validation finished
normal learning rate scheduler step
Epoch-48 lr: 0.00014919286573291188
Epoch-48 lr: 0.00029838573146582375
epoch 48 training time: 15.034
---------------
2023-09-24 13:51:40.459763
current #epochs=49, #steps=1872
Epoch: [49][28/39]	Per Sample Total Time 0.00681	Per Sample Data Time 0.00117	Per Sample DNN Time 0.00564	Train Loss 0.0895	
start validation
[I 2023-09-24 13:51:55,606] Trial 27 finished with value: 0.45375157488599904 and parameters: {'warmup': 'True', 'num_epochs': 49, 'batch_size': 19, 'lr-adaptschedule': 'False', 'lr': 0.0018887929359512367, 'head-lr': 2, 'lr-scheduler-start': 9, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.7758117816821158}. Best is trial 14 with value: 0.47138807158347623.
acc: 0.704225
AUC: 0.903083
Avg Precision: 0.453752
Avg Recall: 1.000000
d_prime: 1.837519
train_loss: 0.089426
valid_loss: 1.334852
validation finished
normal learning rate scheduler step
Epoch-49 lr: 0.00011574558297851104
Epoch-49 lr: 0.0002314911659570221
epoch 49 training time: 15.141
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa63ceae2b0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.843 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 13:51:55.639294
current #epochs=1, #steps=0
start validation
acc: 0.699531
AUC: 0.897449
Avg Precision: 0.483699
Avg Recall: 1.000000
d_prime: 1.792022
train_loss: 0.197057
valid_loss: 1.348453
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0025176600323419803
Epoch-1 lr: 0.010070640129367921
epoch 1 training time: 17.511
---------------
2023-09-24 13:52:13.150215
current #epochs=2, #steps=39
start validation
acc: 0.713615
AUC: 0.903991
Avg Precision: 0.470538
Avg Recall: 1.000000
d_prime: 1.845030
train_loss: 0.154138
valid_loss: 1.320226
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0025176600323419803
Epoch-2 lr: 0.010070640129367921
epoch 2 training time: 17.415
---------------
2023-09-24 13:52:30.565358
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00698	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00552	Train Loss 0.1248	
start validation
acc: 0.661972
AUC: 0.894767
Avg Precision: 0.456923
Avg Recall: 1.000000
d_prime: 1.771002
train_loss: 0.138477
valid_loss: 1.351322
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0025176600323419803
Epoch-3 lr: 0.010070640129367921
epoch 3 training time: 14.993
---------------
2023-09-24 13:52:45.558688
current #epochs=4, #steps=117
start validation
acc: 0.690141
AUC: 0.890173
Avg Precision: 0.476667
Avg Recall: 1.000000
d_prime: 1.735875
train_loss: 0.186043
valid_loss: 1.367031
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0025176600323419803
Epoch-4 lr: 0.010070640129367921
epoch 4 training time: 15.071
---------------
2023-09-24 13:53:00.629032
current #epochs=5, #steps=156
start validation
acc: 0.685446
AUC: 0.892501
Avg Precision: 0.466971
Avg Recall: 1.000000
d_prime: 1.753539
train_loss: 0.146627
valid_loss: 1.352639
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0025176600323419803
Epoch-5 lr: 0.010070640129367921
epoch 5 training time: 15.022
---------------
2023-09-24 13:53:15.651434
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01075	Per Sample Data Time 0.00510	Per Sample DNN Time 0.00565	Train Loss 0.0874	
start validation
acc: 0.676056
AUC: 0.899879
Avg Precision: 0.463473
Avg Recall: 1.000000
d_prime: 1.811414
train_loss: 0.128484
valid_loss: 1.353075
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0021214832486135407
Epoch-6 lr: 0.008485932994454163
epoch 6 training time: 15.058
---------------
2023-09-24 13:53:30.709888
current #epochs=7, #steps=234
start validation
acc: 0.718310
AUC: 0.889858
Avg Precision: 0.476325
Avg Recall: 1.000000
d_prime: 1.733506
train_loss: 0.146878
valid_loss: 1.344926
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0021214832486135407
Epoch-7 lr: 0.008485932994454163
epoch 7 training time: 17.443
---------------
2023-09-24 13:53:48.152695
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00681	Per Sample Data Time 0.00123	Per Sample DNN Time 0.00558	Train Loss 0.1816	
start validation
acc: 0.727700
AUC: 0.904032
Avg Precision: 0.488651
Avg Recall: 1.000000
d_prime: 1.845368
train_loss: 0.172643
valid_loss: 1.334573
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0021214832486135407
Epoch-8 lr: 0.008485932994454163
epoch 8 training time: 17.370
---------------
2023-09-24 13:54:05.522875
current #epochs=9, #steps=312
start validation
acc: 0.727700
AUC: 0.889641
Avg Precision: 0.470149
Avg Recall: 1.000000
d_prime: 1.731873
train_loss: 0.126962
valid_loss: 1.345495
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0017876484975460427
Epoch-9 lr: 0.007150593990184171
epoch 9 training time: 15.141
---------------
2023-09-24 13:54:20.664416
current #epochs=10, #steps=351
start validation
acc: 0.727700
AUC: 0.908871
Avg Precision: 0.457890
Avg Recall: 1.000000
d_prime: 1.886329
train_loss: 0.138316
valid_loss: 1.341205
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0017876484975460427
Epoch-10 lr: 0.007150593990184171
epoch 10 training time: 16.043
---------------
2023-09-24 13:54:36.707718
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00841	Per Sample Data Time 0.00286	Per Sample DNN Time 0.00555	Train Loss 0.1027	
start validation
acc: 0.718310
AUC: 0.899852
Avg Precision: 0.443141
Avg Recall: 1.000000
d_prime: 1.811194
train_loss: 0.098364
valid_loss: 1.339898
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0017876484975460427
Epoch-11 lr: 0.007150593990184171
epoch 11 training time: 15.024
---------------
2023-09-24 13:54:51.731782
current #epochs=12, #steps=429
start validation
[I 2023-09-24 13:55:06,804] Trial 28 finished with value: 0.4678675161687332 and parameters: {'warmup': 'False', 'num_epochs': 12, 'batch_size': 12, 'lr-adaptschedule': 'False', 'lr': 0.0025176600323419803, 'head-lr': 4, 'lr-scheduler-start': 6, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.8426408734145462}. Best is trial 14 with value: 0.47138807158347623.
acc: 0.685446
AUC: 0.902442
Avg Precision: 0.467868
Avg Recall: 1.000000
d_prime: 1.832248
train_loss: 0.117116
valid_loss: 1.326322
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0015063456913303986
Epoch-12 lr: 0.006025382765321594
epoch 12 training time: 15.065
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f547fd0>
The learning rate scheduler starts at 7 epoch with decay rate of 0.879 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 13:55:06.837489
current #epochs=1, #steps=0
start validation
acc: 0.723005
AUC: 0.895760
Avg Precision: 0.462557
Avg Recall: 1.000000
d_prime: 1.778737
train_loss: 0.228079
valid_loss: 1.359936
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0029716474206259655
Epoch-1 lr: 0.008914942261877896
epoch 1 training time: 17.403
---------------
2023-09-24 13:55:24.241101
current #epochs=2, #steps=39
start validation
acc: 0.713615
AUC: 0.883779
Avg Precision: 0.413152
Avg Recall: 1.000000
d_prime: 1.688700
train_loss: 0.171154
valid_loss: 1.380174
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0029716474206259655
Epoch-2 lr: 0.008914942261877896
epoch 2 training time: 15.001
---------------
2023-09-24 13:55:39.242154
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00151	Per Sample DNN Time 0.00556	Train Loss 0.1637	
start validation
acc: 0.699531
AUC: 0.909477
Avg Precision: 0.486370
Avg Recall: 1.000000
d_prime: 1.891568
train_loss: 0.185068
valid_loss: 1.339053
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0029716474206259655
Epoch-3 lr: 0.008914942261877896
epoch 3 training time: 15.080
---------------
2023-09-24 13:55:54.322263
current #epochs=4, #steps=117
start validation
acc: 0.699531
AUC: 0.890624
Avg Precision: 0.478448
Avg Recall: 1.000000
d_prime: 1.739275
train_loss: 0.173264
valid_loss: 1.341374
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0029716474206259655
Epoch-4 lr: 0.008914942261877896
epoch 4 training time: 15.611
---------------
2023-09-24 13:56:09.932990
current #epochs=5, #steps=156
start validation
[I 2023-09-24 13:56:25,048] Trial 29 finished with value: 0.4618872504532321 and parameters: {'warmup': 'True', 'num_epochs': 5, 'batch_size': 63, 'lr-adaptschedule': 'False', 'lr': 0.0029716474206259655, 'head-lr': 3, 'lr-scheduler-start': 7, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.8787582916675231}. Best is trial 14 with value: 0.47138807158347623.
acc: 0.708920
AUC: 0.897862
Avg Precision: 0.461887
Avg Recall: 1.000000
d_prime: 1.795293
train_loss: 0.170215
valid_loss: 1.347182
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0029716474206259655
Epoch-5 lr: 0.008914942261877896
epoch 5 training time: 15.111
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67ec59d60>
The learning rate scheduler starts at 10 epoch with decay rate of 0.846 every 8 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 13:56:25.081605
current #epochs=1, #steps=0
start validation
acc: 0.727700
AUC: 0.885152
Avg Precision: 0.439710
Avg Recall: 1.000000
d_prime: 1.698673
train_loss: 0.150796
valid_loss: 1.352927
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0016171391034131113
Epoch-1 lr: 0.0016171391034131113
epoch 1 training time: 18.028
---------------
2023-09-24 13:56:43.110584
current #epochs=2, #steps=39
start validation
acc: 0.732394
AUC: 0.902568
Avg Precision: 0.469696
Avg Recall: 1.000000
d_prime: 1.833280
train_loss: 0.109368
valid_loss: 1.341174
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0016171391034131113
Epoch-2 lr: 0.0016171391034131113
epoch 2 training time: 17.443
---------------
2023-09-24 13:57:00.553167
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00558	Train Loss 0.1217	
start validation
acc: 0.723005
AUC: 0.901780
Avg Precision: 0.468539
Avg Recall: 1.000000
d_prime: 1.826822
train_loss: 0.127754
valid_loss: 1.335130
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0016171391034131113
Epoch-3 lr: 0.0016171391034131113
epoch 3 training time: 15.193
---------------
2023-09-24 13:57:15.745917
current #epochs=4, #steps=117
start validation
acc: 0.690141
AUC: 0.889113
Avg Precision: 0.457897
Avg Recall: 1.000000
d_prime: 1.727920
train_loss: 0.098468
valid_loss: 1.340920
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0016171391034131113
Epoch-4 lr: 0.0016171391034131113
epoch 4 training time: 15.004
---------------
2023-09-24 13:57:30.750384
current #epochs=5, #steps=156
start validation
acc: 0.727700
AUC: 0.905695
Avg Precision: 0.466769
Avg Recall: 1.000000
d_prime: 1.859266
train_loss: 0.107509
valid_loss: 1.324720
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0016171391034131113
Epoch-5 lr: 0.0016171391034131113
epoch 5 training time: 15.133
---------------
2023-09-24 13:57:45.883079
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01106	Per Sample Data Time 0.00513	Per Sample DNN Time 0.00593	Train Loss 0.0833	
start validation
acc: 0.671362
AUC: 0.891073
Avg Precision: 0.425534
Avg Recall: 1.000000
d_prime: 1.742671
train_loss: 0.125706
valid_loss: 1.366447
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0016171391034131113
Epoch-6 lr: 0.0016171391034131113
epoch 6 training time: 15.115
---------------
2023-09-24 13:58:00.997859
current #epochs=7, #steps=234
start validation
acc: 0.737089
AUC: 0.903868
Avg Precision: 0.452417
Avg Recall: 1.000000
d_prime: 1.844004
train_loss: 0.120245
valid_loss: 1.327068
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0016171391034131113
Epoch-7 lr: 0.0016171391034131113
epoch 7 training time: 17.431
---------------
2023-09-24 13:58:18.428547
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00680	Per Sample Data Time 0.00123	Per Sample DNN Time 0.00557	Train Loss 0.1416	
start validation
acc: 0.713615
AUC: 0.910086
Avg Precision: 0.466403
Avg Recall: 1.000000
d_prime: 1.896865
train_loss: 0.152095
valid_loss: 1.335735
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0016171391034131113
Epoch-8 lr: 0.0016171391034131113
epoch 8 training time: 15.045
---------------
2023-09-24 13:58:33.474137
current #epochs=9, #steps=312
start validation
acc: 0.676056
AUC: 0.899725
Avg Precision: 0.481429
Avg Recall: 1.000000
d_prime: 1.810176
train_loss: 0.111440
valid_loss: 1.338099
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0016171391034131113
Epoch-9 lr: 0.0016171391034131113
epoch 9 training time: 15.066
---------------
2023-09-24 13:58:48.540104
current #epochs=10, #steps=351
start validation
acc: 0.713615
AUC: 0.895594
Avg Precision: 0.478929
Avg Recall: 1.000000
d_prime: 1.777440
train_loss: 0.124301
valid_loss: 1.340769
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0013688909408045014
Epoch-10 lr: 0.0013688909408045014
epoch 10 training time: 14.998
---------------
2023-09-24 13:59:03.538265
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00848	Per Sample Data Time 0.00290	Per Sample DNN Time 0.00558	Train Loss 0.1239	
start validation
acc: 0.704225
AUC: 0.908636
Avg Precision: 0.471772
Avg Recall: 1.000000
d_prime: 1.884299
train_loss: 0.106699
valid_loss: 1.334246
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0013688909408045014
Epoch-11 lr: 0.0013688909408045014
epoch 11 training time: 15.099
---------------
2023-09-24 13:59:18.636806
current #epochs=12, #steps=429
start validation
acc: 0.708920
AUC: 0.905557
Avg Precision: 0.431073
Avg Recall: 1.000000
d_prime: 1.858112
train_loss: 0.135584
valid_loss: 1.346172
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0013688909408045014
Epoch-12 lr: 0.0013688909408045014
epoch 12 training time: 15.076
---------------
2023-09-24 13:59:33.713104
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00664	Per Sample Data Time 0.00107	Per Sample DNN Time 0.00558	Train Loss 0.0971	
start validation
acc: 0.713615
AUC: 0.903611
Avg Precision: 0.466682
Avg Recall: 1.000000
d_prime: 1.841879
train_loss: 0.102224
valid_loss: 1.350676
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0013688909408045014
Epoch-13 lr: 0.0013688909408045014
epoch 13 training time: 15.170
---------------
2023-09-24 13:59:48.883563
current #epochs=14, #steps=507
start validation
acc: 0.727700
AUC: 0.905098
Avg Precision: 0.482794
Avg Recall: 1.000000
d_prime: 1.854259
train_loss: 0.109939
valid_loss: 1.334702
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0013688909408045014
Epoch-14 lr: 0.0013688909408045014
epoch 14 training time: 15.188
---------------
2023-09-24 14:00:04.071970
current #epochs=15, #steps=546
start validation
acc: 0.746479
AUC: 0.910815
Avg Precision: 0.463642
Avg Recall: 1.000000
d_prime: 1.903236
train_loss: 0.087250
valid_loss: 1.335085
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0013688909408045014
Epoch-15 lr: 0.0013688909408045014
epoch 15 training time: 17.456
---------------
2023-09-24 14:00:21.527932
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00776	Per Sample Data Time 0.00205	Per Sample DNN Time 0.00571	Train Loss 0.0810	
start validation
acc: 0.732394
AUC: 0.905313
Avg Precision: 0.472019
Avg Recall: 1.000000
d_prime: 1.856061
train_loss: 0.090488
valid_loss: 1.354441
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0013688909408045014
Epoch-16 lr: 0.0013688909408045014
epoch 16 training time: 15.127
---------------
2023-09-24 14:00:36.654733
current #epochs=17, #steps=624
start validation
acc: 0.708920
AUC: 0.891571
Avg Precision: 0.473924
Avg Recall: 1.000000
d_prime: 1.746449
train_loss: 0.082307
valid_loss: 1.348087
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0013688909408045014
Epoch-17 lr: 0.0013688909408045014
epoch 17 training time: 15.039
---------------
2023-09-24 14:00:51.693643
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00647	Per Sample Data Time 0.00095	Per Sample DNN Time 0.00551	Train Loss 0.1345	
start validation
acc: 0.704225
AUC: 0.889049
Avg Precision: 0.443415
Avg Recall: 1.000000
d_prime: 1.727442
train_loss: 0.132105
valid_loss: 1.354678
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.001158751528462632
Epoch-18 lr: 0.001158751528462632
epoch 18 training time: 15.104
---------------
2023-09-24 14:01:06.797688
current #epochs=19, #steps=702
start validation
acc: 0.723005
AUC: 0.883733
Avg Precision: 0.460073
Avg Recall: 1.000000
d_prime: 1.688371
train_loss: 0.123626
valid_loss: 1.356639
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.001158751528462632
Epoch-19 lr: 0.001158751528462632
epoch 19 training time: 15.117
---------------
2023-09-24 14:01:21.914625
current #epochs=20, #steps=741
start validation
acc: 0.708920
AUC: 0.888224
Avg Precision: 0.450237
Avg Recall: 1.000000
d_prime: 1.721292
train_loss: 0.105217
valid_loss: 1.348619
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.001158751528462632
Epoch-20 lr: 0.001158751528462632
epoch 20 training time: 15.046
---------------
2023-09-24 14:01:36.961091
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00722	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00567	Train Loss 0.0891	
start validation
acc: 0.699531
AUC: 0.890429
Avg Precision: 0.437242
Avg Recall: 1.000000
d_prime: 1.737807
train_loss: 0.097670
valid_loss: 1.355065
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.001158751528462632
Epoch-21 lr: 0.001158751528462632
epoch 21 training time: 15.095
---------------
2023-09-24 14:01:52.056104
current #epochs=22, #steps=819
start validation
acc: 0.741784
AUC: 0.904403
Avg Precision: 0.482874
Avg Recall: 1.000000
d_prime: 1.848459
train_loss: 0.102376
valid_loss: 1.340223
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.001158751528462632
Epoch-22 lr: 0.001158751528462632
epoch 22 training time: 15.108
---------------
2023-09-24 14:02:07.164573
current #epochs=23, #steps=858
start validation
acc: 0.723005
AUC: 0.900436
Avg Precision: 0.479255
Avg Recall: 1.000000
d_prime: 1.815907
train_loss: 0.092330
valid_loss: 1.334326
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.001158751528462632
Epoch-23 lr: 0.001158751528462632
epoch 23 training time: 15.029
---------------
2023-09-24 14:02:22.193283
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01364	Per Sample Data Time 0.00786	Per Sample DNN Time 0.00578	Train Loss 0.1080	
start validation
acc: 0.713615
AUC: 0.901422
Avg Precision: 0.458996
Avg Recall: 1.000000
d_prime: 1.823903
train_loss: 0.115234
valid_loss: 1.346519
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.001158751528462632
Epoch-24 lr: 0.001158751528462632
epoch 24 training time: 15.065
---------------
2023-09-24 14:02:37.258152
current #epochs=25, #steps=936
start validation
acc: 0.727700
AUC: 0.895042
Avg Precision: 0.475416
Avg Recall: 1.000000
d_prime: 1.773134
train_loss: 0.093099
valid_loss: 1.347415
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.001158751528462632
Epoch-25 lr: 0.001158751528462632
epoch 25 training time: 16.051
---------------
2023-09-24 14:02:53.309066
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00689	Per Sample Data Time 0.00131	Per Sample DNN Time 0.00558	Train Loss 0.0688	
start validation
acc: 0.723005
AUC: 0.885116
Avg Precision: 0.456987
Avg Recall: 1.000000
d_prime: 1.698413
train_loss: 0.078614
valid_loss: 1.351153
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.000980870765296594
Epoch-26 lr: 0.000980870765296594
epoch 26 training time: 15.143
---------------
2023-09-24 14:03:08.452195
current #epochs=27, #steps=1014
start validation
acc: 0.727700
AUC: 0.897926
Avg Precision: 0.482268
Avg Recall: 1.000000
d_prime: 1.795797
train_loss: 0.084501
valid_loss: 1.342397
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.000980870765296594
Epoch-27 lr: 0.000980870765296594
epoch 27 training time: 15.018
---------------
2023-09-24 14:03:23.470196
current #epochs=28, #steps=1053
start validation
acc: 0.727700
AUC: 0.891484
Avg Precision: 0.465759
Avg Recall: 1.000000
d_prime: 1.745788
train_loss: 0.080506
valid_loss: 1.359246
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.000980870765296594
Epoch-28 lr: 0.000980870765296594
epoch 28 training time: 15.060
---------------
2023-09-24 14:03:38.530507
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00934	Per Sample Data Time 0.00365	Per Sample DNN Time 0.00570	Train Loss 0.1310	
start validation
acc: 0.718310
AUC: 0.894823
Avg Precision: 0.454153
Avg Recall: 1.000000
d_prime: 1.771435
train_loss: 0.094003
valid_loss: 1.347929
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.000980870765296594
Epoch-29 lr: 0.000980870765296594
epoch 29 training time: 15.064
---------------
2023-09-24 14:03:53.594671
current #epochs=30, #steps=1131
start validation
[I 2023-09-24 14:04:08,592] Trial 30 finished with value: 0.45404690511598406 and parameters: {'warmup': 'False', 'num_epochs': 30, 'batch_size': 44, 'lr-adaptschedule': 'False', 'lr': 0.0016171391034131113, 'head-lr': 1, 'lr-scheduler-start': 10, 'lr-scheduler-step': 8, 'lr-scheduler-decay': 0.8464892957664182}. Best is trial 14 with value: 0.47138807158347623.
acc: 0.713615
AUC: 0.894831
Avg Precision: 0.454047
Avg Recall: 1.000000
d_prime: 1.771495
train_loss: 0.094847
valid_loss: 1.339649
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.000980870765296594
Epoch-30 lr: 0.000980870765296594
epoch 30 training time: 14.990
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67ec453d0>
The learning rate scheduler starts at 8 epoch with decay rate of 0.814 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 14:04:08.627148
current #epochs=1, #steps=0
start validation
acc: 0.718310
AUC: 0.878788
Avg Precision: 0.465256
Avg Recall: 1.000000
d_prime: 1.653143
train_loss: 0.120090
valid_loss: 1.352096
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0010325762104767145
Epoch-1 lr: 0.0010325762104767145
epoch 1 training time: 17.290
---------------
2023-09-24 14:04:25.917784
current #epochs=2, #steps=39
start validation
acc: 0.708920
AUC: 0.889308
Avg Precision: 0.458176
Avg Recall: 1.000000
d_prime: 1.729383
train_loss: 0.109062
valid_loss: 1.340289
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0010325762104767145
Epoch-2 lr: 0.0010325762104767145
epoch 2 training time: 15.132
---------------
2023-09-24 14:04:41.049431
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00699	Per Sample Data Time 0.00139	Per Sample DNN Time 0.00559	Train Loss 0.0910	
start validation
acc: 0.699531
AUC: 0.895403
Avg Precision: 0.448561
Avg Recall: 1.000000
d_prime: 1.775949
train_loss: 0.094675
valid_loss: 1.343699
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0010325762104767145
Epoch-3 lr: 0.0010325762104767145
epoch 3 training time: 14.996
---------------
2023-09-24 14:04:56.045853
current #epochs=4, #steps=117
start validation
acc: 0.690141
AUC: 0.887802
Avg Precision: 0.447760
Avg Recall: 1.000000
d_prime: 1.718162
train_loss: 0.084217
valid_loss: 1.339490
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0010325762104767145
Epoch-4 lr: 0.0010325762104767145
epoch 4 training time: 15.086
---------------
2023-09-24 14:05:11.132237
current #epochs=5, #steps=156
start validation
acc: 0.737089
AUC: 0.887269
Avg Precision: 0.457417
Avg Recall: 1.000000
d_prime: 1.714216
train_loss: 0.060028
valid_loss: 1.345854
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0010325762104767145
Epoch-5 lr: 0.0010325762104767145
epoch 5 training time: 17.498
---------------
2023-09-24 14:05:28.630387
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01068	Per Sample Data Time 0.00502	Per Sample DNN Time 0.00566	Train Loss 0.1009	
start validation
acc: 0.694836
AUC: 0.889233
Avg Precision: 0.454664
Avg Recall: 1.000000
d_prime: 1.728819
train_loss: 0.094197
valid_loss: 1.362774
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0010325762104767145
Epoch-6 lr: 0.0010325762104767145
epoch 6 training time: 15.110
---------------
2023-09-24 14:05:43.739790
current #epochs=7, #steps=234
start validation
acc: 0.699531
AUC: 0.883609
Avg Precision: 0.461290
Avg Recall: 1.000000
d_prime: 1.687469
train_loss: 0.078847
valid_loss: 1.386232
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0010325762104767145
Epoch-7 lr: 0.0010325762104767145
epoch 7 training time: 15.190
---------------
2023-09-24 14:05:58.930242
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00668	Per Sample Data Time 0.00121	Per Sample DNN Time 0.00547	Train Loss 0.0748	
start validation
acc: 0.704225
AUC: 0.884656
Avg Precision: 0.471657
Avg Recall: 1.000000
d_prime: 1.695060
train_loss: 0.086904
valid_loss: 1.366573
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0008403653068284723
Epoch-8 lr: 0.0008403653068284723
epoch 8 training time: 14.997
---------------
2023-09-24 14:06:13.927106
current #epochs=9, #steps=312
start validation
acc: 0.727700
AUC: 0.894760
Avg Precision: 0.475293
Avg Recall: 1.000000
d_prime: 1.770945
train_loss: 0.094326
valid_loss: 1.341465
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0008403653068284723
Epoch-9 lr: 0.0008403653068284723
epoch 9 training time: 15.143
---------------
2023-09-24 14:06:29.069984
current #epochs=10, #steps=351
start validation
acc: 0.718310
AUC: 0.890223
Avg Precision: 0.460927
Avg Recall: 1.000000
d_prime: 1.736249
train_loss: 0.073205
valid_loss: 1.355394
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0006839338750549668
Epoch-10 lr: 0.0006839338750549668
epoch 10 training time: 15.168
---------------
2023-09-24 14:06:44.238278
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00862	Per Sample Data Time 0.00290	Per Sample DNN Time 0.00573	Train Loss 0.0843	
start validation
acc: 0.718310
AUC: 0.894201
Avg Precision: 0.452825
Avg Recall: 1.000000
d_prime: 1.766613
train_loss: 0.076231
valid_loss: 1.339383
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0006839338750549668
Epoch-11 lr: 0.0006839338750549668
epoch 11 training time: 15.106
---------------
2023-09-24 14:06:59.344458
current #epochs=12, #steps=429
start validation
acc: 0.727700
AUC: 0.899728
Avg Precision: 0.467563
Avg Recall: 1.000000
d_prime: 1.810200
train_loss: 0.078591
valid_loss: 1.338035
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0005566216758912193
Epoch-12 lr: 0.0005566216758912193
epoch 12 training time: 15.013
---------------
2023-09-24 14:07:14.357403
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00654	Per Sample Data Time 0.00103	Per Sample DNN Time 0.00551	Train Loss 0.0703	
start validation
acc: 0.718310
AUC: 0.900766
Avg Precision: 0.464311
Avg Recall: 1.000000
d_prime: 1.818578
train_loss: 0.066140
valid_loss: 1.335918
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0005566216758912193
Epoch-13 lr: 0.0005566216758912193
epoch 13 training time: 15.008
---------------
2023-09-24 14:07:29.365302
current #epochs=14, #steps=507
start validation
acc: 0.723005
AUC: 0.894357
Avg Precision: 0.465815
Avg Recall: 1.000000
d_prime: 1.767822
train_loss: 0.080650
valid_loss: 1.341430
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.00045300825324239
Epoch-14 lr: 0.00045300825324239
epoch 14 training time: 14.936
---------------
2023-09-24 14:07:44.301596
current #epochs=15, #steps=546
start validation
acc: 0.723005
AUC: 0.896316
Avg Precision: 0.466295
Avg Recall: 1.000000
d_prime: 1.783090
train_loss: 0.085083
valid_loss: 1.334633
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.00045300825324239
Epoch-15 lr: 0.00045300825324239
epoch 15 training time: 14.991
---------------
2023-09-24 14:07:59.292581
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00759	Per Sample Data Time 0.00198	Per Sample DNN Time 0.00561	Train Loss 0.0899	
start validation
acc: 0.699531
AUC: 0.897046
Avg Precision: 0.464962
Avg Recall: 1.000000
d_prime: 1.788835
train_loss: 0.083141
valid_loss: 1.337567
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0003686821523382911
Epoch-16 lr: 0.0003686821523382911
epoch 16 training time: 15.016
---------------
2023-09-24 14:08:14.309028
current #epochs=17, #steps=624
start validation
acc: 0.718310
AUC: 0.895234
Avg Precision: 0.450817
Avg Recall: 1.000000
d_prime: 1.774633
train_loss: 0.072483
valid_loss: 1.343985
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0003686821523382911
Epoch-17 lr: 0.0003686821523382911
epoch 17 training time: 15.340
---------------
2023-09-24 14:08:29.648825
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00645	Per Sample Data Time 0.00091	Per Sample DNN Time 0.00554	Train Loss 0.0599	
start validation
acc: 0.732394
AUC: 0.896775
Avg Precision: 0.467504
Avg Recall: 1.000000
d_prime: 1.786703
train_loss: 0.059215
valid_loss: 1.335911
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0003000530972226349
Epoch-18 lr: 0.0003000530972226349
epoch 18 training time: 15.040
---------------
2023-09-24 14:08:44.689099
current #epochs=19, #steps=702
start validation
acc: 0.741784
AUC: 0.896303
Avg Precision: 0.457871
Avg Recall: 1.000000
d_prime: 1.782988
train_loss: 0.080117
valid_loss: 1.336011
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0003000530972226349
Epoch-19 lr: 0.0003000530972226349
epoch 19 training time: 19.360
---------------
2023-09-24 14:09:04.048839
current #epochs=20, #steps=741
start validation
acc: 0.741784
AUC: 0.899582
Avg Precision: 0.478514
Avg Recall: 1.000000
d_prime: 1.809026
train_loss: 0.080035
valid_loss: 1.334406
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0002441991308282414
Epoch-20 lr: 0.0002441991308282414
epoch 20 training time: 15.063
---------------
2023-09-24 14:09:19.111722
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00723	Per Sample Data Time 0.00160	Per Sample DNN Time 0.00563	Train Loss 0.0621	
start validation
acc: 0.732394
AUC: 0.904503
Avg Precision: 0.492499
Avg Recall: 1.000000
d_prime: 1.849287
train_loss: 0.069452
valid_loss: 1.342526
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.0002441991308282414
Epoch-21 lr: 0.0002441991308282414
epoch 21 training time: 15.103
---------------
2023-09-24 14:09:34.214506
current #epochs=22, #steps=819
start validation
acc: 0.760563
AUC: 0.905223
Avg Precision: 0.494391
Avg Recall: 1.000000
d_prime: 1.855307
train_loss: 0.067576
valid_loss: 1.329517
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00019874220945975313
Epoch-22 lr: 0.00019874220945975313
epoch 22 training time: 17.473
---------------
2023-09-24 14:09:51.687063
current #epochs=23, #steps=858
start validation
acc: 0.746479
AUC: 0.904462
Avg Precision: 0.495785
Avg Recall: 1.000000
d_prime: 1.848948
train_loss: 0.074522
valid_loss: 1.325673
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00019874220945975313
Epoch-23 lr: 0.00019874220945975313
epoch 23 training time: 15.299
---------------
2023-09-24 14:10:06.986180
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01359	Per Sample Data Time 0.00774	Per Sample DNN Time 0.00584	Train Loss 0.1239	
start validation
acc: 0.723005
AUC: 0.900926
Avg Precision: 0.489686
Avg Recall: 1.000000
d_prime: 1.819877
train_loss: 0.060610
valid_loss: 1.328742
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.0001617469549829226
Epoch-24 lr: 0.0001617469549829226
epoch 24 training time: 15.113
---------------
2023-09-24 14:10:22.099631
current #epochs=25, #steps=936
start validation
acc: 0.732394
AUC: 0.899395
Avg Precision: 0.485530
Avg Recall: 1.000000
d_prime: 1.807524
train_loss: 0.068945
valid_loss: 1.331834
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.0001617469549829226
Epoch-25 lr: 0.0001617469549829226
epoch 25 training time: 15.081
---------------
2023-09-24 14:10:37.180725
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00690	Per Sample Data Time 0.00127	Per Sample DNN Time 0.00563	Train Loss 0.0855	
start validation
acc: 0.732394
AUC: 0.898593
Avg Precision: 0.487260
Avg Recall: 1.000000
d_prime: 1.801106
train_loss: 0.086226
valid_loss: 1.334796
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00013163825398421775
Epoch-26 lr: 0.00013163825398421775
epoch 26 training time: 15.150
---------------
2023-09-24 14:10:52.331037
current #epochs=27, #steps=1014
start validation
acc: 0.732394
AUC: 0.898783
Avg Precision: 0.487213
Avg Recall: 1.000000
d_prime: 1.802622
train_loss: 0.094821
valid_loss: 1.332286
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00013163825398421775
Epoch-27 lr: 0.00013163825398421775
epoch 27 training time: 15.176
---------------
2023-09-24 14:11:07.506842
current #epochs=28, #steps=1053
start validation
acc: 0.732394
AUC: 0.898656
Avg Precision: 0.483710
Avg Recall: 1.000000
d_prime: 1.801610
train_loss: 0.071547
valid_loss: 1.334209
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00010713419559485986
Epoch-28 lr: 0.00010713419559485986
epoch 28 training time: 14.995
---------------
2023-09-24 14:11:22.502172
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00919	Per Sample Data Time 0.00356	Per Sample DNN Time 0.00562	Train Loss 0.0357	
start validation
acc: 0.727700
AUC: 0.897796
Avg Precision: 0.480408
Avg Recall: 1.000000
d_prime: 1.794764
train_loss: 0.068716
valid_loss: 1.335136
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00010713419559485986
Epoch-29 lr: 0.00010713419559485986
epoch 29 training time: 15.971
---------------
2023-09-24 14:11:38.473530
current #epochs=30, #steps=1131
start validation
acc: 0.723005
AUC: 0.898920
Avg Precision: 0.485107
Avg Recall: 1.000000
d_prime: 1.803715
train_loss: 0.070610
valid_loss: 1.336600
validation finished
normal learning rate scheduler step
Epoch-30 lr: 8.719149273382012e-05
Epoch-30 lr: 8.719149273382012e-05
epoch 30 training time: 15.045
---------------
2023-09-24 14:11:53.518457
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00665	Per Sample Data Time 0.00110	Per Sample DNN Time 0.00555	Train Loss 0.0830	
start validation
acc: 0.723005
AUC: 0.899618
Avg Precision: 0.487174
Avg Recall: 1.000000
d_prime: 1.809316
train_loss: 0.079647
valid_loss: 1.335785
validation finished
normal learning rate scheduler step
Epoch-31 lr: 8.719149273382012e-05
Epoch-31 lr: 8.719149273382012e-05
epoch 31 training time: 15.151
---------------
2023-09-24 14:12:08.669178
current #epochs=32, #steps=1209
start validation
acc: 0.727700
AUC: 0.904379
Avg Precision: 0.489109
Avg Recall: 1.000000
d_prime: 1.848257
train_loss: 0.079550
valid_loss: 1.332535
validation finished
normal learning rate scheduler step
Epoch-32 lr: 7.096106301951415e-05
Epoch-32 lr: 7.096106301951415e-05
epoch 32 training time: 15.076
---------------
2023-09-24 14:12:23.744983
current #epochs=33, #steps=1248
start validation
acc: 0.741784
AUC: 0.904140
Avg Precision: 0.488376
Avg Recall: 1.000000
d_prime: 1.846267
train_loss: 0.082308
valid_loss: 1.332718
validation finished
normal learning rate scheduler step
Epoch-33 lr: 7.096106301951415e-05
Epoch-33 lr: 7.096106301951415e-05
epoch 33 training time: 15.223
---------------
2023-09-24 14:12:38.968175
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00810	Per Sample Data Time 0.00228	Per Sample DNN Time 0.00582	Train Loss 0.0859	
start validation
acc: 0.741784
AUC: 0.904483
Avg Precision: 0.488646
Avg Recall: 1.000000
d_prime: 1.849122
train_loss: 0.071368
valid_loss: 1.328403
validation finished
normal learning rate scheduler step
Epoch-34 lr: 5.775187815893745e-05
Epoch-34 lr: 5.775187815893745e-05
epoch 34 training time: 15.171
---------------
2023-09-24 14:12:54.138989
current #epochs=35, #steps=1326
start validation
acc: 0.741784
AUC: 0.905203
Avg Precision: 0.489670
Avg Recall: 1.000000
d_prime: 1.855135
train_loss: 0.068537
valid_loss: 1.325942
validation finished
normal learning rate scheduler step
Epoch-35 lr: 5.775187815893745e-05
Epoch-35 lr: 5.775187815893745e-05
epoch 35 training time: 15.031
---------------
2023-09-24 14:13:09.170391
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00649	Per Sample Data Time 0.00102	Per Sample DNN Time 0.00547	Train Loss 0.0661	
start validation
acc: 0.737089
AUC: 0.904017
Avg Precision: 0.488393
Avg Recall: 1.000000
d_prime: 1.845244
train_loss: 0.066551
valid_loss: 1.326485
validation finished
normal learning rate scheduler step
Epoch-36 lr: 4.700154266245365e-05
Epoch-36 lr: 4.700154266245365e-05
epoch 36 training time: 15.081
---------------
2023-09-24 14:13:24.250925
current #epochs=37, #steps=1404
start validation
[I 2023-09-24 14:13:40,008] Trial 31 finished with value: 0.48893675561075667 and parameters: {'warmup': 'False', 'num_epochs': 37, 'batch_size': 25, 'lr-adaptschedule': 'False', 'lr': 0.0010325762104767145, 'head-lr': 1, 'lr-scheduler-start': 8, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.813853058304042}. Best is trial 31 with value: 0.48893675561075667.
acc: 0.732394
AUC: 0.903557
Avg Precision: 0.488937
Avg Recall: 1.000000
d_prime: 1.841429
train_loss: 0.065301
valid_loss: 1.329013
validation finished
normal learning rate scheduler step
Epoch-37 lr: 4.700154266245365e-05
Epoch-37 lr: 4.700154266245365e-05
epoch 37 training time: 15.750
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f59b1f0>
The learning rate scheduler starts at 8 epoch with decay rate of 0.805 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 14:13:40.043100
current #epochs=1, #steps=0
start validation
acc: 0.723005
AUC: 0.893649
Avg Precision: 0.469103
Avg Recall: 1.000000
d_prime: 1.762354
train_loss: 0.100894
valid_loss: 1.353927
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.000889514020250579
Epoch-1 lr: 0.000889514020250579
epoch 1 training time: 17.621
---------------
2023-09-24 14:13:57.663889
current #epochs=2, #steps=39
start validation
acc: 0.732394
AUC: 0.901676
Avg Precision: 0.482490
Avg Recall: 1.000000
d_prime: 1.825978
train_loss: 0.078715
valid_loss: 1.353361
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.000889514020250579
Epoch-2 lr: 0.000889514020250579
epoch 2 training time: 17.536
---------------
2023-09-24 14:14:15.199797
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00701	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00549	Train Loss 0.1129	
start validation
acc: 0.737089
AUC: 0.897443
Avg Precision: 0.461985
Avg Recall: 1.000000
d_prime: 1.791974
train_loss: 0.103111
valid_loss: 1.345725
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.000889514020250579
Epoch-3 lr: 0.000889514020250579
epoch 3 training time: 18.236
---------------
2023-09-24 14:14:33.435901
current #epochs=4, #steps=117
start validation
acc: 0.704225
AUC: 0.890538
Avg Precision: 0.470650
Avg Recall: 1.000000
d_prime: 1.738627
train_loss: 0.091606
valid_loss: 1.367640
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.000889514020250579
Epoch-4 lr: 0.000889514020250579
epoch 4 training time: 15.138
---------------
2023-09-24 14:14:48.574037
current #epochs=5, #steps=156
start validation
acc: 0.685446
AUC: 0.896561
Avg Precision: 0.448476
Avg Recall: 1.000000
d_prime: 1.785019
train_loss: 0.086345
valid_loss: 1.334945
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.000889514020250579
Epoch-5 lr: 0.000889514020250579
epoch 5 training time: 15.021
---------------
2023-09-24 14:15:03.594823
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01109	Per Sample Data Time 0.00509	Per Sample DNN Time 0.00600	Train Loss 0.1185	
start validation
acc: 0.723005
AUC: 0.892243
Avg Precision: 0.485627
Avg Recall: 1.000000
d_prime: 1.751567
train_loss: 0.082377
valid_loss: 1.337961
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.000889514020250579
Epoch-6 lr: 0.000889514020250579
epoch 6 training time: 15.083
---------------
2023-09-24 14:15:18.678126
current #epochs=7, #steps=234
start validation
acc: 0.718310
AUC: 0.897022
Avg Precision: 0.494812
Avg Recall: 1.000000
d_prime: 1.788649
train_loss: 0.091201
valid_loss: 1.346643
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.000889514020250579
Epoch-7 lr: 0.000889514020250579
epoch 7 training time: 15.160
---------------
2023-09-24 14:15:33.837889
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00676	Per Sample Data Time 0.00121	Per Sample DNN Time 0.00555	Train Loss 0.0882	
start validation
acc: 0.699531
AUC: 0.900482
Avg Precision: 0.469168
Avg Recall: 1.000000
d_prime: 1.816281
train_loss: 0.088895
valid_loss: 1.327980
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0007158195814005314
Epoch-8 lr: 0.0007158195814005314
epoch 8 training time: 15.101
---------------
2023-09-24 14:15:48.939162
current #epochs=9, #steps=312
start validation
acc: 0.704225
AUC: 0.896110
Avg Precision: 0.457575
Avg Recall: 1.000000
d_prime: 1.781473
train_loss: 0.083018
valid_loss: 1.340601
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0007158195814005314
Epoch-9 lr: 0.0007158195814005314
epoch 9 training time: 15.147
---------------
2023-09-24 14:16:04.086787
current #epochs=10, #steps=351
start validation
acc: 0.699531
AUC: 0.892076
Avg Precision: 0.450299
Avg Recall: 1.000000
d_prime: 1.750290
train_loss: 0.069409
valid_loss: 1.345214
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0005760422674080931
Epoch-10 lr: 0.0005760422674080931
epoch 10 training time: 15.118
---------------
2023-09-24 14:16:19.204770
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00858	Per Sample Data Time 0.00286	Per Sample DNN Time 0.00571	Train Loss 0.0989	
start validation
acc: 0.713615
AUC: 0.898229
Avg Precision: 0.478506
Avg Recall: 1.000000
d_prime: 1.798209
train_loss: 0.101626
valid_loss: 1.346606
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0005760422674080931
Epoch-11 lr: 0.0005760422674080931
epoch 11 training time: 15.067
---------------
2023-09-24 14:16:34.272128
current #epochs=12, #steps=429
start validation
acc: 0.737089
AUC: 0.903466
Avg Precision: 0.454383
Avg Recall: 1.000000
d_prime: 1.840683
train_loss: 0.090934
valid_loss: 1.330472
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.000463559118055178
Epoch-12 lr: 0.000463559118055178
epoch 12 training time: 15.250
---------------
2023-09-24 14:16:49.522604
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00667	Per Sample Data Time 0.00106	Per Sample DNN Time 0.00561	Train Loss 0.0731	
start validation
acc: 0.723005
AUC: 0.901687
Avg Precision: 0.470113
Avg Recall: 1.000000
d_prime: 1.826070
train_loss: 0.075839
valid_loss: 1.338184
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.000463559118055178
Epoch-13 lr: 0.000463559118055178
epoch 13 training time: 15.203
---------------
2023-09-24 14:17:04.725677
current #epochs=14, #steps=507
start validation
acc: 0.713615
AUC: 0.903960
Avg Precision: 0.491260
Avg Recall: 1.000000
d_prime: 1.844776
train_loss: 0.064459
valid_loss: 1.331799
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.00037304043138879463
Epoch-14 lr: 0.00037304043138879463
epoch 14 training time: 14.970
---------------
2023-09-24 14:17:19.695087
current #epochs=15, #steps=546
start validation
acc: 0.727700
AUC: 0.904637
Avg Precision: 0.485346
Avg Recall: 1.000000
d_prime: 1.850404
train_loss: 0.094414
valid_loss: 1.347916
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.00037304043138879463
Epoch-15 lr: 0.00037304043138879463
epoch 15 training time: 14.983
---------------
2023-09-24 14:17:34.677893
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00770	Per Sample Data Time 0.00208	Per Sample DNN Time 0.00562	Train Loss 0.0893	
start validation
acc: 0.732394
AUC: 0.905119
Avg Precision: 0.483190
Avg Recall: 1.000000
d_prime: 1.854438
train_loss: 0.080881
valid_loss: 1.338246
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.00030019723058100593
Epoch-16 lr: 0.00030019723058100593
epoch 16 training time: 15.067
---------------
2023-09-24 14:17:49.745346
current #epochs=17, #steps=624
start validation
acc: 0.732394
AUC: 0.902486
Avg Precision: 0.470016
Avg Recall: 1.000000
d_prime: 1.832606
train_loss: 0.072547
valid_loss: 1.339002
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.00030019723058100593
Epoch-17 lr: 0.00030019723058100593
epoch 17 training time: 15.060
---------------
2023-09-24 14:18:04.805732
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00645	Per Sample Data Time 0.00094	Per Sample DNN Time 0.00551	Train Loss 0.0702	
start validation
acc: 0.737089
AUC: 0.900479
Avg Precision: 0.469711
Avg Recall: 1.000000
d_prime: 1.816255
train_loss: 0.071197
valid_loss: 1.344495
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00024157804266149743
Epoch-18 lr: 0.00024157804266149743
epoch 18 training time: 15.104
---------------
2023-09-24 14:18:19.909506
current #epochs=19, #steps=702
start validation
acc: 0.737089
AUC: 0.898646
Avg Precision: 0.463638
Avg Recall: 1.000000
d_prime: 1.801529
train_loss: 0.076323
valid_loss: 1.341818
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00024157804266149743
Epoch-19 lr: 0.00024157804266149743
epoch 19 training time: 15.092
---------------
2023-09-24 14:18:35.000905
current #epochs=20, #steps=741
start validation
acc: 0.723005
AUC: 0.898979
Avg Precision: 0.475274
Avg Recall: 1.000000
d_prime: 1.804188
train_loss: 0.077217
valid_loss: 1.341733
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00019440536004682523
Epoch-20 lr: 0.00019440536004682523
epoch 20 training time: 15.223
---------------
2023-09-24 14:18:50.223879
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00553	Train Loss 0.0709	
start validation
acc: 0.727700
AUC: 0.899314
Avg Precision: 0.475848
Avg Recall: 1.000000
d_prime: 1.806877
train_loss: 0.081362
valid_loss: 1.344581
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00019440536004682523
Epoch-21 lr: 0.00019440536004682523
epoch 21 training time: 14.893
---------------
2023-09-24 14:19:05.117336
current #epochs=22, #steps=819
start validation
acc: 0.718310
AUC: 0.900635
Avg Precision: 0.476100
Avg Recall: 1.000000
d_prime: 1.817514
train_loss: 0.074910
valid_loss: 1.337280
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00015644403604963576
Epoch-22 lr: 0.00015644403604963576
epoch 22 training time: 15.253
---------------
2023-09-24 14:19:20.370439
current #epochs=23, #steps=858
start validation
acc: 0.732394
AUC: 0.899506
Avg Precision: 0.474913
Avg Recall: 1.000000
d_prime: 1.808416
train_loss: 0.073539
valid_loss: 1.343052
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00015644403604963576
Epoch-23 lr: 0.00015644403604963576
epoch 23 training time: 15.105
---------------
2023-09-24 14:19:35.475466
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01393	Per Sample Data Time 0.00797	Per Sample DNN Time 0.00596	Train Loss 0.0824	
start validation
acc: 0.718310
AUC: 0.899217
Avg Precision: 0.464635
Avg Recall: 1.000000
d_prime: 1.806097
train_loss: 0.077667
valid_loss: 1.340958
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00012589537865419274
Epoch-24 lr: 0.00012589537865419274
epoch 24 training time: 15.228
---------------
2023-09-24 14:19:50.702896
current #epochs=25, #steps=936
start validation
acc: 0.718310
AUC: 0.899647
Avg Precision: 0.459174
Avg Recall: 1.000000
d_prime: 1.809543
train_loss: 0.060252
valid_loss: 1.339840
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00012589537865419274
Epoch-25 lr: 0.00012589537865419274
epoch 25 training time: 15.124
---------------
2023-09-24 14:20:05.826708
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00686	Per Sample Data Time 0.00133	Per Sample DNN Time 0.00552	Train Loss 0.0839	
start validation
acc: 0.723005
AUC: 0.900643
Avg Precision: 0.461243
Avg Recall: 1.000000
d_prime: 1.817583
train_loss: 0.076925
valid_loss: 1.335118
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00010131192448559609
Epoch-26 lr: 0.00010131192448559609
epoch 26 training time: 15.068
---------------
2023-09-24 14:20:20.894223
current #epochs=27, #steps=1014
start validation
acc: 0.708920
AUC: 0.902117
Avg Precision: 0.468428
Avg Recall: 1.000000
d_prime: 1.829577
train_loss: 0.064614
valid_loss: 1.337620
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00010131192448559609
Epoch-27 lr: 0.00010131192448559609
epoch 27 training time: 15.004
---------------
2023-09-24 14:20:35.897965
current #epochs=28, #steps=1053
start validation
acc: 0.723005
AUC: 0.903373
Avg Precision: 0.474374
Avg Recall: 1.000000
d_prime: 1.839911
train_loss: 0.084705
valid_loss: 1.348876
validation finished
normal learning rate scheduler step
Epoch-28 lr: 8.152885477367992e-05
Epoch-28 lr: 8.152885477367992e-05
epoch 28 training time: 15.163
---------------
2023-09-24 14:20:51.060803
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00923	Per Sample Data Time 0.00347	Per Sample DNN Time 0.00576	Train Loss 0.0770	
start validation
acc: 0.723005
AUC: 0.903144
Avg Precision: 0.472703
Avg Recall: 1.000000
d_prime: 1.838018
train_loss: 0.060865
valid_loss: 1.343408
validation finished
normal learning rate scheduler step
Epoch-29 lr: 8.152885477367992e-05
Epoch-29 lr: 8.152885477367992e-05
epoch 29 training time: 15.087
---------------
2023-09-24 14:21:06.147472
current #epochs=30, #steps=1131
start validation
acc: 0.723005
AUC: 0.902775
Avg Precision: 0.473118
Avg Recall: 1.000000
d_prime: 1.834980
train_loss: 0.066952
valid_loss: 1.340026
validation finished
normal learning rate scheduler step
Epoch-30 lr: 6.560880364732204e-05
Epoch-30 lr: 6.560880364732204e-05
epoch 30 training time: 15.086
---------------
2023-09-24 14:21:21.233484
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00671	Per Sample Data Time 0.00117	Per Sample DNN Time 0.00555	Train Loss 0.0600	
start validation
acc: 0.723005
AUC: 0.902514
Avg Precision: 0.473963
Avg Recall: 1.000000
d_prime: 1.832833
train_loss: 0.059879
valid_loss: 1.342215
validation finished
normal learning rate scheduler step
Epoch-31 lr: 6.560880364732204e-05
Epoch-31 lr: 6.560880364732204e-05
epoch 31 training time: 15.185
---------------
2023-09-24 14:21:36.417727
current #epochs=32, #steps=1209
start validation
acc: 0.723005
AUC: 0.903649
Avg Precision: 0.474323
Avg Recall: 1.000000
d_prime: 1.842193
train_loss: 0.066361
valid_loss: 1.340841
validation finished
normal learning rate scheduler step
Epoch-32 lr: 5.2797443653317334e-05
Epoch-32 lr: 5.2797443653317334e-05
epoch 32 training time: 15.034
---------------
2023-09-24 14:21:51.451864
current #epochs=33, #steps=1248
start validation
acc: 0.723005
AUC: 0.903643
Avg Precision: 0.473406
Avg Recall: 1.000000
d_prime: 1.842140
train_loss: 0.064816
valid_loss: 1.335879
validation finished
normal learning rate scheduler step
Epoch-33 lr: 5.2797443653317334e-05
Epoch-33 lr: 5.2797443653317334e-05
epoch 33 training time: 15.002
---------------
2023-09-24 14:22:06.454198
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00802	Per Sample Data Time 0.00236	Per Sample DNN Time 0.00566	Train Loss 0.0635	
start validation
acc: 0.723005
AUC: 0.904232
Avg Precision: 0.472691
Avg Recall: 1.000000
d_prime: 1.847031
train_loss: 0.058805
valid_loss: 1.335740
validation finished
normal learning rate scheduler step
Epoch-34 lr: 4.248774404285299e-05
Epoch-34 lr: 4.248774404285299e-05
epoch 34 training time: 15.089
---------------
2023-09-24 14:22:21.543472
current #epochs=35, #steps=1326
start validation
acc: 0.732394
AUC: 0.903882
Avg Precision: 0.473485
Avg Recall: 1.000000
d_prime: 1.844122
train_loss: 0.078221
valid_loss: 1.338820
validation finished
normal learning rate scheduler step
Epoch-35 lr: 4.248774404285299e-05
Epoch-35 lr: 4.248774404285299e-05
epoch 35 training time: 15.216
---------------
2023-09-24 14:22:36.759650
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00649	Per Sample Data Time 0.00098	Per Sample DNN Time 0.00551	Train Loss 0.0549	
start validation
acc: 0.727700
AUC: 0.904170
Avg Precision: 0.472043
Avg Recall: 1.000000
d_prime: 1.846519
train_loss: 0.054702
valid_loss: 1.338885
validation finished
normal learning rate scheduler step
Epoch-36 lr: 3.419120830365366e-05
Epoch-36 lr: 3.419120830365366e-05
epoch 36 training time: 15.031
---------------
2023-09-24 14:22:51.790565
current #epochs=37, #steps=1404
start validation
[I 2023-09-24 14:23:06,982] Trial 32 finished with value: 0.47135515681487306 and parameters: {'warmup': 'False', 'num_epochs': 37, 'batch_size': 33, 'lr-adaptschedule': 'False', 'lr': 0.000889514020250579, 'head-lr': 1, 'lr-scheduler-start': 8, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.8047310836077465}. Best is trial 31 with value: 0.48893675561075667.
acc: 0.732394
AUC: 0.904871
Avg Precision: 0.471355
Avg Recall: 1.000000
d_prime: 1.852362
train_loss: 0.058716
valid_loss: 1.338228
validation finished
normal learning rate scheduler step
Epoch-37 lr: 3.419120830365366e-05
Epoch-37 lr: 3.419120830365366e-05
epoch 37 training time: 15.184
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f536160>
The learning rate scheduler starts at 8 epoch with decay rate of 0.804 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 14:23:07.016034
current #epochs=1, #steps=0
start validation
acc: 0.727700
AUC: 0.892477
Avg Precision: 0.490118
Avg Recall: 1.000000
d_prime: 1.753355
train_loss: 0.077104
valid_loss: 1.343025
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0005734431244520937
Epoch-1 lr: 0.0005734431244520937
epoch 1 training time: 17.481
---------------
2023-09-24 14:23:24.497425
current #epochs=2, #steps=39
start validation
acc: 0.718310
AUC: 0.901139
Avg Precision: 0.490423
Avg Recall: 1.000000
d_prime: 1.821608
train_loss: 0.082809
valid_loss: 1.341529
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0005734431244520937
Epoch-2 lr: 0.0005734431244520937
epoch 2 training time: 15.129
---------------
2023-09-24 14:23:39.625861
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00566	Train Loss 0.0782	
start validation
acc: 0.723005
AUC: 0.900767
Avg Precision: 0.489782
Avg Recall: 1.000000
d_prime: 1.818585
train_loss: 0.077750
valid_loss: 1.344506
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0005734431244520937
Epoch-3 lr: 0.0005734431244520937
epoch 3 training time: 15.162
---------------
2023-09-24 14:23:54.788071
current #epochs=4, #steps=117
start validation
acc: 0.704225
AUC: 0.896914
Avg Precision: 0.478151
Avg Recall: 1.000000
d_prime: 1.787797
train_loss: 0.079790
valid_loss: 1.349424
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0005734431244520937
Epoch-4 lr: 0.0005734431244520937
epoch 4 training time: 15.030
---------------
2023-09-24 14:24:09.817557
current #epochs=5, #steps=156
start validation
acc: 0.727700
AUC: 0.897956
Avg Precision: 0.481002
Avg Recall: 1.000000
d_prime: 1.796038
train_loss: 0.070128
valid_loss: 1.345479
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0005734431244520937
Epoch-5 lr: 0.0005734431244520937
epoch 5 training time: 15.217
---------------
2023-09-24 14:24:25.034944
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01104	Per Sample Data Time 0.00521	Per Sample DNN Time 0.00582	Train Loss 0.0858	
start validation
acc: 0.708920
AUC: 0.900056
Avg Precision: 0.481558
Avg Recall: 1.000000
d_prime: 1.812840
train_loss: 0.081015
valid_loss: 1.344273
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0005734431244520937
Epoch-6 lr: 0.0005734431244520937
epoch 6 training time: 15.205
---------------
2023-09-24 14:24:40.240012
current #epochs=7, #steps=234
start validation
acc: 0.727700
AUC: 0.901539
Avg Precision: 0.483081
Avg Recall: 1.000000
d_prime: 1.824861
train_loss: 0.078866
valid_loss: 1.340878
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0005734431244520937
Epoch-7 lr: 0.0005734431244520937
epoch 7 training time: 15.022
---------------
2023-09-24 14:24:55.261473
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00685	Per Sample Data Time 0.00127	Per Sample DNN Time 0.00559	Train Loss 0.0798	
start validation
acc: 0.741784
AUC: 0.905088
Avg Precision: 0.488040
Avg Recall: 1.000000
d_prime: 1.854177
train_loss: 0.085192
valid_loss: 1.344532
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0004610149390603464
Epoch-8 lr: 0.0004610149390603464
epoch 8 training time: 17.609
---------------
2023-09-24 14:25:12.870773
current #epochs=9, #steps=312
start validation
acc: 0.755869
AUC: 0.912201
Avg Precision: 0.493910
Avg Recall: 1.000000
d_prime: 1.915458
train_loss: 0.065931
valid_loss: 1.321659
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.000370629213210787
Epoch-9 lr: 0.000370629213210787
epoch 9 training time: 17.630
---------------
2023-09-24 14:25:30.501033
current #epochs=10, #steps=351
start validation
acc: 0.732394
AUC: 0.907769
Avg Precision: 0.489686
Avg Recall: 1.000000
d_prime: 1.876865
train_loss: 0.087489
valid_loss: 1.330208
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00029796434355301
Epoch-10 lr: 0.00029796434355301
epoch 10 training time: 14.972
---------------
2023-09-24 14:25:45.473210
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00859	Per Sample Data Time 0.00284	Per Sample DNN Time 0.00575	Train Loss 0.0425	
start validation
acc: 0.751174
AUC: 0.906975
Avg Precision: 0.488503
Avg Recall: 1.000000
d_prime: 1.870096
train_loss: 0.047530
valid_loss: 1.337327
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0002395460121986741
Epoch-11 lr: 0.0002395460121986741
epoch 11 training time: 15.188
---------------
2023-09-24 14:26:00.660635
current #epochs=12, #steps=429
start validation
acc: 0.737089
AUC: 0.907208
Avg Precision: 0.485578
Avg Recall: 1.000000
d_prime: 1.872077
train_loss: 0.053287
valid_loss: 1.334837
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00019258106952008036
Epoch-12 lr: 0.00019258106952008036
epoch 12 training time: 15.244
---------------
2023-09-24 14:26:15.904770
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00665	Per Sample Data Time 0.00105	Per Sample DNN Time 0.00560	Train Loss 0.0642	
start validation
acc: 0.732394
AUC: 0.908845
Avg Precision: 0.487107
Avg Recall: 1.000000
d_prime: 1.886101
train_loss: 0.071196
valid_loss: 1.335756
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00015482398557625958
Epoch-13 lr: 0.00015482398557625958
epoch 13 training time: 15.186
---------------
2023-09-24 14:26:31.090792
current #epochs=14, #steps=507
start validation
acc: 0.737089
AUC: 0.912488
Avg Precision: 0.484772
Avg Recall: 1.000000
d_prime: 1.918006
train_loss: 0.066559
valid_loss: 1.327325
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.00012446948482243444
Epoch-14 lr: 0.00012446948482243444
epoch 14 training time: 15.356
---------------
2023-09-24 14:26:46.446628
current #epochs=15, #steps=546
start validation
acc: 0.737089
AUC: 0.912657
Avg Precision: 0.483984
Avg Recall: 1.000000
d_prime: 1.919509
train_loss: 0.064163
valid_loss: 1.327854
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0001000662306573372
Epoch-15 lr: 0.0001000662306573372
epoch 15 training time: 14.978
---------------
2023-09-24 14:27:01.424861
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00778	Per Sample Data Time 0.00208	Per Sample DNN Time 0.00570	Train Loss 0.0691	
start validation
acc: 0.746479
AUC: 0.911684
Avg Precision: 0.485928
Avg Recall: 1.000000
d_prime: 1.910885
train_loss: 0.068308
valid_loss: 1.332383
validation finished
normal learning rate scheduler step
Epoch-16 lr: 8.044743281658235e-05
Epoch-16 lr: 8.044743281658235e-05
epoch 16 training time: 15.256
---------------
2023-09-24 14:27:16.680451
current #epochs=17, #steps=624
start validation
acc: 0.751174
AUC: 0.913076
Avg Precision: 0.486056
Avg Recall: 1.000000
d_prime: 1.923251
train_loss: 0.077035
valid_loss: 1.331266
validation finished
normal learning rate scheduler step
Epoch-17 lr: 6.467505975057927e-05
Epoch-17 lr: 6.467505975057927e-05
epoch 17 training time: 15.040
---------------
2023-09-24 14:27:31.720764
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00647	Per Sample Data Time 0.00094	Per Sample DNN Time 0.00553	Train Loss 0.0720	
start validation
acc: 0.746479
AUC: 0.911181
Avg Precision: 0.486142
Avg Recall: 1.000000
d_prime: 1.906452
train_loss: 0.070228
valid_loss: 1.331786
validation finished
normal learning rate scheduler step
Epoch-18 lr: 5.199498861918686e-05
Epoch-18 lr: 5.199498861918686e-05
epoch 18 training time: 15.053
---------------
2023-09-24 14:27:46.773461
current #epochs=19, #steps=702
start validation
acc: 0.741784
AUC: 0.910767
Avg Precision: 0.486567
Avg Recall: 1.000000
d_prime: 1.902814
train_loss: 0.064091
valid_loss: 1.331137
validation finished
normal learning rate scheduler step
Epoch-19 lr: 4.180094849444893e-05
Epoch-19 lr: 4.180094849444893e-05
epoch 19 training time: 15.071
---------------
2023-09-24 14:28:01.844414
current #epochs=20, #steps=741
start validation
acc: 0.741784
AUC: 0.910527
Avg Precision: 0.486353
Avg Recall: 1.000000
d_prime: 1.900711
train_loss: 0.074153
valid_loss: 1.331116
validation finished
normal learning rate scheduler step
Epoch-20 lr: 3.360553279149652e-05
Epoch-20 lr: 3.360553279149652e-05
epoch 20 training time: 15.117
---------------
2023-09-24 14:28:16.960993
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00559	Train Loss 0.0673	
start validation
acc: 0.746479
AUC: 0.910059
Avg Precision: 0.485372
Avg Recall: 1.000000
d_prime: 1.896630
train_loss: 0.062897
valid_loss: 1.331034
validation finished
normal learning rate scheduler step
Epoch-21 lr: 2.7016894947977566e-05
Epoch-21 lr: 2.7016894947977566e-05
epoch 21 training time: 15.275
---------------
2023-09-24 14:28:32.236264
current #epochs=22, #steps=819
start validation
acc: 0.746479
AUC: 0.909993
Avg Precision: 0.485691
Avg Recall: 1.000000
d_prime: 1.896055
train_loss: 0.069802
valid_loss: 1.331579
validation finished
normal learning rate scheduler step
Epoch-22 lr: 2.172001310494775e-05
Epoch-22 lr: 2.172001310494775e-05
epoch 22 training time: 15.092
---------------
2023-09-24 14:28:47.327604
current #epochs=23, #steps=858
start validation
acc: 0.746479
AUC: 0.909907
Avg Precision: 0.485988
Avg Recall: 1.000000
d_prime: 1.895302
train_loss: 0.062245
valid_loss: 1.332083
validation finished
normal learning rate scheduler step
Epoch-23 lr: 1.7461627999349976e-05
Epoch-23 lr: 1.7461627999349976e-05
epoch 23 training time: 15.073
---------------
2023-09-24 14:29:02.400489
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01417	Per Sample Data Time 0.00798	Per Sample DNN Time 0.00619	Train Loss 0.0284	
start validation
acc: 0.746479
AUC: 0.909982
Avg Precision: 0.485657
Avg Recall: 1.000000
d_prime: 1.895960
train_loss: 0.059926
valid_loss: 1.332844
validation finished
normal learning rate scheduler step
Epoch-24 lr: 1.4038133905095383e-05
Epoch-24 lr: 1.4038133905095383e-05
epoch 24 training time: 15.213
---------------
2023-09-24 14:29:17.613248
current #epochs=25, #steps=936
start validation
acc: 0.746479
AUC: 0.910053
Avg Precision: 0.485746
Avg Recall: 1.000000
d_prime: 1.896579
train_loss: 0.059498
valid_loss: 1.332732
validation finished
normal learning rate scheduler step
Epoch-25 lr: 1.1285843653565671e-05
Epoch-25 lr: 1.1285843653565671e-05
epoch 25 training time: 15.792
---------------
2023-09-24 14:29:33.405028
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00692	Per Sample Data Time 0.00132	Per Sample DNN Time 0.00559	Train Loss 0.0555	
start validation
acc: 0.746479
AUC: 0.909980
Avg Precision: 0.485452
Avg Recall: 1.000000
d_prime: 1.895943
train_loss: 0.065112
valid_loss: 1.332825
validation finished
normal learning rate scheduler step
Epoch-26 lr: 9.07316227597012e-06
Epoch-26 lr: 9.07316227597012e-06
epoch 26 training time: 15.160
---------------
2023-09-24 14:29:48.565120
current #epochs=27, #steps=1014
start validation
acc: 0.746479
AUC: 0.909688
Avg Precision: 0.485364
Avg Recall: 1.000000
d_prime: 1.893396
train_loss: 0.075328
valid_loss: 1.333207
validation finished
normal learning rate scheduler step
Epoch-27 lr: 7.294295066729746e-06
Epoch-27 lr: 7.294295066729746e-06
epoch 27 training time: 15.080
---------------
2023-09-24 14:30:03.645386
current #epochs=28, #steps=1053
start validation
acc: 0.746479
AUC: 0.909757
Avg Precision: 0.485364
Avg Recall: 1.000000
d_prime: 1.894002
train_loss: 0.075876
valid_loss: 1.333313
validation finished
normal learning rate scheduler step
Epoch-28 lr: 5.864189232174726e-06
Epoch-28 lr: 5.864189232174726e-06
epoch 28 training time: 15.208
---------------
2023-09-24 14:30:18.853643
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00928	Per Sample Data Time 0.00346	Per Sample DNN Time 0.00582	Train Loss 0.0569	
start validation
acc: 0.746479
AUC: 0.909839
Avg Precision: 0.485364
Avg Recall: 1.000000
d_prime: 1.894709
train_loss: 0.066683
valid_loss: 1.333261
validation finished
normal learning rate scheduler step
Epoch-29 lr: 4.714467270128066e-06
Epoch-29 lr: 4.714467270128066e-06
epoch 29 training time: 15.961
---------------
2023-09-24 14:30:34.814374
current #epochs=30, #steps=1131
start validation
acc: 0.746479
AUC: 0.909882
Avg Precision: 0.485919
Avg Recall: 1.000000
d_prime: 1.895088
train_loss: 0.059872
valid_loss: 1.333314
validation finished
normal learning rate scheduler step
Epoch-30 lr: 3.79015764347465e-06
Epoch-30 lr: 3.79015764347465e-06
epoch 30 training time: 15.088
---------------
2023-09-24 14:30:49.901946
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00663	Per Sample Data Time 0.00110	Per Sample DNN Time 0.00553	Train Loss 0.0630	
start validation
acc: 0.746479
AUC: 0.909867
Avg Precision: 0.485919
Avg Recall: 1.000000
d_prime: 1.894959
train_loss: 0.068934
valid_loss: 1.333402
validation finished
normal learning rate scheduler step
Epoch-31 lr: 3.047066431749581e-06
Epoch-31 lr: 3.047066431749581e-06
epoch 31 training time: 15.062
---------------
2023-09-24 14:31:04.963694
current #epochs=32, #steps=1209
start validation
acc: 0.746479
AUC: 0.909868
Avg Precision: 0.485919
Avg Recall: 1.000000
d_prime: 1.894963
train_loss: 0.065293
valid_loss: 1.333434
validation finished
normal learning rate scheduler step
Epoch-32 lr: 2.4496642917953662e-06
Epoch-32 lr: 2.4496642917953662e-06
epoch 32 training time: 15.001
---------------
2023-09-24 14:31:19.965075
current #epochs=33, #steps=1248
start validation
acc: 0.746479
AUC: 0.909832
Avg Precision: 0.485919
Avg Recall: 1.000000
d_prime: 1.894655
train_loss: 0.045420
valid_loss: 1.333463
validation finished
normal learning rate scheduler step
Epoch-33 lr: 1.969387696956673e-06
Epoch-33 lr: 1.969387696956673e-06
epoch 33 training time: 15.297
---------------
2023-09-24 14:31:35.262418
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00795	Per Sample Data Time 0.00230	Per Sample DNN Time 0.00565	Train Loss 0.0361	
start validation
acc: 0.746479
AUC: 0.910006
Avg Precision: 0.486007
Avg Recall: 1.000000
d_prime: 1.896163
train_loss: 0.056256
valid_loss: 1.333347
validation finished
normal learning rate scheduler step
Epoch-34 lr: 1.5832732321381687e-06
Epoch-34 lr: 1.5832732321381687e-06
epoch 34 training time: 15.100
---------------
2023-09-24 14:31:50.362071
current #epochs=35, #steps=1326
start validation
acc: 0.746479
AUC: 0.909953
Avg Precision: 0.486007
Avg Recall: 1.000000
d_prime: 1.895708
train_loss: 0.067366
valid_loss: 1.333372
validation finished
normal learning rate scheduler step
Epoch-35 lr: 1.2728596464164836e-06
Epoch-35 lr: 1.2728596464164836e-06
epoch 35 training time: 14.917
---------------
2023-09-24 14:32:05.279090
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00651	Per Sample Data Time 0.00100	Per Sample DNN Time 0.00551	Train Loss 0.0655	
start validation
acc: 0.746479
AUC: 0.909802
Avg Precision: 0.485919
Avg Recall: 1.000000
d_prime: 1.894395
train_loss: 0.068145
valid_loss: 1.333434
validation finished
normal learning rate scheduler step
Epoch-36 lr: 1.0233051671615116e-06
Epoch-36 lr: 1.0233051671615116e-06
epoch 36 training time: 15.466
---------------
2023-09-24 14:32:20.745103
current #epochs=37, #steps=1404
start validation
[I 2023-09-24 14:32:35,735] Trial 33 finished with value: 0.4860066321809075 and parameters: {'warmup': 'False', 'num_epochs': 37, 'batch_size': 35, 'lr-adaptschedule': 'False', 'lr': 0.0005734431244520937, 'head-lr': 1, 'lr-scheduler-start': 8, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.8039418721792702}. Best is trial 31 with value: 0.48893675561075667.
acc: 0.746479
AUC: 0.909920
Avg Precision: 0.486007
Avg Recall: 1.000000
d_prime: 1.895416
train_loss: 0.070336
valid_loss: 1.333436
validation finished
normal learning rate scheduler step
Epoch-37 lr: 8.226778718985467e-07
Epoch-37 lr: 8.226778718985467e-07
epoch 37 training time: 14.983
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa6015c49d0>
The learning rate scheduler starts at 7 epoch with decay rate of 0.787 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 14:32:35.768960
current #epochs=1, #steps=0
start validation
acc: 0.746479
AUC: 0.911252
Avg Precision: 0.488719
Avg Recall: 1.000000
d_prime: 1.907071
train_loss: 0.064545
valid_loss: 1.325526
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.00031530790797445075
Epoch-1 lr: 0.00031530790797445075
epoch 1 training time: 17.429
---------------
2023-09-24 14:32:53.198675
current #epochs=2, #steps=39
start validation
acc: 0.723005
AUC: 0.909327
Avg Precision: 0.484297
Avg Recall: 1.000000
d_prime: 1.890273
train_loss: 0.060917
valid_loss: 1.335183
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.00031530790797445075
Epoch-2 lr: 0.00031530790797445075
epoch 2 training time: 15.041
---------------
2023-09-24 14:33:08.239703
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00697	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00552	Train Loss 0.0667	
start validation
acc: 0.732394
AUC: 0.903746
Avg Precision: 0.457915
Avg Recall: 1.000000
d_prime: 1.842996
train_loss: 0.064318
valid_loss: 1.332037
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.00031530790797445075
Epoch-3 lr: 0.00031530790797445075
epoch 3 training time: 15.160
---------------
2023-09-24 14:33:23.399529
current #epochs=4, #steps=117
start validation
acc: 0.723005
AUC: 0.902594
Avg Precision: 0.482777
Avg Recall: 1.000000
d_prime: 1.833493
train_loss: 0.066099
valid_loss: 1.342391
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00031530790797445075
Epoch-4 lr: 0.00031530790797445075
epoch 4 training time: 15.170
---------------
2023-09-24 14:33:38.568860
current #epochs=5, #steps=156
start validation
acc: 0.727700
AUC: 0.906307
Avg Precision: 0.477725
Avg Recall: 1.000000
d_prime: 1.864426
train_loss: 0.079324
valid_loss: 1.339692
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00031530790797445075
Epoch-5 lr: 0.00031530790797445075
epoch 5 training time: 15.144
---------------
2023-09-24 14:33:53.713511
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01130	Per Sample Data Time 0.00532	Per Sample DNN Time 0.00598	Train Loss 0.1027	
start validation
acc: 0.708920
AUC: 0.903097
Avg Precision: 0.471110
Avg Recall: 1.000000
d_prime: 1.837631
train_loss: 0.081971
valid_loss: 1.347201
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00031530790797445075
Epoch-6 lr: 0.00031530790797445075
epoch 6 training time: 15.173
---------------
2023-09-24 14:34:08.886851
current #epochs=7, #steps=234
start validation
acc: 0.718310
AUC: 0.903983
Avg Precision: 0.469192
Avg Recall: 1.000000
d_prime: 1.844961
train_loss: 0.060654
valid_loss: 1.346226
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0002481958858977953
Epoch-7 lr: 0.0002481958858977953
epoch 7 training time: 15.077
---------------
2023-09-24 14:34:23.963242
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00677	Per Sample Data Time 0.00121	Per Sample DNN Time 0.00556	Train Loss 0.0711	
start validation
acc: 0.732394
AUC: 0.908910
Avg Precision: 0.472054
Avg Recall: 1.000000
d_prime: 1.886664
train_loss: 0.065549
valid_loss: 1.333606
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00019536838822825514
Epoch-8 lr: 0.00019536838822825514
epoch 8 training time: 15.129
---------------
2023-09-24 14:34:39.092713
current #epochs=9, #steps=312
start validation
acc: 0.732394
AUC: 0.909055
Avg Precision: 0.488253
Avg Recall: 1.000000
d_prime: 1.887920
train_loss: 0.074411
valid_loss: 1.334218
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00015378501130604465
Epoch-9 lr: 0.00015378501130604465
epoch 9 training time: 15.102
---------------
2023-09-24 14:34:54.194526
current #epochs=10, #steps=351
start validation
acc: 0.732394
AUC: 0.907137
Avg Precision: 0.473023
Avg Recall: 1.000000
d_prime: 1.871467
train_loss: 0.056176
valid_loss: 1.335493
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00012105248918146075
Epoch-10 lr: 0.00012105248918146075
epoch 10 training time: 15.017
---------------
2023-09-24 14:35:09.212032
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00857	Per Sample Data Time 0.00287	Per Sample DNN Time 0.00571	Train Loss 0.0761	
start validation
acc: 0.732394
AUC: 0.906805
Avg Precision: 0.471734
Avg Recall: 1.000000
d_prime: 1.868649
train_loss: 0.081848
valid_loss: 1.336851
validation finished
normal learning rate scheduler step
Epoch-11 lr: 9.528695295190771e-05
Epoch-11 lr: 9.528695295190771e-05
epoch 11 training time: 16.020
---------------
2023-09-24 14:35:25.232392
current #epochs=12, #steps=429
start validation
acc: 0.732394
AUC: 0.905936
Avg Precision: 0.466365
Avg Recall: 1.000000
d_prime: 1.861299
train_loss: 0.072946
valid_loss: 1.339962
validation finished
normal learning rate scheduler step
Epoch-12 lr: 7.500550764593133e-05
Epoch-12 lr: 7.500550764593133e-05
epoch 12 training time: 15.175
---------------
2023-09-24 14:35:40.407064
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00653	Per Sample Data Time 0.00103	Per Sample DNN Time 0.00550	Train Loss 0.0681	
start validation
acc: 0.746479
AUC: 0.907849
Avg Precision: 0.460488
Avg Recall: 1.000000
d_prime: 1.877546
train_loss: 0.072599
valid_loss: 1.335324
validation finished
normal learning rate scheduler step
Epoch-13 lr: 5.904088653210765e-05
Epoch-13 lr: 5.904088653210765e-05
epoch 13 training time: 15.001
---------------
2023-09-24 14:35:55.408438
current #epochs=14, #steps=507
start validation
acc: 0.741784
AUC: 0.908678
Avg Precision: 0.461280
Avg Recall: 1.000000
d_prime: 1.884661
train_loss: 0.062228
valid_loss: 1.334796
validation finished
normal learning rate scheduler step
Epoch-14 lr: 4.647427091557454e-05
Epoch-14 lr: 4.647427091557454e-05
epoch 14 training time: 15.163
---------------
2023-09-24 14:36:10.571261
current #epochs=15, #steps=546
start validation
acc: 0.741784
AUC: 0.908996
Avg Precision: 0.474103
Avg Recall: 1.000000
d_prime: 1.887406
train_loss: 0.061171
valid_loss: 1.335063
validation finished
normal learning rate scheduler step
Epoch-15 lr: 3.658240897110586e-05
Epoch-15 lr: 3.658240897110586e-05
epoch 15 training time: 15.110
---------------
2023-09-24 14:36:25.680748
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00768	Per Sample Data Time 0.00207	Per Sample DNN Time 0.00561	Train Loss 0.0475	
start validation
acc: 0.741784
AUC: 0.908309
Avg Precision: 0.474016
Avg Recall: 1.000000
d_prime: 1.881493
train_loss: 0.060899
valid_loss: 1.335532
validation finished
normal learning rate scheduler step
Epoch-16 lr: 2.8795990120218583e-05
Epoch-16 lr: 2.8795990120218583e-05
epoch 16 training time: 15.217
---------------
2023-09-24 14:36:40.897620
current #epochs=17, #steps=624
start validation
acc: 0.737089
AUC: 0.908408
Avg Precision: 0.475413
Avg Recall: 1.000000
d_prime: 1.882342
train_loss: 0.051189
valid_loss: 1.336647
validation finished
normal learning rate scheduler step
Epoch-17 lr: 2.266687925496285e-05
Epoch-17 lr: 2.266687925496285e-05
epoch 17 training time: 15.142
---------------
2023-09-24 14:36:56.039480
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00649	Per Sample Data Time 0.00096	Per Sample DNN Time 0.00554	Train Loss 0.0505	
start validation
acc: 0.737089
AUC: 0.908227
Avg Precision: 0.475752
Avg Recall: 1.000000
d_prime: 1.880787
train_loss: 0.049662
valid_loss: 1.337332
validation finished
normal learning rate scheduler step
Epoch-18 lr: 1.7842325025605517e-05
Epoch-18 lr: 1.7842325025605517e-05
epoch 18 training time: 15.320
---------------
2023-09-24 14:37:11.359554
current #epochs=19, #steps=702
start validation
acc: 0.737089
AUC: 0.908268
Avg Precision: 0.475350
Avg Recall: 1.000000
d_prime: 1.881135
train_loss: 0.059243
valid_loss: 1.337312
validation finished
normal learning rate scheduler step
Epoch-19 lr: 1.4044657790712295e-05
Epoch-19 lr: 1.4044657790712295e-05
epoch 19 training time: 15.009
---------------
2023-09-24 14:37:26.368817
current #epochs=20, #steps=741
start validation
acc: 0.732394
AUC: 0.908416
Avg Precision: 0.475350
Avg Recall: 1.000000
d_prime: 1.882412
train_loss: 0.050112
valid_loss: 1.337911
validation finished
normal learning rate scheduler step
Epoch-20 lr: 1.1055308777030945e-05
Epoch-20 lr: 1.1055308777030945e-05
epoch 20 training time: 15.204
---------------
2023-09-24 14:37:41.572420
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00726	Per Sample Data Time 0.00164	Per Sample DNN Time 0.00562	Train Loss 0.0584	
start validation
acc: 0.732394
AUC: 0.908183
Avg Precision: 0.475595
Avg Recall: 1.000000
d_prime: 1.880410
train_loss: 0.056148
valid_loss: 1.337891
validation finished
normal learning rate scheduler step
Epoch-21 lr: 8.702230697021411e-06
Epoch-21 lr: 8.702230697021411e-06
epoch 21 training time: 15.161
---------------
2023-09-24 14:37:56.733885
current #epochs=22, #steps=819
start validation
acc: 0.732394
AUC: 0.908016
Avg Precision: 0.475535
Avg Recall: 1.000000
d_prime: 1.878972
train_loss: 0.064332
valid_loss: 1.337980
validation finished
normal learning rate scheduler step
Epoch-22 lr: 6.849995837431488e-06
Epoch-22 lr: 6.849995837431488e-06
epoch 22 training time: 15.093
---------------
2023-09-24 14:38:11.826634
current #epochs=23, #steps=858
start validation
acc: 0.732394
AUC: 0.908139
Avg Precision: 0.475843
Avg Recall: 1.000000
d_prime: 1.880034
train_loss: 0.064115
valid_loss: 1.338173
validation finished
normal learning rate scheduler step
Epoch-23 lr: 5.3920017299575e-06
Epoch-23 lr: 5.3920017299575e-06
epoch 23 training time: 15.105
---------------
2023-09-24 14:38:26.931361
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01358	Per Sample Data Time 0.00746	Per Sample DNN Time 0.00612	Train Loss 0.0475	
start validation
acc: 0.732394
AUC: 0.908030
Avg Precision: 0.475843
Avg Recall: 1.000000
d_prime: 1.879092
train_loss: 0.056450
valid_loss: 1.338329
validation finished
normal learning rate scheduler step
Epoch-24 lr: 4.2443358136063184e-06
Epoch-24 lr: 4.2443358136063184e-06
epoch 24 training time: 15.082
---------------
2023-09-24 14:38:42.013301
current #epochs=25, #steps=936
start validation
acc: 0.732394
AUC: 0.907971
Avg Precision: 0.475843
Avg Recall: 1.000000
d_prime: 1.878589
train_loss: 0.062975
valid_loss: 1.338392
validation finished
normal learning rate scheduler step
Epoch-25 lr: 3.340945979036843e-06
Epoch-25 lr: 3.340945979036843e-06
epoch 25 training time: 15.815
---------------
2023-09-24 14:38:57.828041
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00680	Per Sample Data Time 0.00128	Per Sample DNN Time 0.00552	Train Loss 0.0463	
start validation
acc: 0.732394
AUC: 0.907884
Avg Precision: 0.475843
Avg Recall: 1.000000
d_prime: 1.877842
train_loss: 0.054713
valid_loss: 1.338401
validation finished
normal learning rate scheduler step
Epoch-26 lr: 2.62983904314546e-06
Epoch-26 lr: 2.62983904314546e-06
epoch 26 training time: 15.090
---------------
2023-09-24 14:39:12.918434
current #epochs=27, #steps=1014
start validation
acc: 0.732394
AUC: 0.907757
Avg Precision: 0.475843
Avg Recall: 1.000000
d_prime: 1.876762
train_loss: 0.054275
valid_loss: 1.338452
validation finished
normal learning rate scheduler step
Epoch-27 lr: 2.0700883630707642e-06
Epoch-27 lr: 2.0700883630707642e-06
epoch 27 training time: 15.088
---------------
2023-09-24 14:39:28.006967
current #epochs=28, #steps=1053
start validation
acc: 0.732394
AUC: 0.907842
Avg Precision: 0.475843
Avg Recall: 1.000000
d_prime: 1.877488
train_loss: 0.062357
valid_loss: 1.338510
validation finished
normal learning rate scheduler step
Epoch-28 lr: 1.6294783675412837e-06
Epoch-28 lr: 1.6294783675412837e-06
epoch 28 training time: 16.127
---------------
2023-09-24 14:39:44.133470
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00932	Per Sample Data Time 0.00355	Per Sample DNN Time 0.00577	Train Loss 0.0366	
start validation
acc: 0.732394
AUC: 0.907866
Avg Precision: 0.475843
Avg Recall: 1.000000
d_prime: 1.877688
train_loss: 0.058441
valid_loss: 1.338562
validation finished
normal learning rate scheduler step
Epoch-29 lr: 1.2826504402673372e-06
Epoch-29 lr: 1.2826504402673372e-06
epoch 29 training time: 15.033
---------------
2023-09-24 14:39:59.166951
current #epochs=30, #steps=1131
start validation
acc: 0.732394
AUC: 0.907851
Avg Precision: 0.475843
Avg Recall: 1.000000
d_prime: 1.877560
train_loss: 0.055902
valid_loss: 1.338603
validation finished
normal learning rate scheduler step
Epoch-30 lr: 1.0096434446076266e-06
Epoch-30 lr: 1.0096434446076266e-06
epoch 30 training time: 15.168
---------------
2023-09-24 14:40:14.334581
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00670	Per Sample Data Time 0.00108	Per Sample DNN Time 0.00562	Train Loss 0.0573	
start validation
acc: 0.732394
AUC: 0.907768
Avg Precision: 0.475843
Avg Recall: 1.000000
d_prime: 1.876849
train_loss: 0.058652
valid_loss: 1.338597
validation finished
normal learning rate scheduler step
Epoch-31 lr: 7.947448916999464e-07
Epoch-31 lr: 7.947448916999464e-07
epoch 31 training time: 15.746
---------------
2023-09-24 14:40:30.080732
current #epochs=32, #steps=1209
start validation
acc: 0.732394
AUC: 0.907711
Avg Precision: 0.475843
Avg Recall: 1.000000
d_prime: 1.876363
train_loss: 0.054148
valid_loss: 1.338613
validation finished
normal learning rate scheduler step
Epoch-32 lr: 6.255866328420754e-07
Epoch-32 lr: 6.255866328420754e-07
epoch 32 training time: 14.990
---------------
2023-09-24 14:40:45.070492
current #epochs=33, #steps=1248
start validation
acc: 0.732394
AUC: 0.907785
Avg Precision: 0.476155
Avg Recall: 1.000000
d_prime: 1.877001
train_loss: 0.077432
valid_loss: 1.338615
validation finished
normal learning rate scheduler step
Epoch-33 lr: 4.924330301180997e-07
Epoch-33 lr: 4.924330301180997e-07
epoch 33 training time: 15.103
---------------
2023-09-24 14:41:00.173545
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00802	Per Sample Data Time 0.00231	Per Sample DNN Time 0.00571	Train Loss 0.0678	
start validation
acc: 0.732394
AUC: 0.907785
Avg Precision: 0.476155
Avg Recall: 1.000000
d_prime: 1.877001
train_loss: 0.058604
valid_loss: 1.338621
validation finished
normal learning rate scheduler step
Epoch-34 lr: 3.876206370485351e-07
Epoch-34 lr: 3.876206370485351e-07
epoch 34 training time: 15.134
---------------
2023-09-24 14:41:15.307383
current #epochs=35, #steps=1326
start validation
acc: 0.732394
AUC: 0.907807
Avg Precision: 0.476155
Avg Recall: 1.000000
d_prime: 1.877184
train_loss: 0.066793
valid_loss: 1.338623
validation finished
normal learning rate scheduler step
Epoch-35 lr: 3.051171409640778e-07
Epoch-35 lr: 3.051171409640778e-07
epoch 35 training time: 15.209
---------------
2023-09-24 14:41:30.516456
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00652	Per Sample Data Time 0.00099	Per Sample DNN Time 0.00553	Train Loss 0.0652	
start validation
[I 2023-09-24 14:41:45,692] Trial 34 finished with value: 0.47615516074063086 and parameters: {'warmup': 'False', 'num_epochs': 36, 'batch_size': 35, 'lr-adaptschedule': 'False', 'lr': 0.00031530790797445075, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7871540155532875}. Best is trial 31 with value: 0.48893675561075667.
acc: 0.732394
AUC: 0.907785
Avg Precision: 0.476155
Avg Recall: 1.000000
d_prime: 1.877001
train_loss: 0.068371
valid_loss: 1.338627
validation finished
normal learning rate scheduler step
Epoch-36 lr: 2.401741827240123e-07
Epoch-36 lr: 2.401741827240123e-07
epoch 36 training time: 15.168
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67ec59fa0>
The learning rate scheduler starts at 7 epoch with decay rate of 0.772 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 14:41:45.726276
current #epochs=1, #steps=0
start validation
acc: 0.732394
AUC: 0.893709
Avg Precision: 0.473307
Avg Recall: 1.000000
d_prime: 1.762811
train_loss: 0.072929
valid_loss: 1.354548
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0005043322006799387
Epoch-1 lr: 0.0005043322006799387
epoch 1 training time: 17.589
---------------
2023-09-24 14:42:03.315805
current #epochs=2, #steps=39
start validation
acc: 0.737089
AUC: 0.900276
Avg Precision: 0.488649
Avg Recall: 1.000000
d_prime: 1.814611
train_loss: 0.078415
valid_loss: 1.340215
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0005043322006799387
Epoch-2 lr: 0.0005043322006799387
epoch 2 training time: 17.570
---------------
2023-09-24 14:42:20.885941
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00563	Train Loss 0.0653	
start validation
acc: 0.746479
AUC: 0.906622
Avg Precision: 0.497911
Avg Recall: 1.000000
d_prime: 1.867093
train_loss: 0.055632
valid_loss: 1.345593
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0005043322006799387
Epoch-3 lr: 0.0005043322006799387
epoch 3 training time: 17.900
---------------
2023-09-24 14:42:38.786269
current #epochs=4, #steps=117
start validation
acc: 0.746479
AUC: 0.902531
Avg Precision: 0.493609
Avg Recall: 1.000000
d_prime: 1.832971
train_loss: 0.074161
valid_loss: 1.341797
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0005043322006799387
Epoch-4 lr: 0.0005043322006799387
epoch 4 training time: 16.114
---------------
2023-09-24 14:42:54.900584
current #epochs=5, #steps=156
start validation
acc: 0.741784
AUC: 0.905829
Avg Precision: 0.484337
Avg Recall: 1.000000
d_prime: 1.860394
train_loss: 0.075348
valid_loss: 1.330978
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0005043322006799387
Epoch-5 lr: 0.0005043322006799387
epoch 5 training time: 15.184
---------------
2023-09-24 14:43:10.084309
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01123	Per Sample Data Time 0.00532	Per Sample DNN Time 0.00591	Train Loss 0.1023	
start validation
acc: 0.727700
AUC: 0.900841
Avg Precision: 0.475792
Avg Recall: 1.000000
d_prime: 1.819189
train_loss: 0.079799
valid_loss: 1.340515
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0005043322006799387
Epoch-6 lr: 0.0005043322006799387
epoch 6 training time: 16.498
---------------
2023-09-24 14:43:26.582552
current #epochs=7, #steps=234
start validation
acc: 0.741784
AUC: 0.913929
Avg Precision: 0.497900
Avg Recall: 1.000000
d_prime: 1.930897
train_loss: 0.073372
valid_loss: 1.319306
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00038954890846300494
Epoch-7 lr: 0.00038954890846300494
epoch 7 training time: 15.059
---------------
2023-09-24 14:43:41.641909
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00676	Per Sample Data Time 0.00121	Per Sample DNN Time 0.00555	Train Loss 0.0509	
start validation
acc: 0.755869
AUC: 0.910864
Avg Precision: 0.495189
Avg Recall: 1.000000
d_prime: 1.903666
train_loss: 0.065962
valid_loss: 1.323962
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.000300889675257959
Epoch-8 lr: 0.000300889675257959
epoch 8 training time: 17.420
---------------
2023-09-24 14:43:59.061628
current #epochs=9, #steps=312
start validation
acc: 0.732394
AUC: 0.908949
Avg Precision: 0.491619
Avg Recall: 1.000000
d_prime: 1.887001
train_loss: 0.058367
valid_loss: 1.342525
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0002324088059546906
Epoch-9 lr: 0.0002324088059546906
epoch 9 training time: 15.205
---------------
2023-09-24 14:44:14.266534
current #epochs=10, #steps=351
start validation
acc: 0.755869
AUC: 0.912068
Avg Precision: 0.485425
Avg Recall: 1.000000
d_prime: 1.914275
train_loss: 0.067941
valid_loss: 1.330204
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00017951381362280982
Epoch-10 lr: 0.00017951381362280982
epoch 10 training time: 15.039
---------------
2023-09-24 14:44:29.305990
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00859	Per Sample Data Time 0.00285	Per Sample DNN Time 0.00574	Train Loss 0.1224	
start validation
acc: 0.769953
AUC: 0.911616
Avg Precision: 0.470632
Avg Recall: 1.000000
d_prime: 1.910278
train_loss: 0.090166
valid_loss: 1.328598
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00013865743661919329
Epoch-11 lr: 0.00013865743661919329
epoch 11 training time: 17.647
---------------
2023-09-24 14:44:46.952889
current #epochs=12, #steps=429
start validation
acc: 0.765258
AUC: 0.911513
Avg Precision: 0.477710
Avg Recall: 1.000000
d_prime: 1.909370
train_loss: 0.052986
valid_loss: 1.329733
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00010709975094285823
Epoch-12 lr: 0.00010709975094285823
epoch 12 training time: 15.086
---------------
2023-09-24 14:45:02.038183
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00662	Per Sample Data Time 0.00106	Per Sample DNN Time 0.00556	Train Loss 0.0583	
start validation
acc: 0.755869
AUC: 0.910964
Avg Precision: 0.477093
Avg Recall: 1.000000
d_prime: 1.904544
train_loss: 0.055034
valid_loss: 1.333051
validation finished
normal learning rate scheduler step
Epoch-13 lr: 8.27244245364515e-05
Epoch-13 lr: 8.27244245364515e-05
epoch 13 training time: 15.147
---------------
2023-09-24 14:45:17.185312
current #epochs=14, #steps=507
start validation
acc: 0.755869
AUC: 0.911582
Avg Precision: 0.483227
Avg Recall: 1.000000
d_prime: 1.909980
train_loss: 0.070726
valid_loss: 1.334182
validation finished
normal learning rate scheduler step
Epoch-14 lr: 6.3896791118947e-05
Epoch-14 lr: 6.3896791118947e-05
epoch 14 training time: 15.085
---------------
2023-09-24 14:45:32.270625
current #epochs=15, #steps=546
start validation
acc: 0.751174
AUC: 0.912230
Avg Precision: 0.485409
Avg Recall: 1.000000
d_prime: 1.915717
train_loss: 0.066139
valid_loss: 1.334786
validation finished
normal learning rate scheduler step
Epoch-15 lr: 4.93542256495155e-05
Epoch-15 lr: 4.93542256495155e-05
epoch 15 training time: 14.962
---------------
2023-09-24 14:45:47.232580
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00775	Per Sample Data Time 0.00207	Per Sample DNN Time 0.00567	Train Loss 0.0539	
start validation
acc: 0.751174
AUC: 0.911201
Avg Precision: 0.485213
Avg Recall: 1.000000
d_prime: 1.906623
train_loss: 0.059012
valid_loss: 1.336132
validation finished
normal learning rate scheduler step
Epoch-16 lr: 3.812146974530942e-05
Epoch-16 lr: 3.812146974530942e-05
epoch 16 training time: 15.171
---------------
2023-09-24 14:46:02.403491
current #epochs=17, #steps=624
start validation
acc: 0.755869
AUC: 0.911212
Avg Precision: 0.486021
Avg Recall: 1.000000
d_prime: 1.906722
train_loss: 0.057946
valid_loss: 1.336534
validation finished
normal learning rate scheduler step
Epoch-17 lr: 2.944522857804796e-05
Epoch-17 lr: 2.944522857804796e-05
epoch 17 training time: 16.361
---------------
2023-09-24 14:46:18.764767
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00647	Per Sample Data Time 0.00095	Per Sample DNN Time 0.00552	Train Loss 0.0587	
start validation
acc: 0.755869
AUC: 0.911002
Avg Precision: 0.486594
Avg Recall: 1.000000
d_prime: 1.904880
train_loss: 0.059889
valid_loss: 1.336783
validation finished
normal learning rate scheduler step
Epoch-18 lr: 2.2743653164636264e-05
Epoch-18 lr: 2.2743653164636264e-05
epoch 18 training time: 15.110
---------------
2023-09-24 14:46:33.874557
current #epochs=19, #steps=702
start validation
acc: 0.755869
AUC: 0.910916
Avg Precision: 0.486206
Avg Recall: 1.000000
d_prime: 1.904124
train_loss: 0.059099
valid_loss: 1.336596
validation finished
normal learning rate scheduler step
Epoch-19 lr: 1.7567320216318772e-05
Epoch-19 lr: 1.7567320216318772e-05
epoch 19 training time: 15.078
---------------
2023-09-24 14:46:48.952655
current #epochs=20, #steps=741
start validation
acc: 0.755869
AUC: 0.911081
Avg Precision: 0.493537
Avg Recall: 1.000000
d_prime: 1.905572
train_loss: 0.063934
valid_loss: 1.335991
validation finished
normal learning rate scheduler step
Epoch-20 lr: 1.3569092763977604e-05
Epoch-20 lr: 1.3569092763977604e-05
epoch 20 training time: 15.017
---------------
2023-09-24 14:47:03.969916
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00160	Per Sample DNN Time 0.00550	Train Loss 0.0569	
start validation
acc: 0.760563
AUC: 0.910754
Avg Precision: 0.493350
Avg Recall: 1.000000
d_prime: 1.902698
train_loss: 0.057946
valid_loss: 1.335650
validation finished
normal learning rate scheduler step
Epoch-21 lr: 1.0480840342762974e-05
Epoch-21 lr: 1.0480840342762974e-05
epoch 21 training time: 15.105
---------------
2023-09-24 14:47:19.074729
current #epochs=22, #steps=819
start validation
acc: 0.760563
AUC: 0.910611
Avg Precision: 0.493027
Avg Recall: 1.000000
d_prime: 1.901445
train_loss: 0.062557
valid_loss: 1.335951
validation finished
normal learning rate scheduler step
Epoch-22 lr: 8.095457537301658e-06
Epoch-22 lr: 8.095457537301658e-06
epoch 22 training time: 15.079
---------------
2023-09-24 14:47:34.153347
current #epochs=23, #steps=858
start validation
acc: 0.760563
AUC: 0.910605
Avg Precision: 0.492581
Avg Recall: 1.000000
d_prime: 1.901394
train_loss: 0.057498
valid_loss: 1.336299
validation finished
normal learning rate scheduler step
Epoch-23 lr: 6.25297500915632e-06
Epoch-23 lr: 6.25297500915632e-06
epoch 23 training time: 15.866
---------------
2023-09-24 14:47:50.019134
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01384	Per Sample Data Time 0.00812	Per Sample DNN Time 0.00572	Train Loss 0.0569	
start validation
acc: 0.760563
AUC: 0.910654
Avg Precision: 0.492951
Avg Recall: 1.000000
d_prime: 1.901827
train_loss: 0.054769
valid_loss: 1.336241
validation finished
normal learning rate scheduler step
Epoch-24 lr: 4.829831579620146e-06
Epoch-24 lr: 4.829831579620146e-06
epoch 24 training time: 15.166
---------------
2023-09-24 14:48:05.185148
current #epochs=25, #steps=936
start validation
acc: 0.760563
AUC: 0.910631
Avg Precision: 0.493083
Avg Recall: 1.000000
d_prime: 1.901625
train_loss: 0.076417
valid_loss: 1.336354
validation finished
normal learning rate scheduler step
Epoch-25 lr: 3.7305879286799605e-06
Epoch-25 lr: 3.7305879286799605e-06
epoch 25 training time: 15.180
---------------
2023-09-24 14:48:20.364930
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00692	Per Sample Data Time 0.00127	Per Sample DNN Time 0.00565	Train Loss 0.0648	
start validation
acc: 0.760563
AUC: 0.910635
Avg Precision: 0.493083
Avg Recall: 1.000000
d_prime: 1.901655
train_loss: 0.065049
valid_loss: 1.336458
validation finished
normal learning rate scheduler step
Epoch-26 lr: 2.8815262114599857e-06
Epoch-26 lr: 2.8815262114599857e-06
epoch 26 training time: 15.148
---------------
2023-09-24 14:48:35.512875
current #epochs=27, #steps=1014
start validation
acc: 0.760563
AUC: 0.910562
Avg Precision: 0.492951
Avg Recall: 1.000000
d_prime: 1.901018
train_loss: 0.056327
valid_loss: 1.336505
validation finished
normal learning rate scheduler step
Epoch-27 lr: 2.2257063674864134e-06
Epoch-27 lr: 2.2257063674864134e-06
epoch 27 training time: 15.086
---------------
2023-09-24 14:48:50.599232
current #epochs=28, #steps=1053
start validation
acc: 0.760563
AUC: 0.910671
Avg Precision: 0.493083
Avg Recall: 1.000000
d_prime: 1.901973
train_loss: 0.061862
valid_loss: 1.336455
validation finished
normal learning rate scheduler step
Epoch-28 lr: 1.719147587333462e-06
Epoch-28 lr: 1.719147587333462e-06
epoch 28 training time: 15.117
---------------
2023-09-24 14:49:05.716932
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00956	Per Sample Data Time 0.00371	Per Sample DNN Time 0.00586	Train Loss 0.0456	
start validation
acc: 0.755869
AUC: 0.910814
Avg Precision: 0.493218
Avg Recall: 1.000000
d_prime: 1.903231
train_loss: 0.048988
valid_loss: 1.336422
validation finished
normal learning rate scheduler step
Epoch-29 lr: 1.327878856891712e-06
Epoch-29 lr: 1.327878856891712e-06
epoch 29 training time: 15.278
---------------
2023-09-24 14:49:20.994728
current #epochs=30, #steps=1131
start validation
acc: 0.755869
AUC: 0.910698
Avg Precision: 0.493083
Avg Recall: 1.000000
d_prime: 1.902209
train_loss: 0.056034
valid_loss: 1.336428
validation finished
normal learning rate scheduler step
Epoch-30 lr: 1.0256607818733023e-06
Epoch-30 lr: 1.0256607818733023e-06
epoch 30 training time: 15.174
---------------
2023-09-24 14:49:36.168707
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00664	Per Sample Data Time 0.00112	Per Sample DNN Time 0.00552	Train Loss 0.0629	
start validation
acc: 0.755869
AUC: 0.910699
Avg Precision: 0.493083
Avg Recall: 1.000000
d_prime: 1.902218
train_loss: 0.064312
valid_loss: 1.336353
validation finished
normal learning rate scheduler step
Epoch-31 lr: 7.922259127880234e-07
Epoch-31 lr: 7.922259127880234e-07
epoch 31 training time: 15.153
---------------
2023-09-24 14:49:51.321250
current #epochs=32, #steps=1209
start validation
acc: 0.755869
AUC: 0.910699
Avg Precision: 0.493083
Avg Recall: 1.000000
d_prime: 1.902218
train_loss: 0.078995
valid_loss: 1.336353
validation finished
normal learning rate scheduler step
Epoch-32 lr: 6.119195624761109e-07
Epoch-32 lr: 6.119195624761109e-07
epoch 32 training time: 15.173
---------------
2023-09-24 14:50:06.493863
current #epochs=33, #steps=1248
start validation
acc: 0.755869
AUC: 0.910685
Avg Precision: 0.493083
Avg Recall: 1.000000
d_prime: 1.902096
train_loss: 0.060965
valid_loss: 1.336356
validation finished
normal learning rate scheduler step
Epoch-33 lr: 4.72649966249142e-07
Epoch-33 lr: 4.72649966249142e-07
epoch 33 training time: 15.133
---------------
2023-09-24 14:50:21.626501
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00799	Per Sample Data Time 0.00238	Per Sample DNN Time 0.00562	Train Loss 0.0701	
start validation
acc: 0.755869
AUC: 0.910678
Avg Precision: 0.493083
Avg Recall: 1.000000
d_prime: 1.902031
train_loss: 0.069933
valid_loss: 1.336339
validation finished
normal learning rate scheduler step
Epoch-34 lr: 3.6507737992775223e-07
Epoch-34 lr: 3.6507737992775223e-07
epoch 34 training time: 15.047
---------------
2023-09-24 14:50:36.673439
current #epochs=35, #steps=1326
start validation
acc: 0.755869
AUC: 0.910699
Avg Precision: 0.493083
Avg Recall: 1.000000
d_prime: 1.902218
train_loss: 0.049307
valid_loss: 1.336304
validation finished
normal learning rate scheduler step
Epoch-35 lr: 2.819877347979273e-07
Epoch-35 lr: 2.819877347979273e-07
epoch 35 training time: 15.049
---------------
2023-09-24 14:50:51.721946
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00653	Per Sample Data Time 0.00096	Per Sample DNN Time 0.00556	Train Loss 0.0605	
start validation
acc: 0.755869
AUC: 0.910699
Avg Precision: 0.493083
Avg Recall: 1.000000
d_prime: 1.902218
train_loss: 0.059879
valid_loss: 1.336293
validation finished
normal learning rate scheduler step
Epoch-36 lr: 2.1780884532534552e-07
Epoch-36 lr: 2.1780884532534552e-07
epoch 36 training time: 15.153
---------------
2023-09-24 14:51:06.874948
current #epochs=37, #steps=1404
start validation
acc: 0.755869
AUC: 0.910699
Avg Precision: 0.493083
Avg Recall: 1.000000
d_prime: 1.902218
train_loss: 0.067012
valid_loss: 1.336291
validation finished
normal learning rate scheduler step
Epoch-37 lr: 1.6823672538791923e-07
Epoch-37 lr: 1.6823672538791923e-07
epoch 37 training time: 15.161
---------------
2023-09-24 14:51:22.036364
current #epochs=38, #steps=1443
start validation
acc: 0.755869
AUC: 0.910699
Avg Precision: 0.493083
Avg Recall: 1.000000
d_prime: 1.902218
train_loss: 0.080106
valid_loss: 1.336289
validation finished
normal learning rate scheduler step
Epoch-38 lr: 1.2994695292090865e-07
Epoch-38 lr: 1.2994695292090865e-07
epoch 38 training time: 15.403
---------------
2023-09-24 14:51:37.439373
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00742	Per Sample Data Time 0.00183	Per Sample DNN Time 0.00558	Train Loss 0.0793	
start validation
acc: 0.755869
AUC: 0.910699
Avg Precision: 0.493083
Avg Recall: 1.000000
d_prime: 1.902218
train_loss: 0.071641
valid_loss: 1.336293
validation finished
normal learning rate scheduler step
Epoch-39 lr: 1.0037172641403192e-07
Epoch-39 lr: 1.0037172641403192e-07
epoch 39 training time: 15.106
---------------
2023-09-24 14:51:52.545192
current #epochs=40, #steps=1521
start validation
acc: 0.755869
AUC: 0.910678
Avg Precision: 0.493083
Avg Recall: 1.000000
d_prime: 1.902031
train_loss: 0.059294
valid_loss: 1.336294
validation finished
normal learning rate scheduler step
Epoch-40 lr: 7.75276621489158e-08
Epoch-40 lr: 7.75276621489158e-08
epoch 40 training time: 14.972
---------------
2023-09-24 14:52:07.517417
current #epochs=41, #steps=1560
start validation
acc: 0.755869
AUC: 0.910678
Avg Precision: 0.493083
Avg Recall: 1.000000
d_prime: 1.902031
train_loss: 0.054600
valid_loss: 1.336293
validation finished
normal learning rate scheduler step
Epoch-41 lr: 5.988278385770758e-08
Epoch-41 lr: 5.988278385770758e-08
epoch 41 training time: 15.213
---------------
2023-09-24 14:52:22.730575
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02245	Per Sample Data Time 0.01581	Per Sample DNN Time 0.00664	Train Loss 0.0146	
start validation
acc: 0.755869
AUC: 0.910678
Avg Precision: 0.493083
Avg Recall: 1.000000
d_prime: 1.902031
train_loss: 0.047478
valid_loss: 1.336294
validation finished
normal learning rate scheduler step
Epoch-42 lr: 4.625378481890765e-08
Epoch-42 lr: 4.625378481890765e-08
epoch 42 training time: 15.214
---------------
2023-09-24 14:52:37.943827
current #epochs=43, #steps=1638
start validation
acc: 0.755869
AUC: 0.910678
Avg Precision: 0.493083
Avg Recall: 1.000000
d_prime: 1.902031
train_loss: 0.050742
valid_loss: 1.336293
validation finished
normal learning rate scheduler step
Epoch-43 lr: 3.5726672546778165e-08
Epoch-43 lr: 3.5726672546778165e-08
epoch 43 training time: 15.137
---------------
2023-09-24 14:52:53.080661
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00696	Per Sample Data Time 0.00138	Per Sample DNN Time 0.00558	Train Loss 0.0678	
start validation
acc: 0.755869
AUC: 0.910678
Avg Precision: 0.493083
Avg Recall: 1.000000
d_prime: 1.902031
train_loss: 0.076076
valid_loss: 1.336293
validation finished
normal learning rate scheduler step
Epoch-44 lr: 2.759547432198342e-08
Epoch-44 lr: 2.759547432198342e-08
epoch 44 training time: 15.202
---------------
2023-09-24 14:53:08.282204
current #epochs=45, #steps=1716
start validation
acc: 0.755869
AUC: 0.910678
Avg Precision: 0.493083
Avg Recall: 1.000000
d_prime: 1.902031
train_loss: 0.058048
valid_loss: 1.336294
validation finished
normal learning rate scheduler step
Epoch-45 lr: 2.1314893013285095e-08
Epoch-45 lr: 2.1314893013285095e-08
epoch 45 training time: 15.163
---------------
2023-09-24 14:53:23.445279
current #epochs=46, #steps=1755
start validation
acc: 0.755869
AUC: 0.910678
Avg Precision: 0.493083
Avg Recall: 1.000000
d_prime: 1.902031
train_loss: 0.066266
valid_loss: 1.336294
validation finished
normal learning rate scheduler step
Epoch-46 lr: 1.6463738179193407e-08
Epoch-46 lr: 1.6463738179193407e-08
epoch 46 training time: 15.003
---------------
2023-09-24 14:53:38.448334
current #epochs=47, #steps=1794
Epoch: [47][6/39]	Per Sample Total Time 0.01028	Per Sample Data Time 0.00432	Per Sample DNN Time 0.00596	Train Loss 0.0289	
start validation
acc: 0.755869
AUC: 0.910678
Avg Precision: 0.493083
Avg Recall: 1.000000
d_prime: 1.902031
train_loss: 0.063499
valid_loss: 1.336294
validation finished
normal learning rate scheduler step
Epoch-47 lr: 1.2716680053898855e-08
Epoch-47 lr: 1.2716680053898855e-08
epoch 47 training time: 15.127
---------------
2023-09-24 14:53:53.575890
current #epochs=48, #steps=1833
start validation
acc: 0.755869
AUC: 0.910678
Avg Precision: 0.493083
Avg Recall: 1.000000
d_prime: 1.902031
train_loss: 0.064834
valid_loss: 1.336295
validation finished
normal learning rate scheduler step
Epoch-48 lr: 9.822432173854681e-09
Epoch-48 lr: 9.822432173854681e-09
epoch 48 training time: 15.165
---------------
2023-09-24 14:54:08.740794
current #epochs=49, #steps=1872
Epoch: [49][28/39]	Per Sample Total Time 0.00664	Per Sample Data Time 0.00112	Per Sample DNN Time 0.00552	Train Loss 0.0516	
start validation
acc: 0.755869
AUC: 0.910678
Avg Precision: 0.493083
Avg Recall: 1.000000
d_prime: 1.902031
train_loss: 0.055383
valid_loss: 1.336295
validation finished
normal learning rate scheduler step
Epoch-49 lr: 7.586899521026746e-09
Epoch-49 lr: 7.586899521026746e-09
epoch 49 training time: 14.936
---------------
2023-09-24 14:54:23.676913
current #epochs=50, #steps=1911
start validation
[I 2023-09-24 14:54:38,706] Trial 35 finished with value: 0.49308337070783964 and parameters: {'warmup': 'True', 'num_epochs': 50, 'batch_size': 36, 'lr-adaptschedule': 'False', 'lr': 0.0005043322006799387, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7724053866435984}. Best is trial 35 with value: 0.49308337070783964.
acc: 0.755869
AUC: 0.910678
Avg Precision: 0.493083
Avg Recall: 1.000000
d_prime: 1.902031
train_loss: 0.053199
valid_loss: 1.336295
validation finished
normal learning rate scheduler step
Epoch-50 lr: 5.860162057964795e-09
Epoch-50 lr: 5.860162057964795e-09
epoch 50 training time: 15.023
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f577b80>
The learning rate scheduler starts at 7 epoch with decay rate of 0.770 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 14:54:38.740813
current #epochs=1, #steps=0
start validation
acc: 0.694836
AUC: 0.900399
Avg Precision: 0.464022
Avg Recall: 1.000000
d_prime: 1.815605
train_loss: 0.101095
valid_loss: 1.346458
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0004933726569920254
Epoch-1 lr: 0.0004933726569920254
epoch 1 training time: 17.582
---------------
2023-09-24 14:54:56.323763
current #epochs=2, #steps=39
start validation
acc: 0.732394
AUC: 0.904414
Avg Precision: 0.470961
Avg Recall: 1.000000
d_prime: 1.848547
train_loss: 0.066682
valid_loss: 1.342869
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0004933726569920254
Epoch-2 lr: 0.0004933726569920254
epoch 2 training time: 17.589
---------------
2023-09-24 14:55:13.912951
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00700	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00551	Train Loss 0.0910	
start validation
acc: 0.732394
AUC: 0.901893
Avg Precision: 0.484579
Avg Recall: 1.000000
d_prime: 1.827749
train_loss: 0.088404
valid_loss: 1.345745
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0004933726569920254
Epoch-3 lr: 0.0004933726569920254
epoch 3 training time: 15.040
---------------
2023-09-24 14:55:28.953329
current #epochs=4, #steps=117
start validation
acc: 0.723005
AUC: 0.902326
Avg Precision: 0.470916
Avg Recall: 1.000000
d_prime: 1.831290
train_loss: 0.076844
valid_loss: 1.345999
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0004933726569920254
Epoch-4 lr: 0.0004933726569920254
epoch 4 training time: 16.141
---------------
2023-09-24 14:55:45.094458
current #epochs=5, #steps=156
start validation
acc: 0.718310
AUC: 0.902662
Avg Precision: 0.486204
Avg Recall: 1.000000
d_prime: 1.834054
train_loss: 0.064399
valid_loss: 1.343234
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0004933726569920254
Epoch-5 lr: 0.0004933726569920254
epoch 5 training time: 15.276
---------------
2023-09-24 14:56:00.370779
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01088	Per Sample Data Time 0.00523	Per Sample DNN Time 0.00564	Train Loss 0.0544	
start validation
acc: 0.732394
AUC: 0.902325
Avg Precision: 0.476898
Avg Recall: 1.000000
d_prime: 1.831281
train_loss: 0.071028
valid_loss: 1.340993
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0004933726569920254
Epoch-6 lr: 0.0004933726569920254
epoch 6 training time: 15.394
---------------
2023-09-24 14:56:15.764671
current #epochs=7, #steps=234
start validation
acc: 0.704225
AUC: 0.901804
Avg Precision: 0.500024
Avg Recall: 1.000000
d_prime: 1.827021
train_loss: 0.074640
valid_loss: 1.338956
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00037994506719486997
Epoch-7 lr: 0.00037994506719486997
epoch 7 training time: 15.719
---------------
2023-09-24 14:56:31.483549
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00687	Per Sample Data Time 0.00125	Per Sample DNN Time 0.00562	Train Loss 0.0641	
start validation
acc: 0.746479
AUC: 0.903357
Avg Precision: 0.494897
Avg Recall: 1.000000
d_prime: 1.839779
train_loss: 0.065083
valid_loss: 1.349077
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00029259475984306035
Epoch-8 lr: 0.00029259475984306035
epoch 8 training time: 18.675
---------------
2023-09-24 14:56:50.158867
current #epochs=9, #steps=312
start validation
acc: 0.727700
AUC: 0.901293
Avg Precision: 0.486254
Avg Recall: 1.000000
d_prime: 1.822857
train_loss: 0.075163
valid_loss: 1.350822
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00022532650343295228
Epoch-9 lr: 0.00022532650343295228
epoch 9 training time: 16.634
---------------
2023-09-24 14:57:06.792330
current #epochs=10, #steps=351
start validation
acc: 0.718310
AUC: 0.904649
Avg Precision: 0.493580
Avg Recall: 1.000000
d_prime: 1.850508
train_loss: 0.071969
valid_loss: 1.349179
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00017352338495929645
Epoch-10 lr: 0.00017352338495929645
epoch 10 training time: 17.476
---------------
2023-09-24 14:57:24.268462
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00854	Per Sample Data Time 0.00283	Per Sample DNN Time 0.00572	Train Loss 0.0853	
start validation
acc: 0.746479
AUC: 0.905933
Avg Precision: 0.501791
Avg Recall: 1.000000
d_prime: 1.861276
train_loss: 0.076145
valid_loss: 1.343571
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00013362993109548594
Epoch-11 lr: 0.00013362993109548594
epoch 11 training time: 17.621
---------------
2023-09-24 14:57:41.889468
current #epochs=12, #steps=429
start validation
acc: 0.755869
AUC: 0.905454
Avg Precision: 0.502799
Avg Recall: 1.000000
d_prime: 1.857248
train_loss: 0.060504
valid_loss: 1.341470
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.000102908080595437
Epoch-12 lr: 0.000102908080595437
epoch 12 training time: 17.685
---------------
2023-09-24 14:57:59.574222
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00665	Per Sample Data Time 0.00106	Per Sample DNN Time 0.00559	Train Loss 0.0638	
start validation
acc: 0.737089
AUC: 0.905505
Avg Precision: 0.500703
Avg Recall: 1.000000
d_prime: 1.857671
train_loss: 0.068347
valid_loss: 1.342174
validation finished
normal learning rate scheduler step
Epoch-13 lr: 7.924925924170213e-05
Epoch-13 lr: 7.924925924170213e-05
epoch 13 training time: 17.458
---------------
2023-09-24 14:58:17.032194
current #epochs=14, #steps=507
start validation
acc: 0.751174
AUC: 0.903639
Avg Precision: 0.502060
Avg Recall: 1.000000
d_prime: 1.842109
train_loss: 0.057634
valid_loss: 1.343114
validation finished
normal learning rate scheduler step
Epoch-14 lr: 6.10296592261676e-05
Epoch-14 lr: 6.10296592261676e-05
epoch 14 training time: 15.533
---------------
2023-09-24 14:58:32.565374
current #epochs=15, #steps=546
start validation
acc: 0.741784
AUC: 0.903828
Avg Precision: 0.503675
Avg Recall: 1.000000
d_prime: 1.843678
train_loss: 0.058560
valid_loss: 1.343005
validation finished
normal learning rate scheduler step
Epoch-15 lr: 4.6998790157803696e-05
Epoch-15 lr: 4.6998790157803696e-05
epoch 15 training time: 21.661
---------------
2023-09-24 14:58:54.226676
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00773	Per Sample Data Time 0.00207	Per Sample DNN Time 0.00566	Train Loss 0.0603	
start validation
acc: 0.755869
AUC: 0.904801
Avg Precision: 0.504672
Avg Recall: 1.000000
d_prime: 1.851773
train_loss: 0.060684
valid_loss: 1.342753
validation finished
normal learning rate scheduler step
Epoch-16 lr: 3.6193652468407764e-05
Epoch-16 lr: 3.6193652468407764e-05
epoch 16 training time: 15.211
---------------
2023-09-24 14:59:09.437277
current #epochs=17, #steps=624
start validation
acc: 0.741784
AUC: 0.905070
Avg Precision: 0.494617
Avg Recall: 1.000000
d_prime: 1.854028
train_loss: 0.048974
valid_loss: 1.343575
validation finished
normal learning rate scheduler step
Epoch-17 lr: 2.7872642563893102e-05
Epoch-17 lr: 2.7872642563893102e-05
epoch 17 training time: 15.201
---------------
2023-09-24 14:59:24.637995
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00644	Per Sample Data Time 0.00093	Per Sample DNN Time 0.00550	Train Loss 0.0583	
start validation
acc: 0.755869
AUC: 0.905490
Avg Precision: 0.495019
Avg Recall: 1.000000
d_prime: 1.857545
train_loss: 0.057439
valid_loss: 1.343564
validation finished
normal learning rate scheduler step
Epoch-18 lr: 2.146465334419238e-05
Epoch-18 lr: 2.146465334419238e-05
epoch 18 training time: 15.021
---------------
2023-09-24 14:59:39.658584
current #epochs=19, #steps=702
start validation
acc: 0.751174
AUC: 0.905949
Avg Precision: 0.494789
Avg Recall: 1.000000
d_prime: 1.861405
train_loss: 0.066113
valid_loss: 1.343803
validation finished
normal learning rate scheduler step
Epoch-19 lr: 1.6529876639080917e-05
Epoch-19 lr: 1.6529876639080917e-05
epoch 19 training time: 15.410
---------------
2023-09-24 14:59:55.068618
current #epochs=20, #steps=741
start validation
acc: 0.741784
AUC: 0.905822
Avg Precision: 0.494551
Avg Recall: 1.000000
d_prime: 1.860339
train_loss: 0.069809
valid_loss: 1.344053
validation finished
normal learning rate scheduler step
Epoch-20 lr: 1.272961726060961e-05
Epoch-20 lr: 1.272961726060961e-05
epoch 20 training time: 15.277
---------------
2023-09-24 15:00:10.345415
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00557	Train Loss 0.0580	
start validation
acc: 0.741784
AUC: 0.905688
Avg Precision: 0.494810
Avg Recall: 1.000000
d_prime: 1.859215
train_loss: 0.060332
valid_loss: 1.344385
validation finished
normal learning rate scheduler step
Epoch-21 lr: 9.803046879279063e-06
Epoch-21 lr: 9.803046879279063e-06
epoch 21 training time: 15.085
---------------
2023-09-24 15:00:25.430397
current #epochs=22, #steps=819
start validation
acc: 0.741784
AUC: 0.905723
Avg Precision: 0.494408
Avg Recall: 1.000000
d_prime: 1.859506
train_loss: 0.054224
valid_loss: 1.344477
validation finished
normal learning rate scheduler step
Epoch-22 lr: 7.549302241373191e-06
Epoch-22 lr: 7.549302241373191e-06
epoch 22 training time: 15.017
---------------
2023-09-24 15:00:40.447791
current #epochs=23, #steps=858
start validation
acc: 0.741784
AUC: 0.905371
Avg Precision: 0.494268
Avg Recall: 1.000000
d_prime: 1.856544
train_loss: 0.063971
valid_loss: 1.344286
validation finished
normal learning rate scheduler step
Epoch-23 lr: 5.813699050248099e-06
Epoch-23 lr: 5.813699050248099e-06
epoch 23 training time: 15.757
---------------
2023-09-24 15:00:56.205008
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01420	Per Sample Data Time 0.00743	Per Sample DNN Time 0.00676	Train Loss 0.0598	
start validation
acc: 0.741784
AUC: 0.905480
Avg Precision: 0.494408
Avg Recall: 1.000000
d_prime: 1.857467
train_loss: 0.047035
valid_loss: 1.344072
validation finished
normal learning rate scheduler step
Epoch-24 lr: 4.477115310289619e-06
Epoch-24 lr: 4.477115310289619e-06
epoch 24 training time: 15.112
---------------
2023-09-24 15:01:11.317336
current #epochs=25, #steps=936
start validation
acc: 0.741784
AUC: 0.905707
Avg Precision: 0.494551
Avg Recall: 1.000000
d_prime: 1.859370
train_loss: 0.057564
valid_loss: 1.343935
validation finished
normal learning rate scheduler step
Epoch-25 lr: 3.4478154662605577e-06
Epoch-25 lr: 3.4478154662605577e-06
epoch 25 training time: 16.163
---------------
2023-09-24 15:01:27.480814
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00681	Per Sample Data Time 0.00131	Per Sample DNN Time 0.00549	Train Loss 0.0644	
start validation
acc: 0.741784
AUC: 0.905787
Avg Precision: 0.495099
Avg Recall: 1.000000
d_prime: 1.860046
train_loss: 0.068989
valid_loss: 1.343876
validation finished
normal learning rate scheduler step
Epoch-26 lr: 2.655154193162053e-06
Epoch-26 lr: 2.655154193162053e-06
epoch 26 training time: 15.149
---------------
2023-09-24 15:01:42.629789
current #epochs=27, #steps=1014
start validation
acc: 0.741784
AUC: 0.905678
Avg Precision: 0.494698
Avg Recall: 1.000000
d_prime: 1.859128
train_loss: 0.064205
valid_loss: 1.343873
validation finished
normal learning rate scheduler step
Epoch-27 lr: 2.0447277003232928e-06
Epoch-27 lr: 2.0447277003232928e-06
epoch 27 training time: 15.565
---------------
2023-09-24 15:01:58.194127
current #epochs=28, #steps=1053
start validation
acc: 0.741784
AUC: 0.905720
Avg Precision: 0.494698
Avg Recall: 1.000000
d_prime: 1.859480
train_loss: 0.067628
valid_loss: 1.343942
validation finished
normal learning rate scheduler step
Epoch-28 lr: 1.5746397626309933e-06
Epoch-28 lr: 1.5746397626309933e-06
epoch 28 training time: 15.210
---------------
2023-09-24 15:02:13.404151
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00940	Per Sample Data Time 0.00368	Per Sample DNN Time 0.00573	Train Loss 0.0693	
start validation
acc: 0.741784
AUC: 0.905735
Avg Precision: 0.494698
Avg Recall: 1.000000
d_prime: 1.859606
train_loss: 0.058577
valid_loss: 1.343964
validation finished
normal learning rate scheduler step
Epoch-29 lr: 1.212626200381869e-06
Epoch-29 lr: 1.212626200381869e-06
epoch 29 training time: 15.223
---------------
2023-09-24 15:02:28.627459
current #epochs=30, #steps=1131
start validation
acc: 0.741784
AUC: 0.905720
Avg Precision: 0.494698
Avg Recall: 1.000000
d_prime: 1.859480
train_loss: 0.072748
valid_loss: 1.343956
validation finished
normal learning rate scheduler step
Epoch-30 lr: 9.338404483039602e-07
Epoch-30 lr: 9.338404483039602e-07
epoch 30 training time: 15.007
---------------
2023-09-24 15:02:43.634691
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00669	Per Sample Data Time 0.00109	Per Sample DNN Time 0.00560	Train Loss 0.0832	
start validation
acc: 0.741784
AUC: 0.905705
Avg Precision: 0.494698
Avg Recall: 1.000000
d_prime: 1.859355
train_loss: 0.081425
valid_loss: 1.343962
validation finished
normal learning rate scheduler step
Epoch-31 lr: 7.191482277175944e-07
Epoch-31 lr: 7.191482277175944e-07
epoch 31 training time: 15.150
---------------
2023-09-24 15:02:58.784704
current #epochs=32, #steps=1209
start validation
acc: 0.741784
AUC: 0.905684
Avg Precision: 0.494306
Avg Recall: 1.000000
d_prime: 1.859175
train_loss: 0.078967
valid_loss: 1.343997
validation finished
normal learning rate scheduler step
Epoch-32 lr: 5.538142777694498e-07
Epoch-32 lr: 5.538142777694498e-07
epoch 32 training time: 15.021
---------------
2023-09-24 15:03:13.805890
current #epochs=33, #steps=1248
start validation
acc: 0.741784
AUC: 0.905662
Avg Precision: 0.494306
Avg Recall: 1.000000
d_prime: 1.858995
train_loss: 0.073925
valid_loss: 1.343994
validation finished
normal learning rate scheduler step
Epoch-33 lr: 4.264910103925623e-07
Epoch-33 lr: 4.264910103925623e-07
epoch 33 training time: 15.001
---------------
2023-09-24 15:03:28.806474
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00799	Per Sample Data Time 0.00232	Per Sample DNN Time 0.00567	Train Loss 0.0496	
start validation
acc: 0.741784
AUC: 0.905662
Avg Precision: 0.494306
Avg Recall: 1.000000
d_prime: 1.858995
train_loss: 0.050723
valid_loss: 1.343997
validation finished
normal learning rate scheduler step
Epoch-34 lr: 3.2843967598356236e-07
Epoch-34 lr: 3.2843967598356236e-07
epoch 34 training time: 15.047
---------------
2023-09-24 15:03:43.853344
current #epochs=35, #steps=1326
start validation
acc: 0.741784
AUC: 0.905684
Avg Precision: 0.494306
Avg Recall: 1.000000
d_prime: 1.859175
train_loss: 0.051513
valid_loss: 1.343994
validation finished
normal learning rate scheduler step
Epoch-35 lr: 2.5293058501021255e-07
Epoch-35 lr: 2.5293058501021255e-07
epoch 35 training time: 15.137
---------------
2023-09-24 15:03:58.990995
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00649	Per Sample Data Time 0.00099	Per Sample DNN Time 0.00551	Train Loss 0.0646	
start validation
acc: 0.741784
AUC: 0.905705
Avg Precision: 0.494698
Avg Recall: 1.000000
d_prime: 1.859355
train_loss: 0.065923
valid_loss: 1.343977
validation finished
normal learning rate scheduler step
Epoch-36 lr: 1.94781220149572e-07
Epoch-36 lr: 1.94781220149572e-07
epoch 36 training time: 15.139
---------------
2023-09-24 15:04:14.129984
current #epochs=37, #steps=1404
start validation
acc: 0.741784
AUC: 0.905720
Avg Precision: 0.494698
Avg Recall: 1.000000
d_prime: 1.859480
train_loss: 0.077196
valid_loss: 1.343970
validation finished
normal learning rate scheduler step
Epoch-37 lr: 1.500005375839547e-07
Epoch-37 lr: 1.500005375839547e-07
epoch 37 training time: 15.757
---------------
2023-09-24 15:04:29.887281
current #epochs=38, #steps=1443
start validation
acc: 0.741784
AUC: 0.905720
Avg Precision: 0.494698
Avg Recall: 1.000000
d_prime: 1.859480
train_loss: 0.055263
valid_loss: 1.343975
validation finished
normal learning rate scheduler step
Epoch-38 lr: 1.1551504430559366e-07
Epoch-38 lr: 1.1551504430559366e-07
epoch 38 training time: 15.088
---------------
2023-09-24 15:04:44.975190
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00738	Per Sample Data Time 0.00184	Per Sample DNN Time 0.00554	Train Loss 0.0613	
start validation
acc: 0.741784
AUC: 0.905741
Avg Precision: 0.494698
Avg Recall: 1.000000
d_prime: 1.859653
train_loss: 0.060681
valid_loss: 1.343978
validation finished
normal learning rate scheduler step
Epoch-39 lr: 8.895785092406644e-08
Epoch-39 lr: 8.895785092406644e-08
epoch 39 training time: 15.113
---------------
2023-09-24 15:05:00.087754
current #epochs=40, #steps=1521
start validation
acc: 0.741784
AUC: 0.905755
Avg Precision: 0.494698
Avg Recall: 1.000000
d_prime: 1.859779
train_loss: 0.061693
valid_loss: 1.343979
validation finished
normal learning rate scheduler step
Epoch-40 lr: 6.85062217531888e-08
Epoch-40 lr: 6.85062217531888e-08
epoch 40 training time: 15.160
---------------
2023-09-24 15:05:15.248046
current #epochs=41, #steps=1560
start validation
[I 2023-09-24 15:05:30,557] Trial 36 finished with value: 0.49469757490671046 and parameters: {'warmup': 'True', 'num_epochs': 41, 'batch_size': 37, 'lr-adaptschedule': 'True', 'lr': 0.0004933726569920254, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7700975354234338}. Best is trial 36 with value: 0.49469757490671046.
acc: 0.741784
AUC: 0.905755
Avg Precision: 0.494698
Avg Recall: 1.000000
d_prime: 1.859779
train_loss: 0.070804
valid_loss: 1.343977
validation finished
normal learning rate scheduler step
Epoch-41 lr: 5.275647253330193e-08
Epoch-41 lr: 5.275647253330193e-08
epoch 41 training time: 15.301
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67ec171c0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.753 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 15:05:30.591242
current #epochs=1, #steps=0
start validation
acc: 0.699531
AUC: 0.899503
Avg Precision: 0.495607
Avg Recall: 1.000000
d_prime: 1.808388
train_loss: 0.074422
valid_loss: 1.342437
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0004721735431161643
Epoch-1 lr: 0.0004721735431161643
epoch 1 training time: 17.495
---------------
2023-09-24 15:05:48.086296
current #epochs=2, #steps=39
start validation
acc: 0.732394
AUC: 0.897789
Avg Precision: 0.480666
Avg Recall: 1.000000
d_prime: 1.794714
train_loss: 0.067430
valid_loss: 1.354603
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0004721735431161643
Epoch-2 lr: 0.0004721735431161643
epoch 2 training time: 17.610
---------------
2023-09-24 15:06:05.696196
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00561	Train Loss 0.0742	
start validation
acc: 0.737089
AUC: 0.904690
Avg Precision: 0.481941
Avg Recall: 1.000000
d_prime: 1.850847
train_loss: 0.079225
valid_loss: 1.346051
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0004721735431161643
Epoch-3 lr: 0.0004721735431161643
epoch 3 training time: 17.639
---------------
2023-09-24 15:06:23.335145
current #epochs=4, #steps=117
start validation
acc: 0.732394
AUC: 0.910895
Avg Precision: 0.475222
Avg Recall: 1.000000
d_prime: 1.903934
train_loss: 0.063468
valid_loss: 1.333436
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0004721735431161643
Epoch-4 lr: 0.0004721735431161643
epoch 4 training time: 15.165
---------------
2023-09-24 15:06:38.500237
current #epochs=5, #steps=156
start validation
acc: 0.727700
AUC: 0.905569
Avg Precision: 0.457855
Avg Recall: 1.000000
d_prime: 1.858209
train_loss: 0.084434
valid_loss: 1.336572
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0004721735431161643
Epoch-5 lr: 0.0004721735431161643
epoch 5 training time: 15.083
---------------
2023-09-24 15:06:53.583511
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01108	Per Sample Data Time 0.00523	Per Sample DNN Time 0.00585	Train Loss 0.0403	
start validation
acc: 0.727700
AUC: 0.901483
Avg Precision: 0.472296
Avg Recall: 1.000000
d_prime: 1.824401
train_loss: 0.073003
valid_loss: 1.333865
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0003556347752543791
Epoch-6 lr: 0.0003556347752543791
epoch 6 training time: 15.146
---------------
2023-09-24 15:07:08.729808
current #epochs=7, #steps=234
start validation
acc: 0.713615
AUC: 0.894009
Avg Precision: 0.457328
Avg Recall: 1.000000
d_prime: 1.765129
train_loss: 0.070033
valid_loss: 1.345676
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0002678593394613748
Epoch-7 lr: 0.0002678593394613748
epoch 7 training time: 15.224
---------------
2023-09-24 15:07:23.953624
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00679	Per Sample Data Time 0.00121	Per Sample DNN Time 0.00559	Train Loss 0.0736	
start validation
acc: 0.713615
AUC: 0.894028
Avg Precision: 0.466312
Avg Recall: 1.000000
d_prime: 1.765273
train_loss: 0.072439
valid_loss: 1.348244
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0002017480593267729
Epoch-8 lr: 0.0002017480593267729
epoch 8 training time: 15.082
---------------
2023-09-24 15:07:39.035530
current #epochs=9, #steps=312
start validation
acc: 0.718310
AUC: 0.898830
Avg Precision: 0.473928
Avg Recall: 1.000000
d_prime: 1.802999
train_loss: 0.052205
valid_loss: 1.340766
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00015195393046203015
Epoch-9 lr: 0.00015195393046203015
epoch 9 training time: 15.084
---------------
2023-09-24 15:07:54.119077
current #epochs=10, #steps=351
start validation
acc: 0.732394
AUC: 0.900152
Avg Precision: 0.464160
Avg Recall: 1.000000
d_prime: 1.813617
train_loss: 0.057581
valid_loss: 1.333477
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00011444966092814032
Epoch-10 lr: 0.00011444966092814032
epoch 10 training time: 15.007
---------------
2023-09-24 15:08:09.126187
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00867	Per Sample Data Time 0.00284	Per Sample DNN Time 0.00584	Train Loss 0.0554	
start validation
acc: 0.741784
AUC: 0.900168
Avg Precision: 0.468636
Avg Recall: 1.000000
d_prime: 1.813744
train_loss: 0.074080
valid_loss: 1.337966
validation finished
normal learning rate scheduler step
Epoch-11 lr: 8.620194849016665e-05
Epoch-11 lr: 8.620194849016665e-05
epoch 11 training time: 17.541
---------------
2023-09-24 15:08:26.667346
current #epochs=12, #steps=429
start validation
acc: 0.727700
AUC: 0.899648
Avg Precision: 0.471765
Avg Recall: 1.000000
d_prime: 1.809557
train_loss: 0.087459
valid_loss: 1.336309
validation finished
normal learning rate scheduler step
Epoch-12 lr: 6.492615061714265e-05
Epoch-12 lr: 6.492615061714265e-05
epoch 12 training time: 15.134
---------------
2023-09-24 15:08:41.801348
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00665	Per Sample Data Time 0.00104	Per Sample DNN Time 0.00561	Train Loss 0.0604	
start validation
acc: 0.727700
AUC: 0.901307
Avg Precision: 0.479881
Avg Recall: 1.000000
d_prime: 1.822971
train_loss: 0.060628
valid_loss: 1.334572
validation finished
normal learning rate scheduler step
Epoch-13 lr: 4.8901505218768444e-05
Epoch-13 lr: 4.8901505218768444e-05
epoch 13 training time: 15.128
---------------
2023-09-24 15:08:56.929582
current #epochs=14, #steps=507
start validation
acc: 0.732394
AUC: 0.901377
Avg Precision: 0.480038
Avg Recall: 1.000000
d_prime: 1.823541
train_loss: 0.053199
valid_loss: 1.334252
validation finished
normal learning rate scheduler step
Epoch-14 lr: 3.683195738436155e-05
Epoch-14 lr: 3.683195738436155e-05
epoch 14 training time: 15.982
---------------
2023-09-24 15:09:12.911800
current #epochs=15, #steps=546
start validation
acc: 0.732394
AUC: 0.900862
Avg Precision: 0.479464
Avg Recall: 1.000000
d_prime: 1.819356
train_loss: 0.055821
valid_loss: 1.334602
validation finished
normal learning rate scheduler step
Epoch-15 lr: 2.774133595059081e-05
Epoch-15 lr: 2.774133595059081e-05
epoch 15 training time: 15.153
---------------
2023-09-24 15:09:28.064589
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00786	Per Sample Data Time 0.00212	Per Sample DNN Time 0.00574	Train Loss 0.0738	
start validation
acc: 0.732394
AUC: 0.901111
Avg Precision: 0.480771
Avg Recall: 1.000000
d_prime: 1.821379
train_loss: 0.063588
valid_loss: 1.336759
validation finished
normal learning rate scheduler step
Epoch-16 lr: 2.089440189921316e-05
Epoch-16 lr: 2.089440189921316e-05
epoch 16 training time: 15.225
---------------
2023-09-24 15:09:43.290244
current #epochs=17, #steps=624
start validation
acc: 0.732394
AUC: 0.901143
Avg Precision: 0.480064
Avg Recall: 1.000000
d_prime: 1.821640
train_loss: 0.077714
valid_loss: 1.337188
validation finished
normal learning rate scheduler step
Epoch-17 lr: 1.573738306992186e-05
Epoch-17 lr: 1.573738306992186e-05
epoch 17 training time: 15.235
---------------
2023-09-24 15:09:58.524921
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00640	Per Sample Data Time 0.00091	Per Sample DNN Time 0.00549	Train Loss 0.0645	
start validation
acc: 0.732394
AUC: 0.900388
Avg Precision: 0.479360
Avg Recall: 1.000000
d_prime: 1.815519
train_loss: 0.063631
valid_loss: 1.337321
validation finished
normal learning rate scheduler step
Epoch-18 lr: 1.1853185704195238e-05
Epoch-18 lr: 1.1853185704195238e-05
epoch 18 training time: 15.087
---------------
2023-09-24 15:10:13.611510
current #epochs=19, #steps=702
start validation
acc: 0.732394
AUC: 0.900508
Avg Precision: 0.480029
Avg Recall: 1.000000
d_prime: 1.816492
train_loss: 0.055472
valid_loss: 1.337386
validation finished
normal learning rate scheduler step
Epoch-19 lr: 8.927660381265406e-06
Epoch-19 lr: 8.927660381265406e-06
epoch 19 training time: 15.107
---------------
2023-09-24 15:10:28.718452
current #epochs=20, #steps=741
start validation
acc: 0.732394
AUC: 0.900549
Avg Precision: 0.479465
Avg Recall: 1.000000
d_prime: 1.816820
train_loss: 0.074813
valid_loss: 1.337357
validation finished
normal learning rate scheduler step
Epoch-20 lr: 6.724193973861928e-06
Epoch-20 lr: 6.724193973861928e-06
epoch 20 training time: 15.839
---------------
2023-09-24 15:10:44.557524
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00558	Train Loss 0.0629	
start validation
acc: 0.732394
AUC: 0.900573
Avg Precision: 0.479873
Avg Recall: 1.000000
d_prime: 1.817016
train_loss: 0.063885
valid_loss: 1.336967
validation finished
normal learning rate scheduler step
Epoch-21 lr: 5.064572650299711e-06
Epoch-21 lr: 5.064572650299711e-06
epoch 21 training time: 15.016
---------------
2023-09-24 15:10:59.573269
current #epochs=22, #steps=819
start validation
acc: 0.732394
AUC: 0.900784
Avg Precision: 0.480136
Avg Recall: 1.000000
d_prime: 1.818721
train_loss: 0.071572
valid_loss: 1.336721
validation finished
normal learning rate scheduler step
Epoch-22 lr: 3.8145681445046495e-06
Epoch-22 lr: 3.8145681445046495e-06
epoch 22 training time: 15.051
---------------
2023-09-24 15:11:14.624455
current #epochs=23, #steps=858
start validation
acc: 0.732394
AUC: 0.900779
Avg Precision: 0.479862
Avg Recall: 1.000000
d_prime: 1.818682
train_loss: 0.060223
valid_loss: 1.336806
validation finished
normal learning rate scheduler step
Epoch-23 lr: 2.873081528055195e-06
Epoch-23 lr: 2.873081528055195e-06
epoch 23 training time: 15.111
---------------
2023-09-24 15:11:29.735015
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01401	Per Sample Data Time 0.00802	Per Sample DNN Time 0.00599	Train Loss 0.0658	
start validation
acc: 0.732394
AUC: 0.900948
Avg Precision: 0.479862
Avg Recall: 1.000000
d_prime: 1.820053
train_loss: 0.057891
valid_loss: 1.336872
validation finished
normal learning rate scheduler step
Epoch-24 lr: 2.1639664449942335e-06
Epoch-24 lr: 2.1639664449942335e-06
epoch 24 training time: 15.220
---------------
2023-09-24 15:11:44.955100
current #epochs=25, #steps=936
start validation
acc: 0.732394
AUC: 0.901093
Avg Precision: 0.479971
Avg Recall: 1.000000
d_prime: 1.821228
train_loss: 0.053208
valid_loss: 1.336856
validation finished
normal learning rate scheduler step
Epoch-25 lr: 1.6298704820363245e-06
Epoch-25 lr: 1.6298704820363245e-06
epoch 25 training time: 16.258
---------------
2023-09-24 15:12:01.213185
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00694	Per Sample Data Time 0.00137	Per Sample DNN Time 0.00557	Train Loss 0.0767	
start validation
acc: 0.732394
AUC: 0.900970
Avg Precision: 0.479971
Avg Recall: 1.000000
d_prime: 1.820230
train_loss: 0.073044
valid_loss: 1.336918
validation finished
normal learning rate scheduler step
Epoch-26 lr: 1.2275965712677211e-06
Epoch-26 lr: 1.2275965712677211e-06
epoch 26 training time: 15.248
---------------
2023-09-24 15:12:16.461329
current #epochs=27, #steps=1014
start validation
acc: 0.732394
AUC: 0.900954
Avg Precision: 0.479971
Avg Recall: 1.000000
d_prime: 1.820099
train_loss: 0.069262
valid_loss: 1.336932
validation finished
normal learning rate scheduler step
Epoch-27 lr: 9.246092609183649e-07
Epoch-27 lr: 9.246092609183649e-07
epoch 27 training time: 14.940
---------------
2023-09-24 15:12:31.400862
current #epochs=28, #steps=1053
start validation
acc: 0.732394
AUC: 0.900892
Avg Precision: 0.479971
Avg Recall: 1.000000
d_prime: 1.819597
train_loss: 0.062475
valid_loss: 1.336942
validation finished
normal learning rate scheduler step
Epoch-28 lr: 6.964032853995021e-07
Epoch-28 lr: 6.964032853995021e-07
epoch 28 training time: 15.180
---------------
2023-09-24 15:12:46.580667
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00939	Per Sample Data Time 0.00374	Per Sample DNN Time 0.00565	Train Loss 0.0800	
start validation
acc: 0.732394
AUC: 0.900992
Avg Precision: 0.479971
Avg Recall: 1.000000
d_prime: 1.820412
train_loss: 0.075876
valid_loss: 1.336950
validation finished
normal learning rate scheduler step
Epoch-29 lr: 5.245216075745533e-07
Epoch-29 lr: 5.245216075745533e-07
epoch 29 training time: 15.254
---------------
2023-09-24 15:13:01.834828
current #epochs=30, #steps=1131
start validation
acc: 0.732394
AUC: 0.900976
Avg Precision: 0.479862
Avg Recall: 1.000000
d_prime: 1.820284
train_loss: 0.048083
valid_loss: 1.336983
validation finished
normal learning rate scheduler step
Epoch-30 lr: 3.950626347989805e-07
Epoch-30 lr: 3.950626347989805e-07
epoch 30 training time: 15.151
---------------
2023-09-24 15:13:16.985448
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00666	Per Sample Data Time 0.00114	Per Sample DNN Time 0.00552	Train Loss 0.0686	
start validation
acc: 0.732394
AUC: 0.900954
Avg Precision: 0.479862
Avg Recall: 1.000000
d_prime: 1.820100
train_loss: 0.067435
valid_loss: 1.336996
validation finished
normal learning rate scheduler step
Epoch-31 lr: 2.9755587407736845e-07
Epoch-31 lr: 2.9755587407736845e-07
epoch 31 training time: 15.057
---------------
2023-09-24 15:13:32.042418
current #epochs=32, #steps=1209
start validation
acc: 0.732394
AUC: 0.901070
Avg Precision: 0.479971
Avg Recall: 1.000000
d_prime: 1.821046
train_loss: 0.061069
valid_loss: 1.337000
validation finished
normal learning rate scheduler step
Epoch-32 lr: 2.2411509061847434e-07
Epoch-32 lr: 2.2411509061847434e-07
epoch 32 training time: 15.140
---------------
2023-09-24 15:13:47.182440
current #epochs=33, #steps=1248
start validation
acc: 0.732394
AUC: 0.901078
Avg Precision: 0.479971
Avg Recall: 1.000000
d_prime: 1.821107
train_loss: 0.052423
valid_loss: 1.337008
validation finished
normal learning rate scheduler step
Epoch-33 lr: 1.6880047822503123e-07
Epoch-33 lr: 1.6880047822503123e-07
epoch 33 training time: 15.090
---------------
2023-09-24 15:14:02.272172
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00790	Per Sample Data Time 0.00228	Per Sample DNN Time 0.00562	Train Loss 0.0474	
start validation
acc: 0.732394
AUC: 0.901063
Avg Precision: 0.479971
Avg Recall: 1.000000
d_prime: 1.820986
train_loss: 0.050216
valid_loss: 1.337006
validation finished
normal learning rate scheduler step
Epoch-34 lr: 1.2713825459217178e-07
Epoch-34 lr: 1.2713825459217178e-07
epoch 34 training time: 14.968
---------------
2023-09-24 15:14:17.240018
current #epochs=35, #steps=1326
start validation
acc: 0.732394
AUC: 0.901093
Avg Precision: 0.479971
Avg Recall: 1.000000
d_prime: 1.821228
train_loss: 0.060586
valid_loss: 1.337006
validation finished
normal learning rate scheduler step
Epoch-35 lr: 9.575882693409886e-08
Epoch-35 lr: 9.575882693409886e-08
epoch 35 training time: 15.196
---------------
2023-09-24 15:14:32.436040
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00652	Per Sample Data Time 0.00097	Per Sample DNN Time 0.00555	Train Loss 0.0675	
start validation
acc: 0.732394
AUC: 0.901093
Avg Precision: 0.479971
Avg Recall: 1.000000
d_prime: 1.821228
train_loss: 0.067980
valid_loss: 1.337006
validation finished
normal learning rate scheduler step
Epoch-36 lr: 7.212426319056376e-08
Epoch-36 lr: 7.212426319056376e-08
epoch 36 training time: 15.168
---------------
2023-09-24 15:14:47.604484
current #epochs=37, #steps=1404
start validation
acc: 0.732394
AUC: 0.901093
Avg Precision: 0.479971
Avg Recall: 1.000000
d_prime: 1.821228
train_loss: 0.070785
valid_loss: 1.337007
validation finished
normal learning rate scheduler step
Epoch-37 lr: 5.4323026997413606e-08
Epoch-37 lr: 5.4323026997413606e-08
epoch 37 training time: 15.076
---------------
2023-09-24 15:15:02.679987
current #epochs=38, #steps=1443
start validation
acc: 0.732394
AUC: 0.901093
Avg Precision: 0.479971
Avg Recall: 1.000000
d_prime: 1.821228
train_loss: 0.057201
valid_loss: 1.337009
validation finished
normal learning rate scheduler step
Epoch-38 lr: 4.091537482143478e-08
Epoch-38 lr: 4.091537482143478e-08
epoch 38 training time: 15.322
---------------
2023-09-24 15:15:18.001576
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00758	Per Sample Data Time 0.00180	Per Sample DNN Time 0.00578	Train Loss 0.0709	
start validation
acc: 0.732394
AUC: 0.901093
Avg Precision: 0.479971
Avg Recall: 1.000000
d_prime: 1.821228
train_loss: 0.067999
valid_loss: 1.337011
validation finished
normal learning rate scheduler step
Epoch-39 lr: 3.081691115736617e-08
Epoch-39 lr: 3.081691115736617e-08
epoch 39 training time: 15.147
---------------
2023-09-24 15:15:33.148991
current #epochs=40, #steps=1521
start validation
acc: 0.732394
AUC: 0.901093
Avg Precision: 0.479971
Avg Recall: 1.000000
d_prime: 1.821228
train_loss: 0.051887
valid_loss: 1.337011
validation finished
normal learning rate scheduler step
Epoch-40 lr: 2.3210883865188967e-08
Epoch-40 lr: 2.3210883865188967e-08
epoch 40 training time: 15.270
---------------
2023-09-24 15:15:48.419505
current #epochs=41, #steps=1560
start validation
acc: 0.732394
AUC: 0.901093
Avg Precision: 0.479971
Avg Recall: 1.000000
d_prime: 1.821228
train_loss: 0.067395
valid_loss: 1.337012
validation finished
normal learning rate scheduler step
Epoch-41 lr: 1.748212619532809e-08
Epoch-41 lr: 1.748212619532809e-08
epoch 41 training time: 15.004
---------------
2023-09-24 15:16:03.423438
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02127	Per Sample Data Time 0.01499	Per Sample DNN Time 0.00629	Train Loss 0.1042	
start validation
acc: 0.732394
AUC: 0.901093
Avg Precision: 0.479971
Avg Recall: 1.000000
d_prime: 1.821228
train_loss: 0.066395
valid_loss: 1.337012
validation finished
normal learning rate scheduler step
Epoch-42 lr: 1.3167302808651072e-08
Epoch-42 lr: 1.3167302808651072e-08
epoch 42 training time: 15.122
---------------
2023-09-24 15:16:18.545810
current #epochs=43, #steps=1638
start validation
acc: 0.732394
AUC: 0.901093
Avg Precision: 0.479971
Avg Recall: 1.000000
d_prime: 1.821228
train_loss: 0.076490
valid_loss: 1.337012
validation finished
normal learning rate scheduler step
Epoch-43 lr: 9.917435746519425e-09
Epoch-43 lr: 9.917435746519425e-09
epoch 43 training time: 15.209
---------------
2023-09-24 15:16:33.754485
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00696	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00552	Train Loss 0.0550	
start validation
acc: 0.732394
AUC: 0.901093
Avg Precision: 0.479971
Avg Recall: 1.000000
d_prime: 1.821228
train_loss: 0.052694
valid_loss: 1.337012
validation finished
normal learning rate scheduler step
Epoch-44 lr: 7.46967949440037e-09
Epoch-44 lr: 7.46967949440037e-09
epoch 44 training time: 15.269
---------------
2023-09-24 15:16:49.023711
current #epochs=45, #steps=1716
start validation
acc: 0.732394
AUC: 0.901093
Avg Precision: 0.479971
Avg Recall: 1.000000
d_prime: 1.821228
train_loss: 0.071209
valid_loss: 1.337012
validation finished
normal learning rate scheduler step
Epoch-45 lr: 5.626062338608778e-09
Epoch-45 lr: 5.626062338608778e-09
epoch 45 training time: 15.110
---------------
2023-09-24 15:17:04.133482
current #epochs=46, #steps=1755
start validation
acc: 0.732394
AUC: 0.901093
Avg Precision: 0.479971
Avg Recall: 1.000000
d_prime: 1.821228
train_loss: 0.048372
valid_loss: 1.337012
validation finished
normal learning rate scheduler step
Epoch-46 lr: 4.2374746415345344e-09
Epoch-46 lr: 4.2374746415345344e-09
epoch 46 training time: 15.974
---------------
2023-09-24 15:17:20.107880
current #epochs=47, #steps=1794
Epoch: [47][6/39]	Per Sample Total Time 0.01021	Per Sample Data Time 0.00444	Per Sample DNN Time 0.00577	Train Loss 0.0622	
start validation
acc: 0.732394
AUC: 0.901093
Avg Precision: 0.479971
Avg Recall: 1.000000
d_prime: 1.821228
train_loss: 0.057750
valid_loss: 1.337012
validation finished
normal learning rate scheduler step
Epoch-47 lr: 3.1916090254500214e-09
Epoch-47 lr: 3.1916090254500214e-09
epoch 47 training time: 14.991
---------------
2023-09-24 15:17:35.099295
current #epochs=48, #steps=1833
start validation
acc: 0.732394
AUC: 0.901093
Avg Precision: 0.479971
Avg Recall: 1.000000
d_prime: 1.821228
train_loss: 0.050129
valid_loss: 1.337012
validation finished
normal learning rate scheduler step
Epoch-48 lr: 2.403877080818401e-09
Epoch-48 lr: 2.403877080818401e-09
epoch 48 training time: 15.153
---------------
2023-09-24 15:17:50.252512
current #epochs=49, #steps=1872
Epoch: [49][28/39]	Per Sample Total Time 0.00677	Per Sample Data Time 0.00120	Per Sample DNN Time 0.00557	Train Loss 0.0620	
start validation
acc: 0.732394
AUC: 0.901093
Avg Precision: 0.479971
Avg Recall: 1.000000
d_prime: 1.821228
train_loss: 0.067023
valid_loss: 1.337012
validation finished
normal learning rate scheduler step
Epoch-49 lr: 1.810567952905573e-09
Epoch-49 lr: 1.810567952905573e-09
epoch 49 training time: 15.198
---------------
2023-09-24 15:18:05.450989
current #epochs=50, #steps=1911
start validation
[I 2023-09-24 15:18:20,556] Trial 37 finished with value: 0.4799708834331137 and parameters: {'warmup': 'True', 'num_epochs': 50, 'batch_size': 41, 'lr-adaptschedule': 'True', 'lr': 0.0004721735431161643, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7531865781960717}. Best is trial 36 with value: 0.49469757490671046.
acc: 0.732394
AUC: 0.901093
Avg Precision: 0.479971
Avg Recall: 1.000000
d_prime: 1.821228
train_loss: 0.058975
valid_loss: 1.337012
validation finished
normal learning rate scheduler step
Epoch-50 lr: 1.3636954810404148e-09
Epoch-50 lr: 1.3636954810404148e-09
epoch 50 training time: 15.096
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f4df460>
The learning rate scheduler starts at 7 epoch with decay rate of 0.774 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 15:18:20.590419
current #epochs=1, #steps=0
start validation
acc: 0.737089
AUC: 0.895143
Avg Precision: 0.487154
Avg Recall: 1.000000
d_prime: 1.773926
train_loss: 0.066227
valid_loss: 1.348969
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0007271228197602948
Epoch-1 lr: 0.0007271228197602948
epoch 1 training time: 18.321
---------------
2023-09-24 15:18:38.911222
current #epochs=2, #steps=39
start validation
acc: 0.732394
AUC: 0.899089
Avg Precision: 0.482448
Avg Recall: 1.000000
d_prime: 1.805072
train_loss: 0.085394
valid_loss: 1.338461
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0007271228197602948
Epoch-2 lr: 0.0007271228197602948
epoch 2 training time: 15.157
---------------
2023-09-24 15:18:54.068775
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00567	Train Loss 0.0871	
start validation
acc: 0.732394
AUC: 0.900913
Avg Precision: 0.483033
Avg Recall: 1.000000
d_prime: 1.819770
train_loss: 0.081624
valid_loss: 1.350510
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0007271228197602948
Epoch-3 lr: 0.0007271228197602948
epoch 3 training time: 15.160
---------------
2023-09-24 15:19:09.229008
current #epochs=4, #steps=117
start validation
acc: 0.694836
AUC: 0.896981
Avg Precision: 0.455042
Avg Recall: 1.000000
d_prime: 1.788326
train_loss: 0.072097
valid_loss: 1.342084
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0007271228197602948
Epoch-4 lr: 0.0007271228197602948
epoch 4 training time: 15.006
---------------
2023-09-24 15:19:24.235081
current #epochs=5, #steps=156
start validation
acc: 0.704225
AUC: 0.893017
Avg Precision: 0.450521
Avg Recall: 1.000000
d_prime: 1.757493
train_loss: 0.084660
valid_loss: 1.340760
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0007271228197602948
Epoch-5 lr: 0.0007271228197602948
epoch 5 training time: 14.927
---------------
2023-09-24 15:19:39.162306
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01125	Per Sample Data Time 0.00519	Per Sample DNN Time 0.00606	Train Loss 0.0520	
start validation
acc: 0.694836
AUC: 0.896529
Avg Precision: 0.482767
Avg Recall: 1.000000
d_prime: 1.784763
train_loss: 0.079883
valid_loss: 1.350567
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0007271228197602948
Epoch-6 lr: 0.0007271228197602948
epoch 6 training time: 15.134
---------------
2023-09-24 15:19:54.295872
current #epochs=7, #steps=234
start validation
acc: 0.699531
AUC: 0.899834
Avg Precision: 0.493181
Avg Recall: 1.000000
d_prime: 1.811054
train_loss: 0.072835
valid_loss: 1.347428
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.000562603988710975
Epoch-7 lr: 0.000562603988710975
epoch 7 training time: 15.264
---------------
2023-09-24 15:20:09.560299
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00676	Per Sample Data Time 0.00124	Per Sample DNN Time 0.00553	Train Loss 0.0864	
start validation
acc: 0.737089
AUC: 0.904288
Avg Precision: 0.488871
Avg Recall: 1.000000
d_prime: 1.847496
train_loss: 0.075543
valid_loss: 1.345858
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00043530919331873644
Epoch-8 lr: 0.00043530919331873644
epoch 8 training time: 15.083
---------------
2023-09-24 15:20:24.643379
current #epochs=9, #steps=312
start validation
acc: 0.732394
AUC: 0.908079
Avg Precision: 0.485751
Avg Recall: 1.000000
d_prime: 1.879514
train_loss: 0.061519
valid_loss: 1.332590
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00033681612215720946
Epoch-9 lr: 0.00033681612215720946
epoch 9 training time: 15.761
---------------
2023-09-24 15:20:40.404240
current #epochs=10, #steps=351
start validation
acc: 0.732394
AUC: 0.909376
Avg Precision: 0.483109
Avg Recall: 1.000000
d_prime: 1.890695
train_loss: 0.063742
valid_loss: 1.332682
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.000260608096236449
Epoch-10 lr: 0.000260608096236449
epoch 10 training time: 15.034
---------------
2023-09-24 15:20:55.438449
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00862	Per Sample Data Time 0.00305	Per Sample DNN Time 0.00557	Train Loss 0.0414	
start validation
acc: 0.746479
AUC: 0.907858
Avg Precision: 0.485367
Avg Recall: 1.000000
d_prime: 1.877624
train_loss: 0.054034
valid_loss: 1.336623
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00020164290055060396
Epoch-11 lr: 0.00020164290055060396
epoch 11 training time: 17.575
---------------
2023-09-24 15:21:13.013195
current #epochs=12, #steps=429
start validation
acc: 0.741784
AUC: 0.907257
Avg Precision: 0.476772
Avg Recall: 1.000000
d_prime: 1.872490
train_loss: 0.051449
valid_loss: 1.339717
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00015601917181256786
Epoch-12 lr: 0.00015601917181256786
epoch 12 training time: 15.346
---------------
2023-09-24 15:21:28.358790
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00660	Per Sample Data Time 0.00106	Per Sample DNN Time 0.00554	Train Loss 0.0595	
start validation
acc: 0.737089
AUC: 0.906347
Avg Precision: 0.480273
Avg Recall: 1.000000
d_prime: 1.864773
train_loss: 0.064283
valid_loss: 1.342323
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00012071826930981262
Epoch-13 lr: 0.00012071826930981262
epoch 13 training time: 15.224
---------------
2023-09-24 15:21:43.582706
current #epochs=14, #steps=507
start validation
acc: 0.746479
AUC: 0.906677
Avg Precision: 0.489895
Avg Recall: 1.000000
d_prime: 1.867562
train_loss: 0.054956
valid_loss: 1.335168
validation finished
normal learning rate scheduler step
Epoch-14 lr: 9.340455006813818e-05
Epoch-14 lr: 9.340455006813818e-05
epoch 14 training time: 15.121
---------------
2023-09-24 15:21:58.703344
current #epochs=15, #steps=546
start validation
acc: 0.741784
AUC: 0.905840
Avg Precision: 0.496281
Avg Recall: 1.000000
d_prime: 1.860490
train_loss: 0.051298
valid_loss: 1.335990
validation finished
normal learning rate scheduler step
Epoch-15 lr: 7.227083376287407e-05
Epoch-15 lr: 7.227083376287407e-05
epoch 15 training time: 15.853
---------------
2023-09-24 15:22:14.556587
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00786	Per Sample Data Time 0.00207	Per Sample DNN Time 0.00579	Train Loss 0.0613	
start validation
acc: 0.732394
AUC: 0.905342
Avg Precision: 0.495685
Avg Recall: 1.000000
d_prime: 1.856302
train_loss: 0.060791
valid_loss: 1.338454
validation finished
normal learning rate scheduler step
Epoch-16 lr: 5.5918832743916354e-05
Epoch-16 lr: 5.5918832743916354e-05
epoch 16 training time: 16.668
---------------
2023-09-24 15:22:31.224482
current #epochs=17, #steps=624
start validation
acc: 0.727700
AUC: 0.905269
Avg Precision: 0.503603
Avg Recall: 1.000000
d_prime: 1.855695
train_loss: 0.076214
valid_loss: 1.340089
validation finished
normal learning rate scheduler step
Epoch-17 lr: 4.326663596689271e-05
Epoch-17 lr: 4.326663596689271e-05
epoch 17 training time: 15.125
---------------
2023-09-24 15:22:46.349472
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00640	Per Sample Data Time 0.00094	Per Sample DNN Time 0.00546	Train Loss 0.0677	
start validation
acc: 0.741784
AUC: 0.904764
Avg Precision: 0.494873
Avg Recall: 1.000000
d_prime: 1.851469
train_loss: 0.066410
valid_loss: 1.340804
validation finished
normal learning rate scheduler step
Epoch-18 lr: 3.3477125612842425e-05
Epoch-18 lr: 3.3477125612842425e-05
epoch 18 training time: 14.972
---------------
2023-09-24 15:23:01.320855
current #epochs=19, #steps=702
start validation
acc: 0.741784
AUC: 0.904671
Avg Precision: 0.496118
Avg Recall: 1.000000
d_prime: 1.850694
train_loss: 0.057059
valid_loss: 1.340912
validation finished
normal learning rate scheduler step
Epoch-19 lr: 2.5902590165678585e-05
Epoch-19 lr: 2.5902590165678585e-05
epoch 19 training time: 15.111
---------------
2023-09-24 15:23:16.432496
current #epochs=20, #steps=741
start validation
acc: 0.751174
AUC: 0.904663
Avg Precision: 0.495319
Avg Recall: 1.000000
d_prime: 1.850626
train_loss: 0.068616
valid_loss: 1.341126
validation finished
normal learning rate scheduler step
Epoch-20 lr: 2.0041869336408104e-05
Epoch-20 lr: 2.0041869336408104e-05
epoch 20 training time: 17.539
---------------
2023-09-24 15:23:33.971156
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00723	Per Sample Data Time 0.00161	Per Sample DNN Time 0.00562	Train Loss 0.0551	
start validation
acc: 0.741784
AUC: 0.904265
Avg Precision: 0.494269
Avg Recall: 1.000000
d_prime: 1.847305
train_loss: 0.049682
valid_loss: 1.341336
validation finished
normal learning rate scheduler step
Epoch-21 lr: 1.550719537808556e-05
Epoch-21 lr: 1.550719537808556e-05
epoch 21 training time: 15.161
---------------
2023-09-24 15:23:49.132471
current #epochs=22, #steps=819
start validation
acc: 0.741784
AUC: 0.904128
Avg Precision: 0.494269
Avg Recall: 1.000000
d_prime: 1.846170
train_loss: 0.042833
valid_loss: 1.341146
validation finished
normal learning rate scheduler step
Epoch-22 lr: 1.1998536885841988e-05
Epoch-22 lr: 1.1998536885841988e-05
epoch 22 training time: 15.207
---------------
2023-09-24 15:24:04.339849
current #epochs=23, #steps=858
start validation
acc: 0.751174
AUC: 0.903629
Avg Precision: 0.494269
Avg Recall: 1.000000
d_prime: 1.842026
train_loss: 0.065571
valid_loss: 1.341568
validation finished
normal learning rate scheduler step
Epoch-23 lr: 9.283747569490153e-06
Epoch-23 lr: 9.283747569490153e-06
epoch 23 training time: 15.122
---------------
2023-09-24 15:24:19.462049
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01423	Per Sample Data Time 0.00749	Per Sample DNN Time 0.00674	Train Loss 0.0687	
start validation
acc: 0.751174
AUC: 0.903813
Avg Precision: 0.494269
Avg Recall: 1.000000
d_prime: 1.843551
train_loss: 0.065643
valid_loss: 1.341841
validation finished
normal learning rate scheduler step
Epoch-24 lr: 7.183206565436679e-06
Epoch-24 lr: 7.183206565436679e-06
epoch 24 training time: 15.181
---------------
2023-09-24 15:24:34.643032
current #epochs=25, #steps=936
start validation
acc: 0.751174
AUC: 0.903978
Avg Precision: 0.494269
Avg Recall: 1.000000
d_prime: 1.844918
train_loss: 0.057587
valid_loss: 1.341820
validation finished
normal learning rate scheduler step
Epoch-25 lr: 5.557934032082509e-06
Epoch-25 lr: 5.557934032082509e-06
epoch 25 training time: 15.833
---------------
2023-09-24 15:24:50.475859
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00676	Per Sample Data Time 0.00128	Per Sample DNN Time 0.00548	Train Loss 0.0710	
start validation
acc: 0.751174
AUC: 0.904144
Avg Precision: 0.494072
Avg Recall: 1.000000
d_prime: 1.846301
train_loss: 0.066439
valid_loss: 1.341717
validation finished
normal learning rate scheduler step
Epoch-26 lr: 4.300395710965197e-06
Epoch-26 lr: 4.300395710965197e-06
epoch 26 training time: 15.036
---------------
2023-09-24 15:25:05.511884
current #epochs=27, #steps=1014
start validation
acc: 0.751174
AUC: 0.904335
Avg Precision: 0.494269
Avg Recall: 1.000000
d_prime: 1.847889
train_loss: 0.072040
valid_loss: 1.341535
validation finished
normal learning rate scheduler step
Epoch-27 lr: 3.327388048173459e-06
Epoch-27 lr: 3.327388048173459e-06
epoch 27 training time: 15.466
---------------
2023-09-24 15:25:20.978429
current #epochs=28, #steps=1053
start validation
acc: 0.751174
AUC: 0.904399
Avg Precision: 0.494269
Avg Recall: 1.000000
d_prime: 1.848422
train_loss: 0.055966
valid_loss: 1.341418
validation finished
normal learning rate scheduler step
Epoch-28 lr: 2.574533128404281e-06
Epoch-28 lr: 2.574533128404281e-06
epoch 28 training time: 15.165
---------------
2023-09-24 15:25:36.143444
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00926	Per Sample Data Time 0.00356	Per Sample DNN Time 0.00571	Train Loss 0.0793	
start validation
acc: 0.751174
AUC: 0.904399
Avg Precision: 0.494072
Avg Recall: 1.000000
d_prime: 1.848418
train_loss: 0.082084
valid_loss: 1.341291
validation finished
normal learning rate scheduler step
Epoch-29 lr: 1.992019185405694e-06
Epoch-29 lr: 1.992019185405694e-06
epoch 29 training time: 15.181
---------------
2023-09-24 15:25:51.324504
current #epochs=30, #steps=1131
start validation
acc: 0.751174
AUC: 0.904373
Avg Precision: 0.494072
Avg Recall: 1.000000
d_prime: 1.848205
train_loss: 0.058186
valid_loss: 1.341240
validation finished
normal learning rate scheduler step
Epoch-30 lr: 1.5413048646547629e-06
Epoch-30 lr: 1.5413048646547629e-06
epoch 30 training time: 15.135
---------------
2023-09-24 15:26:06.459165
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00666	Per Sample Data Time 0.00112	Per Sample DNN Time 0.00555	Train Loss 0.0729	
start validation
acc: 0.751174
AUC: 0.904358
Avg Precision: 0.494072
Avg Recall: 1.000000
d_prime: 1.848081
train_loss: 0.071035
valid_loss: 1.341181
validation finished
normal learning rate scheduler step
Epoch-31 lr: 1.192569179661098e-06
Epoch-31 lr: 1.192569179661098e-06
epoch 31 training time: 15.167
---------------
2023-09-24 15:26:21.626076
current #epochs=32, #steps=1209
start validation
acc: 0.751174
AUC: 0.904248
Avg Precision: 0.494072
Avg Recall: 1.000000
d_prime: 1.847161
train_loss: 0.059696
valid_loss: 1.341177
validation finished
normal learning rate scheduler step
Epoch-32 lr: 9.227384412337579e-07
Epoch-32 lr: 9.227384412337579e-07
epoch 32 training time: 15.056
---------------
2023-09-24 15:26:36.682208
current #epochs=33, #steps=1248
start validation
acc: 0.751174
AUC: 0.904344
Avg Precision: 0.494072
Avg Recall: 1.000000
d_prime: 1.847961
train_loss: 0.076710
valid_loss: 1.341165
validation finished
normal learning rate scheduler step
Epoch-33 lr: 7.139596137915183e-07
Epoch-33 lr: 7.139596137915183e-07
epoch 33 training time: 15.157
---------------
2023-09-24 15:26:51.839053
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00811	Per Sample Data Time 0.00248	Per Sample DNN Time 0.00563	Train Loss 0.0649	
start validation
acc: 0.751174
AUC: 0.904344
Avg Precision: 0.494072
Avg Recall: 1.000000
d_prime: 1.847961
train_loss: 0.068583
valid_loss: 1.341131
validation finished
normal learning rate scheduler step
Epoch-34 lr: 5.524190901202539e-07
Epoch-34 lr: 5.524190901202539e-07
epoch 34 training time: 15.236
---------------
2023-09-24 15:27:07.075005
current #epochs=35, #steps=1326
start validation
acc: 0.751174
AUC: 0.904333
Avg Precision: 0.494072
Avg Recall: 1.000000
d_prime: 1.847873
train_loss: 0.064772
valid_loss: 1.341137
validation finished
normal learning rate scheduler step
Epoch-35 lr: 4.274287301892125e-07
Epoch-35 lr: 4.274287301892125e-07
epoch 35 training time: 15.147
---------------
2023-09-24 15:27:22.222289
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00657	Per Sample Data Time 0.00098	Per Sample DNN Time 0.00559	Train Loss 0.0591	
start validation
acc: 0.751174
AUC: 0.904344
Avg Precision: 0.494072
Avg Recall: 1.000000
d_prime: 1.847961
train_loss: 0.059167
valid_loss: 1.341145
validation finished
normal learning rate scheduler step
Epoch-36 lr: 3.307186928521829e-07
Epoch-36 lr: 3.307186928521829e-07
epoch 36 training time: 15.132
---------------
2023-09-24 15:27:37.354664
current #epochs=37, #steps=1404
start validation
acc: 0.751174
AUC: 0.904333
Avg Precision: 0.494072
Avg Recall: 1.000000
d_prime: 1.847873
train_loss: 0.063455
valid_loss: 1.341143
validation finished
normal learning rate scheduler step
Epoch-37 lr: 2.5589027146920816e-07
Epoch-37 lr: 2.5589027146920816e-07
epoch 37 training time: 15.064
---------------
2023-09-24 15:27:52.418443
current #epochs=38, #steps=1443
start validation
acc: 0.751174
AUC: 0.904333
Avg Precision: 0.494072
Avg Recall: 1.000000
d_prime: 1.847873
train_loss: 0.061129
valid_loss: 1.341145
validation finished
normal learning rate scheduler step
Epoch-38 lr: 1.9799253095697172e-07
Epoch-38 lr: 1.9799253095697172e-07
epoch 38 training time: 14.942
---------------
2023-09-24 15:28:07.360535
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00734	Per Sample Data Time 0.00176	Per Sample DNN Time 0.00558	Train Loss 0.0522	
start validation
acc: 0.751174
AUC: 0.904333
Avg Precision: 0.494072
Avg Recall: 1.000000
d_prime: 1.847873
train_loss: 0.051435
valid_loss: 1.341143
validation finished
normal learning rate scheduler step
Epoch-39 lr: 1.5319473495288605e-07
Epoch-39 lr: 1.5319473495288605e-07
epoch 39 training time: 15.082
---------------
2023-09-24 15:28:22.442905
current #epochs=40, #steps=1521
start validation
acc: 0.751174
AUC: 0.904333
Avg Precision: 0.494072
Avg Recall: 1.000000
d_prime: 1.847873
train_loss: 0.049673
valid_loss: 1.341143
validation finished
normal learning rate scheduler step
Epoch-40 lr: 1.1853288961887797e-07
Epoch-40 lr: 1.1853288961887797e-07
epoch 40 training time: 15.180
---------------
2023-09-24 15:28:37.622737
current #epochs=41, #steps=1560
start validation
acc: 0.751174
AUC: 0.904333
Avg Precision: 0.494072
Avg Recall: 1.000000
d_prime: 1.847873
train_loss: 0.056054
valid_loss: 1.341142
validation finished
normal learning rate scheduler step
Epoch-41 lr: 9.1713634451746e-08
Epoch-41 lr: 9.1713634451746e-08
epoch 41 training time: 15.302
---------------
2023-09-24 15:28:52.924635
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02130	Per Sample Data Time 0.01478	Per Sample DNN Time 0.00652	Train Loss 0.0737	
start validation
acc: 0.751174
AUC: 0.904333
Avg Precision: 0.494072
Avg Recall: 1.000000
d_prime: 1.847873
train_loss: 0.067427
valid_loss: 1.341146
validation finished
normal learning rate scheduler step
Epoch-42 lr: 7.096250476465953e-08
Epoch-42 lr: 7.096250476465953e-08
epoch 42 training time: 16.299
---------------
2023-09-24 15:29:09.224311
current #epochs=43, #steps=1638
start validation
acc: 0.751174
AUC: 0.904333
Avg Precision: 0.494072
Avg Recall: 1.000000
d_prime: 1.847873
train_loss: 0.077013
valid_loss: 1.341148
validation finished
normal learning rate scheduler step
Epoch-43 lr: 5.490652630415369e-08
Epoch-43 lr: 5.490652630415369e-08
epoch 43 training time: 15.201
---------------
2023-09-24 15:29:24.424701
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00686	Per Sample Data Time 0.00136	Per Sample DNN Time 0.00550	Train Loss 0.0597	
start validation
acc: 0.751174
AUC: 0.904333
Avg Precision: 0.494072
Avg Recall: 1.000000
d_prime: 1.847873
train_loss: 0.059064
valid_loss: 1.341151
validation finished
normal learning rate scheduler step
Epoch-44 lr: 4.2483374012610995e-08
Epoch-44 lr: 4.2483374012610995e-08
epoch 44 training time: 15.924
---------------
2023-09-24 15:29:40.348384
current #epochs=45, #steps=1716
start validation
acc: 0.751174
AUC: 0.904333
Avg Precision: 0.494072
Avg Recall: 1.000000
d_prime: 1.847873
train_loss: 0.050739
valid_loss: 1.341152
validation finished
normal learning rate scheduler step
Epoch-45 lr: 3.2871084531873856e-08
Epoch-45 lr: 3.2871084531873856e-08
epoch 45 training time: 15.177
---------------
2023-09-24 15:29:55.525829
current #epochs=46, #steps=1755
start validation
acc: 0.751174
AUC: 0.904333
Avg Precision: 0.494072
Avg Recall: 1.000000
d_prime: 1.847873
train_loss: 0.055074
valid_loss: 1.341152
validation finished
normal learning rate scheduler step
Epoch-46 lr: 2.543367195790176e-08
Epoch-46 lr: 2.543367195790176e-08
epoch 46 training time: 15.321
---------------
2023-09-24 15:30:10.846735
current #epochs=47, #steps=1794
Epoch: [47][6/39]	Per Sample Total Time 0.01020	Per Sample Data Time 0.00459	Per Sample DNN Time 0.00561	Train Loss 0.0550	
start validation
[I 2023-09-24 15:30:26,080] Trial 38 finished with value: 0.4940717799630921 and parameters: {'warmup': 'True', 'num_epochs': 47, 'batch_size': 39, 'lr-adaptschedule': 'True', 'lr': 0.0007271228197602948, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7737399699495672}. Best is trial 36 with value: 0.49469757490671046.
acc: 0.751174
AUC: 0.904333
Avg Precision: 0.494072
Avg Recall: 1.000000
d_prime: 1.847873
train_loss: 0.060121
valid_loss: 1.341152
validation finished
normal learning rate scheduler step
Epoch-47 lr: 1.9679048576414056e-08
Epoch-47 lr: 1.9679048576414056e-08
epoch 47 training time: 15.225
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f492eb0>
The learning rate scheduler starts at 7 epoch with decay rate of 0.771 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 15:30:26.114189
current #epochs=1, #steps=0
start validation
acc: 0.737089
AUC: 0.904644
Avg Precision: 0.480674
Avg Recall: 1.000000
d_prime: 1.850465
train_loss: 0.057697
valid_loss: 1.339665
validation finished
normal learning rate scheduler step
Epoch-1 lr: 4.97224354359529e-05
Epoch-1 lr: 4.97224354359529e-05
epoch 1 training time: 17.671
---------------
2023-09-24 15:30:43.785870
current #epochs=2, #steps=39
start validation
acc: 0.746479
AUC: 0.904078
Avg Precision: 0.482857
Avg Recall: 1.000000
d_prime: 1.845753
train_loss: 0.043705
valid_loss: 1.339440
validation finished
normal learning rate scheduler step
Epoch-2 lr: 4.97224354359529e-05
Epoch-2 lr: 4.97224354359529e-05
epoch 2 training time: 19.218
---------------
2023-09-24 15:31:03.004169
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00559	Train Loss 0.0394	
start validation
acc: 0.737089
AUC: 0.904229
Avg Precision: 0.489402
Avg Recall: 1.000000
d_prime: 1.847010
train_loss: 0.053014
valid_loss: 1.338079
validation finished
normal learning rate scheduler step
Epoch-3 lr: 4.97224354359529e-05
Epoch-3 lr: 4.97224354359529e-05
epoch 3 training time: 15.155
---------------
2023-09-24 15:31:18.158938
current #epochs=4, #steps=117
start validation
acc: 0.737089
AUC: 0.905577
Avg Precision: 0.488390
Avg Recall: 1.000000
d_prime: 1.858274
train_loss: 0.058538
valid_loss: 1.335855
validation finished
normal learning rate scheduler step
Epoch-4 lr: 4.97224354359529e-05
Epoch-4 lr: 4.97224354359529e-05
epoch 4 training time: 15.150
---------------
2023-09-24 15:31:33.309219
current #epochs=5, #steps=156
start validation
acc: 0.737089
AUC: 0.906015
Avg Precision: 0.488020
Avg Recall: 1.000000
d_prime: 1.861966
train_loss: 0.053865
valid_loss: 1.337603
validation finished
normal learning rate scheduler step
Epoch-5 lr: 4.97224354359529e-05
Epoch-5 lr: 4.97224354359529e-05
epoch 5 training time: 15.091
---------------
2023-09-24 15:31:48.400575
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01088	Per Sample Data Time 0.00511	Per Sample DNN Time 0.00577	Train Loss 0.0718	
start validation
acc: 0.741784
AUC: 0.905644
Avg Precision: 0.495211
Avg Recall: 1.000000
d_prime: 1.858843
train_loss: 0.053890
valid_loss: 1.338034
validation finished
normal learning rate scheduler step
Epoch-6 lr: 4.97224354359529e-05
Epoch-6 lr: 4.97224354359529e-05
epoch 6 training time: 15.032
---------------
2023-09-24 15:32:03.432666
current #epochs=7, #steps=234
start validation
acc: 0.732394
AUC: 0.905562
Avg Precision: 0.495395
Avg Recall: 1.000000
d_prime: 1.858154
train_loss: 0.078522
valid_loss: 1.339074
validation finished
normal learning rate scheduler step
Epoch-7 lr: 3.8355130391078334e-05
Epoch-7 lr: 3.8355130391078334e-05
epoch 7 training time: 15.201
---------------
2023-09-24 15:32:18.633169
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00673	Per Sample Data Time 0.00118	Per Sample DNN Time 0.00555	Train Loss 0.0600	
start validation
acc: 0.732394
AUC: 0.906092
Avg Precision: 0.494798
Avg Recall: 1.000000
d_prime: 1.862611
train_loss: 0.057318
valid_loss: 1.339196
validation finished
normal learning rate scheduler step
Epoch-8 lr: 2.9586564182109594e-05
Epoch-8 lr: 2.9586564182109594e-05
epoch 8 training time: 15.033
---------------
2023-09-24 15:32:33.666599
current #epochs=9, #steps=312
start validation
acc: 0.737089
AUC: 0.905756
Avg Precision: 0.493259
Avg Recall: 1.000000
d_prime: 1.859782
train_loss: 0.054561
valid_loss: 1.339954
validation finished
normal learning rate scheduler step
Epoch-9 lr: 2.282262558298345e-05
Epoch-9 lr: 2.282262558298345e-05
epoch 9 training time: 16.020
---------------
2023-09-24 15:32:49.686359
current #epochs=10, #steps=351
start validation
acc: 0.732394
AUC: 0.906106
Avg Precision: 0.493997
Avg Recall: 1.000000
d_prime: 1.862729
train_loss: 0.051522
valid_loss: 1.339825
validation finished
normal learning rate scheduler step
Epoch-10 lr: 1.760502623065681e-05
Epoch-10 lr: 1.760502623065681e-05
epoch 10 training time: 15.129
---------------
2023-09-24 15:33:04.815039
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00860	Per Sample Data Time 0.00286	Per Sample DNN Time 0.00575	Train Loss 0.0373	
start validation
acc: 0.727700
AUC: 0.906203
Avg Precision: 0.494649
Avg Recall: 1.000000
d_prime: 1.863549
train_loss: 0.048667
valid_loss: 1.339723
validation finished
normal learning rate scheduler step
Epoch-11 lr: 1.3580249452683624e-05
Epoch-11 lr: 1.3580249452683624e-05
epoch 11 training time: 15.110
---------------
2023-09-24 15:33:19.924785
current #epochs=12, #steps=429
start validation
acc: 0.723005
AUC: 0.905522
Avg Precision: 0.494581
Avg Recall: 1.000000
d_prime: 1.857816
train_loss: 0.056803
valid_loss: 1.340424
validation finished
normal learning rate scheduler step
Epoch-12 lr: 1.0475597865112264e-05
Epoch-12 lr: 1.0475597865112264e-05
epoch 12 training time: 15.020
---------------
2023-09-24 15:33:34.944844
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00659	Per Sample Data Time 0.00106	Per Sample DNN Time 0.00554	Train Loss 0.0763	
start validation
acc: 0.727700
AUC: 0.905341
Avg Precision: 0.495173
Avg Recall: 1.000000
d_prime: 1.856293
train_loss: 0.069291
valid_loss: 1.340628
validation finished
normal learning rate scheduler step
Epoch-13 lr: 8.080716853832093e-06
Epoch-13 lr: 8.080716853832093e-06
epoch 13 training time: 15.126
---------------
2023-09-24 15:33:50.070538
current #epochs=14, #steps=507
start validation
acc: 0.732394
AUC: 0.905716
Avg Precision: 0.495173
Avg Recall: 1.000000
d_prime: 1.859450
train_loss: 0.049684
valid_loss: 1.340161
validation finished
normal learning rate scheduler step
Epoch-14 lr: 6.233342069121729e-06
Epoch-14 lr: 6.233342069121729e-06
epoch 14 training time: 15.190
---------------
2023-09-24 15:34:05.260760
current #epochs=15, #steps=546
start validation
acc: 0.741784
AUC: 0.905578
Avg Precision: 0.495060
Avg Recall: 1.000000
d_prime: 1.858283
train_loss: 0.085666
valid_loss: 1.340239
validation finished
normal learning rate scheduler step
Epoch-15 lr: 4.8083052597316144e-06
Epoch-15 lr: 4.8083052597316144e-06
epoch 15 training time: 15.190
---------------
2023-09-24 15:34:20.450750
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00768	Per Sample Data Time 0.00205	Per Sample DNN Time 0.00563	Train Loss 0.0541	
start validation
acc: 0.741784
AUC: 0.905463
Avg Precision: 0.495060
Avg Recall: 1.000000
d_prime: 1.857321
train_loss: 0.048650
valid_loss: 1.340193
validation finished
normal learning rate scheduler step
Epoch-16 lr: 3.7090535405223256e-06
Epoch-16 lr: 3.7090535405223256e-06
epoch 16 training time: 15.137
---------------
2023-09-24 15:34:35.587923
current #epochs=17, #steps=624
start validation
acc: 0.732394
AUC: 0.905544
Avg Precision: 0.495440
Avg Recall: 1.000000
d_prime: 1.858002
train_loss: 0.059173
valid_loss: 1.340189
validation finished
normal learning rate scheduler step
Epoch-17 lr: 2.861107484517129e-06
Epoch-17 lr: 2.861107484517129e-06
epoch 17 training time: 15.037
---------------
2023-09-24 15:34:50.624629
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00643	Per Sample Data Time 0.00095	Per Sample DNN Time 0.00548	Train Loss 0.0591	
start validation
acc: 0.746479
AUC: 0.905517
Avg Precision: 0.494843
Avg Recall: 1.000000
d_prime: 1.857776
train_loss: 0.057878
valid_loss: 1.340238
validation finished
normal learning rate scheduler step
Epoch-18 lr: 2.2070147946171604e-06
Epoch-18 lr: 2.2070147946171604e-06
epoch 18 training time: 15.055
---------------
2023-09-24 15:35:05.679370
current #epochs=19, #steps=702
start validation
acc: 0.737089
AUC: 0.905481
Avg Precision: 0.494843
Avg Recall: 1.000000
d_prime: 1.857471
train_loss: 0.061197
valid_loss: 1.340190
validation finished
normal learning rate scheduler step
Epoch-19 lr: 1.7024576427198066e-06
Epoch-19 lr: 1.7024576427198066e-06
epoch 19 training time: 15.197
---------------
2023-09-24 15:35:20.876803
current #epochs=20, #steps=741
start validation
acc: 0.737089
AUC: 0.905466
Avg Precision: 0.494843
Avg Recall: 1.000000
d_prime: 1.857346
train_loss: 0.051143
valid_loss: 1.340101
validation finished
normal learning rate scheduler step
Epoch-20 lr: 1.3132499303240261e-06
Epoch-20 lr: 1.3132499303240261e-06
epoch 20 training time: 16.971
---------------
2023-09-24 15:35:37.847641
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00163	Per Sample DNN Time 0.00554	Train Loss 0.0469	
start validation
acc: 0.737089
AUC: 0.905487
Avg Precision: 0.494843
Avg Recall: 1.000000
d_prime: 1.857525
train_loss: 0.053966
valid_loss: 1.340018
validation finished
normal learning rate scheduler step
Epoch-21 lr: 1.0130210210345312e-06
Epoch-21 lr: 1.0130210210345312e-06
epoch 21 training time: 15.173
---------------
2023-09-24 15:35:53.020579
current #epochs=22, #steps=819
start validation
acc: 0.737089
AUC: 0.905604
Avg Precision: 0.494843
Avg Recall: 1.000000
d_prime: 1.858505
train_loss: 0.074091
valid_loss: 1.340003
validation finished
normal learning rate scheduler step
Epoch-22 lr: 7.814290070471511e-07
Epoch-22 lr: 7.814290070471511e-07
epoch 22 training time: 15.141
---------------
2023-09-24 15:36:08.162082
current #epochs=23, #steps=858
start validation
acc: 0.737089
AUC: 0.905576
Avg Precision: 0.494843
Avg Recall: 1.000000
d_prime: 1.858271
train_loss: 0.057749
valid_loss: 1.339972
validation finished
normal learning rate scheduler step
Epoch-23 lr: 6.02782450092792e-07
Epoch-23 lr: 6.02782450092792e-07
epoch 23 training time: 15.099
---------------
2023-09-24 15:36:23.261475
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01364	Per Sample Data Time 0.00777	Per Sample DNN Time 0.00587	Train Loss 0.0859	
start validation
acc: 0.737089
AUC: 0.905584
Avg Precision: 0.494843
Avg Recall: 1.000000
d_prime: 1.858335
train_loss: 0.060321
valid_loss: 1.339930
validation finished
normal learning rate scheduler step
Epoch-24 lr: 4.6497721336564753e-07
Epoch-24 lr: 4.6497721336564753e-07
epoch 24 training time: 15.137
---------------
2023-09-24 15:36:38.398546
current #epochs=25, #steps=936
start validation
acc: 0.737089
AUC: 0.905584
Avg Precision: 0.494843
Avg Recall: 1.000000
d_prime: 1.858335
train_loss: 0.059170
valid_loss: 1.339937
validation finished
normal learning rate scheduler step
Epoch-25 lr: 3.5867634984396216e-07
Epoch-25 lr: 3.5867634984396216e-07
epoch 25 training time: 15.257
---------------
2023-09-24 15:36:53.655954
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00685	Per Sample Data Time 0.00129	Per Sample DNN Time 0.00556	Train Loss 0.0742	
start validation
acc: 0.737089
AUC: 0.905569
Avg Precision: 0.494843
Avg Recall: 1.000000
d_prime: 1.858210
train_loss: 0.061537
valid_loss: 1.339940
validation finished
normal learning rate scheduler step
Epoch-26 lr: 2.7667748061499497e-07
Epoch-26 lr: 2.7667748061499497e-07
epoch 26 training time: 15.940
---------------
2023-09-24 15:37:09.595319
current #epochs=27, #steps=1014
start validation
acc: 0.737089
AUC: 0.905590
Avg Precision: 0.495223
Avg Recall: 1.000000
d_prime: 1.858389
train_loss: 0.075238
valid_loss: 1.339944
validation finished
normal learning rate scheduler step
Epoch-27 lr: 2.1342480013740315e-07
Epoch-27 lr: 2.1342480013740315e-07
epoch 27 training time: 15.238
---------------
2023-09-24 15:37:24.832867
current #epochs=28, #steps=1053
start validation
acc: 0.737089
AUC: 0.905590
Avg Precision: 0.495223
Avg Recall: 1.000000
d_prime: 1.858389
train_loss: 0.040342
valid_loss: 1.339939
validation finished
normal learning rate scheduler step
Epoch-28 lr: 1.6463264452329923e-07
Epoch-28 lr: 1.6463264452329923e-07
epoch 28 training time: 16.219
---------------
2023-09-24 15:37:41.052287
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00924	Per Sample Data Time 0.00342	Per Sample DNN Time 0.00582	Train Loss 0.0415	
start validation
acc: 0.737089
AUC: 0.905590
Avg Precision: 0.495223
Avg Recall: 1.000000
d_prime: 1.858389
train_loss: 0.066095
valid_loss: 1.339938
validation finished
normal learning rate scheduler step
Epoch-29 lr: 1.2699511783675318e-07
Epoch-29 lr: 1.2699511783675318e-07
epoch 29 training time: 15.325
---------------
2023-09-24 15:37:56.376925
current #epochs=30, #steps=1131
start validation
acc: 0.737089
AUC: 0.905590
Avg Precision: 0.495223
Avg Recall: 1.000000
d_prime: 1.858389
train_loss: 0.057941
valid_loss: 1.339940
validation finished
normal learning rate scheduler step
Epoch-30 lr: 9.79621022371926e-08
Epoch-30 lr: 9.79621022371926e-08
epoch 30 training time: 14.992
---------------
2023-09-24 15:38:11.368442
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00669	Per Sample Data Time 0.00111	Per Sample DNN Time 0.00558	Train Loss 0.0682	
start validation
acc: 0.737089
AUC: 0.905590
Avg Precision: 0.495223
Avg Recall: 1.000000
d_prime: 1.858389
train_loss: 0.065211
valid_loss: 1.339942
validation finished
normal learning rate scheduler step
Epoch-31 lr: 7.556647561102437e-08
Epoch-31 lr: 7.556647561102437e-08
epoch 31 training time: 15.147
---------------
2023-09-24 15:38:26.515443
current #epochs=32, #steps=1209
start validation
acc: 0.737089
AUC: 0.905590
Avg Precision: 0.495223
Avg Recall: 1.000000
d_prime: 1.858389
train_loss: 0.060323
valid_loss: 1.339941
validation finished
normal learning rate scheduler step
Epoch-32 lr: 5.829082988077765e-08
Epoch-32 lr: 5.829082988077765e-08
epoch 32 training time: 15.170
---------------
2023-09-24 15:38:41.685505
current #epochs=33, #steps=1248
start validation
acc: 0.737089
AUC: 0.905590
Avg Precision: 0.495223
Avg Recall: 1.000000
d_prime: 1.858389
train_loss: 0.053672
valid_loss: 1.339938
validation finished
normal learning rate scheduler step
Epoch-33 lr: 4.49646595360609e-08
Epoch-33 lr: 4.49646595360609e-08
epoch 33 training time: 15.139
---------------
2023-09-24 15:38:56.824726
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00798	Per Sample Data Time 0.00229	Per Sample DNN Time 0.00569	Train Loss 0.0698	
start validation
acc: 0.737089
AUC: 0.905633
Avg Precision: 0.495223
Avg Recall: 1.000000
d_prime: 1.858749
train_loss: 0.075644
valid_loss: 1.339938
validation finished
normal learning rate scheduler step
Epoch-34 lr: 3.468505443015833e-08
Epoch-34 lr: 3.468505443015833e-08
epoch 34 training time: 15.120
---------------
2023-09-24 15:39:11.944626
current #epochs=35, #steps=1326
start validation
acc: 0.737089
AUC: 0.905633
Avg Precision: 0.495223
Avg Recall: 1.000000
d_prime: 1.858749
train_loss: 0.053324
valid_loss: 1.339938
validation finished
normal learning rate scheduler step
Epoch-35 lr: 2.6755523409628348e-08
Epoch-35 lr: 2.6755523409628348e-08
epoch 35 training time: 15.250
---------------
2023-09-24 15:39:27.194806
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00644	Per Sample Data Time 0.00096	Per Sample DNN Time 0.00548	Train Loss 0.0557	
start validation
acc: 0.737089
AUC: 0.905590
Avg Precision: 0.495223
Avg Recall: 1.000000
d_prime: 1.858389
train_loss: 0.054905
valid_loss: 1.339938
validation finished
normal learning rate scheduler step
Epoch-36 lr: 2.063880379270037e-08
Epoch-36 lr: 2.063880379270037e-08
epoch 36 training time: 15.004
---------------
2023-09-24 15:39:42.198500
current #epochs=37, #steps=1404
start validation
acc: 0.737089
AUC: 0.905633
Avg Precision: 0.495223
Avg Recall: 1.000000
d_prime: 1.858749
train_loss: 0.053001
valid_loss: 1.339938
validation finished
normal learning rate scheduler step
Epoch-37 lr: 1.5920459318702602e-08
Epoch-37 lr: 1.5920459318702602e-08
epoch 37 training time: 17.633
---------------
2023-09-24 15:39:59.831216
current #epochs=38, #steps=1443
start validation
acc: 0.737089
AUC: 0.905612
Avg Precision: 0.495223
Avg Recall: 1.000000
d_prime: 1.858569
train_loss: 0.065636
valid_loss: 1.339938
validation finished
normal learning rate scheduler step
Epoch-38 lr: 1.2280800159944821e-08
Epoch-38 lr: 1.2280800159944821e-08
epoch 38 training time: 15.108
---------------
2023-09-24 15:40:14.939473
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00734	Per Sample Data Time 0.00177	Per Sample DNN Time 0.00557	Train Loss 0.0663	
start validation
acc: 0.737089
AUC: 0.905633
Avg Precision: 0.495223
Avg Recall: 1.000000
d_prime: 1.858749
train_loss: 0.049710
valid_loss: 1.339938
validation finished
normal learning rate scheduler step
Epoch-39 lr: 9.473222445996067e-09
Epoch-39 lr: 9.473222445996067e-09
epoch 39 training time: 15.179
---------------
2023-09-24 15:40:30.118316
current #epochs=40, #steps=1521
start validation
acc: 0.737089
AUC: 0.905633
Avg Precision: 0.495223
Avg Recall: 1.000000
d_prime: 1.858749
train_loss: 0.060225
valid_loss: 1.339938
validation finished
normal learning rate scheduler step
Epoch-40 lr: 7.30749970217958e-09
Epoch-40 lr: 7.30749970217958e-09
epoch 40 training time: 15.337
---------------
2023-09-24 15:40:45.454772
current #epochs=41, #steps=1560
start validation
[I 2023-09-24 15:41:00,596] Trial 39 finished with value: 0.49522327206019656 and parameters: {'warmup': 'True', 'num_epochs': 41, 'batch_size': 49, 'lr-adaptschedule': 'True', 'lr': 4.97224354359529e-05, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7713847894776452}. Best is trial 39 with value: 0.49522327206019656.
acc: 0.737089
AUC: 0.905633
Avg Precision: 0.495223
Avg Recall: 1.000000
d_prime: 1.858749
train_loss: 0.061436
valid_loss: 1.339938
validation finished
normal learning rate scheduler step
Epoch-41 lr: 5.63689411937375e-09
Epoch-41 lr: 5.63689411937375e-09
epoch 41 training time: 15.133
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f5361c0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.767 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 15:41:00.630824
current #epochs=1, #steps=0
start validation
acc: 0.737089
AUC: 0.905495
Avg Precision: 0.496056
Avg Recall: 1.000000
d_prime: 1.857587
train_loss: 0.071396
valid_loss: 1.337274
validation finished
normal learning rate scheduler step
Epoch-1 lr: 6.710190875908677e-05
Epoch-1 lr: 6.710190875908677e-05
epoch 1 training time: 17.570
---------------
2023-09-24 15:41:18.200619
current #epochs=2, #steps=39
start validation
acc: 0.723005
AUC: 0.904582
Avg Precision: 0.494457
Avg Recall: 1.000000
d_prime: 1.849950
train_loss: 0.061916
valid_loss: 1.338145
validation finished
normal learning rate scheduler step
Epoch-2 lr: 6.710190875908677e-05
Epoch-2 lr: 6.710190875908677e-05
epoch 2 training time: 16.246
---------------
2023-09-24 15:41:34.446632
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00559	Train Loss 0.0631	
start validation
acc: 0.727700
AUC: 0.905678
Avg Precision: 0.493510
Avg Recall: 1.000000
d_prime: 1.859129
train_loss: 0.070226
valid_loss: 1.336439
validation finished
normal learning rate scheduler step
Epoch-3 lr: 6.710190875908677e-05
Epoch-3 lr: 6.710190875908677e-05
epoch 3 training time: 15.177
---------------
2023-09-24 15:41:49.623493
current #epochs=4, #steps=117
start validation
acc: 0.737089
AUC: 0.905381
Avg Precision: 0.485593
Avg Recall: 1.000000
d_prime: 1.856633
train_loss: 0.083656
valid_loss: 1.335624
validation finished
normal learning rate scheduler step
Epoch-4 lr: 6.710190875908677e-05
Epoch-4 lr: 6.710190875908677e-05
epoch 4 training time: 15.054
---------------
2023-09-24 15:42:04.678005
current #epochs=5, #steps=156
start validation
acc: 0.732394
AUC: 0.904455
Avg Precision: 0.492304
Avg Recall: 1.000000
d_prime: 1.848886
train_loss: 0.060913
valid_loss: 1.338079
validation finished
normal learning rate scheduler step
Epoch-5 lr: 6.710190875908677e-05
Epoch-5 lr: 6.710190875908677e-05
epoch 5 training time: 15.198
---------------
2023-09-24 15:42:19.876095
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01136	Per Sample Data Time 0.00516	Per Sample DNN Time 0.00620	Train Loss 0.0293	
start validation
acc: 0.741784
AUC: 0.906188
Avg Precision: 0.503129
Avg Recall: 1.000000
d_prime: 1.863425
train_loss: 0.064759
valid_loss: 1.337089
validation finished
normal learning rate scheduler step
Epoch-6 lr: 5.148803970835362e-05
Epoch-6 lr: 5.148803970835362e-05
epoch 6 training time: 17.625
---------------
2023-09-24 15:42:37.500785
current #epochs=7, #steps=234
start validation
acc: 0.741784
AUC: 0.906260
Avg Precision: 0.503486
Avg Recall: 1.000000
d_prime: 1.864031
train_loss: 0.048478
valid_loss: 1.336631
validation finished
normal learning rate scheduler step
Epoch-7 lr: 3.9507344605156334e-05
Epoch-7 lr: 3.9507344605156334e-05
epoch 7 training time: 15.113
---------------
2023-09-24 15:42:52.614203
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00680	Per Sample Data Time 0.00121	Per Sample DNN Time 0.00559	Train Loss 0.0526	
start validation
acc: 0.741784
AUC: 0.906566
Avg Precision: 0.494866
Avg Recall: 1.000000
d_prime: 1.866624
train_loss: 0.051837
valid_loss: 1.336552
validation finished
normal learning rate scheduler step
Epoch-8 lr: 3.0314424215636626e-05
Epoch-8 lr: 3.0314424215636626e-05
epoch 8 training time: 15.108
---------------
2023-09-24 15:43:07.722697
current #epochs=9, #steps=312
start validation
acc: 0.746479
AUC: 0.905528
Avg Precision: 0.493614
Avg Recall: 1.000000
d_prime: 1.857865
train_loss: 0.063072
valid_loss: 1.336666
validation finished
normal learning rate scheduler step
Epoch-9 lr: 2.3260594320116288e-05
Epoch-9 lr: 2.3260594320116288e-05
epoch 9 training time: 17.606
---------------
2023-09-24 15:43:25.328534
current #epochs=10, #steps=351
start validation
acc: 0.751174
AUC: 0.905658
Avg Precision: 0.495272
Avg Recall: 1.000000
d_prime: 1.858959
train_loss: 0.050508
valid_loss: 1.337147
validation finished
normal learning rate scheduler step
Epoch-10 lr: 1.7848112313673497e-05
Epoch-10 lr: 1.7848112313673497e-05
epoch 10 training time: 17.638
---------------
2023-09-24 15:43:42.966363
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00864	Per Sample Data Time 0.00295	Per Sample DNN Time 0.00569	Train Loss 0.0503	
start validation
acc: 0.751174
AUC: 0.905568
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.858202
train_loss: 0.062989
valid_loss: 1.337204
validation finished
normal learning rate scheduler step
Epoch-11 lr: 1.3695054768484993e-05
Epoch-11 lr: 1.3695054768484993e-05
epoch 11 training time: 15.178
---------------
2023-09-24 15:43:58.144456
current #epochs=12, #steps=429
start validation
acc: 0.751174
AUC: 0.905937
Avg Precision: 0.496225
Avg Recall: 1.000000
d_prime: 1.861309
train_loss: 0.044351
valid_loss: 1.336901
validation finished
normal learning rate scheduler step
Epoch-12 lr: 1.05083675974023e-05
Epoch-12 lr: 1.05083675974023e-05
epoch 12 training time: 15.180
---------------
2023-09-24 15:44:13.324330
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00657	Per Sample Data Time 0.00107	Per Sample DNN Time 0.00550	Train Loss 0.0735	
start validation
acc: 0.751174
AUC: 0.905957
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.861477
train_loss: 0.078776
valid_loss: 1.337346
validation finished
normal learning rate scheduler step
Epoch-13 lr: 8.06318714520558e-06
Epoch-13 lr: 8.06318714520558e-06
epoch 13 training time: 15.059
---------------
2023-09-24 15:44:28.383546
current #epochs=14, #steps=507
start validation
acc: 0.751174
AUC: 0.905838
Avg Precision: 0.495198
Avg Recall: 1.000000
d_prime: 1.860474
train_loss: 0.056091
valid_loss: 1.337493
validation finished
normal learning rate scheduler step
Epoch-14 lr: 6.186973032298604e-06
Epoch-14 lr: 6.186973032298604e-06
epoch 14 training time: 15.169
---------------
2023-09-24 15:44:43.552770
current #epochs=15, #steps=546
start validation
acc: 0.751174
AUC: 0.905920
Avg Precision: 0.495198
Avg Recall: 1.000000
d_prime: 1.861164
train_loss: 0.047087
valid_loss: 1.337521
validation finished
normal learning rate scheduler step
Epoch-15 lr: 4.747333109482755e-06
Epoch-15 lr: 4.747333109482755e-06
epoch 15 training time: 15.212
---------------
2023-09-24 15:44:58.764674
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00764	Per Sample Data Time 0.00198	Per Sample DNN Time 0.00566	Train Loss 0.0668	
start validation
acc: 0.751174
AUC: 0.905898
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.860977
train_loss: 0.062363
valid_loss: 1.337761
validation finished
normal learning rate scheduler step
Epoch-16 lr: 3.642681410560169e-06
Epoch-16 lr: 3.642681410560169e-06
epoch 16 training time: 15.183
---------------
2023-09-24 15:45:13.947170
current #epochs=17, #steps=624
start validation
acc: 0.751174
AUC: 0.905692
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.859246
train_loss: 0.067023
valid_loss: 1.337892
validation finished
normal learning rate scheduler step
Epoch-17 lr: 2.7950698956295398e-06
Epoch-17 lr: 2.7950698956295398e-06
epoch 17 training time: 15.112
---------------
2023-09-24 15:45:29.058748
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00650	Per Sample Data Time 0.00094	Per Sample DNN Time 0.00556	Train Loss 0.0687	
start validation
acc: 0.751174
AUC: 0.905704
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.859348
train_loss: 0.067986
valid_loss: 1.337854
validation finished
normal learning rate scheduler step
Epoch-18 lr: 2.1446881681187534e-06
Epoch-18 lr: 2.1446881681187534e-06
epoch 18 training time: 15.149
---------------
2023-09-24 15:45:44.207994
current #epochs=19, #steps=702
start validation
acc: 0.751174
AUC: 0.905653
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.858921
train_loss: 0.056762
valid_loss: 1.337850
validation finished
normal learning rate scheduler step
Epoch-19 lr: 1.6456430465874189e-06
Epoch-19 lr: 1.6456430465874189e-06
epoch 19 training time: 14.961
---------------
2023-09-24 15:45:59.169425
current #epochs=20, #steps=741
start validation
acc: 0.751174
AUC: 0.905653
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.858921
train_loss: 0.068115
valid_loss: 1.337819
validation finished
normal learning rate scheduler step
Epoch-20 lr: 1.2627201833061866e-06
Epoch-20 lr: 1.2627201833061866e-06
epoch 20 training time: 15.228
---------------
2023-09-24 15:46:14.397825
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00161	Per Sample DNN Time 0.00557	Train Loss 0.0353	
start validation
acc: 0.751174
AUC: 0.905718
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.859467
train_loss: 0.050922
valid_loss: 1.337864
validation finished
normal learning rate scheduler step
Epoch-21 lr: 9.688992182328096e-07
Epoch-21 lr: 9.688992182328096e-07
epoch 21 training time: 15.149
---------------
2023-09-24 15:46:29.546680
current #epochs=22, #steps=819
start validation
acc: 0.751174
AUC: 0.905715
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.859442
train_loss: 0.060624
valid_loss: 1.337891
validation finished
normal learning rate scheduler step
Epoch-22 lr: 7.434471290655819e-07
Epoch-22 lr: 7.434471290655819e-07
epoch 22 training time: 15.156
---------------
2023-09-24 15:46:44.703088
current #epochs=23, #steps=858
start validation
acc: 0.751174
AUC: 0.905686
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.859191
train_loss: 0.047868
valid_loss: 1.337903
validation finished
normal learning rate scheduler step
Epoch-23 lr: 5.704552375673901e-07
Epoch-23 lr: 5.704552375673901e-07
epoch 23 training time: 15.131
---------------
2023-09-24 15:46:59.834080
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01418	Per Sample Data Time 0.00768	Per Sample DNN Time 0.00649	Train Loss 0.0275	
start validation
acc: 0.751174
AUC: 0.905706
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.859364
train_loss: 0.052436
valid_loss: 1.337914
validation finished
normal learning rate scheduler step
Epoch-24 lr: 4.377166382726877e-07
Epoch-24 lr: 4.377166382726877e-07
epoch 24 training time: 15.133
---------------
2023-09-24 15:47:14.966835
current #epochs=25, #steps=936
start validation
acc: 0.751174
AUC: 0.905736
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.859615
train_loss: 0.060816
valid_loss: 1.337915
validation finished
normal learning rate scheduler step
Epoch-25 lr: 3.3586483706902415e-07
Epoch-25 lr: 3.3586483706902415e-07
epoch 25 training time: 15.071
---------------
2023-09-24 15:47:30.037747
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00680	Per Sample Data Time 0.00130	Per Sample DNN Time 0.00550	Train Loss 0.0523	
start validation
acc: 0.751174
AUC: 0.905701
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.859316
train_loss: 0.062359
valid_loss: 1.337904
validation finished
normal learning rate scheduler step
Epoch-26 lr: 2.5771281901586525e-07
Epoch-26 lr: 2.5771281901586525e-07
epoch 26 training time: 15.013
---------------
2023-09-24 15:47:45.050067
current #epochs=27, #steps=1014
start validation
acc: 0.755869
AUC: 0.905686
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.859191
train_loss: 0.069521
valid_loss: 1.337903
validation finished
normal learning rate scheduler step
Epoch-27 lr: 1.977459077428069e-07
Epoch-27 lr: 1.977459077428069e-07
epoch 27 training time: 17.484
---------------
2023-09-24 15:48:02.534537
current #epochs=28, #steps=1053
start validation
acc: 0.751174
AUC: 0.905706
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.859364
train_loss: 0.051029
valid_loss: 1.337899
validation finished
normal learning rate scheduler step
Epoch-28 lr: 1.5173263083439954e-07
Epoch-28 lr: 1.5173263083439954e-07
epoch 28 training time: 16.355
---------------
2023-09-24 15:48:18.889566
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00924	Per Sample Data Time 0.00352	Per Sample DNN Time 0.00572	Train Loss 0.0535	
start validation
acc: 0.751174
AUC: 0.905706
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.859364
train_loss: 0.063056
valid_loss: 1.337905
validation finished
normal learning rate scheduler step
Epoch-29 lr: 1.1642613251886946e-07
Epoch-29 lr: 1.1642613251886946e-07
epoch 29 training time: 15.123
---------------
2023-09-24 15:48:34.012341
current #epochs=30, #steps=1131
start validation
acc: 0.751174
AUC: 0.905706
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.859364
train_loss: 0.049242
valid_loss: 1.337909
validation finished
normal learning rate scheduler step
Epoch-30 lr: 8.93350643085816e-08
Epoch-30 lr: 8.93350643085816e-08
epoch 30 training time: 15.098
---------------
2023-09-24 15:48:49.110276
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00668	Per Sample Data Time 0.00113	Per Sample DNN Time 0.00555	Train Loss 0.0585	
start validation
acc: 0.751174
AUC: 0.905706
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.859364
train_loss: 0.055896
valid_loss: 1.337909
validation finished
normal learning rate scheduler step
Epoch-31 lr: 6.854778684437491e-08
Epoch-31 lr: 6.854778684437491e-08
epoch 31 training time: 15.212
---------------
2023-09-24 15:49:04.322303
current #epochs=32, #steps=1209
start validation
acc: 0.755869
AUC: 0.905706
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.859364
train_loss: 0.056154
valid_loss: 1.337909
validation finished
normal learning rate scheduler step
Epoch-32 lr: 5.2597478018611416e-08
Epoch-32 lr: 5.2597478018611416e-08
epoch 32 training time: 15.187
---------------
2023-09-24 15:49:19.509421
current #epochs=33, #steps=1248
start validation
acc: 0.755869
AUC: 0.905655
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.858936
train_loss: 0.055465
valid_loss: 1.337906
validation finished
normal learning rate scheduler step
Epoch-33 lr: 4.0358628940116275e-08
Epoch-33 lr: 4.0358628940116275e-08
epoch 33 training time: 15.217
---------------
2023-09-24 15:49:34.726913
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00793	Per Sample Data Time 0.00229	Per Sample DNN Time 0.00564	Train Loss 0.0561	
start validation
acc: 0.755869
AUC: 0.905655
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.858936
train_loss: 0.055219
valid_loss: 1.337906
validation finished
normal learning rate scheduler step
Epoch-34 lr: 3.0967624138739876e-08
Epoch-34 lr: 3.0967624138739876e-08
epoch 34 training time: 15.009
---------------
2023-09-24 15:49:49.735908
current #epochs=35, #steps=1326
start validation
acc: 0.755869
AUC: 0.905655
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.858936
train_loss: 0.060611
valid_loss: 1.337906
validation finished
normal learning rate scheduler step
Epoch-35 lr: 2.3761801874419717e-08
Epoch-35 lr: 2.3761801874419717e-08
epoch 35 training time: 15.162
---------------
2023-09-24 15:50:04.898524
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00655	Per Sample Data Time 0.00097	Per Sample DNN Time 0.00557	Train Loss 0.0601	
start validation
acc: 0.755869
AUC: 0.905655
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.858936
train_loss: 0.065026
valid_loss: 1.337905
validation finished
normal learning rate scheduler step
Epoch-36 lr: 1.823269443563299e-08
Epoch-36 lr: 1.823269443563299e-08
epoch 36 training time: 15.354
---------------
2023-09-24 15:50:20.252247
current #epochs=37, #steps=1404
start validation
acc: 0.755869
AUC: 0.905655
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.858936
train_loss: 0.075159
valid_loss: 1.337906
validation finished
normal learning rate scheduler step
Epoch-37 lr: 1.399014890116705e-08
Epoch-37 lr: 1.399014890116705e-08
epoch 37 training time: 15.149
---------------
2023-09-24 15:50:35.401472
current #epochs=38, #steps=1443
start validation
acc: 0.755869
AUC: 0.905655
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.858936
train_loss: 0.066890
valid_loss: 1.337906
validation finished
normal learning rate scheduler step
Epoch-38 lr: 1.073479660221326e-08
Epoch-38 lr: 1.073479660221326e-08
epoch 38 training time: 15.127
---------------
2023-09-24 15:50:50.528837
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00727	Per Sample Data Time 0.00169	Per Sample DNN Time 0.00558	Train Loss 0.0730	
start validation
acc: 0.755869
AUC: 0.905655
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.858936
train_loss: 0.084384
valid_loss: 1.337906
validation finished
normal learning rate scheduler step
Epoch-39 lr: 8.236928634925139e-09
Epoch-39 lr: 8.236928634925139e-09
epoch 39 training time: 15.082
---------------
2023-09-24 15:51:05.611032
current #epochs=40, #steps=1521
start validation
acc: 0.755869
AUC: 0.905655
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.858936
train_loss: 0.070184
valid_loss: 1.337906
validation finished
normal learning rate scheduler step
Epoch-40 lr: 6.3202868066323e-09
Epoch-40 lr: 6.3202868066323e-09
epoch 40 training time: 16.271
---------------
2023-09-24 15:51:21.881755
current #epochs=41, #steps=1560
start validation
acc: 0.755869
AUC: 0.905655
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.858936
train_loss: 0.055839
valid_loss: 1.337906
validation finished
normal learning rate scheduler step
Epoch-41 lr: 4.849626248880736e-09
Epoch-41 lr: 4.849626248880736e-09
epoch 41 training time: 15.229
---------------
2023-09-24 15:51:37.111123
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02171	Per Sample Data Time 0.01513	Per Sample DNN Time 0.00658	Train Loss 0.0321	
start validation
acc: 0.755869
AUC: 0.905655
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.858936
train_loss: 0.062637
valid_loss: 1.337906
validation finished
normal learning rate scheduler step
Epoch-42 lr: 3.7211720723105642e-09
Epoch-42 lr: 3.7211720723105642e-09
epoch 42 training time: 16.698
---------------
2023-09-24 15:51:53.808650
current #epochs=43, #steps=1638
start validation
acc: 0.755869
AUC: 0.905655
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.858936
train_loss: 0.057807
valid_loss: 1.337906
validation finished
normal learning rate scheduler step
Epoch-43 lr: 2.8552966519718774e-09
Epoch-43 lr: 2.8552966519718774e-09
epoch 43 training time: 15.150
---------------
2023-09-24 15:52:08.958655
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00695	Per Sample Data Time 0.00137	Per Sample DNN Time 0.00558	Train Loss 0.0722	
start validation
acc: 0.755869
AUC: 0.905655
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.858936
train_loss: 0.069144
valid_loss: 1.337906
validation finished
normal learning rate scheduler step
Epoch-44 lr: 2.190900827034208e-09
Epoch-44 lr: 2.190900827034208e-09
epoch 44 training time: 15.181
---------------
2023-09-24 15:52:24.140391
current #epochs=45, #steps=1716
start validation
acc: 0.755869
AUC: 0.905655
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.858936
train_loss: 0.055200
valid_loss: 1.337906
validation finished
normal learning rate scheduler step
Epoch-45 lr: 1.6811025329309474e-09
Epoch-45 lr: 1.6811025329309474e-09
epoch 45 training time: 15.099
---------------
2023-09-24 15:52:39.238690
current #epochs=46, #steps=1755
start validation
acc: 0.755869
AUC: 0.905655
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.858936
train_loss: 0.062567
valid_loss: 1.337906
validation finished
normal learning rate scheduler step
Epoch-46 lr: 1.2899286409291774e-09
Epoch-46 lr: 1.2899286409291774e-09
epoch 46 training time: 15.007
---------------
2023-09-24 15:52:54.245376
current #epochs=47, #steps=1794
Epoch: [47][6/39]	Per Sample Total Time 0.01044	Per Sample Data Time 0.00460	Per Sample DNN Time 0.00584	Train Loss 0.0761	
start validation
[I 2023-09-24 15:53:09,401] Trial 40 finished with value: 0.4956342821622219 and parameters: {'warmup': 'True', 'num_epochs': 47, 'batch_size': 50, 'lr-adaptschedule': 'True', 'lr': 6.710190875908677e-05, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7673111042669295}. Best is trial 40 with value: 0.4956342821622219.
acc: 0.755869
AUC: 0.905655
Avg Precision: 0.495634
Avg Recall: 1.000000
d_prime: 1.858936
train_loss: 0.060996
valid_loss: 1.337906
validation finished
normal learning rate scheduler step
Epoch-47 lr: 9.897765698969067e-10
Epoch-47 lr: 9.897765698969067e-10
epoch 47 training time: 15.147
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f581e50>
The learning rate scheduler starts at 6 epoch with decay rate of 0.772 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 15:53:09.436228
current #epochs=1, #steps=0
start validation
acc: 0.741784
AUC: 0.907367
Avg Precision: 0.488107
Avg Recall: 1.000000
d_prime: 1.873428
train_loss: 0.053679
valid_loss: 1.332883
validation finished
normal learning rate scheduler step
Epoch-1 lr: 8.00479056664981e-05
Epoch-1 lr: 8.00479056664981e-05
epoch 1 training time: 18.273
---------------
2023-09-24 15:53:27.709438
current #epochs=2, #steps=39
start validation
acc: 0.741784
AUC: 0.905913
Avg Precision: 0.494772
Avg Recall: 1.000000
d_prime: 1.861102
train_loss: 0.058194
valid_loss: 1.335844
validation finished
normal learning rate scheduler step
Epoch-2 lr: 8.00479056664981e-05
Epoch-2 lr: 8.00479056664981e-05
epoch 2 training time: 16.445
---------------
2023-09-24 15:53:44.155018
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00700	Per Sample Data Time 0.00142	Per Sample DNN Time 0.00558	Train Loss 0.0545	
start validation
acc: 0.741784
AUC: 0.906052
Avg Precision: 0.494786
Avg Recall: 1.000000
d_prime: 1.862278
train_loss: 0.048462
valid_loss: 1.335702
validation finished
normal learning rate scheduler step
Epoch-3 lr: 8.00479056664981e-05
Epoch-3 lr: 8.00479056664981e-05
epoch 3 training time: 15.013
---------------
2023-09-24 15:53:59.167639
current #epochs=4, #steps=117
start validation
acc: 0.741784
AUC: 0.905868
Avg Precision: 0.488542
Avg Recall: 1.000000
d_prime: 1.860727
train_loss: 0.062581
valid_loss: 1.336501
validation finished
normal learning rate scheduler step
Epoch-4 lr: 8.00479056664981e-05
Epoch-4 lr: 8.00479056664981e-05
epoch 4 training time: 15.337
---------------
2023-09-24 15:54:14.505040
current #epochs=5, #steps=156
start validation
acc: 0.741784
AUC: 0.906277
Avg Precision: 0.486981
Avg Recall: 1.000000
d_prime: 1.864174
train_loss: 0.060926
valid_loss: 1.333705
validation finished
normal learning rate scheduler step
Epoch-5 lr: 8.00479056664981e-05
Epoch-5 lr: 8.00479056664981e-05
epoch 5 training time: 16.157
---------------
2023-09-24 15:54:30.662326
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01145	Per Sample Data Time 0.00546	Per Sample DNN Time 0.00598	Train Loss 0.0453	
start validation
acc: 0.741784
AUC: 0.906203
Avg Precision: 0.501705
Avg Recall: 1.000000
d_prime: 1.863555
train_loss: 0.061633
valid_loss: 1.332530
validation finished
normal learning rate scheduler step
Epoch-6 lr: 6.17701897903485e-05
Epoch-6 lr: 6.17701897903485e-05
epoch 6 training time: 15.214
---------------
2023-09-24 15:54:45.876667
current #epochs=7, #steps=234
start validation
acc: 0.737089
AUC: 0.906587
Avg Precision: 0.503327
Avg Recall: 1.000000
d_prime: 1.866797
train_loss: 0.050097
valid_loss: 1.331712
validation finished
normal learning rate scheduler step
Epoch-7 lr: 4.7665910993753495e-05
Epoch-7 lr: 4.7665910993753495e-05
epoch 7 training time: 14.983
---------------
2023-09-24 15:55:00.859566
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00678	Per Sample Data Time 0.00119	Per Sample DNN Time 0.00559	Train Loss 0.0619	
start validation
acc: 0.741784
AUC: 0.906019
Avg Precision: 0.504501
Avg Recall: 1.000000
d_prime: 1.861996
train_loss: 0.062688
valid_loss: 1.332974
validation finished
normal learning rate scheduler step
Epoch-8 lr: 3.678212870279108e-05
Epoch-8 lr: 3.678212870279108e-05
epoch 8 training time: 15.156
---------------
2023-09-24 15:55:16.015965
current #epochs=9, #steps=312
start validation
acc: 0.746479
AUC: 0.905481
Avg Precision: 0.505007
Avg Recall: 1.000000
d_prime: 1.857471
train_loss: 0.066325
valid_loss: 1.335725
validation finished
normal learning rate scheduler step
Epoch-9 lr: 2.8383491759676748e-05
Epoch-9 lr: 2.8383491759676748e-05
epoch 9 training time: 17.964
---------------
2023-09-24 15:55:33.979573
current #epochs=10, #steps=351
start validation
acc: 0.746479
AUC: 0.906344
Avg Precision: 0.505311
Avg Recall: 1.000000
d_prime: 1.864741
train_loss: 0.073717
valid_loss: 1.336714
validation finished
normal learning rate scheduler step
Epoch-10 lr: 2.190255520503646e-05
Epoch-10 lr: 2.190255520503646e-05
epoch 10 training time: 15.212
---------------
2023-09-24 15:55:49.191999
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00871	Per Sample Data Time 0.00303	Per Sample DNN Time 0.00568	Train Loss 0.0811	
start validation
acc: 0.746479
AUC: 0.906574
Avg Precision: 0.504790
Avg Recall: 1.000000
d_prime: 1.866688
train_loss: 0.062976
valid_loss: 1.336464
validation finished
normal learning rate scheduler step
Epoch-11 lr: 1.690144146363242e-05
Epoch-11 lr: 1.690144146363242e-05
epoch 11 training time: 16.458
---------------
2023-09-24 15:56:05.649987
current #epochs=12, #steps=429
start validation
acc: 0.741784
AUC: 0.906881
Avg Precision: 0.504581
Avg Recall: 1.000000
d_prime: 1.869296
train_loss: 0.061609
valid_loss: 1.335734
validation finished
normal learning rate scheduler step
Epoch-12 lr: 1.3042255612391127e-05
Epoch-12 lr: 1.3042255612391127e-05
epoch 12 training time: 15.677
---------------
2023-09-24 15:56:21.326864
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00665	Per Sample Data Time 0.00105	Per Sample DNN Time 0.00560	Train Loss 0.0598	
start validation
acc: 0.746479
AUC: 0.906622
Avg Precision: 0.503604
Avg Recall: 1.000000
d_prime: 1.867095
train_loss: 0.063143
valid_loss: 1.334357
validation finished
normal learning rate scheduler step
Epoch-13 lr: 1.0064255869829829e-05
Epoch-13 lr: 1.0064255869829829e-05
epoch 13 training time: 18.054
---------------
2023-09-24 15:56:39.381387
current #epochs=14, #steps=507
start validation
acc: 0.746479
AUC: 0.906698
Avg Precision: 0.503140
Avg Recall: 1.000000
d_prime: 1.867737
train_loss: 0.050498
valid_loss: 1.334428
validation finished
normal learning rate scheduler step
Epoch-14 lr: 7.766236855316019e-06
Epoch-14 lr: 7.766236855316019e-06
epoch 14 training time: 16.034
---------------
2023-09-24 15:56:55.415698
current #epochs=15, #steps=546
start validation
acc: 0.746479
AUC: 0.906954
Avg Precision: 0.503337
Avg Recall: 1.000000
d_prime: 1.869915
train_loss: 0.071456
valid_loss: 1.334110
validation finished
normal learning rate scheduler step
Epoch-15 lr: 5.992935361836013e-06
Epoch-15 lr: 5.992935361836013e-06
epoch 15 training time: 15.213
---------------
2023-09-24 15:57:10.628434
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00771	Per Sample Data Time 0.00205	Per Sample DNN Time 0.00565	Train Loss 0.0721	
start validation
acc: 0.746479
AUC: 0.906867
Avg Precision: 0.503337
Avg Recall: 1.000000
d_prime: 1.869178
train_loss: 0.071127
valid_loss: 1.333765
validation finished
normal learning rate scheduler step
Epoch-16 lr: 4.624540162789447e-06
Epoch-16 lr: 4.624540162789447e-06
epoch 16 training time: 15.632
---------------
2023-09-24 15:57:26.260610
current #epochs=17, #steps=624
start validation
acc: 0.746479
AUC: 0.907004
Avg Precision: 0.503537
Avg Recall: 1.000000
d_prime: 1.870339
train_loss: 0.054891
valid_loss: 1.333419
validation finished
normal learning rate scheduler step
Epoch-17 lr: 3.5685970940792284e-06
Epoch-17 lr: 3.5685970940792284e-06
epoch 17 training time: 16.589
---------------
2023-09-24 15:57:42.849933
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00639	Per Sample Data Time 0.00089	Per Sample DNN Time 0.00550	Train Loss 0.0647	
start validation
acc: 0.746479
AUC: 0.907010
Avg Precision: 0.503537
Avg Recall: 1.000000
d_prime: 1.870387
train_loss: 0.063175
valid_loss: 1.333340
validation finished
normal learning rate scheduler step
Epoch-18 lr: 2.753762486990542e-06
Epoch-18 lr: 2.753762486990542e-06
epoch 18 training time: 17.183
---------------
2023-09-24 15:58:00.033087
current #epochs=19, #steps=702
start validation
acc: 0.746479
AUC: 0.906872
Avg Precision: 0.503337
Avg Recall: 1.000000
d_prime: 1.869215
train_loss: 0.060629
valid_loss: 1.333308
validation finished
normal learning rate scheduler step
Epoch-19 lr: 2.124982909204817e-06
Epoch-19 lr: 2.124982909204817e-06
epoch 19 training time: 15.125
---------------
2023-09-24 15:58:15.157835
current #epochs=20, #steps=741
start validation
acc: 0.746479
AUC: 0.907110
Avg Precision: 0.503537
Avg Recall: 1.000000
d_prime: 1.871244
train_loss: 0.053491
valid_loss: 1.333136
validation finished
normal learning rate scheduler step
Epoch-20 lr: 1.6397755382844957e-06
Epoch-20 lr: 1.6397755382844957e-06
epoch 20 training time: 15.216
---------------
2023-09-24 15:58:30.374447
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00159	Per Sample DNN Time 0.00554	Train Loss 0.0431	
start validation
acc: 0.746479
AUC: 0.907218
Avg Precision: 0.503537
Avg Recall: 1.000000
d_prime: 1.872157
train_loss: 0.044167
valid_loss: 1.333073
validation finished
normal learning rate scheduler step
Epoch-21 lr: 1.2653578550250075e-06
Epoch-21 lr: 1.2653578550250075e-06
epoch 21 training time: 16.068
---------------
2023-09-24 15:58:46.442663
current #epochs=22, #steps=819
start validation
acc: 0.746479
AUC: 0.907254
Avg Precision: 0.503537
Avg Recall: 1.000000
d_prime: 1.872466
train_loss: 0.063258
valid_loss: 1.333015
validation finished
normal learning rate scheduler step
Epoch-22 lr: 9.76432727462542e-07
Epoch-22 lr: 9.76432727462542e-07
epoch 22 training time: 15.198
---------------
2023-09-24 15:59:01.641198
current #epochs=23, #steps=858
start validation
acc: 0.746479
AUC: 0.907162
Avg Precision: 0.503537
Avg Recall: 1.000000
d_prime: 1.871680
train_loss: 0.055495
valid_loss: 1.333041
validation finished
normal learning rate scheduler step
Epoch-23 lr: 7.534792370977901e-07
Epoch-23 lr: 7.534792370977901e-07
epoch 23 training time: 15.171
---------------
2023-09-24 15:59:16.811705
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01392	Per Sample Data Time 0.00786	Per Sample DNN Time 0.00606	Train Loss 0.0205	
start validation
acc: 0.746479
AUC: 0.907248
Avg Precision: 0.503537
Avg Recall: 1.000000
d_prime: 1.872418
train_loss: 0.044285
valid_loss: 1.333062
validation finished
normal learning rate scheduler step
Epoch-24 lr: 5.81433768829965e-07
Epoch-24 lr: 5.81433768829965e-07
epoch 24 training time: 15.100
---------------
2023-09-24 15:59:31.911323
current #epochs=25, #steps=936
start validation
acc: 0.746479
AUC: 0.907262
Avg Precision: 0.503537
Avg Recall: 1.000000
d_prime: 1.872538
train_loss: 0.055152
valid_loss: 1.333051
validation finished
normal learning rate scheduler step
Epoch-25 lr: 4.4867225384730995e-07
Epoch-25 lr: 4.4867225384730995e-07
epoch 25 training time: 16.819
---------------
2023-09-24 15:59:48.730842
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00694	Per Sample Data Time 0.00131	Per Sample DNN Time 0.00562	Train Loss 0.0494	
start validation
acc: 0.746479
AUC: 0.907252
Avg Precision: 0.503537
Avg Recall: 1.000000
d_prime: 1.872447
train_loss: 0.045185
valid_loss: 1.333039
validation finished
normal learning rate scheduler step
Epoch-26 lr: 3.4622480179904253e-07
Epoch-26 lr: 3.4622480179904253e-07
epoch 26 training time: 21.198
---------------
2023-09-24 16:00:09.928506
current #epochs=27, #steps=1014
start validation
acc: 0.746479
AUC: 0.907195
Avg Precision: 0.503337
Avg Recall: 1.000000
d_prime: 1.871963
train_loss: 0.063432
valid_loss: 1.333039
validation finished
normal learning rate scheduler step
Epoch-27 lr: 2.671696597079534e-07
Epoch-27 lr: 2.671696597079534e-07
epoch 27 training time: 15.159
---------------
2023-09-24 16:00:25.087613
current #epochs=28, #steps=1053
start validation
acc: 0.746479
AUC: 0.907083
Avg Precision: 0.503337
Avg Recall: 1.000000
d_prime: 1.871008
train_loss: 0.071598
valid_loss: 1.333033
validation finished
normal learning rate scheduler step
Epoch-28 lr: 2.0616555110310705e-07
Epoch-28 lr: 2.0616555110310705e-07
epoch 28 training time: 15.141
---------------
2023-09-24 16:00:40.228567
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00938	Per Sample Data Time 0.00354	Per Sample DNN Time 0.00584	Train Loss 0.0580	
start validation
acc: 0.746479
AUC: 0.907118
Avg Precision: 0.503537
Avg Recall: 1.000000
d_prime: 1.871309
train_loss: 0.053968
valid_loss: 1.333029
validation finished
normal learning rate scheduler step
Epoch-29 lr: 1.59090798364267e-07
Epoch-29 lr: 1.59090798364267e-07
epoch 29 training time: 15.171
---------------
2023-09-24 16:00:55.399212
current #epochs=30, #steps=1131
start validation
acc: 0.746479
AUC: 0.907230
Avg Precision: 0.503537
Avg Recall: 1.000000
d_prime: 1.872265
train_loss: 0.051104
valid_loss: 1.333022
validation finished
normal learning rate scheduler step
Epoch-30 lr: 1.2276484596363018e-07
Epoch-30 lr: 1.2276484596363018e-07
epoch 30 training time: 15.183
---------------
2023-09-24 16:01:10.582234
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00672	Per Sample Data Time 0.00115	Per Sample DNN Time 0.00556	Train Loss 0.0587	
start validation
acc: 0.746479
AUC: 0.907220
Avg Precision: 0.503537
Avg Recall: 1.000000
d_prime: 1.872174
train_loss: 0.054876
valid_loss: 1.333020
validation finished
normal learning rate scheduler step
Epoch-31 lr: 9.473336961931389e-08
Epoch-31 lr: 9.473336961931389e-08
epoch 31 training time: 15.415
---------------
2023-09-24 16:01:25.997387
current #epochs=32, #steps=1209
start validation
acc: 0.746479
AUC: 0.907230
Avg Precision: 0.503537
Avg Recall: 1.000000
d_prime: 1.872265
train_loss: 0.062019
valid_loss: 1.333023
validation finished
normal learning rate scheduler step
Epoch-32 lr: 7.310245248943877e-08
Epoch-32 lr: 7.310245248943877e-08
epoch 32 training time: 15.950
---------------
2023-09-24 16:01:41.947894
current #epochs=33, #steps=1248
start validation
acc: 0.746479
AUC: 0.907230
Avg Precision: 0.503537
Avg Recall: 1.000000
d_prime: 1.872265
train_loss: 0.048599
valid_loss: 1.333019
validation finished
normal learning rate scheduler step
Epoch-33 lr: 5.641062469798546e-08
Epoch-33 lr: 5.641062469798546e-08
epoch 33 training time: 15.389
---------------
2023-09-24 16:01:57.336255
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00791	Per Sample Data Time 0.00221	Per Sample DNN Time 0.00570	Train Loss 0.0710	
start validation
acc: 0.746479
AUC: 0.907230
Avg Precision: 0.503537
Avg Recall: 1.000000
d_prime: 1.872265
train_loss: 0.071664
valid_loss: 1.333022
validation finished
normal learning rate scheduler step
Epoch-34 lr: 4.3530120679284986e-08
Epoch-34 lr: 4.3530120679284986e-08
epoch 34 training time: 15.894
---------------
2023-09-24 16:02:13.230962
current #epochs=35, #steps=1326
start validation
acc: 0.746479
AUC: 0.907230
Avg Precision: 0.503537
Avg Recall: 1.000000
d_prime: 1.872265
train_loss: 0.049441
valid_loss: 1.333022
validation finished
normal learning rate scheduler step
Epoch-35 lr: 3.359068289879768e-08
Epoch-35 lr: 3.359068289879768e-08
epoch 35 training time: 15.073
---------------
2023-09-24 16:02:28.303706
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00650	Per Sample Data Time 0.00098	Per Sample DNN Time 0.00552	Train Loss 0.0887	
start validation
acc: 0.746479
AUC: 0.907230
Avg Precision: 0.503537
Avg Recall: 1.000000
d_prime: 1.872265
train_loss: 0.084017
valid_loss: 1.333022
validation finished
normal learning rate scheduler step
Epoch-36 lr: 2.5920763829734293e-08
Epoch-36 lr: 2.5920763829734293e-08
epoch 36 training time: 17.247
---------------
2023-09-24 16:02:45.550306
current #epochs=37, #steps=1404
start validation
acc: 0.746479
AUC: 0.907230
Avg Precision: 0.503537
Avg Recall: 1.000000
d_prime: 1.872265
train_loss: 0.054429
valid_loss: 1.333022
validation finished
normal learning rate scheduler step
Epoch-37 lr: 2.0002153559697668e-08
Epoch-37 lr: 2.0002153559697668e-08
epoch 37 training time: 15.549
---------------
2023-09-24 16:03:01.099677
current #epochs=38, #steps=1443
start validation
acc: 0.746479
AUC: 0.907230
Avg Precision: 0.503537
Avg Recall: 1.000000
d_prime: 1.872265
train_loss: 0.059450
valid_loss: 1.333021
validation finished
normal learning rate scheduler step
Epoch-38 lr: 1.5434967489915487e-08
Epoch-38 lr: 1.5434967489915487e-08
epoch 38 training time: 15.014
---------------
2023-09-24 16:03:16.113852
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00740	Per Sample Data Time 0.00172	Per Sample DNN Time 0.00567	Train Loss 0.0667	
start validation
acc: 0.746479
AUC: 0.907230
Avg Precision: 0.503537
Avg Recall: 1.000000
d_prime: 1.872265
train_loss: 0.063244
valid_loss: 1.333021
validation finished
normal learning rate scheduler step
Epoch-39 lr: 1.1910628558255552e-08
Epoch-39 lr: 1.1910628558255552e-08
epoch 39 training time: 15.824
---------------
2023-09-24 16:03:31.938286
current #epochs=40, #steps=1521
start validation
acc: 0.746479
AUC: 0.907230
Avg Precision: 0.503537
Avg Recall: 1.000000
d_prime: 1.872265
train_loss: 0.076253
valid_loss: 1.333021
validation finished
normal learning rate scheduler step
Epoch-40 lr: 9.191018558699245e-09
Epoch-40 lr: 9.191018558699245e-09
epoch 40 training time: 15.227
---------------
2023-09-24 16:03:47.164793
current #epochs=41, #steps=1560
start validation
acc: 0.746479
AUC: 0.907230
Avg Precision: 0.503537
Avg Recall: 1.000000
d_prime: 1.872265
train_loss: 0.059943
valid_loss: 1.333020
validation finished
normal learning rate scheduler step
Epoch-41 lr: 7.092389938380065e-09
Epoch-41 lr: 7.092389938380065e-09
epoch 41 training time: 15.108
---------------
2023-09-24 16:04:02.272634
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02243	Per Sample Data Time 0.01575	Per Sample DNN Time 0.00667	Train Loss 0.0437	
start validation
[I 2023-09-24 16:04:18,528] Trial 41 finished with value: 0.5035368702035369 and parameters: {'warmup': 'True', 'num_epochs': 42, 'batch_size': 50, 'lr-adaptschedule': 'True', 'lr': 8.00479056664981e-05, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7716652831330821}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.746479
AUC: 0.907230
Avg Precision: 0.503537
Avg Recall: 1.000000
d_prime: 1.872265
train_loss: 0.059472
valid_loss: 1.333020
validation finished
normal learning rate scheduler step
Epoch-42 lr: 5.472951089890275e-09
Epoch-42 lr: 5.472951089890275e-09
epoch 42 training time: 16.246
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f581610>
The learning rate scheduler starts at 5 epoch with decay rate of 0.737 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 16:04:18.563538
current #epochs=1, #steps=0
start validation
acc: 0.746479
AUC: 0.905793
Avg Precision: 0.503964
Avg Recall: 1.000000
d_prime: 1.860095
train_loss: 0.052902
valid_loss: 1.335147
validation finished
normal learning rate scheduler step
Epoch-1 lr: 2.4740451636974554e-05
Epoch-1 lr: 2.4740451636974554e-05
epoch 1 training time: 17.603
---------------
2023-09-24 16:04:36.166710
current #epochs=2, #steps=39
start validation
acc: 0.746479
AUC: 0.905889
Avg Precision: 0.503770
Avg Recall: 1.000000
d_prime: 1.860905
train_loss: 0.047970
valid_loss: 1.333787
validation finished
normal learning rate scheduler step
Epoch-2 lr: 2.4740451636974554e-05
Epoch-2 lr: 2.4740451636974554e-05
epoch 2 training time: 15.132
---------------
2023-09-24 16:04:51.298910
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00702	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00556	Train Loss 0.0354	
start validation
acc: 0.746479
AUC: 0.906144
Avg Precision: 0.503573
Avg Recall: 1.000000
d_prime: 1.863053
train_loss: 0.036345
valid_loss: 1.332236
validation finished
normal learning rate scheduler step
Epoch-3 lr: 2.4740451636974554e-05
Epoch-3 lr: 2.4740451636974554e-05
epoch 3 training time: 15.103
---------------
2023-09-24 16:05:06.401872
current #epochs=4, #steps=117
start validation
acc: 0.741784
AUC: 0.906346
Avg Precision: 0.503408
Avg Recall: 1.000000
d_prime: 1.864761
train_loss: 0.067868
valid_loss: 1.331573
validation finished
normal learning rate scheduler step
Epoch-4 lr: 2.4740451636974554e-05
Epoch-4 lr: 2.4740451636974554e-05
epoch 4 training time: 15.241
---------------
2023-09-24 16:05:21.642304
current #epochs=5, #steps=156
start validation
acc: 0.741784
AUC: 0.906166
Avg Precision: 0.503048
Avg Recall: 1.000000
d_prime: 1.863240
train_loss: 0.043685
valid_loss: 1.331417
validation finished
normal learning rate scheduler step
Epoch-5 lr: 1.8232573564258836e-05
Epoch-5 lr: 1.8232573564258836e-05
epoch 5 training time: 17.213
---------------
2023-09-24 16:05:38.855460
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01132	Per Sample Data Time 0.00521	Per Sample DNN Time 0.00611	Train Loss 0.0594	
start validation
acc: 0.746479
AUC: 0.905863
Avg Precision: 0.503626
Avg Recall: 1.000000
d_prime: 1.860681
train_loss: 0.058867
valid_loss: 1.331834
validation finished
normal learning rate scheduler step
Epoch-6 lr: 1.343656711097784e-05
Epoch-6 lr: 1.343656711097784e-05
epoch 6 training time: 15.187
---------------
2023-09-24 16:05:54.042211
current #epochs=7, #steps=234
start validation
acc: 0.741784
AUC: 0.905753
Avg Precision: 0.503626
Avg Recall: 1.000000
d_prime: 1.859759
train_loss: 0.063202
valid_loss: 1.332481
validation finished
normal learning rate scheduler step
Epoch-7 lr: 9.90213120992009e-06
Epoch-7 lr: 9.90213120992009e-06
epoch 7 training time: 15.034
---------------
2023-09-24 16:06:09.076362
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00678	Per Sample Data Time 0.00120	Per Sample DNN Time 0.00558	Train Loss 0.0576	
start validation
acc: 0.741784
AUC: 0.905659
Avg Precision: 0.503176
Avg Recall: 1.000000
d_prime: 1.858965
train_loss: 0.064967
valid_loss: 1.332986
validation finished
normal learning rate scheduler step
Epoch-8 lr: 7.297414710812827e-06
Epoch-8 lr: 7.297414710812827e-06
epoch 8 training time: 15.118
---------------
2023-09-24 16:06:24.194170
current #epochs=9, #steps=312
start validation
acc: 0.741784
AUC: 0.905294
Avg Precision: 0.503154
Avg Recall: 1.000000
d_prime: 1.855903
train_loss: 0.051240
valid_loss: 1.333551
validation finished
normal learning rate scheduler step
Epoch-9 lr: 5.377858597575299e-06
Epoch-9 lr: 5.377858597575299e-06
epoch 9 training time: 15.170
---------------
2023-09-24 16:06:39.363709
current #epochs=10, #steps=351
start validation
acc: 0.741784
AUC: 0.905189
Avg Precision: 0.502328
Avg Recall: 1.000000
d_prime: 1.855021
train_loss: 0.053796
valid_loss: 1.333553
validation finished
normal learning rate scheduler step
Epoch-10 lr: 3.963234137243262e-06
Epoch-10 lr: 3.963234137243262e-06
epoch 10 training time: 15.211
---------------
2023-09-24 16:06:54.574520
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00863	Per Sample Data Time 0.00284	Per Sample DNN Time 0.00579	Train Loss 0.0566	
start validation
acc: 0.741784
AUC: 0.905321
Avg Precision: 0.502328
Avg Recall: 1.000000
d_prime: 1.856126
train_loss: 0.055730
valid_loss: 1.333653
validation finished
normal learning rate scheduler step
Epoch-11 lr: 2.920721053114379e-06
Epoch-11 lr: 2.920721053114379e-06
epoch 11 training time: 15.082
---------------
2023-09-24 16:07:09.657281
current #epochs=12, #steps=429
start validation
acc: 0.741784
AUC: 0.905153
Avg Precision: 0.502328
Avg Recall: 1.000000
d_prime: 1.854722
train_loss: 0.065367
valid_loss: 1.333836
validation finished
normal learning rate scheduler step
Epoch-12 lr: 2.1524369176026706e-06
Epoch-12 lr: 2.1524369176026706e-06
epoch 12 training time: 15.058
---------------
2023-09-24 16:07:24.715747
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00656	Per Sample Data Time 0.00107	Per Sample DNN Time 0.00549	Train Loss 0.0502	
start validation
acc: 0.741784
AUC: 0.905175
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.854903
train_loss: 0.054498
valid_loss: 1.333922
validation finished
normal learning rate scheduler step
Epoch-13 lr: 1.5862468890408798e-06
Epoch-13 lr: 1.5862468890408798e-06
epoch 13 training time: 17.749
---------------
2023-09-24 16:07:42.464334
current #epochs=14, #steps=507
start validation
acc: 0.741784
AUC: 0.905322
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.856135
train_loss: 0.064830
valid_loss: 1.333938
validation finished
normal learning rate scheduler step
Epoch-14 lr: 1.16899091091335e-06
Epoch-14 lr: 1.16899091091335e-06
epoch 14 training time: 15.172
---------------
2023-09-24 16:07:57.636706
current #epochs=15, #steps=546
start validation
acc: 0.741784
AUC: 0.905308
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.856017
train_loss: 0.040137
valid_loss: 1.333960
validation finished
normal learning rate scheduler step
Epoch-15 lr: 8.614924695765982e-07
Epoch-15 lr: 8.614924695765982e-07
epoch 15 training time: 15.361
---------------
2023-09-24 16:08:12.997099
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00772	Per Sample Data Time 0.00208	Per Sample DNN Time 0.00565	Train Loss 0.0657	
start validation
acc: 0.741784
AUC: 0.905237
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855422
train_loss: 0.053883
valid_loss: 1.333979
validation finished
normal learning rate scheduler step
Epoch-16 lr: 6.34880278544953e-07
Epoch-16 lr: 6.34880278544953e-07
epoch 16 training time: 15.584
---------------
2023-09-24 16:08:28.580905
current #epochs=17, #steps=624
start validation
acc: 0.741784
AUC: 0.905237
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855422
train_loss: 0.068652
valid_loss: 1.333998
validation finished
normal learning rate scheduler step
Epoch-17 lr: 4.678775291946746e-07
Epoch-17 lr: 4.678775291946746e-07
epoch 17 training time: 15.071
---------------
2023-09-24 16:08:43.651498
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00646	Per Sample Data Time 0.00092	Per Sample DNN Time 0.00554	Train Loss 0.0584	
start validation
acc: 0.741784
AUC: 0.905215
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855243
train_loss: 0.060968
valid_loss: 1.334002
validation finished
normal learning rate scheduler step
Epoch-18 lr: 3.448041933622822e-07
Epoch-18 lr: 3.448041933622822e-07
epoch 18 training time: 16.775
---------------
2023-09-24 16:09:00.426560
current #epochs=19, #steps=702
start validation
acc: 0.741784
AUC: 0.905230
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855368
train_loss: 0.050091
valid_loss: 1.334003
validation finished
normal learning rate scheduler step
Epoch-19 lr: 2.541048123530343e-07
Epoch-19 lr: 2.541048123530343e-07
epoch 19 training time: 15.035
---------------
2023-09-24 16:09:15.461321
current #epochs=20, #steps=741
start validation
acc: 0.741784
AUC: 0.905230
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855368
train_loss: 0.043294
valid_loss: 1.334001
validation finished
normal learning rate scheduler step
Epoch-20 lr: 1.872635452351605e-07
Epoch-20 lr: 1.872635452351605e-07
epoch 20 training time: 15.218
---------------
2023-09-24 16:09:30.679693
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00731	Per Sample Data Time 0.00162	Per Sample DNN Time 0.00569	Train Loss 0.0418	
start validation
acc: 0.741784
AUC: 0.905230
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855368
train_loss: 0.058026
valid_loss: 1.334002
validation finished
normal learning rate scheduler step
Epoch-21 lr: 1.380046093944913e-07
Epoch-21 lr: 1.380046093944913e-07
epoch 21 training time: 16.698
---------------
2023-09-24 16:09:47.377516
current #epochs=22, #steps=819
start validation
acc: 0.741784
AUC: 0.905230
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855368
train_loss: 0.074150
valid_loss: 1.334003
validation finished
normal learning rate scheduler step
Epoch-22 lr: 1.0170304204275092e-07
Epoch-22 lr: 1.0170304204275092e-07
epoch 22 training time: 15.052
---------------
2023-09-24 16:10:02.429276
current #epochs=23, #steps=858
start validation
acc: 0.741784
AUC: 0.905230
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855368
train_loss: 0.065363
valid_loss: 1.334002
validation finished
normal learning rate scheduler step
Epoch-23 lr: 7.495045858346844e-08
Epoch-23 lr: 7.495045858346844e-08
epoch 23 training time: 15.326
---------------
2023-09-24 16:10:17.755903
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01461	Per Sample Data Time 0.00843	Per Sample DNN Time 0.00618	Train Loss 0.0805	
start validation
acc: 0.741784
AUC: 0.905230
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855368
train_loss: 0.069539
valid_loss: 1.334005
validation finished
normal learning rate scheduler step
Epoch-24 lr: 5.523503652438311e-08
Epoch-24 lr: 5.523503652438311e-08
epoch 24 training time: 15.366
---------------
2023-09-24 16:10:33.122347
current #epochs=25, #steps=936
start validation
acc: 0.741784
AUC: 0.905230
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855368
train_loss: 0.062603
valid_loss: 1.334004
validation finished
normal learning rate scheduler step
Epoch-25 lr: 4.07056783575553e-08
Epoch-25 lr: 4.07056783575553e-08
epoch 25 training time: 15.091
---------------
2023-09-24 16:10:48.213270
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00692	Per Sample Data Time 0.00135	Per Sample DNN Time 0.00557	Train Loss 0.0466	
start validation
acc: 0.741784
AUC: 0.905230
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855368
train_loss: 0.049655
valid_loss: 1.334004
validation finished
normal learning rate scheduler step
Epoch-26 lr: 2.999821046225427e-08
Epoch-26 lr: 2.999821046225427e-08
epoch 26 training time: 15.241
---------------
2023-09-24 16:11:03.454580
current #epochs=27, #steps=1014
start validation
acc: 0.741784
AUC: 0.905230
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855368
train_loss: 0.059804
valid_loss: 1.334003
validation finished
normal learning rate scheduler step
Epoch-27 lr: 2.2107299699887552e-08
Epoch-27 lr: 2.2107299699887552e-08
epoch 27 training time: 15.197
---------------
2023-09-24 16:11:18.651559
current #epochs=28, #steps=1053
start validation
acc: 0.741784
AUC: 0.905230
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855368
train_loss: 0.068633
valid_loss: 1.334003
validation finished
normal learning rate scheduler step
Epoch-28 lr: 1.6292061842675715e-08
Epoch-28 lr: 1.6292061842675715e-08
epoch 28 training time: 15.417
---------------
2023-09-24 16:11:34.068636
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00923	Per Sample Data Time 0.00346	Per Sample DNN Time 0.00576	Train Loss 0.0654	
start validation
acc: 0.741784
AUC: 0.905230
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855368
train_loss: 0.071348
valid_loss: 1.334003
validation finished
normal learning rate scheduler step
Epoch-29 lr: 1.2006499332296116e-08
Epoch-29 lr: 1.2006499332296116e-08
epoch 29 training time: 15.094
---------------
2023-09-24 16:11:49.162686
current #epochs=30, #steps=1131
start validation
acc: 0.741784
AUC: 0.905230
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855368
train_loss: 0.050560
valid_loss: 1.334004
validation finished
normal learning rate scheduler step
Epoch-30 lr: 8.848237111328796e-09
Epoch-30 lr: 8.848237111328796e-09
epoch 30 training time: 15.085
---------------
2023-09-24 16:12:04.247443
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00663	Per Sample Data Time 0.00113	Per Sample DNN Time 0.00550	Train Loss 0.0494	
start validation
acc: 0.741784
AUC: 0.905230
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855368
train_loss: 0.051844
valid_loss: 1.334003
validation finished
normal learning rate scheduler step
Epoch-31 lr: 6.520743291735459e-09
Epoch-31 lr: 6.520743291735459e-09
epoch 31 training time: 15.017
---------------
2023-09-24 16:12:19.264794
current #epochs=32, #steps=1209
start validation
acc: 0.741784
AUC: 0.905230
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855368
train_loss: 0.063516
valid_loss: 1.334003
validation finished
normal learning rate scheduler step
Epoch-32 lr: 4.805487527258125e-09
Epoch-32 lr: 4.805487527258125e-09
epoch 32 training time: 16.864
---------------
2023-09-24 16:12:36.128941
current #epochs=33, #steps=1248
start validation
acc: 0.741784
AUC: 0.905230
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855368
train_loss: 0.070292
valid_loss: 1.334003
validation finished
normal learning rate scheduler step
Epoch-33 lr: 3.5414230159775867e-09
Epoch-33 lr: 3.5414230159775867e-09
epoch 33 training time: 15.310
---------------
2023-09-24 16:12:51.438367
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00802	Per Sample Data Time 0.00236	Per Sample DNN Time 0.00566	Train Loss 0.0556	
start validation
acc: 0.741784
AUC: 0.905230
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855368
train_loss: 0.061631
valid_loss: 1.334003
validation finished
normal learning rate scheduler step
Epoch-34 lr: 2.609865681048123e-09
Epoch-34 lr: 2.609865681048123e-09
epoch 34 training time: 15.887
---------------
2023-09-24 16:13:07.325478
current #epochs=35, #steps=1326
start validation
acc: 0.741784
AUC: 0.905230
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855368
train_loss: 0.053758
valid_loss: 1.334003
validation finished
normal learning rate scheduler step
Epoch-35 lr: 1.9233508232092804e-09
Epoch-35 lr: 1.9233508232092804e-09
epoch 35 training time: 15.040
---------------
2023-09-24 16:13:22.365339
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00651	Per Sample Data Time 0.00096	Per Sample DNN Time 0.00556	Train Loss 0.0519	
start validation
acc: 0.741784
AUC: 0.905230
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855368
train_loss: 0.050217
valid_loss: 1.334003
validation finished
normal learning rate scheduler step
Epoch-36 lr: 1.4174209868356844e-09
Epoch-36 lr: 1.4174209868356844e-09
epoch 36 training time: 15.101
---------------
2023-09-24 16:13:37.466276
current #epochs=37, #steps=1404
start validation
acc: 0.741784
AUC: 0.905230
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855368
train_loss: 0.057503
valid_loss: 1.334003
validation finished
normal learning rate scheduler step
Epoch-37 lr: 1.0445739953826597e-09
Epoch-37 lr: 1.0445739953826597e-09
epoch 37 training time: 15.082
---------------
2023-09-24 16:13:52.549057
current #epochs=38, #steps=1443
start validation
acc: 0.741784
AUC: 0.905230
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855368
train_loss: 0.054657
valid_loss: 1.334003
validation finished
normal learning rate scheduler step
Epoch-38 lr: 7.698029322012454e-10
Epoch-38 lr: 7.698029322012454e-10
epoch 38 training time: 15.339
---------------
2023-09-24 16:14:07.887865
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00736	Per Sample Data Time 0.00172	Per Sample DNN Time 0.00565	Train Loss 0.0417	
start validation
acc: 0.741784
AUC: 0.905230
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855368
train_loss: 0.046513
valid_loss: 1.334003
validation finished
normal learning rate scheduler step
Epoch-39 lr: 5.673093117817362e-10
Epoch-39 lr: 5.673093117817362e-10
epoch 39 training time: 15.231
---------------
2023-09-24 16:14:23.118680
current #epochs=40, #steps=1521
start validation
acc: 0.741784
AUC: 0.905230
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855368
train_loss: 0.044240
valid_loss: 1.334003
validation finished
normal learning rate scheduler step
Epoch-40 lr: 4.180808383178909e-10
Epoch-40 lr: 4.180808383178909e-10
epoch 40 training time: 15.237
---------------
2023-09-24 16:14:38.355172
current #epochs=41, #steps=1560
start validation
[I 2023-09-24 16:14:53,591] Trial 42 finished with value: 0.5025275238443074 and parameters: {'warmup': 'True', 'num_epochs': 41, 'batch_size': 51, 'lr-adaptschedule': 'True', 'lr': 2.4740451636974554e-05, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7369539502266116}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.741784
AUC: 0.905230
Avg Precision: 0.502528
Avg Recall: 1.000000
d_prime: 1.855368
train_loss: 0.065661
valid_loss: 1.334003
validation finished
normal learning rate scheduler step
Epoch-41 lr: 3.08106325312423e-10
Epoch-41 lr: 3.08106325312423e-10
epoch 41 training time: 15.227
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67ec17730>
The learning rate scheduler starts at 5 epoch with decay rate of 0.735 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 16:14:53.625742
current #epochs=1, #steps=0
start validation
acc: 0.741784
AUC: 0.905611
Avg Precision: 0.502488
Avg Recall: 1.000000
d_prime: 1.858564
train_loss: 0.059760
valid_loss: 1.333209
validation finished
normal learning rate scheduler step
Epoch-1 lr: 1.6482148077076997e-05
Epoch-1 lr: 1.6482148077076997e-05
epoch 1 training time: 17.619
---------------
2023-09-24 16:15:11.244882
current #epochs=2, #steps=39
start validation
acc: 0.741784
AUC: 0.905292
Avg Precision: 0.502291
Avg Recall: 1.000000
d_prime: 1.855885
train_loss: 0.049700
valid_loss: 1.333888
validation finished
normal learning rate scheduler step
Epoch-2 lr: 1.6482148077076997e-05
Epoch-2 lr: 1.6482148077076997e-05
epoch 2 training time: 15.172
---------------
2023-09-24 16:15:26.416943
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00563	Train Loss 0.0544	
start validation
acc: 0.741784
AUC: 0.905438
Avg Precision: 0.494203
Avg Recall: 1.000000
d_prime: 1.857108
train_loss: 0.062892
valid_loss: 1.333698
validation finished
normal learning rate scheduler step
Epoch-3 lr: 1.6482148077076997e-05
Epoch-3 lr: 1.6482148077076997e-05
epoch 3 training time: 16.923
---------------
2023-09-24 16:15:43.340081
current #epochs=4, #steps=117
start validation
acc: 0.741784
AUC: 0.905706
Avg Precision: 0.493716
Avg Recall: 1.000000
d_prime: 1.859362
train_loss: 0.072794
valid_loss: 1.333137
validation finished
normal learning rate scheduler step
Epoch-4 lr: 1.6482148077076997e-05
Epoch-4 lr: 1.6482148077076997e-05
epoch 4 training time: 16.027
---------------
2023-09-24 16:15:59.367279
current #epochs=5, #steps=156
start validation
acc: 0.741784
AUC: 0.905713
Avg Precision: 0.493448
Avg Recall: 1.000000
d_prime: 1.859422
train_loss: 0.063549
valid_loss: 1.333363
validation finished
normal learning rate scheduler step
Epoch-5 lr: 1.2110970050569677e-05
Epoch-5 lr: 1.2110970050569677e-05
epoch 5 training time: 15.158
---------------
2023-09-24 16:16:14.525032
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01109	Per Sample Data Time 0.00528	Per Sample DNN Time 0.00581	Train Loss 0.0879	
start validation
acc: 0.746479
AUC: 0.905780
Avg Precision: 0.493589
Avg Recall: 1.000000
d_prime: 1.859988
train_loss: 0.048419
valid_loss: 1.333527
validation finished
normal learning rate scheduler step
Epoch-6 lr: 8.899058234392933e-06
Epoch-6 lr: 8.899058234392933e-06
epoch 6 training time: 17.636
---------------
2023-09-24 16:16:32.160918
current #epochs=7, #steps=234
start validation
acc: 0.746479
AUC: 0.905846
Avg Precision: 0.493868
Avg Recall: 1.000000
d_prime: 1.860545
train_loss: 0.051172
valid_loss: 1.333569
validation finished
normal learning rate scheduler step
Epoch-7 lr: 6.538967327013708e-06
Epoch-7 lr: 6.538967327013708e-06
epoch 7 training time: 15.144
---------------
2023-09-24 16:16:47.304532
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00685	Per Sample Data Time 0.00124	Per Sample DNN Time 0.00561	Train Loss 0.0558	
start validation
acc: 0.746479
AUC: 0.905670
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.859064
train_loss: 0.059516
valid_loss: 1.333521
validation finished
normal learning rate scheduler step
Epoch-8 lr: 4.80478861667654e-06
Epoch-8 lr: 4.80478861667654e-06
epoch 8 training time: 15.074
---------------
2023-09-24 16:17:02.378304
current #epochs=9, #steps=312
start validation
acc: 0.746479
AUC: 0.905585
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858344
train_loss: 0.047045
valid_loss: 1.333501
validation finished
normal learning rate scheduler step
Epoch-9 lr: 3.5305259219711743e-06
Epoch-9 lr: 3.5305259219711743e-06
epoch 9 training time: 16.476
---------------
2023-09-24 16:17:18.853893
current #epochs=10, #steps=351
start validation
acc: 0.746479
AUC: 0.905509
Avg Precision: 0.493335
Avg Recall: 1.000000
d_prime: 1.857710
train_loss: 0.052774
valid_loss: 1.333429
validation finished
normal learning rate scheduler step
Epoch-10 lr: 2.5942063803697887e-06
Epoch-10 lr: 2.5942063803697887e-06
epoch 10 training time: 15.751
---------------
2023-09-24 16:17:34.604850
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00875	Per Sample Data Time 0.00307	Per Sample DNN Time 0.00567	Train Loss 0.0634	
start validation
acc: 0.746479
AUC: 0.905549
Avg Precision: 0.493335
Avg Recall: 1.000000
d_prime: 1.858044
train_loss: 0.067695
valid_loss: 1.333386
validation finished
normal learning rate scheduler step
Epoch-11 lr: 1.9062051639586484e-06
Epoch-11 lr: 1.9062051639586484e-06
epoch 11 training time: 15.093
---------------
2023-09-24 16:17:49.697807
current #epochs=12, #steps=429
start validation
acc: 0.746479
AUC: 0.905558
Avg Precision: 0.493335
Avg Recall: 1.000000
d_prime: 1.858115
train_loss: 0.078623
valid_loss: 1.333310
validation finished
normal learning rate scheduler step
Epoch-12 lr: 1.4006665601464857e-06
Epoch-12 lr: 1.4006665601464857e-06
epoch 12 training time: 16.993
---------------
2023-09-24 16:18:06.690486
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00662	Per Sample Data Time 0.00105	Per Sample DNN Time 0.00557	Train Loss 0.0545	
start validation
acc: 0.746479
AUC: 0.905621
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858647
train_loss: 0.055059
valid_loss: 1.333296
validation finished
normal learning rate scheduler step
Epoch-13 lr: 1.0292002402502924e-06
Epoch-13 lr: 1.0292002402502924e-06
epoch 13 training time: 15.164
---------------
2023-09-24 16:18:21.854598
current #epochs=14, #steps=507
start validation
acc: 0.746479
AUC: 0.905623
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858665
train_loss: 0.054400
valid_loss: 1.333281
validation finished
normal learning rate scheduler step
Epoch-14 lr: 7.562493206238035e-07
Epoch-14 lr: 7.562493206238035e-07
epoch 14 training time: 16.036
---------------
2023-09-24 16:18:37.890880
current #epochs=15, #steps=546
start validation
acc: 0.746479
AUC: 0.905653
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858916
train_loss: 0.054316
valid_loss: 1.333299
validation finished
normal learning rate scheduler step
Epoch-15 lr: 5.556868455499778e-07
Epoch-15 lr: 5.556868455499778e-07
epoch 15 training time: 16.806
---------------
2023-09-24 16:18:54.696852
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00763	Per Sample Data Time 0.00206	Per Sample DNN Time 0.00557	Train Loss 0.0728	
start validation
acc: 0.746479
AUC: 0.905546
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858015
train_loss: 0.069694
valid_loss: 1.333336
validation finished
normal learning rate scheduler step
Epoch-16 lr: 4.083149060716863e-07
Epoch-16 lr: 4.083149060716863e-07
epoch 16 training time: 16.080
---------------
2023-09-24 16:19:10.776548
current #epochs=17, #steps=624
start validation
acc: 0.746479
AUC: 0.905561
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858140
train_loss: 0.048357
valid_loss: 1.333348
validation finished
normal learning rate scheduler step
Epoch-17 lr: 3.000270095566538e-07
Epoch-17 lr: 3.000270095566538e-07
epoch 17 training time: 15.189
---------------
2023-09-24 16:19:25.966195
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00643	Per Sample Data Time 0.00094	Per Sample DNN Time 0.00549	Train Loss 0.0482	
start validation
acc: 0.746479
AUC: 0.905561
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858140
train_loss: 0.048262
valid_loss: 1.333348
validation finished
normal learning rate scheduler step
Epoch-18 lr: 2.2045780138064477e-07
Epoch-18 lr: 2.2045780138064477e-07
epoch 18 training time: 15.007
---------------
2023-09-24 16:19:40.972659
current #epochs=19, #steps=702
start validation
acc: 0.746479
AUC: 0.905546
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858015
train_loss: 0.062692
valid_loss: 1.333349
validation finished
normal learning rate scheduler step
Epoch-19 lr: 1.6199088962492363e-07
Epoch-19 lr: 1.6199088962492363e-07
epoch 19 training time: 15.095
---------------
2023-09-24 16:19:56.068358
current #epochs=20, #steps=741
start validation
acc: 0.746479
AUC: 0.905546
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858015
train_loss: 0.078031
valid_loss: 1.333347
validation finished
normal learning rate scheduler step
Epoch-20 lr: 1.1902980142746739e-07
Epoch-20 lr: 1.1902980142746739e-07
epoch 20 training time: 15.308
---------------
2023-09-24 16:20:11.376427
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00556	Train Loss 0.0567	
start validation
acc: 0.746479
AUC: 0.905546
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858015
train_loss: 0.052781
valid_loss: 1.333344
validation finished
normal learning rate scheduler step
Epoch-21 lr: 8.746228667962349e-08
Epoch-21 lr: 8.746228667962349e-08
epoch 21 training time: 15.144
---------------
2023-09-24 16:20:26.520329
current #epochs=22, #steps=819
start validation
acc: 0.746479
AUC: 0.905546
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858015
train_loss: 0.051516
valid_loss: 1.333347
validation finished
normal learning rate scheduler step
Epoch-22 lr: 6.426669203417999e-08
Epoch-22 lr: 6.426669203417999e-08
epoch 22 training time: 15.157
---------------
2023-09-24 16:20:41.677384
current #epochs=23, #steps=858
start validation
acc: 0.746479
AUC: 0.905546
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858015
train_loss: 0.064122
valid_loss: 1.333344
validation finished
normal learning rate scheduler step
Epoch-23 lr: 4.7222727209787986e-08
Epoch-23 lr: 4.7222727209787986e-08
epoch 23 training time: 15.142
---------------
2023-09-24 16:20:56.819518
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01389	Per Sample Data Time 0.00795	Per Sample DNN Time 0.00594	Train Loss 0.0416	
start validation
acc: 0.746479
AUC: 0.905546
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858015
train_loss: 0.079135
valid_loss: 1.333344
validation finished
normal learning rate scheduler step
Epoch-24 lr: 3.469893804311636e-08
Epoch-24 lr: 3.469893804311636e-08
epoch 24 training time: 15.025
---------------
2023-09-24 16:21:11.844815
current #epochs=25, #steps=936
start validation
acc: 0.746479
AUC: 0.905546
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858015
train_loss: 0.052870
valid_loss: 1.333343
validation finished
normal learning rate scheduler step
Epoch-25 lr: 2.549654313634109e-08
Epoch-25 lr: 2.549654313634109e-08
epoch 25 training time: 15.189
---------------
2023-09-24 16:21:27.034426
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00693	Per Sample Data Time 0.00132	Per Sample DNN Time 0.00561	Train Loss 0.0563	
start validation
acc: 0.746479
AUC: 0.905546
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858015
train_loss: 0.053201
valid_loss: 1.333343
validation finished
normal learning rate scheduler step
Epoch-26 lr: 1.873468609026393e-08
Epoch-26 lr: 1.873468609026393e-08
epoch 26 training time: 15.195
---------------
2023-09-24 16:21:42.229681
current #epochs=27, #steps=1014
start validation
acc: 0.746479
AUC: 0.905546
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858015
train_loss: 0.057115
valid_loss: 1.333343
validation finished
normal learning rate scheduler step
Epoch-27 lr: 1.3766119627427179e-08
Epoch-27 lr: 1.3766119627427179e-08
epoch 27 training time: 15.068
---------------
2023-09-24 16:21:57.297700
current #epochs=28, #steps=1053
start validation
acc: 0.746479
AUC: 0.905546
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858015
train_loss: 0.044744
valid_loss: 1.333343
validation finished
normal learning rate scheduler step
Epoch-28 lr: 1.0115250860547836e-08
Epoch-28 lr: 1.0115250860547836e-08
epoch 28 training time: 15.169
---------------
2023-09-24 16:22:12.467030
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00944	Per Sample Data Time 0.00352	Per Sample DNN Time 0.00592	Train Loss 0.0562	
start validation
acc: 0.746479
AUC: 0.905546
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858015
train_loss: 0.055622
valid_loss: 1.333343
validation finished
normal learning rate scheduler step
Epoch-29 lr: 7.432617378099637e-09
Epoch-29 lr: 7.432617378099637e-09
epoch 29 training time: 15.160
---------------
2023-09-24 16:22:27.627323
current #epochs=30, #steps=1131
start validation
acc: 0.746479
AUC: 0.905546
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858015
train_loss: 0.076784
valid_loss: 1.333343
validation finished
normal learning rate scheduler step
Epoch-30 lr: 5.4614365823287895e-09
Epoch-30 lr: 5.4614365823287895e-09
epoch 30 training time: 15.081
---------------
2023-09-24 16:22:42.708138
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00662	Per Sample Data Time 0.00109	Per Sample DNN Time 0.00553	Train Loss 0.0506	
start validation
acc: 0.746479
AUC: 0.905546
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858015
train_loss: 0.050469
valid_loss: 1.333343
validation finished
normal learning rate scheduler step
Epoch-31 lr: 4.013026370856369e-09
Epoch-31 lr: 4.013026370856369e-09
epoch 31 training time: 15.078
---------------
2023-09-24 16:22:57.786303
current #epochs=32, #steps=1209
start validation
acc: 0.746479
AUC: 0.905546
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858015
train_loss: 0.066154
valid_loss: 1.333343
validation finished
normal learning rate scheduler step
Epoch-32 lr: 2.9487444210734816e-09
Epoch-32 lr: 2.9487444210734816e-09
epoch 32 training time: 15.183
---------------
2023-09-24 16:23:12.969714
current #epochs=33, #steps=1248
start validation
acc: 0.746479
AUC: 0.905546
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858015
train_loss: 0.077545
valid_loss: 1.333343
validation finished
normal learning rate scheduler step
Epoch-33 lr: 2.166717299432167e-09
Epoch-33 lr: 2.166717299432167e-09
epoch 33 training time: 15.145
---------------
2023-09-24 16:23:28.114559
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00799	Per Sample Data Time 0.00234	Per Sample DNN Time 0.00565	Train Loss 0.0639	
start validation
acc: 0.746479
AUC: 0.905546
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858015
train_loss: 0.054698
valid_loss: 1.333343
validation finished
normal learning rate scheduler step
Epoch-34 lr: 1.5920891014181368e-09
Epoch-34 lr: 1.5920891014181368e-09
epoch 34 training time: 15.163
---------------
2023-09-24 16:23:43.277474
current #epochs=35, #steps=1326
start validation
acc: 0.746479
AUC: 0.905546
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858015
train_loss: 0.058625
valid_loss: 1.333343
validation finished
normal learning rate scheduler step
Epoch-35 lr: 1.169856218676379e-09
Epoch-35 lr: 1.169856218676379e-09
epoch 35 training time: 16.541
---------------
2023-09-24 16:23:59.818456
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00653	Per Sample Data Time 0.00099	Per Sample DNN Time 0.00554	Train Loss 0.0676	
start validation
acc: 0.746479
AUC: 0.905546
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858015
train_loss: 0.065180
valid_loss: 1.333343
validation finished
normal learning rate scheduler step
Epoch-36 lr: 8.5960237473943e-10
Epoch-36 lr: 8.5960237473943e-10
epoch 36 training time: 15.335
---------------
2023-09-24 16:24:15.153003
current #epochs=37, #steps=1404
start validation
acc: 0.746479
AUC: 0.905546
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858015
train_loss: 0.080974
valid_loss: 1.333343
validation finished
normal learning rate scheduler step
Epoch-37 lr: 6.316299651710243e-10
Epoch-37 lr: 6.316299651710243e-10
epoch 37 training time: 15.192
---------------
2023-09-24 16:24:30.344724
current #epochs=38, #steps=1443
start validation
acc: 0.746479
AUC: 0.905546
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858015
train_loss: 0.049252
valid_loss: 1.333343
validation finished
normal learning rate scheduler step
Epoch-38 lr: 4.641173926757525e-10
Epoch-38 lr: 4.641173926757525e-10
epoch 38 training time: 15.235
---------------
2023-09-24 16:24:45.580098
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00739	Per Sample Data Time 0.00175	Per Sample DNN Time 0.00564	Train Loss 0.0679	
start validation
acc: 0.746479
AUC: 0.905546
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858015
train_loss: 0.064370
valid_loss: 1.333343
validation finished
normal learning rate scheduler step
Epoch-39 lr: 3.4103029631568255e-10
Epoch-39 lr: 3.4103029631568255e-10
epoch 39 training time: 15.234
---------------
2023-09-24 16:25:00.813889
current #epochs=40, #steps=1521
start validation
acc: 0.746479
AUC: 0.905546
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858015
train_loss: 0.049841
valid_loss: 1.333343
validation finished
normal learning rate scheduler step
Epoch-40 lr: 2.5058673697758695e-10
Epoch-40 lr: 2.5058673697758695e-10
epoch 40 training time: 15.139
---------------
2023-09-24 16:25:15.952682
current #epochs=41, #steps=1560
start validation
acc: 0.746479
AUC: 0.905546
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858015
train_loss: 0.054794
valid_loss: 1.333343
validation finished
normal learning rate scheduler step
Epoch-41 lr: 1.8412942611687466e-10
Epoch-41 lr: 1.8412942611687466e-10
epoch 41 training time: 15.582
---------------
2023-09-24 16:25:31.534681
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02229	Per Sample Data Time 0.01554	Per Sample DNN Time 0.00674	Train Loss 0.0779	
start validation
[I 2023-09-24 16:25:46,706] Trial 43 finished with value: 0.4937000872951694 and parameters: {'warmup': 'True', 'num_epochs': 42, 'batch_size': 51, 'lr-adaptschedule': 'True', 'lr': 1.6482148077076997e-05, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7347931831417862}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.746479
AUC: 0.905546
Avg Precision: 0.493700
Avg Recall: 1.000000
d_prime: 1.858015
train_loss: 0.077005
valid_loss: 1.333343
validation finished
normal learning rate scheduler step
Epoch-42 lr: 1.3529704712648868e-10
Epoch-42 lr: 1.3529704712648868e-10
epoch 42 training time: 15.162
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f5471f0>
The learning rate scheduler starts at 4 epoch with decay rate of 0.704 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 16:25:46.741056
current #epochs=1, #steps=0
start validation
acc: 0.732394
AUC: 0.901438
Avg Precision: 0.482547
Avg Recall: 1.000000
d_prime: 1.824034
train_loss: 0.065888
valid_loss: 1.338021
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.000256608069776741
Epoch-1 lr: 0.000256608069776741
epoch 1 training time: 18.699
---------------
2023-09-24 16:26:05.440526
current #epochs=2, #steps=39
start validation
acc: 0.737089
AUC: 0.899565
Avg Precision: 0.488420
Avg Recall: 1.000000
d_prime: 1.808887
train_loss: 0.080745
valid_loss: 1.335053
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.000256608069776741
Epoch-2 lr: 0.000256608069776741
epoch 2 training time: 17.654
---------------
2023-09-24 16:26:23.094379
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00559	Train Loss 0.0604	
start validation
acc: 0.737089
AUC: 0.903485
Avg Precision: 0.490799
Avg Recall: 1.000000
d_prime: 1.840840
train_loss: 0.056665
valid_loss: 1.334544
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.000256608069776741
Epoch-3 lr: 0.000256608069776741
epoch 3 training time: 15.643
---------------
2023-09-24 16:26:38.737813
current #epochs=4, #steps=117
start validation
acc: 0.746479
AUC: 0.907465
Avg Precision: 0.491067
Avg Recall: 1.000000
d_prime: 1.874268
train_loss: 0.049665
valid_loss: 1.320264
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00018053456793194614
Epoch-4 lr: 0.00018053456793194614
epoch 4 training time: 17.605
---------------
2023-09-24 16:26:56.343158
current #epochs=5, #steps=156
start validation
acc: 0.751174
AUC: 0.907446
Avg Precision: 0.484611
Avg Recall: 1.000000
d_prime: 1.874101
train_loss: 0.060640
valid_loss: 1.323604
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00018053456793194614
Epoch-5 lr: 0.00018053456793194614
epoch 5 training time: 17.693
---------------
2023-09-24 16:27:14.035804
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01135	Per Sample Data Time 0.00525	Per Sample DNN Time 0.00610	Train Loss 0.0581	
start validation
acc: 0.751174
AUC: 0.910117
Avg Precision: 0.487805
Avg Recall: 1.000000
d_prime: 1.897137
train_loss: 0.074169
valid_loss: 1.327855
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00018053456793194614
Epoch-6 lr: 0.00018053456793194614
epoch 6 training time: 15.282
---------------
2023-09-24 16:27:29.318269
current #epochs=7, #steps=234
start validation
acc: 0.755869
AUC: 0.910080
Avg Precision: 0.491878
Avg Recall: 1.000000
d_prime: 1.896812
train_loss: 0.052196
valid_loss: 1.327953
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00012701366035265928
Epoch-7 lr: 0.00012701366035265928
epoch 7 training time: 17.706
---------------
2023-09-24 16:27:47.024512
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00681	Per Sample Data Time 0.00122	Per Sample DNN Time 0.00559	Train Loss 0.0574	
start validation
acc: 0.755869
AUC: 0.907115
Avg Precision: 0.491652
Avg Recall: 1.000000
d_prime: 1.871282
train_loss: 0.055598
valid_loss: 1.331030
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00012701366035265928
Epoch-8 lr: 0.00012701366035265928
epoch 8 training time: 15.142
---------------
2023-09-24 16:28:02.166904
current #epochs=9, #steps=312
start validation
acc: 0.765258
AUC: 0.906655
Avg Precision: 0.503786
Avg Recall: 1.000000
d_prime: 1.867373
train_loss: 0.064791
valid_loss: 1.331874
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00012701366035265928
Epoch-9 lr: 0.00012701366035265928
epoch 9 training time: 17.548
---------------
2023-09-24 16:28:19.714753
current #epochs=10, #steps=351
start validation
acc: 0.746479
AUC: 0.904100
Avg Precision: 0.485297
Avg Recall: 1.000000
d_prime: 1.845931
train_loss: 0.074004
valid_loss: 1.336160
validation finished
normal learning rate scheduler step
Epoch-10 lr: 8.935945121746406e-05
Epoch-10 lr: 8.935945121746406e-05
epoch 10 training time: 15.117
---------------
2023-09-24 16:28:34.831180
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00869	Per Sample Data Time 0.00292	Per Sample DNN Time 0.00577	Train Loss 0.0508	
start validation
acc: 0.741784
AUC: 0.904750
Avg Precision: 0.485799
Avg Recall: 1.000000
d_prime: 1.851347
train_loss: 0.048968
valid_loss: 1.334101
validation finished
normal learning rate scheduler step
Epoch-11 lr: 8.935945121746406e-05
Epoch-11 lr: 8.935945121746406e-05
epoch 11 training time: 15.153
---------------
2023-09-24 16:28:49.984832
current #epochs=12, #steps=429
start validation
acc: 0.765258
AUC: 0.903358
Avg Precision: 0.482417
Avg Recall: 1.000000
d_prime: 1.839783
train_loss: 0.064713
valid_loss: 1.335522
validation finished
normal learning rate scheduler step
Epoch-12 lr: 8.935945121746406e-05
Epoch-12 lr: 8.935945121746406e-05
epoch 12 training time: 15.082
---------------
2023-09-24 16:29:05.066497
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00660	Per Sample Data Time 0.00105	Per Sample DNN Time 0.00555	Train Loss 0.0524	
start validation
acc: 0.760563
AUC: 0.902779
Avg Precision: 0.482153
Avg Recall: 1.000000
d_prime: 1.835012
train_loss: 0.048685
valid_loss: 1.335531
validation finished
normal learning rate scheduler step
Epoch-13 lr: 6.286813166170718e-05
Epoch-13 lr: 6.286813166170718e-05
epoch 13 training time: 15.153
---------------
2023-09-24 16:29:20.219106
current #epochs=14, #steps=507
start validation
acc: 0.755869
AUC: 0.902341
Avg Precision: 0.490415
Avg Recall: 1.000000
d_prime: 1.831417
train_loss: 0.049872
valid_loss: 1.334596
validation finished
normal learning rate scheduler step
Epoch-14 lr: 6.286813166170718e-05
Epoch-14 lr: 6.286813166170718e-05
epoch 14 training time: 15.079
---------------
2023-09-24 16:29:35.298011
current #epochs=15, #steps=546
start validation
acc: 0.755869
AUC: 0.903360
Avg Precision: 0.492417
Avg Recall: 1.000000
d_prime: 1.839805
train_loss: 0.062795
valid_loss: 1.334244
validation finished
normal learning rate scheduler step
Epoch-15 lr: 6.286813166170718e-05
Epoch-15 lr: 6.286813166170718e-05
epoch 15 training time: 15.138
---------------
2023-09-24 16:29:50.435599
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00771	Per Sample Data Time 0.00197	Per Sample DNN Time 0.00573	Train Loss 0.0668	
start validation
acc: 0.746479
AUC: 0.904193
Avg Precision: 0.488919
Avg Recall: 1.000000
d_prime: 1.846711
train_loss: 0.070624
valid_loss: 1.334297
validation finished
normal learning rate scheduler step
Epoch-16 lr: 4.423037434524113e-05
Epoch-16 lr: 4.423037434524113e-05
epoch 16 training time: 15.220
---------------
2023-09-24 16:30:05.656444
current #epochs=17, #steps=624
start validation
acc: 0.746479
AUC: 0.903486
Avg Precision: 0.489027
Avg Recall: 1.000000
d_prime: 1.840847
train_loss: 0.070606
valid_loss: 1.334982
validation finished
normal learning rate scheduler step
Epoch-17 lr: 4.423037434524113e-05
Epoch-17 lr: 4.423037434524113e-05
epoch 17 training time: 15.058
---------------
2023-09-24 16:30:20.714046
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00646	Per Sample Data Time 0.00092	Per Sample DNN Time 0.00554	Train Loss 0.0760	
start validation
acc: 0.746479
AUC: 0.903089
Avg Precision: 0.488603
Avg Recall: 1.000000
d_prime: 1.837570
train_loss: 0.075747
valid_loss: 1.335490
validation finished
normal learning rate scheduler step
Epoch-18 lr: 4.423037434524113e-05
Epoch-18 lr: 4.423037434524113e-05
epoch 18 training time: 15.051
---------------
2023-09-24 16:30:35.764703
current #epochs=19, #steps=702
start validation
acc: 0.751174
AUC: 0.904794
Avg Precision: 0.490432
Avg Recall: 1.000000
d_prime: 1.851716
train_loss: 0.070461
valid_loss: 1.333776
validation finished
normal learning rate scheduler step
Epoch-19 lr: 3.11179283209359e-05
Epoch-19 lr: 3.11179283209359e-05
epoch 19 training time: 15.253
---------------
2023-09-24 16:30:51.017985
current #epochs=20, #steps=741
start validation
acc: 0.755869
AUC: 0.904703
Avg Precision: 0.490999
Avg Recall: 1.000000
d_prime: 1.850954
train_loss: 0.058340
valid_loss: 1.334403
validation finished
normal learning rate scheduler step
Epoch-20 lr: 3.11179283209359e-05
Epoch-20 lr: 3.11179283209359e-05
epoch 20 training time: 15.165
---------------
2023-09-24 16:31:06.183319
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00558	Train Loss 0.0608	
start validation
acc: 0.755869
AUC: 0.904841
Avg Precision: 0.491485
Avg Recall: 1.000000
d_prime: 1.852110
train_loss: 0.054514
valid_loss: 1.334583
validation finished
normal learning rate scheduler step
Epoch-21 lr: 3.11179283209359e-05
Epoch-21 lr: 3.11179283209359e-05
epoch 21 training time: 15.077
---------------
2023-09-24 16:31:21.260218
current #epochs=22, #steps=819
start validation
acc: 0.755869
AUC: 0.904458
Avg Precision: 0.491193
Avg Recall: 1.000000
d_prime: 1.848911
train_loss: 0.057711
valid_loss: 1.334880
validation finished
normal learning rate scheduler step
Epoch-22 lr: 2.189277114022638e-05
Epoch-22 lr: 2.189277114022638e-05
epoch 22 training time: 15.093
---------------
2023-09-24 16:31:36.353491
current #epochs=23, #steps=858
start validation
acc: 0.746479
AUC: 0.904380
Avg Precision: 0.491307
Avg Recall: 1.000000
d_prime: 1.848266
train_loss: 0.063964
valid_loss: 1.335264
validation finished
normal learning rate scheduler step
Epoch-23 lr: 2.189277114022638e-05
Epoch-23 lr: 2.189277114022638e-05
epoch 23 training time: 15.161
---------------
2023-09-24 16:31:51.514557
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01406	Per Sample Data Time 0.00753	Per Sample DNN Time 0.00653	Train Loss 0.0735	
start validation
acc: 0.746479
AUC: 0.904636
Avg Precision: 0.490921
Avg Recall: 1.000000
d_prime: 1.850397
train_loss: 0.061351
valid_loss: 1.335292
validation finished
normal learning rate scheduler step
Epoch-24 lr: 2.189277114022638e-05
Epoch-24 lr: 2.189277114022638e-05
epoch 24 training time: 15.231
---------------
2023-09-24 16:32:06.744902
current #epochs=25, #steps=936
start validation
acc: 0.755869
AUC: 0.904470
Avg Precision: 0.491503
Avg Recall: 1.000000
d_prime: 1.849017
train_loss: 0.050802
valid_loss: 1.335388
validation finished
normal learning rate scheduler step
Epoch-25 lr: 1.5402485128673052e-05
Epoch-25 lr: 1.5402485128673052e-05
epoch 25 training time: 15.557
---------------
2023-09-24 16:32:22.302425
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00691	Per Sample Data Time 0.00131	Per Sample DNN Time 0.00560	Train Loss 0.0503	
start validation
acc: 0.741784
AUC: 0.904609
Avg Precision: 0.491107
Avg Recall: 1.000000
d_prime: 1.850171
train_loss: 0.050510
valid_loss: 1.334856
validation finished
normal learning rate scheduler step
Epoch-26 lr: 1.5402485128673052e-05
Epoch-26 lr: 1.5402485128673052e-05
epoch 26 training time: 15.568
---------------
2023-09-24 16:32:37.871091
current #epochs=27, #steps=1014
start validation
acc: 0.741784
AUC: 0.904605
Avg Precision: 0.491306
Avg Recall: 1.000000
d_prime: 1.850140
train_loss: 0.063200
valid_loss: 1.334552
validation finished
normal learning rate scheduler step
Epoch-27 lr: 1.5402485128673052e-05
Epoch-27 lr: 1.5402485128673052e-05
epoch 27 training time: 15.235
---------------
2023-09-24 16:32:53.105444
current #epochs=28, #steps=1053
start validation
acc: 0.741784
AUC: 0.904895
Avg Precision: 0.491703
Avg Recall: 1.000000
d_prime: 1.852564
train_loss: 0.045156
valid_loss: 1.334277
validation finished
normal learning rate scheduler step
Epoch-28 lr: 1.0836295991012739e-05
Epoch-28 lr: 1.0836295991012739e-05
epoch 28 training time: 15.142
---------------
2023-09-24 16:33:08.247367
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00945	Per Sample Data Time 0.00352	Per Sample DNN Time 0.00593	Train Loss 0.0614	
start validation
acc: 0.755869
AUC: 0.905197
Avg Precision: 0.491703
Avg Recall: 1.000000
d_prime: 1.855092
train_loss: 0.061824
valid_loss: 1.333504
validation finished
normal learning rate scheduler step
Epoch-29 lr: 1.0836295991012739e-05
Epoch-29 lr: 1.0836295991012739e-05
epoch 29 training time: 15.157
---------------
2023-09-24 16:33:23.404815
current #epochs=30, #steps=1131
start validation
acc: 0.746479
AUC: 0.904653
Avg Precision: 0.491590
Avg Recall: 1.000000
d_prime: 1.850539
train_loss: 0.048256
valid_loss: 1.333344
validation finished
normal learning rate scheduler step
Epoch-30 lr: 1.0836295991012739e-05
Epoch-30 lr: 1.0836295991012739e-05
epoch 30 training time: 15.244
---------------
2023-09-24 16:33:38.649301
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00672	Per Sample Data Time 0.00111	Per Sample DNN Time 0.00560	Train Loss 0.0551	
start validation
acc: 0.746479
AUC: 0.904762
Avg Precision: 0.491703
Avg Recall: 1.000000
d_prime: 1.851447
train_loss: 0.057209
valid_loss: 1.333535
validation finished
normal learning rate scheduler step
Epoch-31 lr: 7.623789915968912e-06
Epoch-31 lr: 7.623789915968912e-06
epoch 31 training time: 15.126
---------------
2023-09-24 16:33:53.775006
current #epochs=32, #steps=1209
start validation
acc: 0.746479
AUC: 0.904765
Avg Precision: 0.491703
Avg Recall: 1.000000
d_prime: 1.851470
train_loss: 0.054872
valid_loss: 1.333363
validation finished
normal learning rate scheduler step
Epoch-32 lr: 7.623789915968912e-06
Epoch-32 lr: 7.623789915968912e-06
epoch 32 training time: 15.078
---------------
2023-09-24 16:34:08.853094
current #epochs=33, #steps=1248
start validation
acc: 0.746479
AUC: 0.904815
Avg Precision: 0.491703
Avg Recall: 1.000000
d_prime: 1.851890
train_loss: 0.056861
valid_loss: 1.333254
validation finished
normal learning rate scheduler step
Epoch-33 lr: 7.623789915968912e-06
Epoch-33 lr: 7.623789915968912e-06
epoch 33 training time: 15.118
---------------
2023-09-24 16:34:23.971135
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00796	Per Sample Data Time 0.00230	Per Sample DNN Time 0.00566	Train Loss 0.0498	
start validation
acc: 0.746479
AUC: 0.904871
Avg Precision: 0.491703
Avg Recall: 1.000000
d_prime: 1.852360
train_loss: 0.058275
valid_loss: 1.333326
validation finished
normal learning rate scheduler step
Epoch-34 lr: 5.363656800352616e-06
Epoch-34 lr: 5.363656800352616e-06
epoch 34 training time: 15.117
---------------
2023-09-24 16:34:39.088762
current #epochs=35, #steps=1326
start validation
acc: 0.741784
AUC: 0.904860
Avg Precision: 0.492104
Avg Recall: 1.000000
d_prime: 1.852272
train_loss: 0.050261
valid_loss: 1.333352
validation finished
normal learning rate scheduler step
Epoch-35 lr: 5.363656800352616e-06
Epoch-35 lr: 5.363656800352616e-06
epoch 35 training time: 15.164
---------------
2023-09-24 16:34:54.252442
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00650	Per Sample Data Time 0.00097	Per Sample DNN Time 0.00552	Train Loss 0.0580	
start validation
acc: 0.741784
AUC: 0.904917
Avg Precision: 0.492104
Avg Recall: 1.000000
d_prime: 1.852748
train_loss: 0.061509
valid_loss: 1.333175
validation finished
normal learning rate scheduler step
Epoch-36 lr: 5.363656800352616e-06
Epoch-36 lr: 5.363656800352616e-06
epoch 36 training time: 14.997
---------------
2023-09-24 16:35:09.249812
current #epochs=37, #steps=1404
start validation
acc: 0.741784
AUC: 0.904974
Avg Precision: 0.492104
Avg Recall: 1.000000
d_prime: 1.853220
train_loss: 0.056285
valid_loss: 1.333093
validation finished
normal learning rate scheduler step
Epoch-37 lr: 3.7735581107382367e-06
Epoch-37 lr: 3.7735581107382367e-06
epoch 37 training time: 15.252
---------------
2023-09-24 16:35:24.501878
current #epochs=38, #steps=1443
start validation
acc: 0.741784
AUC: 0.905084
Avg Precision: 0.492104
Avg Recall: 1.000000
d_prime: 1.854142
train_loss: 0.054897
valid_loss: 1.332969
validation finished
normal learning rate scheduler step
Epoch-38 lr: 3.7735581107382367e-06
Epoch-38 lr: 3.7735581107382367e-06
epoch 38 training time: 15.165
---------------
2023-09-24 16:35:39.666813
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00733	Per Sample Data Time 0.00168	Per Sample DNN Time 0.00565	Train Loss 0.0629	
start validation
acc: 0.746479
AUC: 0.904924
Avg Precision: 0.491708
Avg Recall: 1.000000
d_prime: 1.852807
train_loss: 0.058131
valid_loss: 1.333025
validation finished
normal learning rate scheduler step
Epoch-39 lr: 3.7735581107382367e-06
Epoch-39 lr: 3.7735581107382367e-06
epoch 39 training time: 15.169
---------------
2023-09-24 16:35:54.835917
current #epochs=40, #steps=1521
start validation
acc: 0.746479
AUC: 0.904932
Avg Precision: 0.491905
Avg Recall: 1.000000
d_prime: 1.852871
train_loss: 0.063347
valid_loss: 1.332989
validation finished
normal learning rate scheduler step
Epoch-40 lr: 2.6548568160032507e-06
Epoch-40 lr: 2.6548568160032507e-06
epoch 40 training time: 15.146
---------------
2023-09-24 16:36:09.982122
current #epochs=41, #steps=1560
start validation
acc: 0.741784
AUC: 0.904846
Avg Precision: 0.491905
Avg Recall: 1.000000
d_prime: 1.852148
train_loss: 0.045039
valid_loss: 1.333027
validation finished
normal learning rate scheduler step
Epoch-41 lr: 2.6548568160032507e-06
Epoch-41 lr: 2.6548568160032507e-06
epoch 41 training time: 15.190
---------------
2023-09-24 16:36:25.172223
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02163	Per Sample Data Time 0.01509	Per Sample DNN Time 0.00654	Train Loss 0.0502	
start validation
[I 2023-09-24 16:36:40,359] Trial 44 finished with value: 0.49190479848590646 and parameters: {'warmup': 'True', 'num_epochs': 42, 'batch_size': 59, 'lr-adaptschedule': 'True', 'lr': 0.000256608069776741, 'head-lr': 1, 'lr-scheduler-start': 4, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.7035420518498045}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.746479
AUC: 0.904842
Avg Precision: 0.491905
Avg Recall: 1.000000
d_prime: 1.852120
train_loss: 0.057060
valid_loss: 1.332914
validation finished
normal learning rate scheduler step
Epoch-42 lr: 2.6548568160032507e-06
Epoch-42 lr: 2.6548568160032507e-06
epoch 42 training time: 15.178
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa63ceae9a0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.752 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 16:36:40.394695
current #epochs=1, #steps=0
start validation
acc: 0.746479
AUC: 0.904960
Avg Precision: 0.492020
Avg Recall: 1.000000
d_prime: 1.853101
train_loss: 0.046924
valid_loss: 1.332205
validation finished
normal learning rate scheduler step
Epoch-1 lr: 1.5079355605701145e-05
Epoch-1 lr: 1.5079355605701145e-05
epoch 1 training time: 18.148
---------------
2023-09-24 16:36:58.543235
current #epochs=2, #steps=39
start validation
acc: 0.741784
AUC: 0.904842
Avg Precision: 0.491117
Avg Recall: 1.000000
d_prime: 1.852117
train_loss: 0.057728
valid_loss: 1.331526
validation finished
normal learning rate scheduler step
Epoch-2 lr: 1.5079355605701145e-05
Epoch-2 lr: 1.5079355605701145e-05
epoch 2 training time: 15.140
---------------
2023-09-24 16:37:13.683411
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00563	Train Loss 0.0583	
start validation
acc: 0.741784
AUC: 0.904297
Avg Precision: 0.491117
Avg Recall: 1.000000
d_prime: 1.847573
train_loss: 0.059996
valid_loss: 1.332570
validation finished
normal learning rate scheduler step
Epoch-3 lr: 1.5079355605701145e-05
Epoch-3 lr: 1.5079355605701145e-05
epoch 3 training time: 16.011
---------------
2023-09-24 16:37:29.694397
current #epochs=4, #steps=117
start validation
acc: 0.741784
AUC: 0.904843
Avg Precision: 0.491409
Avg Recall: 1.000000
d_prime: 1.852124
train_loss: 0.053931
valid_loss: 1.331882
validation finished
normal learning rate scheduler step
Epoch-4 lr: 1.5079355605701145e-05
Epoch-4 lr: 1.5079355605701145e-05
epoch 4 training time: 15.113
---------------
2023-09-24 16:37:44.806944
current #epochs=5, #steps=156
start validation
acc: 0.755869
AUC: 0.905234
Avg Precision: 0.491252
Avg Recall: 1.000000
d_prime: 1.855396
train_loss: 0.076377
valid_loss: 1.332221
validation finished
normal learning rate scheduler step
Epoch-5 lr: 1.5079355605701145e-05
Epoch-5 lr: 1.5079355605701145e-05
epoch 5 training time: 17.528
---------------
2023-09-24 16:38:02.335062
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01121	Per Sample Data Time 0.00508	Per Sample DNN Time 0.00613	Train Loss 0.0473	
start validation
acc: 0.755869
AUC: 0.905013
Avg Precision: 0.489735
Avg Recall: 1.000000
d_prime: 1.853550
train_loss: 0.058619
valid_loss: 1.332776
validation finished
normal learning rate scheduler step
Epoch-6 lr: 1.134004312620532e-05
Epoch-6 lr: 1.134004312620532e-05
epoch 6 training time: 15.260
---------------
2023-09-24 16:38:17.595662
current #epochs=7, #steps=234
start validation
acc: 0.755869
AUC: 0.905032
Avg Precision: 0.490184
Avg Recall: 1.000000
d_prime: 1.853708
train_loss: 0.065491
valid_loss: 1.332872
validation finished
normal learning rate scheduler step
Epoch-7 lr: 8.527988958333021e-06
Epoch-7 lr: 8.527988958333021e-06
epoch 7 training time: 15.201
---------------
2023-09-24 16:38:32.796567
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00684	Per Sample Data Time 0.00122	Per Sample DNN Time 0.00561	Train Loss 0.0804	
start validation
acc: 0.755869
AUC: 0.904995
Avg Precision: 0.490060
Avg Recall: 1.000000
d_prime: 1.853395
train_loss: 0.068305
valid_loss: 1.332517
validation finished
normal learning rate scheduler step
Epoch-8 lr: 6.413255652034384e-06
Epoch-8 lr: 6.413255652034384e-06
epoch 8 training time: 15.242
---------------
2023-09-24 16:38:48.038003
current #epochs=9, #steps=312
start validation
acc: 0.755869
AUC: 0.905139
Avg Precision: 0.489544
Avg Recall: 1.000000
d_prime: 1.854599
train_loss: 0.062961
valid_loss: 1.332349
validation finished
normal learning rate scheduler step
Epoch-9 lr: 4.822924637837557e-06
Epoch-9 lr: 4.822924637837557e-06
epoch 9 training time: 15.515
---------------
2023-09-24 16:39:03.553470
current #epochs=10, #steps=351
start validation
acc: 0.755869
AUC: 0.905043
Avg Precision: 0.489168
Avg Recall: 1.000000
d_prime: 1.853799
train_loss: 0.061312
valid_loss: 1.332338
validation finished
normal learning rate scheduler step
Epoch-10 lr: 3.626956934873149e-06
Epoch-10 lr: 3.626956934873149e-06
epoch 10 training time: 15.059
---------------
2023-09-24 16:39:18.612413
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00872	Per Sample Data Time 0.00292	Per Sample DNN Time 0.00580	Train Loss 0.0563	
start validation
acc: 0.755869
AUC: 0.905245
Avg Precision: 0.489168
Avg Recall: 1.000000
d_prime: 1.855488
train_loss: 0.062042
valid_loss: 1.332358
validation finished
normal learning rate scheduler step
Epoch-11 lr: 2.7275600585213836e-06
Epoch-11 lr: 2.7275600585213836e-06
epoch 11 training time: 16.094
---------------
2023-09-24 16:39:34.706531
current #epochs=12, #steps=429
start validation
acc: 0.755869
AUC: 0.905328
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.856186
train_loss: 0.051922
valid_loss: 1.332330
validation finished
normal learning rate scheduler step
Epoch-12 lr: 2.051191675674354e-06
Epoch-12 lr: 2.051191675674354e-06
epoch 12 training time: 15.221
---------------
2023-09-24 16:39:49.927129
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00658	Per Sample Data Time 0.00103	Per Sample DNN Time 0.00556	Train Loss 0.0634	
start validation
acc: 0.755869
AUC: 0.905330
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.856202
train_loss: 0.062270
valid_loss: 1.332312
validation finished
normal learning rate scheduler step
Epoch-13 lr: 1.5425461585020417e-06
Epoch-13 lr: 1.5425461585020417e-06
epoch 13 training time: 15.153
---------------
2023-09-24 16:40:05.079495
current #epochs=14, #steps=507
start validation
acc: 0.755869
AUC: 0.905237
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.855428
train_loss: 0.061209
valid_loss: 1.332276
validation finished
normal learning rate scheduler step
Epoch-14 lr: 1.1600323262462215e-06
Epoch-14 lr: 1.1600323262462215e-06
epoch 14 training time: 15.374
---------------
2023-09-24 16:40:20.453066
current #epochs=15, #steps=546
start validation
acc: 0.755869
AUC: 0.905288
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.855850
train_loss: 0.048692
valid_loss: 1.332320
validation finished
normal learning rate scheduler step
Epoch-15 lr: 8.723725967740232e-07
Epoch-15 lr: 8.723725967740232e-07
epoch 15 training time: 15.147
---------------
2023-09-24 16:40:35.600562
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00758	Per Sample Data Time 0.00197	Per Sample DNN Time 0.00560	Train Loss 0.0537	
start validation
acc: 0.755869
AUC: 0.905367
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.856513
train_loss: 0.061021
valid_loss: 1.332309
validation finished
normal learning rate scheduler step
Epoch-16 lr: 6.56045465616378e-07
Epoch-16 lr: 6.56045465616378e-07
epoch 16 training time: 15.040
---------------
2023-09-24 16:40:50.640965
current #epochs=17, #steps=624
start validation
acc: 0.755869
AUC: 0.905402
Avg Precision: 0.489735
Avg Recall: 1.000000
d_prime: 1.856809
train_loss: 0.082871
valid_loss: 1.332298
validation finished
normal learning rate scheduler step
Epoch-17 lr: 4.933621878396744e-07
Epoch-17 lr: 4.933621878396744e-07
epoch 17 training time: 15.079
---------------
2023-09-24 16:41:05.719898
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00659	Per Sample Data Time 0.00098	Per Sample DNN Time 0.00561	Train Loss 0.0714	
start validation
acc: 0.755869
AUC: 0.905460
Avg Precision: 0.489735
Avg Recall: 1.000000
d_prime: 1.857295
train_loss: 0.071345
valid_loss: 1.332281
validation finished
normal learning rate scheduler step
Epoch-18 lr: 3.710203959130506e-07
Epoch-18 lr: 3.710203959130506e-07
epoch 18 training time: 15.771
---------------
2023-09-24 16:41:21.490907
current #epochs=19, #steps=702
start validation
acc: 0.755869
AUC: 0.905453
Avg Precision: 0.489735
Avg Recall: 1.000000
d_prime: 1.857234
train_loss: 0.072955
valid_loss: 1.332273
validation finished
normal learning rate scheduler step
Epoch-19 lr: 2.790163850745089e-07
Epoch-19 lr: 2.790163850745089e-07
epoch 19 training time: 15.054
---------------
2023-09-24 16:41:36.544605
current #epochs=20, #steps=741
start validation
acc: 0.755869
AUC: 0.905453
Avg Precision: 0.489735
Avg Recall: 1.000000
d_prime: 1.857234
train_loss: 0.052297
valid_loss: 1.332265
validation finished
normal learning rate scheduler step
Epoch-20 lr: 2.0982712540226761e-07
Epoch-20 lr: 2.0982712540226761e-07
epoch 20 training time: 15.156
---------------
2023-09-24 16:41:51.700289
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00560	Train Loss 0.0414	
start validation
acc: 0.755869
AUC: 0.905453
Avg Precision: 0.489735
Avg Recall: 1.000000
d_prime: 1.857234
train_loss: 0.050882
valid_loss: 1.332265
validation finished
normal learning rate scheduler step
Epoch-21 lr: 1.57795114945747e-07
Epoch-21 lr: 1.57795114945747e-07
epoch 21 training time: 15.081
---------------
2023-09-24 16:42:06.781369
current #epochs=22, #steps=819
start validation
acc: 0.755869
AUC: 0.905453
Avg Precision: 0.489735
Avg Recall: 1.000000
d_prime: 1.857234
train_loss: 0.048661
valid_loss: 1.332264
validation finished
normal learning rate scheduler step
Epoch-22 lr: 1.1866577427968909e-07
Epoch-22 lr: 1.1866577427968909e-07
epoch 22 training time: 15.175
---------------
2023-09-24 16:42:21.956611
current #epochs=23, #steps=858
start validation
acc: 0.755869
AUC: 0.905431
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.857054
train_loss: 0.061612
valid_loss: 1.332266
validation finished
normal learning rate scheduler step
Epoch-23 lr: 8.923955592820243e-08
Epoch-23 lr: 8.923955592820243e-08
epoch 23 training time: 15.488
---------------
2023-09-24 16:42:37.445095
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01381	Per Sample Data Time 0.00776	Per Sample DNN Time 0.00605	Train Loss 0.0496	
start validation
acc: 0.755869
AUC: 0.905431
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.857054
train_loss: 0.051228
valid_loss: 1.332264
validation finished
normal learning rate scheduler step
Epoch-24 lr: 6.711032216831742e-08
Epoch-24 lr: 6.711032216831742e-08
epoch 24 training time: 15.088
---------------
2023-09-24 16:42:52.532482
current #epochs=25, #steps=936
start validation
acc: 0.755869
AUC: 0.905431
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.857054
train_loss: 0.062117
valid_loss: 1.332265
validation finished
normal learning rate scheduler step
Epoch-25 lr: 5.046859875859176e-08
Epoch-25 lr: 5.046859875859176e-08
epoch 25 training time: 15.144
---------------
2023-09-24 16:43:07.676800
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00695	Per Sample Data Time 0.00133	Per Sample DNN Time 0.00562	Train Loss 0.0480	
start validation
acc: 0.755869
AUC: 0.905431
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.857054
train_loss: 0.045176
valid_loss: 1.332266
validation finished
normal learning rate scheduler step
Epoch-26 lr: 3.795361694535566e-08
Epoch-26 lr: 3.795361694535566e-08
epoch 26 training time: 15.148
---------------
2023-09-24 16:43:22.824352
current #epochs=27, #steps=1014
start validation
acc: 0.755869
AUC: 0.905453
Avg Precision: 0.489735
Avg Recall: 1.000000
d_prime: 1.857234
train_loss: 0.058112
valid_loss: 1.332266
validation finished
normal learning rate scheduler step
Epoch-27 lr: 2.854204544344639e-08
Epoch-27 lr: 2.854204544344639e-08
epoch 27 training time: 15.120
---------------
2023-09-24 16:43:37.944048
current #epochs=28, #steps=1053
start validation
acc: 0.755869
AUC: 0.905453
Avg Precision: 0.489735
Avg Recall: 1.000000
d_prime: 1.857234
train_loss: 0.062197
valid_loss: 1.332266
validation finished
normal learning rate scheduler step
Epoch-28 lr: 2.1464314172445334e-08
Epoch-28 lr: 2.1464314172445334e-08
epoch 28 training time: 15.146
---------------
2023-09-24 16:43:53.089919
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00936	Per Sample Data Time 0.00354	Per Sample DNN Time 0.00582	Train Loss 0.0814	
start validation
acc: 0.755869
AUC: 0.905431
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.857054
train_loss: 0.068050
valid_loss: 1.332266
validation finished
normal learning rate scheduler step
Epoch-29 lr: 1.614168766587904e-08
Epoch-29 lr: 1.614168766587904e-08
epoch 29 training time: 15.211
---------------
2023-09-24 16:44:08.300728
current #epochs=30, #steps=1131
start validation
acc: 0.755869
AUC: 0.905431
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.857054
train_loss: 0.071267
valid_loss: 1.332266
validation finished
normal learning rate scheduler step
Epoch-30 lr: 1.213894274047088e-08
Epoch-30 lr: 1.213894274047088e-08
epoch 30 training time: 15.456
---------------
2023-09-24 16:44:23.756969
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00667	Per Sample Data Time 0.00110	Per Sample DNN Time 0.00558	Train Loss 0.0682	
start validation
acc: 0.755869
AUC: 0.905431
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.857054
train_loss: 0.063641
valid_loss: 1.332266
validation finished
normal learning rate scheduler step
Epoch-31 lr: 9.12878094946128e-09
Epoch-31 lr: 9.12878094946128e-09
epoch 31 training time: 15.075
---------------
2023-09-24 16:44:38.831284
current #epochs=32, #steps=1209
start validation
acc: 0.755869
AUC: 0.905431
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.857054
train_loss: 0.052923
valid_loss: 1.332266
validation finished
normal learning rate scheduler step
Epoch-32 lr: 6.8650658797007025e-09
Epoch-32 lr: 6.8650658797007025e-09
epoch 32 training time: 15.261
---------------
2023-09-24 16:44:54.092723
current #epochs=33, #steps=1248
start validation
acc: 0.755869
AUC: 0.905431
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.857054
train_loss: 0.053101
valid_loss: 1.332266
validation finished
normal learning rate scheduler step
Epoch-33 lr: 5.162696946453954e-09
Epoch-33 lr: 5.162696946453954e-09
epoch 33 training time: 15.125
---------------
2023-09-24 16:45:09.218293
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00793	Per Sample Data Time 0.00226	Per Sample DNN Time 0.00567	Train Loss 0.0394	
start validation
acc: 0.755869
AUC: 0.905431
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.857054
train_loss: 0.043966
valid_loss: 1.332266
validation finished
normal learning rate scheduler step
Epoch-34 lr: 3.8824739963146574e-09
Epoch-34 lr: 3.8824739963146574e-09
epoch 34 training time: 15.058
---------------
2023-09-24 16:45:24.276104
current #epochs=35, #steps=1326
start validation
acc: 0.755869
AUC: 0.905431
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.857054
train_loss: 0.054480
valid_loss: 1.332266
validation finished
normal learning rate scheduler step
Epoch-35 lr: 2.9197151195196435e-09
Epoch-35 lr: 2.9197151195196435e-09
epoch 35 training time: 15.230
---------------
2023-09-24 16:45:39.506072
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00649	Per Sample Data Time 0.00096	Per Sample DNN Time 0.00553	Train Loss 0.0527	
start validation
acc: 0.755869
AUC: 0.905431
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.857054
train_loss: 0.051558
valid_loss: 1.332266
validation finished
normal learning rate scheduler step
Epoch-36 lr: 2.1956969672542564e-09
Epoch-36 lr: 2.1956969672542564e-09
epoch 36 training time: 15.176
---------------
2023-09-24 16:45:54.682467
current #epochs=37, #steps=1404
start validation
acc: 0.755869
AUC: 0.905431
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.857054
train_loss: 0.064606
valid_loss: 1.332266
validation finished
normal learning rate scheduler step
Epoch-37 lr: 1.651217661537716e-09
Epoch-37 lr: 1.651217661537716e-09
epoch 37 training time: 15.065
---------------
2023-09-24 16:46:09.747630
current #epochs=38, #steps=1443
start validation
acc: 0.755869
AUC: 0.905431
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.857054
train_loss: 0.044910
valid_loss: 1.332266
validation finished
normal learning rate scheduler step
Epoch-38 lr: 1.2417559464882018e-09
Epoch-38 lr: 1.2417559464882018e-09
epoch 38 training time: 15.034
---------------
2023-09-24 16:46:24.781360
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00751	Per Sample Data Time 0.00173	Per Sample DNN Time 0.00578	Train Loss 0.0631	
start validation
acc: 0.755869
AUC: 0.905431
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.857054
train_loss: 0.054900
valid_loss: 1.332266
validation finished
normal learning rate scheduler step
Epoch-39 lr: 9.338307520298951e-10
Epoch-39 lr: 9.338307520298951e-10
epoch 39 training time: 15.332
---------------
2023-09-24 16:46:40.113084
current #epochs=40, #steps=1521
start validation
acc: 0.755869
AUC: 0.905431
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.857054
train_loss: 0.058486
valid_loss: 1.332266
validation finished
normal learning rate scheduler step
Epoch-40 lr: 7.022634970284838e-10
Epoch-40 lr: 7.022634970284838e-10
epoch 40 training time: 15.823
---------------
2023-09-24 16:46:55.936383
current #epochs=41, #steps=1560
start validation
acc: 0.755869
AUC: 0.905431
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.857054
train_loss: 0.071640
valid_loss: 1.332266
validation finished
normal learning rate scheduler step
Epoch-41 lr: 5.281192744902098e-10
Epoch-41 lr: 5.281192744902098e-10
epoch 41 training time: 15.228
---------------
2023-09-24 16:47:11.163936
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02265	Per Sample Data Time 0.01567	Per Sample DNN Time 0.00699	Train Loss 0.0319	
start validation
acc: 0.755869
AUC: 0.905431
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.857054
train_loss: 0.060428
valid_loss: 1.332266
validation finished
normal learning rate scheduler step
Epoch-42 lr: 3.97158572627267e-10
Epoch-42 lr: 3.97158572627267e-10
epoch 42 training time: 16.058
---------------
2023-09-24 16:47:27.221974
current #epochs=43, #steps=1638
start validation
acc: 0.755869
AUC: 0.905431
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.857054
train_loss: 0.045289
valid_loss: 1.332266
validation finished
normal learning rate scheduler step
Epoch-43 lr: 2.986729313441337e-10
Epoch-43 lr: 2.986729313441337e-10
epoch 43 training time: 15.192
---------------
2023-09-24 16:47:42.414047
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00696	Per Sample Data Time 0.00140	Per Sample DNN Time 0.00556	Train Loss 0.0712	
start validation
acc: 0.755869
AUC: 0.905431
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.857054
train_loss: 0.069142
valid_loss: 1.332266
validation finished
normal learning rate scheduler step
Epoch-44 lr: 2.2460932752272957e-10
Epoch-44 lr: 2.2460932752272957e-10
epoch 44 training time: 15.155
---------------
2023-09-24 16:47:57.568886
current #epochs=45, #steps=1716
start validation
acc: 0.755869
AUC: 0.905431
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.857054
train_loss: 0.062502
valid_loss: 1.332266
validation finished
normal learning rate scheduler step
Epoch-45 lr: 1.6891169140495225e-10
Epoch-45 lr: 1.6891169140495225e-10
epoch 45 training time: 15.062
---------------
2023-09-24 16:48:12.630797
current #epochs=46, #steps=1755
start validation
[I 2023-09-24 16:48:27,844] Trial 45 finished with value: 0.4893599781660451 and parameters: {'warmup': 'True', 'num_epochs': 46, 'batch_size': 49, 'lr-adaptschedule': 'True', 'lr': 1.5079355605701145e-05, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.752024385041886}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.755869
AUC: 0.905431
Avg Precision: 0.489360
Avg Recall: 1.000000
d_prime: 1.857054
train_loss: 0.038486
valid_loss: 1.332266
validation finished
normal learning rate scheduler step
Epoch-46 lr: 1.2702571085519403e-10
Epoch-46 lr: 1.2702571085519403e-10
epoch 46 training time: 15.203
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f581fa0>
The learning rate scheduler starts at 5 epoch with decay rate of 0.764 every 10 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 16:48:27.880580
current #epochs=1, #steps=0
start validation
acc: 0.737089
AUC: 0.898600
Avg Precision: 0.480777
Avg Recall: 1.000000
d_prime: 1.801166
train_loss: 0.065444
valid_loss: 1.337449
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0002523374143672808
Epoch-1 lr: 0.0010093496574691233
epoch 1 training time: 17.655
---------------
2023-09-24 16:48:45.535898
current #epochs=2, #steps=39
start validation
acc: 0.727700
AUC: 0.893799
Avg Precision: 0.486810
Avg Recall: 1.000000
d_prime: 1.763507
train_loss: 0.060112
valid_loss: 1.341774
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0002523374143672808
Epoch-2 lr: 0.0010093496574691233
epoch 2 training time: 15.147
---------------
2023-09-24 16:49:00.683609
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00564	Train Loss 0.0568	
start validation
acc: 0.723005
AUC: 0.899948
Avg Precision: 0.482198
Avg Recall: 1.000000
d_prime: 1.811966
train_loss: 0.057576
valid_loss: 1.334261
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0002523374143672808
Epoch-3 lr: 0.0010093496574691233
epoch 3 training time: 15.425
---------------
2023-09-24 16:49:16.108477
current #epochs=4, #steps=117
start validation
acc: 0.713615
AUC: 0.897024
Avg Precision: 0.487838
Avg Recall: 1.000000
d_prime: 1.788658
train_loss: 0.074008
valid_loss: 1.343993
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0002523374143672808
Epoch-4 lr: 0.0010093496574691233
epoch 4 training time: 15.181
---------------
2023-09-24 16:49:31.288928
current #epochs=5, #steps=156
start validation
acc: 0.751174
AUC: 0.897634
Avg Precision: 0.488030
Avg Recall: 1.000000
d_prime: 1.793486
train_loss: 0.044060
valid_loss: 1.334410
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00019285663680886723
Epoch-5 lr: 0.0007714265472354689
epoch 5 training time: 17.939
---------------
2023-09-24 16:49:49.227495
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01085	Per Sample Data Time 0.00504	Per Sample DNN Time 0.00580	Train Loss 0.0737	
start validation
acc: 0.727700
AUC: 0.898906
Avg Precision: 0.496116
Avg Recall: 1.000000
d_prime: 1.803605
train_loss: 0.065049
valid_loss: 1.332364
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00019285663680886723
Epoch-6 lr: 0.0007714265472354689
epoch 6 training time: 15.100
---------------
2023-09-24 16:50:04.327735
current #epochs=7, #steps=234
start validation
acc: 0.732394
AUC: 0.900238
Avg Precision: 0.496173
Avg Recall: 1.000000
d_prime: 1.814304
train_loss: 0.078313
valid_loss: 1.344447
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00019285663680886723
Epoch-7 lr: 0.0007714265472354689
epoch 7 training time: 15.136
---------------
2023-09-24 16:50:19.463847
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00675	Per Sample Data Time 0.00121	Per Sample DNN Time 0.00554	Train Loss 0.0638	
start validation
acc: 0.713615
AUC: 0.901679
Avg Precision: 0.491273
Avg Recall: 1.000000
d_prime: 1.826005
train_loss: 0.063398
valid_loss: 1.337120
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00019285663680886723
Epoch-8 lr: 0.0007714265472354689
epoch 8 training time: 15.063
---------------
2023-09-24 16:50:34.526806
current #epochs=9, #steps=312
start validation
acc: 0.718310
AUC: 0.902160
Avg Precision: 0.502002
Avg Recall: 1.000000
d_prime: 1.829934
train_loss: 0.055205
valid_loss: 1.337667
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00019285663680886723
Epoch-9 lr: 0.0007714265472354689
epoch 9 training time: 14.936
---------------
2023-09-24 16:50:49.462658
current #epochs=10, #steps=351
start validation
acc: 0.723005
AUC: 0.906430
Avg Precision: 0.502395
Avg Recall: 1.000000
d_prime: 1.865472
train_loss: 0.067326
valid_loss: 1.322315
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00019285663680886723
Epoch-10 lr: 0.0007714265472354689
epoch 10 training time: 15.090
---------------
2023-09-24 16:51:04.553176
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00872	Per Sample Data Time 0.00297	Per Sample DNN Time 0.00575	Train Loss 0.0420	
start validation
acc: 0.727700
AUC: 0.905042
Avg Precision: 0.500465
Avg Recall: 1.000000
d_prime: 1.853788
train_loss: 0.054208
valid_loss: 1.317122
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00019285663680886723
Epoch-11 lr: 0.0007714265472354689
epoch 11 training time: 15.291
---------------
2023-09-24 16:51:19.844477
current #epochs=12, #steps=429
start validation
acc: 0.732394
AUC: 0.903425
Avg Precision: 0.490914
Avg Recall: 1.000000
d_prime: 1.840341
train_loss: 0.047849
valid_loss: 1.329261
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00019285663680886723
Epoch-12 lr: 0.0007714265472354689
epoch 12 training time: 15.085
---------------
2023-09-24 16:51:34.929369
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00671	Per Sample Data Time 0.00109	Per Sample DNN Time 0.00561	Train Loss 0.0500	
start validation
acc: 0.727700
AUC: 0.903569
Avg Precision: 0.482618
Avg Recall: 1.000000
d_prime: 1.841528
train_loss: 0.047983
valid_loss: 1.326961
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00019285663680886723
Epoch-13 lr: 0.0007714265472354689
epoch 13 training time: 15.295
---------------
2023-09-24 16:51:50.224778
current #epochs=14, #steps=507
start validation
acc: 0.727700
AUC: 0.898864
Avg Precision: 0.483682
Avg Recall: 1.000000
d_prime: 1.803269
train_loss: 0.054544
valid_loss: 1.331432
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.00019285663680886723
Epoch-14 lr: 0.0007714265472354689
epoch 14 training time: 15.449
---------------
2023-09-24 16:52:05.673928
current #epochs=15, #steps=546
start validation
acc: 0.723005
AUC: 0.899206
Avg Precision: 0.488110
Avg Recall: 1.000000
d_prime: 1.806009
train_loss: 0.061654
valid_loss: 1.334076
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.00014739662152157655
Epoch-15 lr: 0.0005895864860863062
epoch 15 training time: 15.197
---------------
2023-09-24 16:52:20.871188
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00760	Per Sample Data Time 0.00206	Per Sample DNN Time 0.00555	Train Loss 0.0460	
start validation
acc: 0.732394
AUC: 0.900724
Avg Precision: 0.490783
Avg Recall: 1.000000
d_prime: 1.818239
train_loss: 0.068570
valid_loss: 1.334525
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.00014739662152157655
Epoch-16 lr: 0.0005895864860863062
epoch 16 training time: 15.044
---------------
2023-09-24 16:52:35.915081
current #epochs=17, #steps=624
start validation
acc: 0.727700
AUC: 0.902422
Avg Precision: 0.488188
Avg Recall: 1.000000
d_prime: 1.832076
train_loss: 0.064148
valid_loss: 1.334079
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.00014739662152157655
Epoch-17 lr: 0.0005895864860863062
epoch 17 training time: 15.181
---------------
2023-09-24 16:52:51.096674
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00650	Per Sample Data Time 0.00095	Per Sample DNN Time 0.00555	Train Loss 0.0565	
start validation
acc: 0.741784
AUC: 0.900393
Avg Precision: 0.484328
Avg Recall: 1.000000
d_prime: 1.815558
train_loss: 0.055480
valid_loss: 1.342841
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00014739662152157655
Epoch-18 lr: 0.0005895864860863062
epoch 18 training time: 15.196
---------------
2023-09-24 16:53:06.292380
current #epochs=19, #steps=702
start validation
acc: 0.737089
AUC: 0.902291
Avg Precision: 0.483472
Avg Recall: 1.000000
d_prime: 1.831003
train_loss: 0.054194
valid_loss: 1.343660
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00014739662152157655
Epoch-19 lr: 0.0005895864860863062
epoch 19 training time: 15.121
---------------
2023-09-24 16:53:21.413533
current #epochs=20, #steps=741
start validation
acc: 0.732394
AUC: 0.903116
Avg Precision: 0.484531
Avg Recall: 1.000000
d_prime: 1.837788
train_loss: 0.058912
valid_loss: 1.339334
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00014739662152157655
Epoch-20 lr: 0.0005895864860863062
epoch 20 training time: 15.178
---------------
2023-09-24 16:53:36.591477
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00733	Per Sample Data Time 0.00162	Per Sample DNN Time 0.00572	Train Loss 0.0887	
start validation
acc: 0.727700
AUC: 0.901395
Avg Precision: 0.485542
Avg Recall: 1.000000
d_prime: 1.823690
train_loss: 0.081143
valid_loss: 1.334759
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00014739662152157655
Epoch-21 lr: 0.0005895864860863062
epoch 21 training time: 15.202
---------------
2023-09-24 16:53:51.793296
current #epochs=22, #steps=819
start validation
acc: 0.737089
AUC: 0.897772
Avg Precision: 0.485934
Avg Recall: 1.000000
d_prime: 1.794574
train_loss: 0.060869
valid_loss: 1.337851
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00014739662152157655
Epoch-22 lr: 0.0005895864860863062
epoch 22 training time: 15.050
---------------
2023-09-24 16:54:06.842858
current #epochs=23, #steps=858
start validation
acc: 0.727700
AUC: 0.895388
Avg Precision: 0.483778
Avg Recall: 1.000000
d_prime: 1.775831
train_loss: 0.053799
valid_loss: 1.339630
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00014739662152157655
Epoch-23 lr: 0.0005895864860863062
epoch 23 training time: 14.981
---------------
2023-09-24 16:54:21.824319
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01371	Per Sample Data Time 0.00784	Per Sample DNN Time 0.00587	Train Loss 0.0803	
start validation
acc: 0.746479
AUC: 0.898148
Avg Precision: 0.487591
Avg Recall: 1.000000
d_prime: 1.797561
train_loss: 0.057299
valid_loss: 1.339646
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00014739662152157655
Epoch-24 lr: 0.0005895864860863062
epoch 24 training time: 15.135
---------------
2023-09-24 16:54:36.959733
current #epochs=25, #steps=936
start validation
acc: 0.737089
AUC: 0.899485
Avg Precision: 0.488256
Avg Recall: 1.000000
d_prime: 1.808242
train_loss: 0.057430
valid_loss: 1.341510
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00011265240541089831
Epoch-25 lr: 0.00045060962164359325
epoch 25 training time: 15.159
---------------
2023-09-24 16:54:52.118184
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00690	Per Sample Data Time 0.00136	Per Sample DNN Time 0.00554	Train Loss 0.0396	
start validation
acc: 0.737089
AUC: 0.897690
Avg Precision: 0.494159
Avg Recall: 1.000000
d_prime: 1.793928
train_loss: 0.043141
valid_loss: 1.342708
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00011265240541089831
Epoch-26 lr: 0.00045060962164359325
epoch 26 training time: 15.168
---------------
2023-09-24 16:55:07.286464
current #epochs=27, #steps=1014
start validation
acc: 0.732394
AUC: 0.900036
Avg Precision: 0.495385
Avg Recall: 1.000000
d_prime: 1.812679
train_loss: 0.057997
valid_loss: 1.336876
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00011265240541089831
Epoch-27 lr: 0.00045060962164359325
epoch 27 training time: 15.219
---------------
2023-09-24 16:55:22.505154
current #epochs=28, #steps=1053
start validation
acc: 0.737089
AUC: 0.901145
Avg Precision: 0.495449
Avg Recall: 1.000000
d_prime: 1.821655
train_loss: 0.061280
valid_loss: 1.337165
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00011265240541089831
Epoch-28 lr: 0.00045060962164359325
epoch 28 training time: 15.212
---------------
2023-09-24 16:55:37.717409
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00933	Per Sample Data Time 0.00369	Per Sample DNN Time 0.00564	Train Loss 0.0525	
start validation
acc: 0.737089
AUC: 0.901076
Avg Precision: 0.494825
Avg Recall: 1.000000
d_prime: 1.821090
train_loss: 0.050298
valid_loss: 1.339046
validation finished
normal learning rate scheduler step
Epoch-29 lr: 0.00011265240541089831
Epoch-29 lr: 0.00045060962164359325
epoch 29 training time: 15.084
---------------
2023-09-24 16:55:52.801749
current #epochs=30, #steps=1131
start validation
acc: 0.723005
AUC: 0.901604
Avg Precision: 0.496728
Avg Recall: 1.000000
d_prime: 1.825392
train_loss: 0.071993
valid_loss: 1.338145
validation finished
normal learning rate scheduler step
Epoch-30 lr: 0.00011265240541089831
Epoch-30 lr: 0.00045060962164359325
epoch 30 training time: 15.098
---------------
2023-09-24 16:56:07.900395
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00669	Per Sample Data Time 0.00115	Per Sample DNN Time 0.00555	Train Loss 0.0647	
start validation
acc: 0.741784
AUC: 0.902768
Avg Precision: 0.498796
Avg Recall: 1.000000
d_prime: 1.834925
train_loss: 0.061183
valid_loss: 1.339116
validation finished
normal learning rate scheduler step
Epoch-31 lr: 0.00011265240541089831
Epoch-31 lr: 0.00045060962164359325
epoch 31 training time: 15.251
---------------
2023-09-24 16:56:23.151472
current #epochs=32, #steps=1209
start validation
acc: 0.737089
AUC: 0.902244
Avg Precision: 0.496659
Avg Recall: 1.000000
d_prime: 1.830623
train_loss: 0.063317
valid_loss: 1.340858
validation finished
normal learning rate scheduler step
Epoch-32 lr: 0.00011265240541089831
Epoch-32 lr: 0.00045060962164359325
epoch 32 training time: 15.255
---------------
2023-09-24 16:56:38.406900
current #epochs=33, #steps=1248
start validation
acc: 0.737089
AUC: 0.901611
Avg Precision: 0.496405
Avg Recall: 1.000000
d_prime: 1.825446
train_loss: 0.044627
valid_loss: 1.340605
validation finished
normal learning rate scheduler step
Epoch-33 lr: 0.00011265240541089831
Epoch-33 lr: 0.00045060962164359325
epoch 33 training time: 15.188
---------------
2023-09-24 16:56:53.594403
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00791	Per Sample Data Time 0.00225	Per Sample DNN Time 0.00566	Train Loss 0.0630	
start validation
acc: 0.741784
AUC: 0.899105
Avg Precision: 0.488000
Avg Recall: 1.000000
d_prime: 1.805203
train_loss: 0.058838
valid_loss: 1.338091
validation finished
normal learning rate scheduler step
Epoch-34 lr: 0.00011265240541089831
Epoch-34 lr: 0.00045060962164359325
epoch 34 training time: 15.044
---------------
2023-09-24 16:57:08.637948
current #epochs=35, #steps=1326
start validation
acc: 0.723005
AUC: 0.896757
Avg Precision: 0.485646
Avg Recall: 1.000000
d_prime: 1.786555
train_loss: 0.058464
valid_loss: 1.344209
validation finished
normal learning rate scheduler step
Epoch-35 lr: 8.609806869286818e-05
Epoch-35 lr: 0.0003443922747714727
epoch 35 training time: 15.120
---------------
2023-09-24 16:57:23.758299
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00653	Per Sample Data Time 0.00100	Per Sample DNN Time 0.00553	Train Loss 0.0548	
start validation
acc: 0.727700
AUC: 0.896651
Avg Precision: 0.491769
Avg Recall: 1.000000
d_prime: 1.785723
train_loss: 0.055978
valid_loss: 1.343506
validation finished
normal learning rate scheduler step
Epoch-36 lr: 8.609806869286818e-05
Epoch-36 lr: 0.0003443922747714727
epoch 36 training time: 15.741
---------------
2023-09-24 16:57:39.499196
current #epochs=37, #steps=1404
start validation
acc: 0.723005
AUC: 0.896142
Avg Precision: 0.480512
Avg Recall: 1.000000
d_prime: 1.781728
train_loss: 0.057291
valid_loss: 1.343665
validation finished
normal learning rate scheduler step
Epoch-37 lr: 8.609806869286818e-05
Epoch-37 lr: 0.0003443922747714727
epoch 37 training time: 15.231
---------------
2023-09-24 16:57:54.730529
current #epochs=38, #steps=1443
start validation
acc: 0.723005
AUC: 0.895653
Avg Precision: 0.479145
Avg Recall: 1.000000
d_prime: 1.777898
train_loss: 0.056489
valid_loss: 1.344728
validation finished
normal learning rate scheduler step
Epoch-38 lr: 8.609806869286818e-05
Epoch-38 lr: 0.0003443922747714727
epoch 38 training time: 15.135
---------------
2023-09-24 16:58:09.865297
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00738	Per Sample Data Time 0.00178	Per Sample DNN Time 0.00559	Train Loss 0.0545	
start validation
acc: 0.727700
AUC: 0.894729
Avg Precision: 0.479510
Avg Recall: 1.000000
d_prime: 1.770703
train_loss: 0.050252
valid_loss: 1.345745
validation finished
normal learning rate scheduler step
Epoch-39 lr: 8.609806869286818e-05
Epoch-39 lr: 0.0003443922747714727
epoch 39 training time: 15.122
---------------
2023-09-24 16:58:24.987122
current #epochs=40, #steps=1521
start validation
[I 2023-09-24 16:58:40,080] Trial 46 finished with value: 0.47862204453389734 and parameters: {'warmup': 'True', 'num_epochs': 40, 'batch_size': 54, 'lr-adaptschedule': 'True', 'lr': 0.0002523374143672808, 'head-lr': 4, 'lr-scheduler-start': 5, 'lr-scheduler-step': 10, 'lr-scheduler-decay': 0.7642807836976627}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.718310
AUC: 0.895781
Avg Precision: 0.478622
Avg Recall: 1.000000
d_prime: 1.778898
train_loss: 0.053032
valid_loss: 1.344313
validation finished
normal learning rate scheduler step
Epoch-40 lr: 8.609806869286818e-05
Epoch-40 lr: 0.0003443922747714727
epoch 40 training time: 15.083
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa609e9c6d0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.786 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 16:58:40.115689
current #epochs=1, #steps=0
start validation
acc: 0.680751
AUC: 0.881637
Avg Precision: 0.450865
Avg Recall: 1.000000
d_prime: 1.673312
train_loss: 0.070598
valid_loss: 1.366936
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.000748234115555393
Epoch-1 lr: 0.001496468231110786
epoch 1 training time: 17.404
---------------
2023-09-24 16:58:57.520448
current #epochs=2, #steps=39
start validation
acc: 0.694836
AUC: 0.899291
Avg Precision: 0.452087
Avg Recall: 1.000000
d_prime: 1.806688
train_loss: 0.087811
valid_loss: 1.349338
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.000748234115555393
Epoch-2 lr: 0.001496468231110786
epoch 2 training time: 17.692
---------------
2023-09-24 16:59:15.212457
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00557	Train Loss 0.0547	
start validation
acc: 0.741784
AUC: 0.905687
Avg Precision: 0.479832
Avg Recall: 1.000000
d_prime: 1.859202
train_loss: 0.062748
valid_loss: 1.339023
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.000748234115555393
Epoch-3 lr: 0.001496468231110786
epoch 3 training time: 17.570
---------------
2023-09-24 16:59:32.782716
current #epochs=4, #steps=117
start validation
acc: 0.713615
AUC: 0.899181
Avg Precision: 0.453582
Avg Recall: 1.000000
d_prime: 1.805808
train_loss: 0.069992
valid_loss: 1.334185
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.000748234115555393
Epoch-4 lr: 0.001496468231110786
epoch 4 training time: 15.130
---------------
2023-09-24 16:59:47.912357
current #epochs=5, #steps=156
start validation
acc: 0.732394
AUC: 0.900815
Avg Precision: 0.470705
Avg Recall: 1.000000
d_prime: 1.818976
train_loss: 0.070255
valid_loss: 1.328691
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.000748234115555393
Epoch-5 lr: 0.001496468231110786
epoch 5 training time: 15.128
---------------
2023-09-24 17:00:03.040760
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01068	Per Sample Data Time 0.00507	Per Sample DNN Time 0.00561	Train Loss 0.0764	
start validation
acc: 0.741784
AUC: 0.899280
Avg Precision: 0.465556
Avg Recall: 1.000000
d_prime: 1.806605
train_loss: 0.063152
valid_loss: 1.329246
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0005879185555567549
Epoch-6 lr: 0.0011758371111135098
epoch 6 training time: 14.998
---------------
2023-09-24 17:00:18.039435
current #epochs=7, #steps=234
start validation
acc: 0.713615
AUC: 0.896389
Avg Precision: 0.456469
Avg Recall: 1.000000
d_prime: 1.783665
train_loss: 0.073070
valid_loss: 1.335086
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0004619519757013167
Epoch-7 lr: 0.0009239039514026334
epoch 7 training time: 15.383
---------------
2023-09-24 17:00:33.422027
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00680	Per Sample Data Time 0.00123	Per Sample DNN Time 0.00557	Train Loss 0.0913	
start validation
acc: 0.713615
AUC: 0.887771
Avg Precision: 0.458852
Avg Recall: 1.000000
d_prime: 1.717928
train_loss: 0.092862
valid_loss: 1.363799
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00036297481315632554
Epoch-8 lr: 0.0007259496263126511
epoch 8 training time: 15.219
---------------
2023-09-24 17:00:48.640573
current #epochs=9, #steps=312
start validation
acc: 0.694836
AUC: 0.891031
Avg Precision: 0.472346
Avg Recall: 1.000000
d_prime: 1.742354
train_loss: 0.061793
valid_loss: 1.350304
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00028520435438305215
Epoch-9 lr: 0.0005704087087661043
epoch 9 training time: 15.143
---------------
2023-09-24 17:01:03.783496
current #epochs=10, #steps=351
start validation
acc: 0.699531
AUC: 0.892197
Avg Precision: 0.489138
Avg Recall: 1.000000
d_prime: 1.751216
train_loss: 0.056919
valid_loss: 1.343467
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00022409688168644785
Epoch-10 lr: 0.0004481937633728957
epoch 10 training time: 15.139
---------------
2023-09-24 17:01:18.923239
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00863	Per Sample Data Time 0.00287	Per Sample DNN Time 0.00575	Train Loss 0.0852	
start validation
acc: 0.708920
AUC: 0.897158
Avg Precision: 0.486899
Avg Recall: 1.000000
d_prime: 1.789722
train_loss: 0.074854
valid_loss: 1.341356
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00017608220775669204
Epoch-11 lr: 0.0003521644155133841
epoch 11 training time: 15.134
---------------
2023-09-24 17:01:34.056670
current #epochs=12, #steps=429
start validation
acc: 0.718310
AUC: 0.901300
Avg Precision: 0.488503
Avg Recall: 1.000000
d_prime: 1.822910
train_loss: 0.069368
valid_loss: 1.337969
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00013835508845612762
Epoch-12 lr: 0.00027671017691225524
epoch 12 training time: 15.096
---------------
2023-09-24 17:01:49.152943
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00661	Per Sample Data Time 0.00106	Per Sample DNN Time 0.00555	Train Loss 0.0590	
start validation
acc: 0.727700
AUC: 0.899339
Avg Precision: 0.489277
Avg Recall: 1.000000
d_prime: 1.807072
train_loss: 0.057028
valid_loss: 1.344056
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00010871132720094712
Epoch-13 lr: 0.00021742265440189424
epoch 13 training time: 15.232
---------------
2023-09-24 17:02:04.385075
current #epochs=14, #steps=507
start validation
acc: 0.732394
AUC: 0.894847
Avg Precision: 0.492662
Avg Recall: 1.000000
d_prime: 1.771617
train_loss: 0.060903
valid_loss: 1.349126
validation finished
normal learning rate scheduler step
Epoch-14 lr: 8.541899538114147e-05
Epoch-14 lr: 0.00017083799076228294
epoch 14 training time: 15.210
---------------
2023-09-24 17:02:19.595200
current #epochs=15, #steps=546
start validation
acc: 0.732394
AUC: 0.895314
Avg Precision: 0.480821
Avg Recall: 1.000000
d_prime: 1.775253
train_loss: 0.064471
valid_loss: 1.348138
validation finished
normal learning rate scheduler step
Epoch-15 lr: 6.71172449071149e-05
Epoch-15 lr: 0.0001342344898142298
epoch 15 training time: 15.241
---------------
2023-09-24 17:02:34.836379
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00769	Per Sample Data Time 0.00199	Per Sample DNN Time 0.00570	Train Loss 0.0517	
start validation
acc: 0.718310
AUC: 0.894062
Avg Precision: 0.487924
Avg Recall: 1.000000
d_prime: 1.765540
train_loss: 0.058490
valid_loss: 1.348195
validation finished
normal learning rate scheduler step
Epoch-16 lr: 5.273680103379181e-05
Epoch-16 lr: 0.00010547360206758363
epoch 16 training time: 15.162
---------------
2023-09-24 17:02:49.997978
current #epochs=17, #steps=624
start validation
acc: 0.718310
AUC: 0.894722
Avg Precision: 0.487947
Avg Recall: 1.000000
d_prime: 1.770653
train_loss: 0.064388
valid_loss: 1.347785
validation finished
normal learning rate scheduler step
Epoch-17 lr: 4.143749027730013e-05
Epoch-17 lr: 8.287498055460026e-05
epoch 17 training time: 15.334
---------------
2023-09-24 17:03:05.331788
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00645	Per Sample Data Time 0.00096	Per Sample DNN Time 0.00549	Train Loss 0.0471	
start validation
acc: 0.713615
AUC: 0.894715
Avg Precision: 0.487895
Avg Recall: 1.000000
d_prime: 1.770596
train_loss: 0.046973
valid_loss: 1.347037
validation finished
normal learning rate scheduler step
Epoch-18 lr: 3.2559153509920146e-05
Epoch-18 lr: 6.511830701984029e-05
epoch 18 training time: 15.208
---------------
2023-09-24 17:03:20.540124
current #epochs=19, #steps=702
start validation
acc: 0.708920
AUC: 0.894772
Avg Precision: 0.487611
Avg Recall: 1.000000
d_prime: 1.771037
train_loss: 0.059743
valid_loss: 1.347308
validation finished
normal learning rate scheduler step
Epoch-19 lr: 2.558307634435278e-05
Epoch-19 lr: 5.116615268870556e-05
epoch 19 training time: 15.249
---------------
2023-09-24 17:03:35.789752
current #epochs=20, #steps=741
start validation
acc: 0.718310
AUC: 0.894308
Avg Precision: 0.479178
Avg Recall: 1.000000
d_prime: 1.767437
train_loss: 0.062098
valid_loss: 1.347668
validation finished
normal learning rate scheduler step
Epoch-20 lr: 2.0101683388100713e-05
Epoch-20 lr: 4.0203366776201425e-05
epoch 20 training time: 15.711
---------------
2023-09-24 17:03:51.500456
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00159	Per Sample DNN Time 0.00562	Train Loss 0.0500	
start validation
acc: 0.723005
AUC: 0.894118
Avg Precision: 0.479099
Avg Recall: 1.000000
d_prime: 1.765969
train_loss: 0.059005
valid_loss: 1.348156
validation finished
normal learning rate scheduler step
Epoch-21 lr: 1.57947257630977e-05
Epoch-21 lr: 3.15894515261954e-05
epoch 21 training time: 15.095
---------------
2023-09-24 17:04:06.595500
current #epochs=22, #steps=819
start validation
acc: 0.723005
AUC: 0.894395
Avg Precision: 0.479378
Avg Recall: 1.000000
d_prime: 1.768118
train_loss: 0.060298
valid_loss: 1.348076
validation finished
normal learning rate scheduler step
Epoch-22 lr: 1.2410570652960295e-05
Epoch-22 lr: 2.482114130592059e-05
epoch 22 training time: 15.131
---------------
2023-09-24 17:04:21.726467
current #epochs=23, #steps=858
start validation
acc: 0.718310
AUC: 0.894488
Avg Precision: 0.472371
Avg Recall: 1.000000
d_prime: 1.768833
train_loss: 0.059814
valid_loss: 1.347778
validation finished
normal learning rate scheduler step
Epoch-23 lr: 9.751499724798775e-06
Epoch-23 lr: 1.950299944959755e-05
epoch 23 training time: 15.200
---------------
2023-09-24 17:04:36.926564
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01408	Per Sample Data Time 0.00760	Per Sample DNN Time 0.00648	Train Loss 0.0563	
start validation
acc: 0.718310
AUC: 0.894260
Avg Precision: 0.479000
Avg Recall: 1.000000
d_prime: 1.767071
train_loss: 0.059698
valid_loss: 1.347931
validation finished
normal learning rate scheduler step
Epoch-24 lr: 7.662157489919156e-06
Epoch-24 lr: 1.532431497983831e-05
epoch 24 training time: 15.087
---------------
2023-09-24 17:04:52.014074
current #epochs=25, #steps=936
start validation
acc: 0.723005
AUC: 0.894154
Avg Precision: 0.472371
Avg Recall: 1.000000
d_prime: 1.766245
train_loss: 0.051310
valid_loss: 1.347845
validation finished
normal learning rate scheduler step
Epoch-25 lr: 6.020474702062885e-06
Epoch-25 lr: 1.204094940412577e-05
epoch 25 training time: 15.400
---------------
2023-09-24 17:05:07.413918
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00693	Per Sample Data Time 0.00129	Per Sample DNN Time 0.00564	Train Loss 0.0913	
start validation
acc: 0.723005
AUC: 0.894444
Avg Precision: 0.472091
Avg Recall: 1.000000
d_prime: 1.768493
train_loss: 0.080157
valid_loss: 1.347360
validation finished
normal learning rate scheduler step
Epoch-26 lr: 4.7305364952191314e-06
Epoch-26 lr: 9.461072990438263e-06
epoch 26 training time: 15.272
---------------
2023-09-24 17:05:22.685812
current #epochs=27, #steps=1014
start validation
acc: 0.723005
AUC: 0.894440
Avg Precision: 0.471290
Avg Recall: 1.000000
d_prime: 1.768464
train_loss: 0.077387
valid_loss: 1.347300
validation finished
normal learning rate scheduler step
Epoch-27 lr: 3.7169785839200367e-06
Epoch-27 lr: 7.433957167840073e-06
epoch 27 training time: 15.315
---------------
2023-09-24 17:05:38.000828
current #epochs=28, #steps=1053
start validation
acc: 0.723005
AUC: 0.894478
Avg Precision: 0.471290
Avg Recall: 1.000000
d_prime: 1.768755
train_loss: 0.064303
valid_loss: 1.347373
validation finished
normal learning rate scheduler step
Epoch-28 lr: 2.9205841255602042e-06
Epoch-28 lr: 5.8411682511204085e-06
epoch 28 training time: 15.169
---------------
2023-09-24 17:05:53.169532
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00939	Per Sample Data Time 0.00350	Per Sample DNN Time 0.00589	Train Loss 0.0685	
start validation
acc: 0.723005
AUC: 0.894334
Avg Precision: 0.471290
Avg Recall: 1.000000
d_prime: 1.767641
train_loss: 0.070169
valid_loss: 1.347369
validation finished
normal learning rate scheduler step
Epoch-29 lr: 2.2948239926307213e-06
Epoch-29 lr: 4.589647985261443e-06
epoch 29 training time: 15.157
---------------
2023-09-24 17:06:08.327195
current #epochs=30, #steps=1131
start validation
acc: 0.723005
AUC: 0.894544
Avg Precision: 0.471290
Avg Recall: 1.000000
d_prime: 1.769265
train_loss: 0.055426
valid_loss: 1.347298
validation finished
normal learning rate scheduler step
Epoch-30 lr: 1.8031383212231489e-06
Epoch-30 lr: 3.6062766424462977e-06
epoch 30 training time: 15.157
---------------
2023-09-24 17:06:23.484217
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00661	Per Sample Data Time 0.00110	Per Sample DNN Time 0.00551	Train Loss 0.0567	
start validation
acc: 0.723005
AUC: 0.894480
Avg Precision: 0.471290
Avg Recall: 1.000000
d_prime: 1.768775
train_loss: 0.060545
valid_loss: 1.347199
validation finished
normal learning rate scheduler step
Epoch-31 lr: 1.416800511021426e-06
Epoch-31 lr: 2.833601022042852e-06
epoch 31 training time: 14.993
---------------
2023-09-24 17:06:38.477079
current #epochs=32, #steps=1209
start validation
acc: 0.723005
AUC: 0.894473
Avg Precision: 0.471290
Avg Recall: 1.000000
d_prime: 1.768718
train_loss: 0.059257
valid_loss: 1.347016
validation finished
normal learning rate scheduler step
Epoch-32 lr: 1.1132388815678419e-06
Epoch-32 lr: 2.2264777631356838e-06
epoch 32 training time: 15.204
---------------
2023-09-24 17:06:53.681515
current #epochs=33, #steps=1248
start validation
acc: 0.723005
AUC: 0.894423
Avg Precision: 0.471290
Avg Recall: 1.000000
d_prime: 1.768328
train_loss: 0.064746
valid_loss: 1.347002
validation finished
normal learning rate scheduler step
Epoch-33 lr: 8.747179280313498e-07
Epoch-33 lr: 1.7494358560626997e-06
epoch 33 training time: 15.199
---------------
2023-09-24 17:07:08.880332
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00793	Per Sample Data Time 0.00230	Per Sample DNN Time 0.00563	Train Loss 0.0403	
start validation
acc: 0.723005
AUC: 0.894394
Avg Precision: 0.471290
Avg Recall: 1.000000
d_prime: 1.768106
train_loss: 0.057509
valid_loss: 1.347024
validation finished
normal learning rate scheduler step
Epoch-34 lr: 6.873021292086714e-07
Epoch-34 lr: 1.3746042584173428e-06
epoch 34 training time: 15.134
---------------
2023-09-24 17:07:24.014519
current #epochs=35, #steps=1326
start validation
acc: 0.723005
AUC: 0.894409
Avg Precision: 0.471290
Avg Recall: 1.000000
d_prime: 1.768222
train_loss: 0.046191
valid_loss: 1.347023
validation finished
normal learning rate scheduler step
Epoch-35 lr: 5.40041768525228e-07
Epoch-35 lr: 1.080083537050456e-06
epoch 35 training time: 15.143
---------------
2023-09-24 17:07:39.157066
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00653	Per Sample Data Time 0.00099	Per Sample DNN Time 0.00554	Train Loss 0.0621	
start validation
acc: 0.723005
AUC: 0.894430
Avg Precision: 0.471290
Avg Recall: 1.000000
d_prime: 1.768387
train_loss: 0.063465
valid_loss: 1.347017
validation finished
normal learning rate scheduler step
Epoch-36 lr: 4.2433319985148733e-07
Epoch-36 lr: 8.486663997029747e-07
epoch 36 training time: 15.226
---------------
2023-09-24 17:07:54.383196
current #epochs=37, #steps=1404
start validation
acc: 0.723005
AUC: 0.894415
Avg Precision: 0.471290
Avg Recall: 1.000000
d_prime: 1.768272
train_loss: 0.044030
valid_loss: 1.347011
validation finished
normal learning rate scheduler step
Epoch-37 lr: 3.3341618184074007e-07
Epoch-37 lr: 6.668323636814801e-07
epoch 37 training time: 15.179
---------------
2023-09-24 17:08:09.562238
current #epochs=38, #steps=1443
start validation
acc: 0.723005
AUC: 0.894415
Avg Precision: 0.471290
Avg Recall: 1.000000
d_prime: 1.768272
train_loss: 0.042753
valid_loss: 1.347007
validation finished
normal learning rate scheduler step
Epoch-38 lr: 2.6197891268504244e-07
Epoch-38 lr: 5.239578253700849e-07
epoch 38 training time: 15.171
---------------
2023-09-24 17:08:24.733089
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00739	Per Sample Data Time 0.00174	Per Sample DNN Time 0.00565	Train Loss 0.0982	
start validation
acc: 0.723005
AUC: 0.894415
Avg Precision: 0.471290
Avg Recall: 1.000000
d_prime: 1.768272
train_loss: 0.079122
valid_loss: 1.346992
validation finished
normal learning rate scheduler step
Epoch-39 lr: 2.0584768955341338e-07
Epoch-39 lr: 4.1169537910682677e-07
epoch 39 training time: 15.192
---------------
2023-09-24 17:08:39.925457
current #epochs=40, #steps=1521
start validation
acc: 0.723005
AUC: 0.894451
Avg Precision: 0.471290
Avg Recall: 1.000000
d_prime: 1.768546
train_loss: 0.057445
valid_loss: 1.346983
validation finished
normal learning rate scheduler step
Epoch-40 lr: 1.6174306115019515e-07
Epoch-40 lr: 3.234861223003903e-07
epoch 40 training time: 15.217
---------------
2023-09-24 17:08:55.142404
current #epochs=41, #steps=1560
start validation
acc: 0.723005
AUC: 0.894451
Avg Precision: 0.471290
Avg Recall: 1.000000
d_prime: 1.768546
train_loss: 0.050535
valid_loss: 1.346975
validation finished
normal learning rate scheduler step
Epoch-41 lr: 1.2708822667376868e-07
Epoch-41 lr: 2.5417645334753737e-07
epoch 41 training time: 15.305
---------------
2023-09-24 17:09:10.448005
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02171	Per Sample Data Time 0.01480	Per Sample DNN Time 0.00692	Train Loss 0.0616	
start validation
acc: 0.723005
AUC: 0.894451
Avg Precision: 0.471290
Avg Recall: 1.000000
d_prime: 1.768546
train_loss: 0.046764
valid_loss: 1.346974
validation finished
normal learning rate scheduler step
Epoch-42 lr: 9.98584869374084e-08
Epoch-42 lr: 1.997169738748168e-07
epoch 42 training time: 15.426
---------------
2023-09-24 17:09:25.873428
current #epochs=43, #steps=1638
start validation
acc: 0.723005
AUC: 0.894451
Avg Precision: 0.471290
Avg Recall: 1.000000
d_prime: 1.768546
train_loss: 0.066301
valid_loss: 1.346973
validation finished
normal learning rate scheduler step
Epoch-43 lr: 7.846295187535848e-08
Epoch-43 lr: 1.5692590375071697e-07
epoch 43 training time: 15.043
---------------
2023-09-24 17:09:40.916353
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00696	Per Sample Data Time 0.00137	Per Sample DNN Time 0.00559	Train Loss 0.0828	
start validation
[I 2023-09-24 17:09:55,956] Trial 47 finished with value: 0.4712901573082549 and parameters: {'warmup': 'True', 'num_epochs': 44, 'batch_size': 58, 'lr-adaptschedule': 'True', 'lr': 0.000748234115555393, 'head-lr': 2, 'lr-scheduler-start': 6, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7857414455372161}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.723005
AUC: 0.894451
Avg Precision: 0.471290
Avg Recall: 1.000000
d_prime: 1.768546
train_loss: 0.068592
valid_loss: 1.346977
validation finished
normal learning rate scheduler step
Epoch-44 lr: 6.16515932276612e-08
Epoch-44 lr: 1.233031864553224e-07
epoch 44 training time: 15.030
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa6080c6220>
The learning rate scheduler starts at 5 epoch with decay rate of 0.694 every 8 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 17:09:55.991758
current #epochs=1, #steps=0
start validation
acc: 0.741784
AUC: 0.899627
Avg Precision: 0.489429
Avg Recall: 1.000000
d_prime: 1.809386
train_loss: 0.062422
valid_loss: 1.338625
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.00029984577204174735
Epoch-1 lr: 0.00029984577204174735
epoch 1 training time: 17.522
---------------
2023-09-24 17:10:13.514655
current #epochs=2, #steps=39
start validation
acc: 0.723005
AUC: 0.894414
Avg Precision: 0.477875
Avg Recall: 1.000000
d_prime: 1.768264
train_loss: 0.062877
valid_loss: 1.342274
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.00029984577204174735
Epoch-2 lr: 0.00029984577204174735
epoch 2 training time: 15.173
---------------
2023-09-24 17:10:28.687435
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00704	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00558	Train Loss 0.0432	
start validation
acc: 0.708920
AUC: 0.897097
Avg Precision: 0.472137
Avg Recall: 1.000000
d_prime: 1.789236
train_loss: 0.047717
valid_loss: 1.344975
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.00029984577204174735
Epoch-3 lr: 0.00029984577204174735
epoch 3 training time: 15.054
---------------
2023-09-24 17:10:43.741790
current #epochs=4, #steps=117
start validation
acc: 0.704225
AUC: 0.896764
Avg Precision: 0.473950
Avg Recall: 1.000000
d_prime: 1.786609
train_loss: 0.056942
valid_loss: 1.347818
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00029984577204174735
Epoch-4 lr: 0.00029984577204174735
epoch 4 training time: 15.174
---------------
2023-09-24 17:10:58.916003
current #epochs=5, #steps=156
start validation
acc: 0.713615
AUC: 0.894482
Avg Precision: 0.483703
Avg Recall: 1.000000
d_prime: 1.768785
train_loss: 0.045020
valid_loss: 1.349045
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0002081754245218122
Epoch-5 lr: 0.0002081754245218122
epoch 5 training time: 15.354
---------------
2023-09-24 17:11:14.270354
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01121	Per Sample Data Time 0.00521	Per Sample DNN Time 0.00600	Train Loss 0.0409	
start validation
acc: 0.727700
AUC: 0.895153
Avg Precision: 0.479089
Avg Recall: 1.000000
d_prime: 1.773998
train_loss: 0.063397
valid_loss: 1.350965
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0002081754245218122
Epoch-6 lr: 0.0002081754245218122
epoch 6 training time: 15.020
---------------
2023-09-24 17:11:29.290893
current #epochs=7, #steps=234
start validation
acc: 0.732394
AUC: 0.889992
Avg Precision: 0.462691
Avg Recall: 1.000000
d_prime: 1.734516
train_loss: 0.041845
valid_loss: 1.347687
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0002081754245218122
Epoch-7 lr: 0.0002081754245218122
epoch 7 training time: 15.055
---------------
2023-09-24 17:11:44.345571
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00681	Per Sample Data Time 0.00124	Per Sample DNN Time 0.00557	Train Loss 0.0542	
start validation
acc: 0.727700
AUC: 0.890472
Avg Precision: 0.475613
Avg Recall: 1.000000
d_prime: 1.738131
train_loss: 0.050465
valid_loss: 1.337002
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0002081754245218122
Epoch-8 lr: 0.0002081754245218122
epoch 8 training time: 15.147
---------------
2023-09-24 17:11:59.492410
current #epochs=9, #steps=312
start validation
acc: 0.746479
AUC: 0.894326
Avg Precision: 0.467192
Avg Recall: 1.000000
d_prime: 1.767582
train_loss: 0.071624
valid_loss: 1.328550
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0002081754245218122
Epoch-9 lr: 0.0002081754245218122
epoch 9 training time: 17.579
---------------
2023-09-24 17:12:17.071117
current #epochs=10, #steps=351
start validation
acc: 0.746479
AUC: 0.892330
Avg Precision: 0.458708
Avg Recall: 1.000000
d_prime: 1.752231
train_loss: 0.065816
valid_loss: 1.335282
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0002081754245218122
Epoch-10 lr: 0.0002081754245218122
epoch 10 training time: 15.176
---------------
2023-09-24 17:12:32.247160
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00874	Per Sample Data Time 0.00298	Per Sample DNN Time 0.00576	Train Loss 0.0679	
start validation
acc: 0.737089
AUC: 0.888985
Avg Precision: 0.463538
Avg Recall: 1.000000
d_prime: 1.726966
train_loss: 0.076840
valid_loss: 1.342358
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0002081754245218122
Epoch-11 lr: 0.0002081754245218122
epoch 11 training time: 15.121
---------------
2023-09-24 17:12:47.368649
current #epochs=12, #steps=429
start validation
acc: 0.732394
AUC: 0.896821
Avg Precision: 0.469747
Avg Recall: 1.000000
d_prime: 1.787064
train_loss: 0.054707
valid_loss: 1.329292
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0002081754245218122
Epoch-12 lr: 0.0002081754245218122
epoch 12 training time: 15.285
---------------
2023-09-24 17:13:02.653476
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00665	Per Sample Data Time 0.00104	Per Sample DNN Time 0.00561	Train Loss 0.0666	
start validation
acc: 0.751174
AUC: 0.901405
Avg Precision: 0.481481
Avg Recall: 1.000000
d_prime: 1.823766
train_loss: 0.061155
valid_loss: 1.330234
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00014453099364963848
Epoch-13 lr: 0.00014453099364963848
epoch 13 training time: 17.585
---------------
2023-09-24 17:13:20.238642
current #epochs=14, #steps=507
start validation
acc: 0.746479
AUC: 0.900527
Avg Precision: 0.482180
Avg Recall: 1.000000
d_prime: 1.816640
train_loss: 0.052798
valid_loss: 1.330581
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.00014453099364963848
Epoch-14 lr: 0.00014453099364963848
epoch 14 training time: 15.153
---------------
2023-09-24 17:13:35.391096
current #epochs=15, #steps=546
start validation
acc: 0.751174
AUC: 0.899556
Avg Precision: 0.471516
Avg Recall: 1.000000
d_prime: 1.808814
train_loss: 0.065353
valid_loss: 1.332228
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.00014453099364963848
Epoch-15 lr: 0.00014453099364963848
epoch 15 training time: 15.294
---------------
2023-09-24 17:13:50.684650
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00768	Per Sample Data Time 0.00207	Per Sample DNN Time 0.00562	Train Loss 0.0621	
start validation
acc: 0.751174
AUC: 0.899906
Avg Precision: 0.471432
Avg Recall: 1.000000
d_prime: 1.811632
train_loss: 0.055304
valid_loss: 1.334652
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.00014453099364963848
Epoch-16 lr: 0.00014453099364963848
epoch 16 training time: 15.045
---------------
2023-09-24 17:14:05.729977
current #epochs=17, #steps=624
start validation
acc: 0.746479
AUC: 0.898805
Avg Precision: 0.475811
Avg Recall: 1.000000
d_prime: 1.802802
train_loss: 0.051135
valid_loss: 1.339788
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.00014453099364963848
Epoch-17 lr: 0.00014453099364963848
epoch 17 training time: 15.263
---------------
2023-09-24 17:14:20.993618
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00647	Per Sample Data Time 0.00091	Per Sample DNN Time 0.00555	Train Loss 0.0685	
start validation
acc: 0.746479
AUC: 0.898361
Avg Precision: 0.471908
Avg Recall: 1.000000
d_prime: 1.799256
train_loss: 0.066972
valid_loss: 1.332441
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00014453099364963848
Epoch-18 lr: 0.00014453099364963848
epoch 18 training time: 15.649
---------------
2023-09-24 17:14:36.642160
current #epochs=19, #steps=702
start validation
acc: 0.732394
AUC: 0.898085
Avg Precision: 0.470869
Avg Recall: 1.000000
d_prime: 1.797059
train_loss: 0.068264
valid_loss: 1.333080
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00014453099364963848
Epoch-19 lr: 0.00014453099364963848
epoch 19 training time: 15.089
---------------
2023-09-24 17:14:51.730934
current #epochs=20, #steps=741
start validation
acc: 0.723005
AUC: 0.896977
Avg Precision: 0.464557
Avg Recall: 1.000000
d_prime: 1.788291
train_loss: 0.050969
valid_loss: 1.339192
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00014453099364963848
Epoch-20 lr: 0.00014453099364963848
epoch 20 training time: 15.616
---------------
2023-09-24 17:15:07.347150
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00725	Per Sample Data Time 0.00161	Per Sample DNN Time 0.00564	Train Loss 0.0658	
start validation
acc: 0.727700
AUC: 0.899687
Avg Precision: 0.466884
Avg Recall: 1.000000
d_prime: 1.809868
train_loss: 0.064426
valid_loss: 1.333020
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00010034425616441151
Epoch-21 lr: 0.00010034425616441151
epoch 21 training time: 15.118
---------------
2023-09-24 17:15:22.465009
current #epochs=22, #steps=819
start validation
acc: 0.741784
AUC: 0.899766
Avg Precision: 0.468767
Avg Recall: 1.000000
d_prime: 1.810504
train_loss: 0.045305
valid_loss: 1.333599
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00010034425616441151
Epoch-22 lr: 0.00010034425616441151
epoch 22 training time: 15.000
---------------
2023-09-24 17:15:37.464847
current #epochs=23, #steps=858
start validation
acc: 0.737089
AUC: 0.900107
Avg Precision: 0.467037
Avg Recall: 1.000000
d_prime: 1.813246
train_loss: 0.049282
valid_loss: 1.338110
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00010034425616441151
Epoch-23 lr: 0.00010034425616441151
epoch 23 training time: 15.281
---------------
2023-09-24 17:15:52.746169
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01341	Per Sample Data Time 0.00756	Per Sample DNN Time 0.00585	Train Loss 0.0401	
start validation
acc: 0.727700
AUC: 0.898492
Avg Precision: 0.466780
Avg Recall: 1.000000
d_prime: 1.800299
train_loss: 0.047569
valid_loss: 1.337651
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00010034425616441151
Epoch-24 lr: 0.00010034425616441151
epoch 24 training time: 15.196
---------------
2023-09-24 17:16:07.942612
current #epochs=25, #steps=936
start validation
acc: 0.718310
AUC: 0.896090
Avg Precision: 0.469851
Avg Recall: 1.000000
d_prime: 1.781319
train_loss: 0.048086
valid_loss: 1.338345
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00010034425616441151
Epoch-25 lr: 0.00010034425616441151
epoch 25 training time: 15.195
---------------
2023-09-24 17:16:23.137917
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00688	Per Sample Data Time 0.00131	Per Sample DNN Time 0.00558	Train Loss 0.0521	
start validation
acc: 0.713615
AUC: 0.897056
Avg Precision: 0.470841
Avg Recall: 1.000000
d_prime: 1.788914
train_loss: 0.059171
valid_loss: 1.335968
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00010034425616441151
Epoch-26 lr: 0.00010034425616441151
epoch 26 training time: 15.068
---------------
2023-09-24 17:16:38.205908
current #epochs=27, #steps=1014
start validation
acc: 0.746479
AUC: 0.897524
Avg Precision: 0.475137
Avg Recall: 1.000000
d_prime: 1.792614
train_loss: 0.063350
valid_loss: 1.335502
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00010034425616441151
Epoch-27 lr: 0.00010034425616441151
epoch 27 training time: 15.128
---------------
2023-09-24 17:16:53.333498
current #epochs=28, #steps=1053
start validation
acc: 0.723005
AUC: 0.895718
Avg Precision: 0.471439
Avg Recall: 1.000000
d_prime: 1.778405
train_loss: 0.058785
valid_loss: 1.332641
validation finished
normal learning rate scheduler step
Epoch-28 lr: 0.00010034425616441151
Epoch-28 lr: 0.00010034425616441151
epoch 28 training time: 15.041
---------------
2023-09-24 17:17:08.374637
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00941	Per Sample Data Time 0.00357	Per Sample DNN Time 0.00583	Train Loss 0.0749	
start validation
acc: 0.718310
AUC: 0.894792
Avg Precision: 0.470918
Avg Recall: 1.000000
d_prime: 1.771197
train_loss: 0.071256
valid_loss: 1.332584
validation finished
normal learning rate scheduler step
Epoch-29 lr: 6.966650882922387e-05
Epoch-29 lr: 6.966650882922387e-05
epoch 29 training time: 15.208
---------------
2023-09-24 17:17:23.582808
current #epochs=30, #steps=1131
start validation
acc: 0.732394
AUC: 0.896646
Avg Precision: 0.472337
Avg Recall: 1.000000
d_prime: 1.785685
train_loss: 0.056622
valid_loss: 1.335398
validation finished
normal learning rate scheduler step
Epoch-30 lr: 6.966650882922387e-05
Epoch-30 lr: 6.966650882922387e-05
epoch 30 training time: 15.314
---------------
2023-09-24 17:17:38.896730
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00663	Per Sample Data Time 0.00111	Per Sample DNN Time 0.00552	Train Loss 0.0415	
start validation
acc: 0.737089
AUC: 0.897017
Avg Precision: 0.473277
Avg Recall: 1.000000
d_prime: 1.788607
train_loss: 0.047857
valid_loss: 1.334349
validation finished
normal learning rate scheduler step
Epoch-31 lr: 6.966650882922387e-05
Epoch-31 lr: 6.966650882922387e-05
epoch 31 training time: 15.133
---------------
2023-09-24 17:17:54.029945
current #epochs=32, #steps=1209
start validation
acc: 0.751174
AUC: 0.896546
Avg Precision: 0.474041
Avg Recall: 1.000000
d_prime: 1.784899
train_loss: 0.055268
valid_loss: 1.336185
validation finished
normal learning rate scheduler step
Epoch-32 lr: 6.966650882922387e-05
Epoch-32 lr: 6.966650882922387e-05
epoch 32 training time: 15.547
---------------
2023-09-24 17:18:09.576483
current #epochs=33, #steps=1248
start validation
acc: 0.751174
AUC: 0.896543
Avg Precision: 0.472989
Avg Recall: 1.000000
d_prime: 1.784871
train_loss: 0.064943
valid_loss: 1.337391
validation finished
normal learning rate scheduler step
Epoch-33 lr: 6.966650882922387e-05
Epoch-33 lr: 6.966650882922387e-05
epoch 33 training time: 15.150
---------------
2023-09-24 17:18:24.726802
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00791	Per Sample Data Time 0.00229	Per Sample DNN Time 0.00562	Train Loss 0.0402	
start validation
acc: 0.741784
AUC: 0.895479
Avg Precision: 0.472503
Avg Recall: 1.000000
d_prime: 1.776539
train_loss: 0.053421
valid_loss: 1.336696
validation finished
normal learning rate scheduler step
Epoch-34 lr: 6.966650882922387e-05
Epoch-34 lr: 6.966650882922387e-05
epoch 34 training time: 15.053
---------------
2023-09-24 17:18:39.779818
current #epochs=35, #steps=1326
start validation
acc: 0.737089
AUC: 0.895158
Avg Precision: 0.475239
Avg Recall: 1.000000
d_prime: 1.774041
train_loss: 0.051793
valid_loss: 1.337446
validation finished
normal learning rate scheduler step
Epoch-35 lr: 6.966650882922387e-05
Epoch-35 lr: 6.966650882922387e-05
epoch 35 training time: 15.245
---------------
2023-09-24 17:18:55.024616
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00659	Per Sample Data Time 0.00100	Per Sample DNN Time 0.00559	Train Loss 0.0575	
start validation
acc: 0.737089
AUC: 0.894700
Avg Precision: 0.476102
Avg Recall: 1.000000
d_prime: 1.770481
train_loss: 0.058160
valid_loss: 1.336963
validation finished
normal learning rate scheduler step
Epoch-36 lr: 6.966650882922387e-05
Epoch-36 lr: 6.966650882922387e-05
epoch 36 training time: 15.322
---------------
2023-09-24 17:19:10.346908
current #epochs=37, #steps=1404
start validation
acc: 0.737089
AUC: 0.895129
Avg Precision: 0.470166
Avg Recall: 1.000000
d_prime: 1.773814
train_loss: 0.050433
valid_loss: 1.333042
validation finished
normal learning rate scheduler step
Epoch-37 lr: 4.836771568170397e-05
Epoch-37 lr: 4.836771568170397e-05
epoch 37 training time: 15.167
---------------
2023-09-24 17:19:25.513520
current #epochs=38, #steps=1443
start validation
acc: 0.746479
AUC: 0.895144
Avg Precision: 0.469965
Avg Recall: 1.000000
d_prime: 1.773927
train_loss: 0.060086
valid_loss: 1.333507
validation finished
normal learning rate scheduler step
Epoch-38 lr: 4.836771568170397e-05
Epoch-38 lr: 4.836771568170397e-05
epoch 38 training time: 15.265
---------------
2023-09-24 17:19:40.778964
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00735	Per Sample Data Time 0.00177	Per Sample DNN Time 0.00558	Train Loss 0.0597	
start validation
acc: 0.741784
AUC: 0.894999
Avg Precision: 0.469473
Avg Recall: 1.000000
d_prime: 1.772799
train_loss: 0.065449
valid_loss: 1.333771
validation finished
normal learning rate scheduler step
Epoch-39 lr: 4.836771568170397e-05
Epoch-39 lr: 4.836771568170397e-05
epoch 39 training time: 15.110
---------------
2023-09-24 17:19:55.888501
current #epochs=40, #steps=1521
start validation
acc: 0.732394
AUC: 0.895140
Avg Precision: 0.469416
Avg Recall: 1.000000
d_prime: 1.773899
train_loss: 0.060939
valid_loss: 1.334354
validation finished
normal learning rate scheduler step
Epoch-40 lr: 4.836771568170397e-05
Epoch-40 lr: 4.836771568170397e-05
epoch 40 training time: 15.109
---------------
2023-09-24 17:20:10.997303
current #epochs=41, #steps=1560
start validation
acc: 0.732394
AUC: 0.895971
Avg Precision: 0.480779
Avg Recall: 1.000000
d_prime: 1.780389
train_loss: 0.071304
valid_loss: 1.332466
validation finished
normal learning rate scheduler step
Epoch-41 lr: 4.836771568170397e-05
Epoch-41 lr: 4.836771568170397e-05
epoch 41 training time: 15.154
---------------
2023-09-24 17:20:26.151697
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02205	Per Sample Data Time 0.01543	Per Sample DNN Time 0.00662	Train Loss 0.0433	
start validation
acc: 0.732394
AUC: 0.895691
Avg Precision: 0.474299
Avg Recall: 1.000000
d_prime: 1.778195
train_loss: 0.052270
valid_loss: 1.331225
validation finished
normal learning rate scheduler step
Epoch-42 lr: 4.836771568170397e-05
Epoch-42 lr: 4.836771568170397e-05
epoch 42 training time: 15.227
---------------
2023-09-24 17:20:41.379206
current #epochs=43, #steps=1638
start validation
acc: 0.727700
AUC: 0.896354
Avg Precision: 0.481116
Avg Recall: 1.000000
d_prime: 1.783386
train_loss: 0.051962
valid_loss: 1.328289
validation finished
normal learning rate scheduler step
Epoch-43 lr: 4.836771568170397e-05
Epoch-43 lr: 4.836771568170397e-05
epoch 43 training time: 15.052
---------------
2023-09-24 17:20:56.431489
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00691	Per Sample Data Time 0.00137	Per Sample DNN Time 0.00555	Train Loss 0.0525	
start validation
acc: 0.727700
AUC: 0.896983
Avg Precision: 0.473727
Avg Recall: 1.000000
d_prime: 1.788338
train_loss: 0.058369
valid_loss: 1.328832
validation finished
normal learning rate scheduler step
Epoch-44 lr: 4.836771568170397e-05
Epoch-44 lr: 4.836771568170397e-05
epoch 44 training time: 15.033
---------------
2023-09-24 17:21:11.463891
current #epochs=45, #steps=1716
start validation
acc: 0.732394
AUC: 0.896614
Avg Precision: 0.473397
Avg Recall: 1.000000
d_prime: 1.785429
train_loss: 0.067396
valid_loss: 1.331032
validation finished
normal learning rate scheduler step
Epoch-45 lr: 3.3580495988408134e-05
Epoch-45 lr: 3.3580495988408134e-05
epoch 45 training time: 15.198
---------------
2023-09-24 17:21:26.661499
current #epochs=46, #steps=1755
start validation
acc: 0.732394
AUC: 0.897223
Avg Precision: 0.473555
Avg Recall: 1.000000
d_prime: 1.790234
train_loss: 0.067110
valid_loss: 1.330598
validation finished
normal learning rate scheduler step
Epoch-46 lr: 3.3580495988408134e-05
Epoch-46 lr: 3.3580495988408134e-05
epoch 46 training time: 15.081
---------------
2023-09-24 17:21:41.742983
current #epochs=47, #steps=1794
Epoch: [47][6/39]	Per Sample Total Time 0.01054	Per Sample Data Time 0.00453	Per Sample DNN Time 0.00602	Train Loss 0.0551	
start validation
[I 2023-09-24 17:21:56,924] Trial 48 finished with value: 0.4709206185701953 and parameters: {'warmup': 'True', 'num_epochs': 47, 'batch_size': 46, 'lr-adaptschedule': 'True', 'lr': 0.00029984577204174735, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 8, 'lr-scheduler-decay': 0.6942750037937105}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.732394
AUC: 0.897016
Avg Precision: 0.470921
Avg Recall: 1.000000
d_prime: 1.788601
train_loss: 0.060721
valid_loss: 1.330915
validation finished
normal learning rate scheduler step
Epoch-47 lr: 3.3580495988408134e-05
Epoch-47 lr: 3.3580495988408134e-05
epoch 47 training time: 15.171
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa63ceca880>
The learning rate scheduler starts at 3 epoch with decay rate of 0.744 every 9 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 17:21:56.960753
current #epochs=1, #steps=0
start validation
acc: 0.755869
AUC: 0.897727
Avg Precision: 0.478823
Avg Recall: 1.000000
d_prime: 1.794219
train_loss: 0.056923
valid_loss: 1.336589
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.00016208585280074494
Epoch-1 lr: 0.0003241717056014899
epoch 1 training time: 17.510
---------------
2023-09-24 17:22:14.470630
current #epochs=2, #steps=39
start validation
acc: 0.741784
AUC: 0.896929
Avg Precision: 0.475800
Avg Recall: 1.000000
d_prime: 1.787916
train_loss: 0.049739
valid_loss: 1.331824
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.00016208585280074494
Epoch-2 lr: 0.0003241717056014899
epoch 2 training time: 15.159
---------------
2023-09-24 17:22:29.630289
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00561	Train Loss 0.0490	
start validation
acc: 0.746479
AUC: 0.896605
Avg Precision: 0.481246
Avg Recall: 1.000000
d_prime: 1.785363
train_loss: 0.053310
valid_loss: 1.334797
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.00012053518788401187
Epoch-3 lr: 0.00024107037576802373
epoch 3 training time: 15.142
---------------
2023-09-24 17:22:44.771574
current #epochs=4, #steps=117
start validation
acc: 0.741784
AUC: 0.899180
Avg Precision: 0.477948
Avg Recall: 1.000000
d_prime: 1.805798
train_loss: 0.062823
valid_loss: 1.335117
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00012053518788401187
Epoch-4 lr: 0.00024107037576802373
epoch 4 training time: 15.159
---------------
2023-09-24 17:22:59.931038
current #epochs=5, #steps=156
start validation
acc: 0.727700
AUC: 0.898641
Avg Precision: 0.475913
Avg Recall: 1.000000
d_prime: 1.801490
train_loss: 0.050725
valid_loss: 1.334204
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00012053518788401187
Epoch-5 lr: 0.00024107037576802373
epoch 5 training time: 15.754
---------------
2023-09-24 17:23:15.684761
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01138	Per Sample Data Time 0.00529	Per Sample DNN Time 0.00609	Train Loss 0.0871	
start validation
acc: 0.732394
AUC: 0.899057
Avg Precision: 0.478672
Avg Recall: 1.000000
d_prime: 1.804811
train_loss: 0.063752
valid_loss: 1.338556
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00012053518788401187
Epoch-6 lr: 0.00024107037576802373
epoch 6 training time: 17.185
---------------
2023-09-24 17:23:32.869146
current #epochs=7, #steps=234
start validation
acc: 0.732394
AUC: 0.899096
Avg Precision: 0.481787
Avg Recall: 1.000000
d_prime: 1.805128
train_loss: 0.064041
valid_loss: 1.339008
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00012053518788401187
Epoch-7 lr: 0.00024107037576802373
epoch 7 training time: 15.010
---------------
2023-09-24 17:23:47.879721
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00685	Per Sample Data Time 0.00126	Per Sample DNN Time 0.00559	Train Loss 0.0575	
start validation
acc: 0.732394
AUC: 0.899372
Avg Precision: 0.482471
Avg Recall: 1.000000
d_prime: 1.807335
train_loss: 0.055051
valid_loss: 1.334535
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00012053518788401187
Epoch-8 lr: 0.00024107037576802373
epoch 8 training time: 16.374
---------------
2023-09-24 17:24:04.253884
current #epochs=9, #steps=312
start validation
acc: 0.718310
AUC: 0.899520
Avg Precision: 0.480590
Avg Recall: 1.000000
d_prime: 1.808523
train_loss: 0.065698
valid_loss: 1.339545
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00012053518788401187
Epoch-9 lr: 0.00024107037576802373
epoch 9 training time: 15.227
---------------
2023-09-24 17:24:19.481173
current #epochs=10, #steps=351
start validation
acc: 0.723005
AUC: 0.897945
Avg Precision: 0.472512
Avg Recall: 1.000000
d_prime: 1.795953
train_loss: 0.068797
valid_loss: 1.339847
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00012053518788401187
Epoch-10 lr: 0.00024107037576802373
epoch 10 training time: 15.167
---------------
2023-09-24 17:24:34.647939
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00874	Per Sample Data Time 0.00302	Per Sample DNN Time 0.00573	Train Loss 0.0573	
start validation
acc: 0.723005
AUC: 0.895731
Avg Precision: 0.469499
Avg Recall: 1.000000
d_prime: 1.778507
train_loss: 0.053135
valid_loss: 1.340004
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00012053518788401187
Epoch-11 lr: 0.00024107037576802373
epoch 11 training time: 15.239
---------------
2023-09-24 17:24:49.886570
current #epochs=12, #steps=429
start validation
acc: 0.732394
AUC: 0.899583
Avg Precision: 0.470341
Avg Recall: 1.000000
d_prime: 1.809035
train_loss: 0.061215
valid_loss: 1.335379
validation finished
normal learning rate scheduler step
Epoch-12 lr: 8.9636024780611e-05
Epoch-12 lr: 0.000179272049561222
epoch 12 training time: 15.193
---------------
2023-09-24 17:25:05.080190
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00660	Per Sample Data Time 0.00109	Per Sample DNN Time 0.00551	Train Loss 0.0454	
start validation
acc: 0.723005
AUC: 0.900747
Avg Precision: 0.458404
Avg Recall: 1.000000
d_prime: 1.818421
train_loss: 0.044513
valid_loss: 1.333586
validation finished
normal learning rate scheduler step
Epoch-13 lr: 8.9636024780611e-05
Epoch-13 lr: 0.000179272049561222
epoch 13 training time: 15.141
---------------
2023-09-24 17:25:20.220639
current #epochs=14, #steps=507
start validation
acc: 0.732394
AUC: 0.900964
Avg Precision: 0.467988
Avg Recall: 1.000000
d_prime: 1.820182
train_loss: 0.045507
valid_loss: 1.337413
validation finished
normal learning rate scheduler step
Epoch-14 lr: 8.9636024780611e-05
Epoch-14 lr: 0.000179272049561222
epoch 14 training time: 15.209
---------------
2023-09-24 17:25:35.429606
current #epochs=15, #steps=546
start validation
acc: 0.727700
AUC: 0.899530
Avg Precision: 0.456835
Avg Recall: 1.000000
d_prime: 1.808604
train_loss: 0.049897
valid_loss: 1.335049
validation finished
normal learning rate scheduler step
Epoch-15 lr: 8.9636024780611e-05
Epoch-15 lr: 0.000179272049561222
epoch 15 training time: 15.246
---------------
2023-09-24 17:25:50.675866
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00762	Per Sample Data Time 0.00198	Per Sample DNN Time 0.00564	Train Loss 0.0686	
start validation
acc: 0.732394
AUC: 0.898906
Avg Precision: 0.453087
Avg Recall: 1.000000
d_prime: 1.803604
train_loss: 0.063550
valid_loss: 1.333573
validation finished
normal learning rate scheduler step
Epoch-16 lr: 8.9636024780611e-05
Epoch-16 lr: 0.000179272049561222
epoch 16 training time: 15.050
---------------
2023-09-24 17:26:05.726065
current #epochs=17, #steps=624
start validation
acc: 0.713615
AUC: 0.898368
Avg Precision: 0.466361
Avg Recall: 1.000000
d_prime: 1.799314
train_loss: 0.058684
valid_loss: 1.336882
validation finished
normal learning rate scheduler step
Epoch-17 lr: 8.9636024780611e-05
Epoch-17 lr: 0.000179272049561222
epoch 17 training time: 15.261
---------------
2023-09-24 17:26:20.986827
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00649	Per Sample Data Time 0.00095	Per Sample DNN Time 0.00554	Train Loss 0.0579	
start validation
acc: 0.718310
AUC: 0.900788
Avg Precision: 0.477248
Avg Recall: 1.000000
d_prime: 1.818759
train_loss: 0.059456
valid_loss: 1.334860
validation finished
normal learning rate scheduler step
Epoch-18 lr: 8.9636024780611e-05
Epoch-18 lr: 0.000179272049561222
epoch 18 training time: 15.148
---------------
2023-09-24 17:26:36.135315
current #epochs=19, #steps=702
start validation
acc: 0.741784
AUC: 0.900677
Avg Precision: 0.472839
Avg Recall: 1.000000
d_prime: 1.817855
train_loss: 0.049655
valid_loss: 1.334683
validation finished
normal learning rate scheduler step
Epoch-19 lr: 8.9636024780611e-05
Epoch-19 lr: 0.000179272049561222
epoch 19 training time: 15.151
---------------
2023-09-24 17:26:51.286244
current #epochs=20, #steps=741
start validation
acc: 0.746479
AUC: 0.898393
Avg Precision: 0.471544
Avg Recall: 1.000000
d_prime: 1.799515
train_loss: 0.080707
valid_loss: 1.338344
validation finished
normal learning rate scheduler step
Epoch-20 lr: 8.9636024780611e-05
Epoch-20 lr: 0.000179272049561222
epoch 20 training time: 15.116
---------------
2023-09-24 17:27:06.402538
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00564	Train Loss 0.0506	
start validation
acc: 0.737089
AUC: 0.897812
Avg Precision: 0.470386
Avg Recall: 1.000000
d_prime: 1.794897
train_loss: 0.056678
valid_loss: 1.341432
validation finished
normal learning rate scheduler step
Epoch-21 lr: 6.66578538559365e-05
Epoch-21 lr: 0.000133315707711873
epoch 21 training time: 15.188
---------------
2023-09-24 17:27:21.591226
current #epochs=22, #steps=819
start validation
acc: 0.718310
AUC: 0.898983
Avg Precision: 0.469656
Avg Recall: 1.000000
d_prime: 1.804220
train_loss: 0.057228
valid_loss: 1.336876
validation finished
normal learning rate scheduler step
Epoch-22 lr: 6.66578538559365e-05
Epoch-22 lr: 0.000133315707711873
epoch 22 training time: 15.064
---------------
2023-09-24 17:27:36.654789
current #epochs=23, #steps=858
start validation
acc: 0.723005
AUC: 0.901045
Avg Precision: 0.476716
Avg Recall: 1.000000
d_prime: 1.820844
train_loss: 0.051115
valid_loss: 1.330947
validation finished
normal learning rate scheduler step
Epoch-23 lr: 6.66578538559365e-05
Epoch-23 lr: 0.000133315707711873
epoch 23 training time: 15.279
---------------
2023-09-24 17:27:51.933814
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01388	Per Sample Data Time 0.00763	Per Sample DNN Time 0.00624	Train Loss 0.1411	
start validation
acc: 0.727700
AUC: 0.900785
Avg Precision: 0.475165
Avg Recall: 1.000000
d_prime: 1.818733
train_loss: 0.057407
valid_loss: 1.331249
validation finished
normal learning rate scheduler step
Epoch-24 lr: 6.66578538559365e-05
Epoch-24 lr: 0.000133315707711873
epoch 24 training time: 15.064
---------------
2023-09-24 17:28:06.998059
current #epochs=25, #steps=936
start validation
acc: 0.732394
AUC: 0.900692
Avg Precision: 0.475371
Avg Recall: 1.000000
d_prime: 1.817979
train_loss: 0.066627
valid_loss: 1.334160
validation finished
normal learning rate scheduler step
Epoch-25 lr: 6.66578538559365e-05
Epoch-25 lr: 0.000133315707711873
epoch 25 training time: 15.040
---------------
2023-09-24 17:28:22.038556
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00696	Per Sample Data Time 0.00135	Per Sample DNN Time 0.00560	Train Loss 0.0535	
start validation
acc: 0.746479
AUC: 0.899762
Avg Precision: 0.475369
Avg Recall: 1.000000
d_prime: 1.810471
train_loss: 0.054553
valid_loss: 1.335246
validation finished
normal learning rate scheduler step
Epoch-26 lr: 6.66578538559365e-05
Epoch-26 lr: 0.000133315707711873
epoch 26 training time: 16.498
---------------
2023-09-24 17:28:38.536111
current #epochs=27, #steps=1014
start validation
acc: 0.732394
AUC: 0.899891
Avg Precision: 0.475693
Avg Recall: 1.000000
d_prime: 1.811510
train_loss: 0.047225
valid_loss: 1.332772
validation finished
normal learning rate scheduler step
Epoch-27 lr: 6.66578538559365e-05
Epoch-27 lr: 0.000133315707711873
epoch 27 training time: 15.092
---------------
2023-09-24 17:28:53.628571
current #epochs=28, #steps=1053
start validation
acc: 0.732394
AUC: 0.898191
Avg Precision: 0.474227
Avg Recall: 1.000000
d_prime: 1.797903
train_loss: 0.067004
valid_loss: 1.334301
validation finished
normal learning rate scheduler step
Epoch-28 lr: 6.66578538559365e-05
Epoch-28 lr: 0.000133315707711873
epoch 28 training time: 15.216
---------------
2023-09-24 17:29:08.844494
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00935	Per Sample Data Time 0.00350	Per Sample DNN Time 0.00585	Train Loss 0.0520	
start validation
acc: 0.737089
AUC: 0.896796
Avg Precision: 0.474770
Avg Recall: 1.000000
d_prime: 1.786866
train_loss: 0.058847
valid_loss: 1.335321
validation finished
normal learning rate scheduler step
Epoch-29 lr: 6.66578538559365e-05
Epoch-29 lr: 0.000133315707711873
epoch 29 training time: 15.184
---------------
2023-09-24 17:29:24.027852
current #epochs=30, #steps=1131
start validation
acc: 0.732394
AUC: 0.895108
Avg Precision: 0.474338
Avg Recall: 1.000000
d_prime: 1.773651
train_loss: 0.041741
valid_loss: 1.336581
validation finished
normal learning rate scheduler step
Epoch-30 lr: 4.957013088827321e-05
Epoch-30 lr: 9.914026177654642e-05
epoch 30 training time: 15.175
---------------
2023-09-24 17:29:39.203288
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00665	Per Sample Data Time 0.00110	Per Sample DNN Time 0.00555	Train Loss 0.0502	
start validation
acc: 0.732394
AUC: 0.895221
Avg Precision: 0.465412
Avg Recall: 1.000000
d_prime: 1.774526
train_loss: 0.048529
valid_loss: 1.335115
validation finished
normal learning rate scheduler step
Epoch-31 lr: 4.957013088827321e-05
Epoch-31 lr: 9.914026177654642e-05
epoch 31 training time: 15.055
---------------
2023-09-24 17:29:54.258308
current #epochs=32, #steps=1209
start validation
acc: 0.732394
AUC: 0.894900
Avg Precision: 0.458758
Avg Recall: 1.000000
d_prime: 1.772031
train_loss: 0.046378
valid_loss: 1.333861
validation finished
normal learning rate scheduler step
Epoch-32 lr: 4.957013088827321e-05
Epoch-32 lr: 9.914026177654642e-05
epoch 32 training time: 15.143
---------------
2023-09-24 17:30:09.400768
current #epochs=33, #steps=1248
start validation
acc: 0.732394
AUC: 0.894849
Avg Precision: 0.455358
Avg Recall: 1.000000
d_prime: 1.771635
train_loss: 0.058299
valid_loss: 1.333801
validation finished
normal learning rate scheduler step
Epoch-33 lr: 4.957013088827321e-05
Epoch-33 lr: 9.914026177654642e-05
epoch 33 training time: 15.164
---------------
2023-09-24 17:30:24.565198
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00806	Per Sample Data Time 0.00248	Per Sample DNN Time 0.00559	Train Loss 0.0526	
start validation
acc: 0.723005
AUC: 0.893510
Avg Precision: 0.454962
Avg Recall: 1.000000
d_prime: 1.761278
train_loss: 0.059018
valid_loss: 1.335739
validation finished
normal learning rate scheduler step
Epoch-34 lr: 4.957013088827321e-05
Epoch-34 lr: 9.914026177654642e-05
epoch 34 training time: 15.278
---------------
2023-09-24 17:30:39.843164
current #epochs=35, #steps=1326
start validation
acc: 0.723005
AUC: 0.894202
Avg Precision: 0.462079
Avg Recall: 1.000000
d_prime: 1.766621
train_loss: 0.057660
valid_loss: 1.336225
validation finished
normal learning rate scheduler step
Epoch-35 lr: 4.957013088827321e-05
Epoch-35 lr: 9.914026177654642e-05
epoch 35 training time: 15.178
---------------
2023-09-24 17:30:55.020566
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00652	Per Sample Data Time 0.00098	Per Sample DNN Time 0.00554	Train Loss 0.0524	
start validation
acc: 0.718310
AUC: 0.895561
Avg Precision: 0.462087
Avg Recall: 1.000000
d_prime: 1.777179
train_loss: 0.052114
valid_loss: 1.334688
validation finished
normal learning rate scheduler step
Epoch-36 lr: 4.957013088827321e-05
Epoch-36 lr: 9.914026177654642e-05
epoch 36 training time: 15.099
---------------
2023-09-24 17:31:10.119471
current #epochs=37, #steps=1404
start validation
acc: 0.727700
AUC: 0.896212
Avg Precision: 0.461657
Avg Recall: 1.000000
d_prime: 1.782277
train_loss: 0.047337
valid_loss: 1.333771
validation finished
normal learning rate scheduler step
Epoch-37 lr: 4.957013088827321e-05
Epoch-37 lr: 9.914026177654642e-05
epoch 37 training time: 15.263
---------------
2023-09-24 17:31:25.382810
current #epochs=38, #steps=1443
start validation
acc: 0.723005
AUC: 0.897223
Avg Precision: 0.448350
Avg Recall: 1.000000
d_prime: 1.790234
train_loss: 0.057687
valid_loss: 1.328628
validation finished
normal learning rate scheduler step
Epoch-38 lr: 4.957013088827321e-05
Epoch-38 lr: 9.914026177654642e-05
epoch 38 training time: 15.152
---------------
2023-09-24 17:31:40.534326
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00732	Per Sample Data Time 0.00174	Per Sample DNN Time 0.00558	Train Loss 0.0541	
start validation
acc: 0.737089
AUC: 0.896316
Avg Precision: 0.449813
Avg Recall: 1.000000
d_prime: 1.783092
train_loss: 0.050766
valid_loss: 1.334051
validation finished
normal learning rate scheduler step
Epoch-39 lr: 3.6862841122834944e-05
Epoch-39 lr: 7.372568224566989e-05
epoch 39 training time: 15.053
---------------
2023-09-24 17:31:55.587249
current #epochs=40, #steps=1521
start validation
[I 2023-09-24 17:32:10,726] Trial 49 finished with value: 0.4619911236260277 and parameters: {'warmup': 'True', 'num_epochs': 40, 'batch_size': 49, 'lr-adaptschedule': 'True', 'lr': 0.00016208585280074494, 'head-lr': 2, 'lr-scheduler-start': 3, 'lr-scheduler-step': 9, 'lr-scheduler-decay': 0.7436502680600259}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.727700
AUC: 0.895797
Avg Precision: 0.461991
Avg Recall: 1.000000
d_prime: 1.779027
train_loss: 0.057310
valid_loss: 1.337622
validation finished
normal learning rate scheduler step
Epoch-40 lr: 3.6862841122834944e-05
Epoch-40 lr: 7.372568224566989e-05
epoch 40 training time: 15.129
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa609e9cd00>
The learning rate scheduler starts at 6 epoch with decay rate of 0.763 every 4 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 17:32:10.763234
current #epochs=1, #steps=0
start validation
acc: 0.708920
AUC: 0.890436
Avg Precision: 0.462168
Avg Recall: 1.000000
d_prime: 1.737858
train_loss: 0.057997
valid_loss: 1.335626
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.00043528186591247923
Epoch-1 lr: 0.00043528186591247923
epoch 1 training time: 18.534
---------------
2023-09-24 17:32:29.297356
current #epochs=2, #steps=39
start validation
acc: 0.737089
AUC: 0.889019
Avg Precision: 0.462338
Avg Recall: 1.000000
d_prime: 1.727216
train_loss: 0.074752
valid_loss: 1.360213
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.00043528186591247923
Epoch-2 lr: 0.00043528186591247923
epoch 2 training time: 17.687
---------------
2023-09-24 17:32:46.984534
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00698	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00551	Train Loss 0.0753	
start validation
acc: 0.713615
AUC: 0.899713
Avg Precision: 0.449871
Avg Recall: 1.000000
d_prime: 1.810080
train_loss: 0.072541
valid_loss: 1.336938
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.00043528186591247923
Epoch-3 lr: 0.00043528186591247923
epoch 3 training time: 15.565
---------------
2023-09-24 17:33:02.549599
current #epochs=4, #steps=117
start validation
acc: 0.723005
AUC: 0.897584
Avg Precision: 0.461834
Avg Recall: 1.000000
d_prime: 1.793084
train_loss: 0.065397
valid_loss: 1.334389
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00043528186591247923
Epoch-4 lr: 0.00043528186591247923
epoch 4 training time: 15.049
---------------
2023-09-24 17:33:17.598565
current #epochs=5, #steps=156
start validation
acc: 0.699531
AUC: 0.895163
Avg Precision: 0.462335
Avg Recall: 1.000000
d_prime: 1.774080
train_loss: 0.070712
valid_loss: 1.346124
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00043528186591247923
Epoch-5 lr: 0.00043528186591247923
epoch 5 training time: 15.191
---------------
2023-09-24 17:33:32.789998
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01136	Per Sample Data Time 0.00514	Per Sample DNN Time 0.00622	Train Loss 0.0893	
start validation
acc: 0.727700
AUC: 0.900758
Avg Precision: 0.470302
Avg Recall: 1.000000
d_prime: 1.818511
train_loss: 0.067302
valid_loss: 1.328694
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00033210352785953987
Epoch-6 lr: 0.00033210352785953987
epoch 6 training time: 15.178
---------------
2023-09-24 17:33:47.967365
current #epochs=7, #steps=234
start validation
acc: 0.713615
AUC: 0.899364
Avg Precision: 0.473652
Avg Recall: 1.000000
d_prime: 1.807275
train_loss: 0.064977
valid_loss: 1.335919
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00033210352785953987
Epoch-7 lr: 0.00033210352785953987
epoch 7 training time: 15.165
---------------
2023-09-24 17:34:03.132273
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00670	Per Sample Data Time 0.00120	Per Sample DNN Time 0.00550	Train Loss 0.0362	
start validation
acc: 0.732394
AUC: 0.899949
Avg Precision: 0.477027
Avg Recall: 1.000000
d_prime: 1.811974
train_loss: 0.037318
valid_loss: 1.329096
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00033210352785953987
Epoch-8 lr: 0.00033210352785953987
epoch 8 training time: 15.027
---------------
2023-09-24 17:34:18.159419
current #epochs=9, #steps=312
start validation
acc: 0.723005
AUC: 0.903061
Avg Precision: 0.462443
Avg Recall: 1.000000
d_prime: 1.837334
train_loss: 0.040238
valid_loss: 1.329248
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00033210352785953987
Epoch-9 lr: 0.00033210352785953987
epoch 9 training time: 15.144
---------------
2023-09-24 17:34:33.303188
current #epochs=10, #steps=351
start validation
acc: 0.727700
AUC: 0.901935
Avg Precision: 0.479427
Avg Recall: 1.000000
d_prime: 1.828091
train_loss: 0.068623
valid_loss: 1.339859
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00025338237554543196
Epoch-10 lr: 0.00025338237554543196
epoch 10 training time: 15.283
---------------
2023-09-24 17:34:48.585944
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00856	Per Sample Data Time 0.00291	Per Sample DNN Time 0.00566	Train Loss 0.0407	
start validation
acc: 0.737089
AUC: 0.900040
Avg Precision: 0.479566
Avg Recall: 1.000000
d_prime: 1.812710
train_loss: 0.073175
valid_loss: 1.331652
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00025338237554543196
Epoch-11 lr: 0.00025338237554543196
epoch 11 training time: 15.092
---------------
2023-09-24 17:35:03.677469
current #epochs=12, #steps=429
start validation
acc: 0.718310
AUC: 0.899117
Avg Precision: 0.476174
Avg Recall: 1.000000
d_prime: 1.805291
train_loss: 0.057288
valid_loss: 1.336701
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00025338237554543196
Epoch-12 lr: 0.00025338237554543196
epoch 12 training time: 15.123
---------------
2023-09-24 17:35:18.801000
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00660	Per Sample Data Time 0.00107	Per Sample DNN Time 0.00553	Train Loss 0.0713	
start validation
acc: 0.718310
AUC: 0.900315
Avg Precision: 0.472581
Avg Recall: 1.000000
d_prime: 1.814927
train_loss: 0.068222
valid_loss: 1.338902
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00025338237554543196
Epoch-13 lr: 0.00025338237554543196
epoch 13 training time: 15.149
---------------
2023-09-24 17:35:33.950131
current #epochs=14, #steps=507
start validation
acc: 0.737089
AUC: 0.901212
Avg Precision: 0.458282
Avg Recall: 1.000000
d_prime: 1.822194
train_loss: 0.053563
valid_loss: 1.335433
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.00019332112685114332
Epoch-14 lr: 0.00019332112685114332
epoch 14 training time: 15.169
---------------
2023-09-24 17:35:49.119281
current #epochs=15, #steps=546
start validation
acc: 0.713615
AUC: 0.901492
Avg Precision: 0.464937
Avg Recall: 1.000000
d_prime: 1.824479
train_loss: 0.049342
valid_loss: 1.331305
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.00019332112685114332
Epoch-15 lr: 0.00019332112685114332
epoch 15 training time: 15.216
---------------
2023-09-24 17:36:04.335618
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00766	Per Sample Data Time 0.00197	Per Sample DNN Time 0.00569	Train Loss 0.0689	
start validation
acc: 0.737089
AUC: 0.899589
Avg Precision: 0.475545
Avg Recall: 1.000000
d_prime: 1.809078
train_loss: 0.060012
valid_loss: 1.332436
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.00019332112685114332
Epoch-16 lr: 0.00019332112685114332
epoch 16 training time: 15.203
---------------
2023-09-24 17:36:19.538940
current #epochs=17, #steps=624
start validation
acc: 0.732394
AUC: 0.896834
Avg Precision: 0.483385
Avg Recall: 1.000000
d_prime: 1.787167
train_loss: 0.054324
valid_loss: 1.339832
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.00019332112685114332
Epoch-17 lr: 0.00019332112685114332
epoch 17 training time: 15.130
---------------
2023-09-24 17:36:34.669638
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00652	Per Sample Data Time 0.00096	Per Sample DNN Time 0.00556	Train Loss 0.0726	
start validation
acc: 0.732394
AUC: 0.896158
Avg Precision: 0.474127
Avg Recall: 1.000000
d_prime: 1.781854
train_loss: 0.075937
valid_loss: 1.341798
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00014749667575160444
Epoch-18 lr: 0.00014749667575160444
epoch 18 training time: 15.178
---------------
2023-09-24 17:36:49.847962
current #epochs=19, #steps=702
start validation
acc: 0.727700
AUC: 0.898736
Avg Precision: 0.466833
Avg Recall: 1.000000
d_prime: 1.802249
train_loss: 0.059715
valid_loss: 1.337942
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00014749667575160444
Epoch-19 lr: 0.00014749667575160444
epoch 19 training time: 15.110
---------------
2023-09-24 17:37:04.958205
current #epochs=20, #steps=741
start validation
acc: 0.732394
AUC: 0.900662
Avg Precision: 0.465965
Avg Recall: 1.000000
d_prime: 1.817734
train_loss: 0.038501
valid_loss: 1.333040
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00014749667575160444
Epoch-20 lr: 0.00014749667575160444
epoch 20 training time: 15.219
---------------
2023-09-24 17:37:20.176970
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00564	Train Loss 0.0584	
start validation
acc: 0.737089
AUC: 0.902119
Avg Precision: 0.469233
Avg Recall: 1.000000
d_prime: 1.829600
train_loss: 0.058058
valid_loss: 1.332648
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00014749667575160444
Epoch-21 lr: 0.00014749667575160444
epoch 21 training time: 15.153
---------------
2023-09-24 17:37:35.330053
current #epochs=22, #steps=819
start validation
acc: 0.737089
AUC: 0.901710
Avg Precision: 0.478364
Avg Recall: 1.000000
d_prime: 1.826256
train_loss: 0.057000
valid_loss: 1.331319
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00011253436037813616
Epoch-22 lr: 0.00011253436037813616
epoch 22 training time: 15.256
---------------
2023-09-24 17:37:50.586000
current #epochs=23, #steps=858
start validation
acc: 0.727700
AUC: 0.901686
Avg Precision: 0.473402
Avg Recall: 1.000000
d_prime: 1.826058
train_loss: 0.051291
valid_loss: 1.333505
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00011253436037813616
Epoch-23 lr: 0.00011253436037813616
epoch 23 training time: 15.167
---------------
2023-09-24 17:38:05.753498
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01406	Per Sample Data Time 0.00804	Per Sample DNN Time 0.00602	Train Loss 0.0161	
start validation
acc: 0.732394
AUC: 0.904571
Avg Precision: 0.473781
Avg Recall: 1.000000
d_prime: 1.849855
train_loss: 0.060852
valid_loss: 1.334373
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00011253436037813616
Epoch-24 lr: 0.00011253436037813616
epoch 24 training time: 15.250
---------------
2023-09-24 17:38:21.003696
current #epochs=25, #steps=936
start validation
acc: 0.741784
AUC: 0.904919
Avg Precision: 0.475025
Avg Recall: 1.000000
d_prime: 1.852759
train_loss: 0.050932
valid_loss: 1.336159
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00011253436037813616
Epoch-25 lr: 0.00011253436037813616
epoch 25 training time: 17.522
---------------
2023-09-24 17:38:38.525340
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00691	Per Sample Data Time 0.00133	Per Sample DNN Time 0.00558	Train Loss 0.0557	
start validation
acc: 0.746479
AUC: 0.904580
Avg Precision: 0.472958
Avg Recall: 1.000000
d_prime: 1.849930
train_loss: 0.050304
valid_loss: 1.334434
validation finished
normal learning rate scheduler step
Epoch-26 lr: 8.585944192425955e-05
Epoch-26 lr: 8.585944192425955e-05
epoch 26 training time: 17.483
---------------
2023-09-24 17:38:56.008984
current #epochs=27, #steps=1014
start validation
acc: 0.737089
AUC: 0.902223
Avg Precision: 0.472603
Avg Recall: 1.000000
d_prime: 1.830453
train_loss: 0.064917
valid_loss: 1.337451
validation finished
normal learning rate scheduler step
Epoch-27 lr: 8.585944192425955e-05
Epoch-27 lr: 8.585944192425955e-05
epoch 27 training time: 15.242
---------------
2023-09-24 17:39:11.251140
current #epochs=28, #steps=1053
start validation
acc: 0.737089
AUC: 0.900353
Avg Precision: 0.471173
Avg Recall: 1.000000
d_prime: 1.815236
train_loss: 0.056997
valid_loss: 1.336742
validation finished
normal learning rate scheduler step
Epoch-28 lr: 8.585944192425955e-05
Epoch-28 lr: 8.585944192425955e-05
epoch 28 training time: 15.123
---------------
2023-09-24 17:39:26.374062
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00941	Per Sample Data Time 0.00354	Per Sample DNN Time 0.00587	Train Loss 0.0482	
start validation
acc: 0.727700
AUC: 0.899948
Avg Precision: 0.475482
Avg Recall: 1.000000
d_prime: 1.811966
train_loss: 0.052615
valid_loss: 1.333455
validation finished
normal learning rate scheduler step
Epoch-29 lr: 8.585944192425955e-05
Epoch-29 lr: 8.585944192425955e-05
epoch 29 training time: 15.250
---------------
2023-09-24 17:39:41.624489
current #epochs=30, #steps=1131
start validation
acc: 0.732394
AUC: 0.900782
Avg Precision: 0.475822
Avg Recall: 1.000000
d_prime: 1.818708
train_loss: 0.060298
valid_loss: 1.332881
validation finished
normal learning rate scheduler step
Epoch-30 lr: 6.550749249184468e-05
Epoch-30 lr: 6.550749249184468e-05
epoch 30 training time: 15.124
---------------
2023-09-24 17:39:56.748887
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00667	Per Sample Data Time 0.00109	Per Sample DNN Time 0.00558	Train Loss 0.0508	
start validation
acc: 0.732394
AUC: 0.901547
Avg Precision: 0.477939
Avg Recall: 1.000000
d_prime: 1.824923
train_loss: 0.053900
valid_loss: 1.332145
validation finished
normal learning rate scheduler step
Epoch-31 lr: 6.550749249184468e-05
Epoch-31 lr: 6.550749249184468e-05
epoch 31 training time: 15.130
---------------
2023-09-24 17:40:11.879268
current #epochs=32, #steps=1209
start validation
acc: 0.723005
AUC: 0.900786
Avg Precision: 0.478076
Avg Recall: 1.000000
d_prime: 1.818738
train_loss: 0.058471
valid_loss: 1.331735
validation finished
normal learning rate scheduler step
Epoch-32 lr: 6.550749249184468e-05
Epoch-32 lr: 6.550749249184468e-05
epoch 32 training time: 15.244
---------------
2023-09-24 17:40:27.123632
current #epochs=33, #steps=1248
start validation
acc: 0.708920
AUC: 0.900368
Avg Precision: 0.478167
Avg Recall: 1.000000
d_prime: 1.815357
train_loss: 0.049608
valid_loss: 1.333685
validation finished
normal learning rate scheduler step
Epoch-33 lr: 6.550749249184468e-05
Epoch-33 lr: 6.550749249184468e-05
epoch 33 training time: 16.084
---------------
2023-09-24 17:40:43.207026
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00788	Per Sample Data Time 0.00230	Per Sample DNN Time 0.00558	Train Loss 0.0437	
start validation
acc: 0.708920
AUC: 0.899301
Avg Precision: 0.478076
Avg Recall: 1.000000
d_prime: 1.806767
train_loss: 0.047779
valid_loss: 1.334953
validation finished
normal learning rate scheduler step
Epoch-34 lr: 4.9979728220858625e-05
Epoch-34 lr: 4.9979728220858625e-05
epoch 34 training time: 15.132
---------------
2023-09-24 17:40:58.338797
current #epochs=35, #steps=1326
start validation
acc: 0.713615
AUC: 0.899116
Avg Precision: 0.476865
Avg Recall: 1.000000
d_prime: 1.805291
train_loss: 0.046328
valid_loss: 1.333935
validation finished
normal learning rate scheduler step
Epoch-35 lr: 4.9979728220858625e-05
Epoch-35 lr: 4.9979728220858625e-05
epoch 35 training time: 15.100
---------------
2023-09-24 17:41:13.439008
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00663	Per Sample Data Time 0.00098	Per Sample DNN Time 0.00565	Train Loss 0.0442	
start validation
acc: 0.723005
AUC: 0.900174
Avg Precision: 0.478511
Avg Recall: 1.000000
d_prime: 1.813794
train_loss: 0.048159
valid_loss: 1.332664
validation finished
normal learning rate scheduler step
Epoch-36 lr: 4.9979728220858625e-05
Epoch-36 lr: 4.9979728220858625e-05
epoch 36 training time: 15.299
---------------
2023-09-24 17:41:28.738420
current #epochs=37, #steps=1404
start validation
acc: 0.723005
AUC: 0.900917
Avg Precision: 0.478961
Avg Recall: 1.000000
d_prime: 1.819804
train_loss: 0.051410
valid_loss: 1.332233
validation finished
normal learning rate scheduler step
Epoch-37 lr: 4.9979728220858625e-05
Epoch-37 lr: 4.9979728220858625e-05
epoch 37 training time: 16.475
---------------
2023-09-24 17:41:45.213677
current #epochs=38, #steps=1443
start validation
acc: 0.727700
AUC: 0.901132
Avg Precision: 0.477894
Avg Recall: 1.000000
d_prime: 1.821545
train_loss: 0.067217
valid_loss: 1.332189
validation finished
normal learning rate scheduler step
Epoch-38 lr: 3.813263396308256e-05
Epoch-38 lr: 3.813263396308256e-05
epoch 38 training time: 15.125
---------------
2023-09-24 17:42:00.338601
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00740	Per Sample Data Time 0.00173	Per Sample DNN Time 0.00568	Train Loss 0.0659	
start validation
acc: 0.723005
AUC: 0.901532
Avg Precision: 0.478432
Avg Recall: 1.000000
d_prime: 1.824803
train_loss: 0.062018
valid_loss: 1.333639
validation finished
normal learning rate scheduler step
Epoch-39 lr: 3.813263396308256e-05
Epoch-39 lr: 3.813263396308256e-05
epoch 39 training time: 15.256
---------------
2023-09-24 17:42:15.594739
current #epochs=40, #steps=1521
start validation
acc: 0.737089
AUC: 0.901679
Avg Precision: 0.477862
Avg Recall: 1.000000
d_prime: 1.826005
train_loss: 0.044182
valid_loss: 1.333929
validation finished
normal learning rate scheduler step
Epoch-40 lr: 3.813263396308256e-05
Epoch-40 lr: 3.813263396308256e-05
epoch 40 training time: 15.136
---------------
2023-09-24 17:42:30.730911
current #epochs=41, #steps=1560
start validation
acc: 0.732394
AUC: 0.902315
Avg Precision: 0.477435
Avg Recall: 1.000000
d_prime: 1.831203
train_loss: 0.040785
valid_loss: 1.331941
validation finished
normal learning rate scheduler step
Epoch-41 lr: 3.813263396308256e-05
Epoch-41 lr: 3.813263396308256e-05
epoch 41 training time: 15.013
---------------
2023-09-24 17:42:45.743930
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02213	Per Sample Data Time 0.01550	Per Sample DNN Time 0.00662	Train Loss 0.0276	
start validation
[I 2023-09-24 17:43:01,936] Trial 50 finished with value: 0.4772294808612531 and parameters: {'warmup': 'True', 'num_epochs': 42, 'batch_size': 56, 'lr-adaptschedule': 'True', 'lr': 0.00043528186591247923, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 4, 'lr-scheduler-decay': 0.762962011209341}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.732394
AUC: 0.901876
Avg Precision: 0.477229
Avg Recall: 1.000000
d_prime: 1.827608
train_loss: 0.040020
valid_loss: 1.331119
validation finished
normal learning rate scheduler step
Epoch-42 lr: 2.9093751101183095e-05
Epoch-42 lr: 2.9093751101183095e-05
epoch 42 training time: 16.181
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa609e9c1c0>
The learning rate scheduler starts at 7 epoch with decay rate of 0.774 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 17:43:01.973354
current #epochs=1, #steps=0
start validation
acc: 0.746479
AUC: 0.897980
Avg Precision: 0.468886
Avg Recall: 1.000000
d_prime: 1.796229
train_loss: 0.077094
valid_loss: 1.333509
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0007460298171311189
Epoch-1 lr: 0.0007460298171311189
epoch 1 training time: 17.725
---------------
2023-09-24 17:43:19.698463
current #epochs=2, #steps=39
start validation
acc: 0.741784
AUC: 0.904464
Avg Precision: 0.469191
Avg Recall: 1.000000
d_prime: 1.848960
train_loss: 0.083594
valid_loss: 1.326014
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0007460298171311189
Epoch-2 lr: 0.0007460298171311189
epoch 2 training time: 15.239
---------------
2023-09-24 17:43:34.937687
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00153	Per Sample DNN Time 0.00559	Train Loss 0.0970	
start validation
acc: 0.741784
AUC: 0.898230
Avg Precision: 0.484306
Avg Recall: 1.000000
d_prime: 1.798217
train_loss: 0.092906
valid_loss: 1.332525
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0007460298171311189
Epoch-3 lr: 0.0007460298171311189
epoch 3 training time: 15.257
---------------
2023-09-24 17:43:50.194403
current #epochs=4, #steps=117
start validation
acc: 0.755869
AUC: 0.902314
Avg Precision: 0.465985
Avg Recall: 1.000000
d_prime: 1.831191
train_loss: 0.074280
valid_loss: 1.331790
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0007460298171311189
Epoch-4 lr: 0.0007460298171311189
epoch 4 training time: 17.457
---------------
2023-09-24 17:44:07.651738
current #epochs=5, #steps=156
start validation
acc: 0.741784
AUC: 0.902277
Avg Precision: 0.458814
Avg Recall: 1.000000
d_prime: 1.830892
train_loss: 0.077074
valid_loss: 1.340026
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0007460298171311189
Epoch-5 lr: 0.0007460298171311189
epoch 5 training time: 15.277
---------------
2023-09-24 17:44:22.928850
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01116	Per Sample Data Time 0.00513	Per Sample DNN Time 0.00603	Train Loss 0.0556	
start validation
acc: 0.741784
AUC: 0.896434
Avg Precision: 0.437948
Avg Recall: 1.000000
d_prime: 1.784017
train_loss: 0.045517
valid_loss: 1.329091
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0007460298171311189
Epoch-6 lr: 0.0007460298171311189
epoch 6 training time: 15.215
---------------
2023-09-24 17:44:38.143529
current #epochs=7, #steps=234
start validation
acc: 0.751174
AUC: 0.899920
Avg Precision: 0.469212
Avg Recall: 1.000000
d_prime: 1.811746
train_loss: 0.075767
valid_loss: 1.333947
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0005774344269477783
Epoch-7 lr: 0.0005774344269477783
epoch 7 training time: 15.145
---------------
2023-09-24 17:44:53.288952
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00674	Per Sample Data Time 0.00119	Per Sample DNN Time 0.00555	Train Loss 0.0510	
start validation
acc: 0.727700
AUC: 0.907307
Avg Precision: 0.479672
Avg Recall: 1.000000
d_prime: 1.872917
train_loss: 0.048411
valid_loss: 1.328912
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00044693993425990217
Epoch-8 lr: 0.00044693993425990217
epoch 8 training time: 15.100
---------------
2023-09-24 17:45:08.389310
current #epochs=9, #steps=312
start validation
acc: 0.723005
AUC: 0.905705
Avg Precision: 0.476620
Avg Recall: 1.000000
d_prime: 1.859355
train_loss: 0.060425
valid_loss: 1.331843
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0003459359115321869
Epoch-9 lr: 0.0003459359115321869
epoch 9 training time: 15.073
---------------
2023-09-24 17:45:23.462255
current #epochs=10, #steps=351
start validation
acc: 0.723005
AUC: 0.904111
Avg Precision: 0.471033
Avg Recall: 1.000000
d_prime: 1.846030
train_loss: 0.047725
valid_loss: 1.321303
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0002677578030385045
Epoch-10 lr: 0.0002677578030385045
epoch 10 training time: 15.258
---------------
2023-09-24 17:45:38.720554
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00870	Per Sample Data Time 0.00291	Per Sample DNN Time 0.00579	Train Loss 0.0470	
start validation
acc: 0.727700
AUC: 0.902528
Avg Precision: 0.470870
Avg Recall: 1.000000
d_prime: 1.832950
train_loss: 0.041498
valid_loss: 1.325621
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.000207247177000113
Epoch-11 lr: 0.000207247177000113
epoch 11 training time: 15.162
---------------
2023-09-24 17:45:53.883315
current #epochs=12, #steps=429
start validation
acc: 0.732394
AUC: 0.902659
Avg Precision: 0.464478
Avg Recall: 1.000000
d_prime: 1.834028
train_loss: 0.083593
valid_loss: 1.330815
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.000160411356409059
Epoch-12 lr: 0.000160411356409059
epoch 12 training time: 15.207
---------------
2023-09-24 17:46:09.090243
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00664	Per Sample Data Time 0.00107	Per Sample DNN Time 0.00557	Train Loss 0.0778	
start validation
acc: 0.732394
AUC: 0.903982
Avg Precision: 0.467970
Avg Recall: 1.000000
d_prime: 1.844952
train_loss: 0.071965
valid_loss: 1.334518
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00012415996993281182
Epoch-13 lr: 0.00012415996993281182
epoch 13 training time: 15.547
---------------
2023-09-24 17:46:24.637253
current #epochs=14, #steps=507
start validation
acc: 0.737089
AUC: 0.903269
Avg Precision: 0.470234
Avg Recall: 1.000000
d_prime: 1.839055
train_loss: 0.064853
valid_loss: 1.332615
validation finished
normal learning rate scheduler step
Epoch-14 lr: 9.610103971944315e-05
Epoch-14 lr: 9.610103971944315e-05
epoch 14 training time: 15.073
---------------
2023-09-24 17:46:39.710644
current #epochs=15, #steps=546
start validation
acc: 0.732394
AUC: 0.902739
Avg Precision: 0.476835
Avg Recall: 1.000000
d_prime: 1.834680
train_loss: 0.045185
valid_loss: 1.331932
validation finished
normal learning rate scheduler step
Epoch-15 lr: 7.438315135027546e-05
Epoch-15 lr: 7.438315135027546e-05
epoch 15 training time: 15.140
---------------
2023-09-24 17:46:54.850530
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00773	Per Sample Data Time 0.00198	Per Sample DNN Time 0.00574	Train Loss 0.0555	
start validation
acc: 0.732394
AUC: 0.902691
Avg Precision: 0.476229
Avg Recall: 1.000000
d_prime: 1.834293
train_loss: 0.062701
valid_loss: 1.330202
validation finished
normal learning rate scheduler step
Epoch-16 lr: 5.7573291828585486e-05
Epoch-16 lr: 5.7573291828585486e-05
epoch 16 training time: 15.107
---------------
2023-09-24 17:47:09.957817
current #epochs=17, #steps=624
start validation
acc: 0.727700
AUC: 0.903781
Avg Precision: 0.477249
Avg Recall: 1.000000
d_prime: 1.843288
train_loss: 0.056453
valid_loss: 1.330630
validation finished
normal learning rate scheduler step
Epoch-17 lr: 4.4562294979549736e-05
Epoch-17 lr: 4.4562294979549736e-05
epoch 17 training time: 15.307
---------------
2023-09-24 17:47:25.264800
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00648	Per Sample Data Time 0.00093	Per Sample DNN Time 0.00555	Train Loss 0.0539	
start validation
acc: 0.732394
AUC: 0.905379
Avg Precision: 0.481160
Avg Recall: 1.000000
d_prime: 1.856611
train_loss: 0.053821
valid_loss: 1.330319
validation finished
normal learning rate scheduler step
Epoch-18 lr: 3.4491655258427364e-05
Epoch-18 lr: 3.4491655258427364e-05
epoch 18 training time: 15.882
---------------
2023-09-24 17:47:41.146975
current #epochs=19, #steps=702
start validation
acc: 0.727700
AUC: 0.905390
Avg Precision: 0.480761
Avg Recall: 1.000000
d_prime: 1.856705
train_loss: 0.049680
valid_loss: 1.330273
validation finished
normal learning rate scheduler step
Epoch-19 lr: 2.6696880917200476e-05
Epoch-19 lr: 2.6696880917200476e-05
epoch 19 training time: 15.134
---------------
2023-09-24 17:47:56.280641
current #epochs=20, #steps=741
start validation
acc: 0.732394
AUC: 0.904904
Avg Precision: 0.481188
Avg Recall: 1.000000
d_prime: 1.852638
train_loss: 0.049359
valid_loss: 1.331381
validation finished
normal learning rate scheduler step
Epoch-20 lr: 2.0663648797575257e-05
Epoch-20 lr: 2.0663648797575257e-05
epoch 20 training time: 15.200
---------------
2023-09-24 17:48:11.480428
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00157	Per Sample DNN Time 0.00562	Train Loss 0.0753	
start validation
acc: 0.737089
AUC: 0.904710
Avg Precision: 0.480387
Avg Recall: 1.000000
d_prime: 1.851014
train_loss: 0.061819
valid_loss: 1.331781
validation finished
normal learning rate scheduler step
Epoch-21 lr: 1.599386770888397e-05
Epoch-21 lr: 1.599386770888397e-05
epoch 21 training time: 15.290
---------------
2023-09-24 17:48:26.770657
current #epochs=22, #steps=819
start validation
acc: 0.737089
AUC: 0.904078
Avg Precision: 0.478830
Avg Recall: 1.000000
d_prime: 1.845755
train_loss: 0.057859
valid_loss: 1.330948
validation finished
normal learning rate scheduler step
Epoch-22 lr: 1.2379411148301082e-05
Epoch-22 lr: 1.2379411148301082e-05
epoch 22 training time: 15.126
---------------
2023-09-24 17:48:41.896453
current #epochs=23, #steps=858
start validation
acc: 0.737089
AUC: 0.904042
Avg Precision: 0.478660
Avg Recall: 1.000000
d_prime: 1.845452
train_loss: 0.052404
valid_loss: 1.330463
validation finished
normal learning rate scheduler step
Epoch-23 lr: 9.581786167554507e-06
Epoch-23 lr: 9.581786167554507e-06
epoch 23 training time: 15.161
---------------
2023-09-24 17:48:57.056844
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01429	Per Sample Data Time 0.00778	Per Sample DNN Time 0.00651	Train Loss 0.0504	
start validation
acc: 0.737089
AUC: 0.903591
Avg Precision: 0.479437
Avg Recall: 1.000000
d_prime: 1.841713
train_loss: 0.068653
valid_loss: 1.330660
validation finished
normal learning rate scheduler step
Epoch-24 lr: 7.41639687549587e-06
Epoch-24 lr: 7.41639687549587e-06
epoch 24 training time: 15.242
---------------
2023-09-24 17:49:12.298942
current #epochs=25, #steps=936
start validation
acc: 0.741784
AUC: 0.903555
Avg Precision: 0.479437
Avg Recall: 1.000000
d_prime: 1.841415
train_loss: 0.067960
valid_loss: 1.330606
validation finished
normal learning rate scheduler step
Epoch-25 lr: 5.740364234083395e-06
Epoch-25 lr: 5.740364234083395e-06
epoch 25 training time: 15.046
---------------
2023-09-24 17:49:27.344761
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00695	Per Sample Data Time 0.00135	Per Sample DNN Time 0.00560	Train Loss 0.0896	
start validation
acc: 0.741784
AUC: 0.903757
Avg Precision: 0.479869
Avg Recall: 1.000000
d_prime: 1.843085
train_loss: 0.082692
valid_loss: 1.330667
validation finished
normal learning rate scheduler step
Epoch-26 lr: 4.443098460496109e-06
Epoch-26 lr: 4.443098460496109e-06
epoch 26 training time: 15.214
---------------
2023-09-24 17:49:42.559012
current #epochs=27, #steps=1014
start validation
acc: 0.741784
AUC: 0.903559
Avg Precision: 0.479869
Avg Recall: 1.000000
d_prime: 1.841448
train_loss: 0.038814
valid_loss: 1.330854
validation finished
normal learning rate scheduler step
Epoch-27 lr: 3.4390019735071905e-06
Epoch-27 lr: 3.4390019735071905e-06
epoch 27 training time: 15.826
---------------
2023-09-24 17:49:58.385254
current #epochs=28, #steps=1053
start validation
acc: 0.741784
AUC: 0.903472
Avg Precision: 0.479869
Avg Recall: 1.000000
d_prime: 1.840731
train_loss: 0.042229
valid_loss: 1.330917
validation finished
normal learning rate scheduler step
Epoch-28 lr: 2.6618214021000558e-06
Epoch-28 lr: 2.6618214021000558e-06
epoch 28 training time: 15.242
---------------
2023-09-24 17:50:13.626965
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00908	Per Sample Data Time 0.00346	Per Sample DNN Time 0.00562	Train Loss 0.0521	
start validation
acc: 0.737089
AUC: 0.903481
Avg Precision: 0.479869
Avg Recall: 1.000000
d_prime: 1.840801
train_loss: 0.056089
valid_loss: 1.331100
validation finished
normal learning rate scheduler step
Epoch-29 lr: 2.060275984503762e-06
Epoch-29 lr: 2.060275984503762e-06
epoch 29 training time: 15.034
---------------
2023-09-24 17:50:28.661374
current #epochs=30, #steps=1131
start validation
acc: 0.737089
AUC: 0.903437
Avg Precision: 0.479869
Avg Recall: 1.000000
d_prime: 1.840436
train_loss: 0.056638
valid_loss: 1.331246
validation finished
normal learning rate scheduler step
Epoch-30 lr: 1.5946739059855936e-06
Epoch-30 lr: 1.5946739059855936e-06
epoch 30 training time: 15.089
---------------
2023-09-24 17:50:43.750264
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00670	Per Sample Data Time 0.00107	Per Sample DNN Time 0.00563	Train Loss 0.0615	
start validation
acc: 0.737089
AUC: 0.903415
Avg Precision: 0.479869
Avg Recall: 1.000000
d_prime: 1.840259
train_loss: 0.062733
valid_loss: 1.331290
validation finished
normal learning rate scheduler step
Epoch-31 lr: 1.2342933109730215e-06
Epoch-31 lr: 1.2342933109730215e-06
epoch 31 training time: 15.186
---------------
2023-09-24 17:50:58.935860
current #epochs=32, #steps=1209
start validation
acc: 0.737089
AUC: 0.903438
Avg Precision: 0.479869
Avg Recall: 1.000000
d_prime: 1.840446
train_loss: 0.052821
valid_loss: 1.331267
validation finished
normal learning rate scheduler step
Epoch-32 lr: 9.55355180638735e-07
Epoch-32 lr: 9.55355180638735e-07
epoch 32 training time: 15.086
---------------
2023-09-24 17:51:14.021354
current #epochs=33, #steps=1248
start validation
acc: 0.737089
AUC: 0.903400
Avg Precision: 0.479869
Avg Recall: 1.000000
d_prime: 1.840137
train_loss: 0.061291
valid_loss: 1.331262
validation finished
normal learning rate scheduler step
Epoch-33 lr: 7.394543201840454e-07
Epoch-33 lr: 7.394543201840454e-07
epoch 33 training time: 16.275
---------------
2023-09-24 17:51:30.296735
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00804	Per Sample Data Time 0.00229	Per Sample DNN Time 0.00576	Train Loss 0.0643	
start validation
acc: 0.737089
AUC: 0.903358
Avg Precision: 0.479869
Avg Recall: 1.000000
d_prime: 1.839783
train_loss: 0.061675
valid_loss: 1.331255
validation finished
normal learning rate scheduler step
Epoch-34 lr: 5.723449275412648e-07
Epoch-34 lr: 5.723449275412648e-07
epoch 34 training time: 15.162
---------------
2023-09-24 17:51:45.458589
current #epochs=35, #steps=1326
start validation
acc: 0.737089
AUC: 0.903409
Avg Precision: 0.479869
Avg Recall: 1.000000
d_prime: 1.840206
train_loss: 0.055150
valid_loss: 1.331257
validation finished
normal learning rate scheduler step
Epoch-35 lr: 4.430006115870462e-07
Epoch-35 lr: 4.430006115870462e-07
epoch 35 training time: 15.243
---------------
2023-09-24 17:52:00.701099
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00654	Per Sample Data Time 0.00100	Per Sample DNN Time 0.00555	Train Loss 0.0547	
start validation
acc: 0.737089
AUC: 0.903430
Avg Precision: 0.479869
Avg Recall: 1.000000
d_prime: 1.840384
train_loss: 0.054157
valid_loss: 1.331252
validation finished
normal learning rate scheduler step
Epoch-36 lr: 3.4288683698056857e-07
Epoch-36 lr: 3.4288683698056857e-07
epoch 36 training time: 15.161
---------------
2023-09-24 17:52:15.861970
current #epochs=37, #steps=1404
start validation
acc: 0.737089
AUC: 0.903445
Avg Precision: 0.479869
Avg Recall: 1.000000
d_prime: 1.840508
train_loss: 0.044426
valid_loss: 1.331243
validation finished
normal learning rate scheduler step
Epoch-37 lr: 2.6539778930178096e-07
Epoch-37 lr: 2.6539778930178096e-07
epoch 37 training time: 15.086
---------------
2023-09-24 17:52:30.947696
current #epochs=38, #steps=1443
start validation
acc: 0.737089
AUC: 0.903445
Avg Precision: 0.479869
Avg Recall: 1.000000
d_prime: 1.840508
train_loss: 0.057086
valid_loss: 1.331245
validation finished
normal learning rate scheduler step
Epoch-38 lr: 2.0542050312145443e-07
Epoch-38 lr: 2.0542050312145443e-07
epoch 38 training time: 15.162
---------------
2023-09-24 17:52:46.109797
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00746	Per Sample Data Time 0.00175	Per Sample DNN Time 0.00571	Train Loss 0.0522	
start validation
acc: 0.737089
AUC: 0.903445
Avg Precision: 0.479869
Avg Recall: 1.000000
d_prime: 1.840508
train_loss: 0.049835
valid_loss: 1.331249
validation finished
normal learning rate scheduler step
Epoch-39 lr: 1.5899749283400795e-07
Epoch-39 lr: 1.5899749283400795e-07
epoch 39 training time: 15.146
---------------
2023-09-24 17:53:01.256078
current #epochs=40, #steps=1521
start validation
acc: 0.737089
AUC: 0.903430
Avg Precision: 0.479869
Avg Recall: 1.000000
d_prime: 1.840384
train_loss: 0.049417
valid_loss: 1.331257
validation finished
normal learning rate scheduler step
Epoch-40 lr: 1.230656255989868e-07
Epoch-40 lr: 1.230656255989868e-07
epoch 40 training time: 15.112
---------------
2023-09-24 17:53:16.368673
current #epochs=41, #steps=1560
start validation
acc: 0.737089
AUC: 0.903430
Avg Precision: 0.479869
Avg Recall: 1.000000
d_prime: 1.840384
train_loss: 0.061669
valid_loss: 1.331263
validation finished
normal learning rate scheduler step
Epoch-41 lr: 9.525400642563215e-08
Epoch-41 lr: 9.525400642563215e-08
epoch 41 training time: 15.392
---------------
2023-09-24 17:53:31.760453
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02270	Per Sample Data Time 0.01591	Per Sample DNN Time 0.00680	Train Loss 0.0662	
start validation
acc: 0.737089
AUC: 0.903430
Avg Precision: 0.479869
Avg Recall: 1.000000
d_prime: 1.840384
train_loss: 0.053577
valid_loss: 1.331262
validation finished
normal learning rate scheduler step
Epoch-42 lr: 7.37275392374804e-08
Epoch-42 lr: 7.37275392374804e-08
epoch 42 training time: 15.220
---------------
2023-09-24 17:53:46.980130
current #epochs=43, #steps=1638
start validation
acc: 0.737089
AUC: 0.903445
Avg Precision: 0.479869
Avg Recall: 1.000000
d_prime: 1.840508
train_loss: 0.062684
valid_loss: 1.331264
validation finished
normal learning rate scheduler step
Epoch-43 lr: 5.706584159541967e-08
Epoch-43 lr: 5.706584159541967e-08
epoch 43 training time: 15.183
---------------
2023-09-24 17:54:02.163365
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00700	Per Sample Data Time 0.00141	Per Sample DNN Time 0.00559	Train Loss 0.0484	
start validation
acc: 0.737089
AUC: 0.903445
Avg Precision: 0.479869
Avg Recall: 1.000000
d_prime: 1.840508
train_loss: 0.056437
valid_loss: 1.331264
validation finished
normal learning rate scheduler step
Epoch-44 lr: 4.4169523500630255e-08
Epoch-44 lr: 4.4169523500630255e-08
epoch 44 training time: 15.038
---------------
2023-09-24 17:54:17.201307
current #epochs=45, #steps=1716
start validation
acc: 0.737089
AUC: 0.903445
Avg Precision: 0.479869
Avg Recall: 1.000000
d_prime: 1.840508
train_loss: 0.061620
valid_loss: 1.331264
validation finished
normal learning rate scheduler step
Epoch-45 lr: 3.418764626489481e-08
Epoch-45 lr: 3.418764626489481e-08
epoch 45 training time: 15.227
---------------
2023-09-24 17:54:32.428704
current #epochs=46, #steps=1755
start validation
acc: 0.737089
AUC: 0.903445
Avg Precision: 0.479869
Avg Recall: 1.000000
d_prime: 1.840508
train_loss: 0.061496
valid_loss: 1.331265
validation finished
normal learning rate scheduler step
Epoch-46 lr: 2.6461574961679147e-08
Epoch-46 lr: 2.6461574961679147e-08
epoch 46 training time: 15.130
---------------
2023-09-24 17:54:47.559230
current #epochs=47, #steps=1794
Epoch: [47][6/39]	Per Sample Total Time 0.01060	Per Sample Data Time 0.00461	Per Sample DNN Time 0.00599	Train Loss 0.0383	
start validation
[I 2023-09-24 17:55:02,793] Trial 51 finished with value: 0.4798687061496804 and parameters: {'warmup': 'True', 'num_epochs': 47, 'batch_size': 40, 'lr-adaptschedule': 'True', 'lr': 0.0007460298171311189, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7740098501267959}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.737089
AUC: 0.903445
Avg Precision: 0.479869
Avg Recall: 1.000000
d_prime: 1.840508
train_loss: 0.041638
valid_loss: 1.331265
validation finished
normal learning rate scheduler step
Epoch-47 lr: 2.048151967020825e-08
Epoch-47 lr: 2.048151967020825e-08
epoch 47 training time: 15.225
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f556760>
The learning rate scheduler starts at 5 epoch with decay rate of 0.763 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 17:55:02.829657
current #epochs=1, #steps=0
start validation
acc: 0.727700
AUC: 0.902670
Avg Precision: 0.468280
Avg Recall: 1.000000
d_prime: 1.834118
train_loss: 0.043079
valid_loss: 1.329101
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0001348989276447525
Epoch-1 lr: 0.0001348989276447525
epoch 1 training time: 18.516
---------------
2023-09-24 17:55:21.346213
current #epochs=2, #steps=39
start validation
acc: 0.727700
AUC: 0.901494
Avg Precision: 0.462719
Avg Recall: 1.000000
d_prime: 1.824492
train_loss: 0.066641
valid_loss: 1.332062
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0001348989276447525
Epoch-2 lr: 0.0001348989276447525
epoch 2 training time: 15.225
---------------
2023-09-24 17:55:36.571097
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00562	Train Loss 0.0722	
start validation
acc: 0.732394
AUC: 0.898705
Avg Precision: 0.464820
Avg Recall: 1.000000
d_prime: 1.801998
train_loss: 0.067592
valid_loss: 1.338021
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0001348989276447525
Epoch-3 lr: 0.0001348989276447525
epoch 3 training time: 17.591
---------------
2023-09-24 17:55:54.162475
current #epochs=4, #steps=117
start validation
acc: 0.737089
AUC: 0.899540
Avg Precision: 0.467000
Avg Recall: 1.000000
d_prime: 1.808690
train_loss: 0.075567
valid_loss: 1.341923
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0001348989276447525
Epoch-4 lr: 0.0001348989276447525
epoch 4 training time: 17.539
---------------
2023-09-24 17:56:11.702084
current #epochs=5, #steps=156
start validation
acc: 0.741784
AUC: 0.901961
Avg Precision: 0.462872
Avg Recall: 1.000000
d_prime: 1.828308
train_loss: 0.048433
valid_loss: 1.331067
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.000102901516335897
Epoch-5 lr: 0.000102901516335897
epoch 5 training time: 17.643
---------------
2023-09-24 17:56:29.344932
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01134	Per Sample Data Time 0.00544	Per Sample DNN Time 0.00590	Train Loss 0.0567	
start validation
acc: 0.751174
AUC: 0.903585
Avg Precision: 0.462007
Avg Recall: 1.000000
d_prime: 1.841665
train_loss: 0.045248
valid_loss: 1.326141
validation finished
normal learning rate scheduler step
Epoch-6 lr: 7.849374527358424e-05
Epoch-6 lr: 7.849374527358424e-05
epoch 6 training time: 17.676
---------------
2023-09-24 17:56:47.020824
current #epochs=7, #steps=234
start validation
acc: 0.760563
AUC: 0.904459
Avg Precision: 0.465594
Avg Recall: 1.000000
d_prime: 1.848918
train_loss: 0.062787
valid_loss: 1.326627
validation finished
normal learning rate scheduler step
Epoch-7 lr: 5.987538635448643e-05
Epoch-7 lr: 5.987538635448643e-05
epoch 7 training time: 17.642
---------------
2023-09-24 17:57:04.662839
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00677	Per Sample Data Time 0.00124	Per Sample DNN Time 0.00553	Train Loss 0.0615	
start validation
acc: 0.746479
AUC: 0.903094
Avg Precision: 0.465550
Avg Recall: 1.000000
d_prime: 1.837605
train_loss: 0.061088
valid_loss: 1.328224
validation finished
normal learning rate scheduler step
Epoch-8 lr: 4.567321738316278e-05
Epoch-8 lr: 4.567321738316278e-05
epoch 8 training time: 15.175
---------------
2023-09-24 17:57:19.838125
current #epochs=9, #steps=312
start validation
acc: 0.746479
AUC: 0.903674
Avg Precision: 0.464761
Avg Recall: 1.000000
d_prime: 1.842403
train_loss: 0.057998
valid_loss: 1.326949
validation finished
normal learning rate scheduler step
Epoch-9 lr: 3.483973821528981e-05
Epoch-9 lr: 3.483973821528981e-05
epoch 9 training time: 15.951
---------------
2023-09-24 17:57:35.789694
current #epochs=10, #steps=351
start validation
acc: 0.741784
AUC: 0.903619
Avg Precision: 0.465243
Avg Recall: 1.000000
d_prime: 1.841947
train_loss: 0.061622
valid_loss: 1.327142
validation finished
normal learning rate scheduler step
Epoch-10 lr: 2.6575910970471497e-05
Epoch-10 lr: 2.6575910970471497e-05
epoch 10 training time: 15.303
---------------
2023-09-24 17:57:51.092605
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00857	Per Sample Data Time 0.00286	Per Sample DNN Time 0.00572	Train Loss 0.0544	
start validation
acc: 0.741784
AUC: 0.903589
Avg Precision: 0.464085
Avg Recall: 1.000000
d_prime: 1.841699
train_loss: 0.073228
valid_loss: 1.327594
validation finished
normal learning rate scheduler step
Epoch-11 lr: 2.0272225914730575e-05
Epoch-11 lr: 2.0272225914730575e-05
epoch 11 training time: 15.146
---------------
2023-09-24 17:58:06.238841
current #epochs=12, #steps=429
start validation
acc: 0.746479
AUC: 0.902747
Avg Precision: 0.462085
Avg Recall: 1.000000
d_prime: 1.834748
train_loss: 0.079054
valid_loss: 1.328778
validation finished
normal learning rate scheduler step
Epoch-12 lr: 1.546374624728745e-05
Epoch-12 lr: 1.546374624728745e-05
epoch 12 training time: 15.307
---------------
2023-09-24 17:58:21.545578
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00668	Per Sample Data Time 0.00106	Per Sample DNN Time 0.00561	Train Loss 0.0403	
start validation
acc: 0.732394
AUC: 0.902834
Avg Precision: 0.462455
Avg Recall: 1.000000
d_prime: 1.835469
train_loss: 0.039020
valid_loss: 1.328749
validation finished
normal learning rate scheduler step
Epoch-13 lr: 1.1795816059189509e-05
Epoch-13 lr: 1.1795816059189509e-05
epoch 13 training time: 15.163
---------------
2023-09-24 17:58:36.708852
current #epochs=14, #steps=507
start validation
acc: 0.732394
AUC: 0.903119
Avg Precision: 0.462220
Avg Recall: 1.000000
d_prime: 1.837811
train_loss: 0.061147
valid_loss: 1.329037
validation finished
normal learning rate scheduler step
Epoch-14 lr: 8.99790220798795e-06
Epoch-14 lr: 8.99790220798795e-06
epoch 14 training time: 15.137
---------------
2023-09-24 17:58:51.845585
current #epochs=15, #steps=546
start validation
acc: 0.732394
AUC: 0.903038
Avg Precision: 0.461855
Avg Recall: 1.000000
d_prime: 1.837149
train_loss: 0.063137
valid_loss: 1.328744
validation finished
normal learning rate scheduler step
Epoch-15 lr: 6.8636407806173734e-06
Epoch-15 lr: 6.8636407806173734e-06
epoch 15 training time: 15.172
---------------
2023-09-24 17:59:07.017413
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00774	Per Sample Data Time 0.00201	Per Sample DNN Time 0.00573	Train Loss 0.0569	
start validation
acc: 0.737089
AUC: 0.903116
Avg Precision: 0.461855
Avg Recall: 1.000000
d_prime: 1.837785
train_loss: 0.066525
valid_loss: 1.328846
validation finished
normal learning rate scheduler step
Epoch-16 lr: 5.235616444412123e-06
Epoch-16 lr: 5.235616444412123e-06
epoch 16 training time: 15.173
---------------
2023-09-24 17:59:22.190973
current #epochs=17, #steps=624
start validation
acc: 0.737089
AUC: 0.903306
Avg Precision: 0.461949
Avg Recall: 1.000000
d_prime: 1.839355
train_loss: 0.049216
valid_loss: 1.328938
validation finished
normal learning rate scheduler step
Epoch-17 lr: 3.993752066746857e-06
Epoch-17 lr: 3.993752066746857e-06
epoch 17 training time: 15.113
---------------
2023-09-24 17:59:37.303811
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00647	Per Sample Data Time 0.00092	Per Sample DNN Time 0.00554	Train Loss 0.0679	
start validation
acc: 0.737089
AUC: 0.903226
Avg Precision: 0.461949
Avg Recall: 1.000000
d_prime: 1.838692
train_loss: 0.068264
valid_loss: 1.329107
validation finished
normal learning rate scheduler step
Epoch-18 lr: 3.0464522640248007e-06
Epoch-18 lr: 3.0464522640248007e-06
epoch 18 training time: 15.051
---------------
2023-09-24 17:59:52.354533
current #epochs=19, #steps=702
start validation
acc: 0.737089
AUC: 0.903040
Avg Precision: 0.461589
Avg Recall: 1.000000
d_prime: 1.837163
train_loss: 0.053232
valid_loss: 1.329126
validation finished
normal learning rate scheduler step
Epoch-19 lr: 2.3238476605137994e-06
Epoch-19 lr: 2.3238476605137994e-06
epoch 19 training time: 15.208
---------------
2023-09-24 18:00:07.562364
current #epochs=20, #steps=741
start validation
acc: 0.737089
AUC: 0.903112
Avg Precision: 0.461589
Avg Recall: 1.000000
d_prime: 1.837755
train_loss: 0.064317
valid_loss: 1.329058
validation finished
normal learning rate scheduler step
Epoch-20 lr: 1.7726415782208677e-06
Epoch-20 lr: 1.7726415782208677e-06
epoch 20 training time: 15.109
---------------
2023-09-24 18:00:22.671459
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00731	Per Sample Data Time 0.00161	Per Sample DNN Time 0.00570	Train Loss 0.0468	
start validation
acc: 0.737089
AUC: 0.903054
Avg Precision: 0.461589
Avg Recall: 1.000000
d_prime: 1.837276
train_loss: 0.048019
valid_loss: 1.329065
validation finished
normal learning rate scheduler step
Epoch-21 lr: 1.3521790684603739e-06
Epoch-21 lr: 1.3521790684603739e-06
epoch 21 training time: 15.191
---------------
2023-09-24 18:00:37.862350
current #epochs=22, #steps=819
start validation
acc: 0.737089
AUC: 0.903111
Avg Precision: 0.461589
Avg Recall: 1.000000
d_prime: 1.837744
train_loss: 0.059233
valid_loss: 1.329136
validation finished
normal learning rate scheduler step
Epoch-22 lr: 1.0314483512326545e-06
Epoch-22 lr: 1.0314483512326545e-06
epoch 22 training time: 15.205
---------------
2023-09-24 18:00:53.067655
current #epochs=23, #steps=858
start validation
acc: 0.737089
AUC: 0.903298
Avg Precision: 0.461866
Avg Recall: 1.000000
d_prime: 1.839292
train_loss: 0.058586
valid_loss: 1.329232
validation finished
normal learning rate scheduler step
Epoch-23 lr: 7.867934995266043e-07
Epoch-23 lr: 7.867934995266043e-07
epoch 23 training time: 15.207
---------------
2023-09-24 18:01:08.275282
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01406	Per Sample Data Time 0.00793	Per Sample DNN Time 0.00613	Train Loss 0.0430	
start validation
acc: 0.737089
AUC: 0.903227
Avg Precision: 0.461866
Avg Recall: 1.000000
d_prime: 1.838706
train_loss: 0.078267
valid_loss: 1.329251
validation finished
normal learning rate scheduler step
Epoch-24 lr: 6.001696644892774e-07
Epoch-24 lr: 6.001696644892774e-07
epoch 24 training time: 15.113
---------------
2023-09-24 18:01:23.387898
current #epochs=25, #steps=936
start validation
acc: 0.737089
AUC: 0.903298
Avg Precision: 0.461866
Avg Recall: 1.000000
d_prime: 1.839292
train_loss: 0.066836
valid_loss: 1.329278
validation finished
normal learning rate scheduler step
Epoch-25 lr: 4.578121532395707e-07
Epoch-25 lr: 4.578121532395707e-07
epoch 25 training time: 15.075
---------------
2023-09-24 18:01:38.462817
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00701	Per Sample Data Time 0.00128	Per Sample DNN Time 0.00573	Train Loss 0.0713	
start validation
acc: 0.737089
AUC: 0.903305
Avg Precision: 0.461866
Avg Recall: 1.000000
d_prime: 1.839345
train_loss: 0.064048
valid_loss: 1.329293
validation finished
normal learning rate scheduler step
Epoch-26 lr: 3.492211953634933e-07
Epoch-26 lr: 3.492211953634933e-07
epoch 26 training time: 15.231
---------------
2023-09-24 18:01:53.693892
current #epochs=27, #steps=1014
start validation
acc: 0.737089
AUC: 0.903290
Avg Precision: 0.461866
Avg Recall: 1.000000
d_prime: 1.839228
train_loss: 0.059793
valid_loss: 1.329282
validation finished
normal learning rate scheduler step
Epoch-27 lr: 2.663875181733948e-07
Epoch-27 lr: 2.663875181733948e-07
epoch 27 training time: 17.166
---------------
2023-09-24 18:02:10.859705
current #epochs=28, #steps=1053
start validation
acc: 0.737089
AUC: 0.903356
Avg Precision: 0.461866
Avg Recall: 1.000000
d_prime: 1.839768
train_loss: 0.053852
valid_loss: 1.329270
validation finished
normal learning rate scheduler step
Epoch-28 lr: 2.0320161198898112e-07
Epoch-28 lr: 2.0320161198898112e-07
epoch 28 training time: 15.201
---------------
2023-09-24 18:02:26.060479
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00935	Per Sample Data Time 0.00358	Per Sample DNN Time 0.00577	Train Loss 0.1130	
start validation
acc: 0.737089
AUC: 0.903334
Avg Precision: 0.461866
Avg Recall: 1.000000
d_prime: 1.839591
train_loss: 0.069950
valid_loss: 1.329275
validation finished
normal learning rate scheduler step
Epoch-29 lr: 1.550031150034729e-07
Epoch-29 lr: 1.550031150034729e-07
epoch 29 training time: 15.135
---------------
2023-09-24 18:02:41.195137
current #epochs=30, #steps=1131
start validation
acc: 0.737089
AUC: 0.903356
Avg Precision: 0.461866
Avg Recall: 1.000000
d_prime: 1.839768
train_loss: 0.059617
valid_loss: 1.329270
validation finished
normal learning rate scheduler step
Epoch-30 lr: 1.1823708200741384e-07
Epoch-30 lr: 1.1823708200741384e-07
epoch 30 training time: 15.471
---------------
2023-09-24 18:02:56.666107
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00669	Per Sample Data Time 0.00116	Per Sample DNN Time 0.00553	Train Loss 0.0514	
start validation
acc: 0.737089
AUC: 0.903391
Avg Precision: 0.461866
Avg Recall: 1.000000
d_prime: 1.840061
train_loss: 0.051424
valid_loss: 1.329268
validation finished
normal learning rate scheduler step
Epoch-31 lr: 9.019178460584277e-08
Epoch-31 lr: 9.019178460584277e-08
epoch 31 training time: 15.238
---------------
2023-09-24 18:03:11.903855
current #epochs=32, #steps=1209
start validation
acc: 0.737089
AUC: 0.903391
Avg Precision: 0.461866
Avg Recall: 1.000000
d_prime: 1.840061
train_loss: 0.052705
valid_loss: 1.329267
validation finished
normal learning rate scheduler step
Epoch-32 lr: 6.87987040298971e-08
Epoch-32 lr: 6.87987040298971e-08
epoch 32 training time: 16.134
---------------
2023-09-24 18:03:28.038184
current #epochs=33, #steps=1248
start validation
acc: 0.737089
AUC: 0.903391
Avg Precision: 0.461866
Avg Recall: 1.000000
d_prime: 1.840061
train_loss: 0.047113
valid_loss: 1.329265
validation finished
normal learning rate scheduler step
Epoch-33 lr: 5.2479964742672935e-08
Epoch-33 lr: 5.2479964742672935e-08
epoch 33 training time: 15.479
---------------
2023-09-24 18:03:43.517802
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00805	Per Sample Data Time 0.00227	Per Sample DNN Time 0.00578	Train Loss 0.0684	
start validation
acc: 0.737089
AUC: 0.903391
Avg Precision: 0.461866
Avg Recall: 1.000000
d_prime: 1.840061
train_loss: 0.054825
valid_loss: 1.329264
validation finished
normal learning rate scheduler step
Epoch-34 lr: 4.003195609898923e-08
Epoch-34 lr: 4.003195609898923e-08
epoch 34 training time: 15.136
---------------
2023-09-24 18:03:58.653962
current #epochs=35, #steps=1326
start validation
acc: 0.737089
AUC: 0.903391
Avg Precision: 0.461866
Avg Recall: 1.000000
d_prime: 1.840061
train_loss: 0.045456
valid_loss: 1.329264
validation finished
normal learning rate scheduler step
Epoch-35 lr: 3.053655841747006e-08
Epoch-35 lr: 3.053655841747006e-08
epoch 35 training time: 15.228
---------------
2023-09-24 18:04:13.881402
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00650	Per Sample Data Time 0.00098	Per Sample DNN Time 0.00552	Train Loss 0.0456	
start validation
acc: 0.737089
AUC: 0.903391
Avg Precision: 0.461866
Avg Recall: 1.000000
d_prime: 1.840061
train_loss: 0.044231
valid_loss: 1.329264
validation finished
normal learning rate scheduler step
Epoch-36 lr: 2.329342582405324e-08
Epoch-36 lr: 2.329342582405324e-08
epoch 36 training time: 15.118
---------------
2023-09-24 18:04:28.999182
current #epochs=37, #steps=1404
start validation
acc: 0.737089
AUC: 0.903391
Avg Precision: 0.461866
Avg Recall: 1.000000
d_prime: 1.840061
train_loss: 0.050219
valid_loss: 1.329263
validation finished
normal learning rate scheduler step
Epoch-37 lr: 1.7768331296635465e-08
Epoch-37 lr: 1.7768331296635465e-08
epoch 37 training time: 15.254
---------------
2023-09-24 18:04:44.252856
current #epochs=38, #steps=1443
start validation
acc: 0.737089
AUC: 0.903391
Avg Precision: 0.461866
Avg Recall: 1.000000
d_prime: 1.840061
train_loss: 0.042070
valid_loss: 1.329264
validation finished
normal learning rate scheduler step
Epoch-38 lr: 1.3553764029891362e-08
Epoch-38 lr: 1.3553764029891362e-08
epoch 38 training time: 15.266
---------------
2023-09-24 18:04:59.519038
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00743	Per Sample Data Time 0.00179	Per Sample DNN Time 0.00564	Train Loss 0.0389	
start validation
acc: 0.737089
AUC: 0.903391
Avg Precision: 0.461866
Avg Recall: 1.000000
d_prime: 1.840061
train_loss: 0.039287
valid_loss: 1.329264
validation finished
normal learning rate scheduler step
Epoch-39 lr: 1.0338872925718266e-08
Epoch-39 lr: 1.0338872925718266e-08
epoch 39 training time: 15.187
---------------
2023-09-24 18:05:14.706335
current #epochs=40, #steps=1521
start validation
acc: 0.737089
AUC: 0.903391
Avg Precision: 0.461866
Avg Recall: 1.000000
d_prime: 1.840061
train_loss: 0.048859
valid_loss: 1.329264
validation finished
normal learning rate scheduler step
Epoch-40 lr: 7.886539350870413e-09
Epoch-40 lr: 7.886539350870413e-09
epoch 40 training time: 15.336
---------------
2023-09-24 18:05:30.042655
current #epochs=41, #steps=1560
start validation
acc: 0.737089
AUC: 0.903391
Avg Precision: 0.461866
Avg Recall: 1.000000
d_prime: 1.840061
train_loss: 0.058092
valid_loss: 1.329264
validation finished
normal learning rate scheduler step
Epoch-41 lr: 6.0158881320718535e-09
Epoch-41 lr: 6.0158881320718535e-09
epoch 41 training time: 15.224
---------------
2023-09-24 18:05:45.266938
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02224	Per Sample Data Time 0.01563	Per Sample DNN Time 0.00661	Train Loss 0.0474	
start validation
acc: 0.737089
AUC: 0.903391
Avg Precision: 0.461866
Avg Recall: 1.000000
d_prime: 1.840061
train_loss: 0.045419
valid_loss: 1.329264
validation finished
normal learning rate scheduler step
Epoch-42 lr: 4.588946863443811e-09
Epoch-42 lr: 4.588946863443811e-09
epoch 42 training time: 15.309
---------------
2023-09-24 18:06:00.576198
current #epochs=43, #steps=1638
start validation
acc: 0.737089
AUC: 0.903391
Avg Precision: 0.461866
Avg Recall: 1.000000
d_prime: 1.840061
train_loss: 0.047375
valid_loss: 1.329264
validation finished
normal learning rate scheduler step
Epoch-43 lr: 3.500469565456885e-09
Epoch-43 lr: 3.500469565456885e-09
epoch 43 training time: 15.449
---------------
2023-09-24 18:06:16.025438
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00141	Per Sample DNN Time 0.00567	Train Loss 0.0546	
start validation
acc: 0.737089
AUC: 0.903391
Avg Precision: 0.461866
Avg Recall: 1.000000
d_prime: 1.840061
train_loss: 0.048701
valid_loss: 1.329264
validation finished
normal learning rate scheduler step
Epoch-44 lr: 2.6701741256368217e-09
Epoch-44 lr: 2.6701741256368217e-09
epoch 44 training time: 15.304
---------------
2023-09-24 18:06:31.329107
current #epochs=45, #steps=1716
start validation
[I 2023-09-24 18:06:46,604] Trial 52 finished with value: 0.46186635490759204 and parameters: {'warmup': 'True', 'num_epochs': 45, 'batch_size': 43, 'lr-adaptschedule': 'True', 'lr': 0.0001348989276447525, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7628045539908322}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.737089
AUC: 0.903391
Avg Precision: 0.461866
Avg Recall: 1.000000
d_prime: 1.840061
train_loss: 0.048345
valid_loss: 1.329264
validation finished
normal learning rate scheduler step
Epoch-45 lr: 2.036820982984256e-09
Epoch-45 lr: 2.036820982984256e-09
epoch 45 training time: 15.265
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 5 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa6015c49a0>
The learning rate scheduler starts at 7 epoch with decay rate of 0.783 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 18:06:46.640347
current #epochs=1, #steps=0
start validation
acc: 0.737089
AUC: 0.901369
Avg Precision: 0.469875
Avg Recall: 1.000000
d_prime: 1.823472
train_loss: 0.077427
valid_loss: 1.326301
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0006489870552969913
Epoch-1 lr: 0.0032449352764849565
epoch 1 training time: 17.566
---------------
2023-09-24 18:07:04.207105
current #epochs=2, #steps=39
start validation
acc: 0.737089
AUC: 0.904774
Avg Precision: 0.455567
Avg Recall: 1.000000
d_prime: 1.851551
train_loss: 0.098532
valid_loss: 1.323424
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0006489870552969913
Epoch-2 lr: 0.0032449352764849565
epoch 2 training time: 15.118
---------------
2023-09-24 18:07:19.324778
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00140	Per Sample DNN Time 0.00570	Train Loss 0.0639	
start validation
acc: 0.741784
AUC: 0.905788
Avg Precision: 0.476959
Avg Recall: 1.000000
d_prime: 1.860048
train_loss: 0.064740
valid_loss: 1.340282
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0006489870552969913
Epoch-3 lr: 0.0032449352764849565
epoch 3 training time: 17.657
---------------
2023-09-24 18:07:36.981872
current #epochs=4, #steps=117
start validation
acc: 0.727700
AUC: 0.905435
Avg Precision: 0.475168
Avg Recall: 1.000000
d_prime: 1.857083
train_loss: 0.067970
valid_loss: 1.340902
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0006489870552969913
Epoch-4 lr: 0.0032449352764849565
epoch 4 training time: 15.230
---------------
2023-09-24 18:07:52.212343
current #epochs=5, #steps=156
start validation
acc: 0.741784
AUC: 0.907830
Avg Precision: 0.486531
Avg Recall: 1.000000
d_prime: 1.877386
train_loss: 0.074381
valid_loss: 1.319308
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0006489870552969913
Epoch-5 lr: 0.0032449352764849565
epoch 5 training time: 15.066
---------------
2023-09-24 18:08:07.278034
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01147	Per Sample Data Time 0.00539	Per Sample DNN Time 0.00608	Train Loss 0.0611	
start validation
acc: 0.751174
AUC: 0.902120
Avg Precision: 0.464740
Avg Recall: 1.000000
d_prime: 1.829603
train_loss: 0.074987
valid_loss: 1.329311
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0006489870552969913
Epoch-6 lr: 0.0032449352764849565
epoch 6 training time: 17.684
---------------
2023-09-24 18:08:24.961969
current #epochs=7, #steps=234
start validation
acc: 0.713615
AUC: 0.908372
Avg Precision: 0.486978
Avg Recall: 1.000000
d_prime: 1.882034
train_loss: 0.073525
valid_loss: 1.325505
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0005082780008536393
Epoch-7 lr: 0.0025413900042681966
epoch 7 training time: 15.253
---------------
2023-09-24 18:08:40.215061
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00679	Per Sample Data Time 0.00124	Per Sample DNN Time 0.00555	Train Loss 0.0579	
start validation
acc: 0.760563
AUC: 0.905090
Avg Precision: 0.472890
Avg Recall: 1.000000
d_prime: 1.854191
train_loss: 0.060787
valid_loss: 1.322625
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0005082780008536393
Epoch-8 lr: 0.0025413900042681966
epoch 8 training time: 17.504
---------------
2023-09-24 18:08:57.719273
current #epochs=9, #steps=312
start validation
acc: 0.727700
AUC: 0.894768
Avg Precision: 0.467978
Avg Recall: 1.000000
d_prime: 1.771007
train_loss: 0.068561
valid_loss: 1.339039
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00039807654720254307
Epoch-9 lr: 0.0019903827360127154
epoch 9 training time: 15.223
---------------
2023-09-24 18:09:12.942772
current #epochs=10, #steps=351
start validation
acc: 0.723005
AUC: 0.896556
Avg Precision: 0.483618
Avg Recall: 1.000000
d_prime: 1.784978
train_loss: 0.064513
valid_loss: 1.329449
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00039807654720254307
Epoch-10 lr: 0.0019903827360127154
epoch 10 training time: 15.182
---------------
2023-09-24 18:09:28.124391
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00849	Per Sample Data Time 0.00289	Per Sample DNN Time 0.00559	Train Loss 0.0596	
start validation
acc: 0.718310
AUC: 0.897898
Avg Precision: 0.484117
Avg Recall: 1.000000
d_prime: 1.795581
train_loss: 0.061710
valid_loss: 1.329159
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00031176823936224045
Epoch-11 lr: 0.0015588411968112024
epoch 11 training time: 15.983
---------------
2023-09-24 18:09:44.107294
current #epochs=12, #steps=429
start validation
acc: 0.727700
AUC: 0.901801
Avg Precision: 0.467538
Avg Recall: 1.000000
d_prime: 1.826995
train_loss: 0.055522
valid_loss: 1.318838
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00031176823936224045
Epoch-12 lr: 0.0015588411968112024
epoch 12 training time: 15.139
---------------
2023-09-24 18:09:59.245935
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00667	Per Sample Data Time 0.00105	Per Sample DNN Time 0.00563	Train Loss 0.0670	
start validation
acc: 0.741784
AUC: 0.896750
Avg Precision: 0.463189
Avg Recall: 1.000000
d_prime: 1.786502
train_loss: 0.067983
valid_loss: 1.337204
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00024417272446240285
Epoch-13 lr: 0.0012208636223120144
epoch 13 training time: 15.201
---------------
2023-09-24 18:10:14.446990
current #epochs=14, #steps=507
start validation
acc: 0.704225
AUC: 0.895432
Avg Precision: 0.461830
Avg Recall: 1.000000
d_prime: 1.776177
train_loss: 0.078969
valid_loss: 1.331996
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.00024417272446240285
Epoch-14 lr: 0.0012208636223120144
epoch 14 training time: 15.062
---------------
2023-09-24 18:10:29.508908
current #epochs=15, #steps=546
start validation
acc: 0.713615
AUC: 0.899493
Avg Precision: 0.477608
Avg Recall: 1.000000
d_prime: 1.808310
train_loss: 0.067434
valid_loss: 1.335419
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.00019123281926777745
Epoch-15 lr: 0.0009561640963388874
epoch 15 training time: 15.208
---------------
2023-09-24 18:10:44.716830
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00765	Per Sample Data Time 0.00200	Per Sample DNN Time 0.00565	Train Loss 0.0708	
start validation
acc: 0.727700
AUC: 0.901876
Avg Precision: 0.478544
Avg Recall: 1.000000
d_prime: 1.827612
train_loss: 0.068170
valid_loss: 1.333791
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.00019123281926777745
Epoch-16 lr: 0.0009561640963388874
epoch 16 training time: 15.112
---------------
2023-09-24 18:10:59.828489
current #epochs=17, #steps=624
start validation
acc: 0.746479
AUC: 0.901923
Avg Precision: 0.478339
Avg Recall: 1.000000
d_prime: 1.827993
train_loss: 0.069118
valid_loss: 1.327294
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.0001497709920123916
Epoch-17 lr: 0.0007488549600619582
epoch 17 training time: 15.274
---------------
2023-09-24 18:11:15.102571
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00649	Per Sample Data Time 0.00094	Per Sample DNN Time 0.00555	Train Loss 0.0628	
start validation
acc: 0.723005
AUC: 0.904463
Avg Precision: 0.477108
Avg Recall: 1.000000
d_prime: 1.848955
train_loss: 0.063592
valid_loss: 1.327053
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.0001497709920123916
Epoch-18 lr: 0.0007488549600619582
epoch 18 training time: 15.239
---------------
2023-09-24 18:11:30.341763
current #epochs=19, #steps=702
start validation
acc: 0.718310
AUC: 0.906039
Avg Precision: 0.476216
Avg Recall: 1.000000
d_prime: 1.862167
train_loss: 0.066870
valid_loss: 1.326516
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.0001172986422218978
Epoch-19 lr: 0.0005864932111094892
epoch 19 training time: 15.922
---------------
2023-09-24 18:11:46.264207
current #epochs=20, #steps=741
start validation
acc: 0.718310
AUC: 0.906403
Avg Precision: 0.476171
Avg Recall: 1.000000
d_prime: 1.865245
train_loss: 0.040159
valid_loss: 1.325561
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.0001172986422218978
Epoch-20 lr: 0.0005864932111094892
epoch 20 training time: 15.201
---------------
2023-09-24 18:12:01.465278
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00730	Per Sample Data Time 0.00160	Per Sample DNN Time 0.00570	Train Loss 0.0566	
start validation
acc: 0.723005
AUC: 0.906125
Avg Precision: 0.475510
Avg Recall: 1.000000
d_prime: 1.862892
train_loss: 0.057189
valid_loss: 1.323430
validation finished
normal learning rate scheduler step
Epoch-21 lr: 9.186673121563092e-05
Epoch-21 lr: 0.0004593336560781547
epoch 21 training time: 15.105
---------------
2023-09-24 18:12:16.570202
current #epochs=22, #steps=819
start validation
acc: 0.741784
AUC: 0.905356
Avg Precision: 0.475139
Avg Recall: 1.000000
d_prime: 1.856418
train_loss: 0.039242
valid_loss: 1.322952
validation finished
normal learning rate scheduler step
Epoch-22 lr: 9.186673121563092e-05
Epoch-22 lr: 0.0004593336560781547
epoch 22 training time: 15.200
---------------
2023-09-24 18:12:31.770275
current #epochs=23, #steps=858
start validation
acc: 0.737089
AUC: 0.903884
Avg Precision: 0.477248
Avg Recall: 1.000000
d_prime: 1.844139
train_loss: 0.060111
valid_loss: 1.325812
validation finished
normal learning rate scheduler step
Epoch-23 lr: 7.194879790918378e-05
Epoch-23 lr: 0.000359743989545919
epoch 23 training time: 15.201
---------------
2023-09-24 18:12:46.970835
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01404	Per Sample Data Time 0.00808	Per Sample DNN Time 0.00596	Train Loss 0.0513	
start validation
acc: 0.727700
AUC: 0.903157
Avg Precision: 0.477686
Avg Recall: 1.000000
d_prime: 1.838128
train_loss: 0.048955
valid_loss: 1.327671
validation finished
normal learning rate scheduler step
Epoch-24 lr: 7.194879790918378e-05
Epoch-24 lr: 0.000359743989545919
epoch 24 training time: 15.289
---------------
2023-09-24 18:13:02.260391
current #epochs=25, #steps=936
start validation
acc: 0.741784
AUC: 0.901806
Avg Precision: 0.476890
Avg Recall: 1.000000
d_prime: 1.827036
train_loss: 0.054383
valid_loss: 1.328494
validation finished
normal learning rate scheduler step
Epoch-25 lr: 5.6349338352160456e-05
Epoch-25 lr: 0.0002817466917608024
epoch 25 training time: 15.122
---------------
2023-09-24 18:13:17.382434
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00697	Per Sample Data Time 0.00136	Per Sample DNN Time 0.00561	Train Loss 0.0601	
start validation
acc: 0.727700
AUC: 0.902140
Avg Precision: 0.477049
Avg Recall: 1.000000
d_prime: 1.829770
train_loss: 0.059594
valid_loss: 1.330212
validation finished
normal learning rate scheduler step
Epoch-26 lr: 5.6349338352160456e-05
Epoch-26 lr: 0.0002817466917608024
epoch 26 training time: 16.402
---------------
2023-09-24 18:13:33.784114
current #epochs=27, #steps=1014
start validation
acc: 0.727700
AUC: 0.903981
Avg Precision: 0.480154
Avg Recall: 1.000000
d_prime: 1.844948
train_loss: 0.054470
valid_loss: 1.327459
validation finished
normal learning rate scheduler step
Epoch-27 lr: 4.413204980483715e-05
Epoch-27 lr: 0.00022066024902418584
epoch 27 training time: 15.249
---------------
2023-09-24 18:13:49.033187
current #epochs=28, #steps=1053
start validation
acc: 0.746479
AUC: 0.905165
Avg Precision: 0.480759
Avg Recall: 1.000000
d_prime: 1.854819
train_loss: 0.054541
valid_loss: 1.325226
validation finished
normal learning rate scheduler step
Epoch-28 lr: 4.413204980483715e-05
Epoch-28 lr: 0.00022066024902418584
epoch 28 training time: 15.685
---------------
2023-09-24 18:14:04.718637
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00948	Per Sample Data Time 0.00366	Per Sample DNN Time 0.00583	Train Loss 0.0655	
start validation
acc: 0.755869
AUC: 0.905339
Avg Precision: 0.481581
Avg Recall: 1.000000
d_prime: 1.856282
train_loss: 0.058816
valid_loss: 1.323648
validation finished
normal learning rate scheduler step
Epoch-29 lr: 3.4563632456599266e-05
Epoch-29 lr: 0.00017281816228299638
epoch 29 training time: 15.149
---------------
2023-09-24 18:14:19.867321
current #epochs=30, #steps=1131
start validation
acc: 0.755869
AUC: 0.905855
Avg Precision: 0.481003
Avg Recall: 1.000000
d_prime: 1.860618
train_loss: 0.051295
valid_loss: 1.323751
validation finished
normal learning rate scheduler step
Epoch-30 lr: 3.4563632456599266e-05
Epoch-30 lr: 0.00017281816228299638
epoch 30 training time: 15.172
---------------
2023-09-24 18:14:35.039942
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00674	Per Sample Data Time 0.00116	Per Sample DNN Time 0.00558	Train Loss 0.0573	
start validation
acc: 0.755869
AUC: 0.905979
Avg Precision: 0.481319
Avg Recall: 1.000000
d_prime: 1.861663
train_loss: 0.050761
valid_loss: 1.323778
validation finished
normal learning rate scheduler step
Epoch-31 lr: 2.7069775681798074e-05
Epoch-31 lr: 0.0001353488784089904
epoch 31 training time: 15.250
---------------
2023-09-24 18:14:50.289419
current #epochs=32, #steps=1209
start validation
acc: 0.746479
AUC: 0.905905
Avg Precision: 0.480080
Avg Recall: 1.000000
d_prime: 1.861037
train_loss: 0.043871
valid_loss: 1.324602
validation finished
normal learning rate scheduler step
Epoch-32 lr: 2.7069775681798074e-05
Epoch-32 lr: 0.0001353488784089904
epoch 32 training time: 15.075
---------------
2023-09-24 18:15:05.364888
current #epochs=33, #steps=1248
start validation
acc: 0.727700
AUC: 0.905491
Avg Precision: 0.480687
Avg Recall: 1.000000
d_prime: 1.857553
train_loss: 0.050319
valid_loss: 1.325236
validation finished
normal learning rate scheduler step
Epoch-33 lr: 2.120068706270939e-05
Epoch-33 lr: 0.00010600343531354698
epoch 33 training time: 15.170
---------------
2023-09-24 18:15:20.534119
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00813	Per Sample Data Time 0.00233	Per Sample DNN Time 0.00579	Train Loss 0.0601	
start validation
acc: 0.718310
AUC: 0.905979
Avg Precision: 0.480267
Avg Recall: 1.000000
d_prime: 1.861660
train_loss: 0.060290
valid_loss: 1.325236
validation finished
normal learning rate scheduler step
Epoch-34 lr: 2.120068706270939e-05
Epoch-34 lr: 0.00010600343531354698
epoch 34 training time: 15.469
---------------
2023-09-24 18:15:36.003276
current #epochs=35, #steps=1326
start validation
acc: 0.732394
AUC: 0.905780
Avg Precision: 0.480045
Avg Recall: 1.000000
d_prime: 1.859986
train_loss: 0.071098
valid_loss: 1.325242
validation finished
normal learning rate scheduler step
Epoch-35 lr: 1.6604095180336488e-05
Epoch-35 lr: 8.302047590168246e-05
epoch 35 training time: 15.232
---------------
2023-09-24 18:15:51.235379
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00657	Per Sample Data Time 0.00102	Per Sample DNN Time 0.00555	Train Loss 0.0543	
start validation
acc: 0.732394
AUC: 0.905552
Avg Precision: 0.480366
Avg Recall: 1.000000
d_prime: 1.858069
train_loss: 0.053624
valid_loss: 1.325230
validation finished
normal learning rate scheduler step
Epoch-36 lr: 1.6604095180336488e-05
Epoch-36 lr: 8.302047590168246e-05
epoch 36 training time: 16.013
---------------
2023-09-24 18:16:07.248041
current #epochs=37, #steps=1404
start validation
acc: 0.746479
AUC: 0.905871
Avg Precision: 0.479544
Avg Recall: 1.000000
d_prime: 1.860755
train_loss: 0.052034
valid_loss: 1.324443
validation finished
normal learning rate scheduler step
Epoch-37 lr: 1.300410576044983e-05
Epoch-37 lr: 6.502052880224917e-05
epoch 37 training time: 16.038
---------------
2023-09-24 18:16:23.285653
current #epochs=38, #steps=1443
start validation
acc: 0.741784
AUC: 0.905968
Avg Precision: 0.480106
Avg Recall: 1.000000
d_prime: 1.861567
train_loss: 0.041793
valid_loss: 1.324406
validation finished
normal learning rate scheduler step
Epoch-38 lr: 1.300410576044983e-05
Epoch-38 lr: 6.502052880224917e-05
epoch 38 training time: 15.190
---------------
2023-09-24 18:16:38.475560
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00729	Per Sample Data Time 0.00174	Per Sample DNN Time 0.00555	Train Loss 0.0662	
start validation
acc: 0.737089
AUC: 0.905925
Avg Precision: 0.480005
Avg Recall: 1.000000
d_prime: 1.861206
train_loss: 0.061355
valid_loss: 1.324269
validation finished
normal learning rate scheduler step
Epoch-39 lr: 1.01846420893341e-05
Epoch-39 lr: 5.0923210446670514e-05
epoch 39 training time: 15.193
---------------
2023-09-24 18:16:53.668413
current #epochs=40, #steps=1521
start validation
acc: 0.732394
AUC: 0.905697
Avg Precision: 0.479603
Avg Recall: 1.000000
d_prime: 1.859286
train_loss: 0.053698
valid_loss: 1.324239
validation finished
normal learning rate scheduler step
Epoch-40 lr: 1.01846420893341e-05
Epoch-40 lr: 5.0923210446670514e-05
epoch 40 training time: 15.218
---------------
2023-09-24 18:17:08.886763
current #epochs=41, #steps=1560
start validation
acc: 0.723005
AUC: 0.905401
Avg Precision: 0.479269
Avg Recall: 1.000000
d_prime: 1.856796
train_loss: 0.056857
valid_loss: 1.324397
validation finished
normal learning rate scheduler step
Epoch-41 lr: 7.97647576839206e-06
Epoch-41 lr: 3.988237884196031e-05
epoch 41 training time: 15.285
---------------
2023-09-24 18:17:24.171166
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02312	Per Sample Data Time 0.01565	Per Sample DNN Time 0.00747	Train Loss 0.0419	
start validation
acc: 0.723005
AUC: 0.905181
Avg Precision: 0.479171
Avg Recall: 1.000000
d_prime: 1.854957
train_loss: 0.043243
valid_loss: 1.324495
validation finished
normal learning rate scheduler step
Epoch-42 lr: 7.97647576839206e-06
Epoch-42 lr: 3.988237884196031e-05
epoch 42 training time: 15.165
---------------
2023-09-24 18:17:39.336001
current #epochs=43, #steps=1638
start validation
acc: 0.713615
AUC: 0.905158
Avg Precision: 0.479171
Avg Recall: 1.000000
d_prime: 1.854759
train_loss: 0.063870
valid_loss: 1.324767
validation finished
normal learning rate scheduler step
Epoch-43 lr: 6.247069374227329e-06
Epoch-43 lr: 3.1235346871136654e-05
epoch 43 training time: 15.151
---------------
2023-09-24 18:17:54.486966
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00699	Per Sample Data Time 0.00139	Per Sample DNN Time 0.00560	Train Loss 0.0334	
start validation
acc: 0.708920
AUC: 0.905170
Avg Precision: 0.479171
Avg Recall: 1.000000
d_prime: 1.854865
train_loss: 0.039378
valid_loss: 1.324655
validation finished
normal learning rate scheduler step
Epoch-44 lr: 6.247069374227329e-06
Epoch-44 lr: 3.1235346871136654e-05
epoch 44 training time: 15.197
---------------
2023-09-24 18:18:09.683610
current #epochs=45, #steps=1716
start validation
acc: 0.718310
AUC: 0.905228
Avg Precision: 0.479269
Avg Recall: 1.000000
d_prime: 1.855352
train_loss: 0.064507
valid_loss: 1.324730
validation finished
normal learning rate scheduler step
Epoch-45 lr: 4.892621365572841e-06
Epoch-45 lr: 2.446310682786421e-05
epoch 45 training time: 15.256
---------------
2023-09-24 18:18:24.939434
current #epochs=46, #steps=1755
start validation
acc: 0.718310
AUC: 0.905241
Avg Precision: 0.479369
Avg Recall: 1.000000
d_prime: 1.855453
train_loss: 0.048299
valid_loss: 1.324677
validation finished
normal learning rate scheduler step
Epoch-46 lr: 4.892621365572841e-06
Epoch-46 lr: 2.446310682786421e-05
epoch 46 training time: 15.221
---------------
2023-09-24 18:18:40.160295
current #epochs=47, #steps=1794
Epoch: [47][6/39]	Per Sample Total Time 0.01026	Per Sample Data Time 0.00457	Per Sample DNN Time 0.00570	Train Loss 0.0677	
start validation
[I 2023-09-24 18:18:55,341] Trial 53 finished with value: 0.4793688383968408 and parameters: {'warmup': 'True', 'num_epochs': 47, 'batch_size': 47, 'lr-adaptschedule': 'True', 'lr': 0.0006489870552969913, 'head-lr': 5, 'lr-scheduler-start': 7, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.7831866548109186}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.718310
AUC: 0.905362
Avg Precision: 0.479369
Avg Recall: 1.000000
d_prime: 1.856470
train_loss: 0.059999
valid_loss: 1.324653
validation finished
normal learning rate scheduler step
Epoch-47 lr: 3.831835760559422e-06
Epoch-47 lr: 1.9159178802797117e-05
epoch 47 training time: 15.170
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67ec58280>
The learning rate scheduler starts at 6 epoch with decay rate of 0.744 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 18:18:55.378999
current #epochs=1, #steps=0
start validation
acc: 0.732394
AUC: 0.902193
Avg Precision: 0.468067
Avg Recall: 1.000000
d_prime: 1.830206
train_loss: 0.054536
valid_loss: 1.319598
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0003538482716720928
Epoch-1 lr: 0.0003538482716720928
epoch 1 training time: 17.795
---------------
2023-09-24 18:19:13.174845
current #epochs=2, #steps=39
start validation
acc: 0.751174
AUC: 0.903797
Avg Precision: 0.463065
Avg Recall: 1.000000
d_prime: 1.843421
train_loss: 0.069751
valid_loss: 1.322785
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0003538482716720928
Epoch-2 lr: 0.0003538482716720928
epoch 2 training time: 17.678
---------------
2023-09-24 18:19:30.852992
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00143	Per Sample DNN Time 0.00566	Train Loss 0.0542	
start validation
acc: 0.727700
AUC: 0.905212
Avg Precision: 0.464487
Avg Recall: 1.000000
d_prime: 1.855214
train_loss: 0.059966
valid_loss: 1.325324
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0003538482716720928
Epoch-3 lr: 0.0003538482716720928
epoch 3 training time: 15.249
---------------
2023-09-24 18:19:46.102293
current #epochs=4, #steps=117
start validation
acc: 0.718310
AUC: 0.898900
Avg Precision: 0.477018
Avg Recall: 1.000000
d_prime: 1.803562
train_loss: 0.063299
valid_loss: 1.333850
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0003538482716720928
Epoch-4 lr: 0.0003538482716720928
epoch 4 training time: 15.113
---------------
2023-09-24 18:20:01.214941
current #epochs=5, #steps=156
start validation
acc: 0.713615
AUC: 0.898767
Avg Precision: 0.448569
Avg Recall: 1.000000
d_prime: 1.802495
train_loss: 0.061999
valid_loss: 1.334601
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0003538482716720928
Epoch-5 lr: 0.0003538482716720928
epoch 5 training time: 15.176
---------------
2023-09-24 18:20:16.390841
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01123	Per Sample Data Time 0.00515	Per Sample DNN Time 0.00608	Train Loss 0.0352	
start validation
acc: 0.727700
AUC: 0.904152
Avg Precision: 0.469952
Avg Recall: 1.000000
d_prime: 1.846367
train_loss: 0.054398
valid_loss: 1.318929
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0002631366196896198
Epoch-6 lr: 0.0002631366196896198
epoch 6 training time: 15.195
---------------
2023-09-24 18:20:31.586020
current #epochs=7, #steps=234
start validation
acc: 0.699531
AUC: 0.898214
Avg Precision: 0.464391
Avg Recall: 1.000000
d_prime: 1.798085
train_loss: 0.064628
valid_loss: 1.331727
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0002631366196896198
Epoch-7 lr: 0.0002631366196896198
epoch 7 training time: 15.250
---------------
2023-09-24 18:20:46.835926
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00678	Per Sample Data Time 0.00120	Per Sample DNN Time 0.00558	Train Loss 0.0623	
start validation
acc: 0.694836
AUC: 0.898829
Avg Precision: 0.449164
Avg Recall: 1.000000
d_prime: 1.802995
train_loss: 0.061037
valid_loss: 1.331295
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00019567957840937075
Epoch-8 lr: 0.00019567957840937075
epoch 8 training time: 15.095
---------------
2023-09-24 18:21:01.930759
current #epochs=9, #steps=312
start validation
acc: 0.727700
AUC: 0.896921
Avg Precision: 0.454854
Avg Recall: 1.000000
d_prime: 1.787848
train_loss: 0.069950
valid_loss: 1.335435
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00019567957840937075
Epoch-9 lr: 0.00019567957840937075
epoch 9 training time: 15.262
---------------
2023-09-24 18:21:17.192459
current #epochs=10, #steps=351
start validation
acc: 0.741784
AUC: 0.898933
Avg Precision: 0.464112
Avg Recall: 1.000000
d_prime: 1.803822
train_loss: 0.051248
valid_loss: 1.332343
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00014551565438377317
Epoch-10 lr: 0.00014551565438377317
epoch 10 training time: 16.793
---------------
2023-09-24 18:21:33.985726
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00881	Per Sample Data Time 0.00296	Per Sample DNN Time 0.00585	Train Loss 0.0508	
start validation
acc: 0.751174
AUC: 0.899209
Avg Precision: 0.471828
Avg Recall: 1.000000
d_prime: 1.806033
train_loss: 0.052699
valid_loss: 1.333788
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00014551565438377317
Epoch-11 lr: 0.00014551565438377317
epoch 11 training time: 15.282
---------------
2023-09-24 18:21:49.267566
current #epochs=12, #steps=429
start validation
acc: 0.746479
AUC: 0.900784
Avg Precision: 0.469001
Avg Recall: 1.000000
d_prime: 1.818726
train_loss: 0.057611
valid_loss: 1.329695
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00010821162761521823
Epoch-12 lr: 0.00010821162761521823
epoch 12 training time: 15.989
---------------
2023-09-24 18:22:05.256784
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00664	Per Sample Data Time 0.00106	Per Sample DNN Time 0.00557	Train Loss 0.0471	
start validation
acc: 0.746479
AUC: 0.900073
Avg Precision: 0.468309
Avg Recall: 1.000000
d_prime: 1.812972
train_loss: 0.044906
valid_loss: 1.332283
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00010821162761521823
Epoch-13 lr: 0.00010821162761521823
epoch 13 training time: 15.282
---------------
2023-09-24 18:22:20.538437
current #epochs=14, #steps=507
start validation
acc: 0.741784
AUC: 0.898631
Avg Precision: 0.466278
Avg Recall: 1.000000
d_prime: 1.801411
train_loss: 0.053867
valid_loss: 1.335958
validation finished
normal learning rate scheduler step
Epoch-14 lr: 8.047076722241951e-05
Epoch-14 lr: 8.047076722241951e-05
epoch 14 training time: 15.268
---------------
2023-09-24 18:22:35.806884
current #epochs=15, #steps=546
start validation
acc: 0.732394
AUC: 0.898899
Avg Precision: 0.466371
Avg Recall: 1.000000
d_prime: 1.803549
train_loss: 0.066172
valid_loss: 1.333744
validation finished
normal learning rate scheduler step
Epoch-15 lr: 8.047076722241951e-05
Epoch-15 lr: 8.047076722241951e-05
epoch 15 training time: 15.211
---------------
2023-09-24 18:22:51.017611
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00769	Per Sample Data Time 0.00198	Per Sample DNN Time 0.00571	Train Loss 0.0501	
start validation
acc: 0.741784
AUC: 0.900011
Avg Precision: 0.465543
Avg Recall: 1.000000
d_prime: 1.812477
train_loss: 0.047872
valid_loss: 1.331770
validation finished
normal learning rate scheduler step
Epoch-16 lr: 5.9841483952082664e-05
Epoch-16 lr: 5.9841483952082664e-05
epoch 16 training time: 15.091
---------------
2023-09-24 18:23:06.108519
current #epochs=17, #steps=624
start validation
acc: 0.727700
AUC: 0.901239
Avg Precision: 0.468071
Avg Recall: 1.000000
d_prime: 1.822417
train_loss: 0.050761
valid_loss: 1.332397
validation finished
normal learning rate scheduler step
Epoch-17 lr: 5.9841483952082664e-05
Epoch-17 lr: 5.9841483952082664e-05
epoch 17 training time: 15.227
---------------
2023-09-24 18:23:21.335254
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00651	Per Sample Data Time 0.00093	Per Sample DNN Time 0.00558	Train Loss 0.0502	
start validation
acc: 0.723005
AUC: 0.901332
Avg Precision: 0.468147
Avg Recall: 1.000000
d_prime: 1.823173
train_loss: 0.050586
valid_loss: 1.333765
validation finished
normal learning rate scheduler step
Epoch-18 lr: 4.4500671799108724e-05
Epoch-18 lr: 4.4500671799108724e-05
epoch 18 training time: 15.157
---------------
2023-09-24 18:23:36.492735
current #epochs=19, #steps=702
start validation
acc: 0.727700
AUC: 0.901330
Avg Precision: 0.468147
Avg Recall: 1.000000
d_prime: 1.823154
train_loss: 0.049094
valid_loss: 1.333566
validation finished
normal learning rate scheduler step
Epoch-19 lr: 4.4500671799108724e-05
Epoch-19 lr: 4.4500671799108724e-05
epoch 19 training time: 15.200
---------------
2023-09-24 18:23:51.692808
current #epochs=20, #steps=741
start validation
acc: 0.727700
AUC: 0.900746
Avg Precision: 0.468139
Avg Recall: 1.000000
d_prime: 1.818417
train_loss: 0.064544
valid_loss: 1.335387
validation finished
normal learning rate scheduler step
Epoch-20 lr: 3.3092591623524904e-05
Epoch-20 lr: 3.3092591623524904e-05
epoch 20 training time: 15.504
---------------
2023-09-24 18:24:07.196617
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00726	Per Sample Data Time 0.00163	Per Sample DNN Time 0.00563	Train Loss 0.0368	
start validation
acc: 0.732394
AUC: 0.900985
Avg Precision: 0.467977
Avg Recall: 1.000000
d_prime: 1.820355
train_loss: 0.040253
valid_loss: 1.335847
validation finished
normal learning rate scheduler step
Epoch-21 lr: 3.3092591623524904e-05
Epoch-21 lr: 3.3092591623524904e-05
epoch 21 training time: 16.202
---------------
2023-09-24 18:24:23.398409
current #epochs=22, #steps=819
start validation
acc: 0.737089
AUC: 0.900612
Avg Precision: 0.468038
Avg Recall: 1.000000
d_prime: 1.817328
train_loss: 0.057972
valid_loss: 1.335186
validation finished
normal learning rate scheduler step
Epoch-22 lr: 2.460905815770907e-05
Epoch-22 lr: 2.460905815770907e-05
epoch 22 training time: 15.317
---------------
2023-09-24 18:24:38.715166
current #epochs=23, #steps=858
start validation
acc: 0.732394
AUC: 0.900842
Avg Precision: 0.465802
Avg Recall: 1.000000
d_prime: 1.819191
train_loss: 0.055860
valid_loss: 1.334316
validation finished
normal learning rate scheduler step
Epoch-23 lr: 2.460905815770907e-05
Epoch-23 lr: 2.460905815770907e-05
epoch 23 training time: 15.168
---------------
2023-09-24 18:24:53.882961
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01425	Per Sample Data Time 0.00780	Per Sample DNN Time 0.00646	Train Loss 0.0860	
start validation
acc: 0.732394
AUC: 0.900801
Avg Precision: 0.465222
Avg Recall: 1.000000
d_prime: 1.818865
train_loss: 0.060937
valid_loss: 1.333240
validation finished
normal learning rate scheduler step
Epoch-24 lr: 1.8300341970768876e-05
Epoch-24 lr: 1.8300341970768876e-05
epoch 24 training time: 15.429
---------------
2023-09-24 18:25:09.311566
current #epochs=25, #steps=936
start validation
acc: 0.732394
AUC: 0.901000
Avg Precision: 0.466121
Avg Recall: 1.000000
d_prime: 1.820476
train_loss: 0.051686
valid_loss: 1.332763
validation finished
normal learning rate scheduler step
Epoch-25 lr: 1.8300341970768876e-05
Epoch-25 lr: 1.8300341970768876e-05
epoch 25 training time: 15.283
---------------
2023-09-24 18:25:24.594296
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00693	Per Sample Data Time 0.00132	Per Sample DNN Time 0.00561	Train Loss 0.0495	
start validation
acc: 0.732394
AUC: 0.900884
Avg Precision: 0.466020
Avg Recall: 1.000000
d_prime: 1.819536
train_loss: 0.045109
valid_loss: 1.332779
validation finished
normal learning rate scheduler step
Epoch-26 lr: 1.3608912380995485e-05
Epoch-26 lr: 1.3608912380995485e-05
epoch 26 training time: 15.259
---------------
2023-09-24 18:25:39.853973
current #epochs=27, #steps=1014
start validation
acc: 0.732394
AUC: 0.900943
Avg Precision: 0.466020
Avg Recall: 1.000000
d_prime: 1.820011
train_loss: 0.051992
valid_loss: 1.332934
validation finished
normal learning rate scheduler step
Epoch-27 lr: 1.3608912380995485e-05
Epoch-27 lr: 1.3608912380995485e-05
epoch 27 training time: 15.258
---------------
2023-09-24 18:25:55.111333
current #epochs=28, #steps=1053
start validation
acc: 0.732394
AUC: 0.900805
Avg Precision: 0.466020
Avg Recall: 1.000000
d_prime: 1.818895
train_loss: 0.043842
valid_loss: 1.333358
validation finished
normal learning rate scheduler step
Epoch-28 lr: 1.0120165868454044e-05
Epoch-28 lr: 1.0120165868454044e-05
epoch 28 training time: 15.230
---------------
2023-09-24 18:26:10.340833
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00928	Per Sample Data Time 0.00352	Per Sample DNN Time 0.00576	Train Loss 0.0517	
start validation
acc: 0.732394
AUC: 0.900892
Avg Precision: 0.466352
Avg Recall: 1.000000
d_prime: 1.819598
train_loss: 0.045075
valid_loss: 1.332882
validation finished
normal learning rate scheduler step
Epoch-29 lr: 1.0120165868454044e-05
Epoch-29 lr: 1.0120165868454044e-05
epoch 29 training time: 15.207
---------------
2023-09-24 18:26:25.547704
current #epochs=30, #steps=1131
start validation
acc: 0.732394
AUC: 0.901075
Avg Precision: 0.466454
Avg Recall: 1.000000
d_prime: 1.821081
train_loss: 0.056063
valid_loss: 1.332756
validation finished
normal learning rate scheduler step
Epoch-30 lr: 7.525785627663097e-06
Epoch-30 lr: 7.525785627663097e-06
epoch 30 training time: 15.052
---------------
2023-09-24 18:26:40.599765
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00674	Per Sample Data Time 0.00111	Per Sample DNN Time 0.00563	Train Loss 0.0542	
start validation
acc: 0.732394
AUC: 0.901220
Avg Precision: 0.466283
Avg Recall: 1.000000
d_prime: 1.822261
train_loss: 0.050691
valid_loss: 1.332524
validation finished
normal learning rate scheduler step
Epoch-31 lr: 7.525785627663097e-06
Epoch-31 lr: 7.525785627663097e-06
epoch 31 training time: 15.313
---------------
2023-09-24 18:26:55.913374
current #epochs=32, #steps=1209
start validation
acc: 0.732394
AUC: 0.901269
Avg Precision: 0.466283
Avg Recall: 1.000000
d_prime: 1.822660
train_loss: 0.050975
valid_loss: 1.332518
validation finished
normal learning rate scheduler step
Epoch-32 lr: 5.596494173093268e-06
Epoch-32 lr: 5.596494173093268e-06
epoch 32 training time: 15.172
---------------
2023-09-24 18:27:11.085555
current #epochs=33, #steps=1248
start validation
acc: 0.732394
AUC: 0.901231
Avg Precision: 0.466182
Avg Recall: 1.000000
d_prime: 1.822352
train_loss: 0.053695
valid_loss: 1.332393
validation finished
normal learning rate scheduler step
Epoch-33 lr: 5.596494173093268e-06
Epoch-33 lr: 5.596494173093268e-06
epoch 33 training time: 15.180
---------------
2023-09-24 18:27:26.265573
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00804	Per Sample Data Time 0.00225	Per Sample DNN Time 0.00578	Train Loss 0.0563	
start validation
acc: 0.732394
AUC: 0.901507
Avg Precision: 0.466526
Avg Recall: 1.000000
d_prime: 1.824599
train_loss: 0.054172
valid_loss: 1.332372
validation finished
normal learning rate scheduler step
Epoch-34 lr: 4.161791018114956e-06
Epoch-34 lr: 4.161791018114956e-06
epoch 34 training time: 15.190
---------------
2023-09-24 18:27:41.455597
current #epochs=35, #steps=1326
start validation
acc: 0.732394
AUC: 0.901488
Avg Precision: 0.466352
Avg Recall: 1.000000
d_prime: 1.824442
train_loss: 0.044061
valid_loss: 1.332161
validation finished
normal learning rate scheduler step
Epoch-35 lr: 4.161791018114956e-06
Epoch-35 lr: 4.161791018114956e-06
epoch 35 training time: 15.275
---------------
2023-09-24 18:27:56.730493
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00650	Per Sample Data Time 0.00095	Per Sample DNN Time 0.00555	Train Loss 0.0450	
start validation
acc: 0.732394
AUC: 0.901323
Avg Precision: 0.465683
Avg Recall: 1.000000
d_prime: 1.823099
train_loss: 0.042649
valid_loss: 1.332091
validation finished
normal learning rate scheduler step
Epoch-36 lr: 3.094884751553134e-06
Epoch-36 lr: 3.094884751553134e-06
epoch 36 training time: 15.178
---------------
2023-09-24 18:28:11.908814
current #epochs=37, #steps=1404
start validation
acc: 0.732394
AUC: 0.901338
Avg Precision: 0.466352
Avg Recall: 1.000000
d_prime: 1.823221
train_loss: 0.044860
valid_loss: 1.332158
validation finished
normal learning rate scheduler step
Epoch-37 lr: 3.094884751553134e-06
Epoch-37 lr: 3.094884751553134e-06
epoch 37 training time: 15.148
---------------
2023-09-24 18:28:27.057283
current #epochs=38, #steps=1443
start validation
acc: 0.732394
AUC: 0.901309
Avg Precision: 0.466015
Avg Recall: 1.000000
d_prime: 1.822986
train_loss: 0.048826
valid_loss: 1.332355
validation finished
normal learning rate scheduler step
Epoch-38 lr: 2.301487889157517e-06
Epoch-38 lr: 2.301487889157517e-06
epoch 38 training time: 15.192
---------------
2023-09-24 18:28:42.249223
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00743	Per Sample Data Time 0.00174	Per Sample DNN Time 0.00569	Train Loss 0.0363	
start validation
acc: 0.732394
AUC: 0.901326
Avg Precision: 0.466352
Avg Recall: 1.000000
d_prime: 1.823123
train_loss: 0.044775
valid_loss: 1.332262
validation finished
normal learning rate scheduler step
Epoch-39 lr: 2.301487889157517e-06
Epoch-39 lr: 2.301487889157517e-06
epoch 39 training time: 15.183
---------------
2023-09-24 18:28:57.432512
current #epochs=40, #steps=1521
start validation
acc: 0.732394
AUC: 0.901355
Avg Precision: 0.466352
Avg Recall: 1.000000
d_prime: 1.823359
train_loss: 0.038070
valid_loss: 1.332200
validation finished
normal learning rate scheduler step
Epoch-40 lr: 1.7114842487367453e-06
Epoch-40 lr: 1.7114842487367453e-06
epoch 40 training time: 15.399
---------------
2023-09-24 18:29:12.831959
current #epochs=41, #steps=1560
start validation
acc: 0.732394
AUC: 0.901289
Avg Precision: 0.466352
Avg Recall: 1.000000
d_prime: 1.822821
train_loss: 0.044277
valid_loss: 1.332174
validation finished
normal learning rate scheduler step
Epoch-41 lr: 1.7114842487367453e-06
Epoch-41 lr: 1.7114842487367453e-06
epoch 41 training time: 15.256
---------------
2023-09-24 18:29:28.087647
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02183	Per Sample Data Time 0.01554	Per Sample DNN Time 0.00630	Train Loss 0.0796	
start validation
acc: 0.732394
AUC: 0.901333
Avg Precision: 0.466352
Avg Recall: 1.000000
d_prime: 1.823185
train_loss: 0.044596
valid_loss: 1.332112
validation finished
normal learning rate scheduler step
Epoch-42 lr: 1.2727324560227152e-06
Epoch-42 lr: 1.2727324560227152e-06
epoch 42 training time: 15.120
---------------
2023-09-24 18:29:43.207699
current #epochs=43, #steps=1638
start validation
acc: 0.732394
AUC: 0.901225
Avg Precision: 0.466352
Avg Recall: 1.000000
d_prime: 1.822306
train_loss: 0.044389
valid_loss: 1.332052
validation finished
normal learning rate scheduler step
Epoch-43 lr: 1.2727324560227152e-06
Epoch-43 lr: 1.2727324560227152e-06
epoch 43 training time: 15.278
---------------
2023-09-24 18:29:58.486075
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00704	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00557	Train Loss 0.0481	
start validation
acc: 0.732394
AUC: 0.901210
Avg Precision: 0.466352
Avg Recall: 1.000000
d_prime: 1.822185
train_loss: 0.046343
valid_loss: 1.332068
validation finished
normal learning rate scheduler step
Epoch-44 lr: 9.464579681695757e-07
Epoch-44 lr: 9.464579681695757e-07
epoch 44 training time: 15.198
---------------
2023-09-24 18:30:13.684341
current #epochs=45, #steps=1716
start validation
acc: 0.732394
AUC: 0.901225
Avg Precision: 0.466352
Avg Recall: 1.000000
d_prime: 1.822306
train_loss: 0.044370
valid_loss: 1.332095
validation finished
normal learning rate scheduler step
Epoch-45 lr: 9.464579681695757e-07
Epoch-45 lr: 9.464579681695757e-07
epoch 45 training time: 15.283
---------------
2023-09-24 18:30:28.967648
current #epochs=46, #steps=1755
start validation
acc: 0.732394
AUC: 0.901236
Avg Precision: 0.466352
Avg Recall: 1.000000
d_prime: 1.822393
train_loss: 0.060912
valid_loss: 1.332086
validation finished
normal learning rate scheduler step
Epoch-46 lr: 7.038263865062416e-07
Epoch-46 lr: 7.038263865062416e-07
epoch 46 training time: 15.304
---------------
2023-09-24 18:30:44.271467
current #epochs=47, #steps=1794
Epoch: [47][6/39]	Per Sample Total Time 0.01040	Per Sample Data Time 0.00437	Per Sample DNN Time 0.00603	Train Loss 0.0311	
start validation
acc: 0.732394
AUC: 0.901221
Avg Precision: 0.466352
Avg Recall: 1.000000
d_prime: 1.822272
train_loss: 0.049608
valid_loss: 1.332131
validation finished
normal learning rate scheduler step
Epoch-47 lr: 7.038263865062416e-07
Epoch-47 lr: 7.038263865062416e-07
epoch 47 training time: 15.233
---------------
2023-09-24 18:30:59.504741
current #epochs=48, #steps=1833
start validation
[I 2023-09-24 18:31:14,710] Trial 54 finished with value: 0.4663521029175299 and parameters: {'warmup': 'True', 'num_epochs': 48, 'batch_size': 52, 'lr-adaptschedule': 'True', 'lr': 0.0003538482716720928, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.7436425178684087}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.732394
AUC: 0.901207
Avg Precision: 0.466352
Avg Recall: 1.000000
d_prime: 1.822157
train_loss: 0.042518
valid_loss: 1.332124
validation finished
normal learning rate scheduler step
Epoch-48 lr: 5.233952262037253e-07
Epoch-48 lr: 5.233952262037253e-07
epoch 48 training time: 15.194
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f556430>
The learning rate scheduler starts at 4 epoch with decay rate of 0.725 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 18:31:14.747100
current #epochs=1, #steps=0
start validation
acc: 0.737089
AUC: 0.900051
Avg Precision: 0.464478
Avg Recall: 1.000000
d_prime: 1.812799
train_loss: 0.053407
valid_loss: 1.332631
validation finished
normal learning rate scheduler step
Epoch-1 lr: 2.1196173232821986e-05
Epoch-1 lr: 2.1196173232821986e-05
epoch 1 training time: 18.105
---------------
2023-09-24 18:31:32.852828
current #epochs=2, #steps=39
start validation
acc: 0.732394
AUC: 0.900473
Avg Precision: 0.463934
Avg Recall: 1.000000
d_prime: 1.816202
train_loss: 0.054835
valid_loss: 1.332083
validation finished
normal learning rate scheduler step
Epoch-2 lr: 2.1196173232821986e-05
Epoch-2 lr: 2.1196173232821986e-05
epoch 2 training time: 15.144
---------------
2023-09-24 18:31:47.997260
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00562	Train Loss 0.0637	
start validation
acc: 0.737089
AUC: 0.900830
Avg Precision: 0.465357
Avg Recall: 1.000000
d_prime: 1.819098
train_loss: 0.056433
valid_loss: 1.332207
validation finished
normal learning rate scheduler step
Epoch-3 lr: 2.1196173232821986e-05
Epoch-3 lr: 2.1196173232821986e-05
epoch 3 training time: 15.177
---------------
2023-09-24 18:32:03.173611
current #epochs=4, #steps=117
start validation
acc: 0.737089
AUC: 0.900741
Avg Precision: 0.465619
Avg Recall: 1.000000
d_prime: 1.818379
train_loss: 0.046283
valid_loss: 1.332287
validation finished
normal learning rate scheduler step
Epoch-4 lr: 1.5362664212739995e-05
Epoch-4 lr: 1.5362664212739995e-05
epoch 4 training time: 15.804
---------------
2023-09-24 18:32:18.977544
current #epochs=5, #steps=156
start validation
acc: 0.737089
AUC: 0.900509
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.816495
train_loss: 0.042104
valid_loss: 1.332686
validation finished
normal learning rate scheduler step
Epoch-5 lr: 1.1134625534572517e-05
Epoch-5 lr: 1.1134625534572517e-05
epoch 5 training time: 15.263
---------------
2023-09-24 18:32:34.241070
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01134	Per Sample Data Time 0.00517	Per Sample DNN Time 0.00617	Train Loss 0.0743	
start validation
acc: 0.737089
AUC: 0.900584
Avg Precision: 0.465151
Avg Recall: 1.000000
d_prime: 1.817104
train_loss: 0.044913
valid_loss: 1.333201
validation finished
normal learning rate scheduler step
Epoch-6 lr: 8.070207359758596e-06
Epoch-6 lr: 8.070207359758596e-06
epoch 6 training time: 15.580
---------------
2023-09-24 18:32:49.821395
current #epochs=7, #steps=234
start validation
acc: 0.737089
AUC: 0.900485
Avg Precision: 0.465151
Avg Recall: 1.000000
d_prime: 1.816306
train_loss: 0.058446
valid_loss: 1.333237
validation finished
normal learning rate scheduler step
Epoch-7 lr: 5.849163640688365e-06
Epoch-7 lr: 5.849163640688365e-06
epoch 7 training time: 15.138
---------------
2023-09-24 18:33:04.959296
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00685	Per Sample Data Time 0.00124	Per Sample DNN Time 0.00561	Train Loss 0.0576	
start validation
acc: 0.737089
AUC: 0.900607
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.817292
train_loss: 0.062967
valid_loss: 1.333007
validation finished
normal learning rate scheduler step
Epoch-8 lr: 4.239384909258908e-06
Epoch-8 lr: 4.239384909258908e-06
epoch 8 training time: 15.213
---------------
2023-09-24 18:33:20.172797
current #epochs=9, #steps=312
start validation
acc: 0.737089
AUC: 0.900601
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.817243
train_loss: 0.068542
valid_loss: 1.333042
validation finished
normal learning rate scheduler step
Epoch-9 lr: 3.072641750665239e-06
Epoch-9 lr: 3.072641750665239e-06
epoch 9 training time: 15.354
---------------
2023-09-24 18:33:35.526846
current #epochs=10, #steps=351
start validation
acc: 0.737089
AUC: 0.900751
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.818456
train_loss: 0.050865
valid_loss: 1.332905
validation finished
normal learning rate scheduler step
Epoch-10 lr: 2.2270040418626575e-06
Epoch-10 lr: 2.2270040418626575e-06
epoch 10 training time: 16.318
---------------
2023-09-24 18:33:51.844261
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00860	Per Sample Data Time 0.00298	Per Sample DNN Time 0.00562	Train Loss 0.0427	
start validation
acc: 0.737089
AUC: 0.900760
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.818528
train_loss: 0.063604
valid_loss: 1.332888
validation finished
normal learning rate scheduler step
Epoch-11 lr: 1.614098682802462e-06
Epoch-11 lr: 1.614098682802462e-06
epoch 11 training time: 17.171
---------------
2023-09-24 18:34:09.015243
current #epochs=12, #steps=429
start validation
acc: 0.737089
AUC: 0.900837
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819155
train_loss: 0.051095
valid_loss: 1.332873
validation finished
normal learning rate scheduler step
Epoch-12 lr: 1.169874193692782e-06
Epoch-12 lr: 1.169874193692782e-06
epoch 12 training time: 15.521
---------------
2023-09-24 18:34:24.536264
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00669	Per Sample Data Time 0.00105	Per Sample DNN Time 0.00564	Train Loss 0.0494	
start validation
acc: 0.737089
AUC: 0.900837
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819155
train_loss: 0.052808
valid_loss: 1.332854
validation finished
normal learning rate scheduler step
Epoch-13 lr: 8.479070354559175e-07
Epoch-13 lr: 8.479070354559175e-07
epoch 13 training time: 15.338
---------------
2023-09-24 18:34:39.874121
current #epochs=14, #steps=507
start validation
acc: 0.737089
AUC: 0.900822
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819034
train_loss: 0.058283
valid_loss: 1.332836
validation finished
normal learning rate scheduler step
Epoch-14 lr: 6.145501325285609e-07
Epoch-14 lr: 6.145501325285609e-07
epoch 14 training time: 15.201
---------------
2023-09-24 18:34:55.075315
current #epochs=15, #steps=546
start validation
acc: 0.737089
AUC: 0.900801
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.818861
train_loss: 0.056494
valid_loss: 1.332857
validation finished
normal learning rate scheduler step
Epoch-15 lr: 4.4541659592174343e-07
Epoch-15 lr: 4.4541659592174343e-07
epoch 15 training time: 15.346
---------------
2023-09-24 18:35:10.420990
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00770	Per Sample Data Time 0.00197	Per Sample DNN Time 0.00574	Train Loss 0.0375	
start validation
acc: 0.737089
AUC: 0.900888
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819563
train_loss: 0.064030
valid_loss: 1.332851
validation finished
normal learning rate scheduler step
Epoch-16 lr: 3.2283117913621685e-07
Epoch-16 lr: 3.2283117913621685e-07
epoch 16 training time: 15.167
---------------
2023-09-24 18:35:25.587887
current #epochs=17, #steps=624
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.048081
valid_loss: 1.332860
validation finished
normal learning rate scheduler step
Epoch-17 lr: 2.3398313214353345e-07
Epoch-17 lr: 2.3398313214353345e-07
epoch 17 training time: 16.467
---------------
2023-09-24 18:35:42.055490
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00650	Per Sample Data Time 0.00096	Per Sample DNN Time 0.00554	Train Loss 0.0471	
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.047711
valid_loss: 1.332870
validation finished
normal learning rate scheduler step
Epoch-18 lr: 1.6958741802506495e-07
Epoch-18 lr: 1.6958741802506495e-07
epoch 18 training time: 15.252
---------------
2023-09-24 18:35:57.307171
current #epochs=19, #steps=702
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.053056
valid_loss: 1.332873
validation finished
normal learning rate scheduler step
Epoch-19 lr: 1.2291438313923331e-07
Epoch-19 lr: 1.2291438313923331e-07
epoch 19 training time: 15.229
---------------
2023-09-24 18:36:12.535866
current #epochs=20, #steps=741
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.066332
valid_loss: 1.332875
validation finished
normal learning rate scheduler step
Epoch-20 lr: 8.908647680611125e-08
Epoch-20 lr: 8.908647680611125e-08
epoch 20 training time: 15.213
---------------
2023-09-24 18:36:27.749178
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00731	Per Sample Data Time 0.00162	Per Sample DNN Time 0.00569	Train Loss 0.0568	
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.053783
valid_loss: 1.332874
validation finished
normal learning rate scheduler step
Epoch-21 lr: 6.45685244235063e-08
Epoch-21 lr: 6.45685244235063e-08
epoch 21 training time: 16.532
---------------
2023-09-24 18:36:44.280718
current #epochs=22, #steps=819
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.050288
valid_loss: 1.332873
validation finished
normal learning rate scheduler step
Epoch-22 lr: 4.679828516849523e-08
Epoch-22 lr: 4.679828516849523e-08
epoch 22 training time: 16.604
---------------
2023-09-24 18:37:00.884962
current #epochs=23, #steps=858
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.050029
valid_loss: 1.332873
validation finished
normal learning rate scheduler step
Epoch-23 lr: 3.391868583440165e-08
Epoch-23 lr: 3.391868583440165e-08
epoch 23 training time: 15.143
---------------
2023-09-24 18:37:16.028315
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01424	Per Sample Data Time 0.00830	Per Sample DNN Time 0.00594	Train Loss 0.0617	
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.047850
valid_loss: 1.332874
validation finished
normal learning rate scheduler step
Epoch-24 lr: 2.4583747985435685e-08
Epoch-24 lr: 2.4583747985435685e-08
epoch 24 training time: 15.309
---------------
2023-09-24 18:37:31.336874
current #epochs=25, #steps=936
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.034771
valid_loss: 1.332873
validation finished
normal learning rate scheduler step
Epoch-25 lr: 1.7817926907959594e-08
Epoch-25 lr: 1.7817926907959594e-08
epoch 25 training time: 16.707
---------------
2023-09-24 18:37:48.043638
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00698	Per Sample Data Time 0.00134	Per Sample DNN Time 0.00564	Train Loss 0.0453	
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.061231
valid_loss: 1.332873
validation finished
normal learning rate scheduler step
Epoch-26 lr: 1.2914162620178033e-08
Epoch-26 lr: 1.2914162620178033e-08
epoch 26 training time: 15.199
---------------
2023-09-24 18:38:03.242947
current #epochs=27, #steps=1014
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.055766
valid_loss: 1.332873
validation finished
normal learning rate scheduler step
Epoch-27 lr: 9.359988793415795e-09
Epoch-27 lr: 9.359988793415795e-09
epoch 27 training time: 16.830
---------------
2023-09-24 18:38:20.073435
current #epochs=28, #steps=1053
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.057329
valid_loss: 1.332873
validation finished
normal learning rate scheduler step
Epoch-28 lr: 6.783977621280837e-09
Epoch-28 lr: 6.783977621280837e-09
epoch 28 training time: 15.222
---------------
2023-09-24 18:38:35.295288
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00936	Per Sample Data Time 0.00359	Per Sample DNN Time 0.00577	Train Loss 0.0470	
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.059259
valid_loss: 1.332873
validation finished
normal learning rate scheduler step
Epoch-29 lr: 4.916923874782119e-09
Epoch-29 lr: 4.916923874782119e-09
epoch 29 training time: 15.178
---------------
2023-09-24 18:38:50.472951
current #epochs=30, #steps=1131
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.065040
valid_loss: 1.332873
validation finished
normal learning rate scheduler step
Epoch-30 lr: 3.5637116954165124e-09
Epoch-30 lr: 3.5637116954165124e-09
epoch 30 training time: 15.233
---------------
2023-09-24 18:39:05.706422
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00681	Per Sample Data Time 0.00122	Per Sample DNN Time 0.00559	Train Loss 0.0526	
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.053719
valid_loss: 1.332873
validation finished
normal learning rate scheduler step
Epoch-31 lr: 2.582924074375913e-09
Epoch-31 lr: 2.582924074375913e-09
epoch 31 training time: 15.441
---------------
2023-09-24 18:39:21.146997
current #epochs=32, #steps=1209
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.055217
valid_loss: 1.332873
validation finished
normal learning rate scheduler step
Epoch-32 lr: 1.872064112978401e-09
Epoch-32 lr: 1.872064112978401e-09
epoch 32 training time: 15.159
---------------
2023-09-24 18:39:36.306545
current #epochs=33, #steps=1248
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.050769
valid_loss: 1.332873
validation finished
normal learning rate scheduler step
Epoch-33 lr: 1.3568436168408844e-09
Epoch-33 lr: 1.3568436168408844e-09
epoch 33 training time: 15.366
---------------
2023-09-24 18:39:51.672421
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00821	Per Sample Data Time 0.00239	Per Sample DNN Time 0.00583	Train Loss 0.0582	
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.061362
valid_loss: 1.332873
validation finished
normal learning rate scheduler step
Epoch-34 lr: 9.834196317308997e-10
Epoch-34 lr: 9.834196317308997e-10
epoch 34 training time: 15.307
---------------
2023-09-24 18:40:06.979194
current #epochs=35, #steps=1326
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.045716
valid_loss: 1.332873
validation finished
normal learning rate scheduler step
Epoch-35 lr: 7.127676027436778e-10
Epoch-35 lr: 7.127676027436778e-10
epoch 35 training time: 15.149
---------------
2023-09-24 18:40:22.127664
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00656	Per Sample Data Time 0.00101	Per Sample DNN Time 0.00555	Train Loss 0.0660	
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.064937
valid_loss: 1.332873
validation finished
normal learning rate scheduler step
Epoch-36 lr: 5.166031255922572e-10
Epoch-36 lr: 5.166031255922572e-10
epoch 36 training time: 15.519
---------------
2023-09-24 18:40:37.646983
current #epochs=37, #steps=1404
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.050447
valid_loss: 1.332873
validation finished
normal learning rate scheduler step
Epoch-37 lr: 3.7442609392512356e-10
Epoch-37 lr: 3.7442609392512356e-10
epoch 37 training time: 15.290
---------------
2023-09-24 18:40:52.937482
current #epochs=38, #steps=1443
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.054306
valid_loss: 1.332873
validation finished
normal learning rate scheduler step
Epoch-38 lr: 2.713783422260554e-10
Epoch-38 lr: 2.713783422260554e-10
epoch 38 training time: 15.213
---------------
2023-09-24 18:41:08.151181
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00733	Per Sample Data Time 0.00174	Per Sample DNN Time 0.00559	Train Loss 0.0549	
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.061005
valid_loss: 1.332873
validation finished
normal learning rate scheduler step
Epoch-39 lr: 1.9669089794817975e-10
Epoch-39 lr: 1.9669089794817975e-10
epoch 39 training time: 15.286
---------------
2023-09-24 18:41:23.437375
current #epochs=40, #steps=1521
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.049735
valid_loss: 1.332873
validation finished
normal learning rate scheduler step
Epoch-40 lr: 1.4255857345990833e-10
Epoch-40 lr: 1.4255857345990833e-10
epoch 40 training time: 15.200
---------------
2023-09-24 18:41:38.637775
current #epochs=41, #steps=1560
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.048298
valid_loss: 1.332873
validation finished
normal learning rate scheduler step
Epoch-41 lr: 1.0332428739167366e-10
Epoch-41 lr: 1.0332428739167366e-10
epoch 41 training time: 15.201
---------------
2023-09-24 18:41:53.838685
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02306	Per Sample Data Time 0.01551	Per Sample DNN Time 0.00755	Train Loss 0.0293	
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.044211
valid_loss: 1.332873
validation finished
normal learning rate scheduler step
Epoch-42 lr: 7.488787314499575e-11
Epoch-42 lr: 7.488787314499575e-11
epoch 42 training time: 15.294
---------------
2023-09-24 18:42:09.133126
current #epochs=43, #steps=1638
start validation
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.053381
valid_loss: 1.332873
validation finished
normal learning rate scheduler step
Epoch-43 lr: 5.427759228497625e-11
Epoch-43 lr: 5.427759228497625e-11
epoch 43 training time: 16.442
---------------
2023-09-24 18:42:25.575015
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00143	Per Sample DNN Time 0.00563	Train Loss 0.0486	
start validation
[I 2023-09-24 18:42:40,927] Trial 55 finished with value: 0.46549219121085733 and parameters: {'warmup': 'True', 'num_epochs': 44, 'batch_size': 50, 'lr-adaptschedule': 'True', 'lr': 2.1196173232821986e-05, 'head-lr': 1, 'lr-scheduler-start': 4, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7247848016712337}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.737089
AUC: 0.900903
Avg Precision: 0.465492
Avg Recall: 1.000000
d_prime: 1.819685
train_loss: 0.051188
valid_loss: 1.332873
validation finished
normal learning rate scheduler step
Epoch-44 lr: 3.9339573959458595e-11
Epoch-44 lr: 3.9339573959458595e-11
epoch 44 training time: 15.342
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67ec58190>
The learning rate scheduler starts at 7 epoch with decay rate of 0.792 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 18:42:40.962974
current #epochs=1, #steps=0
start validation
acc: 0.727700
AUC: 0.899899
Avg Precision: 0.484543
Avg Recall: 1.000000
d_prime: 1.811574
train_loss: 0.043401
valid_loss: 1.326223
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0005313813173365605
Epoch-1 lr: 0.0005313813173365605
epoch 1 training time: 17.632
---------------
2023-09-24 18:42:58.595185
current #epochs=2, #steps=39
start validation
acc: 0.718310
AUC: 0.893711
Avg Precision: 0.462448
Avg Recall: 1.000000
d_prime: 1.762825
train_loss: 0.065686
valid_loss: 1.335993
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0005313813173365605
Epoch-2 lr: 0.0005313813173365605
epoch 2 training time: 15.050
---------------
2023-09-24 18:43:13.644832
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00561	Train Loss 0.0699	
start validation
acc: 0.718310
AUC: 0.895773
Avg Precision: 0.463912
Avg Recall: 1.000000
d_prime: 1.778838
train_loss: 0.064229
valid_loss: 1.338228
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0005313813173365605
Epoch-3 lr: 0.0005313813173365605
epoch 3 training time: 15.325
---------------
2023-09-24 18:43:28.969767
current #epochs=4, #steps=117
start validation
acc: 0.713615
AUC: 0.891593
Avg Precision: 0.472118
Avg Recall: 1.000000
d_prime: 1.746617
train_loss: 0.066094
valid_loss: 1.347507
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0005313813173365605
Epoch-4 lr: 0.0005313813173365605
epoch 4 training time: 15.236
---------------
2023-09-24 18:43:44.205667
current #epochs=5, #steps=156
start validation
acc: 0.723005
AUC: 0.902459
Avg Precision: 0.475550
Avg Recall: 1.000000
d_prime: 1.832383
train_loss: 0.069219
valid_loss: 1.333448
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0005313813173365605
Epoch-5 lr: 0.0005313813173365605
epoch 5 training time: 15.103
---------------
2023-09-24 18:43:59.308912
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01137	Per Sample Data Time 0.00524	Per Sample DNN Time 0.00613	Train Loss 0.0456	
start validation
acc: 0.732394
AUC: 0.906104
Avg Precision: 0.466264
Avg Recall: 1.000000
d_prime: 1.862720
train_loss: 0.064134
valid_loss: 1.317700
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0005313813173365605
Epoch-6 lr: 0.0005313813173365605
epoch 6 training time: 17.654
---------------
2023-09-24 18:44:16.962773
current #epochs=7, #steps=234
start validation
acc: 0.741784
AUC: 0.905324
Avg Precision: 0.470690
Avg Recall: 1.000000
d_prime: 1.856151
train_loss: 0.072553
valid_loss: 1.316304
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0004210695657881755
Epoch-7 lr: 0.0004210695657881755
epoch 7 training time: 17.627
---------------
2023-09-24 18:44:34.590064
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00684	Per Sample Data Time 0.00123	Per Sample DNN Time 0.00561	Train Loss 0.0623	
start validation
acc: 0.769953
AUC: 0.905512
Avg Precision: 0.482582
Avg Recall: 1.000000
d_prime: 1.857733
train_loss: 0.069996
valid_loss: 1.324499
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0004210695657881755
Epoch-8 lr: 0.0004210695657881755
epoch 8 training time: 17.622
---------------
2023-09-24 18:44:52.212480
current #epochs=9, #steps=312
start validation
acc: 0.732394
AUC: 0.900115
Avg Precision: 0.479076
Avg Recall: 1.000000
d_prime: 1.813313
train_loss: 0.053521
valid_loss: 1.326887
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00033365790901667433
Epoch-9 lr: 0.00033365790901667433
epoch 9 training time: 15.206
---------------
2023-09-24 18:45:07.418104
current #epochs=10, #steps=351
start validation
acc: 0.708920
AUC: 0.898335
Avg Precision: 0.475598
Avg Recall: 1.000000
d_prime: 1.799048
train_loss: 0.067342
valid_loss: 1.325425
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00033365790901667433
Epoch-10 lr: 0.00033365790901667433
epoch 10 training time: 15.152
---------------
2023-09-24 18:45:22.569830
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00878	Per Sample Data Time 0.00301	Per Sample DNN Time 0.00577	Train Loss 0.0633	
start validation
acc: 0.704225
AUC: 0.896713
Avg Precision: 0.476773
Avg Recall: 1.000000
d_prime: 1.786210
train_loss: 0.062655
valid_loss: 1.340344
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0002643924170605674
Epoch-11 lr: 0.0002643924170605674
epoch 11 training time: 15.467
---------------
2023-09-24 18:45:38.037464
current #epochs=12, #steps=429
start validation
acc: 0.704225
AUC: 0.900775
Avg Precision: 0.472615
Avg Recall: 1.000000
d_prime: 1.818649
train_loss: 0.056136
valid_loss: 1.330898
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0002643924170605674
Epoch-12 lr: 0.0002643924170605674
epoch 12 training time: 15.239
---------------
2023-09-24 18:45:53.276273
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00668	Per Sample Data Time 0.00109	Per Sample DNN Time 0.00558	Train Loss 0.0496	
start validation
acc: 0.718310
AUC: 0.902251
Avg Precision: 0.475369
Avg Recall: 1.000000
d_prime: 1.830677
train_loss: 0.053712
valid_loss: 1.329900
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.000209506048890439
Epoch-13 lr: 0.000209506048890439
epoch 13 training time: 15.218
---------------
2023-09-24 18:46:08.493867
current #epochs=14, #steps=507
start validation
acc: 0.746479
AUC: 0.904701
Avg Precision: 0.477201
Avg Recall: 1.000000
d_prime: 1.850936
train_loss: 0.055038
valid_loss: 1.329523
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.000209506048890439
Epoch-14 lr: 0.000209506048890439
epoch 14 training time: 15.186
---------------
2023-09-24 18:46:23.680381
current #epochs=15, #steps=546
start validation
acc: 0.751174
AUC: 0.904478
Avg Precision: 0.476048
Avg Recall: 1.000000
d_prime: 1.849076
train_loss: 0.045607
valid_loss: 1.329228
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.00016601377985673465
Epoch-15 lr: 0.00016601377985673465
epoch 15 training time: 15.089
---------------
2023-09-24 18:46:38.769522
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00783	Per Sample Data Time 0.00204	Per Sample DNN Time 0.00579	Train Loss 0.0688	
start validation
acc: 0.727700
AUC: 0.904947
Avg Precision: 0.474622
Avg Recall: 1.000000
d_prime: 1.852997
train_loss: 0.058147
valid_loss: 1.328038
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.00016601377985673465
Epoch-16 lr: 0.00016601377985673465
epoch 16 training time: 15.390
---------------
2023-09-24 18:46:54.159507
current #epochs=17, #steps=624
start validation
acc: 0.737089
AUC: 0.905311
Avg Precision: 0.474459
Avg Recall: 1.000000
d_prime: 1.856045
train_loss: 0.045934
valid_loss: 1.324529
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.00013155025951891794
Epoch-17 lr: 0.00013155025951891794
epoch 17 training time: 15.165
---------------
2023-09-24 18:47:09.324345
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00645	Per Sample Data Time 0.00090	Per Sample DNN Time 0.00555	Train Loss 0.0612	
start validation
acc: 0.732394
AUC: 0.905081
Avg Precision: 0.473923
Avg Recall: 1.000000
d_prime: 1.854114
train_loss: 0.061740
valid_loss: 1.324630
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00013155025951891794
Epoch-18 lr: 0.00013155025951891794
epoch 18 training time: 15.113
---------------
2023-09-24 18:47:24.438080
current #epochs=19, #steps=702
start validation
acc: 0.737089
AUC: 0.903037
Avg Precision: 0.470087
Avg Recall: 1.000000
d_prime: 1.837140
train_loss: 0.052287
valid_loss: 1.324468
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00010424117078973086
Epoch-19 lr: 0.00010424117078973086
epoch 19 training time: 15.190
---------------
2023-09-24 18:47:39.628020
current #epochs=20, #steps=741
start validation
acc: 0.732394
AUC: 0.903943
Avg Precision: 0.474051
Avg Recall: 1.000000
d_prime: 1.844628
train_loss: 0.057333
valid_loss: 1.325357
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00010424117078973086
Epoch-20 lr: 0.00010424117078973086
epoch 20 training time: 15.240
---------------
2023-09-24 18:47:54.867993
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00555	Train Loss 0.0601	
start validation
acc: 0.732394
AUC: 0.903599
Avg Precision: 0.472575
Avg Recall: 1.000000
d_prime: 1.841781
train_loss: 0.074257
valid_loss: 1.327254
validation finished
normal learning rate scheduler step
Epoch-21 lr: 8.2601294192439e-05
Epoch-21 lr: 8.2601294192439e-05
epoch 21 training time: 15.197
---------------
2023-09-24 18:48:10.065433
current #epochs=22, #steps=819
start validation
acc: 0.732394
AUC: 0.903563
Avg Precision: 0.473698
Avg Recall: 1.000000
d_prime: 1.841483
train_loss: 0.065385
valid_loss: 1.330482
validation finished
normal learning rate scheduler step
Epoch-22 lr: 8.2601294192439e-05
Epoch-22 lr: 8.2601294192439e-05
epoch 22 training time: 15.167
---------------
2023-09-24 18:48:25.232261
current #epochs=23, #steps=858
start validation
acc: 0.727700
AUC: 0.902070
Avg Precision: 0.474053
Avg Recall: 1.000000
d_prime: 1.829194
train_loss: 0.064871
valid_loss: 1.332425
validation finished
normal learning rate scheduler step
Epoch-23 lr: 6.545373340087245e-05
Epoch-23 lr: 6.545373340087245e-05
epoch 23 training time: 15.322
---------------
2023-09-24 18:48:40.554144
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01406	Per Sample Data Time 0.00781	Per Sample DNN Time 0.00625	Train Loss 0.0766	
start validation
acc: 0.718310
AUC: 0.901353
Avg Precision: 0.474716
Avg Recall: 1.000000
d_prime: 1.823341
train_loss: 0.060839
valid_loss: 1.332139
validation finished
normal learning rate scheduler step
Epoch-24 lr: 6.545373340087245e-05
Epoch-24 lr: 6.545373340087245e-05
epoch 24 training time: 15.160
---------------
2023-09-24 18:48:55.714627
current #epochs=25, #steps=936
start validation
acc: 0.718310
AUC: 0.901062
Avg Precision: 0.474397
Avg Recall: 1.000000
d_prime: 1.820980
train_loss: 0.043437
valid_loss: 1.330499
validation finished
normal learning rate scheduler step
Epoch-25 lr: 5.186590909981945e-05
Epoch-25 lr: 5.186590909981945e-05
epoch 25 training time: 15.260
---------------
2023-09-24 18:49:10.974884
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00685	Per Sample Data Time 0.00127	Per Sample DNN Time 0.00558	Train Loss 0.0614	
start validation
acc: 0.732394
AUC: 0.901454
Avg Precision: 0.474136
Avg Recall: 1.000000
d_prime: 1.824169
train_loss: 0.065022
valid_loss: 1.329392
validation finished
normal learning rate scheduler step
Epoch-26 lr: 5.186590909981945e-05
Epoch-26 lr: 5.186590909981945e-05
epoch 26 training time: 15.127
---------------
2023-09-24 18:49:26.102397
current #epochs=27, #steps=1014
start validation
acc: 0.737089
AUC: 0.902287
Avg Precision: 0.475033
Avg Recall: 1.000000
d_prime: 1.830975
train_loss: 0.060903
valid_loss: 1.328247
validation finished
normal learning rate scheduler step
Epoch-27 lr: 4.109884015744895e-05
Epoch-27 lr: 4.109884015744895e-05
epoch 27 training time: 15.163
---------------
2023-09-24 18:49:41.264809
current #epochs=28, #steps=1053
start validation
acc: 0.723005
AUC: 0.903950
Avg Precision: 0.477024
Avg Recall: 1.000000
d_prime: 1.844691
train_loss: 0.046397
valid_loss: 1.327163
validation finished
normal learning rate scheduler step
Epoch-28 lr: 4.109884015744895e-05
Epoch-28 lr: 4.109884015744895e-05
epoch 28 training time: 15.287
---------------
2023-09-24 18:49:56.552222
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00935	Per Sample Data Time 0.00350	Per Sample DNN Time 0.00584	Train Loss 0.0401	
start validation
acc: 0.727700
AUC: 0.904754
Avg Precision: 0.477512
Avg Recall: 1.000000
d_prime: 1.851380
train_loss: 0.038097
valid_loss: 1.326986
validation finished
normal learning rate scheduler step
Epoch-29 lr: 3.256695373904896e-05
Epoch-29 lr: 3.256695373904896e-05
epoch 29 training time: 15.092
---------------
2023-09-24 18:50:11.644248
current #epochs=30, #steps=1131
start validation
acc: 0.727700
AUC: 0.904518
Avg Precision: 0.476727
Avg Recall: 1.000000
d_prime: 1.849409
train_loss: 0.055693
valid_loss: 1.327325
validation finished
normal learning rate scheduler step
Epoch-30 lr: 3.256695373904896e-05
Epoch-30 lr: 3.256695373904896e-05
epoch 30 training time: 15.233
---------------
2023-09-24 18:50:26.877393
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00675	Per Sample Data Time 0.00112	Per Sample DNN Time 0.00563	Train Loss 0.0528	
start validation
acc: 0.732394
AUC: 0.904133
Avg Precision: 0.477616
Avg Recall: 1.000000
d_prime: 1.846212
train_loss: 0.047165
valid_loss: 1.327779
validation finished
normal learning rate scheduler step
Epoch-31 lr: 2.5806238613503197e-05
Epoch-31 lr: 2.5806238613503197e-05
epoch 31 training time: 15.224
---------------
2023-09-24 18:50:42.101229
current #epochs=32, #steps=1209
start validation
acc: 0.732394
AUC: 0.904741
Avg Precision: 0.477714
Avg Recall: 1.000000
d_prime: 1.851270
train_loss: 0.059625
valid_loss: 1.327619
validation finished
normal learning rate scheduler step
Epoch-32 lr: 2.5806238613503197e-05
Epoch-32 lr: 2.5806238613503197e-05
epoch 32 training time: 15.124
---------------
2023-09-24 18:50:57.225327
current #epochs=33, #steps=1248
start validation
acc: 0.737089
AUC: 0.904850
Avg Precision: 0.478192
Avg Recall: 1.000000
d_prime: 1.852184
train_loss: 0.054860
valid_loss: 1.328944
validation finished
normal learning rate scheduler step
Epoch-33 lr: 2.0449009652952307e-05
Epoch-33 lr: 2.0449009652952307e-05
epoch 33 training time: 15.234
---------------
2023-09-24 18:51:12.458708
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00795	Per Sample Data Time 0.00223	Per Sample DNN Time 0.00572	Train Loss 0.0529	
start validation
acc: 0.737089
AUC: 0.904795
Avg Precision: 0.478310
Avg Recall: 1.000000
d_prime: 1.851724
train_loss: 0.044515
valid_loss: 1.329023
validation finished
normal learning rate scheduler step
Epoch-34 lr: 2.0449009652952307e-05
Epoch-34 lr: 2.0449009652952307e-05
epoch 34 training time: 15.928
---------------
2023-09-24 18:51:28.387057
current #epochs=35, #steps=1326
start validation
[I 2023-09-24 18:51:43,574] Trial 56 finished with value: 0.47790031837650887 and parameters: {'warmup': 'True', 'num_epochs': 35, 'batch_size': 53, 'lr-adaptschedule': 'True', 'lr': 0.0005313813173365605, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.7924056643517315}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.737089
AUC: 0.904754
Avg Precision: 0.477900
Avg Recall: 1.000000
d_prime: 1.851383
train_loss: 0.063452
valid_loss: 1.329010
validation finished
normal learning rate scheduler step
Epoch-35 lr: 1.6203911079382643e-05
Epoch-35 lr: 1.6203911079382643e-05
epoch 35 training time: 15.179
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa6015c0e20>
The learning rate scheduler starts at 4 epoch with decay rate of 0.772 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 18:51:43.610739
current #epochs=1, #steps=0
start validation
acc: 0.718310
AUC: 0.910808
Avg Precision: 0.497005
Avg Recall: 1.000000
d_prime: 1.903172
train_loss: 0.092781
valid_loss: 1.323573
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0008703409130307395
Epoch-1 lr: 0.0008703409130307395
epoch 1 training time: 17.704
---------------
2023-09-24 18:52:01.315058
current #epochs=2, #steps=39
start validation
acc: 0.708920
AUC: 0.876489
Avg Precision: 0.470428
Avg Recall: 1.000000
d_prime: 1.637112
train_loss: 0.074126
valid_loss: 1.363000
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0008703409130307395
Epoch-2 lr: 0.0008703409130307395
epoch 2 training time: 15.133
---------------
2023-09-24 18:52:16.448107
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00569	Train Loss 0.0776	
start validation
acc: 0.737089
AUC: 0.898394
Avg Precision: 0.472661
Avg Recall: 1.000000
d_prime: 1.799518
train_loss: 0.076813
valid_loss: 1.341543
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0008703409130307395
Epoch-3 lr: 0.0008703409130307395
epoch 3 training time: 17.573
---------------
2023-09-24 18:52:34.021677
current #epochs=4, #steps=117
start validation
acc: 0.732394
AUC: 0.900265
Avg Precision: 0.497931
Avg Recall: 1.000000
d_prime: 1.814522
train_loss: 0.068719
valid_loss: 1.351993
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0006719030685868011
Epoch-4 lr: 0.0006719030685868011
epoch 4 training time: 15.175
---------------
2023-09-24 18:52:49.196241
current #epochs=5, #steps=156
start validation
acc: 0.708920
AUC: 0.898204
Avg Precision: 0.464723
Avg Recall: 1.000000
d_prime: 1.798005
train_loss: 0.057944
valid_loss: 1.346927
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0006719030685868011
Epoch-5 lr: 0.0006719030685868011
epoch 5 training time: 15.059
---------------
2023-09-24 18:53:04.254958
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01151	Per Sample Data Time 0.00544	Per Sample DNN Time 0.00607	Train Loss 0.0747	
start validation
acc: 0.723005
AUC: 0.898655
Avg Precision: 0.480727
Avg Recall: 1.000000
d_prime: 1.801605
train_loss: 0.068117
valid_loss: 1.340676
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0006719030685868011
Epoch-6 lr: 0.0006719030685868011
epoch 6 training time: 15.188
---------------
2023-09-24 18:53:19.442772
current #epochs=7, #steps=234
start validation
acc: 0.751174
AUC: 0.898217
Avg Precision: 0.476890
Avg Recall: 1.000000
d_prime: 1.798110
train_loss: 0.051446
valid_loss: 1.345131
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0005187090791863243
Epoch-7 lr: 0.0005187090791863243
epoch 7 training time: 17.638
---------------
2023-09-24 18:53:37.080659
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00679	Per Sample Data Time 0.00123	Per Sample DNN Time 0.00556	Train Loss 0.0812	
start validation
acc: 0.713615
AUC: 0.902012
Avg Precision: 0.483677
Avg Recall: 1.000000
d_prime: 1.828724
train_loss: 0.076603
valid_loss: 1.336929
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0005187090791863243
Epoch-8 lr: 0.0005187090791863243
epoch 8 training time: 15.179
---------------
2023-09-24 18:53:52.259490
current #epochs=9, #steps=312
start validation
acc: 0.746479
AUC: 0.906167
Avg Precision: 0.466870
Avg Recall: 1.000000
d_prime: 1.863248
train_loss: 0.059588
valid_loss: 1.340168
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0005187090791863243
Epoch-9 lr: 0.0005187090791863243
epoch 9 training time: 15.194
---------------
2023-09-24 18:54:07.453228
current #epochs=10, #steps=351
start validation
acc: 0.755869
AUC: 0.908530
Avg Precision: 0.478328
Avg Recall: 1.000000
d_prime: 1.883390
train_loss: 0.069786
valid_loss: 1.330990
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0004004433398350606
Epoch-10 lr: 0.0004004433398350606
epoch 10 training time: 17.657
---------------
2023-09-24 18:54:25.110713
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00875	Per Sample Data Time 0.00298	Per Sample DNN Time 0.00577	Train Loss 0.0568	
start validation
acc: 0.741784
AUC: 0.910179
Avg Precision: 0.468130
Avg Recall: 1.000000
d_prime: 1.897677
train_loss: 0.062707
valid_loss: 1.320634
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0004004433398350606
Epoch-11 lr: 0.0004004433398350606
epoch 11 training time: 15.251
---------------
2023-09-24 18:54:40.360985
current #epochs=12, #steps=429
start validation
acc: 0.732394
AUC: 0.905951
Avg Precision: 0.460962
Avg Recall: 1.000000
d_prime: 1.861428
train_loss: 0.066979
valid_loss: 1.341286
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0004004433398350606
Epoch-12 lr: 0.0004004433398350606
epoch 12 training time: 15.094
---------------
2023-09-24 18:54:55.455237
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00660	Per Sample Data Time 0.00109	Per Sample DNN Time 0.00551	Train Loss 0.0571	
start validation
acc: 0.708920
AUC: 0.909150
Avg Precision: 0.462293
Avg Recall: 1.000000
d_prime: 1.888735
train_loss: 0.055932
valid_loss: 1.334352
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0003091422048555605
Epoch-13 lr: 0.0003091422048555605
epoch 13 training time: 15.072
---------------
2023-09-24 18:55:10.527569
current #epochs=14, #steps=507
start validation
acc: 0.746479
AUC: 0.908637
Avg Precision: 0.479505
Avg Recall: 1.000000
d_prime: 1.884311
train_loss: 0.051606
valid_loss: 1.334179
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0003091422048555605
Epoch-14 lr: 0.0003091422048555605
epoch 14 training time: 15.129
---------------
2023-09-24 18:55:25.656702
current #epochs=15, #steps=546
start validation
acc: 0.755869
AUC: 0.912856
Avg Precision: 0.496338
Avg Recall: 1.000000
d_prime: 1.921284
train_loss: 0.052493
valid_loss: 1.322797
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0003091422048555605
Epoch-15 lr: 0.0003091422048555605
epoch 15 training time: 15.326
---------------
2023-09-24 18:55:40.982595
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00766	Per Sample Data Time 0.00202	Per Sample DNN Time 0.00564	Train Loss 0.0579	
start validation
acc: 0.718310
AUC: 0.908780
Avg Precision: 0.496718
Avg Recall: 1.000000
d_prime: 1.885539
train_loss: 0.059868
valid_loss: 1.342363
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.00023865774084873382
Epoch-16 lr: 0.00023865774084873382
epoch 16 training time: 15.185
---------------
2023-09-24 18:55:56.167352
current #epochs=17, #steps=624
start validation
acc: 0.723005
AUC: 0.903456
Avg Precision: 0.481846
Avg Recall: 1.000000
d_prime: 1.840599
train_loss: 0.064161
valid_loss: 1.345085
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.00023865774084873382
Epoch-17 lr: 0.00023865774084873382
epoch 17 training time: 15.150
---------------
2023-09-24 18:56:11.316952
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00650	Per Sample Data Time 0.00093	Per Sample DNN Time 0.00556	Train Loss 0.0634	
start validation
acc: 0.723005
AUC: 0.902548
Avg Precision: 0.461808
Avg Recall: 1.000000
d_prime: 1.833113
train_loss: 0.063222
valid_loss: 1.341552
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00023865774084873382
Epoch-18 lr: 0.00023865774084873382
epoch 18 training time: 15.095
---------------
2023-09-24 18:56:26.412381
current #epochs=19, #steps=702
start validation
acc: 0.737089
AUC: 0.905055
Avg Precision: 0.466240
Avg Recall: 1.000000
d_prime: 1.853897
train_loss: 0.060595
valid_loss: 1.334944
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00018424374405181414
Epoch-19 lr: 0.00018424374405181414
epoch 19 training time: 15.049
---------------
2023-09-24 18:56:41.461688
current #epochs=20, #steps=741
start validation
acc: 0.746479
AUC: 0.907431
Avg Precision: 0.480122
Avg Recall: 1.000000
d_prime: 1.873971
train_loss: 0.041883
valid_loss: 1.332857
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00018424374405181414
Epoch-20 lr: 0.00018424374405181414
epoch 20 training time: 15.185
---------------
2023-09-24 18:56:56.646928
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00724	Per Sample Data Time 0.00162	Per Sample DNN Time 0.00562	Train Loss 0.0694	
start validation
acc: 0.737089
AUC: 0.905089
Avg Precision: 0.478882
Avg Recall: 1.000000
d_prime: 1.854185
train_loss: 0.057674
valid_loss: 1.335117
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00018424374405181414
Epoch-21 lr: 0.00018424374405181414
epoch 21 training time: 15.237
---------------
2023-09-24 18:57:11.883865
current #epochs=22, #steps=819
start validation
acc: 0.751174
AUC: 0.903997
Avg Precision: 0.484176
Avg Recall: 1.000000
d_prime: 1.845077
train_loss: 0.066517
valid_loss: 1.339380
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00014223614579401354
Epoch-22 lr: 0.00014223614579401354
epoch 22 training time: 15.268
---------------
2023-09-24 18:57:27.151494
current #epochs=23, #steps=858
start validation
acc: 0.741784
AUC: 0.905204
Avg Precision: 0.487072
Avg Recall: 1.000000
d_prime: 1.855150
train_loss: 0.052385
valid_loss: 1.339021
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00014223614579401354
Epoch-23 lr: 0.00014223614579401354
epoch 23 training time: 15.190
---------------
2023-09-24 18:57:42.341914
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01433	Per Sample Data Time 0.00771	Per Sample DNN Time 0.00662	Train Loss 0.0822	
start validation
acc: 0.741784
AUC: 0.907462
Avg Precision: 0.480104
Avg Recall: 1.000000
d_prime: 1.874240
train_loss: 0.059776
valid_loss: 1.332662
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00014223614579401354
Epoch-24 lr: 0.00014223614579401354
epoch 24 training time: 15.140
---------------
2023-09-24 18:57:57.481838
current #epochs=25, #steps=936
start validation
acc: 0.746479
AUC: 0.908046
Avg Precision: 0.480876
Avg Recall: 1.000000
d_prime: 1.879229
train_loss: 0.048957
valid_loss: 1.332694
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00010980628555098379
Epoch-25 lr: 0.00010980628555098379
epoch 25 training time: 15.203
---------------
2023-09-24 18:58:12.684596
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00695	Per Sample Data Time 0.00134	Per Sample DNN Time 0.00561	Train Loss 0.0423	
start validation
acc: 0.741784
AUC: 0.907221
Avg Precision: 0.479288
Avg Recall: 1.000000
d_prime: 1.872181
train_loss: 0.043753
valid_loss: 1.332591
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00010980628555098379
Epoch-26 lr: 0.00010980628555098379
epoch 26 training time: 15.674
---------------
2023-09-24 18:58:28.357860
current #epochs=27, #steps=1014
start validation
acc: 0.769953
AUC: 0.907288
Avg Precision: 0.479437
Avg Recall: 1.000000
d_prime: 1.872754
train_loss: 0.040314
valid_loss: 1.333953
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00010980628555098379
Epoch-27 lr: 0.00010980628555098379
epoch 27 training time: 17.617
---------------
2023-09-24 18:58:45.975140
current #epochs=28, #steps=1053
start validation
acc: 0.765258
AUC: 0.907514
Avg Precision: 0.477390
Avg Recall: 1.000000
d_prime: 1.874685
train_loss: 0.045029
valid_loss: 1.331326
validation finished
normal learning rate scheduler step
Epoch-28 lr: 8.477043777582215e-05
Epoch-28 lr: 8.477043777582215e-05
epoch 28 training time: 15.216
---------------
2023-09-24 18:59:01.191371
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00948	Per Sample Data Time 0.00368	Per Sample DNN Time 0.00580	Train Loss 0.0444	
start validation
acc: 0.755869
AUC: 0.906147
Avg Precision: 0.477372
Avg Recall: 1.000000
d_prime: 1.863077
train_loss: 0.042653
valid_loss: 1.332487
validation finished
normal learning rate scheduler step
Epoch-29 lr: 8.477043777582215e-05
Epoch-29 lr: 8.477043777582215e-05
epoch 29 training time: 15.161
---------------
2023-09-24 18:59:16.352243
current #epochs=30, #steps=1131
start validation
acc: 0.751174
AUC: 0.904856
Avg Precision: 0.476454
Avg Recall: 1.000000
d_prime: 1.852235
train_loss: 0.055039
valid_loss: 1.332967
validation finished
normal learning rate scheduler step
Epoch-30 lr: 8.477043777582215e-05
Epoch-30 lr: 8.477043777582215e-05
epoch 30 training time: 15.111
---------------
2023-09-24 18:59:31.462778
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00673	Per Sample Data Time 0.00115	Per Sample DNN Time 0.00557	Train Loss 0.0444	
start validation
acc: 0.751174
AUC: 0.904291
Avg Precision: 0.476335
Avg Recall: 1.000000
d_prime: 1.847521
train_loss: 0.047456
valid_loss: 1.331677
validation finished
normal learning rate scheduler step
Epoch-31 lr: 6.544276663805382e-05
Epoch-31 lr: 6.544276663805382e-05
epoch 31 training time: 15.204
---------------
2023-09-24 18:59:46.667198
current #epochs=32, #steps=1209
start validation
acc: 0.751174
AUC: 0.903708
Avg Precision: 0.476219
Avg Recall: 1.000000
d_prime: 1.842685
train_loss: 0.046529
valid_loss: 1.333391
validation finished
normal learning rate scheduler step
Epoch-32 lr: 6.544276663805382e-05
Epoch-32 lr: 6.544276663805382e-05
epoch 32 training time: 15.206
---------------
2023-09-24 19:00:01.873122
current #epochs=33, #steps=1248
start validation
acc: 0.746479
AUC: 0.904700
Avg Precision: 0.477922
Avg Recall: 1.000000
d_prime: 1.850930
train_loss: 0.063464
valid_loss: 1.335177
validation finished
normal learning rate scheduler step
Epoch-33 lr: 6.544276663805382e-05
Epoch-33 lr: 6.544276663805382e-05
epoch 33 training time: 15.348
---------------
2023-09-24 19:00:17.221131
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00807	Per Sample Data Time 0.00238	Per Sample DNN Time 0.00569	Train Loss 0.0686	
start validation
acc: 0.741784
AUC: 0.905448
Avg Precision: 0.477306
Avg Recall: 1.000000
d_prime: 1.857191
train_loss: 0.051656
valid_loss: 1.336999
validation finished
normal learning rate scheduler step
Epoch-34 lr: 5.052180710177103e-05
Epoch-34 lr: 5.052180710177103e-05
epoch 34 training time: 15.262
---------------
2023-09-24 19:00:32.482839
current #epochs=35, #steps=1326
start validation
acc: 0.746479
AUC: 0.905363
Avg Precision: 0.475933
Avg Recall: 1.000000
d_prime: 1.856482
train_loss: 0.060704
valid_loss: 1.338920
validation finished
normal learning rate scheduler step
Epoch-35 lr: 5.052180710177103e-05
Epoch-35 lr: 5.052180710177103e-05
epoch 35 training time: 15.123
---------------
2023-09-24 19:00:47.605871
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00659	Per Sample Data Time 0.00097	Per Sample DNN Time 0.00561	Train Loss 0.0405	
start validation
acc: 0.746479
AUC: 0.904748
Avg Precision: 0.476329
Avg Recall: 1.000000
d_prime: 1.851334
train_loss: 0.041107
valid_loss: 1.339084
validation finished
normal learning rate scheduler step
Epoch-36 lr: 5.052180710177103e-05
Epoch-36 lr: 5.052180710177103e-05
epoch 36 training time: 16.981
---------------
2023-09-24 19:01:04.587278
current #epochs=37, #steps=1404
start validation
acc: 0.746479
AUC: 0.904911
Avg Precision: 0.475957
Avg Recall: 1.000000
d_prime: 1.852697
train_loss: 0.049324
valid_loss: 1.339262
validation finished
normal learning rate scheduler step
Epoch-37 lr: 3.900282833312177e-05
Epoch-37 lr: 3.900282833312177e-05
epoch 37 training time: 15.364
---------------
2023-09-24 19:01:19.952052
current #epochs=38, #steps=1443
start validation
acc: 0.741784
AUC: 0.904971
Avg Precision: 0.476401
Avg Recall: 1.000000
d_prime: 1.853198
train_loss: 0.056499
valid_loss: 1.338761
validation finished
normal learning rate scheduler step
Epoch-38 lr: 3.900282833312177e-05
Epoch-38 lr: 3.900282833312177e-05
epoch 38 training time: 15.038
---------------
2023-09-24 19:01:34.990130
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00729	Per Sample Data Time 0.00175	Per Sample DNN Time 0.00553	Train Loss 0.0436	
start validation
acc: 0.746479
AUC: 0.905486
Avg Precision: 0.476796
Avg Recall: 1.000000
d_prime: 1.857511
train_loss: 0.044953
valid_loss: 1.338807
validation finished
normal learning rate scheduler step
Epoch-39 lr: 3.900282833312177e-05
Epoch-39 lr: 3.900282833312177e-05
epoch 39 training time: 15.159
---------------
2023-09-24 19:01:50.149270
current #epochs=40, #steps=1521
start validation
acc: 0.741784
AUC: 0.905247
Avg Precision: 0.484115
Avg Recall: 1.000000
d_prime: 1.855506
train_loss: 0.065664
valid_loss: 1.340259
validation finished
normal learning rate scheduler step
Epoch-40 lr: 3.011017826259901e-05
Epoch-40 lr: 3.011017826259901e-05
epoch 40 training time: 15.319
---------------
2023-09-24 19:02:05.468039
current #epochs=41, #steps=1560
start validation
acc: 0.741784
AUC: 0.905588
Avg Precision: 0.484384
Avg Recall: 1.000000
d_prime: 1.858373
train_loss: 0.044718
valid_loss: 1.340006
validation finished
normal learning rate scheduler step
Epoch-41 lr: 3.011017826259901e-05
Epoch-41 lr: 3.011017826259901e-05
epoch 41 training time: 15.350
---------------
2023-09-24 19:02:20.818236
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02153	Per Sample Data Time 0.01510	Per Sample DNN Time 0.00643	Train Loss 0.0628	
start validation
[I 2023-09-24 19:02:36,096] Trial 57 finished with value: 0.484556651419859 and parameters: {'warmup': 'True', 'num_epochs': 42, 'batch_size': 47, 'lr-adaptschedule': 'True', 'lr': 0.0008703409130307395, 'head-lr': 1, 'lr-scheduler-start': 4, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.7719998664053039}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.751174
AUC: 0.905636
Avg Precision: 0.484557
Avg Recall: 1.000000
d_prime: 1.858778
train_loss: 0.050581
valid_loss: 1.338648
validation finished
normal learning rate scheduler step
Epoch-42 lr: 3.011017826259901e-05
Epoch-42 lr: 3.011017826259901e-05
epoch 42 training time: 15.267
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa63ceb0d90>
The learning rate scheduler starts at 6 epoch with decay rate of 0.753 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 19:02:36.131850
current #epochs=1, #steps=0
start validation
acc: 0.769953
AUC: 0.903957
Avg Precision: 0.476436
Avg Recall: 1.000000
d_prime: 1.844748
train_loss: 0.061776
valid_loss: 1.340370
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.00021063374140299716
Epoch-1 lr: 0.0004212674828059943
epoch 1 training time: 17.610
---------------
2023-09-24 19:02:53.742220
current #epochs=2, #steps=39
start validation
acc: 0.737089
AUC: 0.898961
Avg Precision: 0.471849
Avg Recall: 1.000000
d_prime: 1.804047
train_loss: 0.050798
valid_loss: 1.342322
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.00021063374140299716
Epoch-2 lr: 0.0004212674828059943
epoch 2 training time: 15.211
---------------
2023-09-24 19:03:08.953596
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00567	Train Loss 0.0561	
start validation
acc: 0.755869
AUC: 0.898737
Avg Precision: 0.471451
Avg Recall: 1.000000
d_prime: 1.802258
train_loss: 0.044805
valid_loss: 1.340392
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.00021063374140299716
Epoch-3 lr: 0.0004212674828059943
epoch 3 training time: 15.222
---------------
2023-09-24 19:03:24.175756
current #epochs=4, #steps=117
start validation
acc: 0.760563
AUC: 0.902401
Avg Precision: 0.479620
Avg Recall: 1.000000
d_prime: 1.831907
train_loss: 0.048319
valid_loss: 1.335728
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00021063374140299716
Epoch-4 lr: 0.0004212674828059943
epoch 4 training time: 16.142
---------------
2023-09-24 19:03:40.317314
current #epochs=5, #steps=156
start validation
acc: 0.755869
AUC: 0.904386
Avg Precision: 0.479052
Avg Recall: 1.000000
d_prime: 1.848317
train_loss: 0.045456
valid_loss: 1.334594
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00021063374140299716
Epoch-5 lr: 0.0004212674828059943
epoch 5 training time: 15.023
---------------
2023-09-24 19:03:55.340028
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01120	Per Sample Data Time 0.00512	Per Sample DNN Time 0.00608	Train Loss 0.0464	
start validation
acc: 0.746479
AUC: 0.901556
Avg Precision: 0.474384
Avg Recall: 1.000000
d_prime: 1.824997
train_loss: 0.059729
valid_loss: 1.340649
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00015866293435199658
Epoch-6 lr: 0.00031732586870399315
epoch 6 training time: 15.160
---------------
2023-09-24 19:04:10.500354
current #epochs=7, #steps=234
start validation
acc: 0.741784
AUC: 0.899633
Avg Precision: 0.471806
Avg Recall: 1.000000
d_prime: 1.809436
train_loss: 0.057242
valid_loss: 1.341442
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00011951516679856958
Epoch-7 lr: 0.00023903033359713916
epoch 7 training time: 15.243
---------------
2023-09-24 19:04:25.743385
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00686	Per Sample Data Time 0.00128	Per Sample DNN Time 0.00557	Train Loss 0.0543	
start validation
acc: 0.737089
AUC: 0.897550
Avg Precision: 0.474337
Avg Recall: 1.000000
d_prime: 1.792816
train_loss: 0.059364
valid_loss: 1.344977
validation finished
normal learning rate scheduler step
Epoch-8 lr: 9.002654056051223e-05
Epoch-8 lr: 0.00018005308112102445
epoch 8 training time: 15.347
---------------
2023-09-24 19:04:41.090823
current #epochs=9, #steps=312
start validation
acc: 0.741784
AUC: 0.897774
Avg Precision: 0.477095
Avg Recall: 1.000000
d_prime: 1.794597
train_loss: 0.061432
valid_loss: 1.344116
validation finished
normal learning rate scheduler step
Epoch-9 lr: 6.781380323849037e-05
Epoch-9 lr: 0.00013562760647698073
epoch 9 training time: 15.243
---------------
2023-09-24 19:04:56.333303
current #epochs=10, #steps=351
start validation
acc: 0.779343
AUC: 0.901441
Avg Precision: 0.472167
Avg Recall: 1.000000
d_prime: 1.824061
train_loss: 0.066602
valid_loss: 1.338233
validation finished
normal learning rate scheduler step
Epoch-10 lr: 5.108173524203806e-05
Epoch-10 lr: 0.00010216347048407611
epoch 10 training time: 17.587
---------------
2023-09-24 19:05:13.920492
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00871	Per Sample Data Time 0.00289	Per Sample DNN Time 0.00583	Train Loss 0.0612	
start validation
acc: 0.769953
AUC: 0.901261
Avg Precision: 0.470868
Avg Recall: 1.000000
d_prime: 1.822595
train_loss: 0.051312
valid_loss: 1.338355
validation finished
normal learning rate scheduler step
Epoch-11 lr: 3.847806126078825e-05
Epoch-11 lr: 7.69561225215765e-05
epoch 11 training time: 15.177
---------------
2023-09-24 19:05:29.097632
current #epochs=12, #steps=429
start validation
acc: 0.779343
AUC: 0.902345
Avg Precision: 0.471131
Avg Recall: 1.000000
d_prime: 1.831445
train_loss: 0.062525
valid_loss: 1.335360
validation finished
normal learning rate scheduler step
Epoch-12 lr: 2.898416021643947e-05
Epoch-12 lr: 5.796832043287894e-05
epoch 12 training time: 15.226
---------------
2023-09-24 19:05:44.323201
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00660	Per Sample Data Time 0.00104	Per Sample DNN Time 0.00555	Train Loss 0.0533	
start validation
acc: 0.779343
AUC: 0.902357
Avg Precision: 0.472012
Avg Recall: 1.000000
d_prime: 1.831545
train_loss: 0.050152
valid_loss: 1.335016
validation finished
normal learning rate scheduler step
Epoch-13 lr: 2.183274094187101e-05
Epoch-13 lr: 4.366548188374202e-05
epoch 13 training time: 15.231
---------------
2023-09-24 19:05:59.554646
current #epochs=14, #steps=507
start validation
acc: 0.769953
AUC: 0.902342
Avg Precision: 0.471995
Avg Recall: 1.000000
d_prime: 1.831426
train_loss: 0.054124
valid_loss: 1.336083
validation finished
normal learning rate scheduler step
Epoch-14 lr: 1.644583018708577e-05
Epoch-14 lr: 3.289166037417154e-05
epoch 14 training time: 15.133
---------------
2023-09-24 19:06:14.686923
current #epochs=15, #steps=546
start validation
acc: 0.765258
AUC: 0.902236
Avg Precision: 0.471927
Avg Recall: 1.000000
d_prime: 1.830552
train_loss: 0.039576
valid_loss: 1.336625
validation finished
normal learning rate scheduler step
Epoch-15 lr: 1.2388061181258323e-05
Epoch-15 lr: 2.4776122362516645e-05
epoch 15 training time: 15.225
---------------
2023-09-24 19:06:29.912281
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00774	Per Sample Data Time 0.00204	Per Sample DNN Time 0.00569	Train Loss 0.0562	
start validation
acc: 0.765258
AUC: 0.902340
Avg Precision: 0.472480
Avg Recall: 1.000000
d_prime: 1.831407
train_loss: 0.041982
valid_loss: 1.337114
validation finished
normal learning rate scheduler step
Epoch-16 lr: 9.331487561577059e-06
Epoch-16 lr: 1.8662975123154117e-05
epoch 16 training time: 16.539
---------------
2023-09-24 19:06:46.450836
current #epochs=17, #steps=624
start validation
acc: 0.765258
AUC: 0.902156
Avg Precision: 0.472480
Avg Recall: 1.000000
d_prime: 1.829902
train_loss: 0.038522
valid_loss: 1.337309
validation finished
normal learning rate scheduler step
Epoch-17 lr: 7.029078952532466e-06
Epoch-17 lr: 1.4058157905064932e-05
epoch 17 training time: 16.124
---------------
2023-09-24 19:07:02.574755
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00647	Per Sample Data Time 0.00095	Per Sample DNN Time 0.00552	Train Loss 0.0536	
start validation
acc: 0.765258
AUC: 0.902225
Avg Precision: 0.472873
Avg Recall: 1.000000
d_prime: 1.830466
train_loss: 0.052216
valid_loss: 1.337371
validation finished
normal learning rate scheduler step
Epoch-18 lr: 5.294756124883562e-06
Epoch-18 lr: 1.0589512249767125e-05
epoch 18 training time: 15.162
---------------
2023-09-24 19:07:17.736849
current #epochs=19, #steps=702
start validation
acc: 0.765258
AUC: 0.902202
Avg Precision: 0.472873
Avg Recall: 1.000000
d_prime: 1.830274
train_loss: 0.049226
valid_loss: 1.337380
validation finished
normal learning rate scheduler step
Epoch-19 lr: 3.988352188289425e-06
Epoch-19 lr: 7.97670437657885e-06
epoch 19 training time: 15.206
---------------
2023-09-24 19:07:32.942791
current #epochs=20, #steps=741
start validation
acc: 0.765258
AUC: 0.902162
Avg Precision: 0.472873
Avg Recall: 1.000000
d_prime: 1.829953
train_loss: 0.053807
valid_loss: 1.337268
validation finished
normal learning rate scheduler step
Epoch-20 lr: 3.00428439056442e-06
Epoch-20 lr: 6.00856878112884e-06
epoch 20 training time: 15.304
---------------
2023-09-24 19:07:48.246698
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00159	Per Sample DNN Time 0.00559	Train Loss 0.0554	
start validation
acc: 0.760563
AUC: 0.902075
Avg Precision: 0.472873
Avg Recall: 1.000000
d_prime: 1.829240
train_loss: 0.052240
valid_loss: 1.337553
validation finished
normal learning rate scheduler step
Epoch-21 lr: 2.2630209854311025e-06
Epoch-21 lr: 4.526041970862205e-06
epoch 21 training time: 17.049
---------------
2023-09-24 19:08:05.295617
current #epochs=22, #steps=819
start validation
acc: 0.760563
AUC: 0.902068
Avg Precision: 0.472873
Avg Recall: 1.000000
d_prime: 1.829179
train_loss: 0.058493
valid_loss: 1.337601
validation finished
normal learning rate scheduler step
Epoch-22 lr: 1.7046535263392351e-06
Epoch-22 lr: 3.4093070526784703e-06
epoch 22 training time: 15.160
---------------
2023-09-24 19:08:20.455078
current #epochs=23, #steps=858
start validation
acc: 0.765258
AUC: 0.902047
Avg Precision: 0.472873
Avg Recall: 1.000000
d_prime: 1.829004
train_loss: 0.049608
valid_loss: 1.337591
validation finished
normal learning rate scheduler step
Epoch-23 lr: 1.2840551031422405e-06
Epoch-23 lr: 2.568110206284481e-06
epoch 23 training time: 16.333
---------------
2023-09-24 19:08:36.788322
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01424	Per Sample Data Time 0.00807	Per Sample DNN Time 0.00617	Train Loss 0.0582	
start validation
acc: 0.765258
AUC: 0.902005
Avg Precision: 0.472873
Avg Recall: 1.000000
d_prime: 1.828661
train_loss: 0.051086
valid_loss: 1.337568
validation finished
normal learning rate scheduler step
Epoch-24 lr: 9.67233213335993e-07
Epoch-24 lr: 1.934466426671986e-06
epoch 24 training time: 15.129
---------------
2023-09-24 19:08:51.917818
current #epochs=25, #steps=936
start validation
acc: 0.765258
AUC: 0.901986
Avg Precision: 0.472873
Avg Recall: 1.000000
d_prime: 1.828509
train_loss: 0.048650
valid_loss: 1.337541
validation finished
normal learning rate scheduler step
Epoch-25 lr: 7.285825091858511e-07
Epoch-25 lr: 1.4571650183717021e-06
epoch 25 training time: 15.187
---------------
2023-09-24 19:09:07.104255
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00692	Per Sample Data Time 0.00131	Per Sample DNN Time 0.00561	Train Loss 0.0545	
start validation
acc: 0.765258
AUC: 0.901971
Avg Precision: 0.472873
Avg Recall: 1.000000
d_prime: 1.828387
train_loss: 0.051910
valid_loss: 1.337567
validation finished
normal learning rate scheduler step
Epoch-26 lr: 5.488153894764495e-07
Epoch-26 lr: 1.097630778952899e-06
epoch 26 training time: 15.286
---------------
2023-09-24 19:09:22.390149
current #epochs=27, #steps=1014
start validation
acc: 0.765258
AUC: 0.901949
Avg Precision: 0.472873
Avg Recall: 1.000000
d_prime: 1.828204
train_loss: 0.051554
valid_loss: 1.337570
validation finished
normal learning rate scheduler step
Epoch-27 lr: 4.134031875988332e-07
Epoch-27 lr: 8.268063751976664e-07
epoch 27 training time: 15.600
---------------
2023-09-24 19:09:37.990219
current #epochs=28, #steps=1053
start validation
acc: 0.765258
AUC: 0.901941
Avg Precision: 0.472873
Avg Recall: 1.000000
d_prime: 1.828143
train_loss: 0.050121
valid_loss: 1.337554
validation finished
normal learning rate scheduler step
Epoch-28 lr: 3.1140197376737326e-07
Epoch-28 lr: 6.228039475347465e-07
epoch 28 training time: 16.000
---------------
2023-09-24 19:09:53.989723
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00934	Per Sample Data Time 0.00344	Per Sample DNN Time 0.00590	Train Loss 0.0776	
start validation
acc: 0.765258
AUC: 0.901941
Avg Precision: 0.472873
Avg Recall: 1.000000
d_prime: 1.828143
train_loss: 0.057003
valid_loss: 1.337572
validation finished
normal learning rate scheduler step
Epoch-29 lr: 2.3456807343323328e-07
Epoch-29 lr: 4.6913614686646656e-07
epoch 29 training time: 16.094
---------------
2023-09-24 19:10:10.084182
current #epochs=30, #steps=1131
start validation
acc: 0.765258
AUC: 0.901956
Avg Precision: 0.472873
Avg Recall: 1.000000
d_prime: 1.828265
train_loss: 0.040023
valid_loss: 1.337574
validation finished
normal learning rate scheduler step
Epoch-30 lr: 1.7669181864364793e-07
Epoch-30 lr: 3.5338363728729586e-07
epoch 30 training time: 15.050
---------------
2023-09-24 19:10:25.134627
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00673	Per Sample Data Time 0.00114	Per Sample DNN Time 0.00560	Train Loss 0.0396	
start validation
acc: 0.765258
AUC: 0.901941
Avg Precision: 0.472873
Avg Recall: 1.000000
d_prime: 1.828143
train_loss: 0.038283
valid_loss: 1.337572
validation finished
normal learning rate scheduler step
Epoch-31 lr: 1.3309568654698496e-07
Epoch-31 lr: 2.661913730939699e-07
epoch 31 training time: 15.372
---------------
2023-09-24 19:10:40.506230
current #epochs=32, #steps=1209
start validation
acc: 0.765258
AUC: 0.901941
Avg Precision: 0.472873
Avg Recall: 1.000000
d_prime: 1.828143
train_loss: 0.052305
valid_loss: 1.337571
validation finished
normal learning rate scheduler step
Epoch-32 lr: 1.0025626491026052e-07
Epoch-32 lr: 2.0051252982052103e-07
epoch 32 training time: 17.114
---------------
2023-09-24 19:10:57.620559
current #epochs=33, #steps=1248
start validation
acc: 0.765258
AUC: 0.901941
Avg Precision: 0.472873
Avg Recall: 1.000000
d_prime: 1.828143
train_loss: 0.070542
valid_loss: 1.337574
validation finished
normal learning rate scheduler step
Epoch-33 lr: 7.551949213777152e-08
Epoch-33 lr: 1.5103898427554305e-07
epoch 33 training time: 15.293
---------------
2023-09-24 19:11:12.913554
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00793	Per Sample Data Time 0.00225	Per Sample DNN Time 0.00568	Train Loss 0.0509	
start validation
acc: 0.765258
AUC: 0.901941
Avg Precision: 0.472873
Avg Recall: 1.000000
d_prime: 1.828143
train_loss: 0.056871
valid_loss: 1.337577
validation finished
normal learning rate scheduler step
Epoch-34 lr: 5.688615766657445e-08
Epoch-34 lr: 1.137723153331489e-07
epoch 34 training time: 16.633
---------------
2023-09-24 19:11:29.546151
current #epochs=35, #steps=1326
start validation
acc: 0.765258
AUC: 0.901941
Avg Precision: 0.472873
Avg Recall: 1.000000
d_prime: 1.828143
train_loss: 0.055421
valid_loss: 1.337578
validation finished
normal learning rate scheduler step
Epoch-35 lr: 4.2850327014419166e-08
Epoch-35 lr: 8.570065402883833e-08
epoch 35 training time: 15.254
---------------
2023-09-24 19:11:44.800310
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00646	Per Sample Data Time 0.00097	Per Sample DNN Time 0.00549	Train Loss 0.0407	
start validation
acc: 0.765258
AUC: 0.901941
Avg Precision: 0.472873
Avg Recall: 1.000000
d_prime: 1.828143
train_loss: 0.038302
valid_loss: 1.337578
validation finished
normal learning rate scheduler step
Epoch-36 lr: 3.2277633093183205e-08
Epoch-36 lr: 6.455526618636641e-08
epoch 36 training time: 15.084
---------------
2023-09-24 19:11:59.884530
current #epochs=37, #steps=1404
start validation
acc: 0.765258
AUC: 0.901949
Avg Precision: 0.472873
Avg Recall: 1.000000
d_prime: 1.828204
train_loss: 0.057412
valid_loss: 1.337577
validation finished
normal learning rate scheduler step
Epoch-37 lr: 2.431359736759007e-08
Epoch-37 lr: 4.862719473518014e-08
epoch 37 training time: 15.358
---------------
2023-09-24 19:12:15.242431
current #epochs=38, #steps=1443
start validation
acc: 0.765258
AUC: 0.901941
Avg Precision: 0.472873
Avg Recall: 1.000000
d_prime: 1.828143
train_loss: 0.047105
valid_loss: 1.337578
validation finished
normal learning rate scheduler step
Epoch-38 lr: 1.8314571432380817e-08
Epoch-38 lr: 3.6629142864761634e-08
epoch 38 training time: 15.723
---------------
2023-09-24 19:12:30.965321
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00738	Per Sample Data Time 0.00171	Per Sample DNN Time 0.00567	Train Loss 0.0607	
start validation
acc: 0.765258
AUC: 0.901956
Avg Precision: 0.472873
Avg Recall: 1.000000
d_prime: 1.828265
train_loss: 0.067171
valid_loss: 1.337578
validation finished
normal learning rate scheduler step
Epoch-39 lr: 1.3795717749233513e-08
Epoch-39 lr: 2.7591435498467026e-08
epoch 39 training time: 15.227
---------------
2023-09-24 19:12:46.192136
current #epochs=40, #steps=1521
start validation
[I 2023-09-24 19:13:01,392] Trial 58 finished with value: 0.4728733776141107 and parameters: {'warmup': 'True', 'num_epochs': 40, 'batch_size': 42, 'lr-adaptschedule': 'True', 'lr': 0.00021063374140299716, 'head-lr': 2, 'lr-scheduler-start': 6, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7532645686069503}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.765258
AUC: 0.901956
Avg Precision: 0.472873
Avg Recall: 1.000000
d_prime: 1.828265
train_loss: 0.053334
valid_loss: 1.337578
validation finished
normal learning rate scheduler step
Epoch-40 lr: 1.039182537899963e-08
Epoch-40 lr: 2.078365075799926e-08
epoch 40 training time: 15.188
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f5836d0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.741 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 19:13:01.432776
current #epochs=1, #steps=0
start validation
acc: 0.741784
AUC: 0.895371
Avg Precision: 0.464873
Avg Recall: 1.000000
d_prime: 1.775697
train_loss: 0.065339
valid_loss: 1.350921
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.00040962555200813375
Epoch-1 lr: 0.0008192511040162675
epoch 1 training time: 17.818
---------------
2023-09-24 19:13:19.251368
current #epochs=2, #steps=39
start validation
acc: 0.760563
AUC: 0.896781
Avg Precision: 0.479850
Avg Recall: 1.000000
d_prime: 1.786743
train_loss: 0.042249
valid_loss: 1.344778
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.00040962555200813375
Epoch-2 lr: 0.0008192511040162675
epoch 2 training time: 17.662
---------------
2023-09-24 19:13:36.913533
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00561	Train Loss 0.0467	
start validation
acc: 0.732394
AUC: 0.903603
Avg Precision: 0.483136
Avg Recall: 1.000000
d_prime: 1.841814
train_loss: 0.055836
valid_loss: 1.348875
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.00040962555200813375
Epoch-3 lr: 0.0008192511040162675
epoch 3 training time: 15.076
---------------
2023-09-24 19:13:51.990186
current #epochs=4, #steps=117
start validation
acc: 0.732394
AUC: 0.901666
Avg Precision: 0.465465
Avg Recall: 1.000000
d_prime: 1.825899
train_loss: 0.061958
valid_loss: 1.351326
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00040962555200813375
Epoch-4 lr: 0.0008192511040162675
epoch 4 training time: 17.556
---------------
2023-09-24 19:14:09.546081
current #epochs=5, #steps=156
start validation
acc: 0.737089
AUC: 0.900527
Avg Precision: 0.484005
Avg Recall: 1.000000
d_prime: 1.816641
train_loss: 0.063289
valid_loss: 1.338947
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00040962555200813375
Epoch-5 lr: 0.0008192511040162675
epoch 5 training time: 16.472
---------------
2023-09-24 19:14:26.018162
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01147	Per Sample Data Time 0.00566	Per Sample DNN Time 0.00582	Train Loss 0.0570	
start validation
acc: 0.718310
AUC: 0.902981
Avg Precision: 0.494609
Avg Recall: 1.000000
d_prime: 1.836677
train_loss: 0.057765
valid_loss: 1.341849
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0003037113947757399
Epoch-6 lr: 0.0006074227895514798
epoch 6 training time: 15.552
---------------
2023-09-24 19:14:41.570437
current #epochs=7, #steps=234
start validation
acc: 0.737089
AUC: 0.905001
Avg Precision: 0.484613
Avg Recall: 1.000000
d_prime: 1.853444
train_loss: 0.047756
valid_loss: 1.332712
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0003037113947757399
Epoch-7 lr: 0.0006074227895514798
epoch 7 training time: 15.085
---------------
2023-09-24 19:14:56.655471
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00687	Per Sample Data Time 0.00124	Per Sample DNN Time 0.00563	Train Loss 0.0777	
start validation
acc: 0.746479
AUC: 0.900017
Avg Precision: 0.493820
Avg Recall: 1.000000
d_prime: 1.812521
train_loss: 0.069185
valid_loss: 1.338724
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00022518275743402293
Epoch-8 lr: 0.00045036551486804586
epoch 8 training time: 16.979
---------------
2023-09-24 19:15:13.634088
current #epochs=9, #steps=312
start validation
acc: 0.732394
AUC: 0.907243
Avg Precision: 0.496510
Avg Recall: 1.000000
d_prime: 1.872368
train_loss: 0.044561
valid_loss: 1.325680
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00022518275743402293
Epoch-9 lr: 0.00045036551486804586
epoch 9 training time: 15.230
---------------
2023-09-24 19:15:28.864596
current #epochs=10, #steps=351
start validation
acc: 0.727700
AUC: 0.909242
Avg Precision: 0.496218
Avg Recall: 1.000000
d_prime: 1.889533
train_loss: 0.072359
valid_loss: 1.329334
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00016695874806749414
Epoch-10 lr: 0.00033391749613498827
epoch 10 training time: 15.706
---------------
2023-09-24 19:15:44.570940
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00855	Per Sample Data Time 0.00282	Per Sample DNN Time 0.00573	Train Loss 0.0625	
start validation
acc: 0.737089
AUC: 0.911618
Avg Precision: 0.495339
Avg Recall: 1.000000
d_prime: 1.910298
train_loss: 0.049248
valid_loss: 1.323516
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00016695874806749414
Epoch-11 lr: 0.00033391749613498827
epoch 11 training time: 16.887
---------------
2023-09-24 19:16:01.458101
current #epochs=12, #steps=429
start validation
acc: 0.732394
AUC: 0.910656
Avg Precision: 0.498875
Avg Recall: 1.000000
d_prime: 1.901841
train_loss: 0.059085
valid_loss: 1.330251
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00012378933393438098
Epoch-12 lr: 0.00024757866786876196
epoch 12 training time: 16.747
---------------
2023-09-24 19:16:18.205057
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00667	Per Sample Data Time 0.00105	Per Sample DNN Time 0.00561	Train Loss 0.0586	
start validation
acc: 0.737089
AUC: 0.910981
Avg Precision: 0.505044
Avg Recall: 1.000000
d_prime: 1.904689
train_loss: 0.056245
valid_loss: 1.329093
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00012378933393438098
Epoch-13 lr: 0.00024757866786876196
epoch 13 training time: 15.755
---------------
2023-09-24 19:16:33.960469
current #epochs=14, #steps=507
start validation
acc: 0.746479
AUC: 0.909952
Avg Precision: 0.500598
Avg Recall: 1.000000
d_prime: 1.895695
train_loss: 0.048580
valid_loss: 1.331451
validation finished
normal learning rate scheduler step
Epoch-14 lr: 9.178194837519352e-05
Epoch-14 lr: 0.00018356389675038703
epoch 14 training time: 15.178
---------------
2023-09-24 19:16:49.138468
current #epochs=15, #steps=546
start validation
acc: 0.727700
AUC: 0.909210
Avg Precision: 0.499870
Avg Recall: 1.000000
d_prime: 1.889253
train_loss: 0.047490
valid_loss: 1.333291
validation finished
normal learning rate scheduler step
Epoch-15 lr: 9.178194837519352e-05
Epoch-15 lr: 0.00018356389675038703
epoch 15 training time: 15.054
---------------
2023-09-24 19:17:04.192796
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00779	Per Sample Data Time 0.00200	Per Sample DNN Time 0.00578	Train Loss 0.0689	
start validation
acc: 0.746479
AUC: 0.909881
Avg Precision: 0.497340
Avg Recall: 1.000000
d_prime: 1.895078
train_loss: 0.058622
valid_loss: 1.333962
validation finished
normal learning rate scheduler step
Epoch-16 lr: 6.805049982748994e-05
Epoch-16 lr: 0.0001361009996549799
epoch 16 training time: 15.849
---------------
2023-09-24 19:17:20.042157
current #epochs=17, #steps=624
start validation
acc: 0.746479
AUC: 0.909641
Avg Precision: 0.497624
Avg Recall: 1.000000
d_prime: 1.892994
train_loss: 0.055367
valid_loss: 1.334139
validation finished
normal learning rate scheduler step
Epoch-17 lr: 6.805049982748994e-05
Epoch-17 lr: 0.0001361009996549799
epoch 17 training time: 15.088
---------------
2023-09-24 19:17:35.130236
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00650	Per Sample Data Time 0.00102	Per Sample DNN Time 0.00548	Train Loss 0.0554	
start validation
acc: 0.732394
AUC: 0.909011
Avg Precision: 0.497708
Avg Recall: 1.000000
d_prime: 1.887534
train_loss: 0.055896
valid_loss: 1.333701
validation finished
normal learning rate scheduler step
Epoch-18 lr: 5.045513424754037e-05
Epoch-18 lr: 0.00010091026849508074
epoch 18 training time: 15.222
---------------
2023-09-24 19:17:50.352401
current #epochs=19, #steps=702
start validation
acc: 0.737089
AUC: 0.910110
Avg Precision: 0.498098
Avg Recall: 1.000000
d_prime: 1.897068
train_loss: 0.051147
valid_loss: 1.330456
validation finished
normal learning rate scheduler step
Epoch-19 lr: 5.045513424754037e-05
Epoch-19 lr: 0.00010091026849508074
epoch 19 training time: 15.291
---------------
2023-09-24 19:18:05.642860
current #epochs=20, #steps=741
start validation
acc: 0.746479
AUC: 0.910719
Avg Precision: 0.498498
Avg Recall: 1.000000
d_prime: 1.902393
train_loss: 0.048317
valid_loss: 1.332793
validation finished
normal learning rate scheduler step
Epoch-20 lr: 3.740928543347659e-05
Epoch-20 lr: 7.481857086695318e-05
epoch 20 training time: 15.492
---------------
2023-09-24 19:18:21.134703
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00159	Per Sample DNN Time 0.00560	Train Loss 0.0403	
start validation
acc: 0.741784
AUC: 0.909724
Avg Precision: 0.499598
Avg Recall: 1.000000
d_prime: 1.893713
train_loss: 0.041467
valid_loss: 1.333640
validation finished
normal learning rate scheduler step
Epoch-21 lr: 3.740928543347659e-05
Epoch-21 lr: 7.481857086695318e-05
epoch 21 training time: 15.185
---------------
2023-09-24 19:18:36.319175
current #epochs=22, #steps=819
start validation
acc: 0.746479
AUC: 0.909462
Avg Precision: 0.499056
Avg Recall: 1.000000
d_prime: 1.891435
train_loss: 0.053430
valid_loss: 1.332847
validation finished
normal learning rate scheduler step
Epoch-22 lr: 2.773661506433403e-05
Epoch-22 lr: 5.547323012866806e-05
epoch 22 training time: 15.107
---------------
2023-09-24 19:18:51.425999
current #epochs=23, #steps=858
start validation
acc: 0.746479
AUC: 0.909195
Avg Precision: 0.499183
Avg Recall: 1.000000
d_prime: 1.889127
train_loss: 0.051982
valid_loss: 1.332577
validation finished
normal learning rate scheduler step
Epoch-23 lr: 2.773661506433403e-05
Epoch-23 lr: 5.547323012866806e-05
epoch 23 training time: 15.123
---------------
2023-09-24 19:19:06.549181
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01371	Per Sample Data Time 0.00759	Per Sample DNN Time 0.00612	Train Loss 0.0288	
start validation
acc: 0.737089
AUC: 0.908897
Avg Precision: 0.499319
Avg Recall: 1.000000
d_prime: 1.886551
train_loss: 0.051420
valid_loss: 1.334545
validation finished
normal learning rate scheduler step
Epoch-24 lr: 2.0564942802638973e-05
Epoch-24 lr: 4.1129885605277946e-05
epoch 24 training time: 15.021
---------------
2023-09-24 19:19:21.570637
current #epochs=25, #steps=936
start validation
acc: 0.737089
AUC: 0.909793
Avg Precision: 0.500585
Avg Recall: 1.000000
d_prime: 1.894310
train_loss: 0.046815
valid_loss: 1.333203
validation finished
normal learning rate scheduler step
Epoch-25 lr: 2.0564942802638973e-05
Epoch-25 lr: 4.1129885605277946e-05
epoch 25 training time: 15.238
---------------
2023-09-24 19:19:36.808273
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00695	Per Sample Data Time 0.00130	Per Sample DNN Time 0.00564	Train Loss 0.0690	
start validation
acc: 0.741784
AUC: 0.909907
Avg Precision: 0.501291
Avg Recall: 1.000000
d_prime: 1.895304
train_loss: 0.064282
valid_loss: 1.333429
validation finished
normal learning rate scheduler step
Epoch-26 lr: 1.524760218559016e-05
Epoch-26 lr: 3.049520437118032e-05
epoch 26 training time: 15.290
---------------
2023-09-24 19:19:52.097864
current #epochs=27, #steps=1014
start validation
acc: 0.746479
AUC: 0.909465
Avg Precision: 0.500877
Avg Recall: 1.000000
d_prime: 1.891462
train_loss: 0.047185
valid_loss: 1.333110
validation finished
normal learning rate scheduler step
Epoch-27 lr: 1.524760218559016e-05
Epoch-27 lr: 3.049520437118032e-05
epoch 27 training time: 15.077
---------------
2023-09-24 19:20:07.174462
current #epochs=28, #steps=1053
start validation
acc: 0.737089
AUC: 0.909032
Avg Precision: 0.500593
Avg Recall: 1.000000
d_prime: 1.887719
train_loss: 0.048442
valid_loss: 1.333800
validation finished
normal learning rate scheduler step
Epoch-28 lr: 1.1305131000908005e-05
Epoch-28 lr: 2.261026200181601e-05
epoch 28 training time: 15.171
---------------
2023-09-24 19:20:22.345965
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00941	Per Sample Data Time 0.00351	Per Sample DNN Time 0.00590	Train Loss 0.0358	
start validation
acc: 0.732394
AUC: 0.909075
Avg Precision: 0.500014
Avg Recall: 1.000000
d_prime: 1.888088
train_loss: 0.042536
valid_loss: 1.334128
validation finished
normal learning rate scheduler step
Epoch-29 lr: 1.1305131000908005e-05
Epoch-29 lr: 2.261026200181601e-05
epoch 29 training time: 15.166
---------------
2023-09-24 19:20:37.511790
current #epochs=30, #steps=1131
start validation
acc: 0.737089
AUC: 0.909290
Avg Precision: 0.500877
Avg Recall: 1.000000
d_prime: 1.889952
train_loss: 0.067139
valid_loss: 1.334547
validation finished
normal learning rate scheduler step
Epoch-30 lr: 8.38203839476315e-06
Epoch-30 lr: 1.67640767895263e-05
epoch 30 training time: 15.039
---------------
2023-09-24 19:20:52.550584
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00665	Per Sample Data Time 0.00109	Per Sample DNN Time 0.00557	Train Loss 0.0397	
start validation
acc: 0.737089
AUC: 0.909199
Avg Precision: 0.500166
Avg Recall: 1.000000
d_prime: 1.889162
train_loss: 0.041151
valid_loss: 1.334724
validation finished
normal learning rate scheduler step
Epoch-31 lr: 8.38203839476315e-06
Epoch-31 lr: 1.67640767895263e-05
epoch 31 training time: 15.096
---------------
2023-09-24 19:21:07.646302
current #epochs=32, #steps=1209
start validation
[I 2023-09-24 19:21:22,948] Trial 59 finished with value: 0.4998899044153744 and parameters: {'warmup': 'True', 'num_epochs': 32, 'batch_size': 38, 'lr-adaptschedule': 'True', 'lr': 0.00040962555200813375, 'head-lr': 2, 'lr-scheduler-start': 6, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.741436644483812}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.746479
AUC: 0.909079
Avg Precision: 0.499890
Avg Recall: 1.000000
d_prime: 1.888120
train_loss: 0.043962
valid_loss: 1.334497
validation finished
normal learning rate scheduler step
Epoch-32 lr: 6.214750421347668e-06
Epoch-32 lr: 1.2429500842695336e-05
epoch 32 training time: 15.288
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f500e50>
The learning rate scheduler starts at 6 epoch with decay rate of 0.718 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 19:21:22.985660
current #epochs=1, #steps=0
start validation
acc: 0.732394
AUC: 0.907786
Avg Precision: 0.512924
Avg Recall: 1.000000
d_prime: 1.877003
train_loss: 0.051368
valid_loss: 1.340135
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.00038335733539708323
Epoch-1 lr: 0.0007667146707941665
epoch 1 training time: 17.733
---------------
2023-09-24 19:21:40.718894
current #epochs=2, #steps=39
start validation
acc: 0.718310
AUC: 0.903114
Avg Precision: 0.505001
Avg Recall: 1.000000
d_prime: 1.837773
train_loss: 0.060717
valid_loss: 1.352944
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.00038335733539708323
Epoch-2 lr: 0.0007667146707941665
epoch 2 training time: 15.174
---------------
2023-09-24 19:21:55.892778
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00714	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00569	Train Loss 0.0706	
start validation
acc: 0.741784
AUC: 0.902431
Avg Precision: 0.505638
Avg Recall: 1.000000
d_prime: 1.832156
train_loss: 0.066487
valid_loss: 1.339384
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.00038335733539708323
Epoch-3 lr: 0.0007667146707941665
epoch 3 training time: 18.808
---------------
2023-09-24 19:22:14.700788
current #epochs=4, #steps=117
start validation
acc: 0.765258
AUC: 0.911827
Avg Precision: 0.501884
Avg Recall: 1.000000
d_prime: 1.912145
train_loss: 0.049331
valid_loss: 1.330151
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00038335733539708323
Epoch-4 lr: 0.0007667146707941665
epoch 4 training time: 17.618
---------------
2023-09-24 19:22:32.318539
current #epochs=5, #steps=156
start validation
acc: 0.765258
AUC: 0.908704
Avg Precision: 0.496491
Avg Recall: 1.000000
d_prime: 1.884885
train_loss: 0.064483
valid_loss: 1.322486
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00038335733539708323
Epoch-5 lr: 0.0007667146707941665
epoch 5 training time: 15.066
---------------
2023-09-24 19:22:47.384757
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01138	Per Sample Data Time 0.00522	Per Sample DNN Time 0.00616	Train Loss 0.0532	
start validation
acc: 0.741784
AUC: 0.913243
Avg Precision: 0.508492
Avg Recall: 1.000000
d_prime: 1.924740
train_loss: 0.048432
valid_loss: 1.313377
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0002751100640517176
Epoch-6 lr: 0.0005502201281034352
epoch 6 training time: 15.195
---------------
2023-09-24 19:23:02.580124
current #epochs=7, #steps=234
start validation
acc: 0.732394
AUC: 0.904008
Avg Precision: 0.495053
Avg Recall: 1.000000
d_prime: 1.845174
train_loss: 0.071799
valid_loss: 1.332465
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0002751100640517176
Epoch-7 lr: 0.0005502201281034352
epoch 7 training time: 15.159
---------------
2023-09-24 19:23:17.738832
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00676	Per Sample Data Time 0.00120	Per Sample DNN Time 0.00555	Train Loss 0.0563	
start validation
acc: 0.741784
AUC: 0.905946
Avg Precision: 0.496767
Avg Recall: 1.000000
d_prime: 1.861379
train_loss: 0.053731
valid_loss: 1.333544
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00019742819650012626
Epoch-8 lr: 0.00039485639300025253
epoch 8 training time: 15.098
---------------
2023-09-24 19:23:32.836880
current #epochs=9, #steps=312
start validation
acc: 0.746479
AUC: 0.905647
Avg Precision: 0.485767
Avg Recall: 1.000000
d_prime: 1.858862
train_loss: 0.039456
valid_loss: 1.335392
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00019742819650012626
Epoch-9 lr: 0.00039485639300025253
epoch 9 training time: 15.183
---------------
2023-09-24 19:23:48.019502
current #epochs=10, #steps=351
start validation
acc: 0.723005
AUC: 0.906889
Avg Precision: 0.486737
Avg Recall: 1.000000
d_prime: 1.869364
train_loss: 0.060717
valid_loss: 1.332384
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0001416810864685963
Epoch-10 lr: 0.0002833621729371926
epoch 10 training time: 15.049
---------------
2023-09-24 19:24:03.068355
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00875	Per Sample Data Time 0.00289	Per Sample DNN Time 0.00586	Train Loss 0.0427	
start validation
acc: 0.732394
AUC: 0.905277
Avg Precision: 0.484412
Avg Recall: 1.000000
d_prime: 1.855760
train_loss: 0.046260
valid_loss: 1.333976
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0001416810864685963
Epoch-11 lr: 0.0002833621729371926
epoch 11 training time: 15.230
---------------
2023-09-24 19:24:18.298160
current #epochs=12, #steps=429
start validation
acc: 0.718310
AUC: 0.905028
Avg Precision: 0.492780
Avg Recall: 1.000000
d_prime: 1.853674
train_loss: 0.050282
valid_loss: 1.331693
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.000101675093116241
Epoch-12 lr: 0.000203350186232482
epoch 12 training time: 15.249
---------------
2023-09-24 19:24:33.547883
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00656	Per Sample Data Time 0.00104	Per Sample DNN Time 0.00552	Train Loss 0.0575	
start validation
acc: 0.732394
AUC: 0.905348
Avg Precision: 0.484359
Avg Recall: 1.000000
d_prime: 1.856357
train_loss: 0.059344
valid_loss: 1.332336
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.000101675093116241
Epoch-13 lr: 0.000203350186232482
epoch 13 training time: 16.583
---------------
2023-09-24 19:24:50.130423
current #epochs=14, #steps=507
start validation
acc: 0.727700
AUC: 0.905467
Avg Precision: 0.485114
Avg Recall: 1.000000
d_prime: 1.857357
train_loss: 0.044054
valid_loss: 1.328623
validation finished
normal learning rate scheduler step
Epoch-14 lr: 7.296545232583082e-05
Epoch-14 lr: 0.00014593090465166164
epoch 14 training time: 16.234
---------------
2023-09-24 19:25:06.364114
current #epochs=15, #steps=546
start validation
acc: 0.732394
AUC: 0.905205
Avg Precision: 0.493781
Avg Recall: 1.000000
d_prime: 1.855152
train_loss: 0.047130
valid_loss: 1.327529
validation finished
normal learning rate scheduler step
Epoch-15 lr: 7.296545232583082e-05
Epoch-15 lr: 0.00014593090465166164
epoch 15 training time: 15.269
---------------
2023-09-24 19:25:21.633365
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00787	Per Sample Data Time 0.00213	Per Sample DNN Time 0.00575	Train Loss 0.0353	
start validation
acc: 0.751174
AUC: 0.905727
Avg Precision: 0.485875
Avg Recall: 1.000000
d_prime: 1.859537
train_loss: 0.038761
valid_loss: 1.326709
validation finished
normal learning rate scheduler step
Epoch-16 lr: 5.236245249391044e-05
Epoch-16 lr: 0.00010472490498782088
epoch 16 training time: 15.410
---------------
2023-09-24 19:25:37.043491
current #epochs=17, #steps=624
start validation
acc: 0.751174
AUC: 0.906654
Avg Precision: 0.487906
Avg Recall: 1.000000
d_prime: 1.867371
train_loss: 0.046359
valid_loss: 1.325426
validation finished
normal learning rate scheduler step
Epoch-17 lr: 5.236245249391044e-05
Epoch-17 lr: 0.00010472490498782088
epoch 17 training time: 15.460
---------------
2023-09-24 19:25:52.503252
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00650	Per Sample Data Time 0.00094	Per Sample DNN Time 0.00557	Train Loss 0.0445	
start validation
acc: 0.760563
AUC: 0.906130
Avg Precision: 0.487377
Avg Recall: 1.000000
d_prime: 1.862935
train_loss: 0.043957
valid_loss: 1.327106
validation finished
normal learning rate scheduler step
Epoch-18 lr: 3.7577049737638395e-05
Epoch-18 lr: 7.515409947527679e-05
epoch 18 training time: 15.168
---------------
2023-09-24 19:26:07.671065
current #epochs=19, #steps=702
start validation
acc: 0.769953
AUC: 0.905431
Avg Precision: 0.487543
Avg Recall: 1.000000
d_prime: 1.857052
train_loss: 0.045677
valid_loss: 1.329322
validation finished
normal learning rate scheduler step
Epoch-19 lr: 3.7577049737638395e-05
Epoch-19 lr: 7.515409947527679e-05
epoch 19 training time: 17.861
---------------
2023-09-24 19:26:25.532070
current #epochs=20, #steps=741
start validation
acc: 0.765258
AUC: 0.905055
Avg Precision: 0.487059
Avg Recall: 1.000000
d_prime: 1.853895
train_loss: 0.051947
valid_loss: 1.329858
validation finished
normal learning rate scheduler step
Epoch-20 lr: 2.6966549497450758e-05
Epoch-20 lr: 5.3933098994901517e-05
epoch 20 training time: 15.178
---------------
2023-09-24 19:26:40.710281
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00722	Per Sample Data Time 0.00154	Per Sample DNN Time 0.00568	Train Loss 0.0442	
start validation
acc: 0.765258
AUC: 0.905742
Avg Precision: 0.486868
Avg Recall: 1.000000
d_prime: 1.859669
train_loss: 0.048671
valid_loss: 1.329567
validation finished
normal learning rate scheduler step
Epoch-21 lr: 2.6966549497450758e-05
Epoch-21 lr: 5.3933098994901517e-05
epoch 21 training time: 15.746
---------------
2023-09-24 19:26:56.456399
current #epochs=22, #steps=819
start validation
acc: 0.741784
AUC: 0.906666
Avg Precision: 0.493853
Avg Recall: 1.000000
d_prime: 1.867470
train_loss: 0.040630
valid_loss: 1.329293
validation finished
normal learning rate scheduler step
Epoch-22 lr: 1.9352099136992114e-05
Epoch-22 lr: 3.870419827398423e-05
epoch 22 training time: 15.241
---------------
2023-09-24 19:27:11.697505
current #epochs=23, #steps=858
start validation
acc: 0.751174
AUC: 0.906733
Avg Precision: 0.493515
Avg Recall: 1.000000
d_prime: 1.868034
train_loss: 0.043376
valid_loss: 1.329404
validation finished
normal learning rate scheduler step
Epoch-23 lr: 1.9352099136992114e-05
Epoch-23 lr: 3.870419827398423e-05
epoch 23 training time: 15.122
---------------
2023-09-24 19:27:26.819728
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01471	Per Sample Data Time 0.00821	Per Sample DNN Time 0.00650	Train Loss 0.0440	
start validation
acc: 0.755869
AUC: 0.906564
Avg Precision: 0.492607
Avg Recall: 1.000000
d_prime: 1.866602
train_loss: 0.063494
valid_loss: 1.329683
validation finished
normal learning rate scheduler step
Epoch-24 lr: 1.3887714519923064e-05
Epoch-24 lr: 2.777542903984613e-05
epoch 24 training time: 15.283
---------------
2023-09-24 19:27:42.102342
current #epochs=25, #steps=936
start validation
acc: 0.755869
AUC: 0.906711
Avg Precision: 0.493757
Avg Recall: 1.000000
d_prime: 1.867854
train_loss: 0.046805
valid_loss: 1.330143
validation finished
normal learning rate scheduler step
Epoch-25 lr: 1.3887714519923064e-05
Epoch-25 lr: 2.777542903984613e-05
epoch 25 training time: 15.236
---------------
2023-09-24 19:27:57.338725
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00691	Per Sample Data Time 0.00131	Per Sample DNN Time 0.00560	Train Loss 0.0379	
start validation
acc: 0.760563
AUC: 0.906768
Avg Precision: 0.493927
Avg Recall: 1.000000
d_prime: 1.868337
train_loss: 0.034325
valid_loss: 1.330556
validation finished
normal learning rate scheduler step
Epoch-26 lr: 9.966289094613402e-06
Epoch-26 lr: 1.9932578189226804e-05
epoch 26 training time: 15.188
---------------
2023-09-24 19:28:12.526431
current #epochs=27, #steps=1014
start validation
acc: 0.755869
AUC: 0.906701
Avg Precision: 0.494120
Avg Recall: 1.000000
d_prime: 1.867767
train_loss: 0.051300
valid_loss: 1.331187
validation finished
normal learning rate scheduler step
Epoch-27 lr: 9.966289094613402e-06
Epoch-27 lr: 1.9932578189226804e-05
epoch 27 training time: 16.026
---------------
2023-09-24 19:28:28.552316
current #epochs=28, #steps=1053
start validation
acc: 0.760563
AUC: 0.906398
Avg Precision: 0.494280
Avg Recall: 1.000000
d_prime: 1.865197
train_loss: 0.057441
valid_loss: 1.331715
validation finished
normal learning rate scheduler step
Epoch-28 lr: 7.152142865186162e-06
Epoch-28 lr: 1.4304285730372324e-05
epoch 28 training time: 15.326
---------------
2023-09-24 19:28:43.877978
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00943	Per Sample Data Time 0.00360	Per Sample DNN Time 0.00583	Train Loss 0.0389	
start validation
acc: 0.760563
AUC: 0.906328
Avg Precision: 0.494605
Avg Recall: 1.000000
d_prime: 1.864606
train_loss: 0.040123
valid_loss: 1.331732
validation finished
normal learning rate scheduler step
Epoch-29 lr: 7.152142865186162e-06
Epoch-29 lr: 1.4304285730372324e-05
epoch 29 training time: 15.520
---------------
2023-09-24 19:28:59.398310
current #epochs=30, #steps=1131
start validation
acc: 0.760563
AUC: 0.906554
Avg Precision: 0.494788
Avg Recall: 1.000000
d_prime: 1.866524
train_loss: 0.049800
valid_loss: 1.331567
validation finished
normal learning rate scheduler step
Epoch-30 lr: 5.132617273934054e-06
Epoch-30 lr: 1.0265234547868108e-05
epoch 30 training time: 15.224
---------------
2023-09-24 19:29:14.622229
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00668	Per Sample Data Time 0.00108	Per Sample DNN Time 0.00559	Train Loss 0.0718	
start validation
acc: 0.760563
AUC: 0.906729
Avg Precision: 0.494361
Avg Recall: 1.000000
d_prime: 1.868000
train_loss: 0.061186
valid_loss: 1.331358
validation finished
normal learning rate scheduler step
Epoch-31 lr: 5.132617273934054e-06
Epoch-31 lr: 1.0265234547868108e-05
epoch 31 training time: 15.144
---------------
2023-09-24 19:29:29.766137
current #epochs=32, #steps=1209
start validation
[I 2023-09-24 19:29:46,511] Trial 60 finished with value: 0.49452672807963965 and parameters: {'warmup': 'True', 'num_epochs': 32, 'batch_size': 45, 'lr-adaptschedule': 'True', 'lr': 0.00038335733539708323, 'head-lr': 2, 'lr-scheduler-start': 6, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.7176334940004666}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.760563
AUC: 0.906934
Avg Precision: 0.494527
Avg Recall: 1.000000
d_prime: 1.869741
train_loss: 0.051143
valid_loss: 1.331514
validation finished
normal learning rate scheduler step
Epoch-32 lr: 3.6833380676604452e-06
Epoch-32 lr: 7.3666761353208904e-06
epoch 32 training time: 16.734
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67ec32ee0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.715 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 19:29:46.548594
current #epochs=1, #steps=0
start validation
acc: 0.746479
AUC: 0.900120
Avg Precision: 0.488965
Avg Recall: 1.000000
d_prime: 1.813353
train_loss: 0.077048
valid_loss: 1.329191
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.00042804133750854855
Epoch-1 lr: 0.0012841240125256457
epoch 1 training time: 17.589
---------------
2023-09-24 19:30:04.138595
current #epochs=2, #steps=39
start validation
acc: 0.746479
AUC: 0.902334
Avg Precision: 0.488330
Avg Recall: 1.000000
d_prime: 1.831358
train_loss: 0.046510
valid_loss: 1.329173
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.00042804133750854855
Epoch-2 lr: 0.0012841240125256457
epoch 2 training time: 15.374
---------------
2023-09-24 19:30:19.512499
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00560	Train Loss 0.0521	
start validation
acc: 0.727700
AUC: 0.893909
Avg Precision: 0.487144
Avg Recall: 1.000000
d_prime: 1.764357
train_loss: 0.048719
valid_loss: 1.349707
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.00042804133750854855
Epoch-3 lr: 0.0012841240125256457
epoch 3 training time: 15.338
---------------
2023-09-24 19:30:34.850909
current #epochs=4, #steps=117
start validation
acc: 0.746479
AUC: 0.898974
Avg Precision: 0.496129
Avg Recall: 1.000000
d_prime: 1.804153
train_loss: 0.064136
valid_loss: 1.343105
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00042804133750854855
Epoch-4 lr: 0.0012841240125256457
epoch 4 training time: 15.961
---------------
2023-09-24 19:30:50.811491
current #epochs=5, #steps=156
start validation
acc: 0.723005
AUC: 0.897404
Avg Precision: 0.494157
Avg Recall: 1.000000
d_prime: 1.791665
train_loss: 0.068487
valid_loss: 1.343933
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00042804133750854855
Epoch-5 lr: 0.0012841240125256457
epoch 5 training time: 15.197
---------------
2023-09-24 19:31:06.008316
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01178	Per Sample Data Time 0.00560	Per Sample DNN Time 0.00618	Train Loss 0.1624	
start validation
acc: 0.732394
AUC: 0.897432
Avg Precision: 0.461342
Avg Recall: 1.000000
d_prime: 1.791887
train_loss: 0.077242
valid_loss: 1.348473
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00030595214457947503
Epoch-6 lr: 0.0009178564337384252
epoch 6 training time: 15.383
---------------
2023-09-24 19:31:21.391248
current #epochs=7, #steps=234
start validation
acc: 0.732394
AUC: 0.898922
Avg Precision: 0.453402
Avg Recall: 1.000000
d_prime: 1.803735
train_loss: 0.056577
valid_loss: 1.343512
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00030595214457947503
Epoch-7 lr: 0.0009178564337384252
epoch 7 training time: 15.177
---------------
2023-09-24 19:31:36.568061
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00672	Per Sample Data Time 0.00122	Per Sample DNN Time 0.00550	Train Loss 0.0588	
start validation
acc: 0.746479
AUC: 0.902368
Avg Precision: 0.469188
Avg Recall: 1.000000
d_prime: 1.831639
train_loss: 0.059577
valid_loss: 1.337494
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00021868615614937086
Epoch-8 lr: 0.0006560584684481126
epoch 8 training time: 15.068
---------------
2023-09-24 19:31:51.636216
current #epochs=9, #steps=312
start validation
acc: 0.755869
AUC: 0.901233
Avg Precision: 0.475496
Avg Recall: 1.000000
d_prime: 1.822371
train_loss: 0.048854
valid_loss: 1.337253
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00021868615614937086
Epoch-9 lr: 0.0006560584684481126
epoch 9 training time: 19.751
---------------
2023-09-24 19:32:11.387404
current #epochs=10, #steps=351
start validation
acc: 0.760563
AUC: 0.900774
Avg Precision: 0.481465
Avg Recall: 1.000000
d_prime: 1.818644
train_loss: 0.055844
valid_loss: 1.336018
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00015631083402641163
Epoch-10 lr: 0.0004689325020792349
epoch 10 training time: 17.789
---------------
2023-09-24 19:32:29.176707
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00868	Per Sample Data Time 0.00292	Per Sample DNN Time 0.00576	Train Loss 0.0791	
start validation
acc: 0.741784
AUC: 0.898460
Avg Precision: 0.482455
Avg Recall: 1.000000
d_prime: 1.800047
train_loss: 0.067225
valid_loss: 1.347212
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00015631083402641163
Epoch-11 lr: 0.0004689325020792349
epoch 11 training time: 15.252
---------------
2023-09-24 19:32:44.428345
current #epochs=12, #steps=429
start validation
acc: 0.746479
AUC: 0.900578
Avg Precision: 0.482605
Avg Recall: 1.000000
d_prime: 1.817055
train_loss: 0.039327
valid_loss: 1.338982
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00011172667380619966
Epoch-12 lr: 0.00033518002141859896
epoch 12 training time: 15.276
---------------
2023-09-24 19:32:59.704339
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00665	Per Sample Data Time 0.00110	Per Sample DNN Time 0.00556	Train Loss 0.0683	
start validation
acc: 0.755869
AUC: 0.899989
Avg Precision: 0.482744
Avg Recall: 1.000000
d_prime: 1.812299
train_loss: 0.068963
valid_loss: 1.333526
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00011172667380619966
Epoch-13 lr: 0.00033518002141859896
epoch 13 training time: 15.623
---------------
2023-09-24 19:33:15.327484
current #epochs=14, #steps=507
start validation
acc: 0.741784
AUC: 0.899364
Avg Precision: 0.483719
Avg Recall: 1.000000
d_prime: 1.807278
train_loss: 0.060839
valid_loss: 1.339006
validation finished
normal learning rate scheduler step
Epoch-14 lr: 7.985914551314934e-05
Epoch-14 lr: 0.000239577436539448
epoch 14 training time: 15.252
---------------
2023-09-24 19:33:30.579645
current #epochs=15, #steps=546
start validation
acc: 0.741784
AUC: 0.899923
Avg Precision: 0.490573
Avg Recall: 1.000000
d_prime: 1.811767
train_loss: 0.038378
valid_loss: 1.338865
validation finished
normal learning rate scheduler step
Epoch-15 lr: 7.985914551314934e-05
Epoch-15 lr: 0.000239577436539448
epoch 15 training time: 15.233
---------------
2023-09-24 19:33:45.813105
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00762	Per Sample Data Time 0.00201	Per Sample DNN Time 0.00561	Train Loss 0.0374	
start validation
acc: 0.737089
AUC: 0.900376
Avg Precision: 0.489416
Avg Recall: 1.000000
d_prime: 1.815423
train_loss: 0.044012
valid_loss: 1.339542
validation finished
normal learning rate scheduler step
Epoch-16 lr: 5.708111505362363e-05
Epoch-16 lr: 0.00017124334516087087
epoch 16 training time: 15.169
---------------
2023-09-24 19:34:00.981610
current #epochs=17, #steps=624
start validation
acc: 0.741784
AUC: 0.900602
Avg Precision: 0.481100
Avg Recall: 1.000000
d_prime: 1.817251
train_loss: 0.059142
valid_loss: 1.340593
validation finished
normal learning rate scheduler step
Epoch-17 lr: 5.708111505362363e-05
Epoch-17 lr: 0.00017124334516087087
epoch 17 training time: 15.308
---------------
2023-09-24 19:34:16.289258
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00650	Per Sample Data Time 0.00093	Per Sample DNN Time 0.00556	Train Loss 0.0502	
start validation
acc: 0.737089
AUC: 0.901075
Avg Precision: 0.480642
Avg Recall: 1.000000
d_prime: 1.821082
train_loss: 0.050523
valid_loss: 1.340226
validation finished
normal learning rate scheduler step
Epoch-18 lr: 4.080000699767724e-05
Epoch-18 lr: 0.00012240002099303172
epoch 18 training time: 15.239
---------------
2023-09-24 19:34:31.527903
current #epochs=19, #steps=702
start validation
acc: 0.741784
AUC: 0.900041
Avg Precision: 0.480287
Avg Recall: 1.000000
d_prime: 1.812720
train_loss: 0.052875
valid_loss: 1.341649
validation finished
normal learning rate scheduler step
Epoch-19 lr: 4.080000699767724e-05
Epoch-19 lr: 0.00012240002099303172
epoch 19 training time: 15.215
---------------
2023-09-24 19:34:46.743024
current #epochs=20, #steps=741
start validation
acc: 0.741784
AUC: 0.899977
Avg Precision: 0.480634
Avg Recall: 1.000000
d_prime: 1.812204
train_loss: 0.050907
valid_loss: 1.338970
validation finished
normal learning rate scheduler step
Epoch-20 lr: 2.9162719919656458e-05
Epoch-20 lr: 8.748815975896936e-05
epoch 20 training time: 15.143
---------------
2023-09-24 19:35:01.886050
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00729	Per Sample Data Time 0.00162	Per Sample DNN Time 0.00567	Train Loss 0.0596	
start validation
acc: 0.741784
AUC: 0.900628
Avg Precision: 0.481093
Avg Recall: 1.000000
d_prime: 1.817457
train_loss: 0.056943
valid_loss: 1.337641
validation finished
normal learning rate scheduler step
Epoch-21 lr: 2.9162719919656458e-05
Epoch-21 lr: 8.748815975896936e-05
epoch 21 training time: 15.204
---------------
2023-09-24 19:35:17.090080
current #epochs=22, #steps=819
start validation
acc: 0.741784
AUC: 0.900705
Avg Precision: 0.481659
Avg Recall: 1.000000
d_prime: 1.818087
train_loss: 0.042709
valid_loss: 1.336568
validation finished
normal learning rate scheduler step
Epoch-22 lr: 2.0844708020779133e-05
Epoch-22 lr: 6.253412406233738e-05
epoch 22 training time: 15.077
---------------
2023-09-24 19:35:32.166844
current #epochs=23, #steps=858
start validation
acc: 0.741784
AUC: 0.900856
Avg Precision: 0.481659
Avg Recall: 1.000000
d_prime: 1.819304
train_loss: 0.040629
valid_loss: 1.336730
validation finished
normal learning rate scheduler step
Epoch-23 lr: 2.0844708020779133e-05
Epoch-23 lr: 6.253412406233738e-05
epoch 23 training time: 15.251
---------------
2023-09-24 19:35:47.417565
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01407	Per Sample Data Time 0.00798	Per Sample DNN Time 0.00609	Train Loss 0.0525	
start validation
acc: 0.741784
AUC: 0.900498
Avg Precision: 0.481527
Avg Recall: 1.000000
d_prime: 1.816410
train_loss: 0.043519
valid_loss: 1.337408
validation finished
normal learning rate scheduler step
Epoch-24 lr: 1.489922248914334e-05
Epoch-24 lr: 4.469766746743e-05
epoch 24 training time: 15.368
---------------
2023-09-24 19:36:02.785100
current #epochs=25, #steps=936
start validation
acc: 0.741784
AUC: 0.900135
Avg Precision: 0.479856
Avg Recall: 1.000000
d_prime: 1.813478
train_loss: 0.053762
valid_loss: 1.337474
validation finished
normal learning rate scheduler step
Epoch-25 lr: 1.489922248914334e-05
Epoch-25 lr: 4.469766746743e-05
epoch 25 training time: 15.116
---------------
2023-09-24 19:36:17.901689
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00697	Per Sample Data Time 0.00135	Per Sample DNN Time 0.00563	Train Loss 0.0425	
start validation
acc: 0.741784
AUC: 0.899681
Avg Precision: 0.479724
Avg Recall: 1.000000
d_prime: 1.809824
train_loss: 0.050277
valid_loss: 1.337899
validation finished
normal learning rate scheduler step
Epoch-26 lr: 1.0649553381112661e-05
Epoch-26 lr: 3.194866014333798e-05
epoch 26 training time: 15.245
---------------
2023-09-24 19:36:33.146227
current #epochs=27, #steps=1014
start validation
acc: 0.741784
AUC: 0.899675
Avg Precision: 0.479400
Avg Recall: 1.000000
d_prime: 1.809772
train_loss: 0.040172
valid_loss: 1.337906
validation finished
normal learning rate scheduler step
Epoch-27 lr: 1.0649553381112661e-05
Epoch-27 lr: 3.194866014333798e-05
epoch 27 training time: 15.152
---------------
2023-09-24 19:36:48.298588
current #epochs=28, #steps=1053
start validation
acc: 0.741784
AUC: 0.899604
Avg Precision: 0.479724
Avg Recall: 1.000000
d_prime: 1.809197
train_loss: 0.047031
valid_loss: 1.337491
validation finished
normal learning rate scheduler step
Epoch-28 lr: 7.612007089618878e-06
Epoch-28 lr: 2.2836021268856626e-05
epoch 28 training time: 15.223
---------------
2023-09-24 19:37:03.521581
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00938	Per Sample Data Time 0.00351	Per Sample DNN Time 0.00587	Train Loss 0.0474	
start validation
acc: 0.741784
AUC: 0.899819
Avg Precision: 0.479724
Avg Recall: 1.000000
d_prime: 1.810930
train_loss: 0.055473
valid_loss: 1.337351
validation finished
normal learning rate scheduler step
Epoch-29 lr: 7.612007089618878e-06
Epoch-29 lr: 2.2836021268856626e-05
epoch 29 training time: 15.236
---------------
2023-09-24 19:37:18.757315
current #epochs=30, #steps=1131
start validation
acc: 0.741784
AUC: 0.899939
Avg Precision: 0.479614
Avg Recall: 1.000000
d_prime: 1.811898
train_loss: 0.052089
valid_loss: 1.337993
validation finished
normal learning rate scheduler step
Epoch-30 lr: 5.440852762442722e-06
Epoch-30 lr: 1.6322558287328162e-05
epoch 30 training time: 15.248
---------------
2023-09-24 19:37:34.005394
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00667	Per Sample Data Time 0.00115	Per Sample DNN Time 0.00552	Train Loss 0.0515	
start validation
[I 2023-09-24 19:37:49,409] Trial 61 finished with value: 0.4798804884358552 and parameters: {'warmup': 'True', 'num_epochs': 31, 'batch_size': 46, 'lr-adaptschedule': 'True', 'lr': 0.00042804133750854855, 'head-lr': 3, 'lr-scheduler-start': 6, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.7147724244585718}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.741784
AUC: 0.900047
Avg Precision: 0.479880
Avg Recall: 1.000000
d_prime: 1.812763
train_loss: 0.048700
valid_loss: 1.338096
validation finished
normal learning rate scheduler step
Epoch-31 lr: 5.440852762442722e-06
Epoch-31 lr: 1.6322558287328162e-05
epoch 31 training time: 15.394
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa6015c4a30>
The learning rate scheduler starts at 5 epoch with decay rate of 0.736 every 5 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 19:37:49.445402
current #epochs=1, #steps=0
start validation
acc: 0.746479
AUC: 0.897687
Avg Precision: 0.493955
Avg Recall: 1.000000
d_prime: 1.793902
train_loss: 0.055322
valid_loss: 1.336388
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.00016712199026048508
Epoch-1 lr: 0.00033424398052097015
epoch 1 training time: 18.595
---------------
2023-09-24 19:38:08.040786
current #epochs=2, #steps=39
start validation
acc: 0.751174
AUC: 0.903390
Avg Precision: 0.487282
Avg Recall: 1.000000
d_prime: 1.840055
train_loss: 0.051848
valid_loss: 1.331023
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.00016712199026048508
Epoch-2 lr: 0.00033424398052097015
epoch 2 training time: 17.775
---------------
2023-09-24 19:38:25.815898
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00563	Train Loss 0.0396	
start validation
acc: 0.741784
AUC: 0.901486
Avg Precision: 0.486893
Avg Recall: 1.000000
d_prime: 1.824428
train_loss: 0.035865
valid_loss: 1.332983
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.00016712199026048508
Epoch-3 lr: 0.00033424398052097015
epoch 3 training time: 17.130
---------------
2023-09-24 19:38:42.946645
current #epochs=4, #steps=117
start validation
acc: 0.741784
AUC: 0.901020
Avg Precision: 0.479084
Avg Recall: 1.000000
d_prime: 1.820640
train_loss: 0.057621
valid_loss: 1.340076
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00016712199026048508
Epoch-4 lr: 0.00033424398052097015
epoch 4 training time: 15.276
---------------
2023-09-24 19:38:58.222101
current #epochs=5, #steps=156
start validation
acc: 0.751174
AUC: 0.903877
Avg Precision: 0.476272
Avg Recall: 1.000000
d_prime: 1.844085
train_loss: 0.037414
valid_loss: 1.326943
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00012293548494742468
Epoch-5 lr: 0.00024587096989484936
epoch 5 training time: 16.553
---------------
2023-09-24 19:39:14.774955
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01105	Per Sample Data Time 0.00523	Per Sample DNN Time 0.00582	Train Loss 0.0437	
start validation
acc: 0.751174
AUC: 0.903579
Avg Precision: 0.473417
Avg Recall: 1.000000
d_prime: 1.841617
train_loss: 0.044193
valid_loss: 1.331646
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00012293548494742468
Epoch-6 lr: 0.00024587096989484936
epoch 6 training time: 15.434
---------------
2023-09-24 19:39:30.209130
current #epochs=7, #steps=234
start validation
acc: 0.746479
AUC: 0.902525
Avg Precision: 0.471611
Avg Recall: 1.000000
d_prime: 1.832922
train_loss: 0.049873
valid_loss: 1.331702
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00012293548494742468
Epoch-7 lr: 0.00024587096989484936
epoch 7 training time: 15.750
---------------
2023-09-24 19:39:45.959436
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00683	Per Sample Data Time 0.00124	Per Sample DNN Time 0.00559	Train Loss 0.0309	
start validation
acc: 0.746479
AUC: 0.899739
Avg Precision: 0.470684
Avg Recall: 1.000000
d_prime: 1.810288
train_loss: 0.037113
valid_loss: 1.336520
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00012293548494742468
Epoch-8 lr: 0.00024587096989484936
epoch 8 training time: 15.304
---------------
2023-09-24 19:40:01.263929
current #epochs=9, #steps=312
start validation
acc: 0.741784
AUC: 0.898355
Avg Precision: 0.471469
Avg Recall: 1.000000
d_prime: 1.799211
train_loss: 0.049729
valid_loss: 1.342087
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00012293548494742468
Epoch-9 lr: 0.00024587096989484936
epoch 9 training time: 15.187
---------------
2023-09-24 19:40:16.450749
current #epochs=10, #steps=351
start validation
acc: 0.737089
AUC: 0.899232
Avg Precision: 0.471663
Avg Recall: 1.000000
d_prime: 1.806216
train_loss: 0.051896
valid_loss: 1.333450
validation finished
normal learning rate scheduler step
Epoch-10 lr: 9.04317465086573e-05
Epoch-10 lr: 0.0001808634930173146
epoch 10 training time: 15.269
---------------
2023-09-24 19:40:31.719148
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00865	Per Sample Data Time 0.00286	Per Sample DNN Time 0.00578	Train Loss 0.0503	
start validation
acc: 0.741784
AUC: 0.898702
Avg Precision: 0.472856
Avg Recall: 1.000000
d_prime: 1.801974
train_loss: 0.045432
valid_loss: 1.336424
validation finished
normal learning rate scheduler step
Epoch-11 lr: 9.04317465086573e-05
Epoch-11 lr: 0.0001808634930173146
epoch 11 training time: 15.140
---------------
2023-09-24 19:40:46.859384
current #epochs=12, #steps=429
start validation
acc: 0.732394
AUC: 0.900685
Avg Precision: 0.473392
Avg Recall: 1.000000
d_prime: 1.817925
train_loss: 0.067147
valid_loss: 1.338333
validation finished
normal learning rate scheduler step
Epoch-12 lr: 9.04317465086573e-05
Epoch-12 lr: 0.0001808634930173146
epoch 12 training time: 15.116
---------------
2023-09-24 19:41:01.975752
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00669	Per Sample Data Time 0.00112	Per Sample DNN Time 0.00558	Train Loss 0.0331	
start validation
acc: 0.741784
AUC: 0.901433
Avg Precision: 0.480480
Avg Recall: 1.000000
d_prime: 1.823996
train_loss: 0.033727
valid_loss: 1.337708
validation finished
normal learning rate scheduler step
Epoch-13 lr: 9.04317465086573e-05
Epoch-13 lr: 0.0001808634930173146
epoch 13 training time: 15.336
---------------
2023-09-24 19:41:17.312131
current #epochs=14, #steps=507
start validation
acc: 0.737089
AUC: 0.900091
Avg Precision: 0.481993
Avg Recall: 1.000000
d_prime: 1.813124
train_loss: 0.047183
valid_loss: 1.343756
validation finished
normal learning rate scheduler step
Epoch-14 lr: 9.04317465086573e-05
Epoch-14 lr: 0.0001808634930173146
epoch 14 training time: 15.380
---------------
2023-09-24 19:41:32.692155
current #epochs=15, #steps=546
start validation
acc: 0.732394
AUC: 0.900087
Avg Precision: 0.474491
Avg Recall: 1.000000
d_prime: 1.813091
train_loss: 0.049605
valid_loss: 1.344634
validation finished
normal learning rate scheduler step
Epoch-15 lr: 6.652188975464214e-05
Epoch-15 lr: 0.00013304377950928428
epoch 15 training time: 15.292
---------------
2023-09-24 19:41:47.984069
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00774	Per Sample Data Time 0.00207	Per Sample DNN Time 0.00567	Train Loss 0.0545	
start validation
acc: 0.746479
AUC: 0.900763
Avg Precision: 0.475329
Avg Recall: 1.000000
d_prime: 1.818556
train_loss: 0.045562
valid_loss: 1.342699
validation finished
normal learning rate scheduler step
Epoch-16 lr: 6.652188975464214e-05
Epoch-16 lr: 0.00013304377950928428
epoch 16 training time: 15.192
---------------
2023-09-24 19:42:03.175654
current #epochs=17, #steps=624
start validation
acc: 0.755869
AUC: 0.899910
Avg Precision: 0.480719
Avg Recall: 1.000000
d_prime: 1.811660
train_loss: 0.051662
valid_loss: 1.342776
validation finished
normal learning rate scheduler step
Epoch-17 lr: 6.652188975464214e-05
Epoch-17 lr: 0.00013304377950928428
epoch 17 training time: 17.703
---------------
2023-09-24 19:42:20.878083
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00648	Per Sample Data Time 0.00094	Per Sample DNN Time 0.00554	Train Loss 0.0378	
start validation
acc: 0.760563
AUC: 0.900430
Avg Precision: 0.475006
Avg Recall: 1.000000
d_prime: 1.815859
train_loss: 0.038957
valid_loss: 1.342993
validation finished
normal learning rate scheduler step
Epoch-18 lr: 6.652188975464214e-05
Epoch-18 lr: 0.00013304377950928428
epoch 18 training time: 17.796
---------------
2023-09-24 19:42:38.674531
current #epochs=19, #steps=702
start validation
acc: 0.751174
AUC: 0.901890
Avg Precision: 0.481937
Avg Recall: 1.000000
d_prime: 1.827726
train_loss: 0.040777
valid_loss: 1.338918
validation finished
normal learning rate scheduler step
Epoch-19 lr: 6.652188975464214e-05
Epoch-19 lr: 0.00013304377950928428
epoch 19 training time: 15.299
---------------
2023-09-24 19:42:53.973306
current #epochs=20, #steps=741
start validation
acc: 0.751174
AUC: 0.903515
Avg Precision: 0.480618
Avg Recall: 1.000000
d_prime: 1.841085
train_loss: 0.040290
valid_loss: 1.334729
validation finished
normal learning rate scheduler step
Epoch-20 lr: 4.893372059451631e-05
Epoch-20 lr: 9.786744118903262e-05
epoch 20 training time: 15.628
---------------
2023-09-24 19:43:09.601532
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00734	Per Sample Data Time 0.00160	Per Sample DNN Time 0.00574	Train Loss 0.0568	
start validation
acc: 0.732394
AUC: 0.902518
Avg Precision: 0.478130
Avg Recall: 1.000000
d_prime: 1.832868
train_loss: 0.055667
valid_loss: 1.333191
validation finished
normal learning rate scheduler step
Epoch-21 lr: 4.893372059451631e-05
Epoch-21 lr: 9.786744118903262e-05
epoch 21 training time: 15.282
---------------
2023-09-24 19:43:24.883127
current #epochs=22, #steps=819
start validation
acc: 0.732394
AUC: 0.902464
Avg Precision: 0.478455
Avg Recall: 1.000000
d_prime: 1.832426
train_loss: 0.049127
valid_loss: 1.333175
validation finished
normal learning rate scheduler step
Epoch-22 lr: 4.893372059451631e-05
Epoch-22 lr: 9.786744118903262e-05
epoch 22 training time: 15.197
---------------
2023-09-24 19:43:40.080140
current #epochs=23, #steps=858
start validation
acc: 0.741784
AUC: 0.902447
Avg Precision: 0.478177
Avg Recall: 1.000000
d_prime: 1.832284
train_loss: 0.055629
valid_loss: 1.333836
validation finished
normal learning rate scheduler step
Epoch-23 lr: 4.893372059451631e-05
Epoch-23 lr: 9.786744118903262e-05
epoch 23 training time: 15.245
---------------
2023-09-24 19:43:55.325379
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01412	Per Sample Data Time 0.00800	Per Sample DNN Time 0.00613	Train Loss 0.0369	
start validation
acc: 0.737089
AUC: 0.903153
Avg Precision: 0.472151
Avg Recall: 1.000000
d_prime: 1.838090
train_loss: 0.055003
valid_loss: 1.333618
validation finished
normal learning rate scheduler step
Epoch-24 lr: 4.893372059451631e-05
Epoch-24 lr: 9.786744118903262e-05
epoch 24 training time: 15.261
---------------
2023-09-24 19:44:10.586735
current #epochs=25, #steps=936
start validation
acc: 0.746479
AUC: 0.903458
Avg Precision: 0.473382
Avg Recall: 1.000000
d_prime: 1.840614
train_loss: 0.042640
valid_loss: 1.334522
validation finished
normal learning rate scheduler step
Epoch-25 lr: 3.599580559202458e-05
Epoch-25 lr: 7.199161118404915e-05
epoch 25 training time: 15.248
---------------
2023-09-24 19:44:25.834324
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00689	Per Sample Data Time 0.00133	Per Sample DNN Time 0.00556	Train Loss 0.0408	
start validation
acc: 0.751174
AUC: 0.902626
Avg Precision: 0.473206
Avg Recall: 1.000000
d_prime: 1.833754
train_loss: 0.044297
valid_loss: 1.337111
validation finished
normal learning rate scheduler step
Epoch-26 lr: 3.599580559202458e-05
Epoch-26 lr: 7.199161118404915e-05
epoch 26 training time: 15.616
---------------
2023-09-24 19:44:41.450002
current #epochs=27, #steps=1014
start validation
acc: 0.746479
AUC: 0.902928
Avg Precision: 0.473490
Avg Recall: 1.000000
d_prime: 1.836238
train_loss: 0.051358
valid_loss: 1.336524
validation finished
normal learning rate scheduler step
Epoch-27 lr: 3.599580559202458e-05
Epoch-27 lr: 7.199161118404915e-05
epoch 27 training time: 15.165
---------------
2023-09-24 19:44:56.615802
current #epochs=28, #steps=1053
start validation
[I 2023-09-24 19:45:11,935] Trial 62 finished with value: 0.47334665964790995 and parameters: {'warmup': 'True', 'num_epochs': 28, 'batch_size': 56, 'lr-adaptschedule': 'True', 'lr': 0.00016712199026048508, 'head-lr': 2, 'lr-scheduler-start': 5, 'lr-scheduler-step': 5, 'lr-scheduler-decay': 0.7356032844978151}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.741784
AUC: 0.902436
Avg Precision: 0.473347
Avg Recall: 1.000000
d_prime: 1.832196
train_loss: 0.053659
valid_loss: 1.335261
validation finished
normal learning rate scheduler step
Epoch-28 lr: 3.599580559202458e-05
Epoch-28 lr: 7.199161118404915e-05
epoch 28 training time: 15.309
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f4d83d0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.744 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 19:45:11.972387
current #epochs=1, #steps=0
start validation
acc: 0.737089
AUC: 0.895334
Avg Precision: 0.465412
Avg Recall: 1.000000
d_prime: 1.775407
train_loss: 0.048281
valid_loss: 1.353100
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.00036643678201642887
Epoch-1 lr: 0.0007328735640328577
epoch 1 training time: 17.726
---------------
2023-09-24 19:45:29.699048
current #epochs=2, #steps=39
start validation
acc: 0.727700
AUC: 0.892885
Avg Precision: 0.450826
Avg Recall: 1.000000
d_prime: 1.756482
train_loss: 0.047645
valid_loss: 1.341710
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.00036643678201642887
Epoch-2 lr: 0.0007328735640328577
epoch 2 training time: 15.217
---------------
2023-09-24 19:45:44.915826
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00563	Train Loss 0.0796	
start validation
acc: 0.708920
AUC: 0.898926
Avg Precision: 0.472344
Avg Recall: 1.000000
d_prime: 1.803768
train_loss: 0.069575
valid_loss: 1.333376
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.00036643678201642887
Epoch-3 lr: 0.0007328735640328577
epoch 3 training time: 15.226
---------------
2023-09-24 19:46:00.142270
current #epochs=4, #steps=117
start validation
acc: 0.704225
AUC: 0.896313
Avg Precision: 0.471729
Avg Recall: 1.000000
d_prime: 1.783068
train_loss: 0.057446
valid_loss: 1.340706
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00036643678201642887
Epoch-4 lr: 0.0007328735640328577
epoch 4 training time: 16.171
---------------
2023-09-24 19:46:16.312944
current #epochs=5, #steps=156
start validation
acc: 0.727700
AUC: 0.893838
Avg Precision: 0.478724
Avg Recall: 1.000000
d_prime: 1.763812
train_loss: 0.049047
valid_loss: 1.339194
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00036643678201642887
Epoch-5 lr: 0.0007328735640328577
epoch 5 training time: 16.943
---------------
2023-09-24 19:46:33.255703
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01108	Per Sample Data Time 0.00531	Per Sample DNN Time 0.00577	Train Loss 0.0411	
start validation
acc: 0.732394
AUC: 0.898656
Avg Precision: 0.474588
Avg Recall: 1.000000
d_prime: 1.801609
train_loss: 0.053952
valid_loss: 1.331628
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0002725684570235612
Epoch-6 lr: 0.0005451369140471224
epoch 6 training time: 15.345
---------------
2023-09-24 19:46:48.600307
current #epochs=7, #steps=234
start validation
acc: 0.746479
AUC: 0.901743
Avg Precision: 0.470283
Avg Recall: 1.000000
d_prime: 1.826525
train_loss: 0.053301
valid_loss: 1.334542
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0002725684570235612
Epoch-7 lr: 0.0005451369140471224
epoch 7 training time: 17.744
---------------
2023-09-24 19:47:06.344437
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00687	Per Sample Data Time 0.00125	Per Sample DNN Time 0.00562	Train Loss 0.0754	
start validation
acc: 0.741784
AUC: 0.897273
Avg Precision: 0.475614
Avg Recall: 1.000000
d_prime: 1.790630
train_loss: 0.071173
valid_loss: 1.332783
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0002725684570235612
Epoch-8 lr: 0.0005451369140471224
epoch 8 training time: 16.481
---------------
2023-09-24 19:47:22.825146
current #epochs=9, #steps=312
start validation
acc: 0.699531
AUC: 0.895298
Avg Precision: 0.474976
Avg Recall: 1.000000
d_prime: 1.775132
train_loss: 0.050756
valid_loss: 1.333941
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00020274592347248053
Epoch-9 lr: 0.00040549184694496106
epoch 9 training time: 15.335
---------------
2023-09-24 19:47:38.160202
current #epochs=10, #steps=351
start validation
acc: 0.727700
AUC: 0.895061
Avg Precision: 0.456755
Avg Recall: 1.000000
d_prime: 1.773285
train_loss: 0.049076
valid_loss: 1.331541
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00020274592347248053
Epoch-10 lr: 0.00040549184694496106
epoch 10 training time: 15.139
---------------
2023-09-24 19:47:53.299281
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00869	Per Sample Data Time 0.00295	Per Sample DNN Time 0.00574	Train Loss 0.0646	
start validation
acc: 0.737089
AUC: 0.894439
Avg Precision: 0.456253
Avg Recall: 1.000000
d_prime: 1.768455
train_loss: 0.045038
valid_loss: 1.326819
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00020274592347248053
Epoch-11 lr: 0.00040549184694496106
epoch 11 training time: 15.215
---------------
2023-09-24 19:48:08.513881
current #epochs=12, #steps=429
start validation
acc: 0.741784
AUC: 0.895526
Avg Precision: 0.469669
Avg Recall: 1.000000
d_prime: 1.776904
train_loss: 0.058348
valid_loss: 1.330664
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00015080948813220776
Epoch-12 lr: 0.0003016189762644155
epoch 12 training time: 15.238
---------------
2023-09-24 19:48:23.752268
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00661	Per Sample Data Time 0.00105	Per Sample DNN Time 0.00556	Train Loss 0.0431	
start validation
acc: 0.741784
AUC: 0.898421
Avg Precision: 0.470613
Avg Recall: 1.000000
d_prime: 1.799735
train_loss: 0.048025
valid_loss: 1.329318
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00015080948813220776
Epoch-13 lr: 0.0003016189762644155
epoch 13 training time: 15.201
---------------
2023-09-24 19:48:38.953268
current #epochs=14, #steps=507
start validation
acc: 0.732394
AUC: 0.898731
Avg Precision: 0.475083
Avg Recall: 1.000000
d_prime: 1.802206
train_loss: 0.045904
valid_loss: 1.332467
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.00015080948813220776
Epoch-14 lr: 0.0003016189762644155
epoch 14 training time: 15.231
---------------
2023-09-24 19:48:54.184545
current #epochs=15, #steps=546
start validation
acc: 0.741784
AUC: 0.897960
Avg Precision: 0.466719
Avg Recall: 1.000000
d_prime: 1.796069
train_loss: 0.049380
valid_loss: 1.336203
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.00011217735637375503
Epoch-15 lr: 0.00022435471274751006
epoch 15 training time: 15.135
---------------
2023-09-24 19:49:09.319172
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00786	Per Sample Data Time 0.00210	Per Sample DNN Time 0.00576	Train Loss 0.0613	
start validation
acc: 0.737089
AUC: 0.896695
Avg Precision: 0.466561
Avg Recall: 1.000000
d_prime: 1.786069
train_loss: 0.048253
valid_loss: 1.333870
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.00011217735637375503
Epoch-16 lr: 0.00022435471274751006
epoch 16 training time: 16.322
---------------
2023-09-24 19:49:25.640922
current #epochs=17, #steps=624
start validation
acc: 0.737089
AUC: 0.901142
Avg Precision: 0.469043
Avg Recall: 1.000000
d_prime: 1.821630
train_loss: 0.057858
valid_loss: 1.329382
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.00011217735637375503
Epoch-17 lr: 0.00022435471274751006
epoch 17 training time: 15.248
---------------
2023-09-24 19:49:40.888734
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00648	Per Sample Data Time 0.00094	Per Sample DNN Time 0.00554	Train Loss 0.0451	
start validation
acc: 0.737089
AUC: 0.901166
Avg Precision: 0.481420
Avg Recall: 1.000000
d_prime: 1.821822
train_loss: 0.046149
valid_loss: 1.330379
validation finished
normal learning rate scheduler step
Epoch-18 lr: 8.344142957353475e-05
Epoch-18 lr: 0.0001668828591470695
epoch 18 training time: 15.183
---------------
2023-09-24 19:49:56.071958
current #epochs=19, #steps=702
start validation
acc: 0.755869
AUC: 0.897744
Avg Precision: 0.471017
Avg Recall: 1.000000
d_prime: 1.794357
train_loss: 0.047996
valid_loss: 1.338398
validation finished
normal learning rate scheduler step
Epoch-19 lr: 8.344142957353475e-05
Epoch-19 lr: 0.0001668828591470695
epoch 19 training time: 17.617
---------------
2023-09-24 19:50:13.689309
current #epochs=20, #steps=741
start validation
acc: 0.751174
AUC: 0.899939
Avg Precision: 0.471313
Avg Recall: 1.000000
d_prime: 1.811898
train_loss: 0.054349
valid_loss: 1.337972
validation finished
normal learning rate scheduler step
Epoch-20 lr: 8.344142957353475e-05
Epoch-20 lr: 0.0001668828591470695
epoch 20 training time: 15.622
---------------
2023-09-24 19:50:29.311787
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00563	Train Loss 0.0476	
start validation
acc: 0.746479
AUC: 0.901829
Avg Precision: 0.478779
Avg Recall: 1.000000
d_prime: 1.827230
train_loss: 0.046250
valid_loss: 1.332363
validation finished
normal learning rate scheduler step
Epoch-21 lr: 6.206664512646776e-05
Epoch-21 lr: 0.00012413329025293552
epoch 21 training time: 15.211
---------------
2023-09-24 19:50:44.522674
current #epochs=22, #steps=819
start validation
acc: 0.746479
AUC: 0.901981
Avg Precision: 0.478623
Avg Recall: 1.000000
d_prime: 1.828468
train_loss: 0.056903
valid_loss: 1.331436
validation finished
normal learning rate scheduler step
Epoch-22 lr: 6.206664512646776e-05
Epoch-22 lr: 0.00012413329025293552
epoch 22 training time: 15.217
---------------
2023-09-24 19:50:59.740372
current #epochs=23, #steps=858
start validation
acc: 0.751174
AUC: 0.900888
Avg Precision: 0.477362
Avg Recall: 1.000000
d_prime: 1.819563
train_loss: 0.048167
valid_loss: 1.335978
validation finished
normal learning rate scheduler step
Epoch-23 lr: 6.206664512646776e-05
Epoch-23 lr: 0.00012413329025293552
epoch 23 training time: 15.206
---------------
2023-09-24 19:51:14.945843
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01427	Per Sample Data Time 0.00782	Per Sample DNN Time 0.00645	Train Loss 0.0193	
start validation
[I 2023-09-24 19:51:30,342] Trial 63 finished with value: 0.47887946725739733 and parameters: {'warmup': 'True', 'num_epochs': 24, 'batch_size': 45, 'lr-adaptschedule': 'True', 'lr': 0.00036643678201642887, 'head-lr': 2, 'lr-scheduler-start': 6, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.7438348724810623}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.746479
AUC: 0.900964
Avg Precision: 0.478879
Avg Recall: 1.000000
d_prime: 1.820186
train_loss: 0.049226
valid_loss: 1.333990
validation finished
normal learning rate scheduler step
Epoch-24 lr: 4.6167335062973495e-05
Epoch-24 lr: 9.233467012594699e-05
epoch 24 training time: 15.387
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa609e9cbb0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.725 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 19:51:30.381744
current #epochs=1, #steps=0
start validation
acc: 0.732394
AUC: 0.892879
Avg Precision: 0.475804
Avg Recall: 1.000000
d_prime: 1.756431
train_loss: 0.046045
valid_loss: 1.341000
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0005887548778405737
Epoch-1 lr: 0.0011775097556811474
epoch 1 training time: 17.799
---------------
2023-09-24 19:51:48.181668
current #epochs=2, #steps=39
start validation
acc: 0.741784
AUC: 0.899207
Avg Precision: 0.446253
Avg Recall: 1.000000
d_prime: 1.806018
train_loss: 0.066745
valid_loss: 1.332612
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0005887548778405737
Epoch-2 lr: 0.0011775097556811474
epoch 2 training time: 17.681
---------------
2023-09-24 19:52:05.862797
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00703	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00557	Train Loss 0.0483	
start validation
acc: 0.723005
AUC: 0.901001
Avg Precision: 0.456736
Avg Recall: 1.000000
d_prime: 1.820487
train_loss: 0.065432
valid_loss: 1.335649
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0005887548778405737
Epoch-3 lr: 0.0011775097556811474
epoch 3 training time: 15.662
---------------
2023-09-24 19:52:21.525079
current #epochs=4, #steps=117
start validation
acc: 0.737089
AUC: 0.899101
Avg Precision: 0.462125
Avg Recall: 1.000000
d_prime: 1.805166
train_loss: 0.074764
valid_loss: 1.341612
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0005887548778405737
Epoch-4 lr: 0.0011775097556811474
epoch 4 training time: 15.300
---------------
2023-09-24 19:52:36.825343
current #epochs=5, #steps=156
start validation
acc: 0.741784
AUC: 0.910085
Avg Precision: 0.478376
Avg Recall: 1.000000
d_prime: 1.896857
train_loss: 0.050878
valid_loss: 1.325260
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0005887548778405737
Epoch-5 lr: 0.0011775097556811474
epoch 5 training time: 15.339
---------------
2023-09-24 19:52:52.164075
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01126	Per Sample Data Time 0.00530	Per Sample DNN Time 0.00595	Train Loss 0.0292	
start validation
acc: 0.732394
AUC: 0.918394
Avg Precision: 0.488540
Avg Recall: 1.000000
d_prime: 1.971907
train_loss: 0.044561
valid_loss: 1.312271
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0004269354186332588
Epoch-6 lr: 0.0008538708372665176
epoch 6 training time: 15.345
---------------
2023-09-24 19:53:07.509073
current #epochs=7, #steps=234
start validation
acc: 0.727700
AUC: 0.910100
Avg Precision: 0.480001
Avg Recall: 1.000000
d_prime: 1.896984
train_loss: 0.049327
valid_loss: 1.327490
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0004269354186332588
Epoch-7 lr: 0.0008538708372665176
epoch 7 training time: 15.302
---------------
2023-09-24 19:53:22.811572
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00685	Per Sample Data Time 0.00122	Per Sample DNN Time 0.00562	Train Loss 0.0604	
start validation
acc: 0.727700
AUC: 0.897920
Avg Precision: 0.478420
Avg Recall: 1.000000
d_prime: 1.795755
train_loss: 0.062358
valid_loss: 1.332834
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00030959208754600427
Epoch-8 lr: 0.0006191841750920085
epoch 8 training time: 15.242
---------------
2023-09-24 19:53:38.053849
current #epochs=9, #steps=312
start validation
acc: 0.727700
AUC: 0.895492
Avg Precision: 0.473727
Avg Recall: 1.000000
d_prime: 1.776640
train_loss: 0.042854
valid_loss: 1.335947
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00030959208754600427
Epoch-9 lr: 0.0006191841750920085
epoch 9 training time: 15.322
---------------
2023-09-24 19:53:53.375756
current #epochs=10, #steps=351
start validation
acc: 0.723005
AUC: 0.889755
Avg Precision: 0.465731
Avg Recall: 1.000000
d_prime: 1.732732
train_loss: 0.082889
valid_loss: 1.339242
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00022450060708930405
Epoch-10 lr: 0.0004490012141786081
epoch 10 training time: 15.216
---------------
2023-09-24 19:54:08.592256
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00876	Per Sample Data Time 0.00296	Per Sample DNN Time 0.00580	Train Loss 0.0402	
start validation
acc: 0.727700
AUC: 0.898084
Avg Precision: 0.468046
Avg Recall: 1.000000
d_prime: 1.797053
train_loss: 0.046569
valid_loss: 1.329527
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00022450060708930405
Epoch-11 lr: 0.0004490012141786081
epoch 11 training time: 15.257
---------------
2023-09-24 19:54:23.849673
current #epochs=12, #steps=429
start validation
acc: 0.723005
AUC: 0.900040
Avg Precision: 0.473774
Avg Recall: 1.000000
d_prime: 1.812707
train_loss: 0.036747
valid_loss: 1.328653
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0001627965462004152
Epoch-12 lr: 0.0003255930924008304
epoch 12 training time: 15.266
---------------
2023-09-24 19:54:39.115553
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00665	Per Sample Data Time 0.00106	Per Sample DNN Time 0.00559	Train Loss 0.0587	
start validation
acc: 0.708920
AUC: 0.897979
Avg Precision: 0.465744
Avg Recall: 1.000000
d_prime: 1.796223
train_loss: 0.057076
valid_loss: 1.332330
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0001627965462004152
Epoch-13 lr: 0.0003255930924008304
epoch 13 training time: 16.134
---------------
2023-09-24 19:54:55.249761
current #epochs=14, #steps=507
start validation
acc: 0.727700
AUC: 0.900006
Avg Precision: 0.467598
Avg Recall: 1.000000
d_prime: 1.812438
train_loss: 0.045515
valid_loss: 1.333143
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.00011805186541986239
Epoch-14 lr: 0.00023610373083972477
epoch 14 training time: 15.313
---------------
2023-09-24 19:55:10.562759
current #epochs=15, #steps=546
start validation
acc: 0.713615
AUC: 0.900402
Avg Precision: 0.476408
Avg Recall: 1.000000
d_prime: 1.815633
train_loss: 0.053477
valid_loss: 1.332855
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.00011805186541986239
Epoch-15 lr: 0.00023610373083972477
epoch 15 training time: 15.256
---------------
2023-09-24 19:55:25.818311
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00781	Per Sample Data Time 0.00206	Per Sample DNN Time 0.00576	Train Loss 0.0532	
start validation
acc: 0.727700
AUC: 0.898444
Avg Precision: 0.482191
Avg Recall: 1.000000
d_prime: 1.799923
train_loss: 0.054997
valid_loss: 1.336618
validation finished
normal learning rate scheduler step
Epoch-16 lr: 8.560527391012768e-05
Epoch-16 lr: 0.00017121054782025537
epoch 16 training time: 15.323
---------------
2023-09-24 19:55:41.140815
current #epochs=17, #steps=624
start validation
acc: 0.723005
AUC: 0.897195
Avg Precision: 0.480887
Avg Recall: 1.000000
d_prime: 1.790009
train_loss: 0.047431
valid_loss: 1.335608
validation finished
normal learning rate scheduler step
Epoch-17 lr: 8.560527391012768e-05
Epoch-17 lr: 0.00017121054782025537
epoch 17 training time: 15.318
---------------
2023-09-24 19:55:56.459190
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00649	Per Sample Data Time 0.00092	Per Sample DNN Time 0.00556	Train Loss 0.0496	
start validation
acc: 0.723005
AUC: 0.898335
Avg Precision: 0.475982
Avg Recall: 1.000000
d_prime: 1.799048
train_loss: 0.048378
valid_loss: 1.332504
validation finished
normal learning rate scheduler step
Epoch-18 lr: 6.207663805365839e-05
Epoch-18 lr: 0.00012415327610731678
epoch 18 training time: 15.286
---------------
2023-09-24 19:56:11.745320
current #epochs=19, #steps=702
start validation
acc: 0.732394
AUC: 0.898662
Avg Precision: 0.476042
Avg Recall: 1.000000
d_prime: 1.801659
train_loss: 0.042411
valid_loss: 1.332434
validation finished
normal learning rate scheduler step
Epoch-19 lr: 6.207663805365839e-05
Epoch-19 lr: 0.00012415327610731678
epoch 19 training time: 15.250
---------------
2023-09-24 19:56:26.995133
current #epochs=20, #steps=741
start validation
acc: 0.723005
AUC: 0.898355
Avg Precision: 0.475114
Avg Recall: 1.000000
d_prime: 1.799207
train_loss: 0.057994
valid_loss: 1.331109
validation finished
normal learning rate scheduler step
Epoch-20 lr: 4.501485499702387e-05
Epoch-20 lr: 9.002970999404774e-05
epoch 20 training time: 15.256
---------------
2023-09-24 19:56:42.251997
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00159	Per Sample DNN Time 0.00561	Train Loss 0.0469	
start validation
acc: 0.718310
AUC: 0.899495
Avg Precision: 0.482054
Avg Recall: 1.000000
d_prime: 1.808322
train_loss: 0.046341
valid_loss: 1.330106
validation finished
normal learning rate scheduler step
Epoch-21 lr: 4.501485499702387e-05
Epoch-21 lr: 9.002970999404774e-05
epoch 21 training time: 15.214
---------------
2023-09-24 19:56:57.466008
current #epochs=22, #steps=819
start validation
acc: 0.727700
AUC: 0.900126
Avg Precision: 0.482318
Avg Recall: 1.000000
d_prime: 1.813406
train_loss: 0.052327
valid_loss: 1.329967
validation finished
normal learning rate scheduler step
Epoch-22 lr: 3.264250825973437e-05
Epoch-22 lr: 6.528501651946875e-05
epoch 22 training time: 15.217
---------------
2023-09-24 19:57:12.683235
current #epochs=23, #steps=858
start validation
acc: 0.727700
AUC: 0.899825
Avg Precision: 0.481960
Avg Recall: 1.000000
d_prime: 1.810981
train_loss: 0.046846
valid_loss: 1.329727
validation finished
normal learning rate scheduler step
Epoch-23 lr: 3.264250825973437e-05
Epoch-23 lr: 6.528501651946875e-05
epoch 23 training time: 15.323
---------------
2023-09-24 19:57:28.006348
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01414	Per Sample Data Time 0.00756	Per Sample DNN Time 0.00658	Train Loss 0.0475	
start validation
acc: 0.727700
AUC: 0.899250
Avg Precision: 0.481250
Avg Recall: 1.000000
d_prime: 1.806361
train_loss: 0.060479
valid_loss: 1.330253
validation finished
normal learning rate scheduler step
Epoch-24 lr: 2.3670704827490255e-05
Epoch-24 lr: 4.734140965498051e-05
epoch 24 training time: 15.140
---------------
2023-09-24 19:57:43.146708
current #epochs=25, #steps=936
start validation
acc: 0.723005
AUC: 0.898728
Avg Precision: 0.480404
Avg Recall: 1.000000
d_prime: 1.802186
train_loss: 0.044841
valid_loss: 1.330195
validation finished
normal learning rate scheduler step
Epoch-25 lr: 2.3670704827490255e-05
Epoch-25 lr: 4.734140965498051e-05
epoch 25 training time: 15.187
---------------
2023-09-24 19:57:58.334193
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00688	Per Sample Data Time 0.00132	Per Sample DNN Time 0.00556	Train Loss 0.0467	
start validation
acc: 0.718310
AUC: 0.898809
Avg Precision: 0.480304
Avg Recall: 1.000000
d_prime: 1.802833
train_loss: 0.044585
valid_loss: 1.330408
validation finished
normal learning rate scheduler step
Epoch-26 lr: 1.7164804327286395e-05
Epoch-26 lr: 3.432960865457279e-05
epoch 26 training time: 15.263
---------------
2023-09-24 19:58:13.597421
current #epochs=27, #steps=1014
start validation
acc: 0.713615
AUC: 0.898940
Avg Precision: 0.480424
Avg Recall: 1.000000
d_prime: 1.803881
train_loss: 0.054835
valid_loss: 1.330284
validation finished
normal learning rate scheduler step
Epoch-27 lr: 1.7164804327286395e-05
Epoch-27 lr: 3.432960865457279e-05
epoch 27 training time: 15.199
---------------
2023-09-24 19:58:28.796378
current #epochs=28, #steps=1053
start validation
acc: 0.713615
AUC: 0.899259
Avg Precision: 0.480879
Avg Recall: 1.000000
d_prime: 1.806431
train_loss: 0.051561
valid_loss: 1.330339
validation finished
normal learning rate scheduler step
Epoch-28 lr: 1.2447052580025294e-05
Epoch-28 lr: 2.489410516005059e-05
epoch 28 training time: 16.196
---------------
2023-09-24 19:58:44.992327
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00946	Per Sample Data Time 0.00358	Per Sample DNN Time 0.00588	Train Loss 0.0493	
start validation
acc: 0.713615
AUC: 0.899159
Avg Precision: 0.480879
Avg Recall: 1.000000
d_prime: 1.805631
train_loss: 0.049897
valid_loss: 1.330379
validation finished
normal learning rate scheduler step
Epoch-29 lr: 1.2447052580025294e-05
Epoch-29 lr: 2.489410516005059e-05
epoch 29 training time: 15.198
---------------
2023-09-24 19:59:00.190527
current #epochs=30, #steps=1131
start validation
acc: 0.713615
AUC: 0.899216
Avg Precision: 0.480879
Avg Recall: 1.000000
d_prime: 1.806091
train_loss: 0.036821
valid_loss: 1.330316
validation finished
normal learning rate scheduler step
Epoch-30 lr: 9.025976351133113e-06
Epoch-30 lr: 1.8051952702266226e-05
epoch 30 training time: 15.879
---------------
2023-09-24 19:59:16.069354
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00675	Per Sample Data Time 0.00113	Per Sample DNN Time 0.00562	Train Loss 0.0673	
start validation
acc: 0.723005
AUC: 0.899233
Avg Precision: 0.480879
Avg Recall: 1.000000
d_prime: 1.806228
train_loss: 0.060811
valid_loss: 1.330037
validation finished
normal learning rate scheduler step
Epoch-31 lr: 9.025976351133113e-06
Epoch-31 lr: 1.8051952702266226e-05
epoch 31 training time: 15.244
---------------
2023-09-24 19:59:31.313237
current #epochs=32, #steps=1209
start validation
acc: 0.727700
AUC: 0.899295
Avg Precision: 0.480879
Avg Recall: 1.000000
d_prime: 1.806719
train_loss: 0.038500
valid_loss: 1.330084
validation finished
normal learning rate scheduler step
Epoch-32 lr: 6.5451839756788965e-06
Epoch-32 lr: 1.3090367951357793e-05
epoch 32 training time: 15.278
---------------
2023-09-24 19:59:46.591267
current #epochs=33, #steps=1248
start validation
[I 2023-09-24 20:00:01,865] Trial 64 finished with value: 0.48139665741750265 and parameters: {'warmup': 'True', 'num_epochs': 33, 'batch_size': 38, 'lr-adaptschedule': 'True', 'lr': 0.0005887548778405737, 'head-lr': 2, 'lr-scheduler-start': 6, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.725149692515782}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.723005
AUC: 0.899366
Avg Precision: 0.481397
Avg Recall: 1.000000
d_prime: 1.807291
train_loss: 0.054319
valid_loss: 1.330089
validation finished
normal learning rate scheduler step
Epoch-33 lr: 6.5451839756788965e-06
Epoch-33 lr: 1.3090367951357793e-05
epoch 33 training time: 15.262
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f523100>
The learning rate scheduler starts at 5 epoch with decay rate of 0.709 every 7 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 20:00:01.903295
current #epochs=1, #steps=0
start validation
acc: 0.727700
AUC: 0.899293
Avg Precision: 0.480655
Avg Recall: 1.000000
d_prime: 1.806708
train_loss: 0.039197
valid_loss: 1.329885
validation finished
normal learning rate scheduler step
Epoch-1 lr: 1.1275514391060186e-05
Epoch-1 lr: 2.2551028782120372e-05
epoch 1 training time: 17.835
---------------
2023-09-24 20:00:19.738425
current #epochs=2, #steps=39
start validation
acc: 0.727700
AUC: 0.899484
Avg Precision: 0.480655
Avg Recall: 1.000000
d_prime: 1.808237
train_loss: 0.044396
valid_loss: 1.329851
validation finished
normal learning rate scheduler step
Epoch-2 lr: 1.1275514391060186e-05
Epoch-2 lr: 2.2551028782120372e-05
epoch 2 training time: 15.142
---------------
2023-09-24 20:00:34.880312
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00558	Train Loss 0.0569	
start validation
acc: 0.718310
AUC: 0.899372
Avg Precision: 0.481049
Avg Recall: 1.000000
d_prime: 1.807342
train_loss: 0.056259
valid_loss: 1.329489
validation finished
normal learning rate scheduler step
Epoch-3 lr: 1.1275514391060186e-05
Epoch-3 lr: 2.2551028782120372e-05
epoch 3 training time: 15.706
---------------
2023-09-24 20:00:50.585923
current #epochs=4, #steps=117
start validation
acc: 0.713615
AUC: 0.899289
Avg Precision: 0.481049
Avg Recall: 1.000000
d_prime: 1.806671
train_loss: 0.038410
valid_loss: 1.329389
validation finished
normal learning rate scheduler step
Epoch-4 lr: 1.1275514391060186e-05
Epoch-4 lr: 2.2551028782120372e-05
epoch 4 training time: 15.214
---------------
2023-09-24 20:01:05.799704
current #epochs=5, #steps=156
start validation
acc: 0.718310
AUC: 0.898696
Avg Precision: 0.481049
Avg Recall: 1.000000
d_prime: 1.801925
train_loss: 0.047934
valid_loss: 1.329547
validation finished
normal learning rate scheduler step
Epoch-5 lr: 7.989247856450495e-06
Epoch-5 lr: 1.597849571290099e-05
epoch 5 training time: 15.086
---------------
2023-09-24 20:01:20.885938
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01149	Per Sample Data Time 0.00531	Per Sample DNN Time 0.00618	Train Loss 0.0351	
start validation
acc: 0.732394
AUC: 0.898800
Avg Precision: 0.480655
Avg Recall: 1.000000
d_prime: 1.802757
train_loss: 0.055765
valid_loss: 1.329699
validation finished
normal learning rate scheduler step
Epoch-6 lr: 7.989247856450495e-06
Epoch-6 lr: 1.597849571290099e-05
epoch 6 training time: 17.881
---------------
2023-09-24 20:01:38.766710
current #epochs=7, #steps=234
start validation
acc: 0.732394
AUC: 0.898814
Avg Precision: 0.480655
Avg Recall: 1.000000
d_prime: 1.802875
train_loss: 0.044561
valid_loss: 1.329966
validation finished
normal learning rate scheduler step
Epoch-7 lr: 7.989247856450495e-06
Epoch-7 lr: 1.597849571290099e-05
epoch 7 training time: 15.209
---------------
2023-09-24 20:01:53.975574
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00682	Per Sample Data Time 0.00124	Per Sample DNN Time 0.00558	Train Loss 0.0470	
start validation
acc: 0.732394
AUC: 0.898987
Avg Precision: 0.480655
Avg Recall: 1.000000
d_prime: 1.804251
train_loss: 0.059407
valid_loss: 1.330186
validation finished
normal learning rate scheduler step
Epoch-8 lr: 7.989247856450495e-06
Epoch-8 lr: 1.597849571290099e-05
epoch 8 training time: 15.210
---------------
2023-09-24 20:02:09.185117
current #epochs=9, #steps=312
start validation
acc: 0.732394
AUC: 0.899141
Avg Precision: 0.480266
Avg Recall: 1.000000
d_prime: 1.805484
train_loss: 0.045112
valid_loss: 1.330320
validation finished
normal learning rate scheduler step
Epoch-9 lr: 7.989247856450495e-06
Epoch-9 lr: 1.597849571290099e-05
epoch 9 training time: 15.265
---------------
2023-09-24 20:02:24.449867
current #epochs=10, #steps=351
start validation
acc: 0.732394
AUC: 0.899126
Avg Precision: 0.479933
Avg Recall: 1.000000
d_prime: 1.805369
train_loss: 0.060351
valid_loss: 1.330578
validation finished
normal learning rate scheduler step
Epoch-10 lr: 7.989247856450495e-06
Epoch-10 lr: 1.597849571290099e-05
epoch 10 training time: 15.151
---------------
2023-09-24 20:02:39.600461
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00864	Per Sample Data Time 0.00281	Per Sample DNN Time 0.00582	Train Loss 0.0388	
start validation
acc: 0.732394
AUC: 0.898971
Avg Precision: 0.479933
Avg Recall: 1.000000
d_prime: 1.804128
train_loss: 0.043143
valid_loss: 1.330859
validation finished
normal learning rate scheduler step
Epoch-11 lr: 7.989247856450495e-06
Epoch-11 lr: 1.597849571290099e-05
epoch 11 training time: 15.233
---------------
2023-09-24 20:02:54.832932
current #epochs=12, #steps=429
start validation
acc: 0.732394
AUC: 0.898963
Avg Precision: 0.479933
Avg Recall: 1.000000
d_prime: 1.804067
train_loss: 0.046161
valid_loss: 1.331262
validation finished
normal learning rate scheduler step
Epoch-12 lr: 5.6607689102330494e-06
Epoch-12 lr: 1.1321537820466099e-05
epoch 12 training time: 16.388
---------------
2023-09-24 20:03:11.221209
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00666	Per Sample Data Time 0.00106	Per Sample DNN Time 0.00559	Train Loss 0.0458	
start validation
acc: 0.732394
AUC: 0.898766
Avg Precision: 0.479713
Avg Recall: 1.000000
d_prime: 1.802487
train_loss: 0.053956
valid_loss: 1.331341
validation finished
normal learning rate scheduler step
Epoch-13 lr: 5.6607689102330494e-06
Epoch-13 lr: 1.1321537820466099e-05
epoch 13 training time: 15.151
---------------
2023-09-24 20:03:26.372285
current #epochs=14, #steps=507
start validation
acc: 0.732394
AUC: 0.899081
Avg Precision: 0.479713
Avg Recall: 1.000000
d_prime: 1.805007
train_loss: 0.067346
valid_loss: 1.331274
validation finished
normal learning rate scheduler step
Epoch-14 lr: 5.6607689102330494e-06
Epoch-14 lr: 1.1321537820466099e-05
epoch 14 training time: 16.176
---------------
2023-09-24 20:03:42.548752
current #epochs=15, #steps=546
start validation
acc: 0.732394
AUC: 0.898836
Avg Precision: 0.479713
Avg Recall: 1.000000
d_prime: 1.803050
train_loss: 0.046202
valid_loss: 1.331216
validation finished
normal learning rate scheduler step
Epoch-15 lr: 5.6607689102330494e-06
Epoch-15 lr: 1.1321537820466099e-05
epoch 15 training time: 15.264
---------------
2023-09-24 20:03:57.812504
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00786	Per Sample Data Time 0.00214	Per Sample DNN Time 0.00573	Train Loss 0.0511	
start validation
acc: 0.732394
AUC: 0.899111
Avg Precision: 0.480045
Avg Recall: 1.000000
d_prime: 1.805247
train_loss: 0.055570
valid_loss: 1.331530
validation finished
normal learning rate scheduler step
Epoch-16 lr: 5.6607689102330494e-06
Epoch-16 lr: 1.1321537820466099e-05
epoch 16 training time: 15.295
---------------
2023-09-24 20:04:13.108015
current #epochs=17, #steps=624
start validation
acc: 0.732394
AUC: 0.898959
Avg Precision: 0.479713
Avg Recall: 1.000000
d_prime: 1.804027
train_loss: 0.041768
valid_loss: 1.331546
validation finished
normal learning rate scheduler step
Epoch-17 lr: 5.6607689102330494e-06
Epoch-17 lr: 1.1321537820466099e-05
epoch 17 training time: 15.252
---------------
2023-09-24 20:04:28.360410
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00647	Per Sample Data Time 0.00092	Per Sample DNN Time 0.00555	Train Loss 0.0619	
start validation
acc: 0.732394
AUC: 0.899042
Avg Precision: 0.479713
Avg Recall: 1.000000
d_prime: 1.804694
train_loss: 0.062763
valid_loss: 1.331594
validation finished
normal learning rate scheduler step
Epoch-18 lr: 5.6607689102330494e-06
Epoch-18 lr: 1.1321537820466099e-05
epoch 18 training time: 15.234
---------------
2023-09-24 20:04:43.594430
current #epochs=19, #steps=702
start validation
acc: 0.727700
AUC: 0.899033
Avg Precision: 0.480045
Avg Recall: 1.000000
d_prime: 1.804626
train_loss: 0.045775
valid_loss: 1.331345
validation finished
normal learning rate scheduler step
Epoch-19 lr: 4.010928842217429e-06
Epoch-19 lr: 8.021857684434859e-06
epoch 19 training time: 15.251
---------------
2023-09-24 20:04:58.845337
current #epochs=20, #steps=741
start validation
acc: 0.727700
AUC: 0.899158
Avg Precision: 0.480045
Avg Recall: 1.000000
d_prime: 1.805620
train_loss: 0.041288
valid_loss: 1.331254
validation finished
normal learning rate scheduler step
Epoch-20 lr: 4.010928842217429e-06
Epoch-20 lr: 8.021857684434859e-06
epoch 20 training time: 15.251
---------------
2023-09-24 20:05:14.096206
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00729	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00572	Train Loss 0.0400	
start validation
acc: 0.727700
AUC: 0.899022
Avg Precision: 0.479713
Avg Recall: 1.000000
d_prime: 1.804531
train_loss: 0.046579
valid_loss: 1.331279
validation finished
normal learning rate scheduler step
Epoch-21 lr: 4.010928842217429e-06
Epoch-21 lr: 8.021857684434859e-06
epoch 21 training time: 15.230
---------------
2023-09-24 20:05:29.326020
current #epochs=22, #steps=819
start validation
acc: 0.727700
AUC: 0.898992
Avg Precision: 0.479713
Avg Recall: 1.000000
d_prime: 1.804292
train_loss: 0.034767
valid_loss: 1.331256
validation finished
normal learning rate scheduler step
Epoch-22 lr: 4.010928842217429e-06
Epoch-22 lr: 8.021857684434859e-06
epoch 22 training time: 15.317
---------------
2023-09-24 20:05:44.642756
current #epochs=23, #steps=858
start validation
acc: 0.727700
AUC: 0.898899
Avg Precision: 0.479713
Avg Recall: 1.000000
d_prime: 1.803548
train_loss: 0.032917
valid_loss: 1.331355
validation finished
normal learning rate scheduler step
Epoch-23 lr: 4.010928842217429e-06
Epoch-23 lr: 8.021857684434859e-06
epoch 23 training time: 15.670
---------------
2023-09-24 20:06:00.312795
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01379	Per Sample Data Time 0.00769	Per Sample DNN Time 0.00610	Train Loss 0.0686	
start validation
acc: 0.727700
AUC: 0.898803
Avg Precision: 0.479713
Avg Recall: 1.000000
d_prime: 1.802787
train_loss: 0.034643
valid_loss: 1.331457
validation finished
normal learning rate scheduler step
Epoch-24 lr: 4.010928842217429e-06
Epoch-24 lr: 8.021857684434859e-06
epoch 24 training time: 15.379
---------------
2023-09-24 20:06:15.691564
current #epochs=25, #steps=936
start validation
acc: 0.727700
AUC: 0.898916
Avg Precision: 0.479713
Avg Recall: 1.000000
d_prime: 1.803688
train_loss: 0.047533
valid_loss: 1.331471
validation finished
normal learning rate scheduler step
Epoch-25 lr: 4.010928842217429e-06
Epoch-25 lr: 8.021857684434859e-06
epoch 25 training time: 15.309
---------------
2023-09-24 20:06:31.000436
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00682	Per Sample Data Time 0.00125	Per Sample DNN Time 0.00557	Train Loss 0.0446	
start validation
acc: 0.727700
AUC: 0.898999
Avg Precision: 0.480045
Avg Recall: 1.000000
d_prime: 1.804352
train_loss: 0.043538
valid_loss: 1.331481
validation finished
normal learning rate scheduler step
Epoch-26 lr: 2.8419372760915862e-06
Epoch-26 lr: 5.6838745521831725e-06
epoch 26 training time: 16.050
---------------
2023-09-24 20:06:47.051121
current #epochs=27, #steps=1014
start validation
acc: 0.732394
AUC: 0.898936
Avg Precision: 0.480045
Avg Recall: 1.000000
d_prime: 1.803846
train_loss: 0.039133
valid_loss: 1.331502
validation finished
normal learning rate scheduler step
Epoch-27 lr: 2.8419372760915862e-06
Epoch-27 lr: 5.6838745521831725e-06
epoch 27 training time: 15.136
---------------
2023-09-24 20:07:02.186572
current #epochs=28, #steps=1053
start validation
acc: 0.732394
AUC: 0.898899
Avg Precision: 0.480045
Avg Recall: 1.000000
d_prime: 1.803549
train_loss: 0.039809
valid_loss: 1.331487
validation finished
normal learning rate scheduler step
Epoch-28 lr: 2.8419372760915862e-06
Epoch-28 lr: 5.6838745521831725e-06
epoch 28 training time: 15.269
---------------
2023-09-24 20:07:17.455872
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00950	Per Sample Data Time 0.00362	Per Sample DNN Time 0.00589	Train Loss 0.0404	
start validation
acc: 0.732394
AUC: 0.898739
Avg Precision: 0.480045
Avg Recall: 1.000000
d_prime: 1.802275
train_loss: 0.051623
valid_loss: 1.331424
validation finished
normal learning rate scheduler step
Epoch-29 lr: 2.8419372760915862e-06
Epoch-29 lr: 5.6838745521831725e-06
epoch 29 training time: 15.328
---------------
2023-09-24 20:07:32.784008
current #epochs=30, #steps=1131
start validation
acc: 0.732394
AUC: 0.898788
Avg Precision: 0.480045
Avg Recall: 1.000000
d_prime: 1.802667
train_loss: 0.047002
valid_loss: 1.331375
validation finished
normal learning rate scheduler step
Epoch-30 lr: 2.8419372760915862e-06
Epoch-30 lr: 5.6838745521831725e-06
epoch 30 training time: 15.156
---------------
2023-09-24 20:07:47.939639
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00664	Per Sample Data Time 0.00112	Per Sample DNN Time 0.00552	Train Loss 0.0486	
start validation
acc: 0.732394
AUC: 0.898663
Avg Precision: 0.479713
Avg Recall: 1.000000
d_prime: 1.801669
train_loss: 0.051492
valid_loss: 1.331395
validation finished
normal learning rate scheduler step
Epoch-31 lr: 2.8419372760915862e-06
Epoch-31 lr: 5.6838745521831725e-06
epoch 31 training time: 15.158
---------------
2023-09-24 20:08:03.097590
current #epochs=32, #steps=1209
start validation
acc: 0.732394
AUC: 0.898610
Avg Precision: 0.479385
Avg Recall: 1.000000
d_prime: 1.801245
train_loss: 0.064652
valid_loss: 1.331547
validation finished
normal learning rate scheduler step
Epoch-32 lr: 2.8419372760915862e-06
Epoch-32 lr: 5.6838745521831725e-06
epoch 32 training time: 15.266
---------------
2023-09-24 20:08:18.363298
current #epochs=33, #steps=1248
start validation
acc: 0.732394
AUC: 0.898564
Avg Precision: 0.479385
Avg Recall: 1.000000
d_prime: 1.800873
train_loss: 0.039586
valid_loss: 1.331639
validation finished
normal learning rate scheduler step
Epoch-33 lr: 2.0136501541058847e-06
Epoch-33 lr: 4.0273003082117695e-06
epoch 33 training time: 15.218
---------------
2023-09-24 20:08:33.580793
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00798	Per Sample Data Time 0.00230	Per Sample DNN Time 0.00568	Train Loss 0.0335	
start validation
acc: 0.732394
AUC: 0.898532
Avg Precision: 0.479605
Avg Recall: 1.000000
d_prime: 1.800621
train_loss: 0.037356
valid_loss: 1.331620
validation finished
normal learning rate scheduler step
Epoch-34 lr: 2.0136501541058847e-06
Epoch-34 lr: 4.0273003082117695e-06
epoch 34 training time: 15.189
---------------
2023-09-24 20:08:48.769458
current #epochs=35, #steps=1326
start validation
acc: 0.732394
AUC: 0.898623
Avg Precision: 0.479605
Avg Recall: 1.000000
d_prime: 1.801349
train_loss: 0.052469
valid_loss: 1.331633
validation finished
normal learning rate scheduler step
Epoch-35 lr: 2.0136501541058847e-06
Epoch-35 lr: 4.0273003082117695e-06
epoch 35 training time: 15.233
---------------
2023-09-24 20:09:04.002203
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00660	Per Sample Data Time 0.00102	Per Sample DNN Time 0.00558	Train Loss 0.0385	
start validation
acc: 0.732394
AUC: 0.898725
Avg Precision: 0.479605
Avg Recall: 1.000000
d_prime: 1.802160
train_loss: 0.039613
valid_loss: 1.331605
validation finished
normal learning rate scheduler step
Epoch-36 lr: 2.0136501541058847e-06
Epoch-36 lr: 4.0273003082117695e-06
epoch 36 training time: 15.240
---------------
2023-09-24 20:09:19.242284
current #epochs=37, #steps=1404
start validation
acc: 0.732394
AUC: 0.898798
Avg Precision: 0.480266
Avg Recall: 1.000000
d_prime: 1.802742
train_loss: 0.045444
valid_loss: 1.331578
validation finished
normal learning rate scheduler step
Epoch-37 lr: 2.0136501541058847e-06
Epoch-37 lr: 4.0273003082117695e-06
epoch 37 training time: 15.214
---------------
2023-09-24 20:09:34.456697
current #epochs=38, #steps=1443
start validation
acc: 0.732394
AUC: 0.898637
Avg Precision: 0.479605
Avg Recall: 1.000000
d_prime: 1.801455
train_loss: 0.049592
valid_loss: 1.331604
validation finished
normal learning rate scheduler step
Epoch-38 lr: 2.0136501541058847e-06
Epoch-38 lr: 4.0273003082117695e-06
epoch 38 training time: 15.146
---------------
2023-09-24 20:09:49.602246
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00746	Per Sample Data Time 0.00179	Per Sample DNN Time 0.00566	Train Loss 0.0426	
start validation
[I 2023-09-24 20:10:05,983] Trial 65 finished with value: 0.4796051058665845 and parameters: {'warmup': 'True', 'num_epochs': 39, 'batch_size': 49, 'lr-adaptschedule': 'True', 'lr': 1.1275514391060186e-05, 'head-lr': 2, 'lr-scheduler-start': 5, 'lr-scheduler-step': 7, 'lr-scheduler-decay': 0.7085484155636205}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.732394
AUC: 0.898425
Avg Precision: 0.479605
Avg Recall: 1.000000
d_prime: 1.799767
train_loss: 0.049210
valid_loss: 1.331651
validation finished
normal learning rate scheduler step
Epoch-39 lr: 2.0136501541058847e-06
Epoch-39 lr: 4.0273003082117695e-06
epoch 39 training time: 16.369
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f583940>
The learning rate scheduler starts at 7 epoch with decay rate of 0.688 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 20:10:06.020142
current #epochs=1, #steps=0
start validation
acc: 0.723005
AUC: 0.901420
Avg Precision: 0.479060
Avg Recall: 1.000000
d_prime: 1.823891
train_loss: 0.065145
valid_loss: 1.327307
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.00022984334565509613
Epoch-1 lr: 0.0006895300369652884
epoch 1 training time: 17.886
---------------
2023-09-24 20:10:23.906558
current #epochs=2, #steps=39
start validation
acc: 0.713615
AUC: 0.898495
Avg Precision: 0.476855
Avg Recall: 1.000000
d_prime: 1.800329
train_loss: 0.045888
valid_loss: 1.325229
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.00022984334565509613
Epoch-2 lr: 0.0006895300369652884
epoch 2 training time: 15.136
---------------
2023-09-24 20:10:39.042821
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00148	Per Sample DNN Time 0.00560	Train Loss 0.0455	
start validation
acc: 0.732394
AUC: 0.896433
Avg Precision: 0.478047
Avg Recall: 1.000000
d_prime: 1.784006
train_loss: 0.039328
valid_loss: 1.330053
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.00022984334565509613
Epoch-3 lr: 0.0006895300369652884
epoch 3 training time: 17.735
---------------
2023-09-24 20:10:56.777756
current #epochs=4, #steps=117
start validation
acc: 0.718310
AUC: 0.903385
Avg Precision: 0.485679
Avg Recall: 1.000000
d_prime: 1.840008
train_loss: 0.056250
valid_loss: 1.325234
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00022984334565509613
Epoch-4 lr: 0.0006895300369652884
epoch 4 training time: 15.215
---------------
2023-09-24 20:11:11.992668
current #epochs=5, #steps=156
start validation
acc: 0.737089
AUC: 0.901093
Avg Precision: 0.481465
Avg Recall: 1.000000
d_prime: 1.821230
train_loss: 0.051364
valid_loss: 1.327694
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00022984334565509613
Epoch-5 lr: 0.0006895300369652884
epoch 5 training time: 19.029
---------------
2023-09-24 20:11:31.022175
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01104	Per Sample Data Time 0.00518	Per Sample DNN Time 0.00585	Train Loss 0.0325	
start validation
acc: 0.704225
AUC: 0.896707
Avg Precision: 0.475732
Avg Recall: 1.000000
d_prime: 1.786168
train_loss: 0.041276
valid_loss: 1.331573
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00022984334565509613
Epoch-6 lr: 0.0006895300369652884
epoch 6 training time: 15.758
---------------
2023-09-24 20:11:46.780549
current #epochs=7, #steps=234
start validation
acc: 0.713615
AUC: 0.900329
Avg Precision: 0.479882
Avg Recall: 1.000000
d_prime: 1.815045
train_loss: 0.042604
valid_loss: 1.330946
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00015808474001552988
Epoch-7 lr: 0.00047425422004658964
epoch 7 training time: 15.280
---------------
2023-09-24 20:12:02.060458
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00694	Per Sample Data Time 0.00125	Per Sample DNN Time 0.00569	Train Loss 0.0380	
start validation
acc: 0.718310
AUC: 0.902357
Avg Precision: 0.479368
Avg Recall: 1.000000
d_prime: 1.831549
train_loss: 0.042896
valid_loss: 1.324639
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00010872964346454888
Epoch-8 lr: 0.00032618893039364666
epoch 8 training time: 15.267
---------------
2023-09-24 20:12:17.327576
current #epochs=9, #steps=312
start validation
acc: 0.713615
AUC: 0.904068
Avg Precision: 0.478741
Avg Recall: 1.000000
d_prime: 1.845667
train_loss: 0.062902
valid_loss: 1.324498
validation finished
normal learning rate scheduler step
Epoch-9 lr: 7.47835329758365e-05
Epoch-9 lr: 0.00022435059892750948
epoch 9 training time: 15.203
---------------
2023-09-24 20:12:32.530400
current #epochs=10, #steps=351
start validation
acc: 0.718310
AUC: 0.902737
Avg Precision: 0.472312
Avg Recall: 1.000000
d_prime: 1.834664
train_loss: 0.041615
valid_loss: 1.327765
validation finished
normal learning rate scheduler step
Epoch-10 lr: 5.1435621658885276e-05
Epoch-10 lr: 0.00015430686497665584
epoch 10 training time: 15.932
---------------
2023-09-24 20:12:48.462359
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00877	Per Sample Data Time 0.00295	Per Sample DNN Time 0.00582	Train Loss 0.0401	
start validation
acc: 0.723005
AUC: 0.903562
Avg Precision: 0.472311
Avg Recall: 1.000000
d_prime: 1.841470
train_loss: 0.042752
valid_loss: 1.325006
validation finished
normal learning rate scheduler step
Epoch-11 lr: 3.537708196122297e-05
Epoch-11 lr: 0.0001061312458836689
epoch 11 training time: 15.267
---------------
2023-09-24 20:13:03.729930
current #epochs=12, #steps=429
start validation
acc: 0.723005
AUC: 0.904732
Avg Precision: 0.479134
Avg Recall: 1.000000
d_prime: 1.851201
train_loss: 0.049504
valid_loss: 1.325520
validation finished
normal learning rate scheduler step
Epoch-12 lr: 2.4332124075239788e-05
Epoch-12 lr: 7.299637222571935e-05
epoch 12 training time: 15.225
---------------
2023-09-24 20:13:18.954888
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00660	Per Sample Data Time 0.00103	Per Sample DNN Time 0.00557	Train Loss 0.0587	
start validation
acc: 0.732394
AUC: 0.904711
Avg Precision: 0.478954
Avg Recall: 1.000000
d_prime: 1.851023
train_loss: 0.065121
valid_loss: 1.326471
validation finished
normal learning rate scheduler step
Epoch-13 lr: 1.673547475345241e-05
Epoch-13 lr: 5.0206424260357226e-05
epoch 13 training time: 15.298
---------------
2023-09-24 20:13:34.252768
current #epochs=14, #steps=507
start validation
acc: 0.732394
AUC: 0.904525
Avg Precision: 0.478568
Avg Recall: 1.000000
d_prime: 1.849476
train_loss: 0.049362
valid_loss: 1.326874
validation finished
normal learning rate scheduler step
Epoch-14 lr: 1.1510549360893925e-05
Epoch-14 lr: 3.453164808268177e-05
epoch 14 training time: 15.133
---------------
2023-09-24 20:13:49.385640
current #epochs=15, #steps=546
start validation
acc: 0.723005
AUC: 0.903983
Avg Precision: 0.479171
Avg Recall: 1.000000
d_prime: 1.844966
train_loss: 0.068425
valid_loss: 1.327014
validation finished
normal learning rate scheduler step
Epoch-15 lr: 7.916880073105976e-06
Epoch-15 lr: 2.3750640219317927e-05
epoch 15 training time: 15.637
---------------
2023-09-24 20:14:05.022746
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00786	Per Sample Data Time 0.00211	Per Sample DNN Time 0.00574	Train Loss 0.0413	
start validation
acc: 0.723005
AUC: 0.903764
Avg Precision: 0.479000
Avg Recall: 1.000000
d_prime: 1.843144
train_loss: 0.050826
valid_loss: 1.327052
validation finished
normal learning rate scheduler step
Epoch-16 lr: 5.445177995142615e-06
Epoch-16 lr: 1.6335533985427844e-05
epoch 16 training time: 15.342
---------------
2023-09-24 20:14:20.364420
current #epochs=17, #steps=624
start validation
acc: 0.723005
AUC: 0.904101
Avg Precision: 0.479171
Avg Recall: 1.000000
d_prime: 1.845939
train_loss: 0.052162
valid_loss: 1.327105
validation finished
normal learning rate scheduler step
Epoch-17 lr: 3.745157577857937e-06
Epoch-17 lr: 1.1235472733573812e-05
epoch 17 training time: 16.845
---------------
2023-09-24 20:14:37.209042
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00650	Per Sample Data Time 0.00096	Per Sample DNN Time 0.00554	Train Loss 0.0499	
start validation
acc: 0.723005
AUC: 0.903821
Avg Precision: 0.478779
Avg Recall: 1.000000
d_prime: 1.843619
train_loss: 0.049412
valid_loss: 1.327130
validation finished
normal learning rate scheduler step
Epoch-18 lr: 2.5758947265817286e-06
Epoch-18 lr: 7.727684179745186e-06
epoch 18 training time: 15.314
---------------
2023-09-24 20:14:52.523615
current #epochs=19, #steps=702
start validation
acc: 0.723005
AUC: 0.903859
Avg Precision: 0.478779
Avg Recall: 1.000000
d_prime: 1.843937
train_loss: 0.053348
valid_loss: 1.327176
validation finished
normal learning rate scheduler step
Epoch-19 lr: 1.771683435073676e-06
Epoch-19 lr: 5.315050305221028e-06
epoch 19 training time: 15.187
---------------
2023-09-24 20:15:07.710891
current #epochs=20, #steps=741
start validation
acc: 0.723005
AUC: 0.903881
Avg Precision: 0.478779
Avg Recall: 1.000000
d_prime: 1.844114
train_loss: 0.037921
valid_loss: 1.327148
validation finished
normal learning rate scheduler step
Epoch-20 lr: 1.2185522031328518e-06
Epoch-20 lr: 3.6556566093985553e-06
epoch 20 training time: 17.020
---------------
2023-09-24 20:15:24.730416
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00730	Per Sample Data Time 0.00165	Per Sample DNN Time 0.00565	Train Loss 0.0585	
start validation
acc: 0.723005
AUC: 0.903815
Avg Precision: 0.478779
Avg Recall: 1.000000
d_prime: 1.843566
train_loss: 0.064317
valid_loss: 1.327156
validation finished
normal learning rate scheduler step
Epoch-21 lr: 8.381121832288161e-07
Epoch-21 lr: 2.514336549686448e-06
epoch 21 training time: 15.228
---------------
2023-09-24 20:15:39.958566
current #epochs=22, #steps=819
start validation
acc: 0.723005
AUC: 0.903803
Avg Precision: 0.478779
Avg Recall: 1.000000
d_prime: 1.843468
train_loss: 0.035601
valid_loss: 1.327164
validation finished
normal learning rate scheduler step
Epoch-22 lr: 5.764480420868685e-07
Epoch-22 lr: 1.7293441262606054e-06
epoch 22 training time: 15.264
---------------
2023-09-24 20:15:55.223044
current #epochs=23, #steps=858
start validation
acc: 0.723005
AUC: 0.903762
Avg Precision: 0.478779
Avg Recall: 1.000000
d_prime: 1.843132
train_loss: 0.040743
valid_loss: 1.327162
validation finished
normal learning rate scheduler step
Epoch-23 lr: 3.9647716842109646e-07
Epoch-23 lr: 1.1894315052632892e-06
epoch 23 training time: 15.297
---------------
2023-09-24 20:16:10.520114
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01445	Per Sample Data Time 0.00773	Per Sample DNN Time 0.00673	Train Loss 0.0656	
start validation
acc: 0.723005
AUC: 0.903682
Avg Precision: 0.478609
Avg Recall: 1.000000
d_prime: 1.842467
train_loss: 0.046108
valid_loss: 1.327154
validation finished
normal learning rate scheduler step
Epoch-24 lr: 2.7269438631473734e-07
Epoch-24 lr: 8.180831589442118e-07
epoch 24 training time: 15.238
---------------
2023-09-24 20:16:25.758347
current #epochs=25, #steps=936
start validation
acc: 0.723005
AUC: 0.903682
Avg Precision: 0.478609
Avg Recall: 1.000000
d_prime: 1.842467
train_loss: 0.051133
valid_loss: 1.327155
validation finished
normal learning rate scheduler step
Epoch-25 lr: 1.8755740368028315e-07
Epoch-25 lr: 5.626722110408494e-07
epoch 25 training time: 15.230
---------------
2023-09-24 20:16:40.987827
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00692	Per Sample Data Time 0.00126	Per Sample DNN Time 0.00566	Train Loss 0.0495	
start validation
acc: 0.723005
AUC: 0.903667
Avg Precision: 0.478609
Avg Recall: 1.000000
d_prime: 1.842344
train_loss: 0.044568
valid_loss: 1.327163
validation finished
normal learning rate scheduler step
Epoch-26 lr: 1.2900074750599134e-07
Epoch-26 lr: 3.87002242517974e-07
epoch 26 training time: 15.283
---------------
2023-09-24 20:16:56.270859
current #epochs=27, #steps=1014
start validation
acc: 0.723005
AUC: 0.903660
Avg Precision: 0.478609
Avg Recall: 1.000000
d_prime: 1.842282
train_loss: 0.043469
valid_loss: 1.327165
validation finished
normal learning rate scheduler step
Epoch-27 lr: 8.87258648849271e-08
Epoch-27 lr: 2.6617759465478127e-07
epoch 27 training time: 16.185
---------------
2023-09-24 20:17:12.455835
current #epochs=28, #steps=1053
start validation
acc: 0.723005
AUC: 0.903652
Avg Precision: 0.478609
Avg Recall: 1.000000
d_prime: 1.842220
train_loss: 0.055780
valid_loss: 1.327169
validation finished
normal learning rate scheduler step
Epoch-28 lr: 6.102506575950436e-08
Epoch-28 lr: 1.8307519727851305e-07
epoch 28 training time: 16.185
---------------
2023-09-24 20:17:28.640813
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00942	Per Sample Data Time 0.00350	Per Sample DNN Time 0.00592	Train Loss 0.0730	
start validation
acc: 0.723005
AUC: 0.903652
Avg Precision: 0.478609
Avg Recall: 1.000000
d_prime: 1.842220
train_loss: 0.050186
valid_loss: 1.327173
validation finished
normal learning rate scheduler step
Epoch-29 lr: 4.197263848351036e-08
Epoch-29 lr: 1.2591791545053104e-07
epoch 29 training time: 15.292
---------------
2023-09-24 20:17:43.932414
current #epochs=30, #steps=1131
start validation
acc: 0.723005
AUC: 0.903652
Avg Precision: 0.478609
Avg Recall: 1.000000
d_prime: 1.842220
train_loss: 0.052097
valid_loss: 1.327175
validation finished
normal learning rate scheduler step
Epoch-30 lr: 2.8868504430789214e-08
Epoch-30 lr: 8.660551329236762e-08
epoch 30 training time: 15.824
---------------
2023-09-24 20:17:59.756719
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00673	Per Sample Data Time 0.00113	Per Sample DNN Time 0.00560	Train Loss 0.0530	
start validation
acc: 0.723005
AUC: 0.903652
Avg Precision: 0.478609
Avg Recall: 1.000000
d_prime: 1.842220
train_loss: 0.059263
valid_loss: 1.327176
validation finished
normal learning rate scheduler step
Epoch-31 lr: 1.9855567297679122e-08
Epoch-31 lr: 5.9566701893037345e-08
epoch 31 training time: 15.310
---------------
2023-09-24 20:18:15.066773
current #epochs=32, #steps=1209
start validation
acc: 0.723005
AUC: 0.903652
Avg Precision: 0.478609
Avg Recall: 1.000000
d_prime: 1.842220
train_loss: 0.041458
valid_loss: 1.327176
validation finished
normal learning rate scheduler step
Epoch-32 lr: 1.3656528472330239e-08
Epoch-32 lr: 4.0969585416990706e-08
epoch 32 training time: 15.369
---------------
2023-09-24 20:18:30.435369
current #epochs=33, #steps=1248
start validation
acc: 0.723005
AUC: 0.903652
Avg Precision: 0.478609
Avg Recall: 1.000000
d_prime: 1.842220
train_loss: 0.053305
valid_loss: 1.327176
validation finished
normal learning rate scheduler step
Epoch-33 lr: 9.392870378343015e-09
Epoch-33 lr: 2.8178611135029038e-08
epoch 33 training time: 15.376
---------------
2023-09-24 20:18:45.811720
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00790	Per Sample Data Time 0.00231	Per Sample DNN Time 0.00559	Train Loss 0.0474	
start validation
acc: 0.723005
AUC: 0.903652
Avg Precision: 0.478609
Avg Recall: 1.000000
d_prime: 1.842220
train_loss: 0.048234
valid_loss: 1.327176
validation finished
normal learning rate scheduler step
Epoch-34 lr: 6.460354410208284e-09
Epoch-34 lr: 1.9381063230624847e-08
epoch 34 training time: 15.246
---------------
2023-09-24 20:19:01.058463
current #epochs=35, #steps=1326
start validation
[I 2023-09-24 20:19:16,227] Trial 66 finished with value: 0.478609226866969 and parameters: {'warmup': 'True', 'num_epochs': 35, 'batch_size': 43, 'lr-adaptschedule': 'True', 'lr': 0.00022984334565509613, 'head-lr': 3, 'lr-scheduler-start': 7, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.6877934167071884}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.723005
AUC: 0.903652
Avg Precision: 0.478609
Avg Recall: 1.000000
d_prime: 1.842220
train_loss: 0.044916
valid_loss: 1.327176
validation finished
normal learning rate scheduler step
Epoch-35 lr: 4.4433892329365085e-09
Epoch-35 lr: 1.3330167698809523e-08
epoch 35 training time: 15.158
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa6015ec280>
The learning rate scheduler starts at 5 epoch with decay rate of 0.731 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 20:19:16.267398
current #epochs=1, #steps=0
start validation
acc: 0.713615
AUC: 0.891684
Avg Precision: 0.466619
Avg Recall: 1.000000
d_prime: 1.747311
train_loss: 0.051874
valid_loss: 1.344343
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0004118775710865611
Epoch-1 lr: 0.0004118775710865611
epoch 1 training time: 17.641
---------------
2023-09-24 20:19:33.908366
current #epochs=2, #steps=39
start validation
acc: 0.718310
AUC: 0.904948
Avg Precision: 0.468939
Avg Recall: 1.000000
d_prime: 1.853001
train_loss: 0.056623
valid_loss: 1.328861
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0004118775710865611
Epoch-2 lr: 0.0004118775710865611
epoch 2 training time: 17.762
---------------
2023-09-24 20:19:51.670092
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00564	Train Loss 0.0587	
start validation
acc: 0.746479
AUC: 0.900696
Avg Precision: 0.486230
Avg Recall: 1.000000
d_prime: 1.818010
train_loss: 0.056123
valid_loss: 1.322532
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0004118775710865611
Epoch-3 lr: 0.0004118775710865611
epoch 3 training time: 18.144
---------------
2023-09-24 20:20:09.814697
current #epochs=4, #steps=117
start validation
acc: 0.727700
AUC: 0.901335
Avg Precision: 0.476862
Avg Recall: 1.000000
d_prime: 1.823197
train_loss: 0.053933
valid_loss: 1.336383
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0004118775710865611
Epoch-4 lr: 0.0004118775710865611
epoch 4 training time: 15.362
---------------
2023-09-24 20:20:25.176645
current #epochs=5, #steps=156
start validation
acc: 0.737089
AUC: 0.907374
Avg Precision: 0.499969
Avg Recall: 1.000000
d_prime: 1.873492
train_loss: 0.029682
valid_loss: 1.341554
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0003011407796924798
Epoch-5 lr: 0.0003011407796924798
epoch 5 training time: 15.249
---------------
2023-09-24 20:20:40.425045
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01122	Per Sample Data Time 0.00521	Per Sample DNN Time 0.00601	Train Loss 0.0668	
start validation
acc: 0.732394
AUC: 0.902378
Avg Precision: 0.491165
Avg Recall: 1.000000
d_prime: 1.831717
train_loss: 0.048693
valid_loss: 1.330578
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0003011407796924798
Epoch-6 lr: 0.0003011407796924798
epoch 6 training time: 16.433
---------------
2023-09-24 20:20:56.858065
current #epochs=7, #steps=234
start validation
acc: 0.732394
AUC: 0.905280
Avg Precision: 0.493086
Avg Recall: 1.000000
d_prime: 1.855786
train_loss: 0.055406
valid_loss: 1.333972
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0002201765173921935
Epoch-7 lr: 0.0002201765173921935
epoch 7 training time: 15.286
---------------
2023-09-24 20:21:12.143599
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00689	Per Sample Data Time 0.00127	Per Sample DNN Time 0.00562	Train Loss 0.0546	
start validation
acc: 0.713615
AUC: 0.909035
Avg Precision: 0.488217
Avg Recall: 1.000000
d_prime: 1.887744
train_loss: 0.053322
valid_loss: 1.333330
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0002201765173921935
Epoch-8 lr: 0.0002201765173921935
epoch 8 training time: 15.224
---------------
2023-09-24 20:21:27.368234
current #epochs=9, #steps=312
start validation
acc: 0.718310
AUC: 0.905925
Avg Precision: 0.473070
Avg Recall: 1.000000
d_prime: 1.861206
train_loss: 0.051233
valid_loss: 1.331624
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00016098018627852244
Epoch-9 lr: 0.00016098018627852244
epoch 9 training time: 15.183
---------------
2023-09-24 20:21:42.550832
current #epochs=10, #steps=351
start validation
acc: 0.723005
AUC: 0.903292
Avg Precision: 0.478439
Avg Recall: 1.000000
d_prime: 1.839244
train_loss: 0.060005
valid_loss: 1.338630
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00016098018627852244
Epoch-10 lr: 0.00016098018627852244
epoch 10 training time: 15.885
---------------
2023-09-24 20:21:58.435906
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00895	Per Sample Data Time 0.00298	Per Sample DNN Time 0.00597	Train Loss 0.0353	
start validation
acc: 0.718310
AUC: 0.902964
Avg Precision: 0.482966
Avg Recall: 1.000000
d_prime: 1.836538
train_loss: 0.052489
valid_loss: 1.348851
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00011769929273659501
Epoch-11 lr: 0.00011769929273659501
epoch 11 training time: 16.468
---------------
2023-09-24 20:22:14.904665
current #epochs=12, #steps=429
start validation
acc: 0.732394
AUC: 0.905825
Avg Precision: 0.480011
Avg Recall: 1.000000
d_prime: 1.860360
train_loss: 0.051432
valid_loss: 1.338861
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00011769929273659501
Epoch-12 lr: 0.00011769929273659501
epoch 12 training time: 15.345
---------------
2023-09-24 20:22:30.249474
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00666	Per Sample Data Time 0.00108	Per Sample DNN Time 0.00558	Train Loss 0.0500	
start validation
acc: 0.723005
AUC: 0.904023
Avg Precision: 0.476596
Avg Recall: 1.000000
d_prime: 1.845298
train_loss: 0.050146
valid_loss: 1.332362
validation finished
normal learning rate scheduler step
Epoch-13 lr: 8.605483588350734e-05
Epoch-13 lr: 8.605483588350734e-05
epoch 13 training time: 17.068
---------------
2023-09-24 20:22:47.317193
current #epochs=14, #steps=507
start validation
acc: 0.723005
AUC: 0.905482
Avg Precision: 0.476464
Avg Recall: 1.000000
d_prime: 1.857482
train_loss: 0.055133
valid_loss: 1.335870
validation finished
normal learning rate scheduler step
Epoch-14 lr: 8.605483588350734e-05
Epoch-14 lr: 8.605483588350734e-05
epoch 14 training time: 16.246
---------------
2023-09-24 20:23:03.562931
current #epochs=15, #steps=546
start validation
acc: 0.723005
AUC: 0.905973
Avg Precision: 0.476276
Avg Recall: 1.000000
d_prime: 1.861607
train_loss: 0.052342
valid_loss: 1.337237
validation finished
normal learning rate scheduler step
Epoch-15 lr: 6.291826065183216e-05
Epoch-15 lr: 6.291826065183216e-05
epoch 15 training time: 15.231
---------------
2023-09-24 20:23:18.794440
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00770	Per Sample Data Time 0.00203	Per Sample DNN Time 0.00566	Train Loss 0.0627	
start validation
acc: 0.723005
AUC: 0.908016
Avg Precision: 0.477079
Avg Recall: 1.000000
d_prime: 1.878972
train_loss: 0.045625
valid_loss: 1.334481
validation finished
normal learning rate scheduler step
Epoch-16 lr: 6.291826065183216e-05
Epoch-16 lr: 6.291826065183216e-05
epoch 16 training time: 16.256
---------------
2023-09-24 20:23:35.050697
current #epochs=17, #steps=624
start validation
acc: 0.732394
AUC: 0.907316
Avg Precision: 0.485388
Avg Recall: 1.000000
d_prime: 1.872995
train_loss: 0.045204
valid_loss: 1.333078
validation finished
normal learning rate scheduler step
Epoch-17 lr: 4.6002150638121075e-05
Epoch-17 lr: 4.6002150638121075e-05
epoch 17 training time: 15.299
---------------
2023-09-24 20:23:50.350220
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00656	Per Sample Data Time 0.00092	Per Sample DNN Time 0.00563	Train Loss 0.0343	
start validation
acc: 0.737089
AUC: 0.907110
Avg Precision: 0.494570
Avg Recall: 1.000000
d_prime: 1.871236
train_loss: 0.034739
valid_loss: 1.331706
validation finished
normal learning rate scheduler step
Epoch-18 lr: 4.6002150638121075e-05
Epoch-18 lr: 4.6002150638121075e-05
epoch 18 training time: 15.291
---------------
2023-09-24 20:24:05.641211
current #epochs=19, #steps=702
start validation
acc: 0.732394
AUC: 0.908021
Avg Precision: 0.495277
Avg Recall: 1.000000
d_prime: 1.879021
train_loss: 0.043823
valid_loss: 1.331549
validation finished
normal learning rate scheduler step
Epoch-19 lr: 3.363408081228895e-05
Epoch-19 lr: 3.363408081228895e-05
epoch 19 training time: 15.356
---------------
2023-09-24 20:24:20.997626
current #epochs=20, #steps=741
start validation
acc: 0.732394
AUC: 0.908319
Avg Precision: 0.496286
Avg Recall: 1.000000
d_prime: 1.881574
train_loss: 0.045709
valid_loss: 1.331777
validation finished
normal learning rate scheduler step
Epoch-20 lr: 3.363408081228895e-05
Epoch-20 lr: 3.363408081228895e-05
epoch 20 training time: 17.225
---------------
2023-09-24 20:24:38.222717
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00733	Per Sample Data Time 0.00168	Per Sample DNN Time 0.00565	Train Loss 0.0539	
start validation
acc: 0.741784
AUC: 0.907372
Avg Precision: 0.496954
Avg Recall: 1.000000
d_prime: 1.873474
train_loss: 0.046653
valid_loss: 1.332032
validation finished
normal learning rate scheduler step
Epoch-21 lr: 2.45912718513238e-05
Epoch-21 lr: 2.45912718513238e-05
epoch 21 training time: 15.304
---------------
2023-09-24 20:24:53.527007
current #epochs=22, #steps=819
start validation
acc: 0.741784
AUC: 0.907242
Avg Precision: 0.496899
Avg Recall: 1.000000
d_prime: 1.872360
train_loss: 0.040125
valid_loss: 1.331364
validation finished
normal learning rate scheduler step
Epoch-22 lr: 2.45912718513238e-05
Epoch-22 lr: 2.45912718513238e-05
epoch 22 training time: 15.213
---------------
2023-09-24 20:25:08.740428
current #epochs=23, #steps=858
start validation
acc: 0.751174
AUC: 0.906800
Avg Precision: 0.497545
Avg Recall: 1.000000
d_prime: 1.868609
train_loss: 0.040741
valid_loss: 1.331895
validation finished
normal learning rate scheduler step
Epoch-23 lr: 1.7979699063003934e-05
Epoch-23 lr: 1.7979699063003934e-05
epoch 23 training time: 17.697
---------------
2023-09-24 20:25:26.437036
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01385	Per Sample Data Time 0.00765	Per Sample DNN Time 0.00620	Train Loss 0.0484	
start validation
acc: 0.732394
AUC: 0.906748
Avg Precision: 0.497080
Avg Recall: 1.000000
d_prime: 1.868161
train_loss: 0.044048
valid_loss: 1.332411
validation finished
normal learning rate scheduler step
Epoch-24 lr: 1.7979699063003934e-05
Epoch-24 lr: 1.7979699063003934e-05
epoch 24 training time: 16.683
---------------
2023-09-24 20:25:43.120371
current #epochs=25, #steps=936
start validation
acc: 0.727700
AUC: 0.906741
Avg Precision: 0.495861
Avg Recall: 1.000000
d_prime: 1.868107
train_loss: 0.050792
valid_loss: 1.332501
validation finished
normal learning rate scheduler step
Epoch-25 lr: 1.3145703904647058e-05
Epoch-25 lr: 1.3145703904647058e-05
epoch 25 training time: 16.593
---------------
2023-09-24 20:25:59.713386
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00685	Per Sample Data Time 0.00130	Per Sample DNN Time 0.00555	Train Loss 0.0524	
start validation
acc: 0.737089
AUC: 0.907067
Avg Precision: 0.496365
Avg Recall: 1.000000
d_prime: 1.870871
train_loss: 0.046076
valid_loss: 1.332300
validation finished
normal learning rate scheduler step
Epoch-26 lr: 1.3145703904647058e-05
Epoch-26 lr: 1.3145703904647058e-05
epoch 26 training time: 15.181
---------------
2023-09-24 20:26:14.894086
current #epochs=27, #steps=1014
start validation
acc: 0.737089
AUC: 0.907174
Avg Precision: 0.496571
Avg Recall: 1.000000
d_prime: 1.871788
train_loss: 0.032649
valid_loss: 1.332041
validation finished
normal learning rate scheduler step
Epoch-27 lr: 9.61136949751488e-06
Epoch-27 lr: 9.61136949751488e-06
epoch 27 training time: 16.460
---------------
2023-09-24 20:26:31.354014
current #epochs=28, #steps=1053
start validation
acc: 0.737089
AUC: 0.907146
Avg Precision: 0.496177
Avg Recall: 1.000000
d_prime: 1.871547
train_loss: 0.048214
valid_loss: 1.331662
validation finished
normal learning rate scheduler step
Epoch-28 lr: 9.61136949751488e-06
Epoch-28 lr: 9.61136949751488e-06
epoch 28 training time: 17.157
---------------
2023-09-24 20:26:48.510954
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00956	Per Sample Data Time 0.00370	Per Sample DNN Time 0.00586	Train Loss 0.0500	
start validation
acc: 0.727700
AUC: 0.906982
Avg Precision: 0.495422
Avg Recall: 1.000000
d_prime: 1.870153
train_loss: 0.042368
valid_loss: 1.331899
validation finished
normal learning rate scheduler step
Epoch-29 lr: 7.027270984333012e-06
Epoch-29 lr: 7.027270984333012e-06
epoch 29 training time: 15.335
---------------
2023-09-24 20:27:03.846083
current #epochs=30, #steps=1131
start validation
acc: 0.727700
AUC: 0.906952
Avg Precision: 0.495422
Avg Recall: 1.000000
d_prime: 1.869898
train_loss: 0.046045
valid_loss: 1.332081
validation finished
normal learning rate scheduler step
Epoch-30 lr: 7.027270984333012e-06
Epoch-30 lr: 7.027270984333012e-06
epoch 30 training time: 15.224
---------------
2023-09-24 20:27:19.070352
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00673	Per Sample Data Time 0.00115	Per Sample DNN Time 0.00558	Train Loss 0.0570	
start validation
acc: 0.727700
AUC: 0.906910
Avg Precision: 0.495422
Avg Recall: 1.000000
d_prime: 1.869542
train_loss: 0.061913
valid_loss: 1.331777
validation finished
normal learning rate scheduler step
Epoch-31 lr: 5.13792935543858e-06
Epoch-31 lr: 5.13792935543858e-06
epoch 31 training time: 15.175
---------------
2023-09-24 20:27:34.245387
current #epochs=32, #steps=1209
start validation
acc: 0.727700
AUC: 0.906770
Avg Precision: 0.495216
Avg Recall: 1.000000
d_prime: 1.868354
train_loss: 0.037395
valid_loss: 1.331697
validation finished
normal learning rate scheduler step
Epoch-32 lr: 5.13792935543858e-06
Epoch-32 lr: 5.13792935543858e-06
epoch 32 training time: 15.154
---------------
2023-09-24 20:27:49.399566
current #epochs=33, #steps=1248
start validation
acc: 0.723005
AUC: 0.907094
Avg Precision: 0.486590
Avg Recall: 1.000000
d_prime: 1.871107
train_loss: 0.050799
valid_loss: 1.331394
validation finished
normal learning rate scheduler step
Epoch-33 lr: 3.7565533078675035e-06
Epoch-33 lr: 3.7565533078675035e-06
epoch 33 training time: 15.290
---------------
2023-09-24 20:28:04.689073
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00799	Per Sample Data Time 0.00234	Per Sample DNN Time 0.00565	Train Loss 0.0460	
start validation
acc: 0.723005
AUC: 0.907313
Avg Precision: 0.486955
Avg Recall: 1.000000
d_prime: 1.872965
train_loss: 0.050886
valid_loss: 1.331359
validation finished
normal learning rate scheduler step
Epoch-34 lr: 3.7565533078675035e-06
Epoch-34 lr: 3.7565533078675035e-06
epoch 34 training time: 15.272
---------------
2023-09-24 20:28:19.960674
current #epochs=35, #steps=1326
start validation
acc: 0.727700
AUC: 0.907324
Avg Precision: 0.486955
Avg Recall: 1.000000
d_prime: 1.873062
train_loss: 0.040970
valid_loss: 1.331184
validation finished
normal learning rate scheduler step
Epoch-35 lr: 2.746571970654449e-06
Epoch-35 lr: 2.746571970654449e-06
epoch 35 training time: 15.167
---------------
2023-09-24 20:28:35.127261
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00660	Per Sample Data Time 0.00100	Per Sample DNN Time 0.00560	Train Loss 0.0464	
start validation
acc: 0.727700
AUC: 0.907376
Avg Precision: 0.486955
Avg Recall: 1.000000
d_prime: 1.873508
train_loss: 0.046278
valid_loss: 1.331018
validation finished
normal learning rate scheduler step
Epoch-36 lr: 2.746571970654449e-06
Epoch-36 lr: 2.746571970654449e-06
epoch 36 training time: 15.256
---------------
2023-09-24 20:28:50.383469
current #epochs=37, #steps=1404
start validation
acc: 0.737089
AUC: 0.907305
Avg Precision: 0.486955
Avg Recall: 1.000000
d_prime: 1.872896
train_loss: 0.044998
valid_loss: 1.330960
validation finished
normal learning rate scheduler step
Epoch-37 lr: 2.008132714152005e-06
Epoch-37 lr: 2.008132714152005e-06
epoch 37 training time: 15.172
---------------
2023-09-24 20:29:05.555588
current #epochs=38, #steps=1443
start validation
acc: 0.737089
AUC: 0.907241
Avg Precision: 0.486955
Avg Recall: 1.000000
d_prime: 1.872357
train_loss: 0.056704
valid_loss: 1.330953
validation finished
normal learning rate scheduler step
Epoch-38 lr: 2.008132714152005e-06
Epoch-38 lr: 2.008132714152005e-06
epoch 38 training time: 15.169
---------------
2023-09-24 20:29:20.725085
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00738	Per Sample Data Time 0.00168	Per Sample DNN Time 0.00570	Train Loss 0.0706	
start validation
acc: 0.727700
AUC: 0.907255
Avg Precision: 0.487124
Avg Recall: 1.000000
d_prime: 1.872477
train_loss: 0.061292
valid_loss: 1.331048
validation finished
normal learning rate scheduler step
Epoch-39 lr: 1.468229138261619e-06
Epoch-39 lr: 1.468229138261619e-06
epoch 39 training time: 15.200
---------------
2023-09-24 20:29:35.924942
current #epochs=40, #steps=1521
start validation
acc: 0.727700
AUC: 0.907297
Avg Precision: 0.487499
Avg Recall: 1.000000
d_prime: 1.872834
train_loss: 0.053667
valid_loss: 1.331083
validation finished
normal learning rate scheduler step
Epoch-40 lr: 1.468229138261619e-06
Epoch-40 lr: 1.468229138261619e-06
epoch 40 training time: 15.357
---------------
2023-09-24 20:29:51.281913
current #epochs=41, #steps=1560
start validation
acc: 0.727700
AUC: 0.907286
Avg Precision: 0.486754
Avg Recall: 1.000000
d_prime: 1.872742
train_loss: 0.046067
valid_loss: 1.331085
validation finished
normal learning rate scheduler step
Epoch-41 lr: 1.073483235071326e-06
Epoch-41 lr: 1.073483235071326e-06
epoch 41 training time: 15.255
---------------
2023-09-24 20:30:06.537468
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02193	Per Sample Data Time 0.01504	Per Sample DNN Time 0.00689	Train Loss 0.0704	
start validation
acc: 0.727700
AUC: 0.907378
Avg Precision: 0.486754
Avg Recall: 1.000000
d_prime: 1.873525
train_loss: 0.039025
valid_loss: 1.331126
validation finished
normal learning rate scheduler step
Epoch-42 lr: 1.073483235071326e-06
Epoch-42 lr: 1.073483235071326e-06
epoch 42 training time: 15.210
---------------
2023-09-24 20:30:21.747780
current #epochs=43, #steps=1638
start validation
[I 2023-09-24 20:30:38,004] Trial 67 finished with value: 0.48695484566301667 and parameters: {'warmup': 'True', 'num_epochs': 43, 'batch_size': 48, 'lr-adaptschedule': 'True', 'lr': 0.0004118775710865611, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.7311414867725131}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.727700
AUC: 0.907493
Avg Precision: 0.486955
Avg Recall: 1.000000
d_prime: 1.874502
train_loss: 0.051336
valid_loss: 1.331141
validation finished
normal learning rate scheduler step
Epoch-43 lr: 7.848681285154165e-07
Epoch-43 lr: 7.848681285154165e-07
epoch 43 training time: 16.243
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa63ceaea60>
The learning rate scheduler starts at 6 epoch with decay rate of 0.743 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 20:30:38.042696
current #epochs=1, #steps=0
start validation
acc: 0.694836
AUC: 0.865888
Avg Precision: 0.455322
Avg Recall: 1.000000
d_prime: 1.565762
train_loss: 0.082189
valid_loss: 1.357766
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0012894385349074035
Epoch-1 lr: 0.0012894385349074035
epoch 1 training time: 17.650
---------------
2023-09-24 20:30:55.693058
current #epochs=2, #steps=39
start validation
acc: 0.737089
AUC: 0.894879
Avg Precision: 0.470676
Avg Recall: 1.000000
d_prime: 1.771872
train_loss: 0.091559
valid_loss: 1.336545
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0012894385349074035
Epoch-2 lr: 0.0012894385349074035
epoch 2 training time: 17.803
---------------
2023-09-24 20:31:13.495526
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00703	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00559	Train Loss 0.0938	
start validation
acc: 0.741784
AUC: 0.911857
Avg Precision: 0.489217
Avg Recall: 1.000000
d_prime: 1.912410
train_loss: 0.092340
valid_loss: 1.325209
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0012894385349074035
Epoch-3 lr: 0.0012894385349074035
epoch 3 training time: 17.693
---------------
2023-09-24 20:31:31.188110
current #epochs=4, #steps=117
start validation
acc: 0.694836
AUC: 0.887106
Avg Precision: 0.429965
Avg Recall: 1.000000
d_prime: 1.713006
train_loss: 0.095393
valid_loss: 1.359699
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0012894385349074035
Epoch-4 lr: 0.0012894385349074035
epoch 4 training time: 15.252
---------------
2023-09-24 20:31:46.440399
current #epochs=5, #steps=156
start validation
acc: 0.727700
AUC: 0.897101
Avg Precision: 0.491207
Avg Recall: 1.000000
d_prime: 1.789271
train_loss: 0.074120
valid_loss: 1.337805
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0012894385349074035
Epoch-5 lr: 0.0012894385349074035
epoch 5 training time: 15.218
---------------
2023-09-24 20:32:01.658209
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01119	Per Sample Data Time 0.00544	Per Sample DNN Time 0.00575	Train Loss 0.0847	
start validation
acc: 0.718310
AUC: 0.899267
Avg Precision: 0.483666
Avg Recall: 1.000000
d_prime: 1.806501
train_loss: 0.060410
valid_loss: 1.339859
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0009582729946864679
Epoch-6 lr: 0.0009582729946864679
epoch 6 training time: 15.255
---------------
2023-09-24 20:32:16.913121
current #epochs=7, #steps=234
start validation
acc: 0.732394
AUC: 0.898474
Avg Precision: 0.471012
Avg Recall: 1.000000
d_prime: 1.800159
train_loss: 0.066259
valid_loss: 1.337266
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0007121604539384384
Epoch-7 lr: 0.0007121604539384384
epoch 7 training time: 15.310
---------------
2023-09-24 20:32:32.223341
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00685	Per Sample Data Time 0.00127	Per Sample DNN Time 0.00558	Train Loss 0.0600	
start validation
acc: 0.746479
AUC: 0.905967
Avg Precision: 0.478032
Avg Recall: 1.000000
d_prime: 1.861563
train_loss: 0.060420
valid_loss: 1.331226
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.000529256814045711
Epoch-8 lr: 0.000529256814045711
epoch 8 training time: 17.745
---------------
2023-09-24 20:32:49.967833
current #epochs=9, #steps=312
start validation
acc: 0.769953
AUC: 0.908555
Avg Precision: 0.479576
Avg Recall: 1.000000
d_prime: 1.883606
train_loss: 0.056605
valid_loss: 1.318865
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0003933281799975238
Epoch-9 lr: 0.0003933281799975238
epoch 9 training time: 17.669
---------------
2023-09-24 20:33:07.636802
current #epochs=10, #steps=351
start validation
acc: 0.737089
AUC: 0.909879
Avg Precision: 0.506724
Avg Recall: 1.000000
d_prime: 1.895060
train_loss: 0.058614
valid_loss: 1.322962
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00029230999596880524
Epoch-10 lr: 0.00029230999596880524
epoch 10 training time: 15.312
---------------
2023-09-24 20:33:22.948134
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00872	Per Sample Data Time 0.00297	Per Sample DNN Time 0.00575	Train Loss 0.0763	
start validation
acc: 0.751174
AUC: 0.906835
Avg Precision: 0.494173
Avg Recall: 1.000000
d_prime: 1.868902
train_loss: 0.054336
valid_loss: 1.320545
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.000217236237037023
Epoch-11 lr: 0.000217236237037023
epoch 11 training time: 15.193
---------------
2023-09-24 20:33:38.140881
current #epochs=12, #steps=429
start validation
acc: 0.755869
AUC: 0.909264
Avg Precision: 0.484661
Avg Recall: 1.000000
d_prime: 1.889727
train_loss: 0.055684
valid_loss: 1.315794
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00016144361579424686
Epoch-12 lr: 0.00016144361579424686
epoch 12 training time: 15.292
---------------
2023-09-24 20:33:53.432975
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00674	Per Sample Data Time 0.00113	Per Sample DNN Time 0.00560	Train Loss 0.0454	
start validation
acc: 0.755869
AUC: 0.910062
Avg Precision: 0.484970
Avg Recall: 1.000000
d_prime: 1.896650
train_loss: 0.044975
valid_loss: 1.314865
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00011998017198336192
Epoch-13 lr: 0.00011998017198336192
epoch 13 training time: 15.937
---------------
2023-09-24 20:34:09.370396
current #epochs=14, #steps=507
start validation
acc: 0.755869
AUC: 0.908246
Avg Precision: 0.485275
Avg Recall: 1.000000
d_prime: 1.880950
train_loss: 0.052921
valid_loss: 1.318675
validation finished
normal learning rate scheduler step
Epoch-14 lr: 8.916575361829878e-05
Epoch-14 lr: 8.916575361829878e-05
epoch 14 training time: 15.167
---------------
2023-09-24 20:34:24.537141
current #epochs=15, #steps=546
start validation
acc: 0.751174
AUC: 0.907243
Avg Precision: 0.484007
Avg Recall: 1.000000
d_prime: 1.872371
train_loss: 0.060073
valid_loss: 1.319701
validation finished
normal learning rate scheduler step
Epoch-15 lr: 6.626537941137216e-05
Epoch-15 lr: 6.626537941137216e-05
epoch 15 training time: 15.134
---------------
2023-09-24 20:34:39.671829
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00761	Per Sample Data Time 0.00193	Per Sample DNN Time 0.00568	Train Loss 0.0775	
start validation
acc: 0.751174
AUC: 0.907467
Avg Precision: 0.483817
Avg Recall: 1.000000
d_prime: 1.874282
train_loss: 0.076979
valid_loss: 1.320114
validation finished
normal learning rate scheduler step
Epoch-16 lr: 4.924649128555062e-05
Epoch-16 lr: 4.924649128555062e-05
epoch 16 training time: 16.432
---------------
2023-09-24 20:34:56.103467
current #epochs=17, #steps=624
start validation
acc: 0.751174
AUC: 0.907513
Avg Precision: 0.483816
Avg Recall: 1.000000
d_prime: 1.874671
train_loss: 0.052394
valid_loss: 1.318152
validation finished
normal learning rate scheduler step
Epoch-17 lr: 3.659855154351699e-05
Epoch-17 lr: 3.659855154351699e-05
epoch 17 training time: 15.811
---------------
2023-09-24 20:35:11.914523
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00651	Per Sample Data Time 0.00096	Per Sample DNN Time 0.00556	Train Loss 0.0578	
start validation
acc: 0.751174
AUC: 0.907309
Avg Precision: 0.483863
Avg Recall: 1.000000
d_prime: 1.872934
train_loss: 0.057067
valid_loss: 1.318562
validation finished
normal learning rate scheduler step
Epoch-18 lr: 2.719897276166918e-05
Epoch-18 lr: 2.719897276166918e-05
epoch 18 training time: 15.308
---------------
2023-09-24 20:35:27.222772
current #epochs=19, #steps=702
start validation
acc: 0.755869
AUC: 0.907709
Avg Precision: 0.483817
Avg Recall: 1.000000
d_prime: 1.876349
train_loss: 0.050800
valid_loss: 1.318272
validation finished
normal learning rate scheduler step
Epoch-19 lr: 2.0213480809763525e-05
Epoch-19 lr: 2.0213480809763525e-05
epoch 19 training time: 15.311
---------------
2023-09-24 20:35:42.533530
current #epochs=20, #steps=741
start validation
acc: 0.755869
AUC: 0.907518
Avg Precision: 0.483817
Avg Recall: 1.000000
d_prime: 1.874720
train_loss: 0.040657
valid_loss: 1.318324
validation finished
normal learning rate scheduler step
Epoch-20 lr: 1.502206756214288e-05
Epoch-20 lr: 1.502206756214288e-05
epoch 20 training time: 15.237
---------------
2023-09-24 20:35:57.770828
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00164	Per Sample DNN Time 0.00557	Train Loss 0.0361	
start validation
acc: 0.751174
AUC: 0.907404
Avg Precision: 0.483817
Avg Recall: 1.000000
d_prime: 1.873740
train_loss: 0.045736
valid_loss: 1.318451
validation finished
normal learning rate scheduler step
Epoch-21 lr: 1.116396111908572e-05
Epoch-21 lr: 1.116396111908572e-05
epoch 21 training time: 15.164
---------------
2023-09-24 20:36:12.935057
current #epochs=22, #steps=819
start validation
acc: 0.751174
AUC: 0.907530
Avg Precision: 0.483817
Avg Recall: 1.000000
d_prime: 1.874821
train_loss: 0.047924
valid_loss: 1.318549
validation finished
normal learning rate scheduler step
Epoch-22 lr: 8.296729285291456e-06
Epoch-22 lr: 8.296729285291456e-06
epoch 22 training time: 15.202
---------------
2023-09-24 20:36:28.136973
current #epochs=23, #steps=858
start validation
acc: 0.755869
AUC: 0.907329
Avg Precision: 0.483634
Avg Recall: 1.000000
d_prime: 1.873103
train_loss: 0.053293
valid_loss: 1.318665
validation finished
normal learning rate scheduler step
Epoch-23 lr: 6.165886471579743e-06
Epoch-23 lr: 6.165886471579743e-06
epoch 23 training time: 15.308
---------------
2023-09-24 20:36:43.444579
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01394	Per Sample Data Time 0.00765	Per Sample DNN Time 0.00629	Train Loss 0.0224	
start validation
acc: 0.755869
AUC: 0.907278
Avg Precision: 0.483634
Avg Recall: 1.000000
d_prime: 1.872671
train_loss: 0.065578
valid_loss: 1.318875
validation finished
normal learning rate scheduler step
Epoch-24 lr: 4.582306433429031e-06
Epoch-24 lr: 4.582306433429031e-06
epoch 24 training time: 15.250
---------------
2023-09-24 20:36:58.694734
current #epochs=25, #steps=936
start validation
acc: 0.755869
AUC: 0.907283
Avg Precision: 0.483634
Avg Recall: 1.000000
d_prime: 1.872714
train_loss: 0.050325
valid_loss: 1.318951
validation finished
normal learning rate scheduler step
Epoch-25 lr: 3.4054360790826193e-06
Epoch-25 lr: 3.4054360790826193e-06
epoch 25 training time: 15.680
---------------
2023-09-24 20:37:14.374332
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00694	Per Sample Data Time 0.00134	Per Sample DNN Time 0.00560	Train Loss 0.0547	
start validation
acc: 0.755869
AUC: 0.907318
Avg Precision: 0.483634
Avg Recall: 1.000000
d_prime: 1.873007
train_loss: 0.073770
valid_loss: 1.318984
validation finished
normal learning rate scheduler step
Epoch-26 lr: 2.530820462838262e-06
Epoch-26 lr: 2.530820462838262e-06
epoch 26 training time: 15.323
---------------
2023-09-24 20:37:29.697813
current #epochs=27, #steps=1014
start validation
acc: 0.755869
AUC: 0.907327
Avg Precision: 0.483634
Avg Recall: 1.000000
d_prime: 1.873088
train_loss: 0.054710
valid_loss: 1.319040
validation finished
normal learning rate scheduler step
Epoch-27 lr: 1.880831725036023e-06
Epoch-27 lr: 1.880831725036023e-06
epoch 27 training time: 15.677
---------------
2023-09-24 20:37:45.375551
current #epochs=28, #steps=1053
start validation
acc: 0.755869
AUC: 0.907324
Avg Precision: 0.483634
Avg Recall: 1.000000
d_prime: 1.873059
train_loss: 0.068631
valid_loss: 1.319074
validation finished
normal learning rate scheduler step
Epoch-28 lr: 1.3977791114960084e-06
Epoch-28 lr: 1.3977791114960084e-06
epoch 28 training time: 16.956
---------------
2023-09-24 20:38:02.331362
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00933	Per Sample Data Time 0.00345	Per Sample DNN Time 0.00588	Train Loss 0.0501	
start validation
acc: 0.755869
AUC: 0.907339
Avg Precision: 0.483634
Avg Recall: 1.000000
d_prime: 1.873186
train_loss: 0.073257
valid_loss: 1.319114
validation finished
normal learning rate scheduler step
Epoch-29 lr: 1.0387885415411898e-06
Epoch-29 lr: 1.0387885415411898e-06
epoch 29 training time: 15.337
---------------
2023-09-24 20:38:17.668588
current #epochs=30, #steps=1131
start validation
acc: 0.755869
AUC: 0.907395
Avg Precision: 0.483634
Avg Recall: 1.000000
d_prime: 1.873671
train_loss: 0.049999
valid_loss: 1.319122
validation finished
normal learning rate scheduler step
Epoch-30 lr: 7.719972527578824e-07
Epoch-30 lr: 7.719972527578824e-07
epoch 30 training time: 15.259
---------------
2023-09-24 20:38:32.927212
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00672	Per Sample Data Time 0.00113	Per Sample DNN Time 0.00559	Train Loss 0.0464	
start validation
acc: 0.755869
AUC: 0.907374
Avg Precision: 0.483634
Avg Recall: 1.000000
d_prime: 1.873489
train_loss: 0.051469
valid_loss: 1.319112
validation finished
normal learning rate scheduler step
Epoch-31 lr: 5.737257723130999e-07
Epoch-31 lr: 5.737257723130999e-07
epoch 31 training time: 15.319
---------------
2023-09-24 20:38:48.246496
current #epochs=32, #steps=1209
start validation
[I 2023-09-24 20:39:03,522] Trial 68 finished with value: 0.48349412702584676 and parameters: {'warmup': 'True', 'num_epochs': 32, 'batch_size': 51, 'lr-adaptschedule': 'True', 'lr': 0.0012894385349074035, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7431707435013821}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.755869
AUC: 0.907317
Avg Precision: 0.483494
Avg Recall: 1.000000
d_prime: 1.873004
train_loss: 0.047606
valid_loss: 1.319120
validation finished
normal learning rate scheduler step
Epoch-32 lr: 4.2637620877583114e-07
Epoch-32 lr: 4.2637620877583114e-07
epoch 32 training time: 15.265
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa6015c4400>
The learning rate scheduler starts at 7 epoch with decay rate of 0.761 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 20:39:03.560211
current #epochs=1, #steps=0
start validation
acc: 0.713615
AUC: 0.909678
Avg Precision: 0.491767
Avg Recall: 1.000000
d_prime: 1.893317
train_loss: 0.081784
valid_loss: 1.323012
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0009165004502615112
Epoch-1 lr: 0.0018330009005230225
epoch 1 training time: 17.815
---------------
2023-09-24 20:39:21.375524
current #epochs=2, #steps=39
start validation
acc: 0.732394
AUC: 0.897928
Avg Precision: 0.437768
Avg Recall: 1.000000
d_prime: 1.795818
train_loss: 0.067740
valid_loss: 1.325274
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0009165004502615112
Epoch-2 lr: 0.0018330009005230225
epoch 2 training time: 17.790
---------------
2023-09-24 20:39:39.165339
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00564	Train Loss 0.0619	
start validation
acc: 0.732394
AUC: 0.894920
Avg Precision: 0.446507
Avg Recall: 1.000000
d_prime: 1.772183
train_loss: 0.069582
valid_loss: 1.330889
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0009165004502615112
Epoch-3 lr: 0.0018330009005230225
epoch 3 training time: 15.288
---------------
2023-09-24 20:39:54.453079
current #epochs=4, #steps=117
start validation
acc: 0.699531
AUC: 0.894668
Avg Precision: 0.455194
Avg Recall: 1.000000
d_prime: 1.770232
train_loss: 0.088560
valid_loss: 1.338944
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0009165004502615112
Epoch-4 lr: 0.0018330009005230225
epoch 4 training time: 15.174
---------------
2023-09-24 20:40:09.627818
current #epochs=5, #steps=156
start validation
acc: 0.727700
AUC: 0.899110
Avg Precision: 0.459397
Avg Recall: 1.000000
d_prime: 1.805235
train_loss: 0.071208
valid_loss: 1.327424
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0009165004502615112
Epoch-5 lr: 0.0018330009005230225
epoch 5 training time: 15.284
---------------
2023-09-24 20:40:24.911842
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01132	Per Sample Data Time 0.00514	Per Sample DNN Time 0.00618	Train Loss 0.0483	
start validation
acc: 0.732394
AUC: 0.898826
Avg Precision: 0.446344
Avg Recall: 1.000000
d_prime: 1.802969
train_loss: 0.065813
valid_loss: 1.341249
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0009165004502615112
Epoch-6 lr: 0.0018330009005230225
epoch 6 training time: 16.250
---------------
2023-09-24 20:40:41.162014
current #epochs=7, #steps=234
start validation
acc: 0.737089
AUC: 0.906119
Avg Precision: 0.448280
Avg Recall: 1.000000
d_prime: 1.862846
train_loss: 0.089400
valid_loss: 1.334855
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0006976515800579658
Epoch-7 lr: 0.0013953031601159317
epoch 7 training time: 18.369
---------------
2023-09-24 20:40:59.530702
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00685	Per Sample Data Time 0.00121	Per Sample DNN Time 0.00565	Train Loss 0.0735	
start validation
acc: 0.751174
AUC: 0.907165
Avg Precision: 0.466772
Avg Recall: 1.000000
d_prime: 1.871710
train_loss: 0.074702
valid_loss: 1.308520
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0006976515800579658
Epoch-8 lr: 0.0013953031601159317
epoch 8 training time: 17.730
---------------
2023-09-24 20:41:17.260792
current #epochs=9, #steps=312
start validation
acc: 0.708920
AUC: 0.892782
Avg Precision: 0.461648
Avg Recall: 1.000000
d_prime: 1.755691
train_loss: 0.073079
valid_loss: 1.340363
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0005310610889700031
Epoch-9 lr: 0.0010621221779400062
epoch 9 training time: 15.281
---------------
2023-09-24 20:41:32.542274
current #epochs=10, #steps=351
start validation
acc: 0.713615
AUC: 0.888706
Avg Precision: 0.455186
Avg Recall: 1.000000
d_prime: 1.724883
train_loss: 0.081621
valid_loss: 1.349861
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0005310610889700031
Epoch-10 lr: 0.0010621221779400062
epoch 10 training time: 15.185
---------------
2023-09-24 20:41:47.727414
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00875	Per Sample Data Time 0.00293	Per Sample DNN Time 0.00581	Train Loss 0.0670	
start validation
acc: 0.690141
AUC: 0.897726
Avg Precision: 0.467042
Avg Recall: 1.000000
d_prime: 1.794217
train_loss: 0.065644
valid_loss: 1.341308
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00040425032821479864
Epoch-11 lr: 0.0008085006564295973
epoch 11 training time: 16.904
---------------
2023-09-24 20:42:04.631299
current #epochs=12, #steps=429
start validation
acc: 0.727700
AUC: 0.901377
Avg Precision: 0.466529
Avg Recall: 1.000000
d_prime: 1.823538
train_loss: 0.054771
valid_loss: 1.329724
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00040425032821479864
Epoch-12 lr: 0.0008085006564295973
epoch 12 training time: 15.319
---------------
2023-09-24 20:42:19.950873
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00664	Per Sample Data Time 0.00105	Per Sample DNN Time 0.00559	Train Loss 0.0480	
start validation
acc: 0.732394
AUC: 0.903582
Avg Precision: 0.470576
Avg Recall: 1.000000
d_prime: 1.841638
train_loss: 0.053491
valid_loss: 1.333692
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00030772039461359044
Epoch-13 lr: 0.0006154407892271809
epoch 13 training time: 16.786
---------------
2023-09-24 20:42:36.736650
current #epochs=14, #steps=507
start validation
acc: 0.708920
AUC: 0.903720
Avg Precision: 0.471578
Avg Recall: 1.000000
d_prime: 1.842779
train_loss: 0.051792
valid_loss: 1.322511
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.00030772039461359044
Epoch-14 lr: 0.0006154407892271809
epoch 14 training time: 15.370
---------------
2023-09-24 20:42:52.106454
current #epochs=15, #steps=546
start validation
acc: 0.699531
AUC: 0.901380
Avg Precision: 0.466735
Avg Recall: 1.000000
d_prime: 1.823566
train_loss: 0.058255
valid_loss: 1.328732
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.00023424060452668143
Epoch-15 lr: 0.00046848120905336287
epoch 15 training time: 15.155
---------------
2023-09-24 20:43:07.261938
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00779	Per Sample Data Time 0.00209	Per Sample DNN Time 0.00570	Train Loss 0.0513	
start validation
acc: 0.718310
AUC: 0.902641
Avg Precision: 0.467430
Avg Recall: 1.000000
d_prime: 1.833877
train_loss: 0.045833
valid_loss: 1.328345
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.00023424060452668143
Epoch-16 lr: 0.00046848120905336287
epoch 16 training time: 15.416
---------------
2023-09-24 20:43:22.678593
current #epochs=17, #steps=624
start validation
acc: 0.727700
AUC: 0.900231
Avg Precision: 0.462255
Avg Recall: 1.000000
d_prime: 1.814248
train_loss: 0.060117
valid_loss: 1.328531
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.00017830687133338902
Epoch-17 lr: 0.00035661374266677805
epoch 17 training time: 15.196
---------------
2023-09-24 20:43:37.874054
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00655	Per Sample Data Time 0.00098	Per Sample DNN Time 0.00557	Train Loss 0.0546	
start validation
acc: 0.723005
AUC: 0.901787
Avg Precision: 0.462589
Avg Recall: 1.000000
d_prime: 1.826879
train_loss: 0.054438
valid_loss: 1.330921
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00017830687133338902
Epoch-18 lr: 0.00035661374266677805
epoch 18 training time: 15.291
---------------
2023-09-24 20:43:53.164767
current #epochs=19, #steps=702
start validation
acc: 0.713615
AUC: 0.903631
Avg Precision: 0.463655
Avg Recall: 1.000000
d_prime: 1.842045
train_loss: 0.063107
valid_loss: 1.327507
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00013572941561069228
Epoch-19 lr: 0.00027145883122138456
epoch 19 training time: 16.092
---------------
2023-09-24 20:44:09.256811
current #epochs=20, #steps=741
start validation
acc: 0.704225
AUC: 0.905024
Avg Precision: 0.463728
Avg Recall: 1.000000
d_prime: 1.853643
train_loss: 0.060368
valid_loss: 1.323713
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00013572941561069228
Epoch-20 lr: 0.00027145883122138456
epoch 20 training time: 15.531
---------------
2023-09-24 20:44:24.787413
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00738	Per Sample Data Time 0.00164	Per Sample DNN Time 0.00574	Train Loss 0.0377	
start validation
acc: 0.718310
AUC: 0.903560
Avg Precision: 0.465255
Avg Recall: 1.000000
d_prime: 1.841457
train_loss: 0.048306
valid_loss: 1.323191
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00010331892497611402
Epoch-21 lr: 0.00020663784995222803
epoch 21 training time: 15.409
---------------
2023-09-24 20:44:40.196244
current #epochs=22, #steps=819
start validation
acc: 0.718310
AUC: 0.902677
Avg Precision: 0.466442
Avg Recall: 1.000000
d_prime: 1.834178
train_loss: 0.048927
valid_loss: 1.330393
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00010331892497611402
Epoch-22 lr: 0.00020663784995222803
epoch 22 training time: 15.180
---------------
2023-09-24 20:44:55.376111
current #epochs=23, #steps=858
start validation
acc: 0.713615
AUC: 0.902773
Avg Precision: 0.465504
Avg Recall: 1.000000
d_prime: 1.834963
train_loss: 0.054075
valid_loss: 1.333095
validation finished
normal learning rate scheduler step
Epoch-23 lr: 7.864765504360541e-05
Epoch-23 lr: 0.00015729531008721082
epoch 23 training time: 15.349
---------------
2023-09-24 20:45:10.724899
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01364	Per Sample Data Time 0.00749	Per Sample DNN Time 0.00615	Train Loss 0.0552	
start validation
acc: 0.718310
AUC: 0.902159
Avg Precision: 0.464065
Avg Recall: 1.000000
d_prime: 1.829924
train_loss: 0.047285
valid_loss: 1.329110
validation finished
normal learning rate scheduler step
Epoch-24 lr: 7.864765504360541e-05
Epoch-24 lr: 0.00015729531008721082
epoch 24 training time: 15.136
---------------
2023-09-24 20:45:25.861282
current #epochs=25, #steps=936
start validation
acc: 0.718310
AUC: 0.902370
Avg Precision: 0.463590
Avg Recall: 1.000000
d_prime: 1.831652
train_loss: 0.055524
valid_loss: 1.327679
validation finished
normal learning rate scheduler step
Epoch-25 lr: 5.986757648986328e-05
Epoch-25 lr: 0.00011973515297972656
epoch 25 training time: 15.310
---------------
2023-09-24 20:45:41.171207
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00690	Per Sample Data Time 0.00132	Per Sample DNN Time 0.00558	Train Loss 0.0495	
start validation
acc: 0.723005
AUC: 0.903505
Avg Precision: 0.464032
Avg Recall: 1.000000
d_prime: 1.840998
train_loss: 0.053828
valid_loss: 1.323212
validation finished
normal learning rate scheduler step
Epoch-26 lr: 5.986757648986328e-05
Epoch-26 lr: 0.00011973515297972656
epoch 26 training time: 15.623
---------------
2023-09-24 20:45:56.793684
current #epochs=27, #steps=1014
start validation
acc: 0.723005
AUC: 0.904216
Avg Precision: 0.465433
Avg Recall: 1.000000
d_prime: 1.846896
train_loss: 0.040651
valid_loss: 1.320870
validation finished
normal learning rate scheduler step
Epoch-27 lr: 4.5571946331806674e-05
Epoch-27 lr: 9.114389266361335e-05
epoch 27 training time: 15.215
---------------
2023-09-24 20:46:12.009067
current #epochs=28, #steps=1053
start validation
acc: 0.718310
AUC: 0.903799
Avg Precision: 0.466256
Avg Recall: 1.000000
d_prime: 1.843438
train_loss: 0.047955
valid_loss: 1.323594
validation finished
normal learning rate scheduler step
Epoch-28 lr: 4.5571946331806674e-05
Epoch-28 lr: 9.114389266361335e-05
epoch 28 training time: 15.311
---------------
2023-09-24 20:46:27.319837
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00947	Per Sample Data Time 0.00367	Per Sample DNN Time 0.00580	Train Loss 0.0366	
start validation
acc: 0.718310
AUC: 0.903466
Avg Precision: 0.465475
Avg Recall: 1.000000
d_prime: 1.840681
train_loss: 0.066786
valid_loss: 1.322850
validation finished
normal learning rate scheduler step
Epoch-29 lr: 3.4689934255493205e-05
Epoch-29 lr: 6.937986851098641e-05
epoch 29 training time: 15.278
---------------
2023-09-24 20:46:42.598222
current #epochs=30, #steps=1131
start validation
acc: 0.718310
AUC: 0.903872
Avg Precision: 0.465403
Avg Recall: 1.000000
d_prime: 1.844043
train_loss: 0.068970
valid_loss: 1.323230
validation finished
normal learning rate scheduler step
Epoch-30 lr: 3.4689934255493205e-05
Epoch-30 lr: 6.937986851098641e-05
epoch 30 training time: 15.270
---------------
2023-09-24 20:46:57.869035
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00662	Per Sample Data Time 0.00110	Per Sample DNN Time 0.00553	Train Loss 0.0409	
start validation
acc: 0.718310
AUC: 0.903949
Avg Precision: 0.465337
Avg Recall: 1.000000
d_prime: 1.844676
train_loss: 0.039194
valid_loss: 1.324112
validation finished
normal learning rate scheduler step
Epoch-31 lr: 2.6406410862696483e-05
Epoch-31 lr: 5.2812821725392966e-05
epoch 31 training time: 15.173
---------------
2023-09-24 20:47:13.041634
current #epochs=32, #steps=1209
start validation
acc: 0.718310
AUC: 0.904040
Avg Precision: 0.465620
Avg Recall: 1.000000
d_prime: 1.845437
train_loss: 0.038306
valid_loss: 1.324815
validation finished
normal learning rate scheduler step
Epoch-32 lr: 2.6406410862696483e-05
Epoch-32 lr: 5.2812821725392966e-05
epoch 32 training time: 15.281
---------------
2023-09-24 20:47:28.322100
current #epochs=33, #steps=1248
start validation
acc: 0.708920
AUC: 0.904354
Avg Precision: 0.465620
Avg Recall: 1.000000
d_prime: 1.848047
train_loss: 0.060443
valid_loss: 1.325056
validation finished
normal learning rate scheduler step
Epoch-33 lr: 2.0100889483211303e-05
Epoch-33 lr: 4.0201778966422605e-05
epoch 33 training time: 15.270
---------------
2023-09-24 20:47:43.592383
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00800	Per Sample Data Time 0.00232	Per Sample DNN Time 0.00568	Train Loss 0.0314	
start validation
[I 2023-09-24 20:47:58,781] Trial 69 finished with value: 0.46600091204093835 and parameters: {'warmup': 'True', 'num_epochs': 34, 'batch_size': 61, 'lr-adaptschedule': 'True', 'lr': 0.0009165004502615112, 'head-lr': 2, 'lr-scheduler-start': 7, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.7612124793380082}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.708920
AUC: 0.904449
Avg Precision: 0.466001
Avg Recall: 1.000000
d_prime: 1.848840
train_loss: 0.039216
valid_loss: 1.325092
validation finished
normal learning rate scheduler step
Epoch-34 lr: 2.0100889483211303e-05
Epoch-34 lr: 4.0201778966422605e-05
epoch 34 training time: 15.176
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa609eb76d0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.795 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 20:47:58.818855
current #epochs=1, #steps=0
start validation
acc: 0.732394
AUC: 0.900060
Avg Precision: 0.477738
Avg Recall: 1.000000
d_prime: 1.812870
train_loss: 0.050705
valid_loss: 1.328299
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0006181311326576633
Epoch-1 lr: 0.0006181311326576633
epoch 1 training time: 17.770
---------------
2023-09-24 20:48:16.589038
current #epochs=2, #steps=39
start validation
acc: 0.741784
AUC: 0.908498
Avg Precision: 0.482828
Avg Recall: 1.000000
d_prime: 1.883112
train_loss: 0.052106
valid_loss: 1.322132
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0006181311326576633
Epoch-2 lr: 0.0006181311326576633
epoch 2 training time: 17.593
---------------
2023-09-24 20:48:34.182710
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00564	Train Loss 0.0558	
start validation
acc: 0.737089
AUC: 0.910090
Avg Precision: 0.481186
Avg Recall: 1.000000
d_prime: 1.896897
train_loss: 0.060394
valid_loss: 1.317125
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0006181311326576633
Epoch-3 lr: 0.0006181311326576633
epoch 3 training time: 15.315
---------------
2023-09-24 20:48:49.497077
current #epochs=4, #steps=117
start validation
acc: 0.713615
AUC: 0.891810
Avg Precision: 0.467837
Avg Recall: 1.000000
d_prime: 1.748266
train_loss: 0.061010
valid_loss: 1.343438
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0006181311326576633
Epoch-4 lr: 0.0006181311326576633
epoch 4 training time: 15.263
---------------
2023-09-24 20:49:04.760124
current #epochs=5, #steps=156
start validation
acc: 0.727700
AUC: 0.897081
Avg Precision: 0.457849
Avg Recall: 1.000000
d_prime: 1.789114
train_loss: 0.064027
valid_loss: 1.333380
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0006181311326576633
Epoch-5 lr: 0.0006181311326576633
epoch 5 training time: 15.294
---------------
2023-09-24 20:49:20.054420
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01143	Per Sample Data Time 0.00534	Per Sample DNN Time 0.00610	Train Loss 0.0500	
start validation
acc: 0.723005
AUC: 0.906159
Avg Precision: 0.472832
Avg Recall: 1.000000
d_prime: 1.863184
train_loss: 0.044619
valid_loss: 1.332766
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0004915568891803419
Epoch-6 lr: 0.0004915568891803419
epoch 6 training time: 15.334
---------------
2023-09-24 20:49:35.388412
current #epochs=7, #steps=234
start validation
acc: 0.718310
AUC: 0.892753
Avg Precision: 0.470286
Avg Recall: 1.000000
d_prime: 1.755467
train_loss: 0.081489
valid_loss: 1.328202
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00039090115759381216
Epoch-7 lr: 0.00039090115759381216
epoch 7 training time: 15.309
---------------
2023-09-24 20:49:50.697675
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00678	Per Sample Data Time 0.00121	Per Sample DNN Time 0.00556	Train Loss 0.0763	
start validation
acc: 0.718310
AUC: 0.898728
Avg Precision: 0.458833
Avg Recall: 1.000000
d_prime: 1.802189
train_loss: 0.075488
valid_loss: 1.321862
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0003108566238649987
Epoch-8 lr: 0.0003108566238649987
epoch 8 training time: 15.289
---------------
2023-09-24 20:50:05.986408
current #epochs=9, #steps=312
start validation
acc: 0.723005
AUC: 0.901488
Avg Precision: 0.465097
Avg Recall: 1.000000
d_prime: 1.824445
train_loss: 0.049440
valid_loss: 1.314699
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.000247202748632318
Epoch-9 lr: 0.000247202748632318
epoch 9 training time: 15.945
---------------
2023-09-24 20:50:21.931789
current #epochs=10, #steps=351
start validation
acc: 0.723005
AUC: 0.896072
Avg Precision: 0.459202
Avg Recall: 1.000000
d_prime: 1.781181
train_loss: 0.042727
valid_loss: 1.336671
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00019658322917999647
Epoch-10 lr: 0.00019658322917999647
epoch 10 training time: 15.272
---------------
2023-09-24 20:50:37.203755
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00879	Per Sample Data Time 0.00290	Per Sample DNN Time 0.00588	Train Loss 0.0774	
start validation
acc: 0.727700
AUC: 0.896027
Avg Precision: 0.460471
Avg Recall: 1.000000
d_prime: 1.780823
train_loss: 0.063666
valid_loss: 1.334205
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0001563290303552182
Epoch-11 lr: 0.0001563290303552182
epoch 11 training time: 15.170
---------------
2023-09-24 20:50:52.373761
current #epochs=12, #steps=429
start validation
acc: 0.718310
AUC: 0.895496
Avg Precision: 0.465853
Avg Recall: 1.000000
d_prime: 1.776677
train_loss: 0.039731
valid_loss: 1.334271
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0001243176533102221
Epoch-12 lr: 0.0001243176533102221
epoch 12 training time: 15.107
---------------
2023-09-24 20:51:07.481393
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00663	Per Sample Data Time 0.00106	Per Sample DNN Time 0.00557	Train Loss 0.0435	
start validation
acc: 0.718310
AUC: 0.895413
Avg Precision: 0.459828
Avg Recall: 1.000000
d_prime: 1.776025
train_loss: 0.041050
valid_loss: 1.332835
validation finished
normal learning rate scheduler step
Epoch-13 lr: 9.886122167740225e-05
Epoch-13 lr: 9.886122167740225e-05
epoch 13 training time: 15.219
---------------
2023-09-24 20:51:22.700378
current #epochs=14, #steps=507
start validation
acc: 0.723005
AUC: 0.894288
Avg Precision: 0.459154
Avg Recall: 1.000000
d_prime: 1.767282
train_loss: 0.052579
valid_loss: 1.331656
validation finished
normal learning rate scheduler step
Epoch-14 lr: 7.861748425350009e-05
Epoch-14 lr: 7.861748425350009e-05
epoch 14 training time: 15.382
---------------
2023-09-24 20:51:38.082220
current #epochs=15, #steps=546
start validation
acc: 0.732394
AUC: 0.892985
Avg Precision: 0.457882
Avg Recall: 1.000000
d_prime: 1.757245
train_loss: 0.060520
valid_loss: 1.333524
validation finished
normal learning rate scheduler step
Epoch-15 lr: 6.251904159669235e-05
Epoch-15 lr: 6.251904159669235e-05
epoch 15 training time: 15.330
---------------
2023-09-24 20:51:53.412594
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00779	Per Sample Data Time 0.00202	Per Sample DNN Time 0.00576	Train Loss 0.0672	
start validation
acc: 0.732394
AUC: 0.893597
Avg Precision: 0.460164
Avg Recall: 1.000000
d_prime: 1.761953
train_loss: 0.056211
valid_loss: 1.334994
validation finished
normal learning rate scheduler step
Epoch-16 lr: 4.971706483974567e-05
Epoch-16 lr: 4.971706483974567e-05
epoch 16 training time: 15.873
---------------
2023-09-24 20:52:09.285158
current #epochs=17, #steps=624
start validation
acc: 0.737089
AUC: 0.893577
Avg Precision: 0.459991
Avg Recall: 1.000000
d_prime: 1.761799
train_loss: 0.047487
valid_loss: 1.334106
validation finished
normal learning rate scheduler step
Epoch-17 lr: 3.953653915913913e-05
Epoch-17 lr: 3.953653915913913e-05
epoch 17 training time: 15.426
---------------
2023-09-24 20:52:24.711626
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00652	Per Sample Data Time 0.00094	Per Sample DNN Time 0.00558	Train Loss 0.0496	
start validation
acc: 0.737089
AUC: 0.893204
Avg Precision: 0.459715
Avg Recall: 1.000000
d_prime: 1.758929
train_loss: 0.049054
valid_loss: 1.334930
validation finished
normal learning rate scheduler step
Epoch-18 lr: 3.144067200508811e-05
Epoch-18 lr: 3.144067200508811e-05
epoch 18 training time: 16.451
---------------
2023-09-24 20:52:41.163417
current #epochs=19, #steps=702
start validation
acc: 0.732394
AUC: 0.893389
Avg Precision: 0.465266
Avg Recall: 1.000000
d_prime: 1.760347
train_loss: 0.042105
valid_loss: 1.334843
validation finished
normal learning rate scheduler step
Epoch-19 lr: 2.5002589431326822e-05
Epoch-19 lr: 2.5002589431326822e-05
epoch 19 training time: 15.210
---------------
2023-09-24 20:52:56.372889
current #epochs=20, #steps=741
start validation
acc: 0.732394
AUC: 0.893838
Avg Precision: 0.465571
Avg Recall: 1.000000
d_prime: 1.763811
train_loss: 0.047283
valid_loss: 1.334827
validation finished
normal learning rate scheduler step
Epoch-20 lr: 1.98828281459865e-05
Epoch-20 lr: 1.98828281459865e-05
epoch 20 training time: 15.249
---------------
2023-09-24 20:53:11.622037
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00726	Per Sample Data Time 0.00161	Per Sample DNN Time 0.00565	Train Loss 0.0657	
start validation
acc: 0.732394
AUC: 0.893844
Avg Precision: 0.465325
Avg Recall: 1.000000
d_prime: 1.763858
train_loss: 0.063234
valid_loss: 1.333833
validation finished
normal learning rate scheduler step
Epoch-21 lr: 1.5811436498153704e-05
Epoch-21 lr: 1.5811436498153704e-05
epoch 21 training time: 15.222
---------------
2023-09-24 20:53:26.843843
current #epochs=22, #steps=819
start validation
acc: 0.737089
AUC: 0.894234
Avg Precision: 0.465479
Avg Recall: 1.000000
d_prime: 1.766868
train_loss: 0.064544
valid_loss: 1.333147
validation finished
normal learning rate scheduler step
Epoch-22 lr: 1.2573740631843252e-05
Epoch-22 lr: 1.2573740631843252e-05
epoch 22 training time: 15.249
---------------
2023-09-24 20:53:42.092556
current #epochs=23, #steps=858
start validation
acc: 0.727700
AUC: 0.894218
Avg Precision: 0.465235
Avg Recall: 1.000000
d_prime: 1.766746
train_loss: 0.042015
valid_loss: 1.332877
validation finished
normal learning rate scheduler step
Epoch-23 lr: 9.999025293832543e-06
Epoch-23 lr: 9.999025293832543e-06
epoch 23 training time: 27.089
---------------
2023-09-24 20:54:09.181599
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01468	Per Sample Data Time 0.00798	Per Sample DNN Time 0.00670	Train Loss 0.0337	
start validation
acc: 0.723005
AUC: 0.894370
Avg Precision: 0.465389
Avg Recall: 1.000000
d_prime: 1.767917
train_loss: 0.056014
valid_loss: 1.333097
validation finished
normal learning rate scheduler step
Epoch-24 lr: 7.951532463895455e-06
Epoch-24 lr: 7.951532463895455e-06
epoch 24 training time: 15.372
---------------
2023-09-24 20:54:24.553585
current #epochs=25, #steps=936
start validation
acc: 0.723005
AUC: 0.894600
Avg Precision: 0.465389
Avg Recall: 1.000000
d_prime: 1.769702
train_loss: 0.040782
valid_loss: 1.333168
validation finished
normal learning rate scheduler step
Epoch-25 lr: 6.323303188700005e-06
Epoch-25 lr: 6.323303188700005e-06
epoch 25 training time: 15.188
---------------
2023-09-24 20:54:39.741154
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00697	Per Sample Data Time 0.00133	Per Sample DNN Time 0.00565	Train Loss 0.0726	
start validation
acc: 0.732394
AUC: 0.894704
Avg Precision: 0.465545
Avg Recall: 1.000000
d_prime: 1.770507
train_loss: 0.066595
valid_loss: 1.333733
validation finished
normal learning rate scheduler step
Epoch-26 lr: 5.02848518795274e-06
Epoch-26 lr: 5.02848518795274e-06
epoch 26 training time: 15.242
---------------
2023-09-24 20:54:54.983275
current #epochs=27, #steps=1014
start validation
acc: 0.732394
AUC: 0.894764
Avg Precision: 0.465545
Avg Recall: 1.000000
d_prime: 1.770979
train_loss: 0.042623
valid_loss: 1.333684
validation finished
normal learning rate scheduler step
Epoch-27 lr: 3.998806087717982e-06
Epoch-27 lr: 3.998806087717982e-06
epoch 27 training time: 15.232
---------------
2023-09-24 20:55:10.214847
current #epochs=28, #steps=1053
start validation
acc: 0.732394
AUC: 0.894866
Avg Precision: 0.465635
Avg Recall: 1.000000
d_prime: 1.771766
train_loss: 0.051402
valid_loss: 1.333506
validation finished
normal learning rate scheduler step
Epoch-28 lr: 3.1799735963188994e-06
Epoch-28 lr: 3.1799735963188994e-06
epoch 28 training time: 15.177
---------------
2023-09-24 20:55:25.392235
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00938	Per Sample Data Time 0.00368	Per Sample DNN Time 0.00570	Train Loss 0.0356	
start validation
acc: 0.732394
AUC: 0.894786
Avg Precision: 0.465545
Avg Recall: 1.000000
d_prime: 1.771149
train_loss: 0.047226
valid_loss: 1.333478
validation finished
normal learning rate scheduler step
Epoch-29 lr: 2.528812813490576e-06
Epoch-29 lr: 2.528812813490576e-06
epoch 29 training time: 15.737
---------------
2023-09-24 20:55:41.129258
current #epochs=30, #steps=1131
start validation
acc: 0.732394
AUC: 0.894888
Avg Precision: 0.465635
Avg Recall: 1.000000
d_prime: 1.771939
train_loss: 0.042641
valid_loss: 1.333489
validation finished
normal learning rate scheduler step
Epoch-30 lr: 2.0109897305678197e-06
Epoch-30 lr: 2.0109897305678197e-06
epoch 30 training time: 16.181
---------------
2023-09-24 20:55:57.310132
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00683	Per Sample Data Time 0.00117	Per Sample DNN Time 0.00565	Train Loss 0.0478	
start validation
acc: 0.732394
AUC: 0.895025
Avg Precision: 0.465635
Avg Recall: 1.000000
d_prime: 1.773005
train_loss: 0.045423
valid_loss: 1.333512
validation finished
normal learning rate scheduler step
Epoch-31 lr: 1.5992008878138748e-06
Epoch-31 lr: 1.5992008878138748e-06
epoch 31 training time: 15.389
---------------
2023-09-24 20:56:12.699501
current #epochs=32, #steps=1209
start validation
acc: 0.732394
AUC: 0.894975
Avg Precision: 0.465635
Avg Recall: 1.000000
d_prime: 1.772613
train_loss: 0.063498
valid_loss: 1.333569
validation finished
normal learning rate scheduler step
Epoch-32 lr: 1.271733734245659e-06
Epoch-32 lr: 1.271733734245659e-06
epoch 32 training time: 16.119
---------------
2023-09-24 20:56:28.818565
current #epochs=33, #steps=1248
start validation
acc: 0.732394
AUC: 0.894975
Avg Precision: 0.465635
Avg Recall: 1.000000
d_prime: 1.772613
train_loss: 0.044174
valid_loss: 1.333605
validation finished
normal learning rate scheduler step
Epoch-33 lr: 1.0113217814863052e-06
Epoch-33 lr: 1.0113217814863052e-06
epoch 33 training time: 16.285
---------------
2023-09-24 20:56:45.103402
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00814	Per Sample Data Time 0.00234	Per Sample DNN Time 0.00580	Train Loss 0.0520	
start validation
acc: 0.732394
AUC: 0.895010
Avg Precision: 0.465635
Avg Recall: 1.000000
d_prime: 1.772889
train_loss: 0.043733
valid_loss: 1.333604
validation finished
normal learning rate scheduler step
Epoch-34 lr: 8.042341868954988e-07
Epoch-34 lr: 8.042341868954988e-07
epoch 34 training time: 15.383
---------------
2023-09-24 20:57:00.485844
current #epochs=35, #steps=1326
start validation
acc: 0.732394
AUC: 0.894975
Avg Precision: 0.465635
Avg Recall: 1.000000
d_prime: 1.772613
train_loss: 0.044237
valid_loss: 1.333627
validation finished
normal learning rate scheduler step
Epoch-35 lr: 6.395517620721023e-07
Epoch-35 lr: 6.395517620721023e-07
epoch 35 training time: 15.221
---------------
2023-09-24 20:57:15.707046
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00662	Per Sample Data Time 0.00106	Per Sample DNN Time 0.00556	Train Loss 0.0488	
start validation
acc: 0.732394
AUC: 0.894939
Avg Precision: 0.465635
Avg Recall: 1.000000
d_prime: 1.772337
train_loss: 0.048012
valid_loss: 1.333600
validation finished
normal learning rate scheduler step
Epoch-36 lr: 5.085912325468942e-07
Epoch-36 lr: 5.085912325468942e-07
epoch 36 training time: 15.351
---------------
2023-09-24 20:57:31.058234
current #epochs=37, #steps=1404
start validation
acc: 0.732394
AUC: 0.894960
Avg Precision: 0.465635
Avg Recall: 1.000000
d_prime: 1.772497
train_loss: 0.058746
valid_loss: 1.333583
validation finished
normal learning rate scheduler step
Epoch-37 lr: 4.0444739138160233e-07
Epoch-37 lr: 4.0444739138160233e-07
epoch 37 training time: 15.234
---------------
2023-09-24 20:57:46.292770
current #epochs=38, #steps=1443
start validation
acc: 0.732394
AUC: 0.894924
Avg Precision: 0.465635
Avg Recall: 1.000000
d_prime: 1.772221
train_loss: 0.060123
valid_loss: 1.333582
validation finished
normal learning rate scheduler step
Epoch-38 lr: 3.216290056284061e-07
Epoch-38 lr: 3.216290056284061e-07
epoch 38 training time: 15.200
---------------
2023-09-24 20:58:01.492089
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00746	Per Sample Data Time 0.00174	Per Sample DNN Time 0.00572	Train Loss 0.0543	
start validation
acc: 0.732394
AUC: 0.894946
Avg Precision: 0.465635
Avg Recall: 1.000000
d_prime: 1.772387
train_loss: 0.055395
valid_loss: 1.333584
validation finished
normal learning rate scheduler step
Epoch-39 lr: 2.557692779477347e-07
Epoch-39 lr: 2.557692779477347e-07
epoch 39 training time: 15.166
---------------
2023-09-24 20:58:16.657993
current #epochs=40, #steps=1521
start validation
acc: 0.732394
AUC: 0.894946
Avg Precision: 0.465635
Avg Recall: 1.000000
d_prime: 1.772387
train_loss: 0.055823
valid_loss: 1.333577
validation finished
normal learning rate scheduler step
Epoch-40 lr: 2.0339559678111284e-07
Epoch-40 lr: 2.0339559678111284e-07
epoch 40 training time: 15.179
---------------
2023-09-24 20:58:31.836988
current #epochs=41, #steps=1560
start validation
acc: 0.732394
AUC: 0.894946
Avg Precision: 0.465635
Avg Recall: 1.000000
d_prime: 1.772387
train_loss: 0.040071
valid_loss: 1.333571
validation finished
normal learning rate scheduler step
Epoch-41 lr: 1.6174643460657838e-07
Epoch-41 lr: 1.6174643460657838e-07
epoch 41 training time: 15.627
---------------
2023-09-24 20:58:47.463667
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02300	Per Sample Data Time 0.01632	Per Sample DNN Time 0.00668	Train Loss 0.0553	
start validation
acc: 0.732394
AUC: 0.894946
Avg Precision: 0.465635
Avg Recall: 1.000000
d_prime: 1.772387
train_loss: 0.056305
valid_loss: 1.333571
validation finished
normal learning rate scheduler step
Epoch-42 lr: 1.2862573979954276e-07
Epoch-42 lr: 1.2862573979954276e-07
epoch 42 training time: 15.312
---------------
2023-09-24 20:59:02.775437
current #epochs=43, #steps=1638
start validation
acc: 0.732394
AUC: 0.894946
Avg Precision: 0.465635
Avg Recall: 1.000000
d_prime: 1.772387
train_loss: 0.052701
valid_loss: 1.333568
validation finished
normal learning rate scheduler step
Epoch-43 lr: 1.02287144561929e-07
Epoch-43 lr: 1.02287144561929e-07
epoch 43 training time: 15.314
---------------
2023-09-24 20:59:18.089306
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00702	Per Sample Data Time 0.00143	Per Sample DNN Time 0.00560	Train Loss 0.0576	
start validation
acc: 0.732394
AUC: 0.894924
Avg Precision: 0.465635
Avg Recall: 1.000000
d_prime: 1.772221
train_loss: 0.054535
valid_loss: 1.333572
validation finished
normal learning rate scheduler step
Epoch-44 lr: 8.134188350588717e-08
Epoch-44 lr: 8.134188350588717e-08
epoch 44 training time: 15.198
---------------
2023-09-24 20:59:33.287814
current #epochs=45, #steps=1716
start validation
[I 2023-09-24 20:59:48,631] Trial 70 finished with value: 0.465634923120758 and parameters: {'warmup': 'True', 'num_epochs': 45, 'batch_size': 54, 'lr-adaptschedule': 'True', 'lr': 0.0006181311326576633, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7952307580219851}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.732394
AUC: 0.894924
Avg Precision: 0.465635
Avg Recall: 1.000000
d_prime: 1.772221
train_loss: 0.049099
valid_loss: 1.333578
validation finished
normal learning rate scheduler step
Epoch-45 lr: 6.468556767932267e-08
Epoch-45 lr: 6.468556767932267e-08
epoch 45 training time: 15.330
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f4df1f0>
The learning rate scheduler starts at 7 epoch with decay rate of 0.784 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 20:59:48.670931
current #epochs=1, #steps=0
start validation
acc: 0.713615
AUC: 0.896498
Avg Precision: 0.465525
Avg Recall: 1.000000
d_prime: 1.784521
train_loss: 0.043030
valid_loss: 1.326412
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.00014361870262894416
Epoch-1 lr: 0.00014361870262894416
epoch 1 training time: 19.761
---------------
2023-09-24 21:00:08.432756
current #epochs=2, #steps=39
start validation
acc: 0.723005
AUC: 0.896595
Avg Precision: 0.459523
Avg Recall: 1.000000
d_prime: 1.785283
train_loss: 0.064448
valid_loss: 1.330654
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.00014361870262894416
Epoch-2 lr: 0.00014361870262894416
epoch 2 training time: 17.774
---------------
2023-09-24 21:00:26.206675
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00561	Train Loss 0.0437	
start validation
acc: 0.718310
AUC: 0.897110
Avg Precision: 0.461103
Avg Recall: 1.000000
d_prime: 1.789343
train_loss: 0.046410
valid_loss: 1.331610
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.00014361870262894416
Epoch-3 lr: 0.00014361870262894416
epoch 3 training time: 15.175
---------------
2023-09-24 21:00:41.381645
current #epochs=4, #steps=117
start validation
acc: 0.718310
AUC: 0.897253
Avg Precision: 0.467844
Avg Recall: 1.000000
d_prime: 1.790466
train_loss: 0.045583
valid_loss: 1.332243
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00014361870262894416
Epoch-4 lr: 0.00014361870262894416
epoch 4 training time: 16.535
---------------
2023-09-24 21:00:57.916765
current #epochs=5, #steps=156
start validation
acc: 0.713615
AUC: 0.897721
Avg Precision: 0.472255
Avg Recall: 1.000000
d_prime: 1.794177
train_loss: 0.055072
valid_loss: 1.330930
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00014361870262894416
Epoch-5 lr: 0.00014361870262894416
epoch 5 training time: 15.270
---------------
2023-09-24 21:01:13.186942
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01094	Per Sample Data Time 0.00512	Per Sample DNN Time 0.00582	Train Loss 0.0616	
start validation
acc: 0.708920
AUC: 0.896585
Avg Precision: 0.472918
Avg Recall: 1.000000
d_prime: 1.785204
train_loss: 0.043569
valid_loss: 1.332024
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00014361870262894416
Epoch-6 lr: 0.00014361870262894416
epoch 6 training time: 15.445
---------------
2023-09-24 21:01:28.632190
current #epochs=7, #steps=234
start validation
acc: 0.713615
AUC: 0.894650
Avg Precision: 0.456791
Avg Recall: 1.000000
d_prime: 1.770089
train_loss: 0.043504
valid_loss: 1.333418
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00011254961289133208
Epoch-7 lr: 0.00011254961289133208
epoch 7 training time: 15.346
---------------
2023-09-24 21:01:43.978470
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00683	Per Sample Data Time 0.00121	Per Sample DNN Time 0.00561	Train Loss 0.0538	
start validation
acc: 0.708920
AUC: 0.892422
Avg Precision: 0.470297
Avg Recall: 1.000000
d_prime: 1.752935
train_loss: 0.056606
valid_loss: 1.338672
validation finished
normal learning rate scheduler step
Epoch-8 lr: 8.820171140743741e-05
Epoch-8 lr: 8.820171140743741e-05
epoch 8 training time: 15.168
---------------
2023-09-24 21:01:59.146847
current #epochs=9, #steps=312
start validation
acc: 0.713615
AUC: 0.891973
Avg Precision: 0.461588
Avg Recall: 1.000000
d_prime: 1.749506
train_loss: 0.057907
valid_loss: 1.342688
validation finished
normal learning rate scheduler step
Epoch-9 lr: 6.912100091105697e-05
Epoch-9 lr: 6.912100091105697e-05
epoch 9 training time: 15.404
---------------
2023-09-24 21:02:14.550869
current #epochs=10, #steps=351
start validation
acc: 0.718310
AUC: 0.892717
Avg Precision: 0.461107
Avg Recall: 1.000000
d_prime: 1.755191
train_loss: 0.052114
valid_loss: 1.344941
validation finished
normal learning rate scheduler step
Epoch-10 lr: 5.41680279294838e-05
Epoch-10 lr: 5.41680279294838e-05
epoch 10 training time: 16.070
---------------
2023-09-24 21:02:30.621398
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00869	Per Sample Data Time 0.00290	Per Sample DNN Time 0.00579	Train Loss 0.0252	
start validation
acc: 0.713615
AUC: 0.893051
Avg Precision: 0.461978
Avg Recall: 1.000000
d_prime: 1.757750
train_loss: 0.044229
valid_loss: 1.342852
validation finished
normal learning rate scheduler step
Epoch-11 lr: 4.2449837402455354e-05
Epoch-11 lr: 4.2449837402455354e-05
epoch 11 training time: 15.314
---------------
2023-09-24 21:02:45.935021
current #epochs=12, #steps=429
start validation
acc: 0.704225
AUC: 0.892410
Avg Precision: 0.460873
Avg Recall: 1.000000
d_prime: 1.752843
train_loss: 0.053091
valid_loss: 1.341536
validation finished
normal learning rate scheduler step
Epoch-12 lr: 3.326664758482135e-05
Epoch-12 lr: 3.326664758482135e-05
epoch 12 training time: 15.457
---------------
2023-09-24 21:03:01.392319
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00667	Per Sample Data Time 0.00108	Per Sample DNN Time 0.00559	Train Loss 0.0432	
start validation
acc: 0.704225
AUC: 0.892369
Avg Precision: 0.461447
Avg Recall: 1.000000
d_prime: 1.752530
train_loss: 0.043823
valid_loss: 1.342104
validation finished
normal learning rate scheduler step
Epoch-13 lr: 2.6070060788234932e-05
Epoch-13 lr: 2.6070060788234932e-05
epoch 13 training time: 15.310
---------------
2023-09-24 21:03:16.702134
current #epochs=14, #steps=507
start validation
acc: 0.708920
AUC: 0.891648
Avg Precision: 0.461305
Avg Recall: 1.000000
d_prime: 1.747036
train_loss: 0.048480
valid_loss: 1.341761
validation finished
normal learning rate scheduler step
Epoch-14 lr: 2.0430314409329578e-05
Epoch-14 lr: 2.0430314409329578e-05
epoch 14 training time: 15.198
---------------
2023-09-24 21:03:31.899504
current #epochs=15, #steps=546
start validation
acc: 0.704225
AUC: 0.891411
Avg Precision: 0.461834
Avg Recall: 1.000000
d_prime: 1.745231
train_loss: 0.055713
valid_loss: 1.340806
validation finished
normal learning rate scheduler step
Epoch-15 lr: 1.601061655569387e-05
Epoch-15 lr: 1.601061655569387e-05
epoch 15 training time: 15.282
---------------
2023-09-24 21:03:47.181659
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00777	Per Sample Data Time 0.00201	Per Sample DNN Time 0.00576	Train Loss 0.0500	
start validation
acc: 0.704225
AUC: 0.892064
Avg Precision: 0.463193
Avg Recall: 1.000000
d_prime: 1.750204
train_loss: 0.052376
valid_loss: 1.339991
validation finished
normal learning rate scheduler step
Epoch-16 lr: 1.2547033655850158e-05
Epoch-16 lr: 1.2547033655850158e-05
epoch 16 training time: 16.476
---------------
2023-09-24 21:04:03.657624
current #epochs=17, #steps=624
start validation
acc: 0.704225
AUC: 0.892179
Avg Precision: 0.462610
Avg Recall: 1.000000
d_prime: 1.751081
train_loss: 0.054158
valid_loss: 1.339947
validation finished
normal learning rate scheduler step
Epoch-17 lr: 9.832728990380466e-06
Epoch-17 lr: 9.832728990380466e-06
epoch 17 training time: 17.544
---------------
2023-09-24 21:04:21.201549
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00648	Per Sample Data Time 0.00094	Per Sample DNN Time 0.00555	Train Loss 0.0539	
start validation
acc: 0.704225
AUC: 0.892221
Avg Precision: 0.462681
Avg Recall: 1.000000
d_prime: 1.751400
train_loss: 0.054988
valid_loss: 1.339558
validation finished
normal learning rate scheduler step
Epoch-18 lr: 7.705610907737497e-06
Epoch-18 lr: 7.705610907737497e-06
epoch 18 training time: 16.404
---------------
2023-09-24 21:04:37.605348
current #epochs=19, #steps=702
start validation
acc: 0.704225
AUC: 0.892468
Avg Precision: 0.462361
Avg Recall: 1.000000
d_prime: 1.753287
train_loss: 0.037346
valid_loss: 1.339562
validation finished
normal learning rate scheduler step
Epoch-19 lr: 6.038653106328072e-06
Epoch-19 lr: 6.038653106328072e-06
epoch 19 training time: 15.262
---------------
2023-09-24 21:04:52.867227
current #epochs=20, #steps=741
start validation
acc: 0.704225
AUC: 0.892528
Avg Precision: 0.463298
Avg Recall: 1.000000
d_prime: 1.753744
train_loss: 0.045236
valid_loss: 1.339558
validation finished
normal learning rate scheduler step
Epoch-20 lr: 4.732308933734177e-06
Epoch-20 lr: 4.732308933734177e-06
epoch 20 training time: 15.246
---------------
2023-09-24 21:05:08.113323
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00159	Per Sample DNN Time 0.00553	Train Loss 0.0445	
start validation
acc: 0.704225
AUC: 0.892565
Avg Precision: 0.463444
Avg Recall: 1.000000
d_prime: 1.754031
train_loss: 0.042747
valid_loss: 1.339304
validation finished
normal learning rate scheduler step
Epoch-21 lr: 3.7085667035306644e-06
Epoch-21 lr: 3.7085667035306644e-06
epoch 21 training time: 15.894
---------------
2023-09-24 21:05:24.007268
current #epochs=22, #steps=819
start validation
acc: 0.704225
AUC: 0.892444
Avg Precision: 0.463368
Avg Recall: 1.000000
d_prime: 1.753105
train_loss: 0.050646
valid_loss: 1.339215
validation finished
normal learning rate scheduler step
Epoch-22 lr: 2.9062910277253797e-06
Epoch-22 lr: 2.9062910277253797e-06
epoch 22 training time: 15.267
---------------
2023-09-24 21:05:39.274258
current #epochs=23, #steps=858
start validation
acc: 0.704225
AUC: 0.892436
Avg Precision: 0.463294
Avg Recall: 1.000000
d_prime: 1.753038
train_loss: 0.049083
valid_loss: 1.339077
validation finished
normal learning rate scheduler step
Epoch-23 lr: 2.2775719605624734e-06
Epoch-23 lr: 2.2775719605624734e-06
epoch 23 training time: 15.412
---------------
2023-09-24 21:05:54.686101
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01440	Per Sample Data Time 0.00797	Per Sample DNN Time 0.00644	Train Loss 0.0325	
start validation
acc: 0.704225
AUC: 0.892468
Avg Precision: 0.463294
Avg Recall: 1.000000
d_prime: 1.753283
train_loss: 0.046268
valid_loss: 1.339065
validation finished
normal learning rate scheduler step
Epoch-24 lr: 1.7848639334651481e-06
Epoch-24 lr: 1.7848639334651481e-06
epoch 24 training time: 15.297
---------------
2023-09-24 21:06:09.982616
current #epochs=25, #steps=936
start validation
acc: 0.704225
AUC: 0.892420
Avg Precision: 0.463294
Avg Recall: 1.000000
d_prime: 1.752916
train_loss: 0.057891
valid_loss: 1.339091
validation finished
normal learning rate scheduler step
Epoch-25 lr: 1.3987436252938082e-06
Epoch-25 lr: 1.3987436252938082e-06
epoch 25 training time: 15.281
---------------
2023-09-24 21:06:25.263502
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00701	Per Sample Data Time 0.00141	Per Sample DNN Time 0.00560	Train Loss 0.0341	
start validation
acc: 0.704225
AUC: 0.892421
Avg Precision: 0.463294
Avg Recall: 1.000000
d_prime: 1.752924
train_loss: 0.034428
valid_loss: 1.339005
validation finished
normal learning rate scheduler step
Epoch-26 lr: 1.0961528734023625e-06
Epoch-26 lr: 1.0961528734023625e-06
epoch 26 training time: 15.491
---------------
2023-09-24 21:06:40.755249
current #epochs=27, #steps=1014
start validation
acc: 0.704225
AUC: 0.892487
Avg Precision: 0.463294
Avg Recall: 1.000000
d_prime: 1.753430
train_loss: 0.062567
valid_loss: 1.338896
validation finished
normal learning rate scheduler step
Epoch-27 lr: 8.590216964283703e-07
Epoch-27 lr: 8.590216964283703e-07
epoch 27 training time: 15.240
---------------
2023-09-24 21:06:55.995193
current #epochs=28, #steps=1053
start validation
acc: 0.704225
AUC: 0.892459
Avg Precision: 0.463294
Avg Recall: 1.000000
d_prime: 1.753217
train_loss: 0.045850
valid_loss: 1.338858
validation finished
normal learning rate scheduler step
Epoch-28 lr: 6.731891990979702e-07
Epoch-28 lr: 6.731891990979702e-07
epoch 28 training time: 15.343
---------------
2023-09-24 21:07:11.338670
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00945	Per Sample Data Time 0.00356	Per Sample DNN Time 0.00589	Train Loss 0.0438	
start validation
acc: 0.704225
AUC: 0.892459
Avg Precision: 0.463294
Avg Recall: 1.000000
d_prime: 1.753217
train_loss: 0.054755
valid_loss: 1.338840
validation finished
normal learning rate scheduler step
Epoch-29 lr: 5.275579181136031e-07
Epoch-29 lr: 5.275579181136031e-07
epoch 29 training time: 15.248
---------------
2023-09-24 21:07:26.586960
current #epochs=30, #steps=1131
start validation
acc: 0.704225
AUC: 0.892489
Avg Precision: 0.463294
Avg Recall: 1.000000
d_prime: 1.753446
train_loss: 0.056889
valid_loss: 1.338810
validation finished
normal learning rate scheduler step
Epoch-30 lr: 4.1343110872439175e-07
Epoch-30 lr: 4.1343110872439175e-07
epoch 30 training time: 15.169
---------------
2023-09-24 21:07:41.755470
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00675	Per Sample Data Time 0.00113	Per Sample DNN Time 0.00562	Train Loss 0.0398	
start validation
acc: 0.704225
AUC: 0.892504
Avg Precision: 0.463294
Avg Recall: 1.000000
d_prime: 1.753560
train_loss: 0.040741
valid_loss: 1.338778
validation finished
normal learning rate scheduler step
Epoch-31 lr: 3.239933963502244e-07
Epoch-31 lr: 3.239933963502244e-07
epoch 31 training time: 15.223
---------------
2023-09-24 21:07:56.978010
current #epochs=32, #steps=1209
start validation
acc: 0.704225
AUC: 0.892504
Avg Precision: 0.463294
Avg Recall: 1.000000
d_prime: 1.753560
train_loss: 0.055523
valid_loss: 1.338771
validation finished
normal learning rate scheduler step
Epoch-32 lr: 2.5390377904177404e-07
Epoch-32 lr: 2.5390377904177404e-07
epoch 32 training time: 15.286
---------------
2023-09-24 21:08:12.263638
current #epochs=33, #steps=1248
start validation
acc: 0.704225
AUC: 0.892504
Avg Precision: 0.463294
Avg Recall: 1.000000
d_prime: 1.753560
train_loss: 0.046928
valid_loss: 1.338767
validation finished
normal learning rate scheduler step
Epoch-33 lr: 1.9897667587646605e-07
Epoch-33 lr: 1.9897667587646605e-07
epoch 33 training time: 15.300
---------------
2023-09-24 21:08:27.563630
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00799	Per Sample Data Time 0.00224	Per Sample DNN Time 0.00575	Train Loss 0.0417	
start validation
acc: 0.704225
AUC: 0.892483
Avg Precision: 0.463294
Avg Recall: 1.000000
d_prime: 1.753403
train_loss: 0.037867
valid_loss: 1.338755
validation finished
normal learning rate scheduler step
Epoch-34 lr: 1.5593197427886382e-07
Epoch-34 lr: 1.5593197427886382e-07
epoch 34 training time: 15.165
---------------
2023-09-24 21:08:42.728311
current #epochs=35, #steps=1326
start validation
acc: 0.704225
AUC: 0.892483
Avg Precision: 0.463294
Avg Recall: 1.000000
d_prime: 1.753403
train_loss: 0.044006
valid_loss: 1.338741
validation finished
normal learning rate scheduler step
Epoch-35 lr: 1.2219914970134485e-07
Epoch-35 lr: 1.2219914970134485e-07
epoch 35 training time: 15.340
---------------
2023-09-24 21:08:58.068260
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00659	Per Sample Data Time 0.00101	Per Sample DNN Time 0.00558	Train Loss 0.0383	
start validation
acc: 0.704225
AUC: 0.892483
Avg Precision: 0.463294
Avg Recall: 1.000000
d_prime: 1.753403
train_loss: 0.038770
valid_loss: 1.338732
validation finished
normal learning rate scheduler step
Epoch-36 lr: 9.57637601703589e-08
Epoch-36 lr: 9.57637601703589e-08
epoch 36 training time: 15.289
---------------
2023-09-24 21:09:13.357318
current #epochs=37, #steps=1404
start validation
acc: 0.704225
AUC: 0.892519
Avg Precision: 0.463294
Avg Recall: 1.000000
d_prime: 1.753674
train_loss: 0.046526
valid_loss: 1.338726
validation finished
normal learning rate scheduler step
Epoch-37 lr: 7.504714872713302e-08
Epoch-37 lr: 7.504714872713302e-08
epoch 37 training time: 16.242
---------------
2023-09-24 21:09:29.599162
current #epochs=38, #steps=1443
start validation
acc: 0.704225
AUC: 0.892519
Avg Precision: 0.463294
Avg Recall: 1.000000
d_prime: 1.753674
train_loss: 0.046560
valid_loss: 1.338727
validation finished
normal learning rate scheduler step
Epoch-38 lr: 5.881216988611606e-08
Epoch-38 lr: 5.881216988611606e-08
epoch 38 training time: 15.133
---------------
2023-09-24 21:09:44.732013
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00738	Per Sample Data Time 0.00170	Per Sample DNN Time 0.00569	Train Loss 0.0498	
start validation
acc: 0.704225
AUC: 0.892519
Avg Precision: 0.463294
Avg Recall: 1.000000
d_prime: 1.753674
train_loss: 0.042268
valid_loss: 1.338727
validation finished
normal learning rate scheduler step
Epoch-39 lr: 4.6089310325294675e-08
Epoch-39 lr: 4.6089310325294675e-08
epoch 39 training time: 15.199
---------------
2023-09-24 21:09:59.930904
current #epochs=40, #steps=1521
start validation
acc: 0.704225
AUC: 0.892519
Avg Precision: 0.463294
Avg Recall: 1.000000
d_prime: 1.753674
train_loss: 0.045697
valid_loss: 1.338726
validation finished
normal learning rate scheduler step
Epoch-40 lr: 3.6118791916276247e-08
Epoch-40 lr: 3.6118791916276247e-08
epoch 40 training time: 15.621
---------------
2023-09-24 21:10:15.551502
current #epochs=41, #steps=1560
start validation
[I 2023-09-24 21:10:31,572] Trial 71 finished with value: 0.46329352191332185 and parameters: {'warmup': 'True', 'num_epochs': 41, 'batch_size': 38, 'lr-adaptschedule': 'True', 'lr': 0.00014361870262894416, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.783669611485889}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.704225
AUC: 0.892519
Avg Precision: 0.463294
Avg Recall: 1.000000
d_prime: 1.753674
train_loss: 0.057105
valid_loss: 1.338725
validation finished
normal learning rate scheduler step
Epoch-41 lr: 2.8305199628367873e-08
Epoch-41 lr: 2.8305199628367873e-08
epoch 41 training time: 16.007
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa6080c6070>
The learning rate scheduler starts at 7 epoch with decay rate of 0.775 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 21:10:31.609991
current #epochs=1, #steps=0
start validation
acc: 0.765258
AUC: 0.888687
Avg Precision: 0.458993
Avg Recall: 1.000000
d_prime: 1.724738
train_loss: 0.062393
valid_loss: 1.325750
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0007303154138649818
Epoch-1 lr: 0.0007303154138649818
epoch 1 training time: 29.310
---------------
2023-09-24 21:11:00.919973
current #epochs=2, #steps=39
start validation
acc: 0.774648
AUC: 0.901742
Avg Precision: 0.468612
Avg Recall: 1.000000
d_prime: 1.826517
train_loss: 0.072095
valid_loss: 1.325873
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0007303154138649818
Epoch-2 lr: 0.0007303154138649818
epoch 2 training time: 18.475
---------------
2023-09-24 21:11:19.394987
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00564	Train Loss 0.0682	
start validation
acc: 0.751174
AUC: 0.903478
Avg Precision: 0.455586
Avg Recall: 1.000000
d_prime: 1.840780
train_loss: 0.062862
valid_loss: 1.325609
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0007303154138649818
Epoch-3 lr: 0.0007303154138649818
epoch 3 training time: 15.251
---------------
2023-09-24 21:11:34.646427
current #epochs=4, #steps=117
start validation
acc: 0.746479
AUC: 0.906787
Avg Precision: 0.474542
Avg Recall: 1.000000
d_prime: 1.868495
train_loss: 0.060445
valid_loss: 1.334013
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0007303154138649818
Epoch-4 lr: 0.0007303154138649818
epoch 4 training time: 15.442
---------------
2023-09-24 21:11:50.088829
current #epochs=5, #steps=156
start validation
acc: 0.718310
AUC: 0.898646
Avg Precision: 0.473720
Avg Recall: 1.000000
d_prime: 1.801528
train_loss: 0.076973
valid_loss: 1.323763
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0007303154138649818
Epoch-5 lr: 0.0007303154138649818
epoch 5 training time: 15.165
---------------
2023-09-24 21:12:05.253550
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01149	Per Sample Data Time 0.00521	Per Sample DNN Time 0.00628	Train Loss 0.0183	
start validation
acc: 0.732394
AUC: 0.894886
Avg Precision: 0.457031
Avg Recall: 1.000000
d_prime: 1.771920
train_loss: 0.056679
valid_loss: 1.331715
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0007303154138649818
Epoch-6 lr: 0.0007303154138649818
epoch 6 training time: 15.674
---------------
2023-09-24 21:12:20.927954
current #epochs=7, #steps=234
start validation
acc: 0.732394
AUC: 0.894867
Avg Precision: 0.469651
Avg Recall: 1.000000
d_prime: 1.771772
train_loss: 0.054365
valid_loss: 1.349874
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0005659979683035255
Epoch-7 lr: 0.0005659979683035255
epoch 7 training time: 15.349
---------------
2023-09-24 21:12:36.277164
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00681	Per Sample Data Time 0.00122	Per Sample DNN Time 0.00560	Train Loss 0.0738	
start validation
acc: 0.732394
AUC: 0.898978
Avg Precision: 0.466972
Avg Recall: 1.000000
d_prime: 1.804185
train_loss: 0.074222
valid_loss: 1.344973
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00043865115543480036
Epoch-8 lr: 0.00043865115543480036
epoch 8 training time: 15.283
---------------
2023-09-24 21:12:51.560049
current #epochs=9, #steps=312
start validation
acc: 0.737089
AUC: 0.893096
Avg Precision: 0.457640
Avg Recall: 1.000000
d_prime: 1.758099
train_loss: 0.056518
valid_loss: 1.337632
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0003399567612248033
Epoch-9 lr: 0.0003399567612248033
epoch 9 training time: 15.326
---------------
2023-09-24 21:13:06.886758
current #epochs=10, #steps=351
start validation
acc: 0.732394
AUC: 0.890111
Avg Precision: 0.448632
Avg Recall: 1.000000
d_prime: 1.735405
train_loss: 0.051459
valid_loss: 1.340349
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00026346812967562315
Epoch-10 lr: 0.00026346812967562315
epoch 10 training time: 15.282
---------------
2023-09-24 21:13:22.168251
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00863	Per Sample Data Time 0.00299	Per Sample DNN Time 0.00564	Train Loss 0.0467	
start validation
acc: 0.723005
AUC: 0.893895
Avg Precision: 0.458771
Avg Recall: 1.000000
d_prime: 1.764245
train_loss: 0.050655
valid_loss: 1.340020
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00020418907129447737
Epoch-11 lr: 0.00020418907129447737
epoch 11 training time: 15.739
---------------
2023-09-24 21:13:37.906983
current #epochs=12, #steps=429
start validation
acc: 0.718310
AUC: 0.898052
Avg Precision: 0.457280
Avg Recall: 1.000000
d_prime: 1.796801
train_loss: 0.060737
valid_loss: 1.338713
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00015824751512614823
Epoch-12 lr: 0.00015824751512614823
epoch 12 training time: 15.302
---------------
2023-09-24 21:13:53.208888
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00671	Per Sample Data Time 0.00106	Per Sample DNN Time 0.00565	Train Loss 0.0631	
start validation
acc: 0.723005
AUC: 0.895579
Avg Precision: 0.467816
Avg Recall: 1.000000
d_prime: 1.777320
train_loss: 0.064431
valid_loss: 1.344339
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00012264258750403466
Epoch-13 lr: 0.00012264258750403466
epoch 13 training time: 15.656
---------------
2023-09-24 21:14:08.864583
current #epochs=14, #steps=507
start validation
acc: 0.713615
AUC: 0.896637
Avg Precision: 0.465784
Avg Recall: 1.000000
d_prime: 1.785611
train_loss: 0.050264
valid_loss: 1.343109
validation finished
normal learning rate scheduler step
Epoch-14 lr: 9.504859686229252e-05
Epoch-14 lr: 9.504859686229252e-05
epoch 14 training time: 15.284
---------------
2023-09-24 21:14:24.148490
current #epochs=15, #steps=546
start validation
acc: 0.713615
AUC: 0.896845
Avg Precision: 0.466063
Avg Recall: 1.000000
d_prime: 1.787250
train_loss: 0.050222
valid_loss: 1.335279
validation finished
normal learning rate scheduler step
Epoch-15 lr: 7.36631210197958e-05
Epoch-15 lr: 7.36631210197958e-05
epoch 15 training time: 15.200
---------------
2023-09-24 21:14:39.348850
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00765	Per Sample Data Time 0.00200	Per Sample DNN Time 0.00565	Train Loss 0.0723	
start validation
acc: 0.723005
AUC: 0.898097
Avg Precision: 0.457183
Avg Recall: 1.000000
d_prime: 1.797155
train_loss: 0.066213
valid_loss: 1.333326
validation finished
normal learning rate scheduler step
Epoch-16 lr: 5.708927409248032e-05
Epoch-16 lr: 5.708927409248032e-05
epoch 16 training time: 15.785
---------------
2023-09-24 21:14:55.134050
current #epochs=17, #steps=624
start validation
acc: 0.727700
AUC: 0.897875
Avg Precision: 0.457657
Avg Recall: 1.000000
d_prime: 1.795393
train_loss: 0.040500
valid_loss: 1.334162
validation finished
normal learning rate scheduler step
Epoch-17 lr: 4.424446278254339e-05
Epoch-17 lr: 4.424446278254339e-05
epoch 17 training time: 15.247
---------------
2023-09-24 21:15:10.380721
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00650	Per Sample Data Time 0.00095	Per Sample DNN Time 0.00555	Train Loss 0.0465	
start validation
acc: 0.727700
AUC: 0.898926
Avg Precision: 0.456731
Avg Recall: 1.000000
d_prime: 1.803769
train_loss: 0.046259
valid_loss: 1.334779
validation finished
normal learning rate scheduler step
Epoch-18 lr: 3.428967206247442e-05
Epoch-18 lr: 3.428967206247442e-05
epoch 18 training time: 15.903
---------------
2023-09-24 21:15:26.283911
current #epochs=19, #steps=702
start validation
acc: 0.727700
AUC: 0.898481
Avg Precision: 0.455165
Avg Recall: 1.000000
d_prime: 1.800217
train_loss: 0.055828
valid_loss: 1.334134
validation finished
normal learning rate scheduler step
Epoch-19 lr: 2.6574661239099557e-05
Epoch-19 lr: 2.6574661239099557e-05
epoch 19 training time: 15.487
---------------
2023-09-24 21:15:41.771095
current #epochs=20, #steps=741
start validation
acc: 0.727700
AUC: 0.898275
Avg Precision: 0.454915
Avg Recall: 1.000000
d_prime: 1.798576
train_loss: 0.050707
valid_loss: 1.334067
validation finished
normal learning rate scheduler step
Epoch-20 lr: 2.059549063887835e-05
Epoch-20 lr: 2.059549063887835e-05
epoch 20 training time: 15.291
---------------
2023-09-24 21:15:57.061555
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00726	Per Sample Data Time 0.00161	Per Sample DNN Time 0.00565	Train Loss 0.0498	
start validation
acc: 0.723005
AUC: 0.898014
Avg Precision: 0.455646
Avg Recall: 1.000000
d_prime: 1.796495
train_loss: 0.043835
valid_loss: 1.333430
validation finished
normal learning rate scheduler step
Epoch-21 lr: 1.596160458414552e-05
Epoch-21 lr: 1.596160458414552e-05
epoch 21 training time: 16.829
---------------
2023-09-24 21:16:13.890781
current #epochs=22, #steps=819
start validation
acc: 0.718310
AUC: 0.897902
Avg Precision: 0.456484
Avg Recall: 1.000000
d_prime: 1.795613
train_loss: 0.055517
valid_loss: 1.333512
validation finished
normal learning rate scheduler step
Epoch-22 lr: 1.2370320540928392e-05
Epoch-22 lr: 1.2370320540928392e-05
epoch 22 training time: 15.676
---------------
2023-09-24 21:16:29.567422
current #epochs=23, #steps=858
start validation
acc: 0.723005
AUC: 0.898388
Avg Precision: 0.456436
Avg Recall: 1.000000
d_prime: 1.799471
train_loss: 0.059662
valid_loss: 1.334079
validation finished
normal learning rate scheduler step
Epoch-23 lr: 9.587058085457944e-06
Epoch-23 lr: 9.587058085457944e-06
epoch 23 training time: 15.361
---------------
2023-09-24 21:16:44.928051
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01409	Per Sample Data Time 0.00802	Per Sample DNN Time 0.00607	Train Loss 0.0485	
start validation
acc: 0.723005
AUC: 0.898353
Avg Precision: 0.456059
Avg Recall: 1.000000
d_prime: 1.799193
train_loss: 0.051878
valid_loss: 1.334080
validation finished
normal learning rate scheduler step
Epoch-24 lr: 7.430016257852489e-06
Epoch-24 lr: 7.430016257852489e-06
epoch 24 training time: 15.435
---------------
2023-09-24 21:17:00.363423
current #epochs=25, #steps=936
start validation
acc: 0.723005
AUC: 0.898340
Avg Precision: 0.456059
Avg Recall: 1.000000
d_prime: 1.799094
train_loss: 0.047174
valid_loss: 1.333836
validation finished
normal learning rate scheduler step
Epoch-25 lr: 5.758298437316219e-06
Epoch-25 lr: 5.758298437316219e-06
epoch 25 training time: 16.439
---------------
2023-09-24 21:17:16.802631
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00690	Per Sample Data Time 0.00128	Per Sample DNN Time 0.00562	Train Loss 0.0542	
start validation
acc: 0.723005
AUC: 0.898189
Avg Precision: 0.455919
Avg Recall: 1.000000
d_prime: 1.797888
train_loss: 0.054612
valid_loss: 1.333776
validation finished
normal learning rate scheduler step
Epoch-26 lr: 4.462709063140345e-06
Epoch-26 lr: 4.462709063140345e-06
epoch 26 training time: 15.292
---------------
2023-09-24 21:17:32.094800
current #epochs=27, #steps=1014
start validation
acc: 0.723005
AUC: 0.898239
Avg Precision: 0.455919
Avg Recall: 1.000000
d_prime: 1.798289
train_loss: 0.039959
valid_loss: 1.333906
validation finished
normal learning rate scheduler step
Epoch-27 lr: 3.458621049088445e-06
Epoch-27 lr: 3.458621049088445e-06
epoch 27 training time: 15.319
---------------
2023-09-24 21:17:47.414149
current #epochs=28, #steps=1053
start validation
acc: 0.723005
AUC: 0.898209
Avg Precision: 0.455459
Avg Recall: 1.000000
d_prime: 1.798051
train_loss: 0.055596
valid_loss: 1.333908
validation finished
normal learning rate scheduler step
Epoch-28 lr: 2.680447995142243e-06
Epoch-28 lr: 2.680447995142243e-06
epoch 28 training time: 16.031
---------------
2023-09-24 21:18:03.445504
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00925	Per Sample Data Time 0.00347	Per Sample DNN Time 0.00578	Train Loss 0.0353	
start validation
acc: 0.723005
AUC: 0.898127
Avg Precision: 0.455321
Avg Recall: 1.000000
d_prime: 1.797395
train_loss: 0.043699
valid_loss: 1.333703
validation finished
normal learning rate scheduler step
Epoch-29 lr: 2.077360124942193e-06
Epoch-29 lr: 2.077360124942193e-06
epoch 29 training time: 15.209
---------------
2023-09-24 21:18:18.654809
current #epochs=30, #steps=1131
start validation
acc: 0.723005
AUC: 0.898085
Avg Precision: 0.461380
Avg Recall: 1.000000
d_prime: 1.797061
train_loss: 0.054511
valid_loss: 1.333695
validation finished
normal learning rate scheduler step
Epoch-30 lr: 1.6099641166404487e-06
Epoch-30 lr: 1.6099641166404487e-06
epoch 30 training time: 15.216
---------------
2023-09-24 21:18:33.870388
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00671	Per Sample Data Time 0.00109	Per Sample DNN Time 0.00562	Train Loss 0.0491	
start validation
acc: 0.723005
AUC: 0.898168
Avg Precision: 0.461380
Avg Recall: 1.000000
d_prime: 1.797723
train_loss: 0.056220
valid_loss: 1.333701
validation finished
normal learning rate scheduler step
Epoch-31 lr: 1.2477299557976199e-06
Epoch-31 lr: 1.2477299557976199e-06
epoch 31 training time: 15.461
---------------
2023-09-24 21:18:49.331920
current #epochs=32, #steps=1209
start validation
acc: 0.723005
AUC: 0.898072
Avg Precision: 0.460920
Avg Recall: 1.000000
d_prime: 1.796960
train_loss: 0.052127
valid_loss: 1.333748
validation finished
normal learning rate scheduler step
Epoch-32 lr: 9.669967339665964e-07
Epoch-32 lr: 9.669967339665964e-07
epoch 32 training time: 15.772
---------------
2023-09-24 21:19:05.103296
current #epochs=33, #steps=1248
start validation
acc: 0.723005
AUC: 0.898189
Avg Precision: 0.460920
Avg Recall: 1.000000
d_prime: 1.797893
train_loss: 0.072069
valid_loss: 1.333744
validation finished
normal learning rate scheduler step
Epoch-33 lr: 7.494271329763069e-07
Epoch-33 lr: 7.494271329763069e-07
epoch 33 training time: 15.814
---------------
2023-09-24 21:19:20.916883
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00797	Per Sample Data Time 0.00234	Per Sample DNN Time 0.00563	Train Loss 0.0333	
start validation
acc: 0.723005
AUC: 0.898183
Avg Precision: 0.460920
Avg Recall: 1.000000
d_prime: 1.797842
train_loss: 0.049401
valid_loss: 1.333776
validation finished
normal learning rate scheduler step
Epoch-34 lr: 5.808096427970856e-07
Epoch-34 lr: 5.808096427970856e-07
epoch 34 training time: 15.271
---------------
2023-09-24 21:19:36.188202
current #epochs=35, #steps=1326
start validation
acc: 0.723005
AUC: 0.898126
Avg Precision: 0.460920
Avg Recall: 1.000000
d_prime: 1.797390
train_loss: 0.060254
valid_loss: 1.333767
validation finished
normal learning rate scheduler step
Epoch-35 lr: 4.501302746090234e-07
Epoch-35 lr: 4.501302746090234e-07
epoch 35 training time: 15.113
---------------
2023-09-24 21:19:51.300846
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00656	Per Sample Data Time 0.00100	Per Sample DNN Time 0.00556	Train Loss 0.0568	
start validation
acc: 0.723005
AUC: 0.898047
Avg Precision: 0.460920
Avg Recall: 1.000000
d_prime: 1.796759
train_loss: 0.057944
valid_loss: 1.333757
validation finished
normal learning rate scheduler step
Epoch-36 lr: 3.4885313395249907e-07
Epoch-36 lr: 3.4885313395249907e-07
epoch 36 training time: 15.460
---------------
2023-09-24 21:20:06.760579
current #epochs=37, #steps=1404
start validation
acc: 0.723005
AUC: 0.898047
Avg Precision: 0.460920
Avg Recall: 1.000000
d_prime: 1.796759
train_loss: 0.039264
valid_loss: 1.333744
validation finished
normal learning rate scheduler step
Epoch-37 lr: 2.7036286144980096e-07
Epoch-37 lr: 2.7036286144980096e-07
epoch 37 training time: 16.612
---------------
2023-09-24 21:20:23.372556
current #epochs=38, #steps=1443
start validation
acc: 0.723005
AUC: 0.898082
Avg Precision: 0.460920
Avg Recall: 1.000000
d_prime: 1.797041
train_loss: 0.042324
valid_loss: 1.333732
validation finished
normal learning rate scheduler step
Epoch-38 lr: 2.0953252167508765e-07
Epoch-38 lr: 2.0953252167508765e-07
epoch 38 training time: 15.243
---------------
2023-09-24 21:20:38.615714
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00748	Per Sample Data Time 0.00182	Per Sample DNN Time 0.00566	Train Loss 0.0464	
start validation
acc: 0.723005
AUC: 0.898082
Avg Precision: 0.460920
Avg Recall: 1.000000
d_prime: 1.797041
train_loss: 0.046716
valid_loss: 1.333736
validation finished
normal learning rate scheduler step
Epoch-39 lr: 1.6238871494438904e-07
Epoch-39 lr: 1.6238871494438904e-07
epoch 39 training time: 15.255
---------------
2023-09-24 21:20:53.870768
current #epochs=40, #steps=1521
start validation
acc: 0.723005
AUC: 0.898090
Avg Precision: 0.460920
Avg Recall: 1.000000
d_prime: 1.797100
train_loss: 0.043330
valid_loss: 1.333749
validation finished
normal learning rate scheduler step
Epoch-40 lr: 1.258520373375782e-07
Epoch-40 lr: 1.258520373375782e-07
epoch 40 training time: 15.200
---------------
2023-09-24 21:21:09.070539
current #epochs=41, #steps=1560
start validation
acc: 0.723005
AUC: 0.898082
Avg Precision: 0.460920
Avg Recall: 1.000000
d_prime: 1.797041
train_loss: 0.043484
valid_loss: 1.333752
validation finished
normal learning rate scheduler step
Epoch-41 lr: 9.753593596355043e-08
Epoch-41 lr: 9.753593596355043e-08
epoch 41 training time: 15.107
---------------
2023-09-24 21:21:24.177301
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02204	Per Sample Data Time 0.01526	Per Sample DNN Time 0.00678	Train Loss 0.0469	
start validation
acc: 0.723005
AUC: 0.898082
Avg Precision: 0.460920
Avg Recall: 1.000000
d_prime: 1.797041
train_loss: 0.046311
valid_loss: 1.333756
validation finished
normal learning rate scheduler step
Epoch-42 lr: 7.559082082054816e-08
Epoch-42 lr: 7.559082082054816e-08
epoch 42 training time: 15.194
---------------
2023-09-24 21:21:39.371610
current #epochs=43, #steps=1638
start validation
acc: 0.723005
AUC: 0.898082
Avg Precision: 0.460920
Avg Recall: 1.000000
d_prime: 1.797041
train_loss: 0.053978
valid_loss: 1.333760
validation finished
normal learning rate scheduler step
Epoch-43 lr: 5.85832507360113e-08
Epoch-43 lr: 5.85832507360113e-08
epoch 43 training time: 15.278
---------------
2023-09-24 21:21:54.649674
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00700	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00554	Train Loss 0.0577	
start validation
acc: 0.723005
AUC: 0.898082
Avg Precision: 0.460920
Avg Recall: 1.000000
d_prime: 1.797041
train_loss: 0.053368
valid_loss: 1.333761
validation finished
normal learning rate scheduler step
Epoch-44 lr: 4.5402301887234374e-08
Epoch-44 lr: 4.5402301887234374e-08
epoch 44 training time: 15.263
---------------
2023-09-24 21:22:09.913274
current #epochs=45, #steps=1716
start validation
[I 2023-09-24 21:22:25,099] Trial 72 finished with value: 0.46092008260384193 and parameters: {'warmup': 'True', 'num_epochs': 45, 'batch_size': 40, 'lr-adaptschedule': 'True', 'lr': 0.0007303154138649818, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7750048233381054}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.723005
AUC: 0.898090
Avg Precision: 0.460920
Avg Recall: 1.000000
d_prime: 1.797100
train_loss: 0.048139
valid_loss: 1.333763
validation finished
normal learning rate scheduler step
Epoch-45 lr: 3.5187002953259405e-08
Epoch-45 lr: 3.5187002953259405e-08
epoch 45 training time: 15.173
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa63cec7160>
The learning rate scheduler starts at 7 epoch with decay rate of 0.757 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 21:22:25.137709
current #epochs=1, #steps=0
start validation
acc: 0.718310
AUC: 0.895359
Avg Precision: 0.454724
Avg Recall: 1.000000
d_prime: 1.775604
train_loss: 0.054705
valid_loss: 1.327290
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0003315773618393245
Epoch-1 lr: 0.0003315773618393245
epoch 1 training time: 17.914
---------------
2023-09-24 21:22:43.052493
current #epochs=2, #steps=39
start validation
acc: 0.732394
AUC: 0.896824
Avg Precision: 0.467090
Avg Recall: 1.000000
d_prime: 1.787089
train_loss: 0.073858
valid_loss: 1.339926
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0003315773618393245
Epoch-2 lr: 0.0003315773618393245
epoch 2 training time: 17.995
---------------
2023-09-24 21:23:01.047231
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00557	Train Loss 0.0576	
start validation
acc: 0.723005
AUC: 0.901028
Avg Precision: 0.461545
Avg Recall: 1.000000
d_prime: 1.820706
train_loss: 0.058673
valid_loss: 1.332189
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0003315773618393245
Epoch-3 lr: 0.0003315773618393245
epoch 3 training time: 15.167
---------------
2023-09-24 21:23:16.214657
current #epochs=4, #steps=117
start validation
acc: 0.708920
AUC: 0.897164
Avg Precision: 0.473817
Avg Recall: 1.000000
d_prime: 1.789768
train_loss: 0.046979
valid_loss: 1.331814
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0003315773618393245
Epoch-4 lr: 0.0003315773618393245
epoch 4 training time: 17.703
---------------
2023-09-24 21:23:33.918330
current #epochs=5, #steps=156
start validation
acc: 0.713615
AUC: 0.892191
Avg Precision: 0.446387
Avg Recall: 1.000000
d_prime: 1.751174
train_loss: 0.043101
valid_loss: 1.344552
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0003315773618393245
Epoch-5 lr: 0.0003315773618393245
epoch 5 training time: 15.249
---------------
2023-09-24 21:23:49.166758
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01091	Per Sample Data Time 0.00503	Per Sample DNN Time 0.00588	Train Loss 0.0692	
start validation
acc: 0.690141
AUC: 0.894083
Avg Precision: 0.446763
Avg Recall: 1.000000
d_prime: 1.765697
train_loss: 0.056091
valid_loss: 1.328740
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0003315773618393245
Epoch-6 lr: 0.0003315773618393245
epoch 6 training time: 15.239
---------------
2023-09-24 21:24:04.405361
current #epochs=7, #steps=234
start validation
acc: 0.713615
AUC: 0.898948
Avg Precision: 0.453462
Avg Recall: 1.000000
d_prime: 1.803939
train_loss: 0.065816
valid_loss: 1.343694
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0002509034325393041
Epoch-7 lr: 0.0002509034325393041
epoch 7 training time: 15.208
---------------
2023-09-24 21:24:19.613788
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00683	Per Sample Data Time 0.00120	Per Sample DNN Time 0.00563	Train Loss 0.0554	
start validation
acc: 0.708920
AUC: 0.896834
Avg Precision: 0.445343
Avg Recall: 1.000000
d_prime: 1.787162
train_loss: 0.048768
valid_loss: 1.335516
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0002509034325393041
Epoch-8 lr: 0.0002509034325393041
epoch 8 training time: 15.212
---------------
2023-09-24 21:24:34.825365
current #epochs=9, #steps=312
start validation
acc: 0.713615
AUC: 0.900518
Avg Precision: 0.443672
Avg Recall: 1.000000
d_prime: 1.816571
train_loss: 0.049418
valid_loss: 1.327402
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00018985775178014295
Epoch-9 lr: 0.00018985775178014295
epoch 9 training time: 15.466
---------------
2023-09-24 21:24:50.291841
current #epochs=10, #steps=351
start validation
acc: 0.704225
AUC: 0.898683
Avg Precision: 0.442123
Avg Recall: 1.000000
d_prime: 1.801825
train_loss: 0.047793
valid_loss: 1.331694
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00018985775178014295
Epoch-10 lr: 0.00018985775178014295
epoch 10 training time: 15.166
---------------
2023-09-24 21:25:05.457959
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00862	Per Sample Data Time 0.00298	Per Sample DNN Time 0.00564	Train Loss 0.0171	
start validation
acc: 0.708920
AUC: 0.899047
Avg Precision: 0.446176
Avg Recall: 1.000000
d_prime: 1.804734
train_loss: 0.034872
valid_loss: 1.333795
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00014366469819165892
Epoch-11 lr: 0.00014366469819165892
epoch 11 training time: 15.181
---------------
2023-09-24 21:25:20.639129
current #epochs=12, #steps=429
start validation
acc: 0.708920
AUC: 0.896712
Avg Precision: 0.457902
Avg Recall: 1.000000
d_prime: 1.786207
train_loss: 0.045128
valid_loss: 1.332921
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00014366469819165892
Epoch-12 lr: 0.00014366469819165892
epoch 12 training time: 15.208
---------------
2023-09-24 21:25:35.846933
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00671	Per Sample Data Time 0.00111	Per Sample DNN Time 0.00560	Train Loss 0.0614	
start validation
acc: 0.708920
AUC: 0.899545
Avg Precision: 0.458817
Avg Recall: 1.000000
d_prime: 1.808729
train_loss: 0.059240
valid_loss: 1.330663
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00010871057574937067
Epoch-13 lr: 0.00010871057574937067
epoch 13 training time: 17.629
---------------
2023-09-24 21:25:53.476288
current #epochs=14, #steps=507
start validation
acc: 0.713615
AUC: 0.895903
Avg Precision: 0.458638
Avg Recall: 1.000000
d_prime: 1.779852
train_loss: 0.066356
valid_loss: 1.335763
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.00010871057574937067
Epoch-14 lr: 0.00010871057574937067
epoch 14 training time: 15.247
---------------
2023-09-24 21:26:08.722794
current #epochs=15, #steps=546
start validation
acc: 0.718310
AUC: 0.895715
Avg Precision: 0.459280
Avg Recall: 1.000000
d_prime: 1.778388
train_loss: 0.036776
valid_loss: 1.338377
validation finished
normal learning rate scheduler step
Epoch-15 lr: 8.226091328291117e-05
Epoch-15 lr: 8.226091328291117e-05
epoch 15 training time: 15.350
---------------
2023-09-24 21:26:24.072595
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00772	Per Sample Data Time 0.00209	Per Sample DNN Time 0.00563	Train Loss 0.0410	
start validation
acc: 0.713615
AUC: 0.894832
Avg Precision: 0.452957
Avg Recall: 1.000000
d_prime: 1.771502
train_loss: 0.044973
valid_loss: 1.337604
validation finished
normal learning rate scheduler step
Epoch-16 lr: 8.226091328291117e-05
Epoch-16 lr: 8.226091328291117e-05
epoch 16 training time: 15.298
---------------
2023-09-24 21:26:39.370590
current #epochs=17, #steps=624
start validation
acc: 0.694836
AUC: 0.894031
Avg Precision: 0.459014
Avg Recall: 1.000000
d_prime: 1.765300
train_loss: 0.034704
valid_loss: 1.335903
validation finished
normal learning rate scheduler step
Epoch-17 lr: 6.22465460006342e-05
Epoch-17 lr: 6.22465460006342e-05
epoch 17 training time: 15.166
---------------
2023-09-24 21:26:54.536320
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00649	Per Sample Data Time 0.00093	Per Sample DNN Time 0.00557	Train Loss 0.0513	
start validation
acc: 0.704225
AUC: 0.893747
Avg Precision: 0.459369
Avg Recall: 1.000000
d_prime: 1.763107
train_loss: 0.050361
valid_loss: 1.333738
validation finished
normal learning rate scheduler step
Epoch-18 lr: 6.22465460006342e-05
Epoch-18 lr: 6.22465460006342e-05
epoch 18 training time: 15.288
---------------
2023-09-24 21:27:09.824580
current #epochs=19, #steps=702
start validation
acc: 0.704225
AUC: 0.894521
Avg Precision: 0.459504
Avg Recall: 1.000000
d_prime: 1.769090
train_loss: 0.036003
valid_loss: 1.335114
validation finished
normal learning rate scheduler step
Epoch-19 lr: 4.710174412583362e-05
Epoch-19 lr: 4.710174412583362e-05
epoch 19 training time: 15.278
---------------
2023-09-24 21:27:25.102117
current #epochs=20, #steps=741
start validation
acc: 0.699531
AUC: 0.893433
Avg Precision: 0.459246
Avg Recall: 1.000000
d_prime: 1.760690
train_loss: 0.050379
valid_loss: 1.335328
validation finished
normal learning rate scheduler step
Epoch-20 lr: 4.710174412583362e-05
Epoch-20 lr: 4.710174412583362e-05
epoch 20 training time: 16.592
---------------
2023-09-24 21:27:41.693831
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00730	Per Sample Data Time 0.00161	Per Sample DNN Time 0.00569	Train Loss 0.0447	
start validation
acc: 0.704225
AUC: 0.893301
Avg Precision: 0.458339
Avg Recall: 1.000000
d_prime: 1.759675
train_loss: 0.045044
valid_loss: 1.336402
validation finished
normal learning rate scheduler step
Epoch-21 lr: 3.5641725400681634e-05
Epoch-21 lr: 3.5641725400681634e-05
epoch 21 training time: 15.859
---------------
2023-09-24 21:27:57.553359
current #epochs=22, #steps=819
start validation
acc: 0.704225
AUC: 0.893560
Avg Precision: 0.458925
Avg Recall: 1.000000
d_prime: 1.761665
train_loss: 0.044988
valid_loss: 1.336408
validation finished
normal learning rate scheduler step
Epoch-22 lr: 3.5641725400681634e-05
Epoch-22 lr: 3.5641725400681634e-05
epoch 22 training time: 15.318
---------------
2023-09-24 21:28:12.871747
current #epochs=23, #steps=858
start validation
acc: 0.704225
AUC: 0.894589
Avg Precision: 0.458925
Avg Recall: 1.000000
d_prime: 1.769621
train_loss: 0.077177
valid_loss: 1.334740
validation finished
normal learning rate scheduler step
Epoch-23 lr: 2.6969969225425404e-05
Epoch-23 lr: 2.6969969225425404e-05
epoch 23 training time: 15.226
---------------
2023-09-24 21:28:28.097637
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01375	Per Sample Data Time 0.00781	Per Sample DNN Time 0.00594	Train Loss 0.0659	
start validation
acc: 0.704225
AUC: 0.894568
Avg Precision: 0.457435
Avg Recall: 1.000000
d_prime: 1.769457
train_loss: 0.049215
valid_loss: 1.334915
validation finished
normal learning rate scheduler step
Epoch-24 lr: 2.6969969225425404e-05
Epoch-24 lr: 2.6969969225425404e-05
epoch 24 training time: 15.280
---------------
2023-09-24 21:28:43.377489
current #epochs=25, #steps=936
start validation
acc: 0.713615
AUC: 0.894809
Avg Precision: 0.457562
Avg Recall: 1.000000
d_prime: 1.771326
train_loss: 0.044024
valid_loss: 1.334206
validation finished
normal learning rate scheduler step
Epoch-25 lr: 2.040808159097939e-05
Epoch-25 lr: 2.040808159097939e-05
epoch 25 training time: 15.242
---------------
2023-09-24 21:28:58.619142
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00684	Per Sample Data Time 0.00128	Per Sample DNN Time 0.00556	Train Loss 0.0551	
start validation
acc: 0.708920
AUC: 0.895110
Avg Precision: 0.459073
Avg Recall: 1.000000
d_prime: 1.773662
train_loss: 0.047993
valid_loss: 1.334572
validation finished
normal learning rate scheduler step
Epoch-26 lr: 2.040808159097939e-05
Epoch-26 lr: 2.040808159097939e-05
epoch 26 training time: 15.142
---------------
2023-09-24 21:29:13.761588
current #epochs=27, #steps=1014
start validation
acc: 0.713615
AUC: 0.895250
Avg Precision: 0.458534
Avg Recall: 1.000000
d_prime: 1.774757
train_loss: 0.050131
valid_loss: 1.334669
validation finished
normal learning rate scheduler step
Epoch-27 lr: 1.5442724118180838e-05
Epoch-27 lr: 1.5442724118180838e-05
epoch 27 training time: 15.294
---------------
2023-09-24 21:29:29.055094
current #epochs=28, #steps=1053
start validation
acc: 0.713615
AUC: 0.895481
Avg Precision: 0.457971
Avg Recall: 1.000000
d_prime: 1.776554
train_loss: 0.054077
valid_loss: 1.335149
validation finished
normal learning rate scheduler step
Epoch-28 lr: 1.5442724118180838e-05
Epoch-28 lr: 1.5442724118180838e-05
epoch 28 training time: 15.459
---------------
2023-09-24 21:29:44.514581
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00918	Per Sample Data Time 0.00354	Per Sample DNN Time 0.00564	Train Loss 0.0545	
start validation
acc: 0.713615
AUC: 0.894987
Avg Precision: 0.457856
Avg Recall: 1.000000
d_prime: 1.772707
train_loss: 0.045424
valid_loss: 1.336154
validation finished
normal learning rate scheduler step
Epoch-29 lr: 1.1685455447005567e-05
Epoch-29 lr: 1.1685455447005567e-05
epoch 29 training time: 15.124
---------------
2023-09-24 21:29:59.638496
current #epochs=30, #steps=1131
start validation
acc: 0.713615
AUC: 0.894856
Avg Precision: 0.457216
Avg Recall: 1.000000
d_prime: 1.771688
train_loss: 0.036493
valid_loss: 1.336208
validation finished
normal learning rate scheduler step
Epoch-30 lr: 1.1685455447005567e-05
Epoch-30 lr: 1.1685455447005567e-05
epoch 30 training time: 15.717
---------------
2023-09-24 21:30:15.355893
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00672	Per Sample Data Time 0.00115	Per Sample DNN Time 0.00557	Train Loss 0.0464	
start validation
acc: 0.713615
AUC: 0.894771
Avg Precision: 0.457216
Avg Recall: 1.000000
d_prime: 1.771026
train_loss: 0.047957
valid_loss: 1.335599
validation finished
normal learning rate scheduler step
Epoch-31 lr: 8.842343355936202e-06
Epoch-31 lr: 8.842343355936202e-06
epoch 31 training time: 15.306
---------------
2023-09-24 21:30:30.661799
current #epochs=32, #steps=1209
start validation
acc: 0.713615
AUC: 0.894717
Avg Precision: 0.457216
Avg Recall: 1.000000
d_prime: 1.770610
train_loss: 0.050910
valid_loss: 1.335675
validation finished
normal learning rate scheduler step
Epoch-32 lr: 8.842343355936202e-06
Epoch-32 lr: 8.842343355936202e-06
epoch 32 training time: 15.314
---------------
2023-09-24 21:30:45.975984
current #epochs=33, #steps=1248
start validation
acc: 0.713615
AUC: 0.894697
Avg Precision: 0.457216
Avg Recall: 1.000000
d_prime: 1.770457
train_loss: 0.047766
valid_loss: 1.335907
validation finished
normal learning rate scheduler step
Epoch-33 lr: 6.690970358738114e-06
Epoch-33 lr: 6.690970358738114e-06
epoch 33 training time: 15.354
---------------
2023-09-24 21:31:01.330645
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00802	Per Sample Data Time 0.00229	Per Sample DNN Time 0.00572	Train Loss 0.0346	
start validation
acc: 0.713615
AUC: 0.894715
Avg Precision: 0.457216
Avg Recall: 1.000000
d_prime: 1.770593
train_loss: 0.044014
valid_loss: 1.336041
validation finished
normal learning rate scheduler step
Epoch-34 lr: 6.690970358738114e-06
Epoch-34 lr: 6.690970358738114e-06
epoch 34 training time: 15.154
---------------
2023-09-24 21:31:16.484567
current #epochs=35, #steps=1326
start validation
acc: 0.713615
AUC: 0.894736
Avg Precision: 0.456822
Avg Recall: 1.000000
d_prime: 1.770760
train_loss: 0.041824
valid_loss: 1.336128
validation finished
normal learning rate scheduler step
Epoch-35 lr: 5.063033919787434e-06
Epoch-35 lr: 5.063033919787434e-06
epoch 35 training time: 15.750
---------------
2023-09-24 21:31:32.233960
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00658	Per Sample Data Time 0.00099	Per Sample DNN Time 0.00559	Train Loss 0.0517	
start validation
acc: 0.713615
AUC: 0.894728
Avg Precision: 0.456822
Avg Recall: 1.000000
d_prime: 1.770693
train_loss: 0.049405
valid_loss: 1.335843
validation finished
normal learning rate scheduler step
Epoch-36 lr: 5.063033919787434e-06
Epoch-36 lr: 5.063033919787434e-06
epoch 36 training time: 15.429
---------------
2023-09-24 21:31:47.662842
current #epochs=37, #steps=1404
start validation
acc: 0.713615
AUC: 0.894826
Avg Precision: 0.456822
Avg Recall: 1.000000
d_prime: 1.771460
train_loss: 0.040742
valid_loss: 1.335635
validation finished
normal learning rate scheduler step
Epoch-37 lr: 3.831180097732883e-06
Epoch-37 lr: 3.831180097732883e-06
epoch 37 training time: 15.363
---------------
2023-09-24 21:32:03.025662
current #epochs=38, #steps=1443
start validation
[I 2023-09-24 21:32:18,271] Trial 73 finished with value: 0.456822496905324 and parameters: {'warmup': 'True', 'num_epochs': 38, 'batch_size': 33, 'lr-adaptschedule': 'True', 'lr': 0.0003315773618393245, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.7566965101220833}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.713615
AUC: 0.894868
Avg Precision: 0.456822
Avg Recall: 1.000000
d_prime: 1.771781
train_loss: 0.050770
valid_loss: 1.335705
validation finished
normal learning rate scheduler step
Epoch-38 lr: 3.831180097732883e-06
Epoch-38 lr: 3.831180097732883e-06
epoch 38 training time: 15.231
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f583400>
The learning rate scheduler starts at 6 epoch with decay rate of 0.766 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 21:32:18.311411
current #epochs=1, #steps=0
start validation
acc: 0.713615
AUC: 0.894777
Avg Precision: 0.457823
Avg Recall: 1.000000
d_prime: 1.771073
train_loss: 0.057872
valid_loss: 1.337530
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.00012433794216724122
Epoch-1 lr: 0.00012433794216724122
epoch 1 training time: 20.273
---------------
2023-09-24 21:32:38.584803
current #epochs=2, #steps=39
start validation
acc: 0.704225
AUC: 0.896536
Avg Precision: 0.457836
Avg Recall: 1.000000
d_prime: 1.784823
train_loss: 0.046060
valid_loss: 1.338354
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.00012433794216724122
Epoch-2 lr: 0.00012433794216724122
epoch 2 training time: 15.216
---------------
2023-09-24 21:32:53.800359
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00572	Train Loss 0.0253	
start validation
acc: 0.708920
AUC: 0.895528
Avg Precision: 0.457819
Avg Recall: 1.000000
d_prime: 1.776926
train_loss: 0.026424
valid_loss: 1.333180
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.00012433794216724122
Epoch-3 lr: 0.00012433794216724122
epoch 3 training time: 15.549
---------------
2023-09-24 21:33:09.349790
current #epochs=4, #steps=117
start validation
acc: 0.704225
AUC: 0.899217
Avg Precision: 0.463834
Avg Recall: 1.000000
d_prime: 1.806092
train_loss: 0.052999
valid_loss: 1.335920
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00012433794216724122
Epoch-4 lr: 0.00012433794216724122
epoch 4 training time: 15.465
---------------
2023-09-24 21:33:24.814552
current #epochs=5, #steps=156
start validation
acc: 0.713615
AUC: 0.898530
Avg Precision: 0.447754
Avg Recall: 1.000000
d_prime: 1.800605
train_loss: 0.055300
valid_loss: 1.332829
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00012433794216724122
Epoch-5 lr: 0.00012433794216724122
epoch 5 training time: 15.126
---------------
2023-09-24 21:33:39.940149
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01127	Per Sample Data Time 0.00530	Per Sample DNN Time 0.00597	Train Loss 0.0422	
start validation
acc: 0.718310
AUC: 0.895787
Avg Precision: 0.442156
Avg Recall: 1.000000
d_prime: 1.778947
train_loss: 0.051275
valid_loss: 1.335140
validation finished
normal learning rate scheduler step
Epoch-6 lr: 9.526502318561414e-05
Epoch-6 lr: 9.526502318561414e-05
epoch 6 training time: 17.873
---------------
2023-09-24 21:33:57.813384
current #epochs=7, #steps=234
start validation
acc: 0.713615
AUC: 0.897488
Avg Precision: 0.443258
Avg Recall: 1.000000
d_prime: 1.792326
train_loss: 0.041067
valid_loss: 1.334022
validation finished
normal learning rate scheduler step
Epoch-7 lr: 7.298998587533856e-05
Epoch-7 lr: 7.298998587533856e-05
epoch 7 training time: 15.291
---------------
2023-09-24 21:34:13.104333
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00680	Per Sample Data Time 0.00120	Per Sample DNN Time 0.00560	Train Loss 0.0624	
start validation
acc: 0.708920
AUC: 0.899082
Avg Precision: 0.443449
Avg Recall: 1.000000
d_prime: 1.805013
train_loss: 0.063765
valid_loss: 1.332751
validation finished
normal learning rate scheduler step
Epoch-8 lr: 5.592333744255707e-05
Epoch-8 lr: 5.592333744255707e-05
epoch 8 training time: 15.223
---------------
2023-09-24 21:34:28.327758
current #epochs=9, #steps=312
start validation
acc: 0.708920
AUC: 0.899656
Avg Precision: 0.444162
Avg Recall: 1.000000
d_prime: 1.809622
train_loss: 0.047109
valid_loss: 1.331186
validation finished
normal learning rate scheduler step
Epoch-9 lr: 4.2847243128057385e-05
Epoch-9 lr: 4.2847243128057385e-05
epoch 9 training time: 15.268
---------------
2023-09-24 21:34:43.595752
current #epochs=10, #steps=351
start validation
acc: 0.708920
AUC: 0.898719
Avg Precision: 0.450150
Avg Recall: 1.000000
d_prime: 1.802114
train_loss: 0.047023
valid_loss: 1.330236
validation finished
normal learning rate scheduler step
Epoch-10 lr: 3.282862446399293e-05
Epoch-10 lr: 3.282862446399293e-05
epoch 10 training time: 15.141
---------------
2023-09-24 21:34:58.736999
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00867	Per Sample Data Time 0.00289	Per Sample DNN Time 0.00578	Train Loss 0.0349	
start validation
acc: 0.708920
AUC: 0.898252
Avg Precision: 0.449693
Avg Recall: 1.000000
d_prime: 1.798388
train_loss: 0.052461
valid_loss: 1.330287
validation finished
normal learning rate scheduler step
Epoch-11 lr: 2.5152577050917882e-05
Epoch-11 lr: 2.5152577050917882e-05
epoch 11 training time: 15.274
---------------
2023-09-24 21:35:14.011146
current #epochs=12, #steps=429
start validation
acc: 0.713615
AUC: 0.898636
Avg Precision: 0.450284
Avg Recall: 1.000000
d_prime: 1.801454
train_loss: 0.044016
valid_loss: 1.331288
validation finished
normal learning rate scheduler step
Epoch-12 lr: 1.92713567087243e-05
Epoch-12 lr: 1.92713567087243e-05
epoch 12 training time: 15.161
---------------
2023-09-24 21:35:29.172224
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00666	Per Sample Data Time 0.00107	Per Sample DNN Time 0.00558	Train Loss 0.0416	
start validation
acc: 0.713615
AUC: 0.898858
Avg Precision: 0.456530
Avg Recall: 1.000000
d_prime: 1.803224
train_loss: 0.040239
valid_loss: 1.332640
validation finished
normal learning rate scheduler step
Epoch-13 lr: 1.476529377658105e-05
Epoch-13 lr: 1.476529377658105e-05
epoch 13 training time: 15.369
---------------
2023-09-24 21:35:44.541622
current #epochs=14, #steps=507
start validation
acc: 0.713615
AUC: 0.898454
Avg Precision: 0.450397
Avg Recall: 1.000000
d_prime: 1.800001
train_loss: 0.050401
valid_loss: 1.333174
validation finished
normal learning rate scheduler step
Epoch-14 lr: 1.1312846500840618e-05
Epoch-14 lr: 1.1312846500840618e-05
epoch 14 training time: 15.370
---------------
2023-09-24 21:35:59.911613
current #epochs=15, #steps=546
start validation
acc: 0.713615
AUC: 0.898609
Avg Precision: 0.450397
Avg Recall: 1.000000
d_prime: 1.801232
train_loss: 0.056899
valid_loss: 1.332475
validation finished
normal learning rate scheduler step
Epoch-15 lr: 8.667656593095981e-06
Epoch-15 lr: 8.667656593095981e-06
epoch 15 training time: 15.139
---------------
2023-09-24 21:36:15.050432
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00767	Per Sample Data Time 0.00207	Per Sample DNN Time 0.00559	Train Loss 0.0635	
start validation
acc: 0.713615
AUC: 0.898755
Avg Precision: 0.450397
Avg Recall: 1.000000
d_prime: 1.802399
train_loss: 0.053875
valid_loss: 1.332885
validation finished
normal learning rate scheduler step
Epoch-16 lr: 6.640969698497873e-06
Epoch-16 lr: 6.640969698497873e-06
epoch 16 training time: 15.271
---------------
2023-09-24 21:36:30.321296
current #epochs=17, #steps=624
start validation
acc: 0.713615
AUC: 0.898755
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.802397
train_loss: 0.050837
valid_loss: 1.332749
validation finished
normal learning rate scheduler step
Epoch-17 lr: 5.088166341464857e-06
Epoch-17 lr: 5.088166341464857e-06
epoch 17 training time: 15.274
---------------
2023-09-24 21:36:45.594681
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00644	Per Sample Data Time 0.00092	Per Sample DNN Time 0.00552	Train Loss 0.0517	
start validation
acc: 0.713615
AUC: 0.898782
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.802619
train_loss: 0.050756
valid_loss: 1.332768
validation finished
normal learning rate scheduler step
Epoch-18 lr: 3.898442229644841e-06
Epoch-18 lr: 3.898442229644841e-06
epoch 18 training time: 15.095
---------------
2023-09-24 21:37:00.689226
current #epochs=19, #steps=702
start validation
acc: 0.713615
AUC: 0.898905
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.803599
train_loss: 0.038986
valid_loss: 1.332696
validation finished
normal learning rate scheduler step
Epoch-19 lr: 2.986901527575227e-06
Epoch-19 lr: 2.986901527575227e-06
epoch 19 training time: 15.352
---------------
2023-09-24 21:37:16.040903
current #epochs=20, #steps=741
start validation
acc: 0.713615
AUC: 0.898915
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.803677
train_loss: 0.040753
valid_loss: 1.332659
validation finished
normal learning rate scheduler step
Epoch-20 lr: 2.288498895171266e-06
Epoch-20 lr: 2.288498895171266e-06
epoch 20 training time: 15.379
---------------
2023-09-24 21:37:31.420270
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00735	Per Sample Data Time 0.00163	Per Sample DNN Time 0.00573	Train Loss 0.0445	
start validation
acc: 0.713615
AUC: 0.898992
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804297
train_loss: 0.038961
valid_loss: 1.332552
validation finished
normal learning rate scheduler step
Epoch-21 lr: 1.7533980095593233e-06
Epoch-21 lr: 1.7533980095593233e-06
epoch 21 training time: 15.382
---------------
2023-09-24 21:37:46.802236
current #epochs=22, #steps=819
start validation
acc: 0.713615
AUC: 0.899029
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804587
train_loss: 0.047163
valid_loss: 1.332474
validation finished
normal learning rate scheduler step
Epoch-22 lr: 1.343415365597769e-06
Epoch-22 lr: 1.343415365597769e-06
epoch 22 training time: 15.163
---------------
2023-09-24 21:38:01.965492
current #epochs=23, #steps=858
start validation
acc: 0.713615
AUC: 0.898971
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804126
train_loss: 0.032200
valid_loss: 1.332386
validation finished
normal learning rate scheduler step
Epoch-23 lr: 1.029295593290752e-06
Epoch-23 lr: 1.029295593290752e-06
epoch 23 training time: 15.371
---------------
2023-09-24 21:38:17.336472
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01393	Per Sample Data Time 0.00778	Per Sample DNN Time 0.00615	Train Loss 0.0246	
start validation
acc: 0.713615
AUC: 0.898989
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804271
train_loss: 0.050823
valid_loss: 1.332379
validation finished
normal learning rate scheduler step
Epoch-24 lr: 7.886238653347144e-07
Epoch-24 lr: 7.886238653347144e-07
epoch 24 training time: 15.088
---------------
2023-09-24 21:38:32.424211
current #epochs=25, #steps=936
start validation
acc: 0.713615
AUC: 0.899070
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804916
train_loss: 0.054684
valid_loss: 1.332390
validation finished
normal learning rate scheduler step
Epoch-25 lr: 6.042264292486733e-07
Epoch-25 lr: 6.042264292486733e-07
epoch 25 training time: 15.275
---------------
2023-09-24 21:38:47.699074
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00700	Per Sample Data Time 0.00136	Per Sample DNN Time 0.00564	Train Loss 0.0398	
start validation
acc: 0.713615
AUC: 0.899058
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804822
train_loss: 0.036778
valid_loss: 1.332382
validation finished
normal learning rate scheduler step
Epoch-26 lr: 4.6294512992914264e-07
Epoch-26 lr: 4.6294512992914264e-07
epoch 26 training time: 15.281
---------------
2023-09-24 21:39:02.980410
current #epochs=27, #steps=1014
start validation
acc: 0.713615
AUC: 0.899079
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804993
train_loss: 0.047678
valid_loss: 1.332374
validation finished
normal learning rate scheduler step
Epoch-27 lr: 3.546984755228353e-07
Epoch-27 lr: 3.546984755228353e-07
epoch 27 training time: 15.217
---------------
2023-09-24 21:39:18.197366
current #epochs=28, #steps=1053
start validation
acc: 0.713615
AUC: 0.899090
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.805078
train_loss: 0.054346
valid_loss: 1.332399
validation finished
normal learning rate scheduler step
Epoch-28 lr: 2.717622465484835e-07
Epoch-28 lr: 2.717622465484835e-07
epoch 28 training time: 16.322
---------------
2023-09-24 21:39:34.519150
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00937	Per Sample Data Time 0.00346	Per Sample DNN Time 0.00591	Train Loss 0.0372	
start validation
acc: 0.713615
AUC: 0.899047
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804736
train_loss: 0.049930
valid_loss: 1.332407
validation finished
normal learning rate scheduler step
Epoch-29 lr: 2.0821831427444073e-07
Epoch-29 lr: 2.0821831427444073e-07
epoch 29 training time: 15.210
---------------
2023-09-24 21:39:49.728799
current #epochs=30, #steps=1131
start validation
acc: 0.713615
AUC: 0.899069
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804907
train_loss: 0.060220
valid_loss: 1.332395
validation finished
normal learning rate scheduler step
Epoch-30 lr: 1.5953233736443622e-07
Epoch-30 lr: 1.5953233736443622e-07
epoch 30 training time: 15.154
---------------
2023-09-24 21:40:04.882405
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00671	Per Sample Data Time 0.00111	Per Sample DNN Time 0.00560	Train Loss 0.0623	
start validation
acc: 0.713615
AUC: 0.899069
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804907
train_loss: 0.064241
valid_loss: 1.332402
validation finished
normal learning rate scheduler step
Epoch-31 lr: 1.222302022453959e-07
Epoch-31 lr: 1.222302022453959e-07
epoch 31 training time: 15.187
---------------
2023-09-24 21:40:20.069456
current #epochs=32, #steps=1209
start validation
acc: 0.713615
AUC: 0.899069
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804907
train_loss: 0.056045
valid_loss: 1.332408
validation finished
normal learning rate scheduler step
Epoch-32 lr: 9.365011876445394e-08
Epoch-32 lr: 9.365011876445394e-08
epoch 32 training time: 15.219
---------------
2023-09-24 21:40:35.288278
current #epochs=33, #steps=1248
start validation
acc: 0.713615
AUC: 0.899069
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804907
train_loss: 0.049132
valid_loss: 1.332408
validation finished
normal learning rate scheduler step
Epoch-33 lr: 7.175268128075673e-08
Epoch-33 lr: 7.175268128075673e-08
epoch 33 training time: 15.260
---------------
2023-09-24 21:40:50.548376
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00804	Per Sample Data Time 0.00238	Per Sample DNN Time 0.00566	Train Loss 0.0264	
start validation
acc: 0.713615
AUC: 0.899069
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804907
train_loss: 0.051455
valid_loss: 1.332414
validation finished
normal learning rate scheduler step
Epoch-34 lr: 5.49753416109069e-08
Epoch-34 lr: 5.49753416109069e-08
epoch 34 training time: 16.340
---------------
2023-09-24 21:41:06.888416
current #epochs=35, #steps=1326
start validation
acc: 0.713615
AUC: 0.899069
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804907
train_loss: 0.049247
valid_loss: 1.332416
validation finished
normal learning rate scheduler step
Epoch-35 lr: 4.212090936936814e-08
Epoch-35 lr: 4.212090936936814e-08
epoch 35 training time: 15.210
---------------
2023-09-24 21:41:22.097964
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00650	Per Sample Data Time 0.00097	Per Sample DNN Time 0.00554	Train Loss 0.0372	
start validation
acc: 0.713615
AUC: 0.899069
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804907
train_loss: 0.040431
valid_loss: 1.332415
validation finished
normal learning rate scheduler step
Epoch-36 lr: 3.227212335776619e-08
Epoch-36 lr: 3.227212335776619e-08
epoch 36 training time: 15.196
---------------
2023-09-24 21:41:37.294180
current #epochs=37, #steps=1404
start validation
acc: 0.713615
AUC: 0.899069
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804907
train_loss: 0.047933
valid_loss: 1.332414
validation finished
normal learning rate scheduler step
Epoch-37 lr: 2.4726198024021953e-08
Epoch-37 lr: 2.4726198024021953e-08
epoch 37 training time: 16.191
---------------
2023-09-24 21:41:53.485044
current #epochs=38, #steps=1443
start validation
acc: 0.713615
AUC: 0.899069
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804907
train_loss: 0.050558
valid_loss: 1.332414
validation finished
normal learning rate scheduler step
Epoch-38 lr: 1.894467438492916e-08
Epoch-38 lr: 1.894467438492916e-08
epoch 38 training time: 15.341
---------------
2023-09-24 21:42:08.826646
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00730	Per Sample Data Time 0.00167	Per Sample DNN Time 0.00562	Train Loss 0.0555	
start validation
acc: 0.713615
AUC: 0.899069
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804907
train_loss: 0.049728
valid_loss: 1.332414
validation finished
normal learning rate scheduler step
Epoch-39 lr: 1.451499689528946e-08
Epoch-39 lr: 1.451499689528946e-08
epoch 39 training time: 15.969
---------------
2023-09-24 21:42:24.795578
current #epochs=40, #steps=1521
start validation
acc: 0.713615
AUC: 0.899069
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804907
train_loss: 0.033249
valid_loss: 1.332414
validation finished
normal learning rate scheduler step
Epoch-40 lr: 1.1121074481906461e-08
Epoch-40 lr: 1.1121074481906461e-08
epoch 40 training time: 15.261
---------------
2023-09-24 21:42:40.056460
current #epochs=41, #steps=1560
start validation
acc: 0.713615
AUC: 0.899069
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804907
train_loss: 0.034479
valid_loss: 1.332414
validation finished
normal learning rate scheduler step
Epoch-41 lr: 8.520725049017976e-09
Epoch-41 lr: 8.520725049017976e-09
epoch 41 training time: 15.149
---------------
2023-09-24 21:42:55.205751
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02173	Per Sample Data Time 0.01546	Per Sample DNN Time 0.00627	Train Loss 0.0258	
start validation
acc: 0.713615
AUC: 0.899069
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804907
train_loss: 0.043588
valid_loss: 1.332414
validation finished
normal learning rate scheduler step
Epoch-42 lr: 6.528393949620978e-09
Epoch-42 lr: 6.528393949620978e-09
epoch 42 training time: 15.998
---------------
2023-09-24 21:43:11.203870
current #epochs=43, #steps=1638
start validation
acc: 0.713615
AUC: 0.899069
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804907
train_loss: 0.050427
valid_loss: 1.332414
validation finished
normal learning rate scheduler step
Epoch-43 lr: 5.001913254595604e-09
Epoch-43 lr: 5.001913254595604e-09
epoch 43 training time: 15.243
---------------
2023-09-24 21:43:26.446670
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00704	Per Sample Data Time 0.00137	Per Sample DNN Time 0.00567	Train Loss 0.0379	
start validation
acc: 0.713615
AUC: 0.899069
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804907
train_loss: 0.035416
valid_loss: 1.332413
validation finished
normal learning rate scheduler step
Epoch-44 lr: 3.832356993093491e-09
Epoch-44 lr: 3.832356993093491e-09
epoch 44 training time: 15.215
---------------
2023-09-24 21:43:41.662130
current #epochs=45, #steps=1716
start validation
acc: 0.713615
AUC: 0.899069
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804907
train_loss: 0.051340
valid_loss: 1.332413
validation finished
normal learning rate scheduler step
Epoch-45 lr: 2.9362684586780177e-09
Epoch-45 lr: 2.9362684586780177e-09
epoch 45 training time: 15.217
---------------
2023-09-24 21:43:56.878768
current #epochs=46, #steps=1755
start validation
acc: 0.713615
AUC: 0.899069
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804907
train_loss: 0.045369
valid_loss: 1.332413
validation finished
normal learning rate scheduler step
Epoch-46 lr: 2.249704940579646e-09
Epoch-46 lr: 2.249704940579646e-09
epoch 46 training time: 16.568
---------------
2023-09-24 21:44:13.446787
current #epochs=47, #steps=1794
Epoch: [47][6/39]	Per Sample Total Time 0.01059	Per Sample Data Time 0.00457	Per Sample DNN Time 0.00603	Train Loss 0.0211	
start validation
acc: 0.713615
AUC: 0.899069
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804907
train_loss: 0.037780
valid_loss: 1.332413
validation finished
normal learning rate scheduler step
Epoch-47 lr: 1.7236749264905892e-09
Epoch-47 lr: 1.7236749264905892e-09
epoch 47 training time: 15.250
---------------
2023-09-24 21:44:28.696796
current #epochs=48, #steps=1833
start validation
[I 2023-09-24 21:44:46,415] Trial 74 finished with value: 0.4507786687124374 and parameters: {'warmup': 'True', 'num_epochs': 48, 'batch_size': 44, 'lr-adaptschedule': 'True', 'lr': 0.00012433794216724122, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7661782198186742}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.713615
AUC: 0.899069
Avg Precision: 0.450779
Avg Recall: 1.000000
d_prime: 1.804907
train_loss: 0.055431
valid_loss: 1.332413
validation finished
normal learning rate scheduler step
Epoch-48 lr: 1.3206421867246437e-09
Epoch-48 lr: 1.3206421867246437e-09
epoch 48 training time: 17.705
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f4df580>
The learning rate scheduler starts at 7 epoch with decay rate of 0.749 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 21:44:46.455050
current #epochs=1, #steps=0
start validation
acc: 0.694836
AUC: 0.888883
Avg Precision: 0.458579
Avg Recall: 1.000000
d_prime: 1.726206
train_loss: 0.049347
valid_loss: 1.340100
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0004954035253085982
Epoch-1 lr: 0.0004954035253085982
epoch 1 training time: 19.615
---------------
2023-09-24 21:45:06.070281
current #epochs=2, #steps=39
start validation
acc: 0.718310
AUC: 0.901376
Avg Precision: 0.438389
Avg Recall: 1.000000
d_prime: 1.823534
train_loss: 0.056425
valid_loss: 1.341001
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0004954035253085982
Epoch-2 lr: 0.0004954035253085982
epoch 2 training time: 19.163
---------------
2023-09-24 21:45:25.232934
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00559	Train Loss 0.0663	
start validation
acc: 0.694836
AUC: 0.897024
Avg Precision: 0.476276
Avg Recall: 1.000000
d_prime: 1.788664
train_loss: 0.066185
valid_loss: 1.333055
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0004954035253085982
Epoch-3 lr: 0.0004954035253085982
epoch 3 training time: 16.881
---------------
2023-09-24 21:45:42.114163
current #epochs=4, #steps=117
start validation
acc: 0.723005
AUC: 0.898892
Avg Precision: 0.482115
Avg Recall: 1.000000
d_prime: 1.803496
train_loss: 0.050821
valid_loss: 1.317991
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0004954035253085982
Epoch-4 lr: 0.0004954035253085982
epoch 4 training time: 17.920
---------------
2023-09-24 21:46:00.034591
current #epochs=5, #steps=156
start validation
acc: 0.713615
AUC: 0.899021
Avg Precision: 0.459698
Avg Recall: 1.000000
d_prime: 1.804523
train_loss: 0.033351
valid_loss: 1.333497
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0004954035253085982
Epoch-5 lr: 0.0004954035253085982
epoch 5 training time: 15.234
---------------
2023-09-24 21:46:15.268039
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01129	Per Sample Data Time 0.00551	Per Sample DNN Time 0.00578	Train Loss 0.0383	
start validation
acc: 0.741784
AUC: 0.901756
Avg Precision: 0.461604
Avg Recall: 1.000000
d_prime: 1.826628
train_loss: 0.069192
valid_loss: 1.326243
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0004954035253085982
Epoch-6 lr: 0.0004954035253085982
epoch 6 training time: 18.229
---------------
2023-09-24 21:46:33.497199
current #epochs=7, #steps=234
start validation
acc: 0.704225
AUC: 0.900654
Avg Precision: 0.464962
Avg Recall: 1.000000
d_prime: 1.817668
train_loss: 0.059080
valid_loss: 1.341986
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00037090668131753934
Epoch-7 lr: 0.00037090668131753934
epoch 7 training time: 15.231
---------------
2023-09-24 21:46:48.728542
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00683	Per Sample Data Time 0.00121	Per Sample DNN Time 0.00562	Train Loss 0.0651	
start validation
acc: 0.718310
AUC: 0.898747
Avg Precision: 0.463312
Avg Recall: 1.000000
d_prime: 1.802339
train_loss: 0.062293
valid_loss: 1.311566
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0002776963812687729
Epoch-8 lr: 0.0002776963812687729
epoch 8 training time: 15.357
---------------
2023-09-24 21:47:04.085683
current #epochs=9, #steps=312
start validation
acc: 0.732394
AUC: 0.888132
Avg Precision: 0.460441
Avg Recall: 1.000000
d_prime: 1.720608
train_loss: 0.043809
valid_loss: 1.327313
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0002079101942726991
Epoch-9 lr: 0.0002079101942726991
epoch 9 training time: 15.183
---------------
2023-09-24 21:47:19.269234
current #epochs=10, #steps=351
start validation
acc: 0.713615
AUC: 0.884327
Avg Precision: 0.456484
Avg Recall: 1.000000
d_prime: 1.692674
train_loss: 0.052492
valid_loss: 1.338104
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00015566154908109466
Epoch-10 lr: 0.00015566154908109466
epoch 10 training time: 15.239
---------------
2023-09-24 21:47:34.508531
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00869	Per Sample Data Time 0.00286	Per Sample DNN Time 0.00583	Train Loss 0.0333	
start validation
acc: 0.732394
AUC: 0.893799
Avg Precision: 0.448719
Avg Recall: 1.000000
d_prime: 1.763504
train_loss: 0.046420
valid_loss: 1.331628
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00011654319282942337
Epoch-11 lr: 0.00011654319282942337
epoch 11 training time: 15.245
---------------
2023-09-24 21:47:49.753518
current #epochs=12, #steps=429
start validation
acc: 0.723005
AUC: 0.893991
Avg Precision: 0.444317
Avg Recall: 1.000000
d_prime: 1.764993
train_loss: 0.037500
valid_loss: 1.331929
validation finished
normal learning rate scheduler step
Epoch-12 lr: 8.725543253973536e-05
Epoch-12 lr: 8.725543253973536e-05
epoch 12 training time: 15.369
---------------
2023-09-24 21:48:05.122085
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00667	Per Sample Data Time 0.00107	Per Sample DNN Time 0.00560	Train Loss 0.0334	
start validation
acc: 0.718310
AUC: 0.894818
Avg Precision: 0.449497
Avg Recall: 1.000000
d_prime: 1.771392
train_loss: 0.039584
valid_loss: 1.328508
validation finished
normal learning rate scheduler step
Epoch-13 lr: 6.532780098825423e-05
Epoch-13 lr: 6.532780098825423e-05
epoch 13 training time: 15.207
---------------
2023-09-24 21:48:20.329245
current #epochs=14, #steps=507
start validation
acc: 0.727700
AUC: 0.895289
Avg Precision: 0.450765
Avg Recall: 1.000000
d_prime: 1.775060
train_loss: 0.046557
valid_loss: 1.328059
validation finished
normal learning rate scheduler step
Epoch-14 lr: 4.891066902931766e-05
Epoch-14 lr: 4.891066902931766e-05
epoch 14 training time: 15.484
---------------
2023-09-24 21:48:35.813682
current #epochs=15, #steps=546
start validation
acc: 0.727700
AUC: 0.895349
Avg Precision: 0.450009
Avg Recall: 1.000000
d_prime: 1.775523
train_loss: 0.041442
valid_loss: 1.327109
validation finished
normal learning rate scheduler step
Epoch-15 lr: 3.661922655755051e-05
Epoch-15 lr: 3.661922655755051e-05
epoch 15 training time: 15.286
---------------
2023-09-24 21:48:51.099005
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00774	Per Sample Data Time 0.00210	Per Sample DNN Time 0.00565	Train Loss 0.0404	
start validation
acc: 0.727700
AUC: 0.895559
Avg Precision: 0.450775
Avg Recall: 1.000000
d_prime: 1.777169
train_loss: 0.047688
valid_loss: 1.328850
validation finished
normal learning rate scheduler step
Epoch-16 lr: 2.741667166461002e-05
Epoch-16 lr: 2.741667166461002e-05
epoch 16 training time: 15.196
---------------
2023-09-24 21:49:06.295158
current #epochs=17, #steps=624
start validation
acc: 0.713615
AUC: 0.894809
Avg Precision: 0.450488
Avg Recall: 1.000000
d_prime: 1.771325
train_loss: 0.041875
valid_loss: 1.329377
validation finished
normal learning rate scheduler step
Epoch-17 lr: 2.0526754817819674e-05
Epoch-17 lr: 2.0526754817819674e-05
epoch 17 training time: 15.176
---------------
2023-09-24 21:49:21.471169
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00648	Per Sample Data Time 0.00094	Per Sample DNN Time 0.00554	Train Loss 0.0457	
start validation
acc: 0.713615
AUC: 0.894883
Avg Precision: 0.450781
Avg Recall: 1.000000
d_prime: 1.771901
train_loss: 0.044725
valid_loss: 1.330376
validation finished
normal learning rate scheduler step
Epoch-18 lr: 1.5368301028850524e-05
Epoch-18 lr: 1.5368301028850524e-05
epoch 18 training time: 15.172
---------------
2023-09-24 21:49:36.642986
current #epochs=19, #steps=702
start validation
acc: 0.718310
AUC: 0.894923
Avg Precision: 0.450887
Avg Recall: 1.000000
d_prime: 1.772209
train_loss: 0.036090
valid_loss: 1.331657
validation finished
normal learning rate scheduler step
Epoch-19 lr: 1.1506186857570471e-05
Epoch-19 lr: 1.1506186857570471e-05
epoch 19 training time: 15.717
---------------
2023-09-24 21:49:52.360546
current #epochs=20, #steps=741
start validation
acc: 0.718310
AUC: 0.894752
Avg Precision: 0.451030
Avg Recall: 1.000000
d_prime: 1.770883
train_loss: 0.062105
valid_loss: 1.332253
validation finished
normal learning rate scheduler step
Epoch-20 lr: 8.61463708661033e-06
Epoch-20 lr: 8.61463708661033e-06
epoch 20 training time: 15.267
---------------
2023-09-24 21:50:07.627228
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00722	Per Sample Data Time 0.00157	Per Sample DNN Time 0.00565	Train Loss 0.0419	
start validation
acc: 0.723005
AUC: 0.894601
Avg Precision: 0.451387
Avg Recall: 1.000000
d_prime: 1.769713
train_loss: 0.041682
valid_loss: 1.332185
validation finished
normal learning rate scheduler step
Epoch-21 lr: 6.449745085199491e-06
Epoch-21 lr: 6.449745085199491e-06
epoch 21 training time: 15.199
---------------
2023-09-24 21:50:22.826267
current #epochs=22, #steps=819
start validation
acc: 0.723005
AUC: 0.894598
Avg Precision: 0.451387
Avg Recall: 1.000000
d_prime: 1.769687
train_loss: 0.033275
valid_loss: 1.331835
validation finished
normal learning rate scheduler step
Epoch-22 lr: 4.828898913073466e-06
Epoch-22 lr: 4.828898913073466e-06
epoch 22 training time: 16.168
---------------
2023-09-24 21:50:38.994044
current #epochs=23, #steps=858
start validation
acc: 0.723005
AUC: 0.894612
Avg Precision: 0.451387
Avg Recall: 1.000000
d_prime: 1.769797
train_loss: 0.027471
valid_loss: 1.331554
validation finished
normal learning rate scheduler step
Epoch-23 lr: 3.6153777249571504e-06
Epoch-23 lr: 3.6153777249571504e-06
epoch 23 training time: 17.010
---------------
2023-09-24 21:50:56.004692
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01371	Per Sample Data Time 0.00760	Per Sample DNN Time 0.00611	Train Loss 0.0450	
start validation
acc: 0.723005
AUC: 0.894764
Avg Precision: 0.451387
Avg Recall: 1.000000
d_prime: 1.770975
train_loss: 0.038737
valid_loss: 1.331216
validation finished
normal learning rate scheduler step
Epoch-24 lr: 2.7068191588622477e-06
Epoch-24 lr: 2.7068191588622477e-06
epoch 24 training time: 15.266
---------------
2023-09-24 21:51:11.269996
current #epochs=25, #steps=936
start validation
acc: 0.723005
AUC: 0.894614
Avg Precision: 0.451387
Avg Recall: 1.000000
d_prime: 1.769810
train_loss: 0.037273
valid_loss: 1.331051
validation finished
normal learning rate scheduler step
Epoch-25 lr: 2.0265849148225765e-06
Epoch-25 lr: 2.0265849148225765e-06
epoch 25 training time: 15.409
---------------
2023-09-24 21:51:26.678722
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00691	Per Sample Data Time 0.00131	Per Sample DNN Time 0.00560	Train Loss 0.0518	
start validation
acc: 0.723005
AUC: 0.894677
Avg Precision: 0.451387
Avg Recall: 1.000000
d_prime: 1.770300
train_loss: 0.048812
valid_loss: 1.330990
validation finished
normal learning rate scheduler step
Epoch-26 lr: 1.5172961974721416e-06
Epoch-26 lr: 1.5172961974721416e-06
epoch 26 training time: 15.332
---------------
2023-09-24 21:51:42.010716
current #epochs=27, #steps=1014
start validation
acc: 0.723005
AUC: 0.894698
Avg Precision: 0.451387
Avg Recall: 1.000000
d_prime: 1.770466
train_loss: 0.062984
valid_loss: 1.331065
validation finished
normal learning rate scheduler step
Epoch-27 lr: 1.1359937271934998e-06
Epoch-27 lr: 1.1359937271934998e-06
epoch 27 training time: 15.217
---------------
2023-09-24 21:51:57.228448
current #epochs=28, #steps=1053
start validation
acc: 0.723005
AUC: 0.894627
Avg Precision: 0.451387
Avg Recall: 1.000000
d_prime: 1.769914
train_loss: 0.063273
valid_loss: 1.331197
validation finished
normal learning rate scheduler step
Epoch-28 lr: 8.505140593991858e-07
Epoch-28 lr: 8.505140593991858e-07
epoch 28 training time: 16.060
---------------
2023-09-24 21:52:13.288226
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00917	Per Sample Data Time 0.00346	Per Sample DNN Time 0.00572	Train Loss 0.0307	
start validation
acc: 0.723005
AUC: 0.894693
Avg Precision: 0.451387
Avg Recall: 1.000000
d_prime: 1.770421
train_loss: 0.042463
valid_loss: 1.331166
validation finished
normal learning rate scheduler step
Epoch-29 lr: 6.367765489540116e-07
Epoch-29 lr: 6.367765489540116e-07
epoch 29 training time: 15.092
---------------
2023-09-24 21:52:28.380498
current #epochs=30, #steps=1131
start validation
acc: 0.718310
AUC: 0.894693
Avg Precision: 0.451387
Avg Recall: 1.000000
d_prime: 1.770421
train_loss: 0.044607
valid_loss: 1.331187
validation finished
normal learning rate scheduler step
Epoch-30 lr: 4.767521110517798e-07
Epoch-30 lr: 4.767521110517798e-07
epoch 30 training time: 16.038
---------------
2023-09-24 21:52:44.418960
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00669	Per Sample Data Time 0.00108	Per Sample DNN Time 0.00561	Train Loss 0.0519	
start validation
acc: 0.718310
AUC: 0.894629
Avg Precision: 0.451387
Avg Recall: 1.000000
d_prime: 1.769924
train_loss: 0.048736
valid_loss: 1.331231
validation finished
normal learning rate scheduler step
Epoch-31 lr: 3.569424404301419e-07
Epoch-31 lr: 3.569424404301419e-07
epoch 31 training time: 17.511
---------------
2023-09-24 21:53:01.930436
current #epochs=32, #steps=1209
start validation
acc: 0.723005
AUC: 0.894614
Avg Precision: 0.451387
Avg Recall: 1.000000
d_prime: 1.769808
train_loss: 0.044123
valid_loss: 1.331264
validation finished
normal learning rate scheduler step
Epoch-32 lr: 2.672414087462482e-07
Epoch-32 lr: 2.672414087462482e-07
epoch 32 training time: 15.920
---------------
2023-09-24 21:53:17.850699
current #epochs=33, #steps=1248
start validation
acc: 0.723005
AUC: 0.894629
Avg Precision: 0.451387
Avg Recall: 1.000000
d_prime: 1.769924
train_loss: 0.045141
valid_loss: 1.331288
validation finished
normal learning rate scheduler step
Epoch-33 lr: 2.0008259724625455e-07
Epoch-33 lr: 2.0008259724625455e-07
epoch 33 training time: 15.273
---------------
2023-09-24 21:53:33.123229
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00799	Per Sample Data Time 0.00231	Per Sample DNN Time 0.00568	Train Loss 0.0291	
start validation
acc: 0.723005
AUC: 0.894629
Avg Precision: 0.451387
Avg Recall: 1.000000
d_prime: 1.769924
train_loss: 0.038484
valid_loss: 1.331296
validation finished
normal learning rate scheduler step
Epoch-34 lr: 1.4980105780994143e-07
Epoch-34 lr: 1.4980105780994143e-07
epoch 34 training time: 15.285
---------------
2023-09-24 21:53:48.407789
current #epochs=35, #steps=1326
start validation
acc: 0.723005
AUC: 0.894629
Avg Precision: 0.451387
Avg Recall: 1.000000
d_prime: 1.769924
train_loss: 0.055448
valid_loss: 1.331298
validation finished
normal learning rate scheduler step
Epoch-35 lr: 1.1215546594169118e-07
Epoch-35 lr: 1.1215546594169118e-07
epoch 35 training time: 16.388
---------------
2023-09-24 21:54:04.796445
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00653	Per Sample Data Time 0.00096	Per Sample DNN Time 0.00557	Train Loss 0.0431	
start validation
acc: 0.723005
AUC: 0.894629
Avg Precision: 0.451387
Avg Recall: 1.000000
d_prime: 1.769924
train_loss: 0.048607
valid_loss: 1.331298
validation finished
normal learning rate scheduler step
Epoch-36 lr: 8.397035858423067e-08
Epoch-36 lr: 8.397035858423067e-08
epoch 36 training time: 15.282
---------------
2023-09-24 21:54:20.077992
current #epochs=37, #steps=1404
start validation
acc: 0.723005
AUC: 0.894629
Avg Precision: 0.451387
Avg Recall: 1.000000
d_prime: 1.769924
train_loss: 0.039123
valid_loss: 1.331298
validation finished
normal learning rate scheduler step
Epoch-37 lr: 6.286827896939109e-08
Epoch-37 lr: 6.286827896939109e-08
epoch 37 training time: 15.292
---------------
2023-09-24 21:54:35.369651
current #epochs=38, #steps=1443
start validation
acc: 0.723005
AUC: 0.894629
Avg Precision: 0.451387
Avg Recall: 1.000000
d_prime: 1.769924
train_loss: 0.058294
valid_loss: 1.331301
validation finished
normal learning rate scheduler step
Epoch-38 lr: 4.706923451575484e-08
Epoch-38 lr: 4.706923451575484e-08
epoch 38 training time: 17.759
---------------
2023-09-24 21:54:53.128405
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00745	Per Sample Data Time 0.00176	Per Sample DNN Time 0.00569	Train Loss 0.0378	
start validation
acc: 0.723005
AUC: 0.894629
Avg Precision: 0.451387
Avg Recall: 1.000000
d_prime: 1.769924
train_loss: 0.043531
valid_loss: 1.331304
validation finished
normal learning rate scheduler step
Epoch-39 lr: 3.5240551741169847e-08
Epoch-39 lr: 3.5240551741169847e-08
epoch 39 training time: 15.307
---------------
2023-09-24 21:55:08.435235
current #epochs=40, #steps=1521
start validation
acc: 0.723005
AUC: 0.894629
Avg Precision: 0.451387
Avg Recall: 1.000000
d_prime: 1.769924
train_loss: 0.043211
valid_loss: 1.331304
validation finished
normal learning rate scheduler step
Epoch-40 lr: 2.6384463223135407e-08
Epoch-40 lr: 2.6384463223135407e-08
epoch 40 training time: 15.385
---------------
2023-09-24 21:55:23.820359
current #epochs=41, #steps=1560
start validation
acc: 0.723005
AUC: 0.894629
Avg Precision: 0.451387
Avg Recall: 1.000000
d_prime: 1.769924
train_loss: 0.049826
valid_loss: 1.331303
validation finished
normal learning rate scheduler step
Epoch-41 lr: 1.9753944395817105e-08
Epoch-41 lr: 1.9753944395817105e-08
epoch 41 training time: 15.149
---------------
2023-09-24 21:55:38.969673
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02272	Per Sample Data Time 0.01554	Per Sample DNN Time 0.00718	Train Loss 0.0138	
start validation
acc: 0.723005
AUC: 0.894629
Avg Precision: 0.451387
Avg Recall: 1.000000
d_prime: 1.769924
train_loss: 0.050017
valid_loss: 1.331303
validation finished
normal learning rate scheduler step
Epoch-42 lr: 1.478970088922894e-08
Epoch-42 lr: 1.478970088922894e-08
epoch 42 training time: 15.420
---------------
2023-09-24 21:55:54.389584
current #epochs=43, #steps=1638
start validation
[I 2023-09-24 21:56:09,750] Trial 75 finished with value: 0.45138695993720207 and parameters: {'warmup': 'True', 'num_epochs': 43, 'batch_size': 41, 'lr-adaptschedule': 'True', 'lr': 0.0004954035253085982, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7486960878740074}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.723005
AUC: 0.894629
Avg Precision: 0.451387
Avg Recall: 1.000000
d_prime: 1.769924
train_loss: 0.049318
valid_loss: 1.331303
validation finished
normal learning rate scheduler step
Epoch-43 lr: 1.1072991196592436e-08
Epoch-43 lr: 1.1072991196592436e-08
epoch 43 training time: 15.347
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f556e20>
The learning rate scheduler starts at 6 epoch with decay rate of 0.737 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 21:56:09.788491
current #epochs=1, #steps=0
start validation
acc: 0.699531
AUC: 0.882940
Avg Precision: 0.438105
Avg Recall: 1.000000
d_prime: 1.682652
train_loss: 0.040771
valid_loss: 1.341428
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0002904062247009457
Epoch-1 lr: 0.0002904062247009457
epoch 1 training time: 17.654
---------------
2023-09-24 21:56:27.442671
current #epochs=2, #steps=39
start validation
acc: 0.727700
AUC: 0.889305
Avg Precision: 0.429940
Avg Recall: 1.000000
d_prime: 1.729359
train_loss: 0.054957
valid_loss: 1.337944
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0002904062247009457
Epoch-2 lr: 0.0002904062247009457
epoch 2 training time: 17.752
---------------
2023-09-24 21:56:45.194619
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00561	Train Loss 0.0633	
start validation
acc: 0.713615
AUC: 0.893819
Avg Precision: 0.436401
Avg Recall: 1.000000
d_prime: 1.763659
train_loss: 0.060738
valid_loss: 1.331694
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0002904062247009457
Epoch-3 lr: 0.0002904062247009457
epoch 3 training time: 15.198
---------------
2023-09-24 21:57:00.392641
current #epochs=4, #steps=117
start validation
acc: 0.723005
AUC: 0.896637
Avg Precision: 0.462203
Avg Recall: 1.000000
d_prime: 1.785614
train_loss: 0.037903
valid_loss: 1.318640
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0002904062247009457
Epoch-4 lr: 0.0002904062247009457
epoch 4 training time: 15.215
---------------
2023-09-24 21:57:15.607804
current #epochs=5, #steps=156
start validation
acc: 0.708920
AUC: 0.896724
Avg Precision: 0.474997
Avg Recall: 1.000000
d_prime: 1.786295
train_loss: 0.047242
valid_loss: 1.334299
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0002904062247009457
Epoch-5 lr: 0.0002904062247009457
epoch 5 training time: 17.458
---------------
2023-09-24 21:57:33.065453
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01161	Per Sample Data Time 0.00540	Per Sample DNN Time 0.00621	Train Loss 0.0169	
start validation
acc: 0.746479
AUC: 0.895603
Avg Precision: 0.472207
Avg Recall: 1.000000
d_prime: 1.777505
train_loss: 0.041965
valid_loss: 1.319523
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00021394258203508897
Epoch-6 lr: 0.00021394258203508897
epoch 6 training time: 17.880
---------------
2023-09-24 21:57:50.945252
current #epochs=7, #steps=234
start validation
acc: 0.741784
AUC: 0.894485
Avg Precision: 0.472589
Avg Recall: 1.000000
d_prime: 1.768812
train_loss: 0.043921
valid_loss: 1.321883
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00021394258203508897
Epoch-7 lr: 0.00021394258203508897
epoch 7 training time: 15.140
---------------
2023-09-24 21:58:06.084629
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00682	Per Sample Data Time 0.00120	Per Sample DNN Time 0.00562	Train Loss 0.0714	
start validation
acc: 0.708920
AUC: 0.891076
Avg Precision: 0.458044
Avg Recall: 1.000000
d_prime: 1.742692
train_loss: 0.063010
valid_loss: 1.333144
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00015761173320225918
Epoch-8 lr: 0.00015761173320225918
epoch 8 training time: 15.179
---------------
2023-09-24 21:58:21.263628
current #epochs=9, #steps=312
start validation
acc: 0.737089
AUC: 0.885448
Avg Precision: 0.454708
Avg Recall: 1.000000
d_prime: 1.700836
train_loss: 0.039596
valid_loss: 1.326299
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00015761173320225918
Epoch-9 lr: 0.00015761173320225918
epoch 9 training time: 16.747
---------------
2023-09-24 21:58:38.010851
current #epochs=10, #steps=351
start validation
acc: 0.723005
AUC: 0.885476
Avg Precision: 0.448387
Avg Recall: 1.000000
d_prime: 1.701036
train_loss: 0.062948
valid_loss: 1.333056
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00011611273551398875
Epoch-10 lr: 0.00011611273551398875
epoch 10 training time: 15.254
---------------
2023-09-24 21:58:53.264575
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00867	Per Sample Data Time 0.00292	Per Sample DNN Time 0.00575	Train Loss 0.0333	
start validation
acc: 0.723005
AUC: 0.884431
Avg Precision: 0.453419
Avg Recall: 1.000000
d_prime: 1.693424
train_loss: 0.039609
valid_loss: 1.330837
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00011611273551398875
Epoch-11 lr: 0.00011611273551398875
epoch 11 training time: 15.935
---------------
2023-09-24 21:59:09.199655
current #epochs=12, #steps=429
start validation
acc: 0.718310
AUC: 0.886369
Avg Precision: 0.455747
Avg Recall: 1.000000
d_prime: 1.707580
train_loss: 0.048047
valid_loss: 1.330647
validation finished
normal learning rate scheduler step
Epoch-12 lr: 8.554037871812613e-05
Epoch-12 lr: 8.554037871812613e-05
epoch 12 training time: 15.430
---------------
2023-09-24 21:59:24.629117
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00663	Per Sample Data Time 0.00105	Per Sample DNN Time 0.00558	Train Loss 0.0523	
start validation
acc: 0.723005
AUC: 0.888809
Avg Precision: 0.455997
Avg Recall: 1.000000
d_prime: 1.725651
train_loss: 0.057163
valid_loss: 1.332047
validation finished
normal learning rate scheduler step
Epoch-13 lr: 8.554037871812613e-05
Epoch-13 lr: 8.554037871812613e-05
epoch 13 training time: 15.208
---------------
2023-09-24 21:59:39.837004
current #epochs=14, #steps=507
start validation
acc: 0.708920
AUC: 0.887278
Avg Precision: 0.461262
Avg Recall: 1.000000
d_prime: 1.714276
train_loss: 0.069233
valid_loss: 1.340299
validation finished
normal learning rate scheduler step
Epoch-14 lr: 6.301769016852511e-05
Epoch-14 lr: 6.301769016852511e-05
epoch 14 training time: 15.215
---------------
2023-09-24 21:59:55.052184
current #epochs=15, #steps=546
start validation
acc: 0.713615
AUC: 0.890580
Avg Precision: 0.457123
Avg Recall: 1.000000
d_prime: 1.738946
train_loss: 0.039928
valid_loss: 1.334188
validation finished
normal learning rate scheduler step
Epoch-15 lr: 6.301769016852511e-05
Epoch-15 lr: 6.301769016852511e-05
epoch 15 training time: 15.335
---------------
2023-09-24 22:00:10.386814
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00781	Per Sample Data Time 0.00207	Per Sample DNN Time 0.00574	Train Loss 0.0291	
start validation
acc: 0.713615
AUC: 0.891724
Avg Precision: 0.463923
Avg Recall: 1.000000
d_prime: 1.747612
train_loss: 0.037341
valid_loss: 1.331775
validation finished
normal learning rate scheduler step
Epoch-16 lr: 4.642520098329559e-05
Epoch-16 lr: 4.642520098329559e-05
epoch 16 training time: 15.290
---------------
2023-09-24 22:00:25.677257
current #epochs=17, #steps=624
start validation
acc: 0.713615
AUC: 0.891495
Avg Precision: 0.463463
Avg Recall: 1.000000
d_prime: 1.745870
train_loss: 0.051285
valid_loss: 1.331694
validation finished
normal learning rate scheduler step
Epoch-17 lr: 4.642520098329559e-05
Epoch-17 lr: 4.642520098329559e-05
epoch 17 training time: 15.323
---------------
2023-09-24 22:00:41.000419
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00649	Per Sample Data Time 0.00092	Per Sample DNN Time 0.00557	Train Loss 0.0443	
start validation
acc: 0.718310
AUC: 0.891930
Avg Precision: 0.463856
Avg Recall: 1.000000
d_prime: 1.749180
train_loss: 0.044213
valid_loss: 1.332170
validation finished
normal learning rate scheduler step
Epoch-18 lr: 3.420149612871527e-05
Epoch-18 lr: 3.420149612871527e-05
epoch 18 training time: 16.375
---------------
2023-09-24 22:00:57.375549
current #epochs=19, #steps=702
start validation
acc: 0.718310
AUC: 0.891486
Avg Precision: 0.451458
Avg Recall: 1.000000
d_prime: 1.745806
train_loss: 0.049897
valid_loss: 1.332558
validation finished
normal learning rate scheduler step
Epoch-19 lr: 3.420149612871527e-05
Epoch-19 lr: 3.420149612871527e-05
epoch 19 training time: 15.215
---------------
2023-09-24 22:01:12.590582
current #epochs=20, #steps=741
start validation
acc: 0.718310
AUC: 0.891025
Avg Precision: 0.450915
Avg Recall: 1.000000
d_prime: 1.742305
train_loss: 0.052111
valid_loss: 1.332694
validation finished
normal learning rate scheduler step
Epoch-20 lr: 2.5196279448815197e-05
Epoch-20 lr: 2.5196279448815197e-05
epoch 20 training time: 15.224
---------------
2023-09-24 22:01:27.814846
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00160	Per Sample DNN Time 0.00559	Train Loss 0.0491	
start validation
acc: 0.718310
AUC: 0.891265
Avg Precision: 0.451083
Avg Recall: 1.000000
d_prime: 1.744127
train_loss: 0.054212
valid_loss: 1.331941
validation finished
normal learning rate scheduler step
Epoch-21 lr: 2.5196279448815197e-05
Epoch-21 lr: 2.5196279448815197e-05
epoch 21 training time: 15.238
---------------
2023-09-24 22:01:43.053021
current #epochs=22, #steps=819
start validation
acc: 0.718310
AUC: 0.891438
Avg Precision: 0.451009
Avg Recall: 1.000000
d_prime: 1.745437
train_loss: 0.040203
valid_loss: 1.331283
validation finished
normal learning rate scheduler step
Epoch-22 lr: 1.8562126512640204e-05
Epoch-22 lr: 1.8562126512640204e-05
epoch 22 training time: 16.717
---------------
2023-09-24 22:01:59.769959
current #epochs=23, #steps=858
start validation
acc: 0.718310
AUC: 0.891359
Avg Precision: 0.451009
Avg Recall: 1.000000
d_prime: 1.744843
train_loss: 0.044992
valid_loss: 1.331080
validation finished
normal learning rate scheduler step
Epoch-23 lr: 1.8562126512640204e-05
Epoch-23 lr: 1.8562126512640204e-05
epoch 23 training time: 15.295
---------------
2023-09-24 22:02:15.065500
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01427	Per Sample Data Time 0.00776	Per Sample DNN Time 0.00651	Train Loss 0.0361	
start validation
acc: 0.718310
AUC: 0.892051
Avg Precision: 0.451418
Avg Recall: 1.000000
d_prime: 1.750104
train_loss: 0.041522
valid_loss: 1.330596
validation finished
normal learning rate scheduler step
Epoch-24 lr: 1.367473881892758e-05
Epoch-24 lr: 1.367473881892758e-05
epoch 24 training time: 15.294
---------------
2023-09-24 22:02:30.359267
current #epochs=25, #steps=936
start validation
acc: 0.718310
AUC: 0.892604
Avg Precision: 0.451815
Avg Recall: 1.000000
d_prime: 1.754323
train_loss: 0.045121
valid_loss: 1.330735
validation finished
normal learning rate scheduler step
Epoch-25 lr: 1.367473881892758e-05
Epoch-25 lr: 1.367473881892758e-05
epoch 25 training time: 17.124
---------------
2023-09-24 22:02:47.483306
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00698	Per Sample Data Time 0.00136	Per Sample DNN Time 0.00562	Train Loss 0.0542	
start validation
acc: 0.718310
AUC: 0.892509
Avg Precision: 0.452068
Avg Recall: 1.000000
d_prime: 1.753603
train_loss: 0.048946
valid_loss: 1.330595
validation finished
normal learning rate scheduler step
Epoch-26 lr: 1.007419498183815e-05
Epoch-26 lr: 1.007419498183815e-05
epoch 26 training time: 16.765
---------------
2023-09-24 22:03:04.247663
current #epochs=27, #steps=1014
start validation
acc: 0.718310
AUC: 0.892473
Avg Precision: 0.458366
Avg Recall: 1.000000
d_prime: 1.753327
train_loss: 0.048000
valid_loss: 1.330685
validation finished
normal learning rate scheduler step
Epoch-27 lr: 1.007419498183815e-05
Epoch-27 lr: 1.007419498183815e-05
epoch 27 training time: 16.661
---------------
2023-09-24 22:03:20.909028
current #epochs=28, #steps=1053
start validation
acc: 0.718310
AUC: 0.892547
Avg Precision: 0.457318
Avg Recall: 1.000000
d_prime: 1.753892
train_loss: 0.040722
valid_loss: 1.330678
validation finished
normal learning rate scheduler step
Epoch-28 lr: 7.421670415497715e-06
Epoch-28 lr: 7.421670415497715e-06
epoch 28 training time: 15.395
---------------
2023-09-24 22:03:36.303614
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00938	Per Sample Data Time 0.00342	Per Sample DNN Time 0.00596	Train Loss 0.0377	
start validation
acc: 0.718310
AUC: 0.892474
Avg Precision: 0.451185
Avg Recall: 1.000000
d_prime: 1.753329
train_loss: 0.043458
valid_loss: 1.330654
validation finished
normal learning rate scheduler step
Epoch-29 lr: 7.421670415497715e-06
Epoch-29 lr: 7.421670415497715e-06
epoch 29 training time: 17.709
---------------
2023-09-24 22:03:54.012808
current #epochs=30, #steps=1131
start validation
acc: 0.718310
AUC: 0.892283
Avg Precision: 0.451256
Avg Recall: 1.000000
d_prime: 1.751876
train_loss: 0.041970
valid_loss: 1.330490
validation finished
normal learning rate scheduler step
Epoch-30 lr: 5.467552678459658e-06
Epoch-30 lr: 5.467552678459658e-06
epoch 30 training time: 15.343
---------------
2023-09-24 22:04:09.355290
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00675	Per Sample Data Time 0.00113	Per Sample DNN Time 0.00562	Train Loss 0.0428	
start validation
acc: 0.718310
AUC: 0.892832
Avg Precision: 0.451747
Avg Recall: 1.000000
d_prime: 1.756072
train_loss: 0.042555
valid_loss: 1.330400
validation finished
normal learning rate scheduler step
Epoch-31 lr: 5.467552678459658e-06
Epoch-31 lr: 5.467552678459658e-06
epoch 31 training time: 16.073
---------------
2023-09-24 22:04:25.428067
current #epochs=32, #steps=1209
start validation
acc: 0.718310
AUC: 0.892672
Avg Precision: 0.451418
Avg Recall: 1.000000
d_prime: 1.754847
train_loss: 0.047631
valid_loss: 1.330343
validation finished
normal learning rate scheduler step
Epoch-32 lr: 4.027952013243182e-06
Epoch-32 lr: 4.027952013243182e-06
epoch 32 training time: 16.699
---------------
2023-09-24 22:04:42.126609
current #epochs=33, #steps=1248
start validation
acc: 0.718310
AUC: 0.892616
Avg Precision: 0.451256
Avg Recall: 1.000000
d_prime: 1.754421
train_loss: 0.033477
valid_loss: 1.330350
validation finished
normal learning rate scheduler step
Epoch-33 lr: 4.027952013243182e-06
Epoch-33 lr: 4.027952013243182e-06
epoch 33 training time: 16.253
---------------
2023-09-24 22:04:58.379342
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00809	Per Sample Data Time 0.00239	Per Sample DNN Time 0.00570	Train Loss 0.0338	
start validation
acc: 0.718310
AUC: 0.892733
Avg Precision: 0.451256
Avg Recall: 1.000000
d_prime: 1.755314
train_loss: 0.036696
valid_loss: 1.330257
validation finished
normal learning rate scheduler step
Epoch-34 lr: 2.9673966352274096e-06
Epoch-34 lr: 2.9673966352274096e-06
epoch 34 training time: 16.589
---------------
2023-09-24 22:05:14.968918
current #epochs=35, #steps=1326
start validation
acc: 0.718310
AUC: 0.892752
Avg Precision: 0.451418
Avg Recall: 1.000000
d_prime: 1.755460
train_loss: 0.049974
valid_loss: 1.330329
validation finished
normal learning rate scheduler step
Epoch-35 lr: 2.9673966352274096e-06
Epoch-35 lr: 2.9673966352274096e-06
epoch 35 training time: 15.381
---------------
2023-09-24 22:05:30.349685
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00655	Per Sample Data Time 0.00099	Per Sample DNN Time 0.00556	Train Loss 0.0505	
start validation
acc: 0.718310
AUC: 0.892803
Avg Precision: 0.451582
Avg Recall: 1.000000
d_prime: 1.755846
train_loss: 0.049178
valid_loss: 1.330426
validation finished
normal learning rate scheduler step
Epoch-36 lr: 2.186084333132133e-06
Epoch-36 lr: 2.186084333132133e-06
epoch 36 training time: 15.256
---------------
2023-09-24 22:05:45.605883
current #epochs=37, #steps=1404
start validation
acc: 0.718310
AUC: 0.892911
Avg Precision: 0.451582
Avg Recall: 1.000000
d_prime: 1.756675
train_loss: 0.036990
valid_loss: 1.330388
validation finished
normal learning rate scheduler step
Epoch-37 lr: 2.186084333132133e-06
Epoch-37 lr: 2.186084333132133e-06
epoch 37 training time: 15.435
---------------
2023-09-24 22:06:01.041053
current #epochs=38, #steps=1443
start validation
acc: 0.723005
AUC: 0.892838
Avg Precision: 0.451582
Avg Recall: 1.000000
d_prime: 1.756115
train_loss: 0.048866
valid_loss: 1.330381
validation finished
normal learning rate scheduler step
Epoch-38 lr: 1.610490709206968e-06
Epoch-38 lr: 1.610490709206968e-06
epoch 38 training time: 15.271
---------------
2023-09-24 22:06:16.311743
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00745	Per Sample Data Time 0.00179	Per Sample DNN Time 0.00566	Train Loss 0.0568	
start validation
acc: 0.723005
AUC: 0.892825
Avg Precision: 0.451582
Avg Recall: 1.000000
d_prime: 1.756015
train_loss: 0.044715
valid_loss: 1.330224
validation finished
normal learning rate scheduler step
Epoch-39 lr: 1.610490709206968e-06
Epoch-39 lr: 1.610490709206968e-06
epoch 39 training time: 16.272
---------------
2023-09-24 22:06:32.583944
current #epochs=40, #steps=1521
start validation
acc: 0.723005
AUC: 0.892861
Avg Precision: 0.451582
Avg Recall: 1.000000
d_prime: 1.756293
train_loss: 0.036655
valid_loss: 1.330111
validation finished
normal learning rate scheduler step
Epoch-40 lr: 1.1864502595496135e-06
Epoch-40 lr: 1.1864502595496135e-06
epoch 40 training time: 15.288
---------------
2023-09-24 22:06:47.872268
current #epochs=41, #steps=1560
start validation
acc: 0.723005
AUC: 0.892861
Avg Precision: 0.451582
Avg Recall: 1.000000
d_prime: 1.756293
train_loss: 0.048857
valid_loss: 1.330055
validation finished
normal learning rate scheduler step
Epoch-41 lr: 1.1864502595496135e-06
Epoch-41 lr: 1.1864502595496135e-06
epoch 41 training time: 15.264
---------------
2023-09-24 22:07:03.136366
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02225	Per Sample Data Time 0.01519	Per Sample DNN Time 0.00706	Train Loss 0.0708	
start validation
acc: 0.723005
AUC: 0.892933
Avg Precision: 0.451747
Avg Recall: 1.000000
d_prime: 1.756843
train_loss: 0.052109
valid_loss: 1.330062
validation finished
normal learning rate scheduler step
Epoch-42 lr: 8.740591984405189e-07
Epoch-42 lr: 8.740591984405189e-07
epoch 42 training time: 15.296
---------------
2023-09-24 22:07:18.432858
current #epochs=43, #steps=1638
start validation
acc: 0.723005
AUC: 0.892911
Avg Precision: 0.451747
Avg Recall: 1.000000
d_prime: 1.756679
train_loss: 0.038474
valid_loss: 1.330065
validation finished
normal learning rate scheduler step
Epoch-43 lr: 8.740591984405189e-07
Epoch-43 lr: 8.740591984405189e-07
epoch 43 training time: 15.211
---------------
2023-09-24 22:07:33.643491
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00144	Per Sample DNN Time 0.00568	Train Loss 0.0627	
start validation
acc: 0.723005
AUC: 0.892832
Avg Precision: 0.451660
Avg Recall: 1.000000
d_prime: 1.756072
train_loss: 0.056558
valid_loss: 1.330038
validation finished
normal learning rate scheduler step
Epoch-44 lr: 6.439203634786135e-07
Epoch-44 lr: 6.439203634786135e-07
epoch 44 training time: 15.416
---------------
2023-09-24 22:07:49.059205
current #epochs=45, #steps=1716
start validation
acc: 0.723005
AUC: 0.892832
Avg Precision: 0.451660
Avg Recall: 1.000000
d_prime: 1.756072
train_loss: 0.045094
valid_loss: 1.330059
validation finished
normal learning rate scheduler step
Epoch-45 lr: 6.439203634786135e-07
Epoch-45 lr: 6.439203634786135e-07
epoch 45 training time: 15.332
---------------
2023-09-24 22:08:04.391567
current #epochs=46, #steps=1755
start validation
acc: 0.723005
AUC: 0.892802
Avg Precision: 0.451660
Avg Recall: 1.000000
d_prime: 1.755843
train_loss: 0.037434
valid_loss: 1.330063
validation finished
normal learning rate scheduler step
Epoch-46 lr: 4.7437683310491026e-07
Epoch-46 lr: 4.7437683310491026e-07
epoch 46 training time: 15.295
---------------
2023-09-24 22:08:19.686499
current #epochs=47, #steps=1794
Epoch: [47][6/39]	Per Sample Total Time 0.01052	Per Sample Data Time 0.00445	Per Sample DNN Time 0.00607	Train Loss 0.0641	
start validation
acc: 0.723005
AUC: 0.892817
Avg Precision: 0.451660
Avg Recall: 1.000000
d_prime: 1.755958
train_loss: 0.045442
valid_loss: 1.330054
validation finished
normal learning rate scheduler step
Epoch-47 lr: 4.7437683310491026e-07
Epoch-47 lr: 4.7437683310491026e-07
epoch 47 training time: 15.291
---------------
2023-09-24 22:08:34.976779
current #epochs=48, #steps=1833
start validation
acc: 0.723005
AUC: 0.892934
Avg Precision: 0.451747
Avg Recall: 1.000000
d_prime: 1.756851
train_loss: 0.048153
valid_loss: 1.330056
validation finished
normal learning rate scheduler step
Epoch-48 lr: 3.494739296191212e-07
Epoch-48 lr: 3.494739296191212e-07
epoch 48 training time: 15.255
---------------
2023-09-24 22:08:50.232281
current #epochs=49, #steps=1872
Epoch: [49][28/39]	Per Sample Total Time 0.00675	Per Sample Data Time 0.00118	Per Sample DNN Time 0.00557	Train Loss 0.0365	
start validation
[I 2023-09-24 22:09:06,584] Trial 76 finished with value: 0.45174740126644647 and parameters: {'warmup': 'True', 'num_epochs': 49, 'batch_size': 38, 'lr-adaptschedule': 'True', 'lr': 0.0002904062247009457, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.7367010891567584}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.723005
AUC: 0.892919
Avg Precision: 0.451747
Avg Recall: 1.000000
d_prime: 1.756737
train_loss: 0.040066
valid_loss: 1.330054
validation finished
normal learning rate scheduler step
Epoch-49 lr: 3.494739296191212e-07
Epoch-49 lr: 3.494739296191212e-07
epoch 49 training time: 16.340
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f5319a0>
The learning rate scheduler starts at 7 epoch with decay rate of 0.719 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 22:09:06.624222
current #epochs=1, #steps=0
start validation
acc: 0.699531
AUC: 0.890402
Avg Precision: 0.450307
Avg Recall: 1.000000
d_prime: 1.737596
train_loss: 0.060392
valid_loss: 1.366018
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0006023760477799841
Epoch-1 lr: 0.0012047520955599683
epoch 1 training time: 18.372
---------------
2023-09-24 22:09:24.996780
current #epochs=2, #steps=39
start validation
acc: 0.737089
AUC: 0.899819
Avg Precision: 0.447788
Avg Recall: 1.000000
d_prime: 1.810931
train_loss: 0.065539
valid_loss: 1.327825
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0006023760477799841
Epoch-2 lr: 0.0012047520955599683
epoch 2 training time: 17.791
---------------
2023-09-24 22:09:42.787434
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00564	Train Loss 0.0439	
start validation
acc: 0.708920
AUC: 0.895466
Avg Precision: 0.456496
Avg Recall: 1.000000
d_prime: 1.776437
train_loss: 0.047575
valid_loss: 1.338279
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0006023760477799841
Epoch-3 lr: 0.0012047520955599683
epoch 3 training time: 15.299
---------------
2023-09-24 22:09:58.086574
current #epochs=4, #steps=117
start validation
acc: 0.755869
AUC: 0.898716
Avg Precision: 0.461635
Avg Recall: 1.000000
d_prime: 1.802088
train_loss: 0.051020
valid_loss: 1.319628
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0006023760477799841
Epoch-4 lr: 0.0012047520955599683
epoch 4 training time: 18.933
---------------
2023-09-24 22:10:17.019693
current #epochs=5, #steps=156
start validation
acc: 0.694836
AUC: 0.884599
Avg Precision: 0.467518
Avg Recall: 1.000000
d_prime: 1.694644
train_loss: 0.033512
valid_loss: 1.340525
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0006023760477799841
Epoch-5 lr: 0.0012047520955599683
epoch 5 training time: 15.274
---------------
2023-09-24 22:10:32.293497
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01118	Per Sample Data Time 0.00506	Per Sample DNN Time 0.00613	Train Loss 0.0468	
start validation
acc: 0.741784
AUC: 0.898559
Avg Precision: 0.485965
Avg Recall: 1.000000
d_prime: 1.800839
train_loss: 0.058042
valid_loss: 1.326472
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0006023760477799841
Epoch-6 lr: 0.0012047520955599683
epoch 6 training time: 15.098
---------------
2023-09-24 22:10:47.391761
current #epochs=7, #steps=234
start validation
acc: 0.751174
AUC: 0.904741
Avg Precision: 0.486045
Avg Recall: 1.000000
d_prime: 1.851274
train_loss: 0.059317
valid_loss: 1.323825
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0004329955311589099
Epoch-7 lr: 0.0008659910623178198
epoch 7 training time: 15.247
---------------
2023-09-24 22:11:02.639261
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00680	Per Sample Data Time 0.00122	Per Sample DNN Time 0.00558	Train Loss 0.0438	
start validation
acc: 0.755869
AUC: 0.904693
Avg Precision: 0.491163
Avg Recall: 1.000000
d_prime: 1.850877
train_loss: 0.045216
valid_loss: 1.312721
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0003112426709105553
Epoch-8 lr: 0.0006224853418211106
epoch 8 training time: 15.205
---------------
2023-09-24 22:11:17.844285
current #epochs=9, #steps=312
start validation
acc: 0.718310
AUC: 0.900076
Avg Precision: 0.481989
Avg Recall: 1.000000
d_prime: 1.812996
train_loss: 0.048213
valid_loss: 1.327217
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00022372517318194692
Epoch-9 lr: 0.00044745034636389384
epoch 9 training time: 15.287
---------------
2023-09-24 22:11:33.131636
current #epochs=10, #steps=351
start validation
acc: 0.723005
AUC: 0.894141
Avg Precision: 0.484791
Avg Recall: 1.000000
d_prime: 1.766152
train_loss: 0.044518
valid_loss: 1.321056
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00016081648756213228
Epoch-10 lr: 0.00032163297512426456
epoch 10 training time: 17.047
---------------
2023-09-24 22:11:50.178869
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00863	Per Sample Data Time 0.00287	Per Sample DNN Time 0.00575	Train Loss 0.0478	
start validation
acc: 0.746479
AUC: 0.903003
Avg Precision: 0.491061
Avg Recall: 1.000000
d_prime: 1.836853
train_loss: 0.060247
valid_loss: 1.314826
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00011559692771268498
Epoch-11 lr: 0.00023119385542536995
epoch 11 training time: 15.154
---------------
2023-09-24 22:12:05.332974
current #epochs=12, #steps=429
start validation
acc: 0.732394
AUC: 0.902696
Avg Precision: 0.480420
Avg Recall: 1.000000
d_prime: 1.834329
train_loss: 0.046908
valid_loss: 1.319821
validation finished
normal learning rate scheduler step
Epoch-12 lr: 8.309253546809986e-05
Epoch-12 lr: 0.0001661850709361997
epoch 12 training time: 15.417
---------------
2023-09-24 22:12:20.749590
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00669	Per Sample Data Time 0.00105	Per Sample DNN Time 0.00564	Train Loss 0.0489	
start validation
acc: 0.741784
AUC: 0.901785
Avg Precision: 0.477777
Avg Recall: 1.000000
d_prime: 1.826865
train_loss: 0.051711
valid_loss: 1.321108
validation finished
normal learning rate scheduler step
Epoch-13 lr: 5.972796671273284e-05
Epoch-13 lr: 0.00011945593342546568
epoch 13 training time: 16.340
---------------
2023-09-24 22:12:37.089486
current #epochs=14, #steps=507
start validation
acc: 0.741784
AUC: 0.901030
Avg Precision: 0.478018
Avg Recall: 1.000000
d_prime: 1.820715
train_loss: 0.046812
valid_loss: 1.320696
validation finished
normal learning rate scheduler step
Epoch-14 lr: 4.293321882092403e-05
Epoch-14 lr: 8.586643764184806e-05
epoch 14 training time: 15.380
---------------
2023-09-24 22:12:52.469286
current #epochs=15, #steps=546
start validation
acc: 0.737089
AUC: 0.900321
Avg Precision: 0.477000
Avg Recall: 1.000000
d_prime: 1.814976
train_loss: 0.038730
valid_loss: 1.320290
validation finished
normal learning rate scheduler step
Epoch-15 lr: 3.086094136086501e-05
Epoch-15 lr: 6.172188272173002e-05
epoch 15 training time: 15.309
---------------
2023-09-24 22:13:07.778165
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00781	Per Sample Data Time 0.00206	Per Sample DNN Time 0.00575	Train Loss 0.0472	
start validation
acc: 0.737089
AUC: 0.900285
Avg Precision: 0.476501
Avg Recall: 1.000000
d_prime: 1.814690
train_loss: 0.049939
valid_loss: 1.321409
validation finished
normal learning rate scheduler step
Epoch-16 lr: 2.2183235448784612e-05
Epoch-16 lr: 4.4366470897569224e-05
epoch 16 training time: 15.310
---------------
2023-09-24 22:13:23.088670
current #epochs=17, #steps=624
start validation
acc: 0.737089
AUC: 0.899920
Avg Precision: 0.476837
Avg Recall: 1.000000
d_prime: 1.811744
train_loss: 0.051618
valid_loss: 1.320855
validation finished
normal learning rate scheduler step
Epoch-17 lr: 1.594559055156512e-05
Epoch-17 lr: 3.189118110313024e-05
epoch 17 training time: 16.627
---------------
2023-09-24 22:13:39.715569
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00651	Per Sample Data Time 0.00098	Per Sample DNN Time 0.00553	Train Loss 0.0427	
start validation
acc: 0.737089
AUC: 0.900033
Avg Precision: 0.477039
Avg Recall: 1.000000
d_prime: 1.812650
train_loss: 0.042729
valid_loss: 1.320673
validation finished
normal learning rate scheduler step
Epoch-18 lr: 1.1461892410833759e-05
Epoch-18 lr: 2.2923784821667518e-05
epoch 18 training time: 17.143
---------------
2023-09-24 22:13:56.859048
current #epochs=19, #steps=702
start validation
acc: 0.737089
AUC: 0.899981
Avg Precision: 0.476881
Avg Recall: 1.000000
d_prime: 1.812231
train_loss: 0.043729
valid_loss: 1.320996
validation finished
normal learning rate scheduler step
Epoch-19 lr: 8.23895340926295e-06
Epoch-19 lr: 1.64779068185259e-05
epoch 19 training time: 15.313
---------------
2023-09-24 22:14:12.172226
current #epochs=20, #steps=741
start validation
acc: 0.737089
AUC: 0.899911
Avg Precision: 0.476881
Avg Recall: 1.000000
d_prime: 1.811667
train_loss: 0.053074
valid_loss: 1.320997
validation finished
normal learning rate scheduler step
Epoch-20 lr: 5.92226404217904e-06
Epoch-20 lr: 1.184452808435808e-05
epoch 20 training time: 16.024
---------------
2023-09-24 22:14:28.195931
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00731	Per Sample Data Time 0.00162	Per Sample DNN Time 0.00570	Train Loss 0.0556	
start validation
acc: 0.737089
AUC: 0.900102
Avg Precision: 0.476753
Avg Recall: 1.000000
d_prime: 1.813214
train_loss: 0.046276
valid_loss: 1.320781
validation finished
normal learning rate scheduler step
Epoch-21 lr: 4.256998388394144e-06
Epoch-21 lr: 8.513996776788287e-06
epoch 21 training time: 15.213
---------------
2023-09-24 22:14:43.408719
current #epochs=22, #steps=819
start validation
acc: 0.737089
AUC: 0.900144
Avg Precision: 0.476753
Avg Recall: 1.000000
d_prime: 1.813552
train_loss: 0.038510
valid_loss: 1.320760
validation finished
normal learning rate scheduler step
Epoch-22 lr: 3.0599843488441474e-06
Epoch-22 lr: 6.119968697688295e-06
epoch 22 training time: 16.689
---------------
2023-09-24 22:15:00.097846
current #epochs=23, #steps=858
start validation
acc: 0.737089
AUC: 0.900108
Avg Precision: 0.476753
Avg Recall: 1.000000
d_prime: 1.813260
train_loss: 0.053807
valid_loss: 1.320719
validation finished
normal learning rate scheduler step
Epoch-23 lr: 2.1995554991749272e-06
Epoch-23 lr: 4.3991109983498545e-06
epoch 23 training time: 15.221
---------------
2023-09-24 22:15:15.318901
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01417	Per Sample Data Time 0.00820	Per Sample DNN Time 0.00597	Train Loss 0.0225	
start validation
acc: 0.737089
AUC: 0.900187
Avg Precision: 0.476753
Avg Recall: 1.000000
d_prime: 1.813898
train_loss: 0.048926
valid_loss: 1.320706
validation finished
normal learning rate scheduler step
Epoch-24 lr: 1.5810683462410992e-06
Epoch-24 lr: 3.1621366924821984e-06
epoch 24 training time: 15.327
---------------
2023-09-24 22:15:30.645988
current #epochs=25, #steps=936
start validation
acc: 0.737089
AUC: 0.900190
Avg Precision: 0.476753
Avg Recall: 1.000000
d_prime: 1.813921
train_loss: 0.042932
valid_loss: 1.320687
validation finished
normal learning rate scheduler step
Epoch-25 lr: 1.1364919486792913e-06
Epoch-25 lr: 2.2729838973585825e-06
epoch 25 training time: 15.203
---------------
2023-09-24 22:15:45.848890
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00704	Per Sample Data Time 0.00131	Per Sample DNN Time 0.00572	Train Loss 0.0533	
start validation
acc: 0.737089
AUC: 0.900160
Avg Precision: 0.476753
Avg Recall: 1.000000
d_prime: 1.813680
train_loss: 0.049581
valid_loss: 1.320672
validation finished
normal learning rate scheduler step
Epoch-26 lr: 8.169248043473846e-07
Epoch-26 lr: 1.6338496086947691e-06
epoch 26 training time: 15.473
---------------
2023-09-24 22:16:01.321935
current #epochs=27, #steps=1014
start validation
acc: 0.737089
AUC: 0.900118
Avg Precision: 0.476753
Avg Recall: 1.000000
d_prime: 1.813343
train_loss: 0.056267
valid_loss: 1.320681
validation finished
normal learning rate scheduler step
Epoch-27 lr: 5.872158942556115e-07
Epoch-27 lr: 1.174431788511223e-06
epoch 27 training time: 15.232
---------------
2023-09-24 22:16:16.553684
current #epochs=28, #steps=1053
start validation
acc: 0.737089
AUC: 0.900175
Avg Precision: 0.476753
Avg Recall: 1.000000
d_prime: 1.813801
train_loss: 0.046361
valid_loss: 1.320679
validation finished
normal learning rate scheduler step
Epoch-28 lr: 4.220982208293765e-07
Epoch-28 lr: 8.44196441658753e-07
epoch 28 training time: 15.289
---------------
2023-09-24 22:16:31.843135
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00933	Per Sample Data Time 0.00355	Per Sample DNN Time 0.00577	Train Loss 0.0442	
start validation
acc: 0.737089
AUC: 0.900154
Avg Precision: 0.476753
Avg Recall: 1.000000
d_prime: 1.813629
train_loss: 0.033958
valid_loss: 1.320691
validation finished
normal learning rate scheduler step
Epoch-29 lr: 3.0340954625075276e-07
Epoch-29 lr: 6.068190925015055e-07
epoch 29 training time: 16.568
---------------
2023-09-24 22:16:48.411500
current #epochs=30, #steps=1131
start validation
acc: 0.737089
AUC: 0.900154
Avg Precision: 0.476753
Avg Recall: 1.000000
d_prime: 1.813629
train_loss: 0.046331
valid_loss: 1.320698
validation finished
normal learning rate scheduler step
Epoch-30 lr: 2.180946239839749e-07
Epoch-30 lr: 4.361892479679498e-07
epoch 30 training time: 15.181
---------------
2023-09-24 22:17:03.592169
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00666	Per Sample Data Time 0.00113	Per Sample DNN Time 0.00554	Train Loss 0.0403	
start validation
acc: 0.737089
AUC: 0.900154
Avg Precision: 0.476753
Avg Recall: 1.000000
d_prime: 1.813629
train_loss: 0.040063
valid_loss: 1.320699
validation finished
normal learning rate scheduler step
Epoch-31 lr: 1.567691774978006e-07
Epoch-31 lr: 3.135383549956012e-07
epoch 31 training time: 15.227
---------------
2023-09-24 22:17:18.819433
current #epochs=32, #steps=1209
start validation
acc: 0.737089
AUC: 0.900154
Avg Precision: 0.476753
Avg Recall: 1.000000
d_prime: 1.813629
train_loss: 0.045846
valid_loss: 1.320696
validation finished
normal learning rate scheduler step
Epoch-32 lr: 1.1268766998650431e-07
Epoch-32 lr: 2.2537533997300861e-07
epoch 32 training time: 16.411
---------------
2023-09-24 22:17:35.230812
current #epochs=33, #steps=1248
start validation
acc: 0.737089
AUC: 0.900154
Avg Precision: 0.476753
Avg Recall: 1.000000
d_prime: 1.813629
train_loss: 0.048708
valid_loss: 1.320699
validation finished
normal learning rate scheduler step
Epoch-33 lr: 8.100132417397838e-08
Epoch-33 lr: 1.6200264834795676e-07
epoch 33 training time: 16.713
---------------
2023-09-24 22:17:51.944021
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00814	Per Sample Data Time 0.00235	Per Sample DNN Time 0.00578	Train Loss 0.0532	
start validation
acc: 0.737089
AUC: 0.900154
Avg Precision: 0.476753
Avg Recall: 1.000000
d_prime: 1.813629
train_loss: 0.054519
valid_loss: 1.320699
validation finished
normal learning rate scheduler step
Epoch-34 lr: 5.822477755306963e-08
Epoch-34 lr: 1.1644955510613926e-07
epoch 34 training time: 16.287
---------------
2023-09-24 22:18:08.231135
current #epochs=35, #steps=1326
start validation
acc: 0.737089
AUC: 0.900154
Avg Precision: 0.476753
Avg Recall: 1.000000
d_prime: 1.813629
train_loss: 0.060148
valid_loss: 1.320698
validation finished
normal learning rate scheduler step
Epoch-35 lr: 4.185270741775746e-08
Epoch-35 lr: 8.370541483551491e-08
epoch 35 training time: 15.232
---------------
2023-09-24 22:18:23.462933
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00656	Per Sample Data Time 0.00099	Per Sample DNN Time 0.00557	Train Loss 0.0421	
start validation
acc: 0.737089
AUC: 0.900154
Avg Precision: 0.476753
Avg Recall: 1.000000
d_prime: 1.813629
train_loss: 0.041586
valid_loss: 1.320698
validation finished
normal learning rate scheduler step
Epoch-36 lr: 3.008425608152559e-08
Epoch-36 lr: 6.016851216305119e-08
epoch 36 training time: 15.380
---------------
2023-09-24 22:18:38.843157
current #epochs=37, #steps=1404
start validation
acc: 0.737089
AUC: 0.900154
Avg Precision: 0.476753
Avg Recall: 1.000000
d_prime: 1.813629
train_loss: 0.042155
valid_loss: 1.320697
validation finished
normal learning rate scheduler step
Epoch-37 lr: 2.16249442346663e-08
Epoch-37 lr: 4.32498884693326e-08
epoch 37 training time: 15.358
---------------
2023-09-24 22:18:54.201471
current #epochs=38, #steps=1443
start validation
acc: 0.737089
AUC: 0.900154
Avg Precision: 0.476753
Avg Recall: 1.000000
d_prime: 1.813629
train_loss: 0.047991
valid_loss: 1.320697
validation finished
normal learning rate scheduler step
Epoch-38 lr: 1.5544283757097743e-08
Epoch-38 lr: 3.1088567514195485e-08
epoch 38 training time: 15.164
---------------
2023-09-24 22:19:09.365693
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00744	Per Sample Data Time 0.00179	Per Sample DNN Time 0.00565	Train Loss 0.0423	
start validation
[I 2023-09-24 22:19:24,613] Trial 77 finished with value: 0.4767527158544868 and parameters: {'warmup': 'True', 'num_epochs': 39, 'batch_size': 51, 'lr-adaptschedule': 'True', 'lr': 0.0006023760477799841, 'head-lr': 2, 'lr-scheduler-start': 7, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7188126632104405}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.737089
AUC: 0.900154
Avg Precision: 0.476753
Avg Recall: 1.000000
d_prime: 1.813629
train_loss: 0.041789
valid_loss: 1.320697
validation finished
normal learning rate scheduler step
Epoch-39 lr: 1.117342800513822e-08
Epoch-39 lr: 2.234685601027644e-08
epoch 39 training time: 15.233
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 3 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f5818e0>
The learning rate scheduler starts at 5 epoch with decay rate of 0.778 every 3 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 22:19:24.651154
current #epochs=1, #steps=0
start validation
acc: 0.718310
AUC: 0.893178
Avg Precision: 0.473864
Avg Recall: 1.000000
d_prime: 1.758727
train_loss: 0.107817
valid_loss: 1.333982
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0010581880680498442
Epoch-1 lr: 0.0031745642041495327
epoch 1 training time: 17.834
---------------
2023-09-24 22:19:42.485436
current #epochs=2, #steps=39
start validation
acc: 0.746479
AUC: 0.901805
Avg Precision: 0.496055
Avg Recall: 1.000000
d_prime: 1.827033
train_loss: 0.110924
valid_loss: 1.325127
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0010581880680498442
Epoch-2 lr: 0.0031745642041495327
epoch 2 training time: 18.942
---------------
2023-09-24 22:20:01.427230
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00566	Train Loss 0.1050	
start validation
acc: 0.704225
AUC: 0.884017
Avg Precision: 0.443541
Avg Recall: 1.000000
d_prime: 1.690424
train_loss: 0.096008
valid_loss: 1.357743
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0010581880680498442
Epoch-3 lr: 0.0031745642041495327
epoch 3 training time: 15.987
---------------
2023-09-24 22:20:17.414806
current #epochs=4, #steps=117
start validation
acc: 0.737089
AUC: 0.901792
Avg Precision: 0.463543
Avg Recall: 1.000000
d_prime: 1.826927
train_loss: 0.070069
valid_loss: 1.320751
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0010581880680498442
Epoch-4 lr: 0.0031745642041495327
epoch 4 training time: 17.111
---------------
2023-09-24 22:20:34.525890
current #epochs=5, #steps=156
start validation
acc: 0.741784
AUC: 0.882716
Avg Precision: 0.470573
Avg Recall: 1.000000
d_prime: 1.681035
train_loss: 0.070531
valid_loss: 1.335671
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0008234923396871103
Epoch-5 lr: 0.0024704770190613306
epoch 5 training time: 15.169
---------------
2023-09-24 22:20:49.694501
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01135	Per Sample Data Time 0.00519	Per Sample DNN Time 0.00616	Train Loss 0.0479	
start validation
acc: 0.760563
AUC: 0.898389
Avg Precision: 0.468332
Avg Recall: 1.000000
d_prime: 1.799483
train_loss: 0.065878
valid_loss: 1.311117
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0008234923396871103
Epoch-6 lr: 0.0024704770190613306
epoch 6 training time: 17.694
---------------
2023-09-24 22:21:07.388873
current #epochs=7, #steps=234
start validation
acc: 0.727700
AUC: 0.899083
Avg Precision: 0.472645
Avg Recall: 1.000000
d_prime: 1.805021
train_loss: 0.052145
valid_loss: 1.304900
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0008234923396871103
Epoch-7 lr: 0.0024704770190613306
epoch 7 training time: 15.319
---------------
2023-09-24 22:21:22.710925
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00681	Per Sample Data Time 0.00120	Per Sample DNN Time 0.00561	Train Loss 0.0544	
start validation
acc: 0.741784
AUC: 0.900539
Avg Precision: 0.459788
Avg Recall: 1.000000
d_prime: 1.816737
train_loss: 0.060605
valid_loss: 1.322784
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.000640849820555157
Epoch-8 lr: 0.001922549461665471
epoch 8 training time: 15.676
---------------
2023-09-24 22:21:38.384727
current #epochs=9, #steps=312
start validation
acc: 0.732394
AUC: 0.891919
Avg Precision: 0.456659
Avg Recall: 1.000000
d_prime: 1.749094
train_loss: 0.054341
valid_loss: 1.346290
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.000640849820555157
Epoch-9 lr: 0.001922549461665471
epoch 9 training time: 16.033
---------------
2023-09-24 22:21:54.417906
current #epochs=10, #steps=351
start validation
acc: 0.708920
AUC: 0.893105
Avg Precision: 0.479313
Avg Recall: 1.000000
d_prime: 1.758166
train_loss: 0.066336
valid_loss: 1.345143
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.000640849820555157
Epoch-10 lr: 0.001922549461665471
epoch 10 training time: 18.061
---------------
2023-09-24 22:22:12.478903
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00890	Per Sample Data Time 0.00292	Per Sample DNN Time 0.00598	Train Loss 0.0416	
start validation
acc: 0.727700
AUC: 0.896746
Avg Precision: 0.471368
Avg Recall: 1.000000
d_prime: 1.786468
train_loss: 0.051120
valid_loss: 1.330531
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0004987156197003847
Epoch-11 lr: 0.0014961468591011542
epoch 11 training time: 15.320
---------------
2023-09-24 22:22:27.798862
current #epochs=12, #steps=429
start validation
acc: 0.713615
AUC: 0.890163
Avg Precision: 0.469709
Avg Recall: 1.000000
d_prime: 1.735798
train_loss: 0.051419
valid_loss: 1.341355
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0004987156197003847
Epoch-12 lr: 0.0014961468591011542
epoch 12 training time: 15.392
---------------
2023-09-24 22:22:43.190708
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00669	Per Sample Data Time 0.00107	Per Sample DNN Time 0.00562	Train Loss 0.0668	
start validation
acc: 0.718310
AUC: 0.896413
Avg Precision: 0.477260
Avg Recall: 1.000000
d_prime: 1.783851
train_loss: 0.063226
valid_loss: 1.339182
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0004987156197003847
Epoch-13 lr: 0.0014961468591011542
epoch 13 training time: 16.640
---------------
2023-09-24 22:22:59.830855
current #epochs=14, #steps=507
start validation
acc: 0.737089
AUC: 0.894865
Avg Precision: 0.475493
Avg Recall: 1.000000
d_prime: 1.771758
train_loss: 0.056873
valid_loss: 1.342223
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0003881053896803456
Epoch-14 lr: 0.001164316169041037
epoch 14 training time: 15.243
---------------
2023-09-24 22:23:15.073733
current #epochs=15, #steps=546
start validation
acc: 0.723005
AUC: 0.886744
Avg Precision: 0.480048
Avg Recall: 1.000000
d_prime: 1.710342
train_loss: 0.067975
valid_loss: 1.348113
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.0003881053896803456
Epoch-15 lr: 0.001164316169041037
epoch 15 training time: 15.289
---------------
2023-09-24 22:23:30.362391
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00769	Per Sample Data Time 0.00206	Per Sample DNN Time 0.00564	Train Loss 0.0603	
start validation
acc: 0.708920
AUC: 0.883365
Avg Precision: 0.474015
Avg Recall: 1.000000
d_prime: 1.685708
train_loss: 0.056540
valid_loss: 1.348078
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.0003881053896803456
Epoch-16 lr: 0.001164316169041037
epoch 16 training time: 16.413
---------------
2023-09-24 22:23:46.775469
current #epochs=17, #steps=624
start validation
acc: 0.713615
AUC: 0.886935
Avg Precision: 0.482424
Avg Recall: 1.000000
d_prime: 1.711745
train_loss: 0.070524
valid_loss: 1.332679
validation finished
normal learning rate scheduler step
Epoch-17 lr: 0.00030202742314232095
Epoch-17 lr: 0.000906082269426963
epoch 17 training time: 15.139
---------------
2023-09-24 22:24:01.914867
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00660	Per Sample Data Time 0.00097	Per Sample DNN Time 0.00564	Train Loss 0.0385	
start validation
acc: 0.713615
AUC: 0.886295
Avg Precision: 0.479702
Avg Recall: 1.000000
d_prime: 1.707039
train_loss: 0.038691
valid_loss: 1.342176
validation finished
normal learning rate scheduler step
Epoch-18 lr: 0.00030202742314232095
Epoch-18 lr: 0.000906082269426963
epoch 18 training time: 15.342
---------------
2023-09-24 22:24:17.257074
current #epochs=19, #steps=702
start validation
acc: 0.708920
AUC: 0.890234
Avg Precision: 0.482417
Avg Recall: 1.000000
d_prime: 1.736333
train_loss: 0.057385
valid_loss: 1.339081
validation finished
normal learning rate scheduler step
Epoch-19 lr: 0.00030202742314232095
Epoch-19 lr: 0.000906082269426963
epoch 19 training time: 15.126
---------------
2023-09-24 22:24:32.382811
current #epochs=20, #steps=741
start validation
acc: 0.723005
AUC: 0.891772
Avg Precision: 0.475847
Avg Recall: 1.000000
d_prime: 1.747975
train_loss: 0.069996
valid_loss: 1.323405
validation finished
normal learning rate scheduler step
Epoch-20 lr: 0.00023504070480732665
Epoch-20 lr: 0.00070512211442198
epoch 20 training time: 15.222
---------------
2023-09-24 22:24:47.604919
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00726	Per Sample Data Time 0.00165	Per Sample DNN Time 0.00561	Train Loss 0.0668	
start validation
acc: 0.741784
AUC: 0.893336
Avg Precision: 0.478501
Avg Recall: 1.000000
d_prime: 1.759940
train_loss: 0.056049
valid_loss: 1.323144
validation finished
normal learning rate scheduler step
Epoch-21 lr: 0.00023504070480732665
Epoch-21 lr: 0.00070512211442198
epoch 21 training time: 15.234
---------------
2023-09-24 22:25:02.839426
current #epochs=22, #steps=819
start validation
acc: 0.732394
AUC: 0.894904
Avg Precision: 0.477000
Avg Recall: 1.000000
d_prime: 1.772060
train_loss: 0.047555
valid_loss: 1.325407
validation finished
normal learning rate scheduler step
Epoch-22 lr: 0.00023504070480732665
Epoch-22 lr: 0.00070512211442198
epoch 22 training time: 15.507
---------------
2023-09-24 22:25:18.346559
current #epochs=23, #steps=858
start validation
acc: 0.737089
AUC: 0.893278
Avg Precision: 0.475106
Avg Recall: 1.000000
d_prime: 1.759498
train_loss: 0.043129
valid_loss: 1.320199
validation finished
normal learning rate scheduler step
Epoch-23 lr: 0.00018291098318675786
Epoch-23 lr: 0.0005487329495602736
epoch 23 training time: 15.246
---------------
2023-09-24 22:25:33.592826
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01382	Per Sample Data Time 0.00765	Per Sample DNN Time 0.00617	Train Loss 0.0228	
start validation
acc: 0.741784
AUC: 0.893864
Avg Precision: 0.482921
Avg Recall: 1.000000
d_prime: 1.764008
train_loss: 0.037941
valid_loss: 1.318618
validation finished
normal learning rate scheduler step
Epoch-24 lr: 0.00018291098318675786
Epoch-24 lr: 0.0005487329495602736
epoch 24 training time: 15.985
---------------
2023-09-24 22:25:49.578178
current #epochs=25, #steps=936
start validation
acc: 0.713615
AUC: 0.892789
Avg Precision: 0.483107
Avg Recall: 1.000000
d_prime: 1.755744
train_loss: 0.066383
valid_loss: 1.331096
validation finished
normal learning rate scheduler step
Epoch-25 lr: 0.00018291098318675786
Epoch-25 lr: 0.0005487329495602736
epoch 25 training time: 15.239
---------------
2023-09-24 22:26:04.817480
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00697	Per Sample Data Time 0.00134	Per Sample DNN Time 0.00563	Train Loss 0.0388	
start validation
acc: 0.727700
AUC: 0.892979
Avg Precision: 0.484844
Avg Recall: 1.000000
d_prime: 1.757200
train_loss: 0.041840
valid_loss: 1.324847
validation finished
normal learning rate scheduler step
Epoch-26 lr: 0.00014234312221694597
Epoch-26 lr: 0.00042702936665083794
epoch 26 training time: 15.315
---------------
2023-09-24 22:26:20.132539
current #epochs=27, #steps=1014
start validation
[I 2023-09-24 22:26:35,316] Trial 78 finished with value: 0.48460367208034766 and parameters: {'warmup': 'True', 'num_epochs': 27, 'batch_size': 30, 'lr-adaptschedule': 'True', 'lr': 0.0010581880680498442, 'head-lr': 3, 'lr-scheduler-start': 5, 'lr-scheduler-step': 3, 'lr-scheduler-decay': 0.7782098140690062}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.727700
AUC: 0.894910
Avg Precision: 0.484604
Avg Recall: 1.000000
d_prime: 1.772106
train_loss: 0.041612
valid_loss: 1.324201
validation finished
normal learning rate scheduler step
Epoch-27 lr: 0.00014234312221694597
Epoch-27 lr: 0.00042702936665083794
epoch 27 training time: 15.168
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f5470d0>
The learning rate scheduler starts at 8 epoch with decay rate of 0.804 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 22:26:35.354954
current #epochs=1, #steps=0
start validation
acc: 0.727700
AUC: 0.892393
Avg Precision: 0.475921
Avg Recall: 1.000000
d_prime: 1.752715
train_loss: 0.052908
valid_loss: 1.321425
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0001177417702260835
Epoch-1 lr: 0.0001177417702260835
epoch 1 training time: 17.685
---------------
2023-09-24 22:26:53.040230
current #epochs=2, #steps=39
start validation
acc: 0.737089
AUC: 0.891964
Avg Precision: 0.484983
Avg Recall: 1.000000
d_prime: 1.749436
train_loss: 0.047088
valid_loss: 1.328210
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0001177417702260835
Epoch-2 lr: 0.0001177417702260835
epoch 2 training time: 18.332
---------------
2023-09-24 22:27:11.372115
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00142	Per Sample DNN Time 0.00568	Train Loss 0.0451	
start validation
acc: 0.751174
AUC: 0.892077
Avg Precision: 0.468756
Avg Recall: 1.000000
d_prime: 1.750302
train_loss: 0.046399
valid_loss: 1.325435
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0001177417702260835
Epoch-3 lr: 0.0001177417702260835
epoch 3 training time: 17.616
---------------
2023-09-24 22:27:28.987994
current #epochs=4, #steps=117
start validation
acc: 0.732394
AUC: 0.891763
Avg Precision: 0.468714
Avg Recall: 1.000000
d_prime: 1.747909
train_loss: 0.054366
valid_loss: 1.323919
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0001177417702260835
Epoch-4 lr: 0.0001177417702260835
epoch 4 training time: 15.510
---------------
2023-09-24 22:27:44.498197
current #epochs=5, #steps=156
start validation
acc: 0.727700
AUC: 0.892318
Avg Precision: 0.463540
Avg Recall: 1.000000
d_prime: 1.752141
train_loss: 0.055164
valid_loss: 1.320022
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0001177417702260835
Epoch-5 lr: 0.0001177417702260835
epoch 5 training time: 15.212
---------------
2023-09-24 22:27:59.710437
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01108	Per Sample Data Time 0.00531	Per Sample DNN Time 0.00578	Train Loss 0.0568	
start validation
acc: 0.723005
AUC: 0.893361
Avg Precision: 0.452000
Avg Recall: 1.000000
d_prime: 1.760133
train_loss: 0.041164
valid_loss: 1.328715
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0001177417702260835
Epoch-6 lr: 0.0001177417702260835
epoch 6 training time: 15.205
---------------
2023-09-24 22:28:14.915622
current #epochs=7, #steps=234
start validation
acc: 0.732394
AUC: 0.892155
Avg Precision: 0.462200
Avg Recall: 1.000000
d_prime: 1.750896
train_loss: 0.045805
valid_loss: 1.338355
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0001177417702260835
Epoch-7 lr: 0.0001177417702260835
epoch 7 training time: 15.281
---------------
2023-09-24 22:28:30.196635
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00687	Per Sample Data Time 0.00123	Per Sample DNN Time 0.00564	Train Loss 0.0376	
start validation
acc: 0.723005
AUC: 0.890804
Avg Precision: 0.468124
Avg Recall: 1.000000
d_prime: 1.740638
train_loss: 0.039508
valid_loss: 1.339322
validation finished
normal learning rate scheduler step
Epoch-8 lr: 9.466450581578146e-05
Epoch-8 lr: 9.466450581578146e-05
epoch 8 training time: 15.166
---------------
2023-09-24 22:28:45.362778
current #epochs=9, #steps=312
start validation
acc: 0.718310
AUC: 0.889315
Avg Precision: 0.467657
Avg Recall: 1.000000
d_prime: 1.729434
train_loss: 0.040694
valid_loss: 1.338671
validation finished
normal learning rate scheduler step
Epoch-9 lr: 7.611036120944015e-05
Epoch-9 lr: 7.611036120944015e-05
epoch 9 training time: 16.795
---------------
2023-09-24 22:29:02.158513
current #epochs=10, #steps=351
start validation
acc: 0.732394
AUC: 0.891481
Avg Precision: 0.468262
Avg Recall: 1.000000
d_prime: 1.745767
train_loss: 0.039160
valid_loss: 1.331694
validation finished
normal learning rate scheduler step
Epoch-10 lr: 6.119280963346814e-05
Epoch-10 lr: 6.119280963346814e-05
epoch 10 training time: 15.244
---------------
2023-09-24 22:29:17.401937
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00864	Per Sample Data Time 0.00289	Per Sample DNN Time 0.00575	Train Loss 0.0562	
start validation
acc: 0.732394
AUC: 0.892965
Avg Precision: 0.468138
Avg Recall: 1.000000
d_prime: 1.757091
train_loss: 0.043451
valid_loss: 1.328745
validation finished
normal learning rate scheduler step
Epoch-11 lr: 4.919908263913777e-05
Epoch-11 lr: 4.919908263913777e-05
epoch 11 training time: 15.180
---------------
2023-09-24 22:29:32.582560
current #epochs=12, #steps=429
start validation
acc: 0.732394
AUC: 0.893690
Avg Precision: 0.468079
Avg Recall: 1.000000
d_prime: 1.762664
train_loss: 0.049001
valid_loss: 1.330995
validation finished
normal learning rate scheduler step
Epoch-12 lr: 3.9556113651771884e-05
Epoch-12 lr: 3.9556113651771884e-05
epoch 12 training time: 15.215
---------------
2023-09-24 22:29:47.797406
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00668	Per Sample Data Time 0.00108	Per Sample DNN Time 0.00560	Train Loss 0.0459	
start validation
acc: 0.727700
AUC: 0.894330
Avg Precision: 0.468845
Avg Recall: 1.000000
d_prime: 1.767614
train_loss: 0.049563
valid_loss: 1.328527
validation finished
normal learning rate scheduler step
Epoch-13 lr: 3.180315654884161e-05
Epoch-13 lr: 3.180315654884161e-05
epoch 13 training time: 15.288
---------------
2023-09-24 22:30:03.084721
current #epochs=14, #steps=507
start validation
acc: 0.727700
AUC: 0.895107
Avg Precision: 0.470013
Avg Recall: 1.000000
d_prime: 1.773645
train_loss: 0.039551
valid_loss: 1.326545
validation finished
normal learning rate scheduler step
Epoch-14 lr: 2.5569770968256394e-05
Epoch-14 lr: 2.5569770968256394e-05
epoch 14 training time: 16.531
---------------
2023-09-24 22:30:19.616138
current #epochs=15, #steps=546
start validation
acc: 0.732394
AUC: 0.894506
Avg Precision: 0.468462
Avg Recall: 1.000000
d_prime: 1.768973
train_loss: 0.059549
valid_loss: 1.325158
validation finished
normal learning rate scheduler step
Epoch-15 lr: 2.055812247331474e-05
Epoch-15 lr: 2.055812247331474e-05
epoch 15 training time: 15.118
---------------
2023-09-24 22:30:34.734047
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00782	Per Sample Data Time 0.00206	Per Sample DNN Time 0.00576	Train Loss 0.0571	
start validation
acc: 0.732394
AUC: 0.894274
Avg Precision: 0.467630
Avg Recall: 1.000000
d_prime: 1.767175
train_loss: 0.056340
valid_loss: 1.324845
validation finished
normal learning rate scheduler step
Epoch-16 lr: 1.6528751866901378e-05
Epoch-16 lr: 1.6528751866901378e-05
epoch 16 training time: 15.351
---------------
2023-09-24 22:30:50.084639
current #epochs=17, #steps=624
start validation
acc: 0.732394
AUC: 0.894710
Avg Precision: 0.467757
Avg Recall: 1.000000
d_prime: 1.770560
train_loss: 0.037951
valid_loss: 1.324725
validation finished
normal learning rate scheduler step
Epoch-17 lr: 1.3289133705289468e-05
Epoch-17 lr: 1.3289133705289468e-05
epoch 17 training time: 15.200
---------------
2023-09-24 22:31:05.284783
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00651	Per Sample Data Time 0.00095	Per Sample DNN Time 0.00556	Train Loss 0.0300	
start validation
acc: 0.732394
AUC: 0.894871
Avg Precision: 0.468209
Avg Recall: 1.000000
d_prime: 1.771809
train_loss: 0.029461
valid_loss: 1.325777
validation finished
normal learning rate scheduler step
Epoch-18 lr: 1.068447733132845e-05
Epoch-18 lr: 1.068447733132845e-05
epoch 18 training time: 15.232
---------------
2023-09-24 22:31:20.516805
current #epochs=19, #steps=702
start validation
acc: 0.723005
AUC: 0.894823
Avg Precision: 0.468035
Avg Recall: 1.000000
d_prime: 1.771432
train_loss: 0.049480
valid_loss: 1.326648
validation finished
normal learning rate scheduler step
Epoch-19 lr: 8.590330895552148e-06
Epoch-19 lr: 8.590330895552148e-06
epoch 19 training time: 15.833
---------------
2023-09-24 22:31:36.350312
current #epochs=20, #steps=741
start validation
acc: 0.723005
AUC: 0.894783
Avg Precision: 0.468275
Avg Recall: 1.000000
d_prime: 1.771121
train_loss: 0.044328
valid_loss: 1.326886
validation finished
normal learning rate scheduler step
Epoch-20 lr: 6.906634981451419e-06
Epoch-20 lr: 6.906634981451419e-06
epoch 20 training time: 15.462
---------------
2023-09-24 22:31:51.812454
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00724	Per Sample Data Time 0.00167	Per Sample DNN Time 0.00557	Train Loss 0.0397	
start validation
acc: 0.723005
AUC: 0.895047
Avg Precision: 0.468541
Avg Recall: 1.000000
d_prime: 1.773175
train_loss: 0.039845
valid_loss: 1.327018
validation finished
normal learning rate scheduler step
Epoch-21 lr: 5.5529417140039516e-06
Epoch-21 lr: 5.5529417140039516e-06
epoch 21 training time: 15.280
---------------
2023-09-24 22:32:07.092684
current #epochs=22, #steps=819
start validation
acc: 0.723005
AUC: 0.894763
Avg Precision: 0.468475
Avg Recall: 1.000000
d_prime: 1.770967
train_loss: 0.055353
valid_loss: 1.326965
validation finished
normal learning rate scheduler step
Epoch-22 lr: 4.464570917955937e-06
Epoch-22 lr: 4.464570917955937e-06
epoch 22 training time: 15.622
---------------
2023-09-24 22:32:22.714676
current #epochs=23, #steps=858
start validation
acc: 0.723005
AUC: 0.894956
Avg Precision: 0.468608
Avg Recall: 1.000000
d_prime: 1.772464
train_loss: 0.037756
valid_loss: 1.327238
validation finished
normal learning rate scheduler step
Epoch-23 lr: 3.5895196650795836e-06
Epoch-23 lr: 3.5895196650795836e-06
epoch 23 training time: 15.363
---------------
2023-09-24 22:32:38.077626
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01461	Per Sample Data Time 0.00800	Per Sample DNN Time 0.00661	Train Loss 0.0449	
start validation
acc: 0.723005
AUC: 0.895045
Avg Precision: 0.468608
Avg Recall: 1.000000
d_prime: 1.773161
train_loss: 0.035733
valid_loss: 1.327297
validation finished
normal learning rate scheduler step
Epoch-24 lr: 2.8859775469514027e-06
Epoch-24 lr: 2.8859775469514027e-06
epoch 24 training time: 15.364
---------------
2023-09-24 22:32:53.441817
current #epochs=25, #steps=936
start validation
acc: 0.723005
AUC: 0.895158
Avg Precision: 0.468608
Avg Recall: 1.000000
d_prime: 1.774042
train_loss: 0.053378
valid_loss: 1.327474
validation finished
normal learning rate scheduler step
Epoch-25 lr: 2.3203289516796602e-06
Epoch-25 lr: 2.3203289516796602e-06
epoch 25 training time: 15.169
---------------
2023-09-24 22:33:08.611227
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00690	Per Sample Data Time 0.00131	Per Sample DNN Time 0.00559	Train Loss 0.0429	
start validation
acc: 0.723005
AUC: 0.895118
Avg Precision: 0.468608
Avg Recall: 1.000000
d_prime: 1.773726
train_loss: 0.037495
valid_loss: 1.327496
validation finished
normal learning rate scheduler step
Epoch-26 lr: 1.8655468923138825e-06
Epoch-26 lr: 1.8655468923138825e-06
epoch 26 training time: 15.252
---------------
2023-09-24 22:33:23.863369
current #epochs=27, #steps=1014
start validation
acc: 0.723005
AUC: 0.895114
Avg Precision: 0.468608
Avg Recall: 1.000000
d_prime: 1.773693
train_loss: 0.055600
valid_loss: 1.327475
validation finished
normal learning rate scheduler step
Epoch-27 lr: 1.4999016432142777e-06
Epoch-27 lr: 1.4999016432142777e-06
epoch 27 training time: 15.290
---------------
2023-09-24 22:33:39.152926
current #epochs=28, #steps=1053
start validation
acc: 0.723005
AUC: 0.895020
Avg Precision: 0.468167
Avg Recall: 1.000000
d_prime: 1.772962
train_loss: 0.054446
valid_loss: 1.327532
validation finished
normal learning rate scheduler step
Epoch-28 lr: 1.2059224823486091e-06
Epoch-28 lr: 1.2059224823486091e-06
epoch 28 training time: 15.218
---------------
2023-09-24 22:33:54.370406
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00939	Per Sample Data Time 0.00344	Per Sample DNN Time 0.00595	Train Loss 0.0243	
start validation
acc: 0.723005
AUC: 0.895020
Avg Precision: 0.468167
Avg Recall: 1.000000
d_prime: 1.772962
train_loss: 0.037762
valid_loss: 1.327476
validation finished
normal learning rate scheduler step
Epoch-29 lr: 9.695629310181878e-07
Epoch-29 lr: 9.695629310181878e-07
epoch 29 training time: 15.164
---------------
2023-09-24 22:34:09.534812
current #epochs=30, #steps=1131
start validation
acc: 0.723005
AUC: 0.895035
Avg Precision: 0.468608
Avg Recall: 1.000000
d_prime: 1.773078
train_loss: 0.048322
valid_loss: 1.327436
validation finished
normal learning rate scheduler step
Epoch-30 lr: 7.79529605728694e-07
Epoch-30 lr: 7.79529605728694e-07
epoch 30 training time: 15.339
---------------
2023-09-24 22:34:24.873119
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00683	Per Sample Data Time 0.00120	Per Sample DNN Time 0.00563	Train Loss 0.0512	
start validation
acc: 0.723005
AUC: 0.894999
Avg Precision: 0.468608
Avg Recall: 1.000000
d_prime: 1.772802
train_loss: 0.054437
valid_loss: 1.327394
validation finished
normal learning rate scheduler step
Epoch-31 lr: 6.267426143957376e-07
Epoch-31 lr: 6.267426143957376e-07
epoch 31 training time: 15.328
---------------
2023-09-24 22:34:40.201564
current #epochs=32, #steps=1209
start validation
acc: 0.723005
AUC: 0.894999
Avg Precision: 0.468608
Avg Recall: 1.000000
d_prime: 1.772802
train_loss: 0.040382
valid_loss: 1.327423
validation finished
normal learning rate scheduler step
Epoch-32 lr: 5.03901714332471e-07
Epoch-32 lr: 5.03901714332471e-07
epoch 32 training time: 15.247
---------------
2023-09-24 22:34:55.448389
current #epochs=33, #steps=1248
start validation
acc: 0.723005
AUC: 0.894999
Avg Precision: 0.468608
Avg Recall: 1.000000
d_prime: 1.772802
train_loss: 0.056617
valid_loss: 1.327408
validation finished
normal learning rate scheduler step
Epoch-33 lr: 4.051375028200574e-07
Epoch-33 lr: 4.051375028200574e-07
epoch 33 training time: 15.319
---------------
2023-09-24 22:35:10.767853
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00808	Per Sample Data Time 0.00233	Per Sample DNN Time 0.00575	Train Loss 0.0353	
start validation
acc: 0.723005
AUC: 0.894999
Avg Precision: 0.468608
Avg Recall: 1.000000
d_prime: 1.772802
train_loss: 0.044121
valid_loss: 1.327397
validation finished
normal learning rate scheduler step
Epoch-34 lr: 3.257309739632596e-07
Epoch-34 lr: 3.257309739632596e-07
epoch 34 training time: 15.242
---------------
2023-09-24 22:35:26.009750
current #epochs=35, #steps=1326
start validation
acc: 0.723005
AUC: 0.894999
Avg Precision: 0.468608
Avg Recall: 1.000000
d_prime: 1.772802
train_loss: 0.049218
valid_loss: 1.327403
validation finished
normal learning rate scheduler step
Epoch-35 lr: 2.618880421104302e-07
Epoch-35 lr: 2.618880421104302e-07
epoch 35 training time: 15.205
---------------
2023-09-24 22:35:41.214803
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00655	Per Sample Data Time 0.00098	Per Sample DNN Time 0.00557	Train Loss 0.0520	
start validation
acc: 0.723005
AUC: 0.894999
Avg Precision: 0.468608
Avg Recall: 1.000000
d_prime: 1.772802
train_loss: 0.053362
valid_loss: 1.327445
validation finished
normal learning rate scheduler step
Epoch-36 lr: 2.1055825844849022e-07
Epoch-36 lr: 2.1055825844849022e-07
epoch 36 training time: 15.192
---------------
2023-09-24 22:35:56.407142
current #epochs=37, #steps=1404
start validation
acc: 0.723005
AUC: 0.894999
Avg Precision: 0.468608
Avg Recall: 1.000000
d_prime: 1.772802
train_loss: 0.046753
valid_loss: 1.327466
validation finished
normal learning rate scheduler step
Epoch-37 lr: 1.6928905895660015e-07
Epoch-37 lr: 1.6928905895660015e-07
epoch 37 training time: 15.208
---------------
2023-09-24 22:36:11.615669
current #epochs=38, #steps=1443
start validation
acc: 0.723005
AUC: 0.894999
Avg Precision: 0.468608
Avg Recall: 1.000000
d_prime: 1.772802
train_loss: 0.046257
valid_loss: 1.327470
validation finished
normal learning rate scheduler step
Epoch-38 lr: 1.3610857960920192e-07
Epoch-38 lr: 1.3610857960920192e-07
epoch 38 training time: 15.163
---------------
2023-09-24 22:36:26.778799
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00738	Per Sample Data Time 0.00173	Per Sample DNN Time 0.00565	Train Loss 0.0270	
start validation
acc: 0.723005
AUC: 0.894999
Avg Precision: 0.468608
Avg Recall: 1.000000
d_prime: 1.772802
train_loss: 0.038861
valid_loss: 1.327467
validation finished
normal learning rate scheduler step
Epoch-39 lr: 1.0943143967729046e-07
Epoch-39 lr: 1.0943143967729046e-07
epoch 39 training time: 15.741
---------------
2023-09-24 22:36:42.519924
current #epochs=40, #steps=1521
start validation
acc: 0.723005
AUC: 0.894999
Avg Precision: 0.468608
Avg Recall: 1.000000
d_prime: 1.772802
train_loss: 0.039863
valid_loss: 1.327469
validation finished
normal learning rate scheduler step
Epoch-40 lr: 8.798299140456865e-08
Epoch-40 lr: 8.798299140456865e-08
epoch 40 training time: 16.075
---------------
2023-09-24 22:36:58.595137
current #epochs=41, #steps=1560
start validation
acc: 0.723005
AUC: 0.894999
Avg Precision: 0.468608
Avg Recall: 1.000000
d_prime: 1.772802
train_loss: 0.039942
valid_loss: 1.327472
validation finished
normal learning rate scheduler step
Epoch-41 lr: 7.073841666822955e-08
Epoch-41 lr: 7.073841666822955e-08
epoch 41 training time: 15.110
---------------
2023-09-24 22:37:13.705034
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02257	Per Sample Data Time 0.01587	Per Sample DNN Time 0.00670	Train Loss 0.0386	
start validation
acc: 0.723005
AUC: 0.894999
Avg Precision: 0.468608
Avg Recall: 1.000000
d_prime: 1.772802
train_loss: 0.043277
valid_loss: 1.327466
validation finished
normal learning rate scheduler step
Epoch-42 lr: 5.68737606308328e-08
Epoch-42 lr: 5.68737606308328e-08
epoch 42 training time: 15.261
---------------
2023-09-24 22:37:28.966321
current #epochs=43, #steps=1638
start validation
acc: 0.723005
AUC: 0.895014
Avg Precision: 0.468608
Avg Recall: 1.000000
d_prime: 1.772919
train_loss: 0.048115
valid_loss: 1.327463
validation finished
normal learning rate scheduler step
Epoch-43 lr: 4.57265627454455e-08
Epoch-43 lr: 4.57265627454455e-08
epoch 43 training time: 15.504
---------------
2023-09-24 22:37:44.470487
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00719	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00573	Train Loss 0.0396	
start validation
acc: 0.723005
AUC: 0.895014
Avg Precision: 0.468608
Avg Recall: 1.000000
d_prime: 1.772919
train_loss: 0.039335
valid_loss: 1.327465
validation finished
normal learning rate scheduler step
Epoch-44 lr: 3.676420404279757e-08
Epoch-44 lr: 3.676420404279757e-08
epoch 44 training time: 15.394
---------------
2023-09-24 22:37:59.864978
current #epochs=45, #steps=1716
start validation
acc: 0.723005
AUC: 0.895014
Avg Precision: 0.468608
Avg Recall: 1.000000
d_prime: 1.772919
train_loss: 0.037086
valid_loss: 1.327465
validation finished
normal learning rate scheduler step
Epoch-45 lr: 2.955845831720813e-08
Epoch-45 lr: 2.955845831720813e-08
epoch 45 training time: 15.212
---------------
2023-09-24 22:38:15.076678
current #epochs=46, #steps=1755
start validation
[I 2023-09-24 22:38:30,396] Trial 79 finished with value: 0.4686076615950558 and parameters: {'warmup': 'True', 'num_epochs': 46, 'batch_size': 45, 'lr-adaptschedule': 'True', 'lr': 0.0001177417702260835, 'head-lr': 1, 'lr-scheduler-start': 8, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.8040010408711377}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.723005
AUC: 0.895014
Avg Precision: 0.468608
Avg Recall: 1.000000
d_prime: 1.772919
train_loss: 0.050922
valid_loss: 1.327465
validation finished
normal learning rate scheduler step
Epoch-46 lr: 2.3765031253581473e-08
Epoch-46 lr: 2.3765031253581473e-08
epoch 46 training time: 15.304
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 4 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f5b6e20>
The learning rate scheduler starts at 6 epoch with decay rate of 0.758 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 22:38:30.434546
current #epochs=1, #steps=0
start validation
acc: 0.713615
AUC: 0.896879
Avg Precision: 0.479471
Avg Recall: 1.000000
d_prime: 1.787519
train_loss: 0.056503
valid_loss: 1.333958
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.00044224462872534295
Epoch-1 lr: 0.0017689785149013718
epoch 1 training time: 17.605
---------------
2023-09-24 22:38:48.040226
current #epochs=2, #steps=39
start validation
acc: 0.732394
AUC: 0.885979
Avg Precision: 0.485738
Avg Recall: 1.000000
d_prime: 1.704719
train_loss: 0.055736
valid_loss: 1.336406
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.00044224462872534295
Epoch-2 lr: 0.0017689785149013718
epoch 2 training time: 17.626
---------------
2023-09-24 22:39:05.666186
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00713	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00563	Train Loss 0.0589	
start validation
acc: 0.708920
AUC: 0.888018
Avg Precision: 0.474849
Avg Recall: 1.000000
d_prime: 1.719760
train_loss: 0.054293
valid_loss: 1.329767
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.00044224462872534295
Epoch-3 lr: 0.0017689785149013718
epoch 3 training time: 15.189
---------------
2023-09-24 22:39:20.855712
current #epochs=4, #steps=117
start validation
acc: 0.718310
AUC: 0.887211
Avg Precision: 0.469543
Avg Recall: 1.000000
d_prime: 1.713787
train_loss: 0.056613
valid_loss: 1.346755
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00044224462872534295
Epoch-4 lr: 0.0017689785149013718
epoch 4 training time: 15.437
---------------
2023-09-24 22:39:36.292486
current #epochs=5, #steps=156
start validation
acc: 0.727700
AUC: 0.894563
Avg Precision: 0.474219
Avg Recall: 1.000000
d_prime: 1.769417
train_loss: 0.073071
valid_loss: 1.313964
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00044224462872534295
Epoch-5 lr: 0.0017689785149013718
epoch 5 training time: 15.863
---------------
2023-09-24 22:39:52.155809
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01098	Per Sample Data Time 0.00516	Per Sample DNN Time 0.00581	Train Loss 0.0414	
start validation
acc: 0.723005
AUC: 0.892038
Avg Precision: 0.468342
Avg Recall: 1.000000
d_prime: 1.750003
train_loss: 0.060664
valid_loss: 1.334072
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00033543973203672853
Epoch-6 lr: 0.0013417589281469141
epoch 6 training time: 15.195
---------------
2023-09-24 22:40:07.350671
current #epochs=7, #steps=234
start validation
acc: 0.741784
AUC: 0.890509
Avg Precision: 0.474608
Avg Recall: 1.000000
d_prime: 1.738406
train_loss: 0.052589
valid_loss: 1.327417
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00033543973203672853
Epoch-7 lr: 0.0013417589281469141
epoch 7 training time: 17.695
---------------
2023-09-24 22:40:25.045900
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00691	Per Sample Data Time 0.00128	Per Sample DNN Time 0.00563	Train Loss 0.0470	
start validation
acc: 0.751174
AUC: 0.896243
Avg Precision: 0.478736
Avg Recall: 1.000000
d_prime: 1.782521
train_loss: 0.047819
valid_loss: 1.322817
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00025442889866900554
Epoch-8 lr: 0.0010177155946760222
epoch 8 training time: 17.834
---------------
2023-09-24 22:40:42.880109
current #epochs=9, #steps=312
start validation
acc: 0.723005
AUC: 0.895272
Avg Precision: 0.471757
Avg Recall: 1.000000
d_prime: 1.774929
train_loss: 0.044722
valid_loss: 1.321928
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00025442889866900554
Epoch-9 lr: 0.0010177155946760222
epoch 9 training time: 15.117
---------------
2023-09-24 22:40:57.997862
current #epochs=10, #steps=351
start validation
acc: 0.713615
AUC: 0.890979
Avg Precision: 0.470457
Avg Recall: 1.000000
d_prime: 1.741961
train_loss: 0.045308
valid_loss: 1.337357
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.0001929826979197417
Epoch-10 lr: 0.0007719307916789668
epoch 10 training time: 15.181
---------------
2023-09-24 22:41:13.178402
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00873	Per Sample Data Time 0.00283	Per Sample DNN Time 0.00590	Train Loss 0.0497	
start validation
acc: 0.708920
AUC: 0.888153
Avg Precision: 0.467400
Avg Recall: 1.000000
d_prime: 1.720762
train_loss: 0.044803
valid_loss: 1.329668
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0001929826979197417
Epoch-11 lr: 0.0007719307916789668
epoch 11 training time: 15.188
---------------
2023-09-24 22:41:28.366449
current #epochs=12, #steps=429
start validation
acc: 0.713615
AUC: 0.888522
Avg Precision: 0.460420
Avg Recall: 1.000000
d_prime: 1.723513
train_loss: 0.058698
valid_loss: 1.331563
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00014637614630731068
Epoch-12 lr: 0.0005855045852292427
epoch 12 training time: 15.261
---------------
2023-09-24 22:41:43.627532
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00668	Per Sample Data Time 0.00109	Per Sample DNN Time 0.00558	Train Loss 0.0592	
start validation
acc: 0.732394
AUC: 0.894485
Avg Precision: 0.470431
Avg Recall: 1.000000
d_prime: 1.768809
train_loss: 0.072141
valid_loss: 1.330632
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00014637614630731068
Epoch-13 lr: 0.0005855045852292427
epoch 13 training time: 15.366
---------------
2023-09-24 22:41:58.993708
current #epochs=14, #steps=507
start validation
acc: 0.732394
AUC: 0.895529
Avg Precision: 0.466379
Avg Recall: 1.000000
d_prime: 1.776934
train_loss: 0.044851
valid_loss: 1.326434
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.00011102537397777457
Epoch-14 lr: 0.0004441014959110983
epoch 14 training time: 15.179
---------------
2023-09-24 22:42:14.172462
current #epochs=15, #steps=546
start validation
acc: 0.708920
AUC: 0.895864
Avg Precision: 0.467076
Avg Recall: 1.000000
d_prime: 1.779551
train_loss: 0.054005
valid_loss: 1.324215
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.00011102537397777457
Epoch-15 lr: 0.0004441014959110983
epoch 15 training time: 15.295
---------------
2023-09-24 22:42:29.467891
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00772	Per Sample Data Time 0.00202	Per Sample DNN Time 0.00570	Train Loss 0.0427	
start validation
acc: 0.732394
AUC: 0.893110
Avg Precision: 0.464050
Avg Recall: 1.000000
d_prime: 1.758201
train_loss: 0.049659
valid_loss: 1.330307
validation finished
normal learning rate scheduler step
Epoch-16 lr: 8.421203849037973e-05
Epoch-16 lr: 0.00033684815396151893
epoch 16 training time: 16.809
---------------
2023-09-24 22:42:46.277125
current #epochs=17, #steps=624
start validation
acc: 0.732394
AUC: 0.893031
Avg Precision: 0.463878
Avg Recall: 1.000000
d_prime: 1.757597
train_loss: 0.054920
valid_loss: 1.331910
validation finished
normal learning rate scheduler step
Epoch-17 lr: 8.421203849037973e-05
Epoch-17 lr: 0.00033684815396151893
epoch 17 training time: 16.989
---------------
2023-09-24 22:43:03.266570
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00654	Per Sample Data Time 0.00092	Per Sample DNN Time 0.00562	Train Loss 0.0504	
start validation
acc: 0.727700
AUC: 0.893347
Avg Precision: 0.463192
Avg Recall: 1.000000
d_prime: 1.760023
train_loss: 0.049387
valid_loss: 1.329643
validation finished
normal learning rate scheduler step
Epoch-18 lr: 6.387429443043201e-05
Epoch-18 lr: 0.00025549717772172805
epoch 18 training time: 16.007
---------------
2023-09-24 22:43:19.273878
current #epochs=19, #steps=702
start validation
acc: 0.723005
AUC: 0.892210
Avg Precision: 0.462892
Avg Recall: 1.000000
d_prime: 1.751319
train_loss: 0.042873
valid_loss: 1.328824
validation finished
normal learning rate scheduler step
Epoch-19 lr: 6.387429443043201e-05
Epoch-19 lr: 0.00025549717772172805
epoch 19 training time: 15.589
---------------
2023-09-24 22:43:34.862952
current #epochs=20, #steps=741
start validation
acc: 0.723005
AUC: 0.891676
Avg Precision: 0.462303
Avg Recall: 1.000000
d_prime: 1.747249
train_loss: 0.055710
valid_loss: 1.332408
validation finished
normal learning rate scheduler step
Epoch-20 lr: 4.844824519301481e-05
Epoch-20 lr: 0.00019379298077205925
epoch 20 training time: 15.367
---------------
2023-09-24 22:43:50.230049
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00725	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00567	Train Loss 0.0455	
start validation
acc: 0.718310
AUC: 0.891190
Avg Precision: 0.461856
Avg Recall: 1.000000
d_prime: 1.743560
train_loss: 0.046518
valid_loss: 1.332461
validation finished
normal learning rate scheduler step
Epoch-21 lr: 4.844824519301481e-05
Epoch-21 lr: 0.00019379298077205925
epoch 21 training time: 15.219
---------------
2023-09-24 22:44:05.449412
current #epochs=22, #steps=819
start validation
acc: 0.713615
AUC: 0.891251
Avg Precision: 0.461143
Avg Recall: 1.000000
d_prime: 1.744021
train_loss: 0.040039
valid_loss: 1.333201
validation finished
normal learning rate scheduler step
Epoch-22 lr: 3.67476851715199e-05
Epoch-22 lr: 0.0001469907406860796
epoch 22 training time: 15.334
---------------
2023-09-24 22:44:20.783304
current #epochs=23, #steps=858
start validation
acc: 0.713615
AUC: 0.892290
Avg Precision: 0.460936
Avg Recall: 1.000000
d_prime: 1.751928
train_loss: 0.045801
valid_loss: 1.334265
validation finished
normal learning rate scheduler step
Epoch-23 lr: 3.67476851715199e-05
Epoch-23 lr: 0.0001469907406860796
epoch 23 training time: 15.251
---------------
2023-09-24 22:44:36.034655
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01471	Per Sample Data Time 0.00795	Per Sample DNN Time 0.00675	Train Loss 0.0694	
start validation
acc: 0.723005
AUC: 0.893488
Avg Precision: 0.461645
Avg Recall: 1.000000
d_prime: 1.761109
train_loss: 0.054988
valid_loss: 1.335217
validation finished
normal learning rate scheduler step
Epoch-24 lr: 2.7872884974167055e-05
Epoch-24 lr: 0.00011149153989666822
epoch 24 training time: 15.323
---------------
2023-09-24 22:44:51.358065
current #epochs=25, #steps=936
start validation
acc: 0.723005
AUC: 0.894245
Avg Precision: 0.462067
Avg Recall: 1.000000
d_prime: 1.766953
train_loss: 0.058969
valid_loss: 1.334678
validation finished
normal learning rate scheduler step
Epoch-25 lr: 2.7872884974167055e-05
Epoch-25 lr: 0.00011149153989666822
epoch 25 training time: 15.240
---------------
2023-09-24 22:45:06.598534
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00704	Per Sample Data Time 0.00140	Per Sample DNN Time 0.00564	Train Loss 0.0376	
start validation
acc: 0.718310
AUC: 0.895353
Avg Precision: 0.462637
Avg Recall: 1.000000
d_prime: 1.775559
train_loss: 0.041139
valid_loss: 1.334072
validation finished
normal learning rate scheduler step
Epoch-26 lr: 2.114140559213392e-05
Epoch-26 lr: 8.456562236853568e-05
epoch 26 training time: 16.353
---------------
2023-09-24 22:45:22.951618
current #epochs=27, #steps=1014
start validation
acc: 0.718310
AUC: 0.895362
Avg Precision: 0.464565
Avg Recall: 1.000000
d_prime: 1.775626
train_loss: 0.040538
valid_loss: 1.332301
validation finished
normal learning rate scheduler step
Epoch-27 lr: 2.114140559213392e-05
Epoch-27 lr: 8.456562236853568e-05
epoch 27 training time: 15.283
---------------
2023-09-24 22:45:38.234667
current #epochs=28, #steps=1053
start validation
acc: 0.723005
AUC: 0.894644
Avg Precision: 0.462847
Avg Recall: 1.000000
d_prime: 1.770048
train_loss: 0.049573
valid_loss: 1.332266
validation finished
normal learning rate scheduler step
Epoch-28 lr: 1.6035621387070577e-05
Epoch-28 lr: 6.414248554828231e-05
epoch 28 training time: 16.137
---------------
2023-09-24 22:45:54.371970
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00937	Per Sample Data Time 0.00358	Per Sample DNN Time 0.00579	Train Loss 0.0149	
start validation
acc: 0.723005
AUC: 0.894970
Avg Precision: 0.462557
Avg Recall: 1.000000
d_prime: 1.772576
train_loss: 0.045865
valid_loss: 1.332114
validation finished
normal learning rate scheduler step
Epoch-29 lr: 1.6035621387070577e-05
Epoch-29 lr: 6.414248554828231e-05
epoch 29 training time: 15.234
---------------
2023-09-24 22:46:09.605422
current #epochs=30, #steps=1131
start validation
acc: 0.723005
AUC: 0.895370
Avg Precision: 0.463134
Avg Recall: 1.000000
d_prime: 1.775692
train_loss: 0.059311
valid_loss: 1.331279
validation finished
normal learning rate scheduler step
Epoch-30 lr: 1.2162916611615919e-05
Epoch-30 lr: 4.8651666446463674e-05
epoch 30 training time: 15.159
---------------
2023-09-24 22:46:24.765049
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00679	Per Sample Data Time 0.00112	Per Sample DNN Time 0.00567	Train Loss 0.0421	
start validation
acc: 0.723005
AUC: 0.895930
Avg Precision: 0.463134
Avg Recall: 1.000000
d_prime: 1.780065
train_loss: 0.041746
valid_loss: 1.331029
validation finished
normal learning rate scheduler step
Epoch-31 lr: 1.2162916611615919e-05
Epoch-31 lr: 4.8651666446463674e-05
epoch 31 training time: 15.377
---------------
2023-09-24 22:46:40.142160
current #epochs=32, #steps=1209
start validation
acc: 0.723005
AUC: 0.896119
Avg Precision: 0.462809
Avg Recall: 1.000000
d_prime: 1.781545
train_loss: 0.048627
valid_loss: 1.330901
validation finished
normal learning rate scheduler step
Epoch-32 lr: 9.225494723915269e-06
Epoch-32 lr: 3.6901978895661075e-05
epoch 32 training time: 15.198
---------------
2023-09-24 22:46:55.340155
current #epochs=33, #steps=1248
start validation
acc: 0.723005
AUC: 0.895737
Avg Precision: 0.462495
Avg Recall: 1.000000
d_prime: 1.778557
train_loss: 0.044365
valid_loss: 1.330873
validation finished
normal learning rate scheduler step
Epoch-33 lr: 9.225494723915269e-06
Epoch-33 lr: 3.6901978895661075e-05
epoch 33 training time: 15.191
---------------
2023-09-24 22:47:10.531095
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00808	Per Sample Data Time 0.00234	Per Sample DNN Time 0.00574	Train Loss 0.0690	
start validation
acc: 0.723005
AUC: 0.895666
Avg Precision: 0.462759
Avg Recall: 1.000000
d_prime: 1.778000
train_loss: 0.065576
valid_loss: 1.330472
validation finished
normal learning rate scheduler step
Epoch-34 lr: 6.997478945116364e-06
Epoch-34 lr: 2.7989915780465457e-05
epoch 34 training time: 15.167
---------------
2023-09-24 22:47:25.698040
current #epochs=35, #steps=1326
start validation
acc: 0.723005
AUC: 0.896307
Avg Precision: 0.462871
Avg Recall: 1.000000
d_prime: 1.783020
train_loss: 0.045252
valid_loss: 1.330152
validation finished
normal learning rate scheduler step
Epoch-35 lr: 6.997478945116364e-06
Epoch-35 lr: 2.7989915780465457e-05
epoch 35 training time: 15.309
---------------
2023-09-24 22:47:41.006971
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00652	Per Sample Data Time 0.00095	Per Sample DNN Time 0.00557	Train Loss 0.0396	
start validation
acc: 0.723005
AUC: 0.896769
Avg Precision: 0.463134
Avg Recall: 1.000000
d_prime: 1.786656
train_loss: 0.038584
valid_loss: 1.329700
validation finished
normal learning rate scheduler step
Epoch-36 lr: 5.307543178190271e-06
Epoch-36 lr: 2.1230172712761083e-05
epoch 36 training time: 15.199
---------------
2023-09-24 22:47:56.206291
current #epochs=37, #steps=1404
start validation
acc: 0.723005
AUC: 0.896604
Avg Precision: 0.463134
Avg Recall: 1.000000
d_prime: 1.785357
train_loss: 0.047294
valid_loss: 1.329785
validation finished
normal learning rate scheduler step
Epoch-37 lr: 5.307543178190271e-06
Epoch-37 lr: 2.1230172712761083e-05
epoch 37 training time: 15.139
---------------
2023-09-24 22:48:11.345483
current #epochs=38, #steps=1443
start validation
acc: 0.723005
AUC: 0.896428
Avg Precision: 0.463134
Avg Recall: 1.000000
d_prime: 1.783970
train_loss: 0.042295
valid_loss: 1.329657
validation finished
normal learning rate scheduler step
Epoch-38 lr: 4.025737670566957e-06
Epoch-38 lr: 1.610295068226783e-05
epoch 38 training time: 15.238
---------------
2023-09-24 22:48:26.583078
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00746	Per Sample Data Time 0.00173	Per Sample DNN Time 0.00573	Train Loss 0.0596	
start validation
acc: 0.723005
AUC: 0.896593
Avg Precision: 0.463134
Avg Recall: 1.000000
d_prime: 1.785264
train_loss: 0.064255
valid_loss: 1.329786
validation finished
normal learning rate scheduler step
Epoch-39 lr: 4.025737670566957e-06
Epoch-39 lr: 1.610295068226783e-05
epoch 39 training time: 15.205
---------------
2023-09-24 22:48:41.788556
current #epochs=40, #steps=1521
start validation
acc: 0.723005
AUC: 0.896381
Avg Precision: 0.463134
Avg Recall: 1.000000
d_prime: 1.783601
train_loss: 0.041428
valid_loss: 1.329853
validation finished
normal learning rate scheduler step
Epoch-40 lr: 3.0534963632171285e-06
Epoch-40 lr: 1.2213985452868514e-05
epoch 40 training time: 15.223
---------------
2023-09-24 22:48:57.012494
current #epochs=41, #steps=1560
start validation
acc: 0.723005
AUC: 0.896474
Avg Precision: 0.463134
Avg Recall: 1.000000
d_prime: 1.784333
train_loss: 0.044510
valid_loss: 1.329861
validation finished
normal learning rate scheduler step
Epoch-41 lr: 3.0534963632171285e-06
Epoch-41 lr: 1.2213985452868514e-05
epoch 41 training time: 15.296
---------------
2023-09-24 22:49:12.308508
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02191	Per Sample Data Time 0.01500	Per Sample DNN Time 0.00691	Train Loss 0.0507	
start validation
acc: 0.723005
AUC: 0.896388
Avg Precision: 0.463134
Avg Recall: 1.000000
d_prime: 1.783659
train_loss: 0.034357
valid_loss: 1.329949
validation finished
normal learning rate scheduler step
Epoch-42 lr: 2.3160575286235986e-06
Epoch-42 lr: 9.264230114494394e-06
epoch 42 training time: 15.258
---------------
2023-09-24 22:49:27.566645
current #epochs=43, #steps=1638
start validation
acc: 0.723005
AUC: 0.896186
Avg Precision: 0.462977
Avg Recall: 1.000000
d_prime: 1.782070
train_loss: 0.039752
valid_loss: 1.329879
validation finished
normal learning rate scheduler step
Epoch-43 lr: 2.3160575286235986e-06
Epoch-43 lr: 9.264230114494394e-06
epoch 43 training time: 16.066
---------------
2023-09-24 22:49:43.632852
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00703	Per Sample Data Time 0.00138	Per Sample DNN Time 0.00565	Train Loss 0.0374	
start validation
[I 2023-09-24 22:49:58,775] Trial 80 finished with value: 0.46313435440732703 and parameters: {'warmup': 'True', 'num_epochs': 44, 'batch_size': 58, 'lr-adaptschedule': 'True', 'lr': 0.00044224462872534295, 'head-lr': 4, 'lr-scheduler-start': 6, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.7584936260357708}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.723005
AUC: 0.896294
Avg Precision: 0.463134
Avg Recall: 1.000000
d_prime: 1.782918
train_loss: 0.035210
valid_loss: 1.330057
validation finished
normal learning rate scheduler step
Epoch-44 lr: 1.7567148729931593e-06
Epoch-44 lr: 7.026859491972637e-06
epoch 44 training time: 15.128
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa6015c4bb0>
The learning rate scheduler starts at 5 epoch with decay rate of 0.733 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 22:49:58.813001
current #epochs=1, #steps=0
start validation
acc: 0.727700
AUC: 0.895861
Avg Precision: 0.463272
Avg Recall: 1.000000
d_prime: 1.779527
train_loss: 0.059758
valid_loss: 1.329935
validation finished
normal learning rate scheduler step
Epoch-1 lr: 2.5868924765803665e-05
Epoch-1 lr: 2.5868924765803665e-05
epoch 1 training time: 18.098
---------------
2023-09-24 22:50:16.910914
current #epochs=2, #steps=39
start validation
acc: 0.732394
AUC: 0.895847
Avg Precision: 0.463750
Avg Recall: 1.000000
d_prime: 1.779414
train_loss: 0.057937
valid_loss: 1.331312
validation finished
normal learning rate scheduler step
Epoch-2 lr: 2.5868924765803665e-05
Epoch-2 lr: 2.5868924765803665e-05
epoch 2 training time: 17.772
---------------
2023-09-24 22:50:34.683236
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00726	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00568	Train Loss 0.0383	
start validation
acc: 0.727700
AUC: 0.896608
Avg Precision: 0.464608
Avg Recall: 1.000000
d_prime: 1.785385
train_loss: 0.042296
valid_loss: 1.332737
validation finished
normal learning rate scheduler step
Epoch-3 lr: 2.5868924765803665e-05
Epoch-3 lr: 2.5868924765803665e-05
epoch 3 training time: 15.447
---------------
2023-09-24 22:50:50.130507
current #epochs=4, #steps=117
start validation
acc: 0.727700
AUC: 0.897339
Avg Precision: 0.465121
Avg Recall: 1.000000
d_prime: 1.791152
train_loss: 0.037979
valid_loss: 1.331485
validation finished
normal learning rate scheduler step
Epoch-4 lr: 2.5868924765803665e-05
Epoch-4 lr: 2.5868924765803665e-05
epoch 4 training time: 15.115
---------------
2023-09-24 22:51:05.245349
current #epochs=5, #steps=156
start validation
acc: 0.718310
AUC: 0.897847
Avg Precision: 0.459901
Avg Recall: 1.000000
d_prime: 1.795171
train_loss: 0.052834
valid_loss: 1.331643
validation finished
normal learning rate scheduler step
Epoch-5 lr: 1.895568235852716e-05
Epoch-5 lr: 1.895568235852716e-05
epoch 5 training time: 15.900
---------------
2023-09-24 22:51:21.145540
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01136	Per Sample Data Time 0.00513	Per Sample DNN Time 0.00623	Train Loss 0.0275	
start validation
acc: 0.718310
AUC: 0.897670
Avg Precision: 0.459189
Avg Recall: 1.000000
d_prime: 1.793772
train_loss: 0.031194
valid_loss: 1.331449
validation finished
normal learning rate scheduler step
Epoch-6 lr: 1.3889943124051407e-05
Epoch-6 lr: 1.3889943124051407e-05
epoch 6 training time: 15.973
---------------
2023-09-24 22:51:37.118303
current #epochs=7, #steps=234
start validation
acc: 0.713615
AUC: 0.897027
Avg Precision: 0.458881
Avg Recall: 1.000000
d_prime: 1.788683
train_loss: 0.033662
valid_loss: 1.330285
validation finished
normal learning rate scheduler step
Epoch-7 lr: 1.0177978103889978e-05
Epoch-7 lr: 1.0177978103889978e-05
epoch 7 training time: 15.318
---------------
2023-09-24 22:51:52.435861
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00678	Per Sample Data Time 0.00120	Per Sample DNN Time 0.00558	Train Loss 0.0376	
start validation
acc: 0.713615
AUC: 0.897172
Avg Precision: 0.458718
Avg Recall: 1.000000
d_prime: 1.789829
train_loss: 0.037303
valid_loss: 1.329232
validation finished
normal learning rate scheduler step
Epoch-8 lr: 7.458003057182312e-06
Epoch-8 lr: 7.458003057182312e-06
epoch 8 training time: 15.248
---------------
2023-09-24 22:52:07.683470
current #epochs=9, #steps=312
start validation
acc: 0.718310
AUC: 0.897056
Avg Precision: 0.458386
Avg Recall: 1.000000
d_prime: 1.788912
train_loss: 0.042736
valid_loss: 1.328671
validation finished
normal learning rate scheduler step
Epoch-9 lr: 5.464917396479985e-06
Epoch-9 lr: 5.464917396479985e-06
epoch 9 training time: 15.097
---------------
2023-09-24 22:52:22.780105
current #epochs=10, #steps=351
start validation
acc: 0.718310
AUC: 0.896965
Avg Precision: 0.458386
Avg Recall: 1.000000
d_prime: 1.788195
train_loss: 0.048936
valid_loss: 1.328878
validation finished
normal learning rate scheduler step
Epoch-10 lr: 4.004466332524261e-06
Epoch-10 lr: 4.004466332524261e-06
epoch 10 training time: 15.295
---------------
2023-09-24 22:52:38.074689
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00896	Per Sample Data Time 0.00304	Per Sample DNN Time 0.00592	Train Loss 0.0755	
start validation
acc: 0.718310
AUC: 0.896939
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.787989
train_loss: 0.046581
valid_loss: 1.329012
validation finished
normal learning rate scheduler step
Epoch-11 lr: 2.9343079583689793e-06
Epoch-11 lr: 2.9343079583689793e-06
epoch 11 training time: 15.326
---------------
2023-09-24 22:52:53.400386
current #epochs=12, #steps=429
start validation
acc: 0.718310
AUC: 0.896795
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.786856
train_loss: 0.042993
valid_loss: 1.329056
validation finished
normal learning rate scheduler step
Epoch-12 lr: 2.150139988596187e-06
Epoch-12 lr: 2.150139988596187e-06
epoch 12 training time: 15.235
---------------
2023-09-24 22:53:08.635859
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00663	Per Sample Data Time 0.00105	Per Sample DNN Time 0.00558	Train Loss 0.0429	
start validation
acc: 0.718310
AUC: 0.896769
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.786651
train_loss: 0.040384
valid_loss: 1.329130
validation finished
normal learning rate scheduler step
Epoch-13 lr: 1.5755340053435083e-06
Epoch-13 lr: 1.5755340053435083e-06
epoch 13 training time: 15.199
---------------
2023-09-24 22:53:23.834288
current #epochs=14, #steps=507
start validation
acc: 0.718310
AUC: 0.896789
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.786811
train_loss: 0.045878
valid_loss: 1.329215
validation finished
normal learning rate scheduler step
Epoch-14 lr: 1.1544864125867643e-06
Epoch-14 lr: 1.1544864125867643e-06
epoch 14 training time: 15.320
---------------
2023-09-24 22:53:39.154697
current #epochs=15, #steps=546
start validation
acc: 0.713615
AUC: 0.896661
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785800
train_loss: 0.041888
valid_loss: 1.329401
validation finished
normal learning rate scheduler step
Epoch-15 lr: 8.459600823130836e-07
Epoch-15 lr: 8.459600823130836e-07
epoch 15 training time: 15.185
---------------
2023-09-24 22:53:54.339148
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00784	Per Sample Data Time 0.00209	Per Sample DNN Time 0.00575	Train Loss 0.0508	
start validation
acc: 0.713615
AUC: 0.896676
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785918
train_loss: 0.052369
valid_loss: 1.329441
validation finished
normal learning rate scheduler step
Epoch-16 lr: 6.198846977017803e-07
Epoch-16 lr: 6.198846977017803e-07
epoch 16 training time: 15.151
---------------
2023-09-24 22:54:09.490039
current #epochs=17, #steps=624
start validation
acc: 0.713615
AUC: 0.896691
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.786035
train_loss: 0.043677
valid_loss: 1.329490
validation finished
normal learning rate scheduler step
Epoch-17 lr: 4.542259693792701e-07
Epoch-17 lr: 4.542259693792701e-07
epoch 17 training time: 15.436
---------------
2023-09-24 22:54:24.926737
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00657	Per Sample Data Time 0.00096	Per Sample DNN Time 0.00561	Train Loss 0.0382	
start validation
acc: 0.713615
AUC: 0.896676
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785918
train_loss: 0.038754
valid_loss: 1.329499
validation finished
normal learning rate scheduler step
Epoch-18 lr: 3.328380778287844e-07
Epoch-18 lr: 3.328380778287844e-07
epoch 18 training time: 16.018
---------------
2023-09-24 22:54:40.944103
current #epochs=19, #steps=702
start validation
acc: 0.713615
AUC: 0.896661
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785800
train_loss: 0.033436
valid_loss: 1.329517
validation finished
normal learning rate scheduler step
Epoch-19 lr: 2.438900316601223e-07
Epoch-19 lr: 2.438900316601223e-07
epoch 19 training time: 15.206
---------------
2023-09-24 22:54:56.150434
current #epochs=20, #steps=741
start validation
acc: 0.713615
AUC: 0.896661
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785800
train_loss: 0.040490
valid_loss: 1.329513
validation finished
normal learning rate scheduler step
Epoch-20 lr: 1.7871256777829923e-07
Epoch-20 lr: 1.7871256777829923e-07
epoch 20 training time: 15.789
---------------
2023-09-24 22:55:11.939097
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00729	Per Sample Data Time 0.00162	Per Sample DNN Time 0.00567	Train Loss 0.0632	
start validation
acc: 0.713615
AUC: 0.896661
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785800
train_loss: 0.051266
valid_loss: 1.329516
validation finished
normal learning rate scheduler step
Epoch-21 lr: 1.3095320733084027e-07
Epoch-21 lr: 1.3095320733084027e-07
epoch 21 training time: 15.264
---------------
2023-09-24 22:55:27.203530
current #epochs=22, #steps=819
start validation
acc: 0.713615
AUC: 0.896661
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785800
train_loss: 0.033227
valid_loss: 1.329514
validation finished
normal learning rate scheduler step
Epoch-22 lr: 9.59571155147175e-08
Epoch-22 lr: 9.59571155147175e-08
epoch 22 training time: 15.236
---------------
2023-09-24 22:55:42.439156
current #epochs=23, #steps=858
start validation
acc: 0.713615
AUC: 0.896661
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785800
train_loss: 0.046252
valid_loss: 1.329527
validation finished
normal learning rate scheduler step
Epoch-23 lr: 7.031342114929897e-08
Epoch-23 lr: 7.031342114929897e-08
epoch 23 training time: 15.146
---------------
2023-09-24 22:55:57.585028
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01444	Per Sample Data Time 0.00772	Per Sample DNN Time 0.00672	Train Loss 0.0640	
start validation
acc: 0.713615
AUC: 0.896661
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785800
train_loss: 0.053212
valid_loss: 1.329534
validation finished
normal learning rate scheduler step
Epoch-24 lr: 5.1522778349463804e-08
Epoch-24 lr: 5.1522778349463804e-08
epoch 24 training time: 15.219
---------------
2023-09-24 22:56:12.804324
current #epochs=25, #steps=936
start validation
acc: 0.713615
AUC: 0.896661
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785800
train_loss: 0.046209
valid_loss: 1.329538
validation finished
normal learning rate scheduler step
Epoch-25 lr: 3.7753769414965277e-08
Epoch-25 lr: 3.7753769414965277e-08
epoch 25 training time: 15.156
---------------
2023-09-24 22:56:27.960429
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00694	Per Sample Data Time 0.00133	Per Sample DNN Time 0.00561	Train Loss 0.0470	
start validation
acc: 0.713615
AUC: 0.896661
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785800
train_loss: 0.049639
valid_loss: 1.329539
validation finished
normal learning rate scheduler step
Epoch-26 lr: 2.766440690311106e-08
Epoch-26 lr: 2.766440690311106e-08
epoch 26 training time: 15.190
---------------
2023-09-24 22:56:43.150438
current #epochs=27, #steps=1014
start validation
acc: 0.713615
AUC: 0.896661
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785800
train_loss: 0.044788
valid_loss: 1.329539
validation finished
normal learning rate scheduler step
Epoch-27 lr: 2.0271337701117935e-08
Epoch-27 lr: 2.0271337701117935e-08
epoch 27 training time: 15.156
---------------
2023-09-24 22:56:58.306557
current #epochs=28, #steps=1053
start validation
acc: 0.713615
AUC: 0.896661
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785800
train_loss: 0.042279
valid_loss: 1.329539
validation finished
normal learning rate scheduler step
Epoch-28 lr: 1.4854001158671278e-08
Epoch-28 lr: 1.4854001158671278e-08
epoch 28 training time: 15.229
---------------
2023-09-24 22:57:13.536216
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00915	Per Sample Data Time 0.00339	Per Sample DNN Time 0.00576	Train Loss 0.0393	
start validation
acc: 0.713615
AUC: 0.896661
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785800
train_loss: 0.045190
valid_loss: 1.329540
validation finished
normal learning rate scheduler step
Epoch-29 lr: 1.088440011581671e-08
Epoch-29 lr: 1.088440011581671e-08
epoch 29 training time: 15.166
---------------
2023-09-24 22:57:28.702349
current #epochs=30, #steps=1131
start validation
acc: 0.713615
AUC: 0.896661
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785800
train_loss: 0.046224
valid_loss: 1.329539
validation finished
normal learning rate scheduler step
Epoch-30 lr: 7.975640005388838e-09
Epoch-30 lr: 7.975640005388838e-09
epoch 30 training time: 15.257
---------------
2023-09-24 22:57:43.959964
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00677	Per Sample Data Time 0.00112	Per Sample DNN Time 0.00565	Train Loss 0.0433	
start validation
acc: 0.713615
AUC: 0.896661
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785800
train_loss: 0.047922
valid_loss: 1.329539
validation finished
normal learning rate scheduler step
Epoch-31 lr: 5.84422042728129e-09
Epoch-31 lr: 5.84422042728129e-09
epoch 31 training time: 15.280
---------------
2023-09-24 22:57:59.240085
current #epochs=32, #steps=1209
start validation
acc: 0.713615
AUC: 0.896661
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785800
train_loss: 0.050420
valid_loss: 1.329539
validation finished
normal learning rate scheduler step
Epoch-32 lr: 4.2824039675279634e-09
Epoch-32 lr: 4.2824039675279634e-09
epoch 32 training time: 15.124
---------------
2023-09-24 22:58:14.364385
current #epochs=33, #steps=1248
start validation
acc: 0.713615
AUC: 0.896661
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785800
train_loss: 0.049291
valid_loss: 1.329539
validation finished
normal learning rate scheduler step
Epoch-33 lr: 3.137969207234449e-09
Epoch-33 lr: 3.137969207234449e-09
epoch 33 training time: 16.845
---------------
2023-09-24 22:58:31.209650
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00825	Per Sample Data Time 0.00247	Per Sample DNN Time 0.00577	Train Loss 0.0342	
start validation
acc: 0.713615
AUC: 0.896661
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785800
train_loss: 0.040232
valid_loss: 1.329539
validation finished
normal learning rate scheduler step
Epoch-34 lr: 2.299374561628695e-09
Epoch-34 lr: 2.299374561628695e-09
epoch 34 training time: 17.974
---------------
2023-09-24 22:58:49.184087
current #epochs=35, #steps=1326
start validation
acc: 0.713615
AUC: 0.896661
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785800
train_loss: 0.046668
valid_loss: 1.329539
validation finished
normal learning rate scheduler step
Epoch-35 lr: 1.6848869525156351e-09
Epoch-35 lr: 1.6848869525156351e-09
epoch 35 training time: 15.324
---------------
2023-09-24 22:59:04.507675
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00651	Per Sample Data Time 0.00096	Per Sample DNN Time 0.00555	Train Loss 0.0400	
start validation
acc: 0.713615
AUC: 0.896661
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785800
train_loss: 0.041228
valid_loss: 1.329539
validation finished
normal learning rate scheduler step
Epoch-36 lr: 1.2346157473128743e-09
Epoch-36 lr: 1.2346157473128743e-09
epoch 36 training time: 15.154
---------------
2023-09-24 22:59:19.661761
current #epochs=37, #steps=1404
start validation
acc: 0.713615
AUC: 0.896661
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785800
train_loss: 0.036550
valid_loss: 1.329539
validation finished
normal learning rate scheduler step
Epoch-37 lr: 9.046755577500873e-10
Epoch-37 lr: 9.046755577500873e-10
epoch 37 training time: 15.103
---------------
2023-09-24 22:59:34.765034
current #epochs=38, #steps=1443
start validation
acc: 0.713615
AUC: 0.896661
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785800
train_loss: 0.049068
valid_loss: 1.329539
validation finished
normal learning rate scheduler step
Epoch-38 lr: 6.629089792283561e-10
Epoch-38 lr: 6.629089792283561e-10
epoch 38 training time: 16.518
---------------
2023-09-24 22:59:51.282988
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00753	Per Sample Data Time 0.00181	Per Sample DNN Time 0.00572	Train Loss 0.0436	
start validation
acc: 0.713615
AUC: 0.896661
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785800
train_loss: 0.047304
valid_loss: 1.329539
validation finished
normal learning rate scheduler step
Epoch-39 lr: 4.857523904309757e-10
Epoch-39 lr: 4.857523904309757e-10
epoch 39 training time: 16.684
---------------
2023-09-24 23:00:07.966750
current #epochs=40, #steps=1521
start validation
acc: 0.713615
AUC: 0.896661
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785800
train_loss: 0.046977
valid_loss: 1.329539
validation finished
normal learning rate scheduler step
Epoch-40 lr: 3.559393403964228e-10
Epoch-40 lr: 3.559393403964228e-10
epoch 40 training time: 15.493
---------------
2023-09-24 23:00:23.460323
current #epochs=41, #steps=1560
start validation
[I 2023-09-24 23:00:38,696] Trial 81 finished with value: 0.4581197245752893 and parameters: {'warmup': 'True', 'num_epochs': 41, 'batch_size': 51, 'lr-adaptschedule': 'True', 'lr': 2.5868924765803665e-05, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7327588034731473}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.713615
AUC: 0.896661
Avg Precision: 0.458120
Avg Recall: 1.000000
d_prime: 1.785800
train_loss: 0.045291
valid_loss: 1.329539
validation finished
normal learning rate scheduler step
Epoch-41 lr: 2.6081768517790407e-10
Epoch-41 lr: 2.6081768517790407e-10
epoch 41 training time: 15.222
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f4e1820>
The learning rate scheduler starts at 4 epoch with decay rate of 0.768 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 23:00:38.734528
current #epochs=1, #steps=0
start validation
acc: 0.713615
AUC: 0.896992
Avg Precision: 0.464315
Avg Recall: 1.000000
d_prime: 1.788407
train_loss: 0.048842
valid_loss: 1.329567
validation finished
normal learning rate scheduler step
Epoch-1 lr: 1.4620621003457173e-05
Epoch-1 lr: 1.4620621003457173e-05
epoch 1 training time: 17.895
---------------
2023-09-24 23:00:56.629532
current #epochs=2, #steps=39
start validation
acc: 0.723005
AUC: 0.896952
Avg Precision: 0.464047
Avg Recall: 1.000000
d_prime: 1.788097
train_loss: 0.046316
valid_loss: 1.330549
validation finished
normal learning rate scheduler step
Epoch-2 lr: 1.4620621003457173e-05
Epoch-2 lr: 1.4620621003457173e-05
epoch 2 training time: 17.559
---------------
2023-09-24 23:01:14.189316
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00560	Train Loss 0.0421	
start validation
acc: 0.718310
AUC: 0.896946
Avg Precision: 0.469886
Avg Recall: 1.000000
d_prime: 1.788048
train_loss: 0.041486
valid_loss: 1.331242
validation finished
normal learning rate scheduler step
Epoch-3 lr: 1.4620621003457173e-05
Epoch-3 lr: 1.4620621003457173e-05
epoch 3 training time: 15.343
---------------
2023-09-24 23:01:29.531978
current #epochs=4, #steps=117
start validation
acc: 0.718310
AUC: 0.896866
Avg Precision: 0.468945
Avg Recall: 1.000000
d_prime: 1.787414
train_loss: 0.043821
valid_loss: 1.331558
validation finished
normal learning rate scheduler step
Epoch-4 lr: 1.1226546580537713e-05
Epoch-4 lr: 1.1226546580537713e-05
epoch 4 training time: 16.999
---------------
2023-09-24 23:01:46.531367
current #epochs=5, #steps=156
start validation
acc: 0.718310
AUC: 0.897187
Avg Precision: 0.468531
Avg Recall: 1.000000
d_prime: 1.789950
train_loss: 0.036837
valid_loss: 1.331766
validation finished
normal learning rate scheduler step
Epoch-5 lr: 8.620382683825869e-06
Epoch-5 lr: 8.620382683825869e-06
epoch 5 training time: 15.681
---------------
2023-09-24 23:02:02.212585
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01116	Per Sample Data Time 0.00534	Per Sample DNN Time 0.00582	Train Loss 0.0366	
start validation
acc: 0.718310
AUC: 0.897411
Avg Precision: 0.468312
Avg Recall: 1.000000
d_prime: 1.791717
train_loss: 0.032180
valid_loss: 1.331598
validation finished
normal learning rate scheduler step
Epoch-6 lr: 6.619221421521564e-06
Epoch-6 lr: 6.619221421521564e-06
epoch 6 training time: 17.448
---------------
2023-09-24 23:02:19.660458
current #epochs=7, #steps=234
start validation
acc: 0.713615
AUC: 0.897185
Avg Precision: 0.468882
Avg Recall: 1.000000
d_prime: 1.789930
train_loss: 0.046142
valid_loss: 1.331656
validation finished
normal learning rate scheduler step
Epoch-7 lr: 5.082615683563195e-06
Epoch-7 lr: 5.082615683563195e-06
epoch 7 training time: 15.269
---------------
2023-09-24 23:02:34.929001
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00691	Per Sample Data Time 0.00126	Per Sample DNN Time 0.00565	Train Loss 0.0435	
start validation
acc: 0.718310
AUC: 0.896986
Avg Precision: 0.468468
Avg Recall: 1.000000
d_prime: 1.788362
train_loss: 0.047053
valid_loss: 1.331712
validation finished
normal learning rate scheduler step
Epoch-8 lr: 3.902722169530375e-06
Epoch-8 lr: 3.902722169530375e-06
epoch 8 training time: 15.233
---------------
2023-09-24 23:02:50.162044
current #epochs=9, #steps=312
start validation
acc: 0.723005
AUC: 0.896903
Avg Precision: 0.468204
Avg Recall: 1.000000
d_prime: 1.787708
train_loss: 0.042651
valid_loss: 1.331559
validation finished
normal learning rate scheduler step
Epoch-9 lr: 2.996732643351451e-06
Epoch-9 lr: 2.996732643351451e-06
epoch 9 training time: 15.234
---------------
2023-09-24 23:03:05.395952
current #epochs=10, #steps=351
start validation
acc: 0.723005
AUC: 0.896751
Avg Precision: 0.475661
Avg Recall: 1.000000
d_prime: 1.786513
train_loss: 0.054434
valid_loss: 1.331259
validation finished
normal learning rate scheduler step
Epoch-10 lr: 2.3010622190430764e-06
Epoch-10 lr: 2.3010622190430764e-06
epoch 10 training time: 15.319
---------------
2023-09-24 23:03:20.714612
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00860	Per Sample Data Time 0.00286	Per Sample DNN Time 0.00574	Train Loss 0.0547	
start validation
acc: 0.723005
AUC: 0.896705
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.786150
train_loss: 0.040900
valid_loss: 1.331229
validation finished
normal learning rate scheduler step
Epoch-11 lr: 1.7668867950748561e-06
Epoch-11 lr: 1.7668867950748561e-06
epoch 11 training time: 16.675
---------------
2023-09-24 23:03:37.389062
current #epochs=12, #steps=429
start validation
acc: 0.723005
AUC: 0.896727
Avg Precision: 0.475661
Avg Recall: 1.000000
d_prime: 1.786324
train_loss: 0.043438
valid_loss: 1.331279
validation finished
normal learning rate scheduler step
Epoch-12 lr: 1.356716441986593e-06
Epoch-12 lr: 1.356716441986593e-06
epoch 12 training time: 15.301
---------------
2023-09-24 23:03:52.689844
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00663	Per Sample Data Time 0.00104	Per Sample DNN Time 0.00559	Train Loss 0.0391	
start validation
acc: 0.723005
AUC: 0.896756
Avg Precision: 0.475661
Avg Recall: 1.000000
d_prime: 1.786553
train_loss: 0.040260
valid_loss: 1.331274
validation finished
normal learning rate scheduler step
Epoch-13 lr: 1.0417642539904644e-06
Epoch-13 lr: 1.0417642539904644e-06
epoch 13 training time: 16.367
---------------
2023-09-24 23:04:09.056925
current #epochs=14, #steps=507
start validation
acc: 0.723005
AUC: 0.896742
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.786442
train_loss: 0.043078
valid_loss: 1.331275
validation finished
normal learning rate scheduler step
Epoch-14 lr: 7.999260031839679e-07
Epoch-14 lr: 7.999260031839679e-07
epoch 14 training time: 15.345
---------------
2023-09-24 23:04:24.401841
current #epochs=15, #steps=546
start validation
acc: 0.723005
AUC: 0.896660
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785795
train_loss: 0.044766
valid_loss: 1.331273
validation finished
normal learning rate scheduler step
Epoch-15 lr: 6.142288028398164e-07
Epoch-15 lr: 6.142288028398164e-07
epoch 15 training time: 16.064
---------------
2023-09-24 23:04:40.465738
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00780	Per Sample Data Time 0.00202	Per Sample DNN Time 0.00579	Train Loss 0.0470	
start validation
acc: 0.723005
AUC: 0.896637
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785611
train_loss: 0.047933
valid_loss: 1.331234
validation finished
normal learning rate scheduler step
Epoch-16 lr: 4.7163990261142625e-07
Epoch-16 lr: 4.7163990261142625e-07
epoch 16 training time: 15.207
---------------
2023-09-24 23:04:55.673060
current #epochs=17, #steps=624
start validation
acc: 0.723005
AUC: 0.896629
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785552
train_loss: 0.049819
valid_loss: 1.331256
validation finished
normal learning rate scheduler step
Epoch-17 lr: 3.621520135605338e-07
Epoch-17 lr: 3.621520135605338e-07
epoch 17 training time: 15.272
---------------
2023-09-24 23:05:10.945509
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00652	Per Sample Data Time 0.00091	Per Sample DNN Time 0.00560	Train Loss 0.0481	
start validation
acc: 0.723005
AUC: 0.896643
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785663
train_loss: 0.047112
valid_loss: 1.331264
validation finished
normal learning rate scheduler step
Epoch-18 lr: 2.780809685519845e-07
Epoch-18 lr: 2.780809685519845e-07
epoch 18 training time: 15.312
---------------
2023-09-24 23:05:26.257591
current #epochs=19, #steps=702
start validation
acc: 0.723005
AUC: 0.896658
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785781
train_loss: 0.031723
valid_loss: 1.331274
validation finished
normal learning rate scheduler step
Epoch-19 lr: 2.1352642585234234e-07
Epoch-19 lr: 2.1352642585234234e-07
epoch 19 training time: 15.314
---------------
2023-09-24 23:05:41.571080
current #epochs=20, #steps=741
start validation
acc: 0.723005
AUC: 0.896658
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785781
train_loss: 0.054917
valid_loss: 1.331264
validation finished
normal learning rate scheduler step
Epoch-20 lr: 1.6395776659830134e-07
Epoch-20 lr: 1.6395776659830134e-07
epoch 20 training time: 15.418
---------------
2023-09-24 23:05:56.989290
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00730	Per Sample Data Time 0.00159	Per Sample DNN Time 0.00572	Train Loss 0.0558	
start validation
acc: 0.723005
AUC: 0.896651
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785722
train_loss: 0.052805
valid_loss: 1.331265
validation finished
normal learning rate scheduler step
Epoch-21 lr: 1.2589612325779567e-07
Epoch-21 lr: 1.2589612325779567e-07
epoch 21 training time: 15.233
---------------
2023-09-24 23:06:12.222480
current #epochs=22, #steps=819
start validation
acc: 0.723005
AUC: 0.896651
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785722
train_loss: 0.037544
valid_loss: 1.331264
validation finished
normal learning rate scheduler step
Epoch-22 lr: 9.667022294939146e-08
Epoch-22 lr: 9.667022294939146e-08
epoch 22 training time: 15.255
---------------
2023-09-24 23:06:27.477229
current #epochs=23, #steps=858
start validation
acc: 0.723005
AUC: 0.896666
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785839
train_loss: 0.038891
valid_loss: 1.331262
validation finished
normal learning rate scheduler step
Epoch-23 lr: 7.422891001932728e-08
Epoch-23 lr: 7.422891001932728e-08
epoch 23 training time: 15.194
---------------
2023-09-24 23:06:42.670754
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01371	Per Sample Data Time 0.00776	Per Sample DNN Time 0.00595	Train Loss 0.0394	
start validation
acc: 0.723005
AUC: 0.896651
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785722
train_loss: 0.044429
valid_loss: 1.331263
validation finished
normal learning rate scheduler step
Epoch-24 lr: 5.699719018484038e-08
Epoch-24 lr: 5.699719018484038e-08
epoch 24 training time: 15.288
---------------
2023-09-24 23:06:57.959002
current #epochs=25, #steps=936
start validation
acc: 0.723005
AUC: 0.896658
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785781
train_loss: 0.042849
valid_loss: 1.331272
validation finished
normal learning rate scheduler step
Epoch-25 lr: 4.376569301800326e-08
Epoch-25 lr: 4.376569301800326e-08
epoch 25 training time: 15.258
---------------
2023-09-24 23:07:13.217370
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00690	Per Sample Data Time 0.00134	Per Sample DNN Time 0.00556	Train Loss 0.0404	
start validation
acc: 0.723005
AUC: 0.896658
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785781
train_loss: 0.044628
valid_loss: 1.331273
validation finished
normal learning rate scheduler step
Epoch-26 lr: 3.360579493716079e-08
Epoch-26 lr: 3.360579493716079e-08
epoch 26 training time: 15.251
---------------
2023-09-24 23:07:28.467761
current #epochs=27, #steps=1014
start validation
acc: 0.723005
AUC: 0.896666
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785839
train_loss: 0.027592
valid_loss: 1.331274
validation finished
normal learning rate scheduler step
Epoch-27 lr: 2.5804445799451586e-08
Epoch-27 lr: 2.5804445799451586e-08
epoch 27 training time: 16.579
---------------
2023-09-24 23:07:45.046891
current #epochs=28, #steps=1053
start validation
acc: 0.723005
AUC: 0.896666
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785839
train_loss: 0.051155
valid_loss: 1.331275
validation finished
normal learning rate scheduler step
Epoch-28 lr: 1.9814125041884546e-08
Epoch-28 lr: 1.9814125041884546e-08
epoch 28 training time: 15.348
---------------
2023-09-24 23:08:00.394299
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00945	Per Sample Data Time 0.00356	Per Sample DNN Time 0.00589	Train Loss 0.0555	
start validation
acc: 0.723005
AUC: 0.896666
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785839
train_loss: 0.044199
valid_loss: 1.331274
validation finished
normal learning rate scheduler step
Epoch-29 lr: 1.521441515259282e-08
Epoch-29 lr: 1.521441515259282e-08
epoch 29 training time: 16.496
---------------
2023-09-24 23:08:16.890030
current #epochs=30, #steps=1131
start validation
acc: 0.723005
AUC: 0.896666
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785839
train_loss: 0.042107
valid_loss: 1.331274
validation finished
normal learning rate scheduler step
Epoch-30 lr: 1.168249559070259e-08
Epoch-30 lr: 1.168249559070259e-08
epoch 30 training time: 16.169
---------------
2023-09-24 23:08:33.058809
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00668	Per Sample Data Time 0.00112	Per Sample DNN Time 0.00556	Train Loss 0.0525	
start validation
acc: 0.723005
AUC: 0.896666
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785839
train_loss: 0.048869
valid_loss: 1.331274
validation finished
normal learning rate scheduler step
Epoch-31 lr: 8.970486335357201e-09
Epoch-31 lr: 8.970486335357201e-09
epoch 31 training time: 16.340
---------------
2023-09-24 23:08:49.398225
current #epochs=32, #steps=1209
start validation
acc: 0.723005
AUC: 0.896666
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785839
train_loss: 0.049241
valid_loss: 1.331274
validation finished
normal learning rate scheduler step
Epoch-32 lr: 6.888050970622348e-09
Epoch-32 lr: 6.888050970622348e-09
epoch 32 training time: 15.264
---------------
2023-09-24 23:09:04.662497
current #epochs=33, #steps=1248
start validation
acc: 0.723005
AUC: 0.896666
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785839
train_loss: 0.041860
valid_loss: 1.331274
validation finished
normal learning rate scheduler step
Epoch-33 lr: 5.289038341977723e-09
Epoch-33 lr: 5.289038341977723e-09
epoch 33 training time: 15.951
---------------
2023-09-24 23:09:20.613970
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00802	Per Sample Data Time 0.00229	Per Sample DNN Time 0.00573	Train Loss 0.0299	
start validation
acc: 0.723005
AUC: 0.896666
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785839
train_loss: 0.026119
valid_loss: 1.331274
validation finished
normal learning rate scheduler step
Epoch-34 lr: 4.061225258381467e-09
Epoch-34 lr: 4.061225258381467e-09
epoch 34 training time: 15.142
---------------
2023-09-24 23:09:35.756162
current #epochs=35, #steps=1326
start validation
acc: 0.723005
AUC: 0.896666
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785839
train_loss: 0.046782
valid_loss: 1.331274
validation finished
normal learning rate scheduler step
Epoch-35 lr: 3.1184403539695653e-09
Epoch-35 lr: 3.1184403539695653e-09
epoch 35 training time: 15.307
---------------
2023-09-24 23:09:51.063259
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00656	Per Sample Data Time 0.00097	Per Sample DNN Time 0.00559	Train Loss 0.0352	
start validation
acc: 0.723005
AUC: 0.896666
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785839
train_loss: 0.033230
valid_loss: 1.331274
validation finished
normal learning rate scheduler step
Epoch-36 lr: 2.3945163399139872e-09
Epoch-36 lr: 2.3945163399139872e-09
epoch 36 training time: 16.421
---------------
2023-09-24 23:10:07.484612
current #epochs=37, #steps=1404
start validation
acc: 0.723005
AUC: 0.896666
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785839
train_loss: 0.042485
valid_loss: 1.331274
validation finished
normal learning rate scheduler step
Epoch-37 lr: 1.8386461985128083e-09
Epoch-37 lr: 1.8386461985128083e-09
epoch 37 training time: 15.233
---------------
2023-09-24 23:10:22.716974
current #epochs=38, #steps=1443
start validation
acc: 0.723005
AUC: 0.896666
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785839
train_loss: 0.041404
valid_loss: 1.331274
validation finished
normal learning rate scheduler step
Epoch-38 lr: 1.411817404189038e-09
Epoch-38 lr: 1.411817404189038e-09
epoch 38 training time: 15.217
---------------
2023-09-24 23:10:37.934714
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00743	Per Sample Data Time 0.00176	Per Sample DNN Time 0.00566	Train Loss 0.0597	
start validation
acc: 0.723005
AUC: 0.896666
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785839
train_loss: 0.055805
valid_loss: 1.331274
validation finished
normal learning rate scheduler step
Epoch-39 lr: 1.0840739150268818e-09
Epoch-39 lr: 1.0840739150268818e-09
epoch 39 training time: 15.220
---------------
2023-09-24 23:10:53.154897
current #epochs=40, #steps=1521
start validation
acc: 0.723005
AUC: 0.896666
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785839
train_loss: 0.050642
valid_loss: 1.331274
validation finished
normal learning rate scheduler step
Epoch-40 lr: 8.324137737321399e-10
Epoch-40 lr: 8.324137737321399e-10
epoch 40 training time: 15.478
---------------
2023-09-24 23:11:08.633148
current #epochs=41, #steps=1560
start validation
acc: 0.723005
AUC: 0.896666
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785839
train_loss: 0.048445
valid_loss: 1.331274
validation finished
normal learning rate scheduler step
Epoch-41 lr: 6.391747657555252e-10
Epoch-41 lr: 6.391747657555252e-10
epoch 41 training time: 15.265
---------------
2023-09-24 23:11:23.898357
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02329	Per Sample Data Time 0.01526	Per Sample DNN Time 0.00803	Train Loss 0.0102	
start validation
[I 2023-09-24 23:11:39,235] Trial 82 finished with value: 0.47550468848674265 and parameters: {'warmup': 'True', 'num_epochs': 42, 'batch_size': 55, 'lr-adaptschedule': 'True', 'lr': 1.4620621003457173e-05, 'head-lr': 1, 'lr-scheduler-start': 4, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7678570272687527}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.723005
AUC: 0.896666
Avg Precision: 0.475505
Avg Recall: 1.000000
d_prime: 1.785839
train_loss: 0.035990
valid_loss: 1.331274
validation finished
normal learning rate scheduler step
Epoch-42 lr: 4.907948355382389e-10
Epoch-42 lr: 4.907948355382389e-10
epoch 42 training time: 15.325
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa63cec72e0>
The learning rate scheduler starts at 5 epoch with decay rate of 0.755 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 23:11:39.274395
current #epochs=1, #steps=0
start validation
acc: 0.723005
AUC: 0.894729
Avg Precision: 0.457422
Avg Recall: 1.000000
d_prime: 1.770705
train_loss: 0.030117
valid_loss: 1.334211
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0001740527686665184
Epoch-1 lr: 0.0001740527686665184
epoch 1 training time: 17.802
---------------
2023-09-24 23:11:57.076259
current #epochs=2, #steps=39
start validation
acc: 0.704225
AUC: 0.893315
Avg Precision: 0.463183
Avg Recall: 1.000000
d_prime: 1.759781
train_loss: 0.040939
valid_loss: 1.325733
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0001740527686665184
Epoch-2 lr: 0.0001740527686665184
epoch 2 training time: 15.139
---------------
2023-09-24 23:12:12.215588
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00722	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00568	Train Loss 0.0470	
start validation
acc: 0.704225
AUC: 0.894944
Avg Precision: 0.452230
Avg Recall: 1.000000
d_prime: 1.772375
train_loss: 0.049641
valid_loss: 1.320686
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0001740527686665184
Epoch-3 lr: 0.0001740527686665184
epoch 3 training time: 15.240
---------------
2023-09-24 23:12:27.455975
current #epochs=4, #steps=117
start validation
acc: 0.708920
AUC: 0.898280
Avg Precision: 0.455466
Avg Recall: 1.000000
d_prime: 1.798616
train_loss: 0.030315
valid_loss: 1.328462
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0001740527686665184
Epoch-4 lr: 0.0001740527686665184
epoch 4 training time: 15.276
---------------
2023-09-24 23:12:42.732288
current #epochs=5, #steps=156
start validation
acc: 0.723005
AUC: 0.899958
Avg Precision: 0.456543
Avg Recall: 1.000000
d_prime: 1.812049
train_loss: 0.051365
valid_loss: 1.337314
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00013141203240290316
Epoch-5 lr: 0.00013141203240290316
epoch 5 training time: 15.160
---------------
2023-09-24 23:12:57.892564
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01124	Per Sample Data Time 0.00543	Per Sample DNN Time 0.00581	Train Loss 0.0395	
start validation
acc: 0.718310
AUC: 0.900713
Avg Precision: 0.459093
Avg Recall: 1.000000
d_prime: 1.818150
train_loss: 0.037190
valid_loss: 1.332767
validation finished
normal learning rate scheduler step
Epoch-6 lr: 9.921773949685891e-05
Epoch-6 lr: 9.921773949685891e-05
epoch 6 training time: 15.261
---------------
2023-09-24 23:13:13.153468
current #epochs=7, #steps=234
start validation
acc: 0.713615
AUC: 0.898772
Avg Precision: 0.459080
Avg Recall: 1.000000
d_prime: 1.802533
train_loss: 0.050313
valid_loss: 1.332485
validation finished
normal learning rate scheduler step
Epoch-7 lr: 7.491064289063594e-05
Epoch-7 lr: 7.491064289063594e-05
epoch 7 training time: 15.121
---------------
2023-09-24 23:13:28.274791
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00690	Per Sample Data Time 0.00121	Per Sample DNN Time 0.00570	Train Loss 0.0431	
start validation
acc: 0.718310
AUC: 0.897059
Avg Precision: 0.459148
Avg Recall: 1.000000
d_prime: 1.788934
train_loss: 0.051515
valid_loss: 1.333574
validation finished
normal learning rate scheduler step
Epoch-8 lr: 5.655847882390063e-05
Epoch-8 lr: 5.655847882390063e-05
epoch 8 training time: 15.767
---------------
2023-09-24 23:13:44.041498
current #epochs=9, #steps=312
start validation
acc: 0.723005
AUC: 0.897153
Avg Precision: 0.465529
Avg Recall: 1.000000
d_prime: 1.789678
train_loss: 0.053129
valid_loss: 1.335259
validation finished
normal learning rate scheduler step
Epoch-9 lr: 4.270236382223712e-05
Epoch-9 lr: 4.270236382223712e-05
epoch 9 training time: 15.861
---------------
2023-09-24 23:13:59.902821
current #epochs=10, #steps=351
start validation
acc: 0.718310
AUC: 0.897430
Avg Precision: 0.468087
Avg Recall: 1.000000
d_prime: 1.791873
train_loss: 0.048425
valid_loss: 1.335519
validation finished
normal learning rate scheduler step
Epoch-10 lr: 3.2240822488955086e-05
Epoch-10 lr: 3.2240822488955086e-05
epoch 10 training time: 15.205
---------------
2023-09-24 23:14:15.108204
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00873	Per Sample Data Time 0.00297	Per Sample DNN Time 0.00576	Train Loss 0.0462	
start validation
acc: 0.723005
AUC: 0.897777
Avg Precision: 0.468290
Avg Recall: 1.000000
d_prime: 1.794614
train_loss: 0.037053
valid_loss: 1.336605
validation finished
normal learning rate scheduler step
Epoch-11 lr: 2.4342227027324683e-05
Epoch-11 lr: 2.4342227027324683e-05
epoch 11 training time: 15.270
---------------
2023-09-24 23:14:30.378101
current #epochs=12, #steps=429
start validation
acc: 0.718310
AUC: 0.897444
Avg Precision: 0.475400
Avg Recall: 1.000000
d_prime: 1.791982
train_loss: 0.054209
valid_loss: 1.336940
validation finished
normal learning rate scheduler step
Epoch-12 lr: 1.837868797710751e-05
Epoch-12 lr: 1.837868797710751e-05
epoch 12 training time: 15.378
---------------
2023-09-24 23:14:45.756328
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00673	Per Sample Data Time 0.00115	Per Sample DNN Time 0.00558	Train Loss 0.0457	
start validation
acc: 0.723005
AUC: 0.897619
Avg Precision: 0.474746
Avg Recall: 1.000000
d_prime: 1.793363
train_loss: 0.041534
valid_loss: 1.337243
validation finished
normal learning rate scheduler step
Epoch-13 lr: 1.3876140888042617e-05
Epoch-13 lr: 1.3876140888042617e-05
epoch 13 training time: 15.696
---------------
2023-09-24 23:15:01.451962
current #epochs=14, #steps=507
start validation
acc: 0.718310
AUC: 0.897269
Avg Precision: 0.474746
Avg Recall: 1.000000
d_prime: 1.790597
train_loss: 0.053574
valid_loss: 1.336818
validation finished
normal learning rate scheduler step
Epoch-14 lr: 1.047666112970877e-05
Epoch-14 lr: 1.047666112970877e-05
epoch 14 training time: 15.382
---------------
2023-09-24 23:15:16.833946
current #epochs=15, #steps=546
start validation
acc: 0.718310
AUC: 0.897111
Avg Precision: 0.475401
Avg Recall: 1.000000
d_prime: 1.789349
train_loss: 0.037978
valid_loss: 1.335563
validation finished
normal learning rate scheduler step
Epoch-15 lr: 7.910011098354707e-06
Epoch-15 lr: 7.910011098354707e-06
epoch 15 training time: 15.357
---------------
2023-09-24 23:15:32.190476
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00780	Per Sample Data Time 0.00205	Per Sample DNN Time 0.00575	Train Loss 0.0474	
start validation
acc: 0.718310
AUC: 0.897153
Avg Precision: 0.475263
Avg Recall: 1.000000
d_prime: 1.789683
train_loss: 0.045977
valid_loss: 1.334804
validation finished
normal learning rate scheduler step
Epoch-16 lr: 5.972157999715116e-06
Epoch-16 lr: 5.972157999715116e-06
epoch 16 training time: 15.350
---------------
2023-09-24 23:15:47.540904
current #epochs=17, #steps=624
start validation
acc: 0.723005
AUC: 0.897426
Avg Precision: 0.475601
Avg Recall: 1.000000
d_prime: 1.791839
train_loss: 0.042433
valid_loss: 1.334423
validation finished
normal learning rate scheduler step
Epoch-17 lr: 4.5090545044848254e-06
Epoch-17 lr: 4.5090545044848254e-06
epoch 17 training time: 15.740
---------------
2023-09-24 23:16:03.281533
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00648	Per Sample Data Time 0.00093	Per Sample DNN Time 0.00554	Train Loss 0.0403	
start validation
acc: 0.723005
AUC: 0.897477
Avg Precision: 0.475601
Avg Recall: 1.000000
d_prime: 1.792242
train_loss: 0.045251
valid_loss: 1.334361
validation finished
normal learning rate scheduler step
Epoch-18 lr: 3.4043929389317485e-06
Epoch-18 lr: 3.4043929389317485e-06
epoch 18 training time: 15.169
---------------
2023-09-24 23:16:18.450409
current #epochs=19, #steps=702
start validation
acc: 0.723005
AUC: 0.897464
Avg Precision: 0.475601
Avg Recall: 1.000000
d_prime: 1.792141
train_loss: 0.045520
valid_loss: 1.334548
validation finished
normal learning rate scheduler step
Epoch-19 lr: 2.570359544583179e-06
Epoch-19 lr: 2.570359544583179e-06
epoch 19 training time: 15.284
---------------
2023-09-24 23:16:33.734459
current #epochs=20, #steps=741
start validation
acc: 0.723005
AUC: 0.897418
Avg Precision: 0.475332
Avg Recall: 1.000000
d_prime: 1.791775
train_loss: 0.046910
valid_loss: 1.334567
validation finished
normal learning rate scheduler step
Epoch-20 lr: 1.9406538278460163e-06
Epoch-20 lr: 1.9406538278460163e-06
epoch 20 training time: 15.294
---------------
2023-09-24 23:16:49.028264
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00724	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00566	Train Loss 0.0494	
start validation
acc: 0.723005
AUC: 0.897577
Avg Precision: 0.475400
Avg Recall: 1.000000
d_prime: 1.793036
train_loss: 0.056322
valid_loss: 1.334587
validation finished
normal learning rate scheduler step
Epoch-21 lr: 1.4652180810541544e-06
Epoch-21 lr: 1.4652180810541544e-06
epoch 21 training time: 15.124
---------------
2023-09-24 23:17:04.152645
current #epochs=22, #steps=819
start validation
acc: 0.723005
AUC: 0.897610
Avg Precision: 0.475400
Avg Recall: 1.000000
d_prime: 1.793297
train_loss: 0.046901
valid_loss: 1.334620
validation finished
normal learning rate scheduler step
Epoch-22 lr: 1.1062581044816636e-06
Epoch-22 lr: 1.1062581044816636e-06
epoch 22 training time: 15.299
---------------
2023-09-24 23:17:19.451988
current #epochs=23, #steps=858
start validation
acc: 0.723005
AUC: 0.897656
Avg Precision: 0.475400
Avg Recall: 1.000000
d_prime: 1.793662
train_loss: 0.037936
valid_loss: 1.334605
validation finished
normal learning rate scheduler step
Epoch-23 lr: 8.352388013468224e-07
Epoch-23 lr: 8.352388013468224e-07
epoch 23 training time: 15.207
---------------
2023-09-24 23:17:34.659263
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01449	Per Sample Data Time 0.00803	Per Sample DNN Time 0.00646	Train Loss 0.0422	
start validation
acc: 0.723005
AUC: 0.897682
Avg Precision: 0.475400
Avg Recall: 1.000000
d_prime: 1.793865
train_loss: 0.038327
valid_loss: 1.334558
validation finished
normal learning rate scheduler step
Epoch-24 lr: 6.306158142020101e-07
Epoch-24 lr: 6.306158142020101e-07
epoch 24 training time: 15.228
---------------
2023-09-24 23:17:49.888100
current #epochs=25, #steps=936
start validation
acc: 0.723005
AUC: 0.897690
Avg Precision: 0.475400
Avg Recall: 1.000000
d_prime: 1.793924
train_loss: 0.054149
valid_loss: 1.334556
validation finished
normal learning rate scheduler step
Epoch-25 lr: 4.761228818397938e-07
Epoch-25 lr: 4.761228818397938e-07
epoch 25 training time: 15.153
---------------
2023-09-24 23:18:05.040544
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00691	Per Sample Data Time 0.00129	Per Sample DNN Time 0.00562	Train Loss 0.0457	
start validation
acc: 0.723005
AUC: 0.897682
Avg Precision: 0.475400
Avg Recall: 1.000000
d_prime: 1.793865
train_loss: 0.053352
valid_loss: 1.334548
validation finished
normal learning rate scheduler step
Epoch-26 lr: 3.5947877218761264e-07
Epoch-26 lr: 3.5947877218761264e-07
epoch 26 training time: 15.166
---------------
2023-09-24 23:18:20.206832
current #epochs=27, #steps=1014
start validation
acc: 0.723005
AUC: 0.897647
Avg Precision: 0.475400
Avg Recall: 1.000000
d_prime: 1.793584
train_loss: 0.037819
valid_loss: 1.334550
validation finished
normal learning rate scheduler step
Epoch-27 lr: 2.714110003580866e-07
Epoch-27 lr: 2.714110003580866e-07
epoch 27 training time: 15.806
---------------
2023-09-24 23:18:36.012740
current #epochs=28, #steps=1053
start validation
acc: 0.723005
AUC: 0.897682
Avg Precision: 0.475400
Avg Recall: 1.000000
d_prime: 1.793865
train_loss: 0.052198
valid_loss: 1.334554
validation finished
normal learning rate scheduler step
Epoch-28 lr: 2.0491872348148543e-07
Epoch-28 lr: 2.0491872348148543e-07
epoch 28 training time: 15.217
---------------
2023-09-24 23:18:51.229249
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00944	Per Sample Data Time 0.00350	Per Sample DNN Time 0.00594	Train Loss 0.0342	
start validation
acc: 0.723005
AUC: 0.897625
Avg Precision: 0.475134
Avg Recall: 1.000000
d_prime: 1.793415
train_loss: 0.046137
valid_loss: 1.334545
validation finished
normal learning rate scheduler step
Epoch-29 lr: 1.547162170209744e-07
Epoch-29 lr: 1.547162170209744e-07
epoch 29 training time: 15.233
---------------
2023-09-24 23:19:06.461979
current #epochs=30, #steps=1131
start validation
acc: 0.723005
AUC: 0.897640
Avg Precision: 0.475134
Avg Recall: 1.000000
d_prime: 1.793533
train_loss: 0.048731
valid_loss: 1.334544
validation finished
normal learning rate scheduler step
Epoch-30 lr: 1.168126923816407e-07
Epoch-30 lr: 1.168126923816407e-07
epoch 30 training time: 15.217
---------------
2023-09-24 23:19:21.679437
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00674	Per Sample Data Time 0.00114	Per Sample DNN Time 0.00560	Train Loss 0.0466	
start validation
acc: 0.723005
AUC: 0.897640
Avg Precision: 0.475134
Avg Recall: 1.000000
d_prime: 1.793533
train_loss: 0.049822
valid_loss: 1.334544
validation finished
normal learning rate scheduler step
Epoch-31 lr: 8.819505391343675e-08
Epoch-31 lr: 8.819505391343675e-08
epoch 31 training time: 15.288
---------------
2023-09-24 23:19:36.967280
current #epochs=32, #steps=1209
start validation
acc: 0.723005
AUC: 0.897640
Avg Precision: 0.475134
Avg Recall: 1.000000
d_prime: 1.793533
train_loss: 0.044107
valid_loss: 1.334538
validation finished
normal learning rate scheduler step
Epoch-32 lr: 6.658837645297295e-08
Epoch-32 lr: 6.658837645297295e-08
epoch 32 training time: 15.180
---------------
2023-09-24 23:19:52.146559
current #epochs=33, #steps=1248
start validation
acc: 0.723005
AUC: 0.897640
Avg Precision: 0.475134
Avg Recall: 1.000000
d_prime: 1.793533
train_loss: 0.040576
valid_loss: 1.334537
validation finished
normal learning rate scheduler step
Epoch-33 lr: 5.027506285097138e-08
Epoch-33 lr: 5.027506285097138e-08
epoch 33 training time: 15.339
---------------
2023-09-24 23:20:07.485674
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00798	Per Sample Data Time 0.00236	Per Sample DNN Time 0.00561	Train Loss 0.0265	
start validation
acc: 0.723005
AUC: 0.897640
Avg Precision: 0.475134
Avg Recall: 1.000000
d_prime: 1.793533
train_loss: 0.048246
valid_loss: 1.334534
validation finished
normal learning rate scheduler step
Epoch-34 lr: 3.795830562792276e-08
Epoch-34 lr: 3.795830562792276e-08
epoch 34 training time: 15.222
---------------
2023-09-24 23:20:22.707167
current #epochs=35, #steps=1326
start validation
acc: 0.723005
AUC: 0.897640
Avg Precision: 0.475134
Avg Recall: 1.000000
d_prime: 1.793533
train_loss: 0.050547
valid_loss: 1.334531
validation finished
normal learning rate scheduler step
Epoch-35 lr: 2.8658998804512758e-08
Epoch-35 lr: 2.8658998804512758e-08
epoch 35 training time: 15.958
---------------
2023-09-24 23:20:38.665134
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00663	Per Sample Data Time 0.00099	Per Sample DNN Time 0.00564	Train Loss 0.0517	
start validation
acc: 0.723005
AUC: 0.897640
Avg Precision: 0.475134
Avg Recall: 1.000000
d_prime: 1.793533
train_loss: 0.051563
valid_loss: 1.334529
validation finished
normal learning rate scheduler step
Epoch-36 lr: 2.1637905035278334e-08
Epoch-36 lr: 2.1637905035278334e-08
epoch 36 training time: 15.249
---------------
2023-09-24 23:20:53.914233
current #epochs=37, #steps=1404
start validation
acc: 0.723005
AUC: 0.897640
Avg Precision: 0.475134
Avg Recall: 1.000000
d_prime: 1.793533
train_loss: 0.053016
valid_loss: 1.334529
validation finished
normal learning rate scheduler step
Epoch-37 lr: 1.633689081427363e-08
Epoch-37 lr: 1.633689081427363e-08
epoch 37 training time: 15.264
---------------
2023-09-24 23:21:09.178303
current #epochs=38, #steps=1443
start validation
[I 2023-09-24 23:21:26,656] Trial 83 finished with value: 0.47513383719161567 and parameters: {'warmup': 'True', 'num_epochs': 38, 'batch_size': 48, 'lr-adaptschedule': 'True', 'lr': 0.0001740527686665184, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7550125942247202}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.723005
AUC: 0.897640
Avg Precision: 0.475134
Avg Recall: 1.000000
d_prime: 1.793533
train_loss: 0.049664
valid_loss: 1.334529
validation finished
normal learning rate scheduler step
Epoch-38 lr: 1.2334558315250736e-08
Epoch-38 lr: 1.2334558315250736e-08
epoch 38 training time: 17.462
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f48a5b0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.738 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 23:21:26.695186
current #epochs=1, #steps=0
start validation
acc: 0.718310
AUC: 0.901304
Avg Precision: 0.464734
Avg Recall: 1.000000
d_prime: 1.822946
train_loss: 0.048439
valid_loss: 1.323854
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.00027350403964880815
Epoch-1 lr: 0.00027350403964880815
epoch 1 training time: 17.623
---------------
2023-09-24 23:21:44.318659
current #epochs=2, #steps=39
start validation
acc: 0.718310
AUC: 0.899859
Avg Precision: 0.467941
Avg Recall: 1.000000
d_prime: 1.811255
train_loss: 0.046631
valid_loss: 1.327017
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.00027350403964880815
Epoch-2 lr: 0.00027350403964880815
epoch 2 training time: 15.263
---------------
2023-09-24 23:21:59.581774
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00563	Train Loss 0.0420	
start validation
acc: 0.746479
AUC: 0.904553
Avg Precision: 0.478580
Avg Recall: 1.000000
d_prime: 1.849703
train_loss: 0.050715
valid_loss: 1.325694
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.00027350403964880815
Epoch-3 lr: 0.00027350403964880815
epoch 3 training time: 17.563
---------------
2023-09-24 23:22:17.144779
current #epochs=4, #steps=117
start validation
acc: 0.723005
AUC: 0.905333
Avg Precision: 0.469445
Avg Recall: 1.000000
d_prime: 1.856228
train_loss: 0.041121
valid_loss: 1.320973
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00027350403964880815
Epoch-4 lr: 0.00027350403964880815
epoch 4 training time: 15.223
---------------
2023-09-24 23:22:32.367537
current #epochs=5, #steps=156
start validation
acc: 0.708920
AUC: 0.902074
Avg Precision: 0.470254
Avg Recall: 1.000000
d_prime: 1.829230
train_loss: 0.046340
valid_loss: 1.315010
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00027350403964880815
Epoch-5 lr: 0.00027350403964880815
epoch 5 training time: 15.266
---------------
2023-09-24 23:22:47.633469
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01138	Per Sample Data Time 0.00543	Per Sample DNN Time 0.00595	Train Loss 0.0660	
start validation
acc: 0.723005
AUC: 0.898253
Avg Precision: 0.455171
Avg Recall: 1.000000
d_prime: 1.798402
train_loss: 0.047023
valid_loss: 1.333994
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00020194484194788635
Epoch-6 lr: 0.00020194484194788635
epoch 6 training time: 16.555
---------------
2023-09-24 23:23:04.188803
current #epochs=7, #steps=234
start validation
acc: 0.727700
AUC: 0.896577
Avg Precision: 0.456475
Avg Recall: 1.000000
d_prime: 1.785139
train_loss: 0.043483
valid_loss: 1.330481
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00020194484194788635
Epoch-7 lr: 0.00020194484194788635
epoch 7 training time: 15.197
---------------
2023-09-24 23:23:19.385338
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00690	Per Sample Data Time 0.00122	Per Sample DNN Time 0.00568	Train Loss 0.0580	
start validation
acc: 0.718310
AUC: 0.896843
Avg Precision: 0.464669
Avg Recall: 1.000000
d_prime: 1.787232
train_loss: 0.052159
valid_loss: 1.338842
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0001491082882787487
Epoch-8 lr: 0.0001491082882787487
epoch 8 training time: 15.302
---------------
2023-09-24 23:23:34.687238
current #epochs=9, #steps=312
start validation
acc: 0.723005
AUC: 0.898617
Avg Precision: 0.463778
Avg Recall: 1.000000
d_prime: 1.801298
train_loss: 0.030377
valid_loss: 1.334697
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0001491082882787487
Epoch-9 lr: 0.0001491082882787487
epoch 9 training time: 15.239
---------------
2023-09-24 23:23:49.926273
current #epochs=10, #steps=351
start validation
acc: 0.723005
AUC: 0.899788
Avg Precision: 0.463857
Avg Recall: 1.000000
d_prime: 1.810681
train_loss: 0.052816
valid_loss: 1.329514
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00011009581338629051
Epoch-10 lr: 0.00011009581338629051
epoch 10 training time: 15.209
---------------
2023-09-24 23:24:05.135253
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00863	Per Sample Data Time 0.00285	Per Sample DNN Time 0.00577	Train Loss 0.0575	
start validation
acc: 0.723005
AUC: 0.898962
Avg Precision: 0.463402
Avg Recall: 1.000000
d_prime: 1.804055
train_loss: 0.042863
valid_loss: 1.327965
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00011009581338629051
Epoch-11 lr: 0.00011009581338629051
epoch 11 training time: 15.196
---------------
2023-09-24 23:24:20.331172
current #epochs=12, #steps=429
start validation
acc: 0.727700
AUC: 0.898939
Avg Precision: 0.466165
Avg Recall: 1.000000
d_prime: 1.803868
train_loss: 0.053105
valid_loss: 1.333511
validation finished
normal learning rate scheduler step
Epoch-12 lr: 8.129050547833587e-05
Epoch-12 lr: 8.129050547833587e-05
epoch 12 training time: 15.259
---------------
2023-09-24 23:24:35.590038
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00661	Per Sample Data Time 0.00105	Per Sample DNN Time 0.00557	Train Loss 0.0407	
start validation
acc: 0.723005
AUC: 0.899460
Avg Precision: 0.464135
Avg Recall: 1.000000
d_prime: 1.808044
train_loss: 0.038021
valid_loss: 1.326805
validation finished
normal learning rate scheduler step
Epoch-13 lr: 8.129050547833587e-05
Epoch-13 lr: 8.129050547833587e-05
epoch 13 training time: 15.331
---------------
2023-09-24 23:24:50.921148
current #epochs=14, #steps=507
start validation
acc: 0.723005
AUC: 0.902492
Avg Precision: 0.467307
Avg Recall: 1.000000
d_prime: 1.832652
train_loss: 0.048866
valid_loss: 1.324098
validation finished
normal learning rate scheduler step
Epoch-14 lr: 6.002177628442156e-05
Epoch-14 lr: 6.002177628442156e-05
epoch 14 training time: 15.236
---------------
2023-09-24 23:25:06.157513
current #epochs=15, #steps=546
start validation
acc: 0.718310
AUC: 0.904068
Avg Precision: 0.468356
Avg Recall: 1.000000
d_prime: 1.845671
train_loss: 0.047712
valid_loss: 1.322749
validation finished
normal learning rate scheduler step
Epoch-15 lr: 6.002177628442156e-05
Epoch-15 lr: 6.002177628442156e-05
epoch 15 training time: 15.308
---------------
2023-09-24 23:25:21.465042
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00775	Per Sample Data Time 0.00205	Per Sample DNN Time 0.00570	Train Loss 0.0505	
start validation
acc: 0.723005
AUC: 0.904464
Avg Precision: 0.469552
Avg Recall: 1.000000
d_prime: 1.848965
train_loss: 0.046707
valid_loss: 1.320697
validation finished
normal learning rate scheduler step
Epoch-16 lr: 4.431776635092097e-05
Epoch-16 lr: 4.431776635092097e-05
epoch 16 training time: 16.397
---------------
2023-09-24 23:25:37.862041
current #epochs=17, #steps=624
start validation
acc: 0.718310
AUC: 0.904605
Avg Precision: 0.461801
Avg Recall: 1.000000
d_prime: 1.850142
train_loss: 0.048056
valid_loss: 1.321183
validation finished
normal learning rate scheduler step
Epoch-17 lr: 4.431776635092097e-05
Epoch-17 lr: 4.431776635092097e-05
epoch 17 training time: 15.268
---------------
2023-09-24 23:25:53.130430
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00649	Per Sample Data Time 0.00093	Per Sample DNN Time 0.00555	Train Loss 0.0565	
start validation
acc: 0.718310
AUC: 0.902988
Avg Precision: 0.467095
Avg Recall: 1.000000
d_prime: 1.836736
train_loss: 0.059624
valid_loss: 1.323005
validation finished
normal learning rate scheduler step
Epoch-18 lr: 3.272253065333872e-05
Epoch-18 lr: 3.272253065333872e-05
epoch 18 training time: 16.436
---------------
2023-09-24 23:26:09.566049
current #epochs=19, #steps=702
start validation
acc: 0.727700
AUC: 0.901402
Avg Precision: 0.464727
Avg Recall: 1.000000
d_prime: 1.823741
train_loss: 0.044690
valid_loss: 1.325839
validation finished
normal learning rate scheduler step
Epoch-19 lr: 3.272253065333872e-05
Epoch-19 lr: 3.272253065333872e-05
epoch 19 training time: 15.267
---------------
2023-09-24 23:26:24.832582
current #epochs=20, #steps=741
start validation
acc: 0.732394
AUC: 0.901734
Avg Precision: 0.464333
Avg Recall: 1.000000
d_prime: 1.826452
train_loss: 0.064849
valid_loss: 1.323881
validation finished
normal learning rate scheduler step
Epoch-20 lr: 2.4161055498151032e-05
Epoch-20 lr: 2.4161055498151032e-05
epoch 20 training time: 15.119
---------------
2023-09-24 23:26:39.952034
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00726	Per Sample Data Time 0.00163	Per Sample DNN Time 0.00564	Train Loss 0.0463	
start validation
acc: 0.732394
AUC: 0.901945
Avg Precision: 0.465021
Avg Recall: 1.000000
d_prime: 1.828178
train_loss: 0.041954
valid_loss: 1.324515
validation finished
normal learning rate scheduler step
Epoch-21 lr: 2.4161055498151032e-05
Epoch-21 lr: 2.4161055498151032e-05
epoch 21 training time: 15.171
---------------
2023-09-24 23:26:55.123023
current #epochs=22, #steps=819
start validation
acc: 0.741784
AUC: 0.902596
Avg Precision: 0.465005
Avg Recall: 1.000000
d_prime: 1.833510
train_loss: 0.042988
valid_loss: 1.323579
validation finished
normal learning rate scheduler step
Epoch-22 lr: 1.783959220541437e-05
Epoch-22 lr: 1.783959220541437e-05
epoch 22 training time: 15.404
---------------
2023-09-24 23:27:10.526597
current #epochs=23, #steps=858
start validation
acc: 0.737089
AUC: 0.903439
Avg Precision: 0.465861
Avg Recall: 1.000000
d_prime: 1.840454
train_loss: 0.038275
valid_loss: 1.322907
validation finished
normal learning rate scheduler step
Epoch-23 lr: 1.783959220541437e-05
Epoch-23 lr: 1.783959220541437e-05
epoch 23 training time: 15.208
---------------
2023-09-24 23:27:25.734419
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01469	Per Sample Data Time 0.00810	Per Sample DNN Time 0.00659	Train Loss 0.0466	
start validation
acc: 0.732394
AUC: 0.903311
Avg Precision: 0.465861
Avg Recall: 1.000000
d_prime: 1.839400
train_loss: 0.043218
valid_loss: 1.323774
validation finished
normal learning rate scheduler step
Epoch-24 lr: 1.3172067341173728e-05
Epoch-24 lr: 1.3172067341173728e-05
epoch 24 training time: 15.676
---------------
2023-09-24 23:27:41.410607
current #epochs=25, #steps=936
start validation
acc: 0.732394
AUC: 0.903253
Avg Precision: 0.465861
Avg Recall: 1.000000
d_prime: 1.838920
train_loss: 0.034564
valid_loss: 1.324069
validation finished
normal learning rate scheduler step
Epoch-25 lr: 1.3172067341173728e-05
Epoch-25 lr: 1.3172067341173728e-05
epoch 25 training time: 15.312
---------------
2023-09-24 23:27:56.722869
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00693	Per Sample Data Time 0.00131	Per Sample DNN Time 0.00562	Train Loss 0.0433	
start validation
acc: 0.718310
AUC: 0.904181
Avg Precision: 0.465505
Avg Recall: 1.000000
d_prime: 1.846609
train_loss: 0.039115
valid_loss: 1.323082
validation finished
normal learning rate scheduler step
Epoch-26 lr: 9.725746869244956e-06
Epoch-26 lr: 9.725746869244956e-06
epoch 26 training time: 15.136
---------------
2023-09-24 23:28:11.858509
current #epochs=27, #steps=1014
start validation
acc: 0.718310
AUC: 0.904181
Avg Precision: 0.465505
Avg Recall: 1.000000
d_prime: 1.846604
train_loss: 0.062844
valid_loss: 1.322706
validation finished
normal learning rate scheduler step
Epoch-27 lr: 9.725746869244956e-06
Epoch-27 lr: 9.725746869244956e-06
epoch 27 training time: 15.246
---------------
2023-09-24 23:28:27.104831
current #epochs=28, #steps=1053
start validation
acc: 0.718310
AUC: 0.904474
Avg Precision: 0.465623
Avg Recall: 1.000000
d_prime: 1.849045
train_loss: 0.042383
valid_loss: 1.322342
validation finished
normal learning rate scheduler step
Epoch-28 lr: 7.1811166550109205e-06
Epoch-28 lr: 7.1811166550109205e-06
epoch 28 training time: 15.230
---------------
2023-09-24 23:28:42.334793
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00949	Per Sample Data Time 0.00358	Per Sample DNN Time 0.00591	Train Loss 0.0583	
start validation
acc: 0.718310
AUC: 0.904446
Avg Precision: 0.465272
Avg Recall: 1.000000
d_prime: 1.848811
train_loss: 0.056678
valid_loss: 1.322189
validation finished
normal learning rate scheduler step
Epoch-29 lr: 7.1811166550109205e-06
Epoch-29 lr: 7.1811166550109205e-06
epoch 29 training time: 15.205
---------------
2023-09-24 23:28:57.540048
current #epochs=30, #steps=1131
start validation
acc: 0.718310
AUC: 0.904453
Avg Precision: 0.465662
Avg Recall: 1.000000
d_prime: 1.848871
train_loss: 0.047878
valid_loss: 1.322543
validation finished
normal learning rate scheduler step
Epoch-30 lr: 5.302259775642163e-06
Epoch-30 lr: 5.302259775642163e-06
epoch 30 training time: 15.261
---------------
2023-09-24 23:29:12.801128
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00675	Per Sample Data Time 0.00113	Per Sample DNN Time 0.00562	Train Loss 0.0370	
start validation
acc: 0.718310
AUC: 0.904420
Avg Precision: 0.465662
Avg Recall: 1.000000
d_prime: 1.848596
train_loss: 0.036119
valid_loss: 1.322493
validation finished
normal learning rate scheduler step
Epoch-31 lr: 5.302259775642163e-06
Epoch-31 lr: 5.302259775642163e-06
epoch 31 training time: 15.287
---------------
2023-09-24 23:29:28.088040
current #epochs=32, #steps=1209
start validation
acc: 0.718310
AUC: 0.904250
Avg Precision: 0.465272
Avg Recall: 1.000000
d_prime: 1.847182
train_loss: 0.039377
valid_loss: 1.322510
validation finished
normal learning rate scheduler step
Epoch-32 lr: 3.9149842676313025e-06
Epoch-32 lr: 3.9149842676313025e-06
epoch 32 training time: 15.369
---------------
2023-09-24 23:29:43.457347
current #epochs=33, #steps=1248
start validation
acc: 0.718310
AUC: 0.904151
Avg Precision: 0.466012
Avg Recall: 1.000000
d_prime: 1.846360
train_loss: 0.057315
valid_loss: 1.322548
validation finished
normal learning rate scheduler step
Epoch-33 lr: 3.9149842676313025e-06
Epoch-33 lr: 3.9149842676313025e-06
epoch 33 training time: 15.267
---------------
2023-09-24 23:29:58.724899
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00783	Per Sample Data Time 0.00225	Per Sample DNN Time 0.00559	Train Loss 0.0239	
start validation
acc: 0.718310
AUC: 0.903997
Avg Precision: 0.465544
Avg Recall: 1.000000
d_prime: 1.845079
train_loss: 0.035611
valid_loss: 1.322591
validation finished
normal learning rate scheduler step
Epoch-34 lr: 2.8906734985356923e-06
Epoch-34 lr: 2.8906734985356923e-06
epoch 34 training time: 15.136
---------------
2023-09-24 23:30:13.860732
current #epochs=35, #steps=1326
start validation
acc: 0.718310
AUC: 0.904008
Avg Precision: 0.465544
Avg Recall: 1.000000
d_prime: 1.845171
train_loss: 0.046003
valid_loss: 1.322491
validation finished
normal learning rate scheduler step
Epoch-35 lr: 2.8906734985356923e-06
Epoch-35 lr: 2.8906734985356923e-06
epoch 35 training time: 16.889
---------------
2023-09-24 23:30:30.749355
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00664	Per Sample Data Time 0.00098	Per Sample DNN Time 0.00567	Train Loss 0.0464	
start validation
acc: 0.718310
AUC: 0.904040
Avg Precision: 0.465662
Avg Recall: 1.000000
d_prime: 1.845436
train_loss: 0.047051
valid_loss: 1.322499
validation finished
normal learning rate scheduler step
Epoch-36 lr: 2.1343619038837766e-06
Epoch-36 lr: 2.1343619038837766e-06
epoch 36 training time: 15.295
---------------
2023-09-24 23:30:46.044731
current #epochs=37, #steps=1404
start validation
acc: 0.718310
AUC: 0.903981
Avg Precision: 0.465662
Avg Recall: 1.000000
d_prime: 1.844947
train_loss: 0.043581
valid_loss: 1.322668
validation finished
normal learning rate scheduler step
Epoch-37 lr: 2.1343619038837766e-06
Epoch-37 lr: 2.1343619038837766e-06
epoch 37 training time: 15.281
---------------
2023-09-24 23:31:01.325855
current #epochs=38, #steps=1443
start validation
acc: 0.718310
AUC: 0.904070
Avg Precision: 0.465662
Avg Recall: 1.000000
d_prime: 1.845682
train_loss: 0.037495
valid_loss: 1.322698
validation finished
normal learning rate scheduler step
Epoch-38 lr: 1.575930570871469e-06
Epoch-38 lr: 1.575930570871469e-06
epoch 38 training time: 15.247
---------------
2023-09-24 23:31:16.572607
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00747	Per Sample Data Time 0.00176	Per Sample DNN Time 0.00571	Train Loss 0.0425	
start validation
acc: 0.718310
AUC: 0.903903
Avg Precision: 0.465558
Avg Recall: 1.000000
d_prime: 1.844296
train_loss: 0.047922
valid_loss: 1.322639
validation finished
normal learning rate scheduler step
Epoch-39 lr: 1.575930570871469e-06
Epoch-39 lr: 1.575930570871469e-06
epoch 39 training time: 17.076
---------------
2023-09-24 23:31:33.648246
current #epochs=40, #steps=1521
start validation
acc: 0.718310
AUC: 0.903995
Avg Precision: 0.465677
Avg Recall: 1.000000
d_prime: 1.845062
train_loss: 0.042661
valid_loss: 1.322651
validation finished
normal learning rate scheduler step
Epoch-40 lr: 1.1636063966884371e-06
Epoch-40 lr: 1.1636063966884371e-06
epoch 40 training time: 17.423
---------------
2023-09-24 23:31:51.071489
current #epochs=41, #steps=1560
start validation
acc: 0.718310
AUC: 0.903964
Avg Precision: 0.465677
Avg Recall: 1.000000
d_prime: 1.844806
train_loss: 0.060742
valid_loss: 1.322664
validation finished
normal learning rate scheduler step
Epoch-41 lr: 1.1636063966884371e-06
Epoch-41 lr: 1.1636063966884371e-06
epoch 41 training time: 15.280
---------------
2023-09-24 23:32:06.351944
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02245	Per Sample Data Time 0.01561	Per Sample DNN Time 0.00684	Train Loss 0.0786	
start validation
acc: 0.718310
AUC: 0.903919
Avg Precision: 0.465677
Avg Recall: 1.000000
d_prime: 1.844434
train_loss: 0.036399
valid_loss: 1.322719
validation finished
normal learning rate scheduler step
Epoch-42 lr: 8.591621175706462e-07
Epoch-42 lr: 8.591621175706462e-07
epoch 42 training time: 15.218
---------------
2023-09-24 23:32:21.569552
current #epochs=43, #steps=1638
start validation
[I 2023-09-24 23:32:37,032] Trial 84 finished with value: 0.46567651740715205 and parameters: {'warmup': 'True', 'num_epochs': 43, 'batch_size': 53, 'lr-adaptschedule': 'True', 'lr': 0.00027350403964880815, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.7383614596961452}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.718310
AUC: 0.903929
Avg Precision: 0.465677
Avg Recall: 1.000000
d_prime: 1.844511
train_loss: 0.053427
valid_loss: 1.322685
validation finished
normal learning rate scheduler step
Epoch-43 lr: 8.591621175706462e-07
Epoch-43 lr: 8.591621175706462e-07
epoch 43 training time: 15.449
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f4df4f0>
The learning rate scheduler starts at 5 epoch with decay rate of 0.728 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 23:32:37.070303
current #epochs=1, #steps=0
start validation
acc: 0.723005
AUC: 0.896113
Avg Precision: 0.452257
Avg Recall: 1.000000
d_prime: 1.781496
train_loss: 0.037902
valid_loss: 1.337101
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0003615538059827084
Epoch-1 lr: 0.0003615538059827084
epoch 1 training time: 17.655
---------------
2023-09-24 23:32:54.725661
current #epochs=2, #steps=39
start validation
acc: 0.760563
AUC: 0.897705
Avg Precision: 0.457011
Avg Recall: 1.000000
d_prime: 1.794044
train_loss: 0.049601
valid_loss: 1.324762
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0003615538059827084
Epoch-2 lr: 0.0003615538059827084
epoch 2 training time: 19.996
---------------
2023-09-24 23:33:14.721701
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00560	Train Loss 0.0729	
start validation
acc: 0.723005
AUC: 0.897992
Avg Precision: 0.454219
Avg Recall: 1.000000
d_prime: 1.796322
train_loss: 0.072899
valid_loss: 1.333763
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0003615538059827084
Epoch-3 lr: 0.0003615538059827084
epoch 3 training time: 15.204
---------------
2023-09-24 23:33:29.925956
current #epochs=4, #steps=117
start validation
acc: 0.732394
AUC: 0.888722
Avg Precision: 0.418262
Avg Recall: 1.000000
d_prime: 1.724998
train_loss: 0.047857
valid_loss: 1.336608
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0003615538059827084
Epoch-4 lr: 0.0003615538059827084
epoch 4 training time: 15.176
---------------
2023-09-24 23:33:45.101737
current #epochs=5, #steps=156
start validation
acc: 0.737089
AUC: 0.893153
Avg Precision: 0.441501
Avg Recall: 1.000000
d_prime: 1.758534
train_loss: 0.049561
valid_loss: 1.339693
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0002633437327377013
Epoch-5 lr: 0.0002633437327377013
epoch 5 training time: 15.577
---------------
2023-09-24 23:34:00.679365
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01111	Per Sample Data Time 0.00514	Per Sample DNN Time 0.00597	Train Loss 0.0434	
start validation
acc: 0.732394
AUC: 0.899895
Avg Precision: 0.453468
Avg Recall: 1.000000
d_prime: 1.811540
train_loss: 0.047629
valid_loss: 1.329013
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0002633437327377013
Epoch-6 lr: 0.0002633437327377013
epoch 6 training time: 15.227
---------------
2023-09-24 23:34:15.906257
current #epochs=7, #steps=234
start validation
acc: 0.718310
AUC: 0.903100
Avg Precision: 0.467399
Avg Recall: 1.000000
d_prime: 1.837653
train_loss: 0.048913
valid_loss: 1.326253
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00019181079115937328
Epoch-7 lr: 0.00019181079115937328
epoch 7 training time: 16.671
---------------
2023-09-24 23:34:32.576863
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00684	Per Sample Data Time 0.00123	Per Sample DNN Time 0.00561	Train Loss 0.0520	
start validation
acc: 0.746479
AUC: 0.902543
Avg Precision: 0.466946
Avg Recall: 1.000000
d_prime: 1.833076
train_loss: 0.054100
valid_loss: 1.319520
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00019181079115937328
Epoch-8 lr: 0.00019181079115937328
epoch 8 training time: 15.123
---------------
2023-09-24 23:34:47.699763
current #epochs=9, #steps=312
start validation
acc: 0.737089
AUC: 0.900799
Avg Precision: 0.469728
Avg Recall: 1.000000
d_prime: 1.818842
train_loss: 0.053057
valid_loss: 1.327008
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00013970858247775388
Epoch-9 lr: 0.00013970858247775388
epoch 9 training time: 17.008
---------------
2023-09-24 23:35:04.707919
current #epochs=10, #steps=351
start validation
acc: 0.727700
AUC: 0.900441
Avg Precision: 0.467822
Avg Recall: 1.000000
d_prime: 1.815948
train_loss: 0.036407
valid_loss: 1.330289
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00013970858247775388
Epoch-10 lr: 0.00013970858247775388
epoch 10 training time: 15.206
---------------
2023-09-24 23:35:19.914214
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00863	Per Sample Data Time 0.00287	Per Sample DNN Time 0.00576	Train Loss 0.0483	
start validation
acc: 0.732394
AUC: 0.901908
Avg Precision: 0.470739
Avg Recall: 1.000000
d_prime: 1.827873
train_loss: 0.039645
valid_loss: 1.322642
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00010175907153068192
Epoch-11 lr: 0.00010175907153068192
epoch 11 training time: 15.192
---------------
2023-09-24 23:35:35.105961
current #epochs=12, #steps=429
start validation
acc: 0.732394
AUC: 0.902213
Avg Precision: 0.471813
Avg Recall: 1.000000
d_prime: 1.830365
train_loss: 0.036958
valid_loss: 1.324066
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00010175907153068192
Epoch-12 lr: 0.00010175907153068192
epoch 12 training time: 15.288
---------------
2023-09-24 23:35:50.393970
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00670	Per Sample Data Time 0.00107	Per Sample DNN Time 0.00563	Train Loss 0.0502	
start validation
acc: 0.741784
AUC: 0.900477
Avg Precision: 0.470229
Avg Recall: 1.000000
d_prime: 1.816236
train_loss: 0.048507
valid_loss: 1.327038
validation finished
normal learning rate scheduler step
Epoch-13 lr: 7.411791355363065e-05
Epoch-13 lr: 7.411791355363065e-05
epoch 13 training time: 16.759
---------------
2023-09-24 23:36:07.152919
current #epochs=14, #steps=507
start validation
acc: 0.751174
AUC: 0.899622
Avg Precision: 0.464422
Avg Recall: 1.000000
d_prime: 1.809349
train_loss: 0.044971
valid_loss: 1.325131
validation finished
normal learning rate scheduler step
Epoch-14 lr: 7.411791355363065e-05
Epoch-14 lr: 7.411791355363065e-05
epoch 14 training time: 15.188
---------------
2023-09-24 23:36:22.341212
current #epochs=15, #steps=546
start validation
acc: 0.751174
AUC: 0.899380
Avg Precision: 0.470909
Avg Recall: 1.000000
d_prime: 1.807406
train_loss: 0.038270
valid_loss: 1.324978
validation finished
normal learning rate scheduler step
Epoch-15 lr: 5.398501604731232e-05
Epoch-15 lr: 5.398501604731232e-05
epoch 15 training time: 15.124
---------------
2023-09-24 23:36:37.464765
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00789	Per Sample Data Time 0.00208	Per Sample DNN Time 0.00581	Train Loss 0.0513	
start validation
acc: 0.751174
AUC: 0.899170
Avg Precision: 0.471005
Avg Recall: 1.000000
d_prime: 1.805721
train_loss: 0.047076
valid_loss: 1.324779
validation finished
normal learning rate scheduler step
Epoch-16 lr: 5.398501604731232e-05
Epoch-16 lr: 5.398501604731232e-05
epoch 16 training time: 15.341
---------------
2023-09-24 23:36:52.805945
current #epochs=17, #steps=624
start validation
acc: 0.746479
AUC: 0.899196
Avg Precision: 0.470580
Avg Recall: 1.000000
d_prime: 1.805927
train_loss: 0.048096
valid_loss: 1.325632
validation finished
normal learning rate scheduler step
Epoch-17 lr: 3.9320885031656546e-05
Epoch-17 lr: 3.9320885031656546e-05
epoch 17 training time: 15.136
---------------
2023-09-24 23:37:07.942157
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00652	Per Sample Data Time 0.00097	Per Sample DNN Time 0.00555	Train Loss 0.0427	
start validation
acc: 0.751174
AUC: 0.900118
Avg Precision: 0.470580
Avg Recall: 1.000000
d_prime: 1.813341
train_loss: 0.042137
valid_loss: 1.324809
validation finished
normal learning rate scheduler step
Epoch-18 lr: 3.9320885031656546e-05
Epoch-18 lr: 3.9320885031656546e-05
epoch 18 training time: 15.198
---------------
2023-09-24 23:37:23.139681
current #epochs=19, #steps=702
start validation
acc: 0.741784
AUC: 0.900929
Avg Precision: 0.471425
Avg Recall: 1.000000
d_prime: 1.819897
train_loss: 0.037872
valid_loss: 1.323159
validation finished
normal learning rate scheduler step
Epoch-19 lr: 2.8640021118410443e-05
Epoch-19 lr: 2.8640021118410443e-05
epoch 19 training time: 15.422
---------------
2023-09-24 23:37:38.561357
current #epochs=20, #steps=741
start validation
acc: 0.741784
AUC: 0.901716
Avg Precision: 0.472525
Avg Recall: 1.000000
d_prime: 1.826307
train_loss: 0.046568
valid_loss: 1.321610
validation finished
normal learning rate scheduler step
Epoch-20 lr: 2.8640021118410443e-05
Epoch-20 lr: 2.8640021118410443e-05
epoch 20 training time: 15.318
---------------
2023-09-24 23:37:53.879771
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00558	Train Loss 0.0261	
start validation
acc: 0.746479
AUC: 0.902665
Avg Precision: 0.473913
Avg Recall: 1.000000
d_prime: 1.834076
train_loss: 0.048569
valid_loss: 1.319386
validation finished
normal learning rate scheduler step
Epoch-21 lr: 2.0860436101644885e-05
Epoch-21 lr: 2.0860436101644885e-05
epoch 21 training time: 15.185
---------------
2023-09-24 23:38:09.064846
current #epochs=22, #steps=819
start validation
[I 2023-09-24 23:38:24,340] Trial 85 finished with value: 0.4743926472101709 and parameters: {'warmup': 'True', 'num_epochs': 22, 'batch_size': 50, 'lr-adaptschedule': 'True', 'lr': 0.0003615538059827084, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.728366645240891}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.737089
AUC: 0.903534
Avg Precision: 0.474393
Avg Recall: 1.000000
d_prime: 1.841241
train_loss: 0.046168
valid_loss: 1.318813
validation finished
normal learning rate scheduler step
Epoch-22 lr: 2.0860436101644885e-05
Epoch-22 lr: 2.0860436101644885e-05
epoch 22 training time: 15.261
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f4dfb80>
The learning rate scheduler starts at 7 epoch with decay rate of 0.751 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 23:38:24.378985
current #epochs=1, #steps=0
start validation
acc: 0.737089
AUC: 0.895168
Avg Precision: 0.463950
Avg Recall: 1.000000
d_prime: 1.774119
train_loss: 0.063371
valid_loss: 1.330430
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0005059836836618307
Epoch-1 lr: 0.0005059836836618307
epoch 1 training time: 17.938
---------------
2023-09-24 23:38:42.317729
current #epochs=2, #steps=39
start validation
acc: 0.741784
AUC: 0.902195
Avg Precision: 0.474099
Avg Recall: 1.000000
d_prime: 1.830219
train_loss: 0.042806
valid_loss: 1.314325
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0005059836836618307
Epoch-2 lr: 0.0005059836836618307
epoch 2 training time: 17.601
---------------
2023-09-24 23:38:59.918627
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00715	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00567	Train Loss 0.0638	
start validation
acc: 0.727700
AUC: 0.897645
Avg Precision: 0.461494
Avg Recall: 1.000000
d_prime: 1.793573
train_loss: 0.059144
valid_loss: 1.335932
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0005059836836618307
Epoch-3 lr: 0.0005059836836618307
epoch 3 training time: 15.252
---------------
2023-09-24 23:39:15.170409
current #epochs=4, #steps=117
start validation
acc: 0.741784
AUC: 0.896781
Avg Precision: 0.484737
Avg Recall: 1.000000
d_prime: 1.786748
train_loss: 0.051952
valid_loss: 1.326013
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0005059836836618307
Epoch-4 lr: 0.0005059836836618307
epoch 4 training time: 15.228
---------------
2023-09-24 23:39:30.398415
current #epochs=5, #steps=156
start validation
acc: 0.723005
AUC: 0.905850
Avg Precision: 0.488397
Avg Recall: 1.000000
d_prime: 1.860571
train_loss: 0.069774
valid_loss: 1.322016
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0005059836836618307
Epoch-5 lr: 0.0005059836836618307
epoch 5 training time: 15.201
---------------
2023-09-24 23:39:45.598651
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01150	Per Sample Data Time 0.00532	Per Sample DNN Time 0.00618	Train Loss 0.0385	
start validation
acc: 0.704225
AUC: 0.895298
Avg Precision: 0.461417
Avg Recall: 1.000000
d_prime: 1.775130
train_loss: 0.042076
valid_loss: 1.329804
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0005059836836618307
Epoch-6 lr: 0.0005059836836618307
epoch 6 training time: 16.464
---------------
2023-09-24 23:40:02.062263
current #epochs=7, #steps=234
start validation
acc: 0.718310
AUC: 0.897185
Avg Precision: 0.467519
Avg Recall: 1.000000
d_prime: 1.789934
train_loss: 0.053793
valid_loss: 1.330605
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0003801232327326057
Epoch-7 lr: 0.0003801232327326057
epoch 7 training time: 15.319
---------------
2023-09-24 23:40:17.381230
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00689	Per Sample Data Time 0.00129	Per Sample DNN Time 0.00559	Train Loss 0.0550	
start validation
acc: 0.751174
AUC: 0.897641
Avg Precision: 0.461728
Avg Recall: 1.000000
d_prime: 1.793539
train_loss: 0.054940
valid_loss: 1.331751
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00028556982513226194
Epoch-8 lr: 0.00028556982513226194
epoch 8 training time: 20.200
---------------
2023-09-24 23:40:37.581139
current #epochs=9, #steps=312
start validation
acc: 0.737089
AUC: 0.900346
Avg Precision: 0.470271
Avg Recall: 1.000000
d_prime: 1.815182
train_loss: 0.042753
valid_loss: 1.329867
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00021453601885848523
Epoch-9 lr: 0.00021453601885848523
epoch 9 training time: 15.347
---------------
2023-09-24 23:40:52.927734
current #epochs=10, #steps=351
start validation
acc: 0.746479
AUC: 0.897947
Avg Precision: 0.474613
Avg Recall: 1.000000
d_prime: 1.795964
train_loss: 0.041058
valid_loss: 1.334002
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00016117145208297646
Epoch-10 lr: 0.00016117145208297646
epoch 10 training time: 15.363
---------------
2023-09-24 23:41:08.290311
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00866	Per Sample Data Time 0.00297	Per Sample DNN Time 0.00569	Train Loss 0.0354	
start validation
acc: 0.746479
AUC: 0.895080
Avg Precision: 0.470538
Avg Recall: 1.000000
d_prime: 1.773432
train_loss: 0.047317
valid_loss: 1.336431
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.0001210810059063785
Epoch-11 lr: 0.0001210810059063785
epoch 11 training time: 15.366
---------------
2023-09-24 23:41:23.656519
current #epochs=12, #steps=429
start validation
acc: 0.755869
AUC: 0.898110
Avg Precision: 0.474025
Avg Recall: 1.000000
d_prime: 1.797260
train_loss: 0.045837
valid_loss: 1.333604
validation finished
normal learning rate scheduler step
Epoch-12 lr: 9.096282128023945e-05
Epoch-12 lr: 9.096282128023945e-05
epoch 12 training time: 17.580
---------------
2023-09-24 23:41:41.236176
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00664	Per Sample Data Time 0.00106	Per Sample DNN Time 0.00558	Train Loss 0.0483	
start validation
acc: 0.755869
AUC: 0.899592
Avg Precision: 0.474064
Avg Recall: 1.000000
d_prime: 1.809108
train_loss: 0.048986
valid_loss: 1.333079
validation finished
normal learning rate scheduler step
Epoch-13 lr: 6.833635708030486e-05
Epoch-13 lr: 6.833635708030486e-05
epoch 13 training time: 15.179
---------------
2023-09-24 23:41:56.414833
current #epochs=14, #steps=507
start validation
acc: 0.755869
AUC: 0.899143
Avg Precision: 0.471405
Avg Recall: 1.000000
d_prime: 1.805501
train_loss: 0.056746
valid_loss: 1.332728
validation finished
normal learning rate scheduler step
Epoch-14 lr: 5.1338092126891865e-05
Epoch-14 lr: 5.1338092126891865e-05
epoch 14 training time: 16.021
---------------
2023-09-24 23:42:12.435788
current #epochs=15, #steps=546
start validation
acc: 0.741784
AUC: 0.898451
Avg Precision: 0.469507
Avg Recall: 1.000000
d_prime: 1.799971
train_loss: 0.056193
valid_loss: 1.333311
validation finished
normal learning rate scheduler step
Epoch-15 lr: 3.856804512028692e-05
Epoch-15 lr: 3.856804512028692e-05
epoch 15 training time: 15.423
---------------
2023-09-24 23:42:27.858772
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00767	Per Sample Data Time 0.00202	Per Sample DNN Time 0.00565	Train Loss 0.0364	
start validation
acc: 0.741784
AUC: 0.898269
Avg Precision: 0.469621
Avg Recall: 1.000000
d_prime: 1.798529
train_loss: 0.035811
valid_loss: 1.334699
validation finished
normal learning rate scheduler step
Epoch-16 lr: 2.897447183514072e-05
Epoch-16 lr: 2.897447183514072e-05
epoch 16 training time: 15.203
---------------
2023-09-24 23:42:43.061721
current #epochs=17, #steps=624
start validation
acc: 0.741784
AUC: 0.899088
Avg Precision: 0.469900
Avg Recall: 1.000000
d_prime: 1.805061
train_loss: 0.055676
valid_loss: 1.334436
validation finished
normal learning rate scheduler step
Epoch-17 lr: 2.1767243206313622e-05
Epoch-17 lr: 2.1767243206313622e-05
epoch 17 training time: 15.271
---------------
2023-09-24 23:42:58.333041
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00648	Per Sample Data Time 0.00095	Per Sample DNN Time 0.00552	Train Loss 0.0302	
start validation
acc: 0.741784
AUC: 0.899022
Avg Precision: 0.463881
Avg Recall: 1.000000
d_prime: 1.804538
train_loss: 0.030501
valid_loss: 1.334314
validation finished
normal learning rate scheduler step
Epoch-18 lr: 1.6352770103928468e-05
Epoch-18 lr: 1.6352770103928468e-05
epoch 18 training time: 15.128
---------------
2023-09-24 23:43:13.460787
current #epochs=19, #steps=702
start validation
acc: 0.741784
AUC: 0.898575
Avg Precision: 0.463125
Avg Recall: 1.000000
d_prime: 1.800967
train_loss: 0.050137
valid_loss: 1.334666
validation finished
normal learning rate scheduler step
Epoch-19 lr: 1.228511518603206e-05
Epoch-19 lr: 1.228511518603206e-05
epoch 19 training time: 15.194
---------------
2023-09-24 23:43:28.655047
current #epochs=20, #steps=741
start validation
acc: 0.741784
AUC: 0.898649
Avg Precision: 0.463047
Avg Recall: 1.000000
d_prime: 1.801550
train_loss: 0.033423
valid_loss: 1.334557
validation finished
normal learning rate scheduler step
Epoch-20 lr: 9.229265388976433e-06
Epoch-20 lr: 9.229265388976433e-06
epoch 20 training time: 15.251
---------------
2023-09-24 23:43:43.905785
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00159	Per Sample DNN Time 0.00561	Train Loss 0.0288	
start validation
acc: 0.741784
AUC: 0.898712
Avg Precision: 0.463047
Avg Recall: 1.000000
d_prime: 1.802053
train_loss: 0.044079
valid_loss: 1.334355
validation finished
normal learning rate scheduler step
Epoch-21 lr: 6.933540168756869e-06
Epoch-21 lr: 6.933540168756869e-06
epoch 21 training time: 15.619
---------------
2023-09-24 23:43:59.524878
current #epochs=22, #steps=819
start validation
acc: 0.741784
AUC: 0.898509
Avg Precision: 0.463278
Avg Recall: 1.000000
d_prime: 1.800434
train_loss: 0.043412
valid_loss: 1.334459
validation finished
normal learning rate scheduler step
Epoch-22 lr: 5.208863029248815e-06
Epoch-22 lr: 5.208863029248815e-06
epoch 22 training time: 15.273
---------------
2023-09-24 23:44:14.797592
current #epochs=23, #steps=858
start validation
acc: 0.741784
AUC: 0.898408
Avg Precision: 0.462881
Avg Recall: 1.000000
d_prime: 1.799629
train_loss: 0.050102
valid_loss: 1.334584
validation finished
normal learning rate scheduler step
Epoch-23 lr: 3.9131891352898514e-06
Epoch-23 lr: 3.9131891352898514e-06
epoch 23 training time: 16.057
---------------
2023-09-24 23:44:30.854552
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01379	Per Sample Data Time 0.00764	Per Sample DNN Time 0.00615	Train Loss 0.0338	
start validation
acc: 0.741784
AUC: 0.898428
Avg Precision: 0.462881
Avg Recall: 1.000000
d_prime: 1.799789
train_loss: 0.044897
valid_loss: 1.334552
validation finished
normal learning rate scheduler step
Epoch-24 lr: 2.9398064649741564e-06
Epoch-24 lr: 2.9398064649741564e-06
epoch 24 training time: 15.073
---------------
2023-09-24 23:44:45.927427
current #epochs=25, #steps=936
start validation
acc: 0.741784
AUC: 0.898479
Avg Precision: 0.462881
Avg Recall: 1.000000
d_prime: 1.800198
train_loss: 0.048333
valid_loss: 1.334671
validation finished
normal learning rate scheduler step
Epoch-25 lr: 2.208546981173118e-06
Epoch-25 lr: 2.208546981173118e-06
epoch 25 training time: 15.276
---------------
2023-09-24 23:45:01.203156
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00700	Per Sample Data Time 0.00135	Per Sample DNN Time 0.00565	Train Loss 0.0403	
start validation
acc: 0.741784
AUC: 0.898546
Avg Precision: 0.462881
Avg Recall: 1.000000
d_prime: 1.800736
train_loss: 0.036623
valid_loss: 1.334822
validation finished
normal learning rate scheduler step
Epoch-26 lr: 1.659183972197902e-06
Epoch-26 lr: 1.659183972197902e-06
epoch 26 training time: 15.360
---------------
2023-09-24 23:45:16.563036
current #epochs=27, #steps=1014
start validation
acc: 0.741784
AUC: 0.898461
Avg Precision: 0.462881
Avg Recall: 1.000000
d_prime: 1.800055
train_loss: 0.048883
valid_loss: 1.334867
validation finished
normal learning rate scheduler step
Epoch-27 lr: 1.2464717649502525e-06
Epoch-27 lr: 1.2464717649502525e-06
epoch 27 training time: 15.243
---------------
2023-09-24 23:45:31.806223
current #epochs=28, #steps=1053
start validation
acc: 0.741784
AUC: 0.898523
Avg Precision: 0.462881
Avg Recall: 1.000000
d_prime: 1.800553
train_loss: 0.039834
valid_loss: 1.334870
validation finished
normal learning rate scheduler step
Epoch-28 lr: 9.364192801115597e-07
Epoch-28 lr: 9.364192801115597e-07
epoch 28 training time: 15.283
---------------
2023-09-24 23:45:47.088779
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00943	Per Sample Data Time 0.00349	Per Sample DNN Time 0.00594	Train Loss 0.0489	
start validation
acc: 0.741784
AUC: 0.898538
Avg Precision: 0.462881
Avg Recall: 1.000000
d_prime: 1.800672
train_loss: 0.042796
valid_loss: 1.334872
validation finished
normal learning rate scheduler step
Epoch-29 lr: 7.034905184552244e-07
Epoch-29 lr: 7.034905184552244e-07
epoch 29 training time: 15.318
---------------
2023-09-24 23:46:02.406719
current #epochs=30, #steps=1131
start validation
acc: 0.741784
AUC: 0.898538
Avg Precision: 0.462881
Avg Recall: 1.000000
d_prime: 1.800672
train_loss: 0.031071
valid_loss: 1.334905
validation finished
normal learning rate scheduler step
Epoch-30 lr: 5.285014096435958e-07
Epoch-30 lr: 5.285014096435958e-07
epoch 30 training time: 15.116
---------------
2023-09-24 23:46:17.522944
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00671	Per Sample Data Time 0.00111	Per Sample DNN Time 0.00560	Train Loss 0.0442	
start validation
acc: 0.741784
AUC: 0.898538
Avg Precision: 0.462881
Avg Recall: 1.000000
d_prime: 1.800672
train_loss: 0.042763
valid_loss: 1.334920
validation finished
normal learning rate scheduler step
Epoch-31 lr: 3.9703980745697216e-07
Epoch-31 lr: 3.9703980745697216e-07
epoch 31 training time: 15.316
---------------
2023-09-24 23:46:32.838669
current #epochs=32, #steps=1209
start validation
acc: 0.741784
AUC: 0.898533
Avg Precision: 0.462881
Avg Recall: 1.000000
d_prime: 1.800627
train_loss: 0.053319
valid_loss: 1.334928
validation finished
normal learning rate scheduler step
Epoch-32 lr: 2.982785018715035e-07
Epoch-32 lr: 2.982785018715035e-07
epoch 32 training time: 15.388
---------------
2023-09-24 23:46:48.226176
current #epochs=33, #steps=1248
start validation
acc: 0.741784
AUC: 0.898533
Avg Precision: 0.462881
Avg Recall: 1.000000
d_prime: 1.800627
train_loss: 0.047315
valid_loss: 1.334925
validation finished
normal learning rate scheduler step
Epoch-33 lr: 2.2408348736757418e-07
Epoch-33 lr: 2.2408348736757418e-07
epoch 33 training time: 16.572
---------------
2023-09-24 23:47:04.798216
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00819	Per Sample Data Time 0.00238	Per Sample DNN Time 0.00581	Train Loss 0.0295	
start validation
acc: 0.741784
AUC: 0.898533
Avg Precision: 0.462881
Avg Recall: 1.000000
d_prime: 1.800627
train_loss: 0.038223
valid_loss: 1.334928
validation finished
normal learning rate scheduler step
Epoch-34 lr: 1.683440442263097e-07
Epoch-34 lr: 1.683440442263097e-07
epoch 34 training time: 15.342
---------------
2023-09-24 23:47:20.140357
current #epochs=35, #steps=1326
start validation
acc: 0.741784
AUC: 0.898533
Avg Precision: 0.462881
Avg Recall: 1.000000
d_prime: 1.800627
train_loss: 0.038030
valid_loss: 1.334931
validation finished
normal learning rate scheduler step
Epoch-35 lr: 1.2646945814433353e-07
Epoch-35 lr: 1.2646945814433353e-07
epoch 35 training time: 15.323
---------------
2023-09-24 23:47:35.462655
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00656	Per Sample Data Time 0.00101	Per Sample DNN Time 0.00555	Train Loss 0.0574	
start validation
[I 2023-09-24 23:47:51,843] Trial 86 finished with value: 0.46288068177921265 and parameters: {'warmup': 'True', 'num_epochs': 36, 'batch_size': 34, 'lr-adaptschedule': 'True', 'lr': 0.0005059836836618307, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7512559100357422}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.741784
AUC: 0.898533
Avg Precision: 0.462881
Avg Recall: 1.000000
d_prime: 1.800627
train_loss: 0.054230
valid_loss: 1.334933
validation finished
normal learning rate scheduler step
Epoch-36 lr: 9.50109278699485e-08
Epoch-36 lr: 9.50109278699485e-08
epoch 36 training time: 16.368
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa63cec0850>
The learning rate scheduler starts at 6 epoch with decay rate of 0.783 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 23:47:51.882368
current #epochs=1, #steps=0
start validation
acc: 0.751174
AUC: 0.894835
Avg Precision: 0.415039
Avg Recall: 1.000000
d_prime: 1.771529
train_loss: 0.060557
valid_loss: 1.330850
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0007206840316890142
Epoch-1 lr: 0.0007206840316890142
epoch 1 training time: 17.577
---------------
2023-09-24 23:48:09.460030
current #epochs=2, #steps=39
start validation
acc: 0.737089
AUC: 0.892078
Avg Precision: 0.449950
Avg Recall: 1.000000
d_prime: 1.750310
train_loss: 0.070353
valid_loss: 1.342500
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0007206840316890142
Epoch-2 lr: 0.0007206840316890142
epoch 2 training time: 15.428
---------------
2023-09-24 23:48:24.887610
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00141	Per Sample DNN Time 0.00565	Train Loss 0.0812	
start validation
acc: 0.723005
AUC: 0.896622
Avg Precision: 0.478880
Avg Recall: 1.000000
d_prime: 1.785494
train_loss: 0.085856
valid_loss: 1.325686
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0007206840316890142
Epoch-3 lr: 0.0007206840316890142
epoch 3 training time: 15.266
---------------
2023-09-24 23:48:40.153124
current #epochs=4, #steps=117
start validation
acc: 0.746479
AUC: 0.893585
Avg Precision: 0.472261
Avg Recall: 1.000000
d_prime: 1.761861
train_loss: 0.069975
valid_loss: 1.328334
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0007206840316890142
Epoch-4 lr: 0.0007206840316890142
epoch 4 training time: 15.074
---------------
2023-09-24 23:48:55.227628
current #epochs=5, #steps=156
start validation
acc: 0.732394
AUC: 0.889523
Avg Precision: 0.472241
Avg Recall: 1.000000
d_prime: 1.730992
train_loss: 0.070958
valid_loss: 1.332290
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0007206840316890142
Epoch-5 lr: 0.0007206840316890142
epoch 5 training time: 15.324
---------------
2023-09-24 23:49:10.551480
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01130	Per Sample Data Time 0.00511	Per Sample DNN Time 0.00620	Train Loss 0.0743	
start validation
acc: 0.727700
AUC: 0.895364
Avg Precision: 0.464688
Avg Recall: 1.000000
d_prime: 1.775646
train_loss: 0.074336
valid_loss: 1.334451
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0005639942481764624
Epoch-6 lr: 0.0005639942481764624
epoch 6 training time: 15.183
---------------
2023-09-24 23:49:25.734810
current #epochs=7, #steps=234
start validation
acc: 0.723005
AUC: 0.891955
Avg Precision: 0.464473
Avg Recall: 1.000000
d_prime: 1.749371
train_loss: 0.066054
valid_loss: 1.331569
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0004413716663468317
Epoch-7 lr: 0.0004413716663468317
epoch 7 training time: 15.274
---------------
2023-09-24 23:49:41.008597
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00682	Per Sample Data Time 0.00120	Per Sample DNN Time 0.00562	Train Loss 0.0401	
start validation
acc: 0.755869
AUC: 0.897481
Avg Precision: 0.464582
Avg Recall: 1.000000
d_prime: 1.792270
train_loss: 0.038878
valid_loss: 1.317542
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0003454094584894191
Epoch-8 lr: 0.0003454094584894191
epoch 8 training time: 17.569
---------------
2023-09-24 23:49:58.578013
current #epochs=9, #steps=312
start validation
acc: 0.718310
AUC: 0.900624
Avg Precision: 0.474174
Avg Recall: 1.000000
d_prime: 1.817431
train_loss: 0.050150
valid_loss: 1.315741
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00027031117561633703
Epoch-9 lr: 0.00027031117561633703
epoch 9 training time: 15.208
---------------
2023-09-24 23:50:13.786510
current #epochs=10, #steps=351
start validation
acc: 0.723005
AUC: 0.897905
Avg Precision: 0.472513
Avg Recall: 1.000000
d_prime: 1.795635
train_loss: 0.058969
valid_loss: 1.316608
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00021154062191184754
Epoch-10 lr: 0.00021154062191184754
epoch 10 training time: 15.034
---------------
2023-09-24 23:50:28.820888
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00900	Per Sample Data Time 0.00303	Per Sample DNN Time 0.00597	Train Loss 0.0642	
start validation
acc: 0.723005
AUC: 0.895936
Avg Precision: 0.473839
Avg Recall: 1.000000
d_prime: 1.780112
train_loss: 0.039097
valid_loss: 1.323912
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00016554785282857048
Epoch-11 lr: 0.00016554785282857048
epoch 11 training time: 15.464
---------------
2023-09-24 23:50:44.285374
current #epochs=12, #steps=429
start validation
acc: 0.727700
AUC: 0.896412
Avg Precision: 0.466316
Avg Recall: 1.000000
d_prime: 1.783844
train_loss: 0.040251
valid_loss: 1.319434
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00012955474616866067
Epoch-12 lr: 0.00012955474616866067
epoch 12 training time: 15.232
---------------
2023-09-24 23:50:59.517816
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00663	Per Sample Data Time 0.00106	Per Sample DNN Time 0.00557	Train Loss 0.0531	
start validation
acc: 0.723005
AUC: 0.895954
Avg Precision: 0.474218
Avg Recall: 1.000000
d_prime: 1.780255
train_loss: 0.054543
valid_loss: 1.320791
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00010138719390221785
Epoch-13 lr: 0.00010138719390221785
epoch 13 training time: 15.152
---------------
2023-09-24 23:51:14.670078
current #epochs=14, #steps=507
start validation
acc: 0.727700
AUC: 0.895152
Avg Precision: 0.474412
Avg Recall: 1.000000
d_prime: 1.773990
train_loss: 0.048642
valid_loss: 1.323649
validation finished
normal learning rate scheduler step
Epoch-14 lr: 7.93437785288371e-05
Epoch-14 lr: 7.93437785288371e-05
epoch 14 training time: 16.440
---------------
2023-09-24 23:51:31.109415
current #epochs=15, #steps=546
start validation
acc: 0.732394
AUC: 0.897181
Avg Precision: 0.475447
Avg Recall: 1.000000
d_prime: 1.789897
train_loss: 0.050667
valid_loss: 1.324139
validation finished
normal learning rate scheduler step
Epoch-15 lr: 6.209300158070002e-05
Epoch-15 lr: 6.209300158070002e-05
epoch 15 training time: 15.215
---------------
2023-09-24 23:51:46.324677
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00773	Per Sample Data Time 0.00213	Per Sample DNN Time 0.00560	Train Loss 0.0520	
start validation
acc: 0.727700
AUC: 0.898535
Avg Precision: 0.475802
Avg Recall: 1.000000
d_prime: 1.800648
train_loss: 0.051224
valid_loss: 1.322682
validation finished
normal learning rate scheduler step
Epoch-16 lr: 4.8592856513627443e-05
Epoch-16 lr: 4.8592856513627443e-05
epoch 16 training time: 15.305
---------------
2023-09-24 23:52:01.629171
current #epochs=17, #steps=624
start validation
acc: 0.727700
AUC: 0.897813
Avg Precision: 0.476537
Avg Recall: 1.000000
d_prime: 1.794906
train_loss: 0.031129
valid_loss: 1.324388
validation finished
normal learning rate scheduler step
Epoch-17 lr: 3.8027887910767745e-05
Epoch-17 lr: 3.8027887910767745e-05
epoch 17 training time: 16.276
---------------
2023-09-24 23:52:17.905767
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00657	Per Sample Data Time 0.00094	Per Sample DNN Time 0.00563	Train Loss 0.0527	
start validation
acc: 0.727700
AUC: 0.898692
Avg Precision: 0.476464
Avg Recall: 1.000000
d_prime: 1.801898
train_loss: 0.052826
valid_loss: 1.323532
validation finished
normal learning rate scheduler step
Epoch-18 lr: 2.975993515730782e-05
Epoch-18 lr: 2.975993515730782e-05
epoch 18 training time: 15.248
---------------
2023-09-24 23:52:33.153670
current #epochs=19, #steps=702
start validation
acc: 0.723005
AUC: 0.898567
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.800902
train_loss: 0.047988
valid_loss: 1.322484
validation finished
normal learning rate scheduler step
Epoch-19 lr: 2.328958533393567e-05
Epoch-19 lr: 2.328958533393567e-05
epoch 19 training time: 15.232
---------------
2023-09-24 23:52:48.385578
current #epochs=20, #steps=741
start validation
acc: 0.718310
AUC: 0.898787
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.802660
train_loss: 0.045540
valid_loss: 1.323266
validation finished
normal learning rate scheduler step
Epoch-20 lr: 1.822600695060584e-05
Epoch-20 lr: 1.822600695060584e-05
epoch 20 training time: 15.242
---------------
2023-09-24 23:53:03.626987
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00563	Train Loss 0.0504	
start validation
acc: 0.727700
AUC: 0.898332
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.799026
train_loss: 0.038847
valid_loss: 1.324826
validation finished
normal learning rate scheduler step
Epoch-21 lr: 1.4263342373876288e-05
Epoch-21 lr: 1.4263342373876288e-05
epoch 21 training time: 15.288
---------------
2023-09-24 23:53:18.915273
current #epochs=22, #steps=819
start validation
acc: 0.723005
AUC: 0.898069
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.796937
train_loss: 0.046008
valid_loss: 1.325591
validation finished
normal learning rate scheduler step
Epoch-22 lr: 1.1162232968843038e-05
Epoch-22 lr: 1.1162232968843038e-05
epoch 22 training time: 15.189
---------------
2023-09-24 23:53:34.104436
current #epochs=23, #steps=858
start validation
acc: 0.727700
AUC: 0.897778
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.794629
train_loss: 0.058317
valid_loss: 1.324755
validation finished
normal learning rate scheduler step
Epoch-23 lr: 8.735361010398693e-06
Epoch-23 lr: 8.735361010398693e-06
epoch 23 training time: 15.235
---------------
2023-09-24 23:53:49.339848
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01370	Per Sample Data Time 0.00763	Per Sample DNN Time 0.00607	Train Loss 0.0420	
start validation
acc: 0.727700
AUC: 0.897618
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.793357
train_loss: 0.035999
valid_loss: 1.324381
validation finished
normal learning rate scheduler step
Epoch-24 lr: 6.836135045289493e-06
Epoch-24 lr: 6.836135045289493e-06
epoch 24 training time: 15.185
---------------
2023-09-24 23:54:04.524823
current #epochs=25, #steps=936
start validation
acc: 0.727700
AUC: 0.897362
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.791329
train_loss: 0.031561
valid_loss: 1.324288
validation finished
normal learning rate scheduler step
Epoch-25 lr: 5.349835261737195e-06
Epoch-25 lr: 5.349835261737195e-06
epoch 25 training time: 15.338
---------------
2023-09-24 23:54:19.862265
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00700	Per Sample Data Time 0.00132	Per Sample DNN Time 0.00568	Train Loss 0.0364	
start validation
acc: 0.727700
AUC: 0.897380
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.791475
train_loss: 0.042876
valid_loss: 1.324206
validation finished
normal learning rate scheduler step
Epoch-26 lr: 4.18668401635045e-06
Epoch-26 lr: 4.18668401635045e-06
epoch 26 training time: 15.252
---------------
2023-09-24 23:54:35.114320
current #epochs=27, #steps=1014
start validation
acc: 0.727700
AUC: 0.897608
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.793276
train_loss: 0.057708
valid_loss: 1.324004
validation finished
normal learning rate scheduler step
Epoch-27 lr: 3.2764229542037433e-06
Epoch-27 lr: 3.2764229542037433e-06
epoch 27 training time: 15.265
---------------
2023-09-24 23:54:50.379268
current #epochs=28, #steps=1053
start validation
acc: 0.727700
AUC: 0.897517
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.792555
train_loss: 0.062529
valid_loss: 1.324042
validation finished
normal learning rate scheduler step
Epoch-28 lr: 2.5640691613958685e-06
Epoch-28 lr: 2.5640691613958685e-06
epoch 28 training time: 15.238
---------------
2023-09-24 23:55:05.616912
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00963	Per Sample Data Time 0.00367	Per Sample DNN Time 0.00595	Train Loss 0.0707	
start validation
acc: 0.732394
AUC: 0.897315
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.790957
train_loss: 0.056414
valid_loss: 1.324090
validation finished
normal learning rate scheduler step
Epoch-29 lr: 2.006594007036273e-06
Epoch-29 lr: 2.006594007036273e-06
epoch 29 training time: 15.283
---------------
2023-09-24 23:55:20.900523
current #epochs=30, #steps=1131
start validation
acc: 0.732394
AUC: 0.897269
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.790595
train_loss: 0.041590
valid_loss: 1.324218
validation finished
normal learning rate scheduler step
Epoch-30 lr: 1.5703240652377412e-06
Epoch-30 lr: 1.5703240652377412e-06
epoch 30 training time: 15.197
---------------
2023-09-24 23:55:36.097169
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00670	Per Sample Data Time 0.00111	Per Sample DNN Time 0.00559	Train Loss 0.0287	
start validation
acc: 0.732394
AUC: 0.897274
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.790639
train_loss: 0.036706
valid_loss: 1.324228
validation finished
normal learning rate scheduler step
Epoch-31 lr: 1.2289071238216896e-06
Epoch-31 lr: 1.2289071238216896e-06
epoch 31 training time: 15.158
---------------
2023-09-24 23:55:51.254826
current #epochs=32, #steps=1209
start validation
acc: 0.732394
AUC: 0.897295
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.790801
train_loss: 0.048477
valid_loss: 1.324247
validation finished
normal learning rate scheduler step
Epoch-32 lr: 9.617204196326554e-07
Epoch-32 lr: 9.617204196326554e-07
epoch 32 training time: 15.331
---------------
2023-09-24 23:56:06.586134
current #epochs=33, #steps=1248
start validation
acc: 0.732394
AUC: 0.897409
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.791702
train_loss: 0.057818
valid_loss: 1.324252
validation finished
normal learning rate scheduler step
Epoch-33 lr: 7.526249523740344e-07
Epoch-33 lr: 7.526249523740344e-07
epoch 33 training time: 15.323
---------------
2023-09-24 23:56:21.908761
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00825	Per Sample Data Time 0.00241	Per Sample DNN Time 0.00585	Train Loss 0.0517	
start validation
acc: 0.732394
AUC: 0.897424
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.791820
train_loss: 0.041147
valid_loss: 1.324231
validation finished
normal learning rate scheduler step
Epoch-34 lr: 5.889906332158155e-07
Epoch-34 lr: 5.889906332158155e-07
epoch 34 training time: 15.303
---------------
2023-09-24 23:56:37.211891
current #epochs=35, #steps=1326
start validation
acc: 0.732394
AUC: 0.897424
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.791820
train_loss: 0.039243
valid_loss: 1.324232
validation finished
normal learning rate scheduler step
Epoch-35 lr: 4.60933383781252e-07
Epoch-35 lr: 4.60933383781252e-07
epoch 35 training time: 15.281
---------------
2023-09-24 23:56:52.493166
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00654	Per Sample Data Time 0.00096	Per Sample DNN Time 0.00558	Train Loss 0.0493	
start validation
acc: 0.732394
AUC: 0.897401
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.791642
train_loss: 0.050602
valid_loss: 1.324240
validation finished
normal learning rate scheduler step
Epoch-36 lr: 3.607181036547765e-07
Epoch-36 lr: 3.607181036547765e-07
epoch 36 training time: 15.240
---------------
2023-09-24 23:57:07.732914
current #epochs=37, #steps=1404
start validation
acc: 0.732394
AUC: 0.897401
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.791642
train_loss: 0.048639
valid_loss: 1.324225
validation finished
normal learning rate scheduler step
Epoch-37 lr: 2.8229144358536797e-07
Epoch-37 lr: 2.8229144358536797e-07
epoch 37 training time: 15.162
---------------
2023-09-24 23:57:22.895010
current #epochs=38, #steps=1443
start validation
acc: 0.732394
AUC: 0.897409
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.791702
train_loss: 0.052595
valid_loss: 1.324226
validation finished
normal learning rate scheduler step
Epoch-38 lr: 2.2091616227217815e-07
Epoch-38 lr: 2.2091616227217815e-07
epoch 38 training time: 15.173
---------------
2023-09-24 23:57:38.068637
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00760	Per Sample Data Time 0.00181	Per Sample DNN Time 0.00580	Train Loss 0.0397	
start validation
acc: 0.732394
AUC: 0.897416
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.791761
train_loss: 0.040466
valid_loss: 1.324226
validation finished
normal learning rate scheduler step
Epoch-39 lr: 1.7288498061865098e-07
Epoch-39 lr: 1.7288498061865098e-07
epoch 39 training time: 16.428
---------------
2023-09-24 23:57:54.496167
current #epochs=40, #steps=1521
start validation
acc: 0.732394
AUC: 0.897416
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.791761
train_loss: 0.044968
valid_loss: 1.324218
validation finished
normal learning rate scheduler step
Epoch-40 lr: 1.352966492632012e-07
Epoch-40 lr: 1.352966492632012e-07
epoch 40 training time: 16.579
---------------
2023-09-24 23:58:11.075015
current #epochs=41, #steps=1560
start validation
acc: 0.732394
AUC: 0.897416
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.791761
train_loss: 0.047802
valid_loss: 1.324223
validation finished
normal learning rate scheduler step
Epoch-41 lr: 1.0588070309142228e-07
Epoch-41 lr: 1.0588070309142228e-07
epoch 41 training time: 15.274
---------------
2023-09-24 23:58:26.348761
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02243	Per Sample Data Time 0.01537	Per Sample DNN Time 0.00706	Train Loss 0.0849	
start validation
acc: 0.732394
AUC: 0.897416
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.791761
train_loss: 0.042776
valid_loss: 1.324226
validation finished
normal learning rate scheduler step
Epoch-42 lr: 8.2860317296735e-08
Epoch-42 lr: 8.2860317296735e-08
epoch 42 training time: 16.426
---------------
2023-09-24 23:58:42.774865
current #epochs=43, #steps=1638
start validation
acc: 0.732394
AUC: 0.897416
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.791761
train_loss: 0.045684
valid_loss: 1.324231
validation finished
normal learning rate scheduler step
Epoch-43 lr: 6.484498102158734e-08
Epoch-43 lr: 6.484498102158734e-08
epoch 43 training time: 15.276
---------------
2023-09-24 23:58:58.050526
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00704	Per Sample Data Time 0.00142	Per Sample DNN Time 0.00562	Train Loss 0.0399	
start validation
acc: 0.732394
AUC: 0.897416
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.791761
train_loss: 0.042014
valid_loss: 1.324234
validation finished
normal learning rate scheduler step
Epoch-44 lr: 5.0746505696228004e-08
Epoch-44 lr: 5.0746505696228004e-08
epoch 44 training time: 15.232
---------------
2023-09-24 23:59:13.282799
current #epochs=45, #steps=1716
start validation
acc: 0.732394
AUC: 0.897487
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.792322
train_loss: 0.026866
valid_loss: 1.324233
validation finished
normal learning rate scheduler step
Epoch-45 lr: 3.971329468845086e-08
Epoch-45 lr: 3.971329468845086e-08
epoch 45 training time: 15.139
---------------
2023-09-24 23:59:28.421788
current #epochs=46, #steps=1755
start validation
[I 2023-09-24 23:59:43,749] Trial 87 finished with value: 0.47613943486543836 and parameters: {'warmup': 'True', 'num_epochs': 46, 'batch_size': 46, 'lr-adaptschedule': 'True', 'lr': 0.0007206840316890142, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7825818574815242}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.732394
AUC: 0.897487
Avg Precision: 0.476139
Avg Recall: 1.000000
d_prime: 1.792322
train_loss: 0.040636
valid_loss: 1.324233
validation finished
normal learning rate scheduler step
Epoch-46 lr: 3.107890392399902e-08
Epoch-46 lr: 3.107890392399902e-08
epoch 46 training time: 15.313
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67ec60b20>
The learning rate scheduler starts at 5 epoch with decay rate of 0.776 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-24 23:59:43.789905
current #epochs=1, #steps=0
start validation
acc: 0.746479
AUC: 0.891846
Avg Precision: 0.465351
Avg Recall: 1.000000
d_prime: 1.748544
train_loss: 0.055906
valid_loss: 1.328769
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.00021291789729349615
Epoch-1 lr: 0.00021291789729349615
epoch 1 training time: 17.720
---------------
2023-09-25 00:00:01.510539
current #epochs=2, #steps=39
start validation
acc: 0.755869
AUC: 0.895158
Avg Precision: 0.477095
Avg Recall: 1.000000
d_prime: 1.774036
train_loss: 0.041683
valid_loss: 1.335954
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.00021291789729349615
Epoch-2 lr: 0.00021291789729349615
epoch 2 training time: 17.639
---------------
2023-09-25 00:00:19.148897
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00150	Per Sample DNN Time 0.00565	Train Loss 0.0256	
start validation
acc: 0.751174
AUC: 0.897544
Avg Precision: 0.478375
Avg Recall: 1.000000
d_prime: 1.792771
train_loss: 0.033307
valid_loss: 1.327091
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.00021291789729349615
Epoch-3 lr: 0.00021291789729349615
epoch 3 training time: 15.346
---------------
2023-09-25 00:00:34.494874
current #epochs=4, #steps=117
start validation
acc: 0.741784
AUC: 0.897611
Avg Precision: 0.469684
Avg Recall: 1.000000
d_prime: 1.793300
train_loss: 0.053184
valid_loss: 1.332698
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00021291789729349615
Epoch-4 lr: 0.00021291789729349615
epoch 4 training time: 15.228
---------------
2023-09-25 00:00:49.723034
current #epochs=5, #steps=156
start validation
acc: 0.723005
AUC: 0.892235
Avg Precision: 0.478948
Avg Recall: 1.000000
d_prime: 1.751504
train_loss: 0.049602
valid_loss: 1.338771
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00016512518493531456
Epoch-5 lr: 0.00016512518493531456
epoch 5 training time: 15.221
---------------
2023-09-25 00:01:04.944233
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01122	Per Sample Data Time 0.00534	Per Sample DNN Time 0.00588	Train Loss 0.0382	
start validation
acc: 0.732394
AUC: 0.894051
Avg Precision: 0.473312
Avg Recall: 1.000000
d_prime: 1.765453
train_loss: 0.032475
valid_loss: 1.341686
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00012806028542700022
Epoch-6 lr: 0.00012806028542700022
epoch 6 training time: 15.258
---------------
2023-09-25 00:01:20.201877
current #epochs=7, #steps=234
start validation
acc: 0.732394
AUC: 0.896381
Avg Precision: 0.474775
Avg Recall: 1.000000
d_prime: 1.783599
train_loss: 0.045874
valid_loss: 1.332846
validation finished
normal learning rate scheduler step
Epoch-7 lr: 9.931517539295421e-05
Epoch-7 lr: 9.931517539295421e-05
epoch 7 training time: 15.263
---------------
2023-09-25 00:01:35.465409
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00688	Per Sample Data Time 0.00124	Per Sample DNN Time 0.00565	Train Loss 0.0475	
start validation
acc: 0.732394
AUC: 0.899925
Avg Precision: 0.467960
Avg Recall: 1.000000
d_prime: 1.811783
train_loss: 0.052689
valid_loss: 1.331115
validation finished
normal learning rate scheduler step
Epoch-8 lr: 7.702234951643826e-05
Epoch-8 lr: 7.702234951643826e-05
epoch 8 training time: 16.930
---------------
2023-09-25 00:01:52.394980
current #epochs=9, #steps=312
start validation
acc: 0.737089
AUC: 0.900285
Avg Precision: 0.468535
Avg Recall: 1.000000
d_prime: 1.814688
train_loss: 0.048875
valid_loss: 1.328260
validation finished
normal learning rate scheduler step
Epoch-9 lr: 5.973349290840851e-05
Epoch-9 lr: 5.973349290840851e-05
epoch 9 training time: 15.216
---------------
2023-09-25 00:02:07.611313
current #epochs=10, #steps=351
start validation
acc: 0.755869
AUC: 0.899860
Avg Precision: 0.476085
Avg Recall: 1.000000
d_prime: 1.811259
train_loss: 0.044740
valid_loss: 1.329367
validation finished
normal learning rate scheduler step
Epoch-10 lr: 4.63253873380918e-05
Epoch-10 lr: 4.63253873380918e-05
epoch 10 training time: 16.404
---------------
2023-09-25 00:02:24.015403
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00876	Per Sample Data Time 0.00291	Per Sample DNN Time 0.00585	Train Loss 0.0580	
start validation
acc: 0.755869
AUC: 0.900245
Avg Precision: 0.486012
Avg Recall: 1.000000
d_prime: 1.814362
train_loss: 0.053442
valid_loss: 1.329738
validation finished
normal learning rate scheduler step
Epoch-11 lr: 3.592693826418016e-05
Epoch-11 lr: 3.592693826418016e-05
epoch 11 training time: 15.241
---------------
2023-09-25 00:02:39.256185
current #epochs=12, #steps=429
start validation
acc: 0.751174
AUC: 0.899772
Avg Precision: 0.485890
Avg Recall: 1.000000
d_prime: 1.810555
train_loss: 0.039181
valid_loss: 1.328454
validation finished
normal learning rate scheduler step
Epoch-12 lr: 2.786258177655595e-05
Epoch-12 lr: 2.786258177655595e-05
epoch 12 training time: 15.239
---------------
2023-09-25 00:02:54.495105
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00662	Per Sample Data Time 0.00102	Per Sample DNN Time 0.00560	Train Loss 0.0412	
start validation
acc: 0.751174
AUC: 0.901169
Avg Precision: 0.486563
Avg Recall: 1.000000
d_prime: 1.821848
train_loss: 0.041927
valid_loss: 1.328912
validation finished
normal learning rate scheduler step
Epoch-13 lr: 2.160839472450334e-05
Epoch-13 lr: 2.160839472450334e-05
epoch 13 training time: 15.171
---------------
2023-09-25 00:03:09.666145
current #epochs=14, #steps=507
start validation
acc: 0.755869
AUC: 0.900211
Avg Precision: 0.486601
Avg Recall: 1.000000
d_prime: 1.814089
train_loss: 0.041781
valid_loss: 1.330698
validation finished
normal learning rate scheduler step
Epoch-14 lr: 1.675805660489153e-05
Epoch-14 lr: 1.675805660489153e-05
epoch 14 training time: 15.315
---------------
2023-09-25 00:03:24.981259
current #epochs=15, #steps=546
start validation
acc: 0.755869
AUC: 0.900288
Avg Precision: 0.486746
Avg Recall: 1.000000
d_prime: 1.814713
train_loss: 0.044380
valid_loss: 1.330676
validation finished
normal learning rate scheduler step
Epoch-15 lr: 1.2996451830560656e-05
Epoch-15 lr: 1.2996451830560656e-05
epoch 15 training time: 16.706
---------------
2023-09-25 00:03:41.687348
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00787	Per Sample Data Time 0.00208	Per Sample DNN Time 0.00579	Train Loss 0.0484	
start validation
acc: 0.755869
AUC: 0.900531
Avg Precision: 0.486601
Avg Recall: 1.000000
d_prime: 1.816673
train_loss: 0.053825
valid_loss: 1.330961
validation finished
normal learning rate scheduler step
Epoch-16 lr: 1.0079197377503828e-05
Epoch-16 lr: 1.0079197377503828e-05
epoch 16 training time: 15.411
---------------
2023-09-25 00:03:57.098616
current #epochs=17, #steps=624
start validation
acc: 0.760563
AUC: 0.900559
Avg Precision: 0.486601
Avg Recall: 1.000000
d_prime: 1.816901
train_loss: 0.043781
valid_loss: 1.330912
validation finished
normal learning rate scheduler step
Epoch-17 lr: 7.816765768007123e-06
Epoch-17 lr: 7.816765768007123e-06
epoch 17 training time: 17.497
---------------
2023-09-25 00:04:14.596037
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00653	Per Sample Data Time 0.00095	Per Sample DNN Time 0.00559	Train Loss 0.0410	
start validation
acc: 0.760563
AUC: 0.900394
Avg Precision: 0.486368
Avg Recall: 1.000000
d_prime: 1.815565
train_loss: 0.040067
valid_loss: 1.330988
validation finished
normal learning rate scheduler step
Epoch-18 lr: 6.062171895578079e-06
Epoch-18 lr: 6.062171895578079e-06
epoch 18 training time: 15.259
---------------
2023-09-25 00:04:29.854781
current #epochs=19, #steps=702
start validation
acc: 0.755869
AUC: 0.900590
Avg Precision: 0.486368
Avg Recall: 1.000000
d_prime: 1.817151
train_loss: 0.052688
valid_loss: 1.330678
validation finished
normal learning rate scheduler step
Epoch-19 lr: 4.701423732299718e-06
Epoch-19 lr: 4.701423732299718e-06
epoch 19 training time: 15.216
---------------
2023-09-25 00:04:45.070636
current #epochs=20, #steps=741
start validation
acc: 0.755869
AUC: 0.900892
Avg Precision: 0.486368
Avg Recall: 1.000000
d_prime: 1.819598
train_loss: 0.043767
valid_loss: 1.330533
validation finished
normal learning rate scheduler step
Epoch-20 lr: 3.6461165224882274e-06
Epoch-20 lr: 3.6461165224882274e-06
epoch 20 training time: 19.470
---------------
2023-09-25 00:05:04.540415
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00727	Per Sample Data Time 0.00157	Per Sample DNN Time 0.00571	Train Loss 0.0441	
start validation
acc: 0.760563
AUC: 0.900774
Avg Precision: 0.486368
Avg Recall: 1.000000
d_prime: 1.818646
train_loss: 0.047451
valid_loss: 1.330798
validation finished
normal learning rate scheduler step
Epoch-21 lr: 2.827689324029246e-06
Epoch-21 lr: 2.827689324029246e-06
epoch 21 training time: 15.254
---------------
2023-09-25 00:05:19.794731
current #epochs=22, #steps=819
start validation
acc: 0.755869
AUC: 0.900817
Avg Precision: 0.486368
Avg Recall: 1.000000
d_prime: 1.818992
train_loss: 0.045892
valid_loss: 1.330922
validation finished
normal learning rate scheduler step
Epoch-22 lr: 2.1929707577673256e-06
Epoch-22 lr: 2.1929707577673256e-06
epoch 22 training time: 15.220
---------------
2023-09-25 00:05:35.015042
current #epochs=23, #steps=858
start validation
acc: 0.755869
AUC: 0.900723
Avg Precision: 0.486368
Avg Recall: 1.000000
d_prime: 1.818228
train_loss: 0.045176
valid_loss: 1.330889
validation finished
normal learning rate scheduler step
Epoch-23 lr: 1.7007245822783531e-06
Epoch-23 lr: 1.7007245822783531e-06
epoch 23 training time: 15.305
---------------
2023-09-25 00:05:50.319670
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01441	Per Sample Data Time 0.00780	Per Sample DNN Time 0.00661	Train Loss 0.0339	
start validation
acc: 0.755869
AUC: 0.900727
Avg Precision: 0.486368
Avg Recall: 1.000000
d_prime: 1.818262
train_loss: 0.051241
valid_loss: 1.330789
validation finished
normal learning rate scheduler step
Epoch-24 lr: 1.3189706677670025e-06
Epoch-24 lr: 1.3189706677670025e-06
epoch 24 training time: 15.333
---------------
2023-09-25 00:06:05.652578
current #epochs=25, #steps=936
start validation
acc: 0.755869
AUC: 0.900735
Avg Precision: 0.486368
Avg Recall: 1.000000
d_prime: 1.818323
train_loss: 0.039768
valid_loss: 1.330738
validation finished
normal learning rate scheduler step
Epoch-25 lr: 1.0229073187730305e-06
Epoch-25 lr: 1.0229073187730305e-06
epoch 25 training time: 15.262
---------------
2023-09-25 00:06:20.913815
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00691	Per Sample Data Time 0.00131	Per Sample DNN Time 0.00560	Train Loss 0.0546	
start validation
acc: 0.755869
AUC: 0.900608
Avg Precision: 0.486368
Avg Recall: 1.000000
d_prime: 1.817301
train_loss: 0.047547
valid_loss: 1.330820
validation finished
normal learning rate scheduler step
Epoch-26 lr: 7.932999636533745e-07
Epoch-26 lr: 7.932999636533745e-07
epoch 26 training time: 15.223
---------------
2023-09-25 00:06:36.137288
current #epochs=27, #steps=1014
start validation
acc: 0.755869
AUC: 0.900630
Avg Precision: 0.486368
Avg Recall: 1.000000
d_prime: 1.817474
train_loss: 0.053903
valid_loss: 1.330821
validation finished
normal learning rate scheduler step
Epoch-27 lr: 6.152315276102586e-07
Epoch-27 lr: 6.152315276102586e-07
epoch 27 training time: 15.205
---------------
2023-09-25 00:06:51.341981
current #epochs=28, #steps=1053
start validation
acc: 0.755869
AUC: 0.900657
Avg Precision: 0.486601
Avg Recall: 1.000000
d_prime: 1.817699
train_loss: 0.051580
valid_loss: 1.330789
validation finished
normal learning rate scheduler step
Epoch-28 lr: 4.771333038041573e-07
Epoch-28 lr: 4.771333038041573e-07
epoch 28 training time: 15.255
---------------
2023-09-25 00:07:06.597163
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00921	Per Sample Data Time 0.00346	Per Sample DNN Time 0.00575	Train Loss 0.0436	
start validation
acc: 0.755869
AUC: 0.900728
Avg Precision: 0.486601
Avg Recall: 1.000000
d_prime: 1.818273
train_loss: 0.045277
valid_loss: 1.330753
validation finished
normal learning rate scheduler step
Epoch-29 lr: 3.7003336042181425e-07
Epoch-29 lr: 3.7003336042181425e-07
epoch 29 training time: 15.899
---------------
2023-09-25 00:07:22.496901
current #epochs=30, #steps=1131
start validation
acc: 0.755869
AUC: 0.900773
Avg Precision: 0.486601
Avg Recall: 1.000000
d_prime: 1.818636
train_loss: 0.041026
valid_loss: 1.330729
validation finished
normal learning rate scheduler step
Epoch-30 lr: 2.869736543925301e-07
Epoch-30 lr: 2.869736543925301e-07
epoch 30 training time: 15.188
---------------
2023-09-25 00:07:37.684531
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00681	Per Sample Data Time 0.00115	Per Sample DNN Time 0.00567	Train Loss 0.0658	
start validation
acc: 0.755869
AUC: 0.900763
Avg Precision: 0.486601
Avg Recall: 1.000000
d_prime: 1.818549
train_loss: 0.060135
valid_loss: 1.330706
validation finished
normal learning rate scheduler step
Epoch-31 lr: 2.2255798293841718e-07
Epoch-31 lr: 2.2255798293841718e-07
epoch 31 training time: 15.365
---------------
2023-09-25 00:07:53.050086
current #epochs=32, #steps=1209
start validation
acc: 0.755869
AUC: 0.900763
Avg Precision: 0.486601
Avg Recall: 1.000000
d_prime: 1.818549
train_loss: 0.049585
valid_loss: 1.330692
validation finished
normal learning rate scheduler step
Epoch-32 lr: 1.726014043848971e-07
Epoch-32 lr: 1.726014043848971e-07
epoch 32 training time: 15.256
---------------
2023-09-25 00:08:08.305879
current #epochs=33, #steps=1248
start validation
acc: 0.755869
AUC: 0.900763
Avg Precision: 0.486601
Avg Recall: 1.000000
d_prime: 1.818549
train_loss: 0.042710
valid_loss: 1.330688
validation finished
normal learning rate scheduler step
Epoch-33 lr: 1.3385835188793094e-07
Epoch-33 lr: 1.3385835188793094e-07
epoch 33 training time: 15.183
---------------
2023-09-25 00:08:23.489290
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00803	Per Sample Data Time 0.00226	Per Sample DNN Time 0.00577	Train Loss 0.0288	
start validation
acc: 0.755869
AUC: 0.900763
Avg Precision: 0.486601
Avg Recall: 1.000000
d_prime: 1.818549
train_loss: 0.039892
valid_loss: 1.330684
validation finished
normal learning rate scheduler step
Epoch-34 lr: 1.0381177623674657e-07
Epoch-34 lr: 1.0381177623674657e-07
epoch 34 training time: 15.202
---------------
2023-09-25 00:08:38.690877
current #epochs=35, #steps=1326
start validation
acc: 0.755869
AUC: 0.900763
Avg Precision: 0.486601
Avg Recall: 1.000000
d_prime: 1.818549
train_loss: 0.034405
valid_loss: 1.330670
validation finished
normal learning rate scheduler step
Epoch-35 lr: 8.050961881295966e-08
Epoch-35 lr: 8.050961881295966e-08
epoch 35 training time: 15.264
---------------
2023-09-25 00:08:53.954482
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00653	Per Sample Data Time 0.00098	Per Sample DNN Time 0.00554	Train Loss 0.0471	
start validation
acc: 0.755869
AUC: 0.900763
Avg Precision: 0.486601
Avg Recall: 1.000000
d_prime: 1.818549
train_loss: 0.046130
valid_loss: 1.330665
validation finished
normal learning rate scheduler step
Epoch-36 lr: 6.24379907210728e-08
Epoch-36 lr: 6.24379907210728e-08
epoch 36 training time: 15.269
---------------
2023-09-25 00:09:09.223436
current #epochs=37, #steps=1404
start validation
acc: 0.755869
AUC: 0.900763
Avg Precision: 0.486601
Avg Recall: 1.000000
d_prime: 1.818549
train_loss: 0.035633
valid_loss: 1.330661
validation finished
normal learning rate scheduler step
Epoch-37 lr: 4.842281882295076e-08
Epoch-37 lr: 4.842281882295076e-08
epoch 37 training time: 15.415
---------------
2023-09-25 00:09:24.638492
current #epochs=38, #steps=1443
start validation
acc: 0.755869
AUC: 0.900763
Avg Precision: 0.486601
Avg Recall: 1.000000
d_prime: 1.818549
train_loss: 0.047701
valid_loss: 1.330661
validation finished
normal learning rate scheduler step
Epoch-38 lr: 3.7553568839763374e-08
Epoch-38 lr: 3.7553568839763374e-08
epoch 38 training time: 15.343
---------------
2023-09-25 00:09:39.981866
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00752	Per Sample Data Time 0.00174	Per Sample DNN Time 0.00577	Train Loss 0.0328	
start validation
acc: 0.755869
AUC: 0.900763
Avg Precision: 0.486601
Avg Recall: 1.000000
d_prime: 1.818549
train_loss: 0.037176
valid_loss: 1.330661
validation finished
normal learning rate scheduler step
Epoch-39 lr: 2.912408998243668e-08
Epoch-39 lr: 2.912408998243668e-08
epoch 39 training time: 15.322
---------------
2023-09-25 00:09:55.303945
current #epochs=40, #steps=1521
start validation
acc: 0.755869
AUC: 0.900763
Avg Precision: 0.486601
Avg Recall: 1.000000
d_prime: 1.818549
train_loss: 0.036598
valid_loss: 1.330661
validation finished
normal learning rate scheduler step
Epoch-40 lr: 2.2586737918952293e-08
Epoch-40 lr: 2.2586737918952293e-08
epoch 40 training time: 15.290
---------------
2023-09-25 00:10:10.594408
current #epochs=41, #steps=1560
start validation
[I 2023-09-25 00:10:25,790] Trial 88 finished with value: 0.48660088032038723 and parameters: {'warmup': 'True', 'num_epochs': 41, 'batch_size': 37, 'lr-adaptschedule': 'True', 'lr': 0.00021291789729349615, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7755345465754725}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.755869
AUC: 0.900763
Avg Precision: 0.486601
Avg Recall: 1.000000
d_prime: 1.818549
train_loss: 0.039639
valid_loss: 1.330662
validation finished
normal learning rate scheduler step
Epoch-41 lr: 1.7516795550593698e-08
Epoch-41 lr: 1.7516795550593698e-08
epoch 41 training time: 15.182
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa609e93ac0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.766 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-25 00:10:25.829003
current #epochs=1, #steps=0
start validation
acc: 0.732394
AUC: 0.900363
Avg Precision: 0.486863
Avg Recall: 1.000000
d_prime: 1.815313
train_loss: 0.037699
valid_loss: 1.333303
validation finished
normal learning rate scheduler step
Epoch-1 lr: 9.36769205272394e-05
Epoch-1 lr: 0.0001873538410544788
epoch 1 training time: 17.773
---------------
2023-09-25 00:10:43.602013
current #epochs=2, #steps=39
start validation
acc: 0.741784
AUC: 0.899535
Avg Precision: 0.484783
Avg Recall: 1.000000
d_prime: 1.808651
train_loss: 0.040535
valid_loss: 1.332531
validation finished
normal learning rate scheduler step
Epoch-2 lr: 9.36769205272394e-05
Epoch-2 lr: 0.0001873538410544788
epoch 2 training time: 17.573
---------------
2023-09-25 00:11:01.175472
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00561	Train Loss 0.0547	
start validation
acc: 0.751174
AUC: 0.898438
Avg Precision: 0.484271
Avg Recall: 1.000000
d_prime: 1.799869
train_loss: 0.042720
valid_loss: 1.337241
validation finished
normal learning rate scheduler step
Epoch-3 lr: 9.36769205272394e-05
Epoch-3 lr: 0.0001873538410544788
epoch 3 training time: 17.657
---------------
2023-09-25 00:11:18.832991
current #epochs=4, #steps=117
start validation
acc: 0.732394
AUC: 0.897022
Avg Precision: 0.482932
Avg Recall: 1.000000
d_prime: 1.788649
train_loss: 0.039900
valid_loss: 1.334579
validation finished
normal learning rate scheduler step
Epoch-4 lr: 9.36769205272394e-05
Epoch-4 lr: 0.0001873538410544788
epoch 4 training time: 15.265
---------------
2023-09-25 00:11:34.098004
current #epochs=5, #steps=156
start validation
acc: 0.732394
AUC: 0.898285
Avg Precision: 0.474195
Avg Recall: 1.000000
d_prime: 1.798655
train_loss: 0.040159
valid_loss: 1.330720
validation finished
normal learning rate scheduler step
Epoch-5 lr: 9.36769205272394e-05
Epoch-5 lr: 0.0001873538410544788
epoch 5 training time: 15.145
---------------
2023-09-25 00:11:49.242767
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01121	Per Sample Data Time 0.00522	Per Sample DNN Time 0.00598	Train Loss 0.0618	
start validation
acc: 0.732394
AUC: 0.898856
Avg Precision: 0.474549
Avg Recall: 1.000000
d_prime: 1.803206
train_loss: 0.036699
valid_loss: 1.329036
validation finished
normal learning rate scheduler step
Epoch-6 lr: 7.173627249341132e-05
Epoch-6 lr: 0.00014347254498682264
epoch 6 training time: 17.161
---------------
2023-09-25 00:12:06.403480
current #epochs=7, #steps=234
start validation
acc: 0.732394
AUC: 0.898530
Avg Precision: 0.465860
Avg Recall: 1.000000
d_prime: 1.800606
train_loss: 0.054158
valid_loss: 1.327092
validation finished
normal learning rate scheduler step
Epoch-7 lr: 7.173627249341132e-05
Epoch-7 lr: 0.00014347254498682264
epoch 7 training time: 15.165
---------------
2023-09-25 00:12:21.568871
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00692	Per Sample Data Time 0.00122	Per Sample DNN Time 0.00570	Train Loss 0.0488	
start validation
acc: 0.732394
AUC: 0.895563
Avg Precision: 0.463724
Avg Recall: 1.000000
d_prime: 1.777196
train_loss: 0.048481
valid_loss: 1.330886
validation finished
normal learning rate scheduler step
Epoch-8 lr: 5.493447865584543e-05
Epoch-8 lr: 0.00010986895731169086
epoch 8 training time: 19.076
---------------
2023-09-25 00:12:40.644468
current #epochs=9, #steps=312
start validation
acc: 0.737089
AUC: 0.893832
Avg Precision: 0.462426
Avg Recall: 1.000000
d_prime: 1.763761
train_loss: 0.061439
valid_loss: 1.333331
validation finished
normal learning rate scheduler step
Epoch-9 lr: 5.493447865584543e-05
Epoch-9 lr: 0.00010986895731169086
epoch 9 training time: 18.093
---------------
2023-09-25 00:12:58.737308
current #epochs=10, #steps=351
start validation
acc: 0.746479
AUC: 0.894876
Avg Precision: 0.462301
Avg Recall: 1.000000
d_prime: 1.771849
train_loss: 0.047892
valid_loss: 1.331502
validation finished
normal learning rate scheduler step
Epoch-10 lr: 4.206793634930933e-05
Epoch-10 lr: 8.413587269861866e-05
epoch 10 training time: 17.272
---------------
2023-09-25 00:13:16.009560
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00883	Per Sample Data Time 0.00304	Per Sample DNN Time 0.00579	Train Loss 0.0176	
start validation
acc: 0.741784
AUC: 0.893171
Avg Precision: 0.462391
Avg Recall: 1.000000
d_prime: 1.758671
train_loss: 0.034951
valid_loss: 1.332722
validation finished
normal learning rate scheduler step
Epoch-11 lr: 4.206793634930933e-05
Epoch-11 lr: 8.413587269861866e-05
epoch 11 training time: 15.340
---------------
2023-09-25 00:13:31.349655
current #epochs=12, #steps=429
start validation
acc: 0.741784
AUC: 0.893630
Avg Precision: 0.463612
Avg Recall: 1.000000
d_prime: 1.762202
train_loss: 0.043407
valid_loss: 1.333615
validation finished
normal learning rate scheduler step
Epoch-12 lr: 3.221494609562898e-05
Epoch-12 lr: 6.442989219125796e-05
epoch 12 training time: 15.373
---------------
2023-09-25 00:13:46.722631
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00663	Per Sample Data Time 0.00105	Per Sample DNN Time 0.00559	Train Loss 0.0403	
start validation
acc: 0.746479
AUC: 0.893539
Avg Precision: 0.462750
Avg Recall: 1.000000
d_prime: 1.761502
train_loss: 0.040227
valid_loss: 1.333065
validation finished
normal learning rate scheduler step
Epoch-13 lr: 3.221494609562898e-05
Epoch-13 lr: 6.442989219125796e-05
epoch 13 training time: 15.179
---------------
2023-09-25 00:14:01.901730
current #epochs=14, #steps=507
start validation
acc: 0.746479
AUC: 0.894093
Avg Precision: 0.463458
Avg Recall: 1.000000
d_prime: 1.765780
train_loss: 0.038673
valid_loss: 1.332210
validation finished
normal learning rate scheduler step
Epoch-14 lr: 2.4669685323447518e-05
Epoch-14 lr: 4.9339370646895035e-05
epoch 14 training time: 15.123
---------------
2023-09-25 00:14:17.025109
current #epochs=15, #steps=546
start validation
acc: 0.746479
AUC: 0.894179
Avg Precision: 0.463458
Avg Recall: 1.000000
d_prime: 1.766444
train_loss: 0.039356
valid_loss: 1.332414
validation finished
normal learning rate scheduler step
Epoch-15 lr: 2.4669685323447518e-05
Epoch-15 lr: 4.9339370646895035e-05
epoch 15 training time: 15.294
---------------
2023-09-25 00:14:32.319037
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00776	Per Sample Data Time 0.00203	Per Sample DNN Time 0.00573	Train Loss 0.0527	
start validation
acc: 0.741784
AUC: 0.894218
Avg Precision: 0.463032
Avg Recall: 1.000000
d_prime: 1.766746
train_loss: 0.056304
valid_loss: 1.333020
validation finished
normal learning rate scheduler step
Epoch-16 lr: 1.889164650939763e-05
Epoch-16 lr: 3.778329301879526e-05
epoch 16 training time: 15.213
---------------
2023-09-25 00:14:47.532261
current #epochs=17, #steps=624
start validation
acc: 0.746479
AUC: 0.894310
Avg Precision: 0.462447
Avg Recall: 1.000000
d_prime: 1.767453
train_loss: 0.039803
valid_loss: 1.332961
validation finished
normal learning rate scheduler step
Epoch-17 lr: 1.889164650939763e-05
Epoch-17 lr: 3.778329301879526e-05
epoch 17 training time: 15.296
---------------
2023-09-25 00:15:02.827749
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00652	Per Sample Data Time 0.00095	Per Sample DNN Time 0.00557	Train Loss 0.0528	
start validation
acc: 0.746479
AUC: 0.894328
Avg Precision: 0.462103
Avg Recall: 1.000000
d_prime: 1.767593
train_loss: 0.051520
valid_loss: 1.333209
validation finished
normal learning rate scheduler step
Epoch-18 lr: 1.4466917723381833e-05
Epoch-18 lr: 2.8933835446763665e-05
epoch 18 training time: 15.730
---------------
2023-09-25 00:15:18.557377
current #epochs=19, #steps=702
start validation
acc: 0.746479
AUC: 0.894569
Avg Precision: 0.462206
Avg Recall: 1.000000
d_prime: 1.769465
train_loss: 0.036294
valid_loss: 1.332996
validation finished
normal learning rate scheduler step
Epoch-19 lr: 1.4466917723381833e-05
Epoch-19 lr: 2.8933835446763665e-05
epoch 19 training time: 32.422
---------------
2023-09-25 00:15:50.979669
current #epochs=20, #steps=741
start validation
acc: 0.746479
AUC: 0.894407
Avg Precision: 0.462206
Avg Recall: 1.000000
d_prime: 1.768206
train_loss: 0.048958
valid_loss: 1.332545
validation finished
normal learning rate scheduler step
Epoch-20 lr: 1.1078531895617856e-05
Epoch-20 lr: 2.2157063791235713e-05
epoch 20 training time: 16.614
---------------
2023-09-25 00:16:07.594102
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00560	Train Loss 0.0416	
start validation
acc: 0.741784
AUC: 0.894119
Avg Precision: 0.462051
Avg Recall: 1.000000
d_prime: 1.765979
train_loss: 0.043672
valid_loss: 1.332223
validation finished
normal learning rate scheduler step
Epoch-21 lr: 1.1078531895617856e-05
Epoch-21 lr: 2.2157063791235713e-05
epoch 21 training time: 15.066
---------------
2023-09-25 00:16:22.660173
current #epochs=22, #steps=819
start validation
acc: 0.741784
AUC: 0.894289
Avg Precision: 0.462051
Avg Recall: 1.000000
d_prime: 1.767291
train_loss: 0.043037
valid_loss: 1.332295
validation finished
normal learning rate scheduler step
Epoch-22 lr: 8.483760764316528e-06
Epoch-22 lr: 1.6967521528633056e-05
epoch 22 training time: 16.058
---------------
2023-09-25 00:16:38.718414
current #epochs=23, #steps=858
start validation
acc: 0.737089
AUC: 0.894373
Avg Precision: 0.462534
Avg Recall: 1.000000
d_prime: 1.767940
train_loss: 0.030931
valid_loss: 1.331939
validation finished
normal learning rate scheduler step
Epoch-23 lr: 8.483760764316528e-06
Epoch-23 lr: 1.6967521528633056e-05
epoch 23 training time: 15.330
---------------
2023-09-25 00:16:54.048357
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01440	Per Sample Data Time 0.00788	Per Sample DNN Time 0.00652	Train Loss 0.0360	
start validation
acc: 0.737089
AUC: 0.894558
Avg Precision: 0.462760
Avg Recall: 1.000000
d_prime: 1.769380
train_loss: 0.038679
valid_loss: 1.331855
validation finished
normal learning rate scheduler step
Epoch-24 lr: 6.496726947604507e-06
Epoch-24 lr: 1.2993453895209013e-05
epoch 24 training time: 15.304
---------------
2023-09-25 00:17:09.352876
current #epochs=25, #steps=936
start validation
acc: 0.741784
AUC: 0.895096
Avg Precision: 0.462976
Avg Recall: 1.000000
d_prime: 1.773559
train_loss: 0.046290
valid_loss: 1.331277
validation finished
normal learning rate scheduler step
Epoch-25 lr: 6.496726947604507e-06
Epoch-25 lr: 1.2993453895209013e-05
epoch 25 training time: 16.698
---------------
2023-09-25 00:17:26.051045
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00701	Per Sample Data Time 0.00136	Per Sample DNN Time 0.00565	Train Loss 0.0512	
start validation
acc: 0.741784
AUC: 0.895272
Avg Precision: 0.463087
Avg Recall: 1.000000
d_prime: 1.774930
train_loss: 0.044854
valid_loss: 1.330963
validation finished
normal learning rate scheduler step
Epoch-26 lr: 4.97508854908533e-06
Epoch-26 lr: 9.95017709817066e-06
epoch 26 training time: 15.321
---------------
2023-09-25 00:17:41.372059
current #epochs=27, #steps=1014
start validation
acc: 0.741784
AUC: 0.895379
Avg Precision: 0.462976
Avg Recall: 1.000000
d_prime: 1.775761
train_loss: 0.038125
valid_loss: 1.331007
validation finished
normal learning rate scheduler step
Epoch-27 lr: 4.97508854908533e-06
Epoch-27 lr: 9.95017709817066e-06
epoch 27 training time: 15.532
---------------
2023-09-25 00:17:56.904025
current #epochs=28, #steps=1053
start validation
acc: 0.741784
AUC: 0.895446
Avg Precision: 0.462976
Avg Recall: 1.000000
d_prime: 1.776280
train_loss: 0.041682
valid_loss: 1.330858
validation finished
normal learning rate scheduler step
Epoch-28 lr: 3.809842443873438e-06
Epoch-28 lr: 7.619684887746876e-06
epoch 28 training time: 15.212
---------------
2023-09-25 00:18:12.115892
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00974	Per Sample Data Time 0.00379	Per Sample DNN Time 0.00595	Train Loss 0.0479	
start validation
acc: 0.741784
AUC: 0.895559
Avg Precision: 0.462976
Avg Recall: 1.000000
d_prime: 1.777163
train_loss: 0.050901
valid_loss: 1.330709
validation finished
normal learning rate scheduler step
Epoch-29 lr: 3.809842443873438e-06
Epoch-29 lr: 7.619684887746876e-06
epoch 29 training time: 15.294
---------------
2023-09-25 00:18:27.410329
current #epochs=30, #steps=1131
start validation
acc: 0.737089
AUC: 0.895564
Avg Precision: 0.462976
Avg Recall: 1.000000
d_prime: 1.777201
train_loss: 0.048813
valid_loss: 1.330515
validation finished
normal learning rate scheduler step
Epoch-30 lr: 2.9175157997555833e-06
Epoch-30 lr: 5.835031599511167e-06
epoch 30 training time: 15.252
---------------
2023-09-25 00:18:42.661989
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00669	Per Sample Data Time 0.00110	Per Sample DNN Time 0.00559	Train Loss 0.0486	
start validation
acc: 0.741784
AUC: 0.895598
Avg Precision: 0.462976
Avg Recall: 1.000000
d_prime: 1.777472
train_loss: 0.050009
valid_loss: 1.330310
validation finished
normal learning rate scheduler step
Epoch-31 lr: 2.9175157997555833e-06
Epoch-31 lr: 5.835031599511167e-06
epoch 31 training time: 15.123
---------------
2023-09-25 00:18:57.785058
current #epochs=32, #steps=1209
start validation
acc: 0.737089
AUC: 0.895762
Avg Precision: 0.463358
Avg Recall: 1.000000
d_prime: 1.778748
train_loss: 0.059098
valid_loss: 1.330315
validation finished
normal learning rate scheduler step
Epoch-32 lr: 2.2341864702335244e-06
Epoch-32 lr: 4.468372940467049e-06
epoch 32 training time: 15.309
---------------
2023-09-25 00:19:13.094068
current #epochs=33, #steps=1248
start validation
acc: 0.737089
AUC: 0.895776
Avg Precision: 0.463358
Avg Recall: 1.000000
d_prime: 1.778863
train_loss: 0.030403
valid_loss: 1.330379
validation finished
normal learning rate scheduler step
Epoch-33 lr: 2.2341864702335244e-06
Epoch-33 lr: 4.468372940467049e-06
epoch 33 training time: 15.151
---------------
2023-09-25 00:19:28.244809
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00796	Per Sample Data Time 0.00237	Per Sample DNN Time 0.00559	Train Loss 0.0570	
start validation
acc: 0.737089
AUC: 0.895759
Avg Precision: 0.463358
Avg Recall: 1.000000
d_prime: 1.778730
train_loss: 0.044239
valid_loss: 1.330284
validation finished
normal learning rate scheduler step
Epoch-34 lr: 1.7109039081100122e-06
Epoch-34 lr: 3.4218078162200244e-06
epoch 34 training time: 15.151
---------------
2023-09-25 00:19:43.396159
current #epochs=35, #steps=1326
start validation
acc: 0.737089
AUC: 0.895751
Avg Precision: 0.462976
Avg Recall: 1.000000
d_prime: 1.778663
train_loss: 0.038680
valid_loss: 1.330308
validation finished
normal learning rate scheduler step
Epoch-35 lr: 1.7109039081100122e-06
Epoch-35 lr: 3.4218078162200244e-06
epoch 35 training time: 15.235
---------------
2023-09-25 00:19:58.631276
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00657	Per Sample Data Time 0.00092	Per Sample DNN Time 0.00564	Train Loss 0.0449	
start validation
acc: 0.737089
AUC: 0.895731
Avg Precision: 0.463358
Avg Recall: 1.000000
d_prime: 1.778513
train_loss: 0.045603
valid_loss: 1.330286
validation finished
normal learning rate scheduler step
Epoch-36 lr: 1.3101825750829802e-06
Epoch-36 lr: 2.6203651501659604e-06
epoch 36 training time: 15.151
---------------
2023-09-25 00:20:13.781729
current #epochs=37, #steps=1404
start validation
acc: 0.732394
AUC: 0.895925
Avg Precision: 0.463358
Avg Recall: 1.000000
d_prime: 1.780024
train_loss: 0.043974
valid_loss: 1.330288
validation finished
normal learning rate scheduler step
Epoch-37 lr: 1.3101825750829802e-06
Epoch-37 lr: 2.6203651501659604e-06
epoch 37 training time: 15.992
---------------
2023-09-25 00:20:29.773399
current #epochs=38, #steps=1443
start validation
acc: 0.732394
AUC: 0.896003
Avg Precision: 0.462976
Avg Recall: 1.000000
d_prime: 1.780634
train_loss: 0.049703
valid_loss: 1.330278
validation finished
normal learning rate scheduler step
Epoch-38 lr: 1.0033166514578397e-06
Epoch-38 lr: 2.0066333029156793e-06
epoch 38 training time: 15.142
---------------
2023-09-25 00:20:44.915214
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00738	Per Sample Data Time 0.00174	Per Sample DNN Time 0.00563	Train Loss 0.0456	
start validation
acc: 0.732394
AUC: 0.896017
Avg Precision: 0.462976
Avg Recall: 1.000000
d_prime: 1.780751
train_loss: 0.046229
valid_loss: 1.330248
validation finished
normal learning rate scheduler step
Epoch-39 lr: 1.0033166514578397e-06
Epoch-39 lr: 2.0066333029156793e-06
epoch 39 training time: 15.227
---------------
2023-09-25 00:21:00.142160
current #epochs=40, #steps=1521
start validation
acc: 0.732394
AUC: 0.896032
Avg Precision: 0.462976
Avg Recall: 1.000000
d_prime: 1.780868
train_loss: 0.045303
valid_loss: 1.330260
validation finished
normal learning rate scheduler step
Epoch-40 lr: 7.683236842230302e-07
Epoch-40 lr: 1.5366473684460604e-06
epoch 40 training time: 16.339
---------------
2023-09-25 00:21:16.481353
current #epochs=41, #steps=1560
start validation
acc: 0.732394
AUC: 0.895973
Avg Precision: 0.462976
Avg Recall: 1.000000
d_prime: 1.780400
train_loss: 0.054997
valid_loss: 1.330252
validation finished
normal learning rate scheduler step
Epoch-41 lr: 7.683236842230302e-07
Epoch-41 lr: 1.5366473684460604e-06
epoch 41 training time: 15.213
---------------
2023-09-25 00:21:31.694764
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02221	Per Sample Data Time 0.01531	Per Sample DNN Time 0.00690	Train Loss 0.0791	
start validation
acc: 0.732394
AUC: 0.895977
Avg Precision: 0.462976
Avg Recall: 1.000000
d_prime: 1.780433
train_loss: 0.029215
valid_loss: 1.330299
validation finished
normal learning rate scheduler step
Epoch-42 lr: 5.883698659643509e-07
Epoch-42 lr: 1.1767397319287019e-06
epoch 42 training time: 15.169
---------------
2023-09-25 00:21:46.863456
current #epochs=43, #steps=1638
start validation
acc: 0.732394
AUC: 0.895977
Avg Precision: 0.462976
Avg Recall: 1.000000
d_prime: 1.780433
train_loss: 0.035015
valid_loss: 1.330284
validation finished
normal learning rate scheduler step
Epoch-43 lr: 5.883698659643509e-07
Epoch-43 lr: 1.1767397319287019e-06
epoch 43 training time: 15.159
---------------
2023-09-25 00:22:02.021988
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00704	Per Sample Data Time 0.00137	Per Sample DNN Time 0.00567	Train Loss 0.0476	
start validation
acc: 0.732394
AUC: 0.895991
Avg Precision: 0.462976
Avg Recall: 1.000000
d_prime: 1.780542
train_loss: 0.047246
valid_loss: 1.330262
validation finished
normal learning rate scheduler step
Epoch-44 lr: 4.505641388954228e-07
Epoch-44 lr: 9.011282777908456e-07
epoch 44 training time: 15.130
---------------
2023-09-25 00:22:17.152517
current #epochs=45, #steps=1716
start validation
acc: 0.732394
AUC: 0.895983
Avg Precision: 0.462976
Avg Recall: 1.000000
d_prime: 1.780483
train_loss: 0.041495
valid_loss: 1.330252
validation finished
normal learning rate scheduler step
Epoch-45 lr: 4.505641388954228e-07
Epoch-45 lr: 9.011282777908456e-07
epoch 45 training time: 15.229
---------------
2023-09-25 00:22:32.381352
current #epochs=46, #steps=1755
start validation
acc: 0.732394
AUC: 0.895990
Avg Precision: 0.462976
Avg Recall: 1.000000
d_prime: 1.780534
train_loss: 0.036949
valid_loss: 1.330223
validation finished
normal learning rate scheduler step
Epoch-46 lr: 3.4503473920412165e-07
Epoch-46 lr: 6.900694784082433e-07
epoch 46 training time: 15.252
---------------
2023-09-25 00:22:47.633097
current #epochs=47, #steps=1794
Epoch: [47][6/39]	Per Sample Total Time 0.01060	Per Sample Data Time 0.00462	Per Sample DNN Time 0.00597	Train Loss 0.0537	
start validation
acc: 0.732394
AUC: 0.895939
Avg Precision: 0.462976
Avg Recall: 1.000000
d_prime: 1.780133
train_loss: 0.049953
valid_loss: 1.330214
validation finished
normal learning rate scheduler step
Epoch-47 lr: 3.4503473920412165e-07
Epoch-47 lr: 6.900694784082433e-07
epoch 47 training time: 15.286
---------------
2023-09-25 00:23:02.918984
current #epochs=48, #steps=1833
start validation
acc: 0.732394
AUC: 0.895974
Avg Precision: 0.462976
Avg Recall: 1.000000
d_prime: 1.780410
train_loss: 0.049188
valid_loss: 1.330199
validation finished
normal learning rate scheduler step
Epoch-48 lr: 2.6422202963047587e-07
Epoch-48 lr: 5.284440592609517e-07
epoch 48 training time: 15.218
---------------
2023-09-25 00:23:18.137353
current #epochs=49, #steps=1872
Epoch: [49][28/39]	Per Sample Total Time 0.00685	Per Sample Data Time 0.00122	Per Sample DNN Time 0.00563	Train Loss 0.0352	
start validation
[I 2023-09-25 00:23:33,511] Trial 89 finished with value: 0.4629761564866164 and parameters: {'warmup': 'True', 'num_epochs': 49, 'batch_size': 42, 'lr-adaptschedule': 'True', 'lr': 9.36769205272394e-05, 'head-lr': 2, 'lr-scheduler-start': 6, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.765783846113428}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.732394
AUC: 0.895987
Avg Precision: 0.462976
Avg Recall: 1.000000
d_prime: 1.780511
train_loss: 0.040554
valid_loss: 1.330187
validation finished
normal learning rate scheduler step
Epoch-49 lr: 2.6422202963047587e-07
Epoch-49 lr: 5.284440592609517e-07
epoch 49 training time: 15.359
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67ec7d5b0>
The learning rate scheduler starts at 7 epoch with decay rate of 0.792 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-25 00:23:33.551275
current #epochs=1, #steps=0
start validation
acc: 0.746479
AUC: 0.894135
Avg Precision: 0.477858
Avg Recall: 1.000000
d_prime: 1.766104
train_loss: 0.043700
valid_loss: 1.334957
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.00036736785453534175
Epoch-1 lr: 0.00036736785453534175
epoch 1 training time: 17.575
---------------
2023-09-25 00:23:51.126966
current #epochs=2, #steps=39
start validation
acc: 0.718310
AUC: 0.889561
Avg Precision: 0.427833
Avg Recall: 1.000000
d_prime: 1.731277
train_loss: 0.053090
valid_loss: 1.331526
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.00036736785453534175
Epoch-2 lr: 0.00036736785453534175
epoch 2 training time: 15.359
---------------
2023-09-25 00:24:06.485610
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00709	Per Sample Data Time 0.00149	Per Sample DNN Time 0.00560	Train Loss 0.0549	
start validation
acc: 0.741784
AUC: 0.886419
Avg Precision: 0.462692
Avg Recall: 1.000000
d_prime: 1.707946
train_loss: 0.060301
valid_loss: 1.332368
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.00036736785453534175
Epoch-3 lr: 0.00036736785453534175
epoch 3 training time: 15.216
---------------
2023-09-25 00:24:21.701986
current #epochs=4, #steps=117
start validation
acc: 0.732394
AUC: 0.881025
Avg Precision: 0.462515
Avg Recall: 1.000000
d_prime: 1.668948
train_loss: 0.046737
valid_loss: 1.334472
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00036736785453534175
Epoch-4 lr: 0.00036736785453534175
epoch 4 training time: 16.559
---------------
2023-09-25 00:24:38.261052
current #epochs=5, #steps=156
start validation
acc: 0.737089
AUC: 0.883282
Avg Precision: 0.458984
Avg Recall: 1.000000
d_prime: 1.685112
train_loss: 0.035492
valid_loss: 1.337225
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00036736785453534175
Epoch-5 lr: 0.00036736785453534175
epoch 5 training time: 15.247
---------------
2023-09-25 00:24:53.508351
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01121	Per Sample Data Time 0.00535	Per Sample DNN Time 0.00586	Train Loss 0.0503	
start validation
acc: 0.713615
AUC: 0.890598
Avg Precision: 0.455011
Avg Recall: 1.000000
d_prime: 1.739081
train_loss: 0.046385
valid_loss: 1.329200
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00036736785453534175
Epoch-6 lr: 0.00036736785453534175
epoch 6 training time: 15.281
---------------
2023-09-25 00:25:08.789217
current #epochs=7, #steps=234
start validation
acc: 0.755869
AUC: 0.898218
Avg Precision: 0.460495
Avg Recall: 1.000000
d_prime: 1.798117
train_loss: 0.055168
valid_loss: 1.315628
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00029077570010229976
Epoch-7 lr: 0.00029077570010229976
epoch 7 training time: 17.642
---------------
2023-09-25 00:25:26.431098
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00682	Per Sample Data Time 0.00122	Per Sample DNN Time 0.00560	Train Loss 0.0448	
start validation
acc: 0.727700
AUC: 0.898549
Avg Precision: 0.462469
Avg Recall: 1.000000
d_prime: 1.800758
train_loss: 0.043667
valid_loss: 1.315741
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00029077570010229976
Epoch-8 lr: 0.00029077570010229976
epoch 8 training time: 15.165
---------------
2023-09-25 00:25:41.596457
current #epochs=9, #steps=312
start validation
acc: 0.708920
AUC: 0.892794
Avg Precision: 0.452402
Avg Recall: 1.000000
d_prime: 1.755782
train_loss: 0.043958
valid_loss: 1.322038
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00023015216689801203
Epoch-9 lr: 0.00023015216689801203
epoch 9 training time: 16.731
---------------
2023-09-25 00:25:58.327538
current #epochs=10, #steps=351
start validation
acc: 0.708920
AUC: 0.886552
Avg Precision: 0.463762
Avg Recall: 1.000000
d_prime: 1.708929
train_loss: 0.042336
valid_loss: 1.325780
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00023015216689801203
Epoch-10 lr: 0.00023015216689801203
epoch 10 training time: 15.127
---------------
2023-09-25 00:26:13.454905
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00870	Per Sample Data Time 0.00292	Per Sample DNN Time 0.00578	Train Loss 0.0406	
start validation
acc: 0.727700
AUC: 0.887660
Avg Precision: 0.463001
Avg Recall: 1.000000
d_prime: 1.717107
train_loss: 0.054707
valid_loss: 1.329450
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00018216797314636208
Epoch-11 lr: 0.00018216797314636208
epoch 11 training time: 16.277
---------------
2023-09-25 00:26:29.731686
current #epochs=12, #steps=429
start validation
acc: 0.727700
AUC: 0.895452
Avg Precision: 0.474151
Avg Recall: 1.000000
d_prime: 1.776328
train_loss: 0.043265
valid_loss: 1.317335
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00018216797314636208
Epoch-12 lr: 0.00018216797314636208
epoch 12 training time: 15.359
---------------
2023-09-25 00:26:45.091142
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00666	Per Sample Data Time 0.00108	Per Sample DNN Time 0.00558	Train Loss 0.0460	
start validation
acc: 0.727700
AUC: 0.895697
Avg Precision: 0.474808
Avg Recall: 1.000000
d_prime: 1.778241
train_loss: 0.045265
valid_loss: 1.319374
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.0001441879556795967
Epoch-13 lr: 0.0001441879556795967
epoch 13 training time: 15.307
---------------
2023-09-25 00:27:00.397821
current #epochs=14, #steps=507
start validation
acc: 0.732394
AUC: 0.895750
Avg Precision: 0.468148
Avg Recall: 1.000000
d_prime: 1.778656
train_loss: 0.049469
valid_loss: 1.325358
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0001441879556795967
Epoch-14 lr: 0.0001441879556795967
epoch 14 training time: 15.261
---------------
2023-09-25 00:27:15.659215
current #epochs=15, #steps=546
start validation
acc: 0.732394
AUC: 0.895286
Avg Precision: 0.460722
Avg Recall: 1.000000
d_prime: 1.775040
train_loss: 0.053263
valid_loss: 1.320797
validation finished
normal learning rate scheduler step
Epoch-15 lr: 0.00011412635384792677
Epoch-15 lr: 0.00011412635384792677
epoch 15 training time: 16.684
---------------
2023-09-25 00:27:32.342960
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00765	Per Sample Data Time 0.00197	Per Sample DNN Time 0.00568	Train Loss 0.0309	
start validation
acc: 0.727700
AUC: 0.894348
Avg Precision: 0.459580
Avg Recall: 1.000000
d_prime: 1.767749
train_loss: 0.028227
valid_loss: 1.318540
validation finished
normal learning rate scheduler step
Epoch-16 lr: 0.00011412635384792677
Epoch-16 lr: 0.00011412635384792677
epoch 16 training time: 15.056
---------------
2023-09-25 00:27:47.399424
current #epochs=17, #steps=624
start validation
acc: 0.727700
AUC: 0.890864
Avg Precision: 0.471005
Avg Recall: 1.000000
d_prime: 1.741090
train_loss: 0.042353
valid_loss: 1.320383
validation finished
normal learning rate scheduler step
Epoch-17 lr: 9.033226514123652e-05
Epoch-17 lr: 9.033226514123652e-05
epoch 17 training time: 15.210
---------------
2023-09-25 00:28:02.609391
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00653	Per Sample Data Time 0.00095	Per Sample DNN Time 0.00558	Train Loss 0.0582	
start validation
acc: 0.727700
AUC: 0.889803
Avg Precision: 0.469960
Avg Recall: 1.000000
d_prime: 1.733092
train_loss: 0.057338
valid_loss: 1.324948
validation finished
normal learning rate scheduler step
Epoch-18 lr: 9.033226514123652e-05
Epoch-18 lr: 9.033226514123652e-05
epoch 18 training time: 15.339
---------------
2023-09-25 00:28:17.947993
current #epochs=19, #steps=702
start validation
acc: 0.727700
AUC: 0.889764
Avg Precision: 0.470025
Avg Recall: 1.000000
d_prime: 1.732800
train_loss: 0.040191
valid_loss: 1.325358
validation finished
normal learning rate scheduler step
Epoch-19 lr: 7.149898205299485e-05
Epoch-19 lr: 7.149898205299485e-05
epoch 19 training time: 29.106
---------------
2023-09-25 00:28:47.054162
current #epochs=20, #steps=741
start validation
acc: 0.741784
AUC: 0.889522
Avg Precision: 0.460580
Avg Recall: 1.000000
d_prime: 1.730984
train_loss: 0.052710
valid_loss: 1.323588
validation finished
normal learning rate scheduler step
Epoch-20 lr: 7.149898205299485e-05
Epoch-20 lr: 7.149898205299485e-05
epoch 20 training time: 15.279
---------------
2023-09-25 00:29:02.332853
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00728	Per Sample Data Time 0.00166	Per Sample DNN Time 0.00562	Train Loss 0.0379	
start validation
acc: 0.741784
AUC: 0.889326
Avg Precision: 0.463076
Avg Recall: 1.000000
d_prime: 1.729518
train_loss: 0.036092
valid_loss: 1.324893
validation finished
normal learning rate scheduler step
Epoch-21 lr: 5.6592231210205884e-05
Epoch-21 lr: 5.6592231210205884e-05
epoch 21 training time: 15.237
---------------
2023-09-25 00:29:17.569934
current #epochs=22, #steps=819
start validation
acc: 0.727700
AUC: 0.888539
Avg Precision: 0.463202
Avg Recall: 1.000000
d_prime: 1.723637
train_loss: 0.035948
valid_loss: 1.324993
validation finished
normal learning rate scheduler step
Epoch-22 lr: 5.6592231210205884e-05
Epoch-22 lr: 5.6592231210205884e-05
epoch 22 training time: 15.022
---------------
2023-09-25 00:29:32.591934
current #epochs=23, #steps=858
start validation
acc: 0.723005
AUC: 0.889850
Avg Precision: 0.465838
Avg Recall: 1.000000
d_prime: 1.733442
train_loss: 0.053307
valid_loss: 1.325674
validation finished
normal learning rate scheduler step
Epoch-23 lr: 4.479337385496738e-05
Epoch-23 lr: 4.479337385496738e-05
epoch 23 training time: 15.241
---------------
2023-09-25 00:29:47.833142
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01383	Per Sample Data Time 0.00764	Per Sample DNN Time 0.00620	Train Loss 0.0403	
start validation
acc: 0.727700
AUC: 0.891096
Avg Precision: 0.465614
Avg Recall: 1.000000
d_prime: 1.742847
train_loss: 0.045306
valid_loss: 1.325438
validation finished
normal learning rate scheduler step
Epoch-24 lr: 4.479337385496738e-05
Epoch-24 lr: 4.479337385496738e-05
epoch 24 training time: 15.245
---------------
2023-09-25 00:30:03.077935
current #epochs=25, #steps=936
start validation
acc: 0.732394
AUC: 0.891888
Avg Precision: 0.465474
Avg Recall: 1.000000
d_prime: 1.748861
train_loss: 0.038728
valid_loss: 1.326242
validation finished
normal learning rate scheduler step
Epoch-25 lr: 3.545444840049054e-05
Epoch-25 lr: 3.545444840049054e-05
epoch 25 training time: 15.069
---------------
2023-09-25 00:30:18.147397
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00694	Per Sample Data Time 0.00129	Per Sample DNN Time 0.00566	Train Loss 0.0389	
start validation
acc: 0.727700
AUC: 0.892168
Avg Precision: 0.466452
Avg Recall: 1.000000
d_prime: 1.750993
train_loss: 0.037149
valid_loss: 1.325785
validation finished
normal learning rate scheduler step
Epoch-26 lr: 3.545444840049054e-05
Epoch-26 lr: 3.545444840049054e-05
epoch 26 training time: 15.163
---------------
2023-09-25 00:30:33.310813
current #epochs=27, #steps=1014
start validation
acc: 0.727700
AUC: 0.892597
Avg Precision: 0.466879
Avg Recall: 1.000000
d_prime: 1.754274
train_loss: 0.044285
valid_loss: 1.325674
validation finished
normal learning rate scheduler step
Epoch-27 lr: 2.806258611938982e-05
Epoch-27 lr: 2.806258611938982e-05
epoch 27 training time: 15.218
---------------
2023-09-25 00:30:48.528753
current #epochs=28, #steps=1053
start validation
acc: 0.732394
AUC: 0.893079
Avg Precision: 0.466746
Avg Recall: 1.000000
d_prime: 1.757967
train_loss: 0.041317
valid_loss: 1.325613
validation finished
normal learning rate scheduler step
Epoch-28 lr: 2.806258611938982e-05
Epoch-28 lr: 2.806258611938982e-05
epoch 28 training time: 15.238
---------------
2023-09-25 00:31:03.766928
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00927	Per Sample Data Time 0.00353	Per Sample DNN Time 0.00574	Train Loss 0.0296	
start validation
acc: 0.732394
AUC: 0.893414
Avg Precision: 0.466677
Avg Recall: 1.000000
d_prime: 1.760544
train_loss: 0.035778
valid_loss: 1.324926
validation finished
normal learning rate scheduler step
Epoch-29 lr: 2.2211845769324514e-05
Epoch-29 lr: 2.2211845769324514e-05
epoch 29 training time: 15.127
---------------
2023-09-25 00:31:18.894670
current #epochs=30, #steps=1131
start validation
acc: 0.718310
AUC: 0.893100
Avg Precision: 0.466404
Avg Recall: 1.000000
d_prime: 1.758125
train_loss: 0.041850
valid_loss: 1.324566
validation finished
normal learning rate scheduler step
Epoch-30 lr: 2.2211845769324514e-05
Epoch-30 lr: 2.2211845769324514e-05
epoch 30 training time: 15.268
---------------
2023-09-25 00:31:34.162781
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00671	Per Sample Data Time 0.00112	Per Sample DNN Time 0.00559	Train Loss 0.0290	
start validation
acc: 0.718310
AUC: 0.892785
Avg Precision: 0.466454
Avg Recall: 1.000000
d_prime: 1.755715
train_loss: 0.029108
valid_loss: 1.324520
validation finished
normal learning rate scheduler step
Epoch-31 lr: 1.7580920389207056e-05
Epoch-31 lr: 1.7580920389207056e-05
epoch 31 training time: 15.231
---------------
2023-09-25 00:31:49.394087
current #epochs=32, #steps=1209
start validation
acc: 0.718310
AUC: 0.892466
Avg Precision: 0.466454
Avg Recall: 1.000000
d_prime: 1.753271
train_loss: 0.036901
valid_loss: 1.324747
validation finished
normal learning rate scheduler step
Epoch-32 lr: 1.7580920389207056e-05
Epoch-32 lr: 1.7580920389207056e-05
epoch 32 training time: 15.217
---------------
2023-09-25 00:32:04.610971
current #epochs=33, #steps=1248
start validation
acc: 0.718310
AUC: 0.892543
Avg Precision: 0.466723
Avg Recall: 1.000000
d_prime: 1.753857
train_loss: 0.046540
valid_loss: 1.324314
validation finished
normal learning rate scheduler step
Epoch-33 lr: 1.3915491983043607e-05
Epoch-33 lr: 1.3915491983043607e-05
epoch 33 training time: 16.554
---------------
2023-09-25 00:32:21.164820
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00821	Per Sample Data Time 0.00246	Per Sample DNN Time 0.00574	Train Loss 0.0543	
start validation
acc: 0.723005
AUC: 0.892564
Avg Precision: 0.466923
Avg Recall: 1.000000
d_prime: 1.754024
train_loss: 0.046346
valid_loss: 1.324560
validation finished
normal learning rate scheduler step
Epoch-34 lr: 1.3915491983043607e-05
Epoch-34 lr: 1.3915491983043607e-05
epoch 34 training time: 15.247
---------------
2023-09-25 00:32:36.412369
current #epochs=35, #steps=1326
start validation
acc: 0.732394
AUC: 0.892480
Avg Precision: 0.466923
Avg Recall: 1.000000
d_prime: 1.753378
train_loss: 0.035397
valid_loss: 1.324232
validation finished
normal learning rate scheduler step
Epoch-35 lr: 1.101426505799021e-05
Epoch-35 lr: 1.101426505799021e-05
epoch 35 training time: 15.216
---------------
2023-09-25 00:32:51.628362
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00654	Per Sample Data Time 0.00099	Per Sample DNN Time 0.00555	Train Loss 0.0456	
start validation
[I 2023-09-25 00:33:06,889] Trial 90 finished with value: 0.46692252165555564 and parameters: {'warmup': 'True', 'num_epochs': 36, 'batch_size': 53, 'lr-adaptschedule': 'True', 'lr': 0.00036736785453534175, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.7915110059645308}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.723005
AUC: 0.892560
Avg Precision: 0.466923
Avg Recall: 1.000000
d_prime: 1.753986
train_loss: 0.042919
valid_loss: 1.324311
validation finished
normal learning rate scheduler step
Epoch-36 lr: 1.101426505799021e-05
Epoch-36 lr: 1.101426505799021e-05
epoch 36 training time: 15.248
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67ec58a90>
The learning rate scheduler starts at 7 epoch with decay rate of 0.770 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-25 00:33:06.929923
current #epochs=1, #steps=0
start validation
acc: 0.741784
AUC: 0.878161
Avg Precision: 0.456253
Avg Recall: 1.000000
d_prime: 1.648748
train_loss: 0.044318
valid_loss: 1.342811
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0005080192219842181
Epoch-1 lr: 0.0005080192219842181
epoch 1 training time: 17.678
---------------
2023-09-25 00:33:24.608560
current #epochs=2, #steps=39
start validation
acc: 0.718310
AUC: 0.886383
Avg Precision: 0.466611
Avg Recall: 1.000000
d_prime: 1.707687
train_loss: 0.042269
valid_loss: 1.323062
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0005080192219842181
Epoch-2 lr: 0.0005080192219842181
epoch 2 training time: 15.197
---------------
2023-09-25 00:33:39.805410
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00706	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00559	Train Loss 0.0365	
start validation
acc: 0.741784
AUC: 0.884120
Avg Precision: 0.458052
Avg Recall: 1.000000
d_prime: 1.691171
train_loss: 0.036136
valid_loss: 1.328384
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0005080192219842181
Epoch-3 lr: 0.0005080192219842181
epoch 3 training time: 15.078
---------------
2023-09-25 00:33:54.883424
current #epochs=4, #steps=117
start validation
acc: 0.713615
AUC: 0.883901
Avg Precision: 0.450609
Avg Recall: 1.000000
d_prime: 1.689587
train_loss: 0.056694
valid_loss: 1.341873
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0005080192219842181
Epoch-4 lr: 0.0005080192219842181
epoch 4 training time: 17.404
---------------
2023-09-25 00:34:12.287261
current #epochs=5, #steps=156
start validation
acc: 0.718310
AUC: 0.884745
Avg Precision: 0.413860
Avg Recall: 1.000000
d_prime: 1.695711
train_loss: 0.078057
valid_loss: 1.339729
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0005080192219842181
Epoch-5 lr: 0.0005080192219842181
epoch 5 training time: 15.402
---------------
2023-09-25 00:34:27.689931
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01139	Per Sample Data Time 0.00540	Per Sample DNN Time 0.00600	Train Loss 0.0419	
start validation
acc: 0.755869
AUC: 0.895681
Avg Precision: 0.441220
Avg Recall: 1.000000
d_prime: 1.778117
train_loss: 0.049086
valid_loss: 1.319780
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0005080192219842181
Epoch-6 lr: 0.0005080192219842181
epoch 6 training time: 17.660
---------------
2023-09-25 00:34:45.349360
current #epochs=7, #steps=234
start validation
acc: 0.727700
AUC: 0.900010
Avg Precision: 0.453433
Avg Recall: 1.000000
d_prime: 1.812470
train_loss: 0.065030
valid_loss: 1.320925
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0003910367629624611
Epoch-7 lr: 0.0003910367629624611
epoch 7 training time: 15.280
---------------
2023-09-25 00:35:00.628844
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00681	Per Sample Data Time 0.00122	Per Sample DNN Time 0.00559	Train Loss 0.0509	
start validation
acc: 0.751174
AUC: 0.903851
Avg Precision: 0.465546
Avg Recall: 1.000000
d_prime: 1.843869
train_loss: 0.044669
valid_loss: 1.315654
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00030099205575514663
Epoch-8 lr: 0.00030099205575514663
epoch 8 training time: 15.300
---------------
2023-09-25 00:35:15.929429
current #epochs=9, #steps=312
start validation
acc: 0.755869
AUC: 0.901689
Avg Precision: 0.462371
Avg Recall: 1.000000
d_prime: 1.826084
train_loss: 0.055382
valid_loss: 1.325590
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00023168209797298878
Epoch-9 lr: 0.00023168209797298878
epoch 9 training time: 15.264
---------------
2023-09-25 00:35:31.193547
current #epochs=10, #steps=351
start validation
acc: 0.760563
AUC: 0.900135
Avg Precision: 0.470060
Avg Recall: 1.000000
d_prime: 1.813479
train_loss: 0.055287
valid_loss: 1.324893
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00017833226324362139
Epoch-10 lr: 0.00017833226324362139
epoch 10 training time: 18.507
---------------
2023-09-25 00:35:49.700578
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00871	Per Sample Data Time 0.00287	Per Sample DNN Time 0.00584	Train Loss 0.0521	
start validation
acc: 0.755869
AUC: 0.900266
Avg Precision: 0.459169
Avg Recall: 1.000000
d_prime: 1.814535
train_loss: 0.052636
valid_loss: 1.321409
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00013726738661223636
Epoch-11 lr: 0.00013726738661223636
epoch 11 training time: 15.944
---------------
2023-09-25 00:36:05.644838
current #epochs=12, #steps=429
start validation
acc: 0.751174
AUC: 0.897431
Avg Precision: 0.469220
Avg Recall: 1.000000
d_prime: 1.791876
train_loss: 0.056298
valid_loss: 1.324352
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.00010565858967209133
Epoch-12 lr: 0.00010565858967209133
epoch 12 training time: 15.304
---------------
2023-09-25 00:36:20.949429
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00666	Per Sample Data Time 0.00106	Per Sample DNN Time 0.00559	Train Loss 0.0400	
start validation
acc: 0.760563
AUC: 0.898578
Avg Precision: 0.476720
Avg Recall: 1.000000
d_prime: 1.800985
train_loss: 0.045930
valid_loss: 1.323262
validation finished
normal learning rate scheduler step
Epoch-13 lr: 8.132840470716881e-05
Epoch-13 lr: 8.132840470716881e-05
epoch 13 training time: 15.830
---------------
2023-09-25 00:36:36.779897
current #epochs=14, #steps=507
start validation
acc: 0.760563
AUC: 0.900192
Avg Precision: 0.485413
Avg Recall: 1.000000
d_prime: 1.813938
train_loss: 0.051196
valid_loss: 1.321487
validation finished
normal learning rate scheduler step
Epoch-14 lr: 6.260077323330147e-05
Epoch-14 lr: 6.260077323330147e-05
epoch 14 training time: 16.594
---------------
2023-09-25 00:36:53.374215
current #epochs=15, #steps=546
start validation
acc: 0.760563
AUC: 0.900052
Avg Precision: 0.483599
Avg Recall: 1.000000
d_prime: 1.812807
train_loss: 0.051742
valid_loss: 1.323510
validation finished
normal learning rate scheduler step
Epoch-15 lr: 4.8185585632934474e-05
Epoch-15 lr: 4.8185585632934474e-05
epoch 15 training time: 15.377
---------------
2023-09-25 00:37:08.751124
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00764	Per Sample Data Time 0.00201	Per Sample DNN Time 0.00563	Train Loss 0.0313	
start validation
acc: 0.760563
AUC: 0.901271
Avg Precision: 0.483696
Avg Recall: 1.000000
d_prime: 1.822679
train_loss: 0.041798
valid_loss: 1.323077
validation finished
normal learning rate scheduler step
Epoch-16 lr: 3.708980804655167e-05
Epoch-16 lr: 3.708980804655167e-05
epoch 16 training time: 15.216
---------------
2023-09-25 00:37:23.967577
current #epochs=17, #steps=624
start validation
acc: 0.760563
AUC: 0.901981
Avg Precision: 0.484908
Avg Recall: 1.000000
d_prime: 1.828467
train_loss: 0.047713
valid_loss: 1.321733
validation finished
normal learning rate scheduler step
Epoch-17 lr: 2.8549074227496786e-05
Epoch-17 lr: 2.8549074227496786e-05
epoch 17 training time: 15.237
---------------
2023-09-25 00:37:39.204858
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00650	Per Sample Data Time 0.00091	Per Sample DNN Time 0.00559	Train Loss 0.0543	
start validation
acc: 0.760563
AUC: 0.901125
Avg Precision: 0.485042
Avg Recall: 1.000000
d_prime: 1.821487
train_loss: 0.056093
valid_loss: 1.321498
validation finished
normal learning rate scheduler step
Epoch-18 lr: 2.1975029857909936e-05
Epoch-18 lr: 2.1975029857909936e-05
epoch 18 training time: 15.167
---------------
2023-09-25 00:37:54.371896
current #epochs=19, #steps=702
start validation
acc: 0.760563
AUC: 0.900884
Avg Precision: 0.484411
Avg Recall: 1.000000
d_prime: 1.819536
train_loss: 0.029608
valid_loss: 1.321957
validation finished
normal learning rate scheduler step
Epoch-19 lr: 1.691480197949573e-05
Epoch-19 lr: 1.691480197949573e-05
epoch 19 training time: 15.330
---------------
2023-09-25 00:38:09.702317
current #epochs=20, #steps=741
start validation
acc: 0.769953
AUC: 0.901056
Avg Precision: 0.484668
Avg Recall: 1.000000
d_prime: 1.820930
train_loss: 0.037202
valid_loss: 1.321361
validation finished
normal learning rate scheduler step
Epoch-20 lr: 1.3019801468099797e-05
Epoch-20 lr: 1.3019801468099797e-05
epoch 20 training time: 17.729
---------------
2023-09-25 00:38:27.431118
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00718	Per Sample Data Time 0.00155	Per Sample DNN Time 0.00563	Train Loss 0.0481	
start validation
acc: 0.769953
AUC: 0.900949
Avg Precision: 0.484411
Avg Recall: 1.000000
d_prime: 1.820064
train_loss: 0.040977
valid_loss: 1.321120
validation finished
normal learning rate scheduler step
Epoch-21 lr: 1.002170941606183e-05
Epoch-21 lr: 1.002170941606183e-05
epoch 21 training time: 15.152
---------------
2023-09-25 00:38:42.583338
current #epochs=22, #steps=819
start validation
acc: 0.760563
AUC: 0.901268
Avg Precision: 0.484581
Avg Recall: 1.000000
d_prime: 1.822656
train_loss: 0.035041
valid_loss: 1.321738
validation finished
normal learning rate scheduler step
Epoch-22 lr: 7.713993171559512e-06
Epoch-22 lr: 7.713993171559512e-06
epoch 22 training time: 34.242
---------------
2023-09-25 00:39:16.824955
current #epochs=23, #steps=858
start validation
acc: 0.760563
AUC: 0.901334
Avg Precision: 0.484498
Avg Recall: 1.000000
d_prime: 1.823192
train_loss: 0.046239
valid_loss: 1.321905
validation finished
normal learning rate scheduler step
Epoch-23 lr: 5.937678711328109e-06
Epoch-23 lr: 5.937678711328109e-06
epoch 23 training time: 15.302
---------------
2023-09-25 00:39:32.127079
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01396	Per Sample Data Time 0.00781	Per Sample DNN Time 0.00615	Train Loss 0.0365	
start validation
acc: 0.760563
AUC: 0.901293
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.822858
train_loss: 0.044518
valid_loss: 1.321955
validation finished
normal learning rate scheduler step
Epoch-24 lr: 4.5703992335569356e-06
Epoch-24 lr: 4.5703992335569356e-06
epoch 24 training time: 15.185
---------------
2023-09-25 00:39:47.312508
current #epochs=25, #steps=936
start validation
acc: 0.765258
AUC: 0.901312
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.823008
train_loss: 0.039232
valid_loss: 1.321965
validation finished
normal learning rate scheduler step
Epoch-25 lr: 3.5179655501140418e-06
Epoch-25 lr: 3.5179655501140418e-06
epoch 25 training time: 19.567
---------------
2023-09-25 00:40:06.879209
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00697	Per Sample Data Time 0.00132	Per Sample DNN Time 0.00565	Train Loss 0.0372	
start validation
acc: 0.760563
AUC: 0.901312
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.823008
train_loss: 0.039833
valid_loss: 1.322011
validation finished
normal learning rate scheduler step
Epoch-26 lr: 2.7078775790353543e-06
Epoch-26 lr: 2.7078775790353543e-06
epoch 26 training time: 15.272
---------------
2023-09-25 00:40:22.151154
current #epochs=27, #steps=1014
start validation
acc: 0.760563
AUC: 0.901405
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.823766
train_loss: 0.039133
valid_loss: 1.322051
validation finished
normal learning rate scheduler step
Epoch-27 lr: 2.084329956785583e-06
Epoch-27 lr: 2.084329956785583e-06
epoch 27 training time: 15.096
---------------
2023-09-25 00:40:37.246918
current #epochs=28, #steps=1053
start validation
acc: 0.760563
AUC: 0.901420
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.823887
train_loss: 0.032141
valid_loss: 1.322070
validation finished
normal learning rate scheduler step
Epoch-28 lr: 1.604367716764152e-06
Epoch-28 lr: 1.604367716764152e-06
epoch 28 training time: 17.432
---------------
2023-09-25 00:40:54.678952
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00950	Per Sample Data Time 0.00357	Per Sample DNN Time 0.00594	Train Loss 0.0340	
start validation
acc: 0.760563
AUC: 0.901491
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.824472
train_loss: 0.033376
valid_loss: 1.322055
validation finished
normal learning rate scheduler step
Epoch-29 lr: 1.2349272063260988e-06
Epoch-29 lr: 1.2349272063260988e-06
epoch 29 training time: 15.310
---------------
2023-09-25 00:41:09.989419
current #epochs=30, #steps=1131
start validation
acc: 0.760563
AUC: 0.901528
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.824767
train_loss: 0.044912
valid_loss: 1.322073
validation finished
normal learning rate scheduler step
Epoch-30 lr: 9.505583969242697e-07
Epoch-30 lr: 9.505583969242697e-07
epoch 30 training time: 15.209
---------------
2023-09-25 00:41:25.198851
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00663	Per Sample Data Time 0.00111	Per Sample DNN Time 0.00552	Train Loss 0.0664	
start validation
acc: 0.760563
AUC: 0.901371
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.823488
train_loss: 0.061208
valid_loss: 1.322139
validation finished
normal learning rate scheduler step
Epoch-31 lr: 7.316716818081341e-07
Epoch-31 lr: 7.316716818081341e-07
epoch 31 training time: 15.199
---------------
2023-09-25 00:41:40.397715
current #epochs=32, #steps=1209
start validation
acc: 0.760563
AUC: 0.901345
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.823279
train_loss: 0.059163
valid_loss: 1.322161
validation finished
normal learning rate scheduler step
Epoch-32 lr: 5.631883866284903e-07
Epoch-32 lr: 5.631883866284903e-07
epoch 32 training time: 15.177
---------------
2023-09-25 00:41:55.575252
current #epochs=33, #steps=1248
start validation
acc: 0.760563
AUC: 0.901324
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.823105
train_loss: 0.040640
valid_loss: 1.322179
validation finished
normal learning rate scheduler step
Epoch-33 lr: 4.3350202928364265e-07
Epoch-33 lr: 4.3350202928364265e-07
epoch 33 training time: 15.365
---------------
2023-09-25 00:42:10.940139
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00800	Per Sample Data Time 0.00233	Per Sample DNN Time 0.00567	Train Loss 0.0370	
start validation
acc: 0.760563
AUC: 0.901266
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.822636
train_loss: 0.048078
valid_loss: 1.322171
validation finished
normal learning rate scheduler step
Epoch-34 lr: 3.3367877224535363e-07
Epoch-34 lr: 3.3367877224535363e-07
epoch 34 training time: 15.483
---------------
2023-09-25 00:42:26.422802
current #epochs=35, #steps=1326
start validation
acc: 0.760563
AUC: 0.901309
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.822984
train_loss: 0.042335
valid_loss: 1.322167
validation finished
normal learning rate scheduler step
Epoch-35 lr: 2.5684198810131803e-07
Epoch-35 lr: 2.5684198810131803e-07
epoch 35 training time: 15.330
---------------
2023-09-25 00:42:41.752971
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00663	Per Sample Data Time 0.00104	Per Sample DNN Time 0.00559	Train Loss 0.0311	
start validation
acc: 0.760563
AUC: 0.901309
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.822984
train_loss: 0.032665
valid_loss: 1.322166
validation finished
normal learning rate scheduler step
Epoch-36 lr: 1.976985422474869e-07
Epoch-36 lr: 1.976985422474869e-07
epoch 36 training time: 17.171
---------------
2023-09-25 00:42:58.923902
current #epochs=37, #steps=1404
start validation
acc: 0.760563
AUC: 0.901309
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.822984
train_loss: 0.038407
valid_loss: 1.322165
validation finished
normal learning rate scheduler step
Epoch-37 lr: 1.5217415927867436e-07
Epoch-37 lr: 1.5217415927867436e-07
epoch 37 training time: 15.261
---------------
2023-09-25 00:43:14.184481
current #epochs=38, #steps=1443
start validation
acc: 0.760563
AUC: 0.901324
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.823105
train_loss: 0.048553
valid_loss: 1.322158
validation finished
normal learning rate scheduler step
Epoch-38 lr: 1.1713275418683935e-07
Epoch-38 lr: 1.1713275418683935e-07
epoch 38 training time: 15.200
---------------
2023-09-25 00:43:29.384193
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00744	Per Sample Data Time 0.00183	Per Sample DNN Time 0.00561	Train Loss 0.0413	
start validation
acc: 0.760563
AUC: 0.901345
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.823279
train_loss: 0.032303
valid_loss: 1.322149
validation finished
normal learning rate scheduler step
Epoch-39 lr: 9.016039364652667e-08
Epoch-39 lr: 9.016039364652667e-08
epoch 39 training time: 15.254
---------------
2023-09-25 00:43:44.638156
current #epochs=40, #steps=1521
start validation
acc: 0.760563
AUC: 0.901345
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.823279
train_loss: 0.036615
valid_loss: 1.322148
validation finished
normal learning rate scheduler step
Epoch-40 lr: 6.939900490626374e-08
Epoch-40 lr: 6.939900490626374e-08
epoch 40 training time: 15.210
---------------
2023-09-25 00:43:59.848084
current #epochs=41, #steps=1560
start validation
acc: 0.760563
AUC: 0.901345
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.823279
train_loss: 0.036504
valid_loss: 1.322150
validation finished
normal learning rate scheduler step
Epoch-41 lr: 5.341837681922275e-08
Epoch-41 lr: 5.341837681922275e-08
epoch 41 training time: 15.324
---------------
2023-09-25 00:44:15.172655
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02288	Per Sample Data Time 0.01627	Per Sample DNN Time 0.00661	Train Loss 0.0059	
start validation
acc: 0.760563
AUC: 0.901345
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.823279
train_loss: 0.031687
valid_loss: 1.322152
validation finished
normal learning rate scheduler step
Epoch-42 lr: 4.1117635416454274e-08
Epoch-42 lr: 4.1117635416454274e-08
epoch 42 training time: 15.406
---------------
2023-09-25 00:44:30.577934
current #epochs=43, #steps=1638
start validation
acc: 0.760563
AUC: 0.901345
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.823279
train_loss: 0.039801
valid_loss: 1.322151
validation finished
normal learning rate scheduler step
Epoch-43 lr: 3.164940686913696e-08
Epoch-43 lr: 3.164940686913696e-08
epoch 43 training time: 15.186
---------------
2023-09-25 00:44:45.763805
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00705	Per Sample Data Time 0.00143	Per Sample DNN Time 0.00562	Train Loss 0.0377	
start validation
acc: 0.760563
AUC: 0.901345
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.823279
train_loss: 0.036859
valid_loss: 1.322151
validation finished
normal learning rate scheduler step
Epoch-44 lr: 2.4361443575797742e-08
Epoch-44 lr: 2.4361443575797742e-08
epoch 44 training time: 15.288
---------------
2023-09-25 00:45:01.052247
current #epochs=45, #steps=1716
start validation
acc: 0.760563
AUC: 0.901345
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.823279
train_loss: 0.040246
valid_loss: 1.322151
validation finished
normal learning rate scheduler step
Epoch-45 lr: 1.875169211071413e-08
Epoch-45 lr: 1.875169211071413e-08
epoch 45 training time: 15.176
---------------
2023-09-25 00:45:16.228274
current #epochs=46, #steps=1755
start validation
acc: 0.760563
AUC: 0.901345
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.823279
train_loss: 0.047891
valid_loss: 1.322151
validation finished
normal learning rate scheduler step
Epoch-46 lr: 1.4433707753030977e-08
Epoch-46 lr: 1.4433707753030977e-08
epoch 46 training time: 15.149
---------------
2023-09-25 00:45:31.377346
current #epochs=47, #steps=1794
Epoch: [47][6/39]	Per Sample Total Time 0.01062	Per Sample Data Time 0.00450	Per Sample DNN Time 0.00612	Train Loss 0.0594	
start validation
acc: 0.760563
AUC: 0.901345
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.823279
train_loss: 0.049891
valid_loss: 1.322152
validation finished
normal learning rate scheduler step
Epoch-47 lr: 1.1110033071675287e-08
Epoch-47 lr: 1.1110033071675287e-08
epoch 47 training time: 15.210
---------------
2023-09-25 00:45:46.587114
current #epochs=48, #steps=1833
start validation
acc: 0.760563
AUC: 0.901345
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.823279
train_loss: 0.036370
valid_loss: 1.322152
validation finished
normal learning rate scheduler step
Epoch-48 lr: 8.551706669258187e-09
Epoch-48 lr: 8.551706669258187e-09
epoch 48 training time: 15.281
---------------
2023-09-25 00:46:01.868048
current #epochs=49, #steps=1872
Epoch: [49][28/39]	Per Sample Total Time 0.00679	Per Sample Data Time 0.00122	Per Sample DNN Time 0.00557	Train Loss 0.0560	
start validation
acc: 0.760563
AUC: 0.901345
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.823279
train_loss: 0.051541
valid_loss: 1.322152
validation finished
normal learning rate scheduler step
Epoch-49 lr: 6.582490482722514e-09
Epoch-49 lr: 6.582490482722514e-09
epoch 49 training time: 15.261
---------------
2023-09-25 00:46:17.128699
current #epochs=50, #steps=1911
start validation
[I 2023-09-25 00:46:32,369] Trial 91 finished with value: 0.48433022353676874 and parameters: {'warmup': 'True', 'num_epochs': 50, 'batch_size': 39, 'lr-adaptschedule': 'True', 'lr': 0.0005080192219842181, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.769728282003095}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.760563
AUC: 0.901345
Avg Precision: 0.484330
Avg Recall: 1.000000
d_prime: 1.823279
train_loss: 0.036710
valid_loss: 1.322152
validation finished
normal learning rate scheduler step
Epoch-50 lr: 5.066729090567724e-09
Epoch-50 lr: 5.066729090567724e-09
epoch 50 training time: 15.224
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f4df1c0>
The learning rate scheduler starts at 7 epoch with decay rate of 0.746 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-25 00:46:32.411096
current #epochs=1, #steps=0
start validation
acc: 0.779343
AUC: 0.906440
Avg Precision: 0.471012
Avg Recall: 1.000000
d_prime: 1.865559
train_loss: 0.042484
valid_loss: 1.312554
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.00025092238361402856
Epoch-1 lr: 0.00025092238361402856
epoch 1 training time: 17.643
---------------
2023-09-25 00:46:50.054220
current #epochs=2, #steps=39
start validation
acc: 0.737089
AUC: 0.899343
Avg Precision: 0.462714
Avg Recall: 1.000000
d_prime: 1.807104
train_loss: 0.041358
valid_loss: 1.325929
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.00025092238361402856
Epoch-2 lr: 0.00025092238361402856
epoch 2 training time: 15.272
---------------
2023-09-25 00:47:05.326668
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00566	Train Loss 0.0469	
start validation
acc: 0.760563
AUC: 0.901518
Avg Precision: 0.477168
Avg Recall: 1.000000
d_prime: 1.824690
train_loss: 0.051832
valid_loss: 1.320127
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.00025092238361402856
Epoch-3 lr: 0.00025092238361402856
epoch 3 training time: 16.522
---------------
2023-09-25 00:47:21.848845
current #epochs=4, #steps=117
start validation
acc: 0.755869
AUC: 0.899438
Avg Precision: 0.477079
Avg Recall: 1.000000
d_prime: 1.807870
train_loss: 0.039787
valid_loss: 1.323491
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00025092238361402856
Epoch-4 lr: 0.00025092238361402856
epoch 4 training time: 15.264
---------------
2023-09-25 00:47:37.113219
current #epochs=5, #steps=156
start validation
acc: 0.760563
AUC: 0.896855
Avg Precision: 0.481301
Avg Recall: 1.000000
d_prime: 1.787328
train_loss: 0.054214
valid_loss: 1.331478
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00025092238361402856
Epoch-5 lr: 0.00025092238361402856
epoch 5 training time: 16.128
---------------
2023-09-25 00:47:53.241661
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01113	Per Sample Data Time 0.00515	Per Sample DNN Time 0.00598	Train Loss 0.0291	
start validation
acc: 0.746479
AUC: 0.893427
Avg Precision: 0.482001
Avg Recall: 1.000000
d_prime: 1.760642
train_loss: 0.042960
valid_loss: 1.335513
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00025092238361402856
Epoch-6 lr: 0.00025092238361402856
epoch 6 training time: 15.747
---------------
2023-09-25 00:48:08.989056
current #epochs=7, #steps=234
start validation
acc: 0.755869
AUC: 0.894018
Avg Precision: 0.482285
Avg Recall: 1.000000
d_prime: 1.765196
train_loss: 0.058176
valid_loss: 1.332575
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00018707472157386714
Epoch-7 lr: 0.00018707472157386714
epoch 7 training time: 15.282
---------------
2023-09-25 00:48:24.270711
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00692	Per Sample Data Time 0.00121	Per Sample DNN Time 0.00570	Train Loss 0.0447	
start validation
acc: 0.737089
AUC: 0.892600
Avg Precision: 0.475170
Avg Recall: 1.000000
d_prime: 1.754292
train_loss: 0.042494
valid_loss: 1.334998
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00013947321457687326
Epoch-8 lr: 0.00013947321457687326
epoch 8 training time: 15.272
---------------
2023-09-25 00:48:39.542828
current #epochs=9, #steps=312
start validation
acc: 0.732394
AUC: 0.891602
Avg Precision: 0.463880
Avg Recall: 1.000000
d_prime: 1.746685
train_loss: 0.036547
valid_loss: 1.337526
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00010398399859023995
Epoch-9 lr: 0.00010398399859023995
epoch 9 training time: 15.168
---------------
2023-09-25 00:48:54.711408
current #epochs=10, #steps=351
start validation
acc: 0.727700
AUC: 0.891382
Avg Precision: 0.456273
Avg Recall: 1.000000
d_prime: 1.745013
train_loss: 0.038140
valid_loss: 1.339192
validation finished
normal learning rate scheduler step
Epoch-10 lr: 7.752507888785641e-05
Epoch-10 lr: 7.752507888785641e-05
epoch 10 training time: 15.077
---------------
2023-09-25 00:49:09.788119
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00873	Per Sample Data Time 0.00291	Per Sample DNN Time 0.00582	Train Loss 0.0517	
start validation
acc: 0.727700
AUC: 0.891852
Avg Precision: 0.471251
Avg Recall: 1.000000
d_prime: 1.748583
train_loss: 0.039462
valid_loss: 1.337104
validation finished
normal learning rate scheduler step
Epoch-11 lr: 5.779867997048228e-05
Epoch-11 lr: 5.779867997048228e-05
epoch 11 training time: 15.248
---------------
2023-09-25 00:49:25.036150
current #epochs=12, #steps=429
start validation
acc: 0.723005
AUC: 0.891916
Avg Precision: 0.471251
Avg Recall: 1.000000
d_prime: 1.749076
train_loss: 0.045065
valid_loss: 1.338687
validation finished
normal learning rate scheduler step
Epoch-12 lr: 4.309169954103094e-05
Epoch-12 lr: 4.309169954103094e-05
epoch 12 training time: 15.234
---------------
2023-09-25 00:49:40.269905
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00661	Per Sample Data Time 0.00105	Per Sample DNN Time 0.00556	Train Loss 0.0456	
start validation
acc: 0.727700
AUC: 0.892329
Avg Precision: 0.471911
Avg Recall: 1.000000
d_prime: 1.752227
train_loss: 0.046498
valid_loss: 1.340966
validation finished
normal learning rate scheduler step
Epoch-13 lr: 3.212693733287335e-05
Epoch-13 lr: 3.212693733287335e-05
epoch 13 training time: 15.175
---------------
2023-09-25 00:49:55.444919
current #epochs=14, #steps=507
start validation
acc: 0.732394
AUC: 0.893631
Avg Precision: 0.472378
Avg Recall: 1.000000
d_prime: 1.762213
train_loss: 0.042503
valid_loss: 1.339048
validation finished
normal learning rate scheduler step
Epoch-14 lr: 2.3952179036419554e-05
Epoch-14 lr: 2.3952179036419554e-05
epoch 14 training time: 15.358
---------------
2023-09-25 00:50:10.802838
current #epochs=15, #steps=546
start validation
acc: 0.727700
AUC: 0.894172
Avg Precision: 0.472507
Avg Recall: 1.000000
d_prime: 1.766387
train_loss: 0.045405
valid_loss: 1.337500
validation finished
normal learning rate scheduler step
Epoch-15 lr: 1.7857503024593024e-05
Epoch-15 lr: 1.7857503024593024e-05
epoch 15 training time: 15.295
---------------
2023-09-25 00:50:26.097472
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00770	Per Sample Data Time 0.00205	Per Sample DNN Time 0.00565	Train Loss 0.0315	
start validation
acc: 0.727700
AUC: 0.894985
Avg Precision: 0.473316
Avg Recall: 1.000000
d_prime: 1.772689
train_loss: 0.039269
valid_loss: 1.335653
validation finished
normal learning rate scheduler step
Epoch-16 lr: 1.3313628534108423e-05
Epoch-16 lr: 1.3313628534108423e-05
epoch 16 training time: 15.186
---------------
2023-09-25 00:50:41.282935
current #epochs=17, #steps=624
start validation
acc: 0.727700
AUC: 0.895711
Avg Precision: 0.473679
Avg Recall: 1.000000
d_prime: 1.778354
train_loss: 0.044032
valid_loss: 1.334586
validation finished
normal learning rate scheduler step
Epoch-17 lr: 9.925951265421422e-06
Epoch-17 lr: 9.925951265421422e-06
epoch 17 training time: 16.257
---------------
2023-09-25 00:50:57.539988
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00653	Per Sample Data Time 0.00096	Per Sample DNN Time 0.00557	Train Loss 0.0380	
start validation
acc: 0.737089
AUC: 0.895595
Avg Precision: 0.473939
Avg Recall: 1.000000
d_prime: 1.777444
train_loss: 0.039292
valid_loss: 1.333864
validation finished
normal learning rate scheduler step
Epoch-18 lr: 7.400274708815064e-06
Epoch-18 lr: 7.400274708815064e-06
epoch 18 training time: 15.225
---------------
2023-09-25 00:51:12.765583
current #epochs=19, #steps=702
start validation
acc: 0.737089
AUC: 0.895202
Avg Precision: 0.473951
Avg Recall: 1.000000
d_prime: 1.774380
train_loss: 0.039148
valid_loss: 1.334153
validation finished
normal learning rate scheduler step
Epoch-19 lr: 5.5172611975949266e-06
Epoch-19 lr: 5.5172611975949266e-06
epoch 19 training time: 15.276
---------------
2023-09-25 00:51:28.041739
current #epochs=20, #steps=741
start validation
acc: 0.737089
AUC: 0.895318
Avg Precision: 0.474086
Avg Recall: 1.000000
d_prime: 1.775289
train_loss: 0.046764
valid_loss: 1.334077
validation finished
normal learning rate scheduler step
Epoch-20 lr: 4.1133839377917775e-06
Epoch-20 lr: 4.1133839377917775e-06
epoch 20 training time: 15.214
---------------
2023-09-25 00:51:43.255471
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00717	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00562	Train Loss 0.0514	
start validation
acc: 0.737089
AUC: 0.895312
Avg Precision: 0.474086
Avg Recall: 1.000000
d_prime: 1.775237
train_loss: 0.047136
valid_loss: 1.334115
validation finished
normal learning rate scheduler step
Epoch-21 lr: 3.0667258289419196e-06
Epoch-21 lr: 3.0667258289419196e-06
epoch 21 training time: 15.154
---------------
2023-09-25 00:51:58.409374
current #epochs=22, #steps=819
start validation
acc: 0.727700
AUC: 0.895239
Avg Precision: 0.473689
Avg Recall: 1.000000
d_prime: 1.774671
train_loss: 0.042066
valid_loss: 1.334094
validation finished
normal learning rate scheduler step
Epoch-22 lr: 2.2863918010406695e-06
Epoch-22 lr: 2.2863918010406695e-06
epoch 22 training time: 16.439
---------------
2023-09-25 00:52:14.848627
current #epochs=23, #steps=858
start validation
acc: 0.723005
AUC: 0.895217
Avg Precision: 0.473689
Avg Recall: 1.000000
d_prime: 1.774496
train_loss: 0.035782
valid_loss: 1.334118
validation finished
normal learning rate scheduler step
Epoch-23 lr: 1.7046152018322475e-06
Epoch-23 lr: 1.7046152018322475e-06
epoch 23 training time: 15.353
---------------
2023-09-25 00:52:30.201884
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01363	Per Sample Data Time 0.00761	Per Sample DNN Time 0.00602	Train Loss 0.0443	
start validation
acc: 0.723005
AUC: 0.895236
Avg Precision: 0.473689
Avg Recall: 1.000000
d_prime: 1.774648
train_loss: 0.036085
valid_loss: 1.334192
validation finished
normal learning rate scheduler step
Epoch-24 lr: 1.2708727283727292e-06
Epoch-24 lr: 1.2708727283727292e-06
epoch 24 training time: 15.163
---------------
2023-09-25 00:52:45.364880
current #epochs=25, #steps=936
start validation
acc: 0.723005
AUC: 0.895186
Avg Precision: 0.473826
Avg Recall: 1.000000
d_prime: 1.774256
train_loss: 0.040106
valid_loss: 1.334236
validation finished
normal learning rate scheduler step
Epoch-25 lr: 9.474968250814001e-07
Epoch-25 lr: 9.474968250814001e-07
epoch 25 training time: 15.207
---------------
2023-09-25 00:53:00.572046
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00694	Per Sample Data Time 0.00134	Per Sample DNN Time 0.00560	Train Loss 0.0418	
start validation
acc: 0.723005
AUC: 0.895216
Avg Precision: 0.473826
Avg Recall: 1.000000
d_prime: 1.774488
train_loss: 0.036041
valid_loss: 1.334179
validation finished
normal learning rate scheduler step
Epoch-26 lr: 7.064045151781995e-07
Epoch-26 lr: 7.064045151781995e-07
epoch 26 training time: 15.161
---------------
2023-09-25 00:53:15.733284
current #epochs=27, #steps=1014
start validation
acc: 0.723005
AUC: 0.895201
Avg Precision: 0.473826
Avg Recall: 1.000000
d_prime: 1.774372
train_loss: 0.039260
valid_loss: 1.334147
validation finished
normal learning rate scheduler step
Epoch-27 lr: 5.26658586978671e-07
Epoch-27 lr: 5.26658586978671e-07
epoch 27 training time: 15.083
---------------
2023-09-25 00:53:30.816042
current #epochs=28, #steps=1053
start validation
acc: 0.723005
AUC: 0.895201
Avg Precision: 0.473826
Avg Recall: 1.000000
d_prime: 1.774372
train_loss: 0.038375
valid_loss: 1.334104
validation finished
normal learning rate scheduler step
Epoch-28 lr: 3.926493408219515e-07
Epoch-28 lr: 3.926493408219515e-07
epoch 28 training time: 15.163
---------------
2023-09-25 00:53:45.979534
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00950	Per Sample Data Time 0.00363	Per Sample DNN Time 0.00587	Train Loss 0.0292	
start validation
acc: 0.723005
AUC: 0.895201
Avg Precision: 0.473826
Avg Recall: 1.000000
d_prime: 1.774372
train_loss: 0.035951
valid_loss: 1.334072
validation finished
normal learning rate scheduler step
Epoch-29 lr: 2.9273899383730526e-07
Epoch-29 lr: 2.9273899383730526e-07
epoch 29 training time: 15.272
---------------
2023-09-25 00:54:01.251064
current #epochs=30, #steps=1131
start validation
acc: 0.723005
AUC: 0.895201
Avg Precision: 0.473826
Avg Recall: 1.000000
d_prime: 1.774372
train_loss: 0.045011
valid_loss: 1.334075
validation finished
normal learning rate scheduler step
Epoch-30 lr: 2.1825101841120143e-07
Epoch-30 lr: 2.1825101841120143e-07
epoch 30 training time: 15.711
---------------
2023-09-25 00:54:16.962580
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00673	Per Sample Data Time 0.00115	Per Sample DNN Time 0.00558	Train Loss 0.0532	
start validation
acc: 0.723005
AUC: 0.895201
Avg Precision: 0.473826
Avg Recall: 1.000000
d_prime: 1.774372
train_loss: 0.049888
valid_loss: 1.334083
validation finished
normal learning rate scheduler step
Epoch-31 lr: 1.6271664534038717e-07
Epoch-31 lr: 1.6271664534038717e-07
epoch 31 training time: 33.502
---------------
2023-09-25 00:54:50.464510
current #epochs=32, #steps=1209
start validation
acc: 0.723005
AUC: 0.895201
Avg Precision: 0.473826
Avg Recall: 1.000000
d_prime: 1.774372
train_loss: 0.041797
valid_loss: 1.334078
validation finished
normal learning rate scheduler step
Epoch-32 lr: 1.2131309564359156e-07
Epoch-32 lr: 1.2131309564359156e-07
epoch 32 training time: 15.322
---------------
2023-09-25 00:55:05.786950
current #epochs=33, #steps=1248
start validation
acc: 0.723005
AUC: 0.895201
Avg Precision: 0.473826
Avg Recall: 1.000000
d_prime: 1.774372
train_loss: 0.048367
valid_loss: 1.334073
validation finished
normal learning rate scheduler step
Epoch-33 lr: 9.044475532201982e-08
Epoch-33 lr: 9.044475532201982e-08
epoch 33 training time: 16.635
---------------
2023-09-25 00:55:22.421916
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00801	Per Sample Data Time 0.00242	Per Sample DNN Time 0.00560	Train Loss 0.0576	
start validation
acc: 0.723005
AUC: 0.895201
Avg Precision: 0.473826
Avg Recall: 1.000000
d_prime: 1.774372
train_loss: 0.044449
valid_loss: 1.334068
validation finished
normal learning rate scheduler step
Epoch-34 lr: 6.743092097239841e-08
Epoch-34 lr: 6.743092097239841e-08
epoch 34 training time: 16.754
---------------
2023-09-25 00:55:39.176411
current #epochs=35, #steps=1326
start validation
acc: 0.723005
AUC: 0.895201
Avg Precision: 0.473826
Avg Recall: 1.000000
d_prime: 1.774372
train_loss: 0.032980
valid_loss: 1.334067
validation finished
normal learning rate scheduler step
Epoch-35 lr: 5.0272999103120325e-08
Epoch-35 lr: 5.0272999103120325e-08
epoch 35 training time: 15.280
---------------
2023-09-25 00:55:54.456813
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00657	Per Sample Data Time 0.00098	Per Sample DNN Time 0.00559	Train Loss 0.0418	
start validation
acc: 0.723005
AUC: 0.895201
Avg Precision: 0.473826
Avg Recall: 1.000000
d_prime: 1.774372
train_loss: 0.040827
valid_loss: 1.334068
validation finished
normal learning rate scheduler step
Epoch-36 lr: 3.748094201259494e-08
Epoch-36 lr: 3.748094201259494e-08
epoch 36 training time: 15.339
---------------
2023-09-25 00:56:09.795969
current #epochs=37, #steps=1404
start validation
acc: 0.723005
AUC: 0.895201
Avg Precision: 0.473826
Avg Recall: 1.000000
d_prime: 1.774372
train_loss: 0.042286
valid_loss: 1.334068
validation finished
normal learning rate scheduler step
Epoch-37 lr: 2.7943847377593804e-08
Epoch-37 lr: 2.7943847377593804e-08
epoch 37 training time: 15.726
---------------
2023-09-25 00:56:25.521448
current #epochs=38, #steps=1443
start validation
acc: 0.723005
AUC: 0.895201
Avg Precision: 0.473826
Avg Recall: 1.000000
d_prime: 1.774372
train_loss: 0.039987
valid_loss: 1.334066
validation finished
normal learning rate scheduler step
Epoch-38 lr: 2.0833484014352137e-08
Epoch-38 lr: 2.0833484014352137e-08
epoch 38 training time: 15.206
---------------
2023-09-25 00:56:40.727914
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00737	Per Sample Data Time 0.00178	Per Sample DNN Time 0.00559	Train Loss 0.0349	
start validation
acc: 0.723005
AUC: 0.895193
Avg Precision: 0.473826
Avg Recall: 1.000000
d_prime: 1.774314
train_loss: 0.030944
valid_loss: 1.334066
validation finished
normal learning rate scheduler step
Epoch-39 lr: 1.5532365687206238e-08
Epoch-39 lr: 1.5532365687206238e-08
epoch 39 training time: 16.146
---------------
2023-09-25 00:56:56.873618
current #epochs=40, #steps=1521
start validation
acc: 0.723005
AUC: 0.895201
Avg Precision: 0.473826
Avg Recall: 1.000000
d_prime: 1.774372
train_loss: 0.041028
valid_loss: 1.334064
validation finished
normal learning rate scheduler step
Epoch-40 lr: 1.1580126668919234e-08
Epoch-40 lr: 1.1580126668919234e-08
epoch 40 training time: 15.064
---------------
2023-09-25 00:57:11.937424
current #epochs=41, #steps=1560
start validation
acc: 0.723005
AUC: 0.895201
Avg Precision: 0.473826
Avg Recall: 1.000000
d_prime: 1.774372
train_loss: 0.046812
valid_loss: 1.334064
validation finished
normal learning rate scheduler step
Epoch-41 lr: 8.63354213831509e-09
Epoch-41 lr: 8.63354213831509e-09
epoch 41 training time: 15.213
---------------
2023-09-25 00:57:27.150228
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02299	Per Sample Data Time 0.01608	Per Sample DNN Time 0.00692	Train Loss 0.0272	
start validation
acc: 0.723005
AUC: 0.895201
Avg Precision: 0.473826
Avg Recall: 1.000000
d_prime: 1.774372
train_loss: 0.047815
valid_loss: 1.334064
validation finished
normal learning rate scheduler step
Epoch-42 lr: 6.436721461270413e-09
Epoch-42 lr: 6.436721461270413e-09
epoch 42 training time: 15.355
---------------
2023-09-25 00:57:42.505149
current #epochs=43, #steps=1638
start validation
acc: 0.723005
AUC: 0.895201
Avg Precision: 0.473826
Avg Recall: 1.000000
d_prime: 1.774372
train_loss: 0.052814
valid_loss: 1.334064
validation finished
normal learning rate scheduler step
Epoch-43 lr: 4.798885846182343e-09
Epoch-43 lr: 4.798885846182343e-09
epoch 43 training time: 16.675
---------------
2023-09-25 00:57:59.180526
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00702	Per Sample Data Time 0.00140	Per Sample DNN Time 0.00562	Train Loss 0.0355	
start validation
acc: 0.723005
AUC: 0.895201
Avg Precision: 0.473826
Avg Recall: 1.000000
d_prime: 1.774372
train_loss: 0.040189
valid_loss: 1.334064
validation finished
normal learning rate scheduler step
Epoch-44 lr: 3.5778005158769034e-09
Epoch-44 lr: 3.5778005158769034e-09
epoch 44 training time: 15.906
---------------
2023-09-25 00:58:15.086443
current #epochs=45, #steps=1716
start validation
acc: 0.723005
AUC: 0.895201
Avg Precision: 0.473826
Avg Recall: 1.000000
d_prime: 1.774372
train_loss: 0.033481
valid_loss: 1.334064
validation finished
normal learning rate scheduler step
Epoch-45 lr: 2.667422593849016e-09
Epoch-45 lr: 2.667422593849016e-09
epoch 45 training time: 15.229
---------------
2023-09-25 00:58:30.315087
current #epochs=46, #steps=1755
start validation
acc: 0.723005
AUC: 0.895201
Avg Precision: 0.473826
Avg Recall: 1.000000
d_prime: 1.774372
train_loss: 0.034748
valid_loss: 1.334064
validation finished
normal learning rate scheduler step
Epoch-46 lr: 1.9886920085683767e-09
Epoch-46 lr: 1.9886920085683767e-09
epoch 46 training time: 15.040
---------------
2023-09-25 00:58:45.354978
current #epochs=47, #steps=1794
Epoch: [47][6/39]	Per Sample Total Time 0.01062	Per Sample Data Time 0.00463	Per Sample DNN Time 0.00599	Train Loss 0.0163	
start validation
acc: 0.723005
AUC: 0.895201
Avg Precision: 0.473826
Avg Recall: 1.000000
d_prime: 1.774372
train_loss: 0.033889
valid_loss: 1.334064
validation finished
normal learning rate scheduler step
Epoch-47 lr: 1.4826656691232867e-09
Epoch-47 lr: 1.4826656691232867e-09
epoch 47 training time: 15.383
---------------
2023-09-25 00:59:00.737491
current #epochs=48, #steps=1833
start validation
[I 2023-09-25 00:59:16,004] Trial 92 finished with value: 0.4738256729061199 and parameters: {'warmup': 'True', 'num_epochs': 48, 'batch_size': 48, 'lr-adaptschedule': 'True', 'lr': 0.00025092238361402856, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7455481606679915}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.723005
AUC: 0.895201
Avg Precision: 0.473826
Avg Recall: 1.000000
d_prime: 1.774372
train_loss: 0.033772
valid_loss: 1.334064
validation finished
normal learning rate scheduler step
Epoch-48 lr: 1.1053986625004433e-09
Epoch-48 lr: 1.1053986625004433e-09
epoch 48 training time: 15.254
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa609e931c0>
The learning rate scheduler starts at 8 epoch with decay rate of 0.759 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-25 00:59:16.043836
current #epochs=1, #steps=0
start validation
acc: 0.741784
AUC: 0.894849
Avg Precision: 0.459600
Avg Recall: 1.000000
d_prime: 1.771638
train_loss: 0.064197
valid_loss: 1.335483
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0008544537380868432
Epoch-1 lr: 0.0008544537380868432
epoch 1 training time: 19.000
---------------
2023-09-25 00:59:35.043592
current #epochs=2, #steps=39
start validation
acc: 0.760563
AUC: 0.896969
Avg Precision: 0.447653
Avg Recall: 1.000000
d_prime: 1.788225
train_loss: 0.074706
valid_loss: 1.321663
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0008544537380868432
Epoch-2 lr: 0.0008544537380868432
epoch 2 training time: 17.731
---------------
2023-09-25 00:59:52.774781
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00561	Train Loss 0.0585	
start validation
acc: 0.727700
AUC: 0.895162
Avg Precision: 0.448098
Avg Recall: 1.000000
d_prime: 1.774071
train_loss: 0.055432
valid_loss: 1.325799
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0008544537380868432
Epoch-3 lr: 0.0008544537380868432
epoch 3 training time: 15.173
---------------
2023-09-25 01:00:07.947687
current #epochs=4, #steps=117
start validation
acc: 0.774648
AUC: 0.893141
Avg Precision: 0.482706
Avg Recall: 1.000000
d_prime: 1.758439
train_loss: 0.050421
valid_loss: 1.324924
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0008544537380868432
Epoch-4 lr: 0.0008544537380868432
epoch 4 training time: 18.048
---------------
2023-09-25 01:00:25.995504
current #epochs=5, #steps=156
start validation
acc: 0.732394
AUC: 0.896155
Avg Precision: 0.473772
Avg Recall: 1.000000
d_prime: 1.781829
train_loss: 0.054013
valid_loss: 1.318943
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0008544537380868432
Epoch-5 lr: 0.0008544537380868432
epoch 5 training time: 16.385
---------------
2023-09-25 01:00:42.380807
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01129	Per Sample Data Time 0.00509	Per Sample DNN Time 0.00620	Train Loss 0.0843	
start validation
acc: 0.718310
AUC: 0.895842
Avg Precision: 0.427642
Avg Recall: 1.000000
d_prime: 1.779379
train_loss: 0.079987
valid_loss: 1.337836
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0008544537380868432
Epoch-6 lr: 0.0008544537380868432
epoch 6 training time: 15.276
---------------
2023-09-25 01:00:57.657339
current #epochs=7, #steps=234
start validation
acc: 0.755869
AUC: 0.904331
Avg Precision: 0.469987
Avg Recall: 1.000000
d_prime: 1.847852
train_loss: 0.094632
valid_loss: 1.326961
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0008544537380868432
Epoch-7 lr: 0.0008544537380868432
epoch 7 training time: 15.307
---------------
2023-09-25 01:01:12.964387
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00678	Per Sample Data Time 0.00121	Per Sample DNN Time 0.00557	Train Loss 0.0586	
start validation
acc: 0.751174
AUC: 0.906508
Avg Precision: 0.456272
Avg Recall: 1.000000
d_prime: 1.866135
train_loss: 0.063183
valid_loss: 1.321987
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0006489109856864615
Epoch-8 lr: 0.0006489109856864615
epoch 8 training time: 15.232
---------------
2023-09-25 01:01:28.196552
current #epochs=9, #steps=312
start validation
acc: 0.746479
AUC: 0.913464
Avg Precision: 0.457291
Avg Recall: 1.000000
d_prime: 1.926726
train_loss: 0.051704
valid_loss: 1.307229
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0004928124819108436
Epoch-9 lr: 0.0004928124819108436
epoch 9 training time: 15.176
---------------
2023-09-25 01:01:43.372627
current #epochs=10, #steps=351
start validation
acc: 0.746479
AUC: 0.912794
Avg Precision: 0.458754
Avg Recall: 1.000000
d_prime: 1.920733
train_loss: 0.040848
valid_loss: 1.308375
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00037426418674389923
Epoch-10 lr: 0.00037426418674389923
epoch 10 training time: 15.102
---------------
2023-09-25 01:01:58.474481
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00881	Per Sample Data Time 0.00290	Per Sample DNN Time 0.00591	Train Loss 0.0523	
start validation
acc: 0.751174
AUC: 0.912458
Avg Precision: 0.452375
Avg Recall: 1.000000
d_prime: 1.917742
train_loss: 0.050226
valid_loss: 1.315466
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00028423322586300376
Epoch-11 lr: 0.00028423322586300376
epoch 11 training time: 15.325
---------------
2023-09-25 01:02:13.799664
current #epochs=12, #steps=429
start validation
acc: 0.746479
AUC: 0.910355
Avg Precision: 0.437250
Avg Recall: 1.000000
d_prime: 1.899206
train_loss: 0.048755
valid_loss: 1.318211
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.0002158596241530615
Epoch-12 lr: 0.0002158596241530615
epoch 12 training time: 15.433
---------------
2023-09-25 01:02:29.232197
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00659	Per Sample Data Time 0.00106	Per Sample DNN Time 0.00553	Train Loss 0.0483	
start validation
acc: 0.727700
AUC: 0.908493
Avg Precision: 0.456839
Avg Recall: 1.000000
d_prime: 1.883074
train_loss: 0.047596
valid_loss: 1.321900
validation finished
normal learning rate scheduler step
Epoch-13 lr: 0.00016393360486982356
Epoch-13 lr: 0.00016393360486982356
epoch 13 training time: 15.242
---------------
2023-09-25 01:02:44.474240
current #epochs=14, #steps=507
start validation
acc: 0.737089
AUC: 0.907283
Avg Precision: 0.461818
Avg Recall: 1.000000
d_prime: 1.872712
train_loss: 0.057888
valid_loss: 1.324254
validation finished
normal learning rate scheduler step
Epoch-14 lr: 0.0001244986268787325
Epoch-14 lr: 0.0001244986268787325
epoch 14 training time: 15.021
---------------
2023-09-25 01:02:59.495319
current #epochs=15, #steps=546
start validation
acc: 0.751174
AUC: 0.906180
Avg Precision: 0.460571
Avg Recall: 1.000000
d_prime: 1.863359
train_loss: 0.057221
valid_loss: 1.326089
validation finished
normal learning rate scheduler step
Epoch-15 lr: 9.454991310047764e-05
Epoch-15 lr: 9.454991310047764e-05
epoch 15 training time: 15.250
---------------
2023-09-25 01:03:14.745013
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00776	Per Sample Data Time 0.00201	Per Sample DNN Time 0.00575	Train Loss 0.0395	
start validation
acc: 0.760563
AUC: 0.906756
Avg Precision: 0.461805
Avg Recall: 1.000000
d_prime: 1.868234
train_loss: 0.049670
valid_loss: 1.325675
validation finished
normal learning rate scheduler step
Epoch-16 lr: 7.180549931699686e-05
Epoch-16 lr: 7.180549931699686e-05
epoch 16 training time: 15.294
---------------
2023-09-25 01:03:30.039096
current #epochs=17, #steps=624
start validation
acc: 0.755869
AUC: 0.907349
Avg Precision: 0.463782
Avg Recall: 1.000000
d_prime: 1.873278
train_loss: 0.039852
valid_loss: 1.324144
validation finished
normal learning rate scheduler step
Epoch-17 lr: 5.453235823372945e-05
Epoch-17 lr: 5.453235823372945e-05
epoch 17 training time: 15.219
---------------
2023-09-25 01:03:45.257787
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00652	Per Sample Data Time 0.00094	Per Sample DNN Time 0.00558	Train Loss 0.0426	
start validation
acc: 0.765258
AUC: 0.908239
Avg Precision: 0.464666
Avg Recall: 1.000000
d_prime: 1.880887
train_loss: 0.041929
valid_loss: 1.322597
validation finished
normal learning rate scheduler step
Epoch-18 lr: 4.141435019348005e-05
Epoch-18 lr: 4.141435019348005e-05
epoch 18 training time: 16.148
---------------
2023-09-25 01:04:01.405696
current #epochs=19, #steps=702
start validation
acc: 0.760563
AUC: 0.908571
Avg Precision: 0.465476
Avg Recall: 1.000000
d_prime: 1.883743
train_loss: 0.036736
valid_loss: 1.321055
validation finished
normal learning rate scheduler step
Epoch-19 lr: 3.145193894965915e-05
Epoch-19 lr: 3.145193894965915e-05
epoch 19 training time: 15.256
---------------
2023-09-25 01:04:16.661841
current #epochs=20, #steps=741
start validation
acc: 0.755869
AUC: 0.908876
Avg Precision: 0.465832
Avg Recall: 1.000000
d_prime: 1.886370
train_loss: 0.034004
valid_loss: 1.320598
validation finished
normal learning rate scheduler step
Epoch-20 lr: 2.388603126866933e-05
Epoch-20 lr: 2.388603126866933e-05
epoch 20 training time: 15.572
---------------
2023-09-25 01:04:32.233685
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00733	Per Sample Data Time 0.00166	Per Sample DNN Time 0.00567	Train Loss 0.0602	
start validation
acc: 0.755869
AUC: 0.908778
Avg Precision: 0.466837
Avg Recall: 1.000000
d_prime: 1.885522
train_loss: 0.060480
valid_loss: 1.319686
validation finished
normal learning rate scheduler step
Epoch-21 lr: 1.814013726406626e-05
Epoch-21 lr: 1.814013726406626e-05
epoch 21 training time: 15.200
---------------
2023-09-25 01:04:47.433964
current #epochs=22, #steps=819
start validation
acc: 0.755869
AUC: 0.908380
Avg Precision: 0.466841
Avg Recall: 1.000000
d_prime: 1.882103
train_loss: 0.043944
valid_loss: 1.319717
validation finished
normal learning rate scheduler step
Epoch-22 lr: 1.3776444326722061e-05
Epoch-22 lr: 1.3776444326722061e-05
epoch 22 training time: 16.540
---------------
2023-09-25 01:05:03.974085
current #epochs=23, #steps=858
start validation
acc: 0.755869
AUC: 0.908278
Avg Precision: 0.466841
Avg Recall: 1.000000
d_prime: 1.881223
train_loss: 0.039659
valid_loss: 1.320029
validation finished
normal learning rate scheduler step
Epoch-23 lr: 1.0462457671873724e-05
Epoch-23 lr: 1.0462457671873724e-05
epoch 23 training time: 15.743
---------------
2023-09-25 01:05:19.717504
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01429	Per Sample Data Time 0.00802	Per Sample DNN Time 0.00627	Train Loss 0.0517	
start validation
acc: 0.755869
AUC: 0.908291
Avg Precision: 0.466654
Avg Recall: 1.000000
d_prime: 1.881337
train_loss: 0.051486
valid_loss: 1.320056
validation finished
normal learning rate scheduler step
Epoch-24 lr: 7.945665655064912e-06
Epoch-24 lr: 7.945665655064912e-06
epoch 24 training time: 15.387
---------------
2023-09-25 01:05:35.104718
current #epochs=25, #steps=936
start validation
acc: 0.755869
AUC: 0.908642
Avg Precision: 0.466837
Avg Recall: 1.000000
d_prime: 1.884354
train_loss: 0.048427
valid_loss: 1.320186
validation finished
normal learning rate scheduler step
Epoch-25 lr: 6.034299462142676e-06
Epoch-25 lr: 6.034299462142676e-06
epoch 25 training time: 15.276
---------------
2023-09-25 01:05:50.380381
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00687	Per Sample Data Time 0.00135	Per Sample DNN Time 0.00552	Train Loss 0.0344	
start validation
acc: 0.755869
AUC: 0.908540
Avg Precision: 0.466841
Avg Recall: 1.000000
d_prime: 1.883472
train_loss: 0.038449
valid_loss: 1.320102
validation finished
normal learning rate scheduler step
Epoch-26 lr: 4.582721143772807e-06
Epoch-26 lr: 4.582721143772807e-06
epoch 26 training time: 15.451
---------------
2023-09-25 01:06:05.830977
current #epochs=27, #steps=1014
start validation
acc: 0.755869
AUC: 0.908586
Avg Precision: 0.467023
Avg Recall: 1.000000
d_prime: 1.883875
train_loss: 0.042074
valid_loss: 1.320106
validation finished
normal learning rate scheduler step
Epoch-27 lr: 3.4803266250437517e-06
Epoch-27 lr: 3.4803266250437517e-06
epoch 27 training time: 15.519
---------------
2023-09-25 01:06:21.350421
current #epochs=28, #steps=1053
start validation
acc: 0.755869
AUC: 0.908565
Avg Precision: 0.467023
Avg Recall: 1.000000
d_prime: 1.883691
train_loss: 0.044525
valid_loss: 1.320181
validation finished
normal learning rate scheduler step
Epoch-28 lr: 2.6431181468345804e-06
Epoch-28 lr: 2.6431181468345804e-06
epoch 28 training time: 16.704
---------------
2023-09-25 01:06:38.054370
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00948	Per Sample Data Time 0.00363	Per Sample DNN Time 0.00586	Train Loss 0.0542	
start validation
acc: 0.755869
AUC: 0.908426
Avg Precision: 0.466841
Avg Recall: 1.000000
d_prime: 1.882497
train_loss: 0.041574
valid_loss: 1.320145
validation finished
normal learning rate scheduler step
Epoch-29 lr: 2.0073039949342237e-06
Epoch-29 lr: 2.0073039949342237e-06
epoch 29 training time: 16.935
---------------
2023-09-25 01:06:54.989178
current #epochs=30, #steps=1131
start validation
acc: 0.755869
AUC: 0.908391
Avg Precision: 0.466841
Avg Recall: 1.000000
d_prime: 1.882192
train_loss: 0.045404
valid_loss: 1.320046
validation finished
normal learning rate scheduler step
Epoch-30 lr: 1.5244378435766784e-06
Epoch-30 lr: 1.5244378435766784e-06
epoch 30 training time: 15.330
---------------
2023-09-25 01:07:10.319310
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00670	Per Sample Data Time 0.00111	Per Sample DNN Time 0.00559	Train Loss 0.0455	
start validation
acc: 0.755869
AUC: 0.908454
Avg Precision: 0.466841
Avg Recall: 1.000000
d_prime: 1.882736
train_loss: 0.049894
valid_loss: 1.320009
validation finished
normal learning rate scheduler step
Epoch-31 lr: 1.1577273521068562e-06
Epoch-31 lr: 1.1577273521068562e-06
epoch 31 training time: 15.237
---------------
2023-09-25 01:07:25.556793
current #epochs=32, #steps=1209
start validation
acc: 0.755869
AUC: 0.908433
Avg Precision: 0.466841
Avg Recall: 1.000000
d_prime: 1.882552
train_loss: 0.043215
valid_loss: 1.320014
validation finished
normal learning rate scheduler step
Epoch-32 lr: 8.792307455918486e-07
Epoch-32 lr: 8.792307455918486e-07
epoch 32 training time: 15.312
---------------
2023-09-25 01:07:40.869118
current #epochs=33, #steps=1248
start validation
acc: 0.755869
AUC: 0.908443
Avg Precision: 0.466841
Avg Recall: 1.000000
d_prime: 1.882644
train_loss: 0.038835
valid_loss: 1.320037
validation finished
normal learning rate scheduler step
Epoch-33 lr: 6.677277707805656e-07
Epoch-33 lr: 6.677277707805656e-07
epoch 33 training time: 15.369
---------------
2023-09-25 01:07:56.238187
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00795	Per Sample Data Time 0.00234	Per Sample DNN Time 0.00562	Train Loss 0.0443	
start validation
acc: 0.755869
AUC: 0.908469
Avg Precision: 0.466841
Avg Recall: 1.000000
d_prime: 1.882864
train_loss: 0.048923
valid_loss: 1.319994
validation finished
normal learning rate scheduler step
Epoch-34 lr: 5.071028033391341e-07
Epoch-34 lr: 5.071028033391341e-07
epoch 34 training time: 15.243
---------------
2023-09-25 01:08:11.481519
current #epochs=35, #steps=1326
start validation
acc: 0.755869
AUC: 0.908367
Avg Precision: 0.466663
Avg Recall: 1.000000
d_prime: 1.881991
train_loss: 0.057279
valid_loss: 1.319976
validation finished
normal learning rate scheduler step
Epoch-35 lr: 3.8511690603162953e-07
Epoch-35 lr: 3.8511690603162953e-07
epoch 35 training time: 15.341
---------------
2023-09-25 01:08:26.822972
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00657	Per Sample Data Time 0.00102	Per Sample DNN Time 0.00556	Train Loss 0.0408	
start validation
acc: 0.755869
AUC: 0.908389
Avg Precision: 0.466663
Avg Recall: 1.000000
d_prime: 1.882174
train_loss: 0.042541
valid_loss: 1.319968
validation finished
normal learning rate scheduler step
Epoch-36 lr: 2.9247527391834713e-07
Epoch-36 lr: 2.9247527391834713e-07
epoch 36 training time: 15.479
---------------
2023-09-25 01:08:42.301761
current #epochs=37, #steps=1404
start validation
acc: 0.755869
AUC: 0.908389
Avg Precision: 0.466663
Avg Recall: 1.000000
d_prime: 1.882174
train_loss: 0.046992
valid_loss: 1.319964
validation finished
normal learning rate scheduler step
Epoch-37 lr: 2.2211900987433325e-07
Epoch-37 lr: 2.2211900987433325e-07
epoch 37 training time: 17.011
---------------
2023-09-25 01:08:59.313349
current #epochs=38, #steps=1443
start validation
acc: 0.755869
AUC: 0.908389
Avg Precision: 0.466663
Avg Recall: 1.000000
d_prime: 1.882174
train_loss: 0.036065
valid_loss: 1.319962
validation finished
normal learning rate scheduler step
Epoch-38 lr: 1.6868726674422384e-07
Epoch-38 lr: 1.6868726674422384e-07
epoch 38 training time: 15.247
---------------
2023-09-25 01:09:14.559976
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00737	Per Sample Data Time 0.00173	Per Sample DNN Time 0.00564	Train Loss 0.0484	
start validation
acc: 0.755869
AUC: 0.908389
Avg Precision: 0.466663
Avg Recall: 1.000000
d_prime: 1.882174
train_loss: 0.043264
valid_loss: 1.319960
validation finished
normal learning rate scheduler step
Epoch-39 lr: 1.281087736602821e-07
Epoch-39 lr: 1.281087736602821e-07
epoch 39 training time: 15.227
---------------
2023-09-25 01:09:29.786828
current #epochs=40, #steps=1521
start validation
acc: 0.755869
AUC: 0.908389
Avg Precision: 0.466663
Avg Recall: 1.000000
d_prime: 1.882174
train_loss: 0.030439
valid_loss: 1.319958
validation finished
normal learning rate scheduler step
Epoch-40 lr: 9.729162257176333e-08
Epoch-40 lr: 9.729162257176333e-08
epoch 40 training time: 15.260
---------------
2023-09-25 01:09:45.047205
current #epochs=41, #steps=1560
start validation
acc: 0.755869
AUC: 0.908389
Avg Precision: 0.466663
Avg Recall: 1.000000
d_prime: 1.882174
train_loss: 0.035979
valid_loss: 1.319959
validation finished
normal learning rate scheduler step
Epoch-41 lr: 7.388767804262504e-08
Epoch-41 lr: 7.388767804262504e-08
epoch 41 training time: 15.450
---------------
2023-09-25 01:10:00.497422
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02247	Per Sample Data Time 0.01568	Per Sample DNN Time 0.00678	Train Loss 0.0592	
start validation
acc: 0.755869
AUC: 0.908389
Avg Precision: 0.466663
Avg Recall: 1.000000
d_prime: 1.882174
train_loss: 0.040426
valid_loss: 1.319958
validation finished
normal learning rate scheduler step
Epoch-42 lr: 5.6113659349279657e-08
Epoch-42 lr: 5.6113659349279657e-08
epoch 42 training time: 15.276
---------------
2023-09-25 01:10:15.773592
current #epochs=43, #steps=1638
start validation
acc: 0.755869
AUC: 0.908404
Avg Precision: 0.466663
Avg Recall: 1.000000
d_prime: 1.882303
train_loss: 0.039587
valid_loss: 1.319958
validation finished
normal learning rate scheduler step
Epoch-43 lr: 4.261526209756548e-08
Epoch-43 lr: 4.261526209756548e-08
epoch 43 training time: 15.524
---------------
2023-09-25 01:10:31.298044
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00708	Per Sample Data Time 0.00142	Per Sample DNN Time 0.00566	Train Loss 0.0379	
start validation
acc: 0.755869
AUC: 0.908404
Avg Precision: 0.466663
Avg Recall: 1.000000
d_prime: 1.882303
train_loss: 0.043482
valid_loss: 1.319958
validation finished
normal learning rate scheduler step
Epoch-44 lr: 3.2363966005854765e-08
Epoch-44 lr: 3.2363966005854765e-08
epoch 44 training time: 15.334
---------------
2023-09-25 01:10:46.631963
current #epochs=45, #steps=1716
start validation
acc: 0.755869
AUC: 0.908404
Avg Precision: 0.466663
Avg Recall: 1.000000
d_prime: 1.882303
train_loss: 0.040764
valid_loss: 1.319958
validation finished
normal learning rate scheduler step
Epoch-45 lr: 2.4578666047626162e-08
Epoch-45 lr: 2.4578666047626162e-08
epoch 45 training time: 15.206
---------------
2023-09-25 01:11:01.838411
current #epochs=46, #steps=1755
start validation
acc: 0.755869
AUC: 0.908404
Avg Precision: 0.466663
Avg Recall: 1.000000
d_prime: 1.882303
train_loss: 0.041809
valid_loss: 1.319957
validation finished
normal learning rate scheduler step
Epoch-46 lr: 1.8666155580915057e-08
Epoch-46 lr: 1.8666155580915057e-08
epoch 46 training time: 15.261
---------------
2023-09-25 01:11:17.099889
current #epochs=47, #steps=1794
Epoch: [47][6/39]	Per Sample Total Time 0.01011	Per Sample Data Time 0.00445	Per Sample DNN Time 0.00566	Train Loss 0.0206	
start validation
acc: 0.755869
AUC: 0.908404
Avg Precision: 0.466663
Avg Recall: 1.000000
d_prime: 1.882303
train_loss: 0.040668
valid_loss: 1.319957
validation finished
normal learning rate scheduler step
Epoch-47 lr: 1.4175926533025891e-08
Epoch-47 lr: 1.4175926533025891e-08
epoch 47 training time: 15.220
---------------
2023-09-25 01:11:32.319303
current #epochs=48, #steps=1833
start validation
acc: 0.755869
AUC: 0.908404
Avg Precision: 0.466663
Avg Recall: 1.000000
d_prime: 1.882303
train_loss: 0.038490
valid_loss: 1.319958
validation finished
normal learning rate scheduler step
Epoch-48 lr: 1.0765842607420081e-08
Epoch-48 lr: 1.0765842607420081e-08
epoch 48 training time: 15.086
---------------
2023-09-25 01:11:47.405188
current #epochs=49, #steps=1872
Epoch: [49][28/39]	Per Sample Total Time 0.00682	Per Sample Data Time 0.00121	Per Sample DNN Time 0.00561	Train Loss 0.0598	
start validation
acc: 0.755869
AUC: 0.908404
Avg Precision: 0.466663
Avg Recall: 1.000000
d_prime: 1.882303
train_loss: 0.055560
valid_loss: 1.319958
validation finished
normal learning rate scheduler step
Epoch-49 lr: 8.176069957594631e-09
Epoch-49 lr: 8.176069957594631e-09
epoch 49 training time: 15.339
---------------
2023-09-25 01:12:02.744399
current #epochs=50, #steps=1911
start validation
[I 2023-09-25 01:12:18,043] Trial 93 finished with value: 0.4666625925798314 and parameters: {'warmup': 'True', 'num_epochs': 50, 'batch_size': 36, 'lr-adaptschedule': 'True', 'lr': 0.0008544537380868432, 'head-lr': 1, 'lr-scheduler-start': 8, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7594454290052025}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.755869
AUC: 0.908404
Avg Precision: 0.466663
Avg Recall: 1.000000
d_prime: 1.882303
train_loss: 0.034224
valid_loss: 1.319958
validation finished
normal learning rate scheduler step
Epoch-50 lr: 6.209278956522002e-09
Epoch-50 lr: 6.209278956522002e-09
epoch 50 training time: 15.285
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f583d30>
The learning rate scheduler starts at 7 epoch with decay rate of 0.738 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-25 01:12:18.083475
current #epochs=1, #steps=0
start validation
acc: 0.755869
AUC: 0.914929
Avg Precision: 0.454616
Avg Recall: 1.000000
d_prime: 1.939940
train_loss: 0.061516
valid_loss: 1.295261
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0006499668083278202
Epoch-1 lr: 0.0006499668083278202
epoch 1 training time: 17.745
---------------
2023-09-25 01:12:35.829353
current #epochs=2, #steps=39
start validation
acc: 0.737089
AUC: 0.905176
Avg Precision: 0.464835
Avg Recall: 1.000000
d_prime: 1.854915
train_loss: 0.077733
valid_loss: 1.315099
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0006499668083278202
Epoch-2 lr: 0.0006499668083278202
epoch 2 training time: 15.270
---------------
2023-09-25 01:12:51.099039
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00712	Per Sample Data Time 0.00152	Per Sample DNN Time 0.00560	Train Loss 0.0667	
start validation
acc: 0.727700
AUC: 0.902197
Avg Precision: 0.482160
Avg Recall: 1.000000
d_prime: 1.830236
train_loss: 0.074927
valid_loss: 1.333187
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0006499668083278202
Epoch-3 lr: 0.0006499668083278202
epoch 3 training time: 15.982
---------------
2023-09-25 01:13:07.080988
current #epochs=4, #steps=117
start validation
acc: 0.727700
AUC: 0.911666
Avg Precision: 0.402257
Avg Recall: 1.000000
d_prime: 1.910724
train_loss: 0.058106
valid_loss: 1.327476
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0006499668083278202
Epoch-4 lr: 0.0006499668083278202
epoch 4 training time: 17.025
---------------
2023-09-25 01:13:24.106489
current #epochs=5, #steps=156
start validation
acc: 0.741784
AUC: 0.908066
Avg Precision: 0.432035
Avg Recall: 1.000000
d_prime: 1.879405
train_loss: 0.057456
valid_loss: 1.332453
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0006499668083278202
Epoch-5 lr: 0.0006499668083278202
epoch 5 training time: 15.470
---------------
2023-09-25 01:13:39.576678
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01142	Per Sample Data Time 0.00529	Per Sample DNN Time 0.00613	Train Loss 0.0720	
start validation
acc: 0.755869
AUC: 0.916255
Avg Precision: 0.452365
Avg Recall: 1.000000
d_prime: 1.952056
train_loss: 0.067006
valid_loss: 1.315843
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0006499668083278202
Epoch-6 lr: 0.0006499668083278202
epoch 6 training time: 16.177
---------------
2023-09-25 01:13:55.753452
current #epochs=7, #steps=234
start validation
acc: 0.737089
AUC: 0.902130
Avg Precision: 0.466163
Avg Recall: 1.000000
d_prime: 1.829688
train_loss: 0.051187
valid_loss: 1.325309
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.000479715693980849
Epoch-7 lr: 0.000479715693980849
epoch 7 training time: 15.258
---------------
2023-09-25 01:14:11.011657
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00682	Per Sample Data Time 0.00130	Per Sample DNN Time 0.00552	Train Loss 0.0445	
start validation
acc: 0.718310
AUC: 0.899237
Avg Precision: 0.475570
Avg Recall: 1.000000
d_prime: 1.806256
train_loss: 0.038830
valid_loss: 1.330636
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0003540598444458714
Epoch-8 lr: 0.0003540598444458714
epoch 8 training time: 15.204
---------------
2023-09-25 01:14:26.215876
current #epochs=9, #steps=312
start validation
acc: 0.718310
AUC: 0.901445
Avg Precision: 0.473510
Avg Recall: 1.000000
d_prime: 1.824092
train_loss: 0.061199
valid_loss: 1.330283
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.0002613180578037106
Epoch-9 lr: 0.0002613180578037106
epoch 9 training time: 15.185
---------------
2023-09-25 01:14:41.399871
current #epochs=10, #steps=351
start validation
acc: 0.723005
AUC: 0.904046
Avg Precision: 0.468050
Avg Recall: 1.000000
d_prime: 1.845485
train_loss: 0.056010
valid_loss: 1.325570
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00019286888475358627
Epoch-10 lr: 0.00019286888475358627
epoch 10 training time: 15.390
---------------
2023-09-25 01:14:56.790429
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00871	Per Sample Data Time 0.00289	Per Sample DNN Time 0.00581	Train Loss 0.0374	
start validation
acc: 0.727700
AUC: 0.905574
Avg Precision: 0.472709
Avg Recall: 1.000000
d_prime: 1.858254
train_loss: 0.038563
valid_loss: 1.323601
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00014234916262095354
Epoch-11 lr: 0.00014234916262095354
epoch 11 training time: 15.230
---------------
2023-09-25 01:15:12.019748
current #epochs=12, #steps=429
start validation
acc: 0.727700
AUC: 0.907854
Avg Precision: 0.490953
Avg Recall: 1.000000
d_prime: 1.877589
train_loss: 0.066407
valid_loss: 1.318810
validation finished
normal learning rate scheduler step
Epoch-12 lr: 0.000105062483898196
Epoch-12 lr: 0.000105062483898196
epoch 12 training time: 15.213
---------------
2023-09-25 01:15:27.233029
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00664	Per Sample Data Time 0.00107	Per Sample DNN Time 0.00557	Train Loss 0.0404	
start validation
acc: 0.732394
AUC: 0.908965
Avg Precision: 0.483223
Avg Recall: 1.000000
d_prime: 1.887141
train_loss: 0.036520
valid_loss: 1.319463
validation finished
normal learning rate scheduler step
Epoch-13 lr: 7.754260945145806e-05
Epoch-13 lr: 7.754260945145806e-05
epoch 13 training time: 15.219
---------------
2023-09-25 01:15:42.451971
current #epochs=14, #steps=507
start validation
acc: 0.732394
AUC: 0.910129
Avg Precision: 0.483465
Avg Recall: 1.000000
d_prime: 1.897238
train_loss: 0.056662
valid_loss: 1.318768
validation finished
normal learning rate scheduler step
Epoch-14 lr: 5.723124047179127e-05
Epoch-14 lr: 5.723124047179127e-05
epoch 14 training time: 16.019
---------------
2023-09-25 01:15:58.470872
current #epochs=15, #steps=546
start validation
acc: 0.737089
AUC: 0.910371
Avg Precision: 0.484358
Avg Recall: 1.000000
d_prime: 1.899348
train_loss: 0.049451
valid_loss: 1.318706
validation finished
normal learning rate scheduler step
Epoch-15 lr: 4.224019425075474e-05
Epoch-15 lr: 4.224019425075474e-05
epoch 15 training time: 15.284
---------------
2023-09-25 01:16:13.754783
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00791	Per Sample Data Time 0.00214	Per Sample DNN Time 0.00577	Train Loss 0.0494	
start validation
acc: 0.737089
AUC: 0.910709
Avg Precision: 0.485154
Avg Recall: 1.000000
d_prime: 1.902310
train_loss: 0.036517
valid_loss: 1.318119
validation finished
normal learning rate scheduler step
Epoch-16 lr: 3.117587519740946e-05
Epoch-16 lr: 3.117587519740946e-05
epoch 16 training time: 17.451
---------------
2023-09-25 01:16:31.206122
current #epochs=17, #steps=624
start validation
acc: 0.737089
AUC: 0.910289
Avg Precision: 0.485341
Avg Recall: 1.000000
d_prime: 1.898630
train_loss: 0.050150
valid_loss: 1.317855
validation finished
normal learning rate scheduler step
Epoch-17 lr: 2.3009723595366367e-05
Epoch-17 lr: 2.3009723595366367e-05
epoch 17 training time: 15.346
---------------
2023-09-25 01:16:46.551964
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00651	Per Sample Data Time 0.00095	Per Sample DNN Time 0.00556	Train Loss 0.0443	
start validation
acc: 0.737089
AUC: 0.909784
Avg Precision: 0.485089
Avg Recall: 1.000000
d_prime: 1.894238
train_loss: 0.043577
valid_loss: 1.318123
validation finished
normal learning rate scheduler step
Epoch-18 lr: 1.6982598774938446e-05
Epoch-18 lr: 1.6982598774938446e-05
epoch 18 training time: 16.240
---------------
2023-09-25 01:17:02.791796
current #epochs=19, #steps=702
start validation
acc: 0.732394
AUC: 0.909497
Avg Precision: 0.484906
Avg Recall: 1.000000
d_prime: 1.891743
train_loss: 0.048994
valid_loss: 1.318425
validation finished
normal learning rate scheduler step
Epoch-19 lr: 1.2534207981908125e-05
Epoch-19 lr: 1.2534207981908125e-05
epoch 19 training time: 16.964
---------------
2023-09-25 01:17:19.755175
current #epochs=20, #steps=741
start validation
acc: 0.727700
AUC: 0.909158
Avg Precision: 0.484460
Avg Recall: 1.000000
d_prime: 1.888803
train_loss: 0.049392
valid_loss: 1.318951
validation finished
normal learning rate scheduler step
Epoch-20 lr: 9.251020519048845e-06
Epoch-20 lr: 9.251020519048845e-06
epoch 20 training time: 15.097
---------------
2023-09-25 01:17:34.852713
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00731	Per Sample Data Time 0.00164	Per Sample DNN Time 0.00566	Train Loss 0.0288	
start validation
acc: 0.727700
AUC: 0.909166
Avg Precision: 0.484468
Avg Recall: 1.000000
d_prime: 1.888873
train_loss: 0.041521
valid_loss: 1.319006
validation finished
normal learning rate scheduler step
Epoch-21 lr: 6.827825161940103e-06
Epoch-21 lr: 6.827825161940103e-06
epoch 21 training time: 15.376
---------------
2023-09-25 01:17:50.228443
current #epochs=22, #steps=819
start validation
acc: 0.727700
AUC: 0.909227
Avg Precision: 0.484638
Avg Recall: 1.000000
d_prime: 1.889404
train_loss: 0.040524
valid_loss: 1.319159
validation finished
normal learning rate scheduler step
Epoch-22 lr: 5.0393571548164286e-06
Epoch-22 lr: 5.0393571548164286e-06
epoch 22 training time: 15.310
---------------
2023-09-25 01:18:05.537967
current #epochs=23, #steps=858
start validation
acc: 0.723005
AUC: 0.909070
Avg Precision: 0.484638
Avg Recall: 1.000000
d_prime: 1.888043
train_loss: 0.053211
valid_loss: 1.319419
validation finished
normal learning rate scheduler step
Epoch-23 lr: 3.7193571791143513e-06
Epoch-23 lr: 3.7193571791143513e-06
epoch 23 training time: 15.317
---------------
2023-09-25 01:18:20.855321
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01413	Per Sample Data Time 0.00788	Per Sample DNN Time 0.00625	Train Loss 0.0242	
start validation
acc: 0.723005
AUC: 0.908873
Avg Precision: 0.484656
Avg Recall: 1.000000
d_prime: 1.886343
train_loss: 0.034982
valid_loss: 1.319691
validation finished
normal learning rate scheduler step
Epoch-24 lr: 2.745115577412054e-06
Epoch-24 lr: 2.745115577412054e-06
epoch 24 training time: 15.238
---------------
2023-09-25 01:18:36.093220
current #epochs=25, #steps=936
start validation
acc: 0.723005
AUC: 0.908994
Avg Precision: 0.484377
Avg Recall: 1.000000
d_prime: 1.887390
train_loss: 0.040960
valid_loss: 1.319770
validation finished
normal learning rate scheduler step
Epoch-25 lr: 2.026065035018953e-06
Epoch-25 lr: 2.026065035018953e-06
epoch 25 training time: 15.254
---------------
2023-09-25 01:18:51.347258
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00690	Per Sample Data Time 0.00135	Per Sample DNN Time 0.00556	Train Loss 0.0351	
start validation
acc: 0.723005
AUC: 0.909111
Avg Precision: 0.485078
Avg Recall: 1.000000
d_prime: 1.888398
train_loss: 0.034567
valid_loss: 1.319787
validation finished
normal learning rate scheduler step
Epoch-26 lr: 1.4953612736394386e-06
Epoch-26 lr: 1.4953612736394386e-06
epoch 26 training time: 15.178
---------------
2023-09-25 01:19:06.525141
current #epochs=27, #steps=1014
start validation
acc: 0.723005
AUC: 0.909131
Avg Precision: 0.485253
Avg Recall: 1.000000
d_prime: 1.888575
train_loss: 0.044845
valid_loss: 1.319741
validation finished
normal learning rate scheduler step
Epoch-27 lr: 1.1036690827052578e-06
Epoch-27 lr: 1.1036690827052578e-06
epoch 27 training time: 15.150
---------------
2023-09-25 01:19:21.675343
current #epochs=28, #steps=1053
start validation
acc: 0.723005
AUC: 0.909045
Avg Precision: 0.484985
Avg Recall: 1.000000
d_prime: 1.887826
train_loss: 0.044548
valid_loss: 1.319757
validation finished
normal learning rate scheduler step
Epoch-28 lr: 8.145760262701373e-07
Epoch-28 lr: 8.145760262701373e-07
epoch 28 training time: 15.263
---------------
2023-09-25 01:19:36.938203
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00946	Per Sample Data Time 0.00349	Per Sample DNN Time 0.00597	Train Loss 0.0499	
start validation
acc: 0.723005
AUC: 0.909009
Avg Precision: 0.484810
Avg Recall: 1.000000
d_prime: 1.887519
train_loss: 0.045894
valid_loss: 1.319755
validation finished
normal learning rate scheduler step
Epoch-29 lr: 6.01207475113488e-07
Epoch-29 lr: 6.01207475113488e-07
epoch 29 training time: 15.322
---------------
2023-09-25 01:19:52.260410
current #epochs=30, #steps=1131
start validation
acc: 0.723005
AUC: 0.908938
Avg Precision: 0.484810
Avg Recall: 1.000000
d_prime: 1.886907
train_loss: 0.042019
valid_loss: 1.319751
validation finished
normal learning rate scheduler step
Epoch-30 lr: 4.437282911300261e-07
Epoch-30 lr: 4.437282911300261e-07
epoch 30 training time: 15.243
---------------
2023-09-25 01:20:07.502941
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00674	Per Sample Data Time 0.00112	Per Sample DNN Time 0.00562	Train Loss 0.0564	
start validation
acc: 0.723005
AUC: 0.908938
Avg Precision: 0.484810
Avg Recall: 1.000000
d_prime: 1.886907
train_loss: 0.054235
valid_loss: 1.319747
validation finished
normal learning rate scheduler step
Epoch-31 lr: 3.2749891593082073e-07
Epoch-31 lr: 3.2749891593082073e-07
epoch 31 training time: 15.273
---------------
2023-09-25 01:20:22.776435
current #epochs=32, #steps=1209
start validation
acc: 0.723005
AUC: 0.908837
Avg Precision: 0.484549
Avg Recall: 1.000000
d_prime: 1.886030
train_loss: 0.041817
valid_loss: 1.319739
validation finished
normal learning rate scheduler step
Epoch-32 lr: 2.417144502161878e-07
Epoch-32 lr: 2.417144502161878e-07
epoch 32 training time: 15.284
---------------
2023-09-25 01:20:38.060430
current #epochs=33, #steps=1248
start validation
acc: 0.723005
AUC: 0.908851
Avg Precision: 0.484549
Avg Recall: 1.000000
d_prime: 1.886159
train_loss: 0.049218
valid_loss: 1.319754
validation finished
normal learning rate scheduler step
Epoch-33 lr: 1.7840021020300273e-07
Epoch-33 lr: 1.7840021020300273e-07
epoch 33 training time: 17.315
---------------
2023-09-25 01:20:55.375406
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00799	Per Sample Data Time 0.00230	Per Sample DNN Time 0.00569	Train Loss 0.0397	
start validation
acc: 0.723005
AUC: 0.908837
Avg Precision: 0.484549
Avg Recall: 1.000000
d_prime: 1.886030
train_loss: 0.043293
valid_loss: 1.319768
validation finished
normal learning rate scheduler step
Epoch-34 lr: 1.3167038616024e-07
Epoch-34 lr: 1.3167038616024e-07
epoch 34 training time: 15.258
---------------
2023-09-25 01:21:10.633572
current #epochs=35, #steps=1326
start validation
acc: 0.723005
AUC: 0.908837
Avg Precision: 0.484549
Avg Recall: 1.000000
d_prime: 1.886030
train_loss: 0.039253
valid_loss: 1.319764
validation finished
normal learning rate scheduler step
Epoch-35 lr: 9.718088656879238e-08
Epoch-35 lr: 9.718088656879238e-08
epoch 35 training time: 15.165
---------------
2023-09-25 01:21:25.798424
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00654	Per Sample Data Time 0.00098	Per Sample DNN Time 0.00556	Train Loss 0.0405	
start validation
acc: 0.723005
AUC: 0.908837
Avg Precision: 0.484549
Avg Recall: 1.000000
d_prime: 1.886030
train_loss: 0.042615
valid_loss: 1.319767
validation finished
normal learning rate scheduler step
Epoch-36 lr: 7.172550327909872e-08
Epoch-36 lr: 7.172550327909872e-08
epoch 36 training time: 15.222
---------------
2023-09-25 01:21:41.020053
current #epochs=37, #steps=1404
start validation
acc: 0.723005
AUC: 0.908837
Avg Precision: 0.484549
Avg Recall: 1.000000
d_prime: 1.886030
train_loss: 0.035934
valid_loss: 1.319768
validation finished
normal learning rate scheduler step
Epoch-37 lr: 5.2937856427130665e-08
Epoch-37 lr: 5.2937856427130665e-08
epoch 37 training time: 16.022
---------------
2023-09-25 01:21:57.042473
current #epochs=38, #steps=1443
start validation
acc: 0.723005
AUC: 0.908837
Avg Precision: 0.484549
Avg Recall: 1.000000
d_prime: 1.886030
train_loss: 0.038782
valid_loss: 1.319769
validation finished
normal learning rate scheduler step
Epoch-38 lr: 3.9071411352733466e-08
Epoch-38 lr: 3.9071411352733466e-08
epoch 38 training time: 15.063
---------------
2023-09-25 01:22:12.106212
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00742	Per Sample Data Time 0.00186	Per Sample DNN Time 0.00556	Train Loss 0.0475	
start validation
acc: 0.723005
AUC: 0.908837
Avg Precision: 0.484549
Avg Recall: 1.000000
d_prime: 1.886030
train_loss: 0.046992
valid_loss: 1.319769
validation finished
normal learning rate scheduler step
Epoch-39 lr: 2.883711748313518e-08
Epoch-39 lr: 2.883711748313518e-08
epoch 39 training time: 15.192
---------------
2023-09-25 01:22:27.297722
current #epochs=40, #steps=1521
start validation
acc: 0.723005
AUC: 0.908837
Avg Precision: 0.484549
Avg Recall: 1.000000
d_prime: 1.886030
train_loss: 0.052503
valid_loss: 1.319769
validation finished
normal learning rate scheduler step
Epoch-40 lr: 2.128357578969214e-08
Epoch-40 lr: 2.128357578969214e-08
epoch 40 training time: 15.337
---------------
2023-09-25 01:22:42.634674
current #epochs=41, #steps=1560
start validation
acc: 0.723005
AUC: 0.908837
Avg Precision: 0.484549
Avg Recall: 1.000000
d_prime: 1.886030
train_loss: 0.040437
valid_loss: 1.319768
validation finished
normal learning rate scheduler step
Epoch-41 lr: 1.570859496135465e-08
Epoch-41 lr: 1.570859496135465e-08
epoch 41 training time: 15.313
---------------
2023-09-25 01:22:57.948301
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02268	Per Sample Data Time 0.01572	Per Sample DNN Time 0.00696	Train Loss 0.0574	
start validation
acc: 0.723005
AUC: 0.908837
Avg Precision: 0.484549
Avg Recall: 1.000000
d_prime: 1.886030
train_loss: 0.029780
valid_loss: 1.319769
validation finished
normal learning rate scheduler step
Epoch-42 lr: 1.1593914391932447e-08
Epoch-42 lr: 1.1593914391932447e-08
epoch 42 training time: 15.300
---------------
2023-09-25 01:23:13.248025
current #epochs=43, #steps=1638
start validation
acc: 0.723005
AUC: 0.908837
Avg Precision: 0.484549
Avg Recall: 1.000000
d_prime: 1.886030
train_loss: 0.034417
valid_loss: 1.319769
validation finished
normal learning rate scheduler step
Epoch-43 lr: 8.557025708419345e-09
Epoch-43 lr: 8.557025708419345e-09
epoch 43 training time: 17.133
---------------
2023-09-25 01:23:30.381591
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00703	Per Sample Data Time 0.00143	Per Sample DNN Time 0.00560	Train Loss 0.0347	
start validation
acc: 0.723005
AUC: 0.908837
Avg Precision: 0.484549
Avg Recall: 1.000000
d_prime: 1.886030
train_loss: 0.038370
valid_loss: 1.319769
validation finished
normal learning rate scheduler step
Epoch-44 lr: 6.315614079874623e-09
Epoch-44 lr: 6.315614079874623e-09
epoch 44 training time: 15.247
---------------
2023-09-25 01:23:45.628409
current #epochs=45, #steps=1716
start validation
acc: 0.723005
AUC: 0.908837
Avg Precision: 0.484549
Avg Recall: 1.000000
d_prime: 1.886030
train_loss: 0.042380
valid_loss: 1.319769
validation finished
normal learning rate scheduler step
Epoch-45 lr: 4.661313704674906e-09
Epoch-45 lr: 4.661313704674906e-09
epoch 45 training time: 15.232
---------------
2023-09-25 01:24:00.860102
current #epochs=46, #steps=1755
start validation
[I 2023-09-25 01:24:16,512] Trial 94 finished with value: 0.48454937002714743 and parameters: {'warmup': 'True', 'num_epochs': 46, 'batch_size': 35, 'lr-adaptschedule': 'False', 'lr': 0.0006499668083278202, 'head-lr': 1, 'lr-scheduler-start': 7, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7380618330573234}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.723005
AUC: 0.908837
Avg Precision: 0.484549
Avg Recall: 1.000000
d_prime: 1.886030
train_loss: 0.051513
valid_loss: 1.319769
validation finished
normal learning rate scheduler step
Epoch-46 lr: 3.440337737327584e-09
Epoch-46 lr: 3.440337737327584e-09
epoch 46 training time: 15.638
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f5b6820>
The learning rate scheduler starts at 6 epoch with decay rate of 0.780 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-25 01:24:16.551676
current #epochs=1, #steps=0
start validation
acc: 0.718310
AUC: 0.902214
Avg Precision: 0.469972
Avg Recall: 1.000000
d_prime: 1.830374
train_loss: 0.051666
valid_loss: 1.327978
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0004853670828964862
Epoch-1 lr: 0.0004853670828964862
epoch 1 training time: 18.284
---------------
2023-09-25 01:24:34.835927
current #epochs=2, #steps=39
start validation
acc: 0.741784
AUC: 0.899453
Avg Precision: 0.461571
Avg Recall: 1.000000
d_prime: 1.807988
train_loss: 0.063466
valid_loss: 1.333570
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0004853670828964862
Epoch-2 lr: 0.0004853670828964862
epoch 2 training time: 17.737
---------------
2023-09-25 01:24:52.572955
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00701	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00556	Train Loss 0.0572	
start validation
acc: 0.727700
AUC: 0.904887
Avg Precision: 0.460676
Avg Recall: 1.000000
d_prime: 1.852490
train_loss: 0.058527
valid_loss: 1.320540
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0004853670828964862
Epoch-3 lr: 0.0004853670828964862
epoch 3 training time: 15.144
---------------
2023-09-25 01:25:07.716539
current #epochs=4, #steps=117
start validation
acc: 0.741784
AUC: 0.900757
Avg Precision: 0.457747
Avg Recall: 1.000000
d_prime: 1.818506
train_loss: 0.065343
valid_loss: 1.322242
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0004853670828964862
Epoch-4 lr: 0.0004853670828964862
epoch 4 training time: 15.197
---------------
2023-09-25 01:25:22.914177
current #epochs=5, #steps=156
start validation
acc: 0.746479
AUC: 0.904593
Avg Precision: 0.494894
Avg Recall: 1.000000
d_prime: 1.850039
train_loss: 0.051767
valid_loss: 1.321793
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0004853670828964862
Epoch-5 lr: 0.0004853670828964862
epoch 5 training time: 18.665
---------------
2023-09-25 01:25:41.579348
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01153	Per Sample Data Time 0.00532	Per Sample DNN Time 0.00621	Train Loss 0.0385	
start validation
acc: 0.699531
AUC: 0.902040
Avg Precision: 0.482702
Avg Recall: 1.000000
d_prime: 1.828951
train_loss: 0.047884
valid_loss: 1.318321
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00037869837514382617
Epoch-6 lr: 0.00037869837514382617
epoch 6 training time: 15.166
---------------
2023-09-25 01:25:56.745882
current #epochs=7, #steps=234
start validation
acc: 0.708920
AUC: 0.898933
Avg Precision: 0.470907
Avg Recall: 1.000000
d_prime: 1.803823
train_loss: 0.054937
valid_loss: 1.323875
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.0002954721578578075
Epoch-7 lr: 0.0002954721578578075
epoch 7 training time: 15.237
---------------
2023-09-25 01:26:11.983031
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00695	Per Sample Data Time 0.00138	Per Sample DNN Time 0.00556	Train Loss 0.0297	
start validation
acc: 0.737089
AUC: 0.898273
Avg Precision: 0.462837
Avg Recall: 1.000000
d_prime: 1.798557
train_loss: 0.037583
valid_loss: 1.316971
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.0002305364950034231
Epoch-8 lr: 0.0002305364950034231
epoch 8 training time: 15.277
---------------
2023-09-25 01:26:27.260586
current #epochs=9, #steps=312
start validation
acc: 0.723005
AUC: 0.896707
Avg Precision: 0.460537
Avg Recall: 1.000000
d_prime: 1.786164
train_loss: 0.036169
valid_loss: 1.318359
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00017987168711185208
Epoch-9 lr: 0.00017987168711185208
epoch 9 training time: 15.673
---------------
2023-09-25 01:26:42.933570
current #epochs=10, #steps=351
start validation
acc: 0.718310
AUC: 0.899424
Avg Precision: 0.476908
Avg Recall: 1.000000
d_prime: 1.807756
train_loss: 0.048684
valid_loss: 1.311987
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00014034144062085967
Epoch-10 lr: 0.00014034144062085967
epoch 10 training time: 15.228
---------------
2023-09-25 01:26:58.161842
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00866	Per Sample Data Time 0.00291	Per Sample DNN Time 0.00575	Train Loss 0.0634	
start validation
acc: 0.727700
AUC: 0.902762
Avg Precision: 0.471440
Avg Recall: 1.000000
d_prime: 1.834874
train_loss: 0.047098
valid_loss: 1.307705
validation finished
normal learning rate scheduler step
Epoch-11 lr: 0.00010949872251596005
Epoch-11 lr: 0.00010949872251596005
epoch 11 training time: 17.270
---------------
2023-09-25 01:27:15.431861
current #epochs=12, #steps=429
start validation
acc: 0.718310
AUC: 0.902080
Avg Precision: 0.470461
Avg Recall: 1.000000
d_prime: 1.829277
train_loss: 0.048107
valid_loss: 1.309902
validation finished
normal learning rate scheduler step
Epoch-12 lr: 8.543428213067015e-05
Epoch-12 lr: 8.543428213067015e-05
epoch 12 training time: 15.185
---------------
2023-09-25 01:27:30.616005
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00665	Per Sample Data Time 0.00104	Per Sample DNN Time 0.00561	Train Loss 0.0608	
start validation
acc: 0.723005
AUC: 0.901424
Avg Precision: 0.463068
Avg Recall: 1.000000
d_prime: 1.823919
train_loss: 0.057403
valid_loss: 1.308609
validation finished
normal learning rate scheduler step
Epoch-13 lr: 6.665846318087476e-05
Epoch-13 lr: 6.665846318087476e-05
epoch 13 training time: 15.200
---------------
2023-09-25 01:27:45.816356
current #epochs=14, #steps=507
start validation
acc: 0.727700
AUC: 0.901886
Avg Precision: 0.463532
Avg Recall: 1.000000
d_prime: 1.827689
train_loss: 0.039220
valid_loss: 1.312754
validation finished
normal learning rate scheduler step
Epoch-14 lr: 5.200898986708887e-05
Epoch-14 lr: 5.200898986708887e-05
epoch 14 training time: 15.230
---------------
2023-09-25 01:28:01.046627
current #epochs=15, #steps=546
start validation
acc: 0.727700
AUC: 0.900130
Avg Precision: 0.462661
Avg Recall: 1.000000
d_prime: 1.813439
train_loss: 0.047155
valid_loss: 1.318167
validation finished
normal learning rate scheduler step
Epoch-15 lr: 4.057901874598028e-05
Epoch-15 lr: 4.057901874598028e-05
epoch 15 training time: 15.199
---------------
2023-09-25 01:28:16.245631
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00770	Per Sample Data Time 0.00209	Per Sample DNN Time 0.00561	Train Loss 0.0363	
start validation
acc: 0.723005
AUC: 0.899970
Avg Precision: 0.463335
Avg Recall: 1.000000
d_prime: 1.812142
train_loss: 0.038084
valid_loss: 1.321437
validation finished
normal learning rate scheduler step
Epoch-16 lr: 3.1661002580413856e-05
Epoch-16 lr: 3.1661002580413856e-05
epoch 16 training time: 15.222
---------------
2023-09-25 01:28:31.467242
current #epochs=17, #steps=624
start validation
acc: 0.727700
AUC: 0.900061
Avg Precision: 0.462656
Avg Recall: 1.000000
d_prime: 1.812877
train_loss: 0.060647
valid_loss: 1.321239
validation finished
normal learning rate scheduler step
Epoch-17 lr: 2.4702891183051872e-05
Epoch-17 lr: 2.4702891183051872e-05
epoch 17 training time: 15.451
---------------
2023-09-25 01:28:46.918220
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00657	Per Sample Data Time 0.00098	Per Sample DNN Time 0.00559	Train Loss 0.0395	
start validation
acc: 0.723005
AUC: 0.900060
Avg Precision: 0.462719
Avg Recall: 1.000000
d_prime: 1.812871
train_loss: 0.038790
valid_loss: 1.320383
validation finished
normal learning rate scheduler step
Epoch-18 lr: 1.9273957963011708e-05
Epoch-18 lr: 1.9273957963011708e-05
epoch 18 training time: 15.359
---------------
2023-09-25 01:29:02.276891
current #epochs=19, #steps=702
start validation
acc: 0.723005
AUC: 0.899762
Avg Precision: 0.462762
Avg Recall: 1.000000
d_prime: 1.810470
train_loss: 0.051898
valid_loss: 1.320645
validation finished
normal learning rate scheduler step
Epoch-19 lr: 1.5038136743071221e-05
Epoch-19 lr: 1.5038136743071221e-05
epoch 19 training time: 15.284
---------------
2023-09-25 01:29:17.561585
current #epochs=20, #steps=741
start validation
acc: 0.718310
AUC: 0.899430
Avg Precision: 0.462519
Avg Recall: 1.000000
d_prime: 1.807807
train_loss: 0.067099
valid_loss: 1.320184
validation finished
normal learning rate scheduler step
Epoch-20 lr: 1.1733218321701252e-05
Epoch-20 lr: 1.1733218321701252e-05
epoch 20 training time: 15.128
---------------
2023-09-25 01:29:32.689181
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00735	Per Sample Data Time 0.00157	Per Sample DNN Time 0.00578	Train Loss 0.0466	
start validation
acc: 0.718310
AUC: 0.899724
Avg Precision: 0.462519
Avg Recall: 1.000000
d_prime: 1.810168
train_loss: 0.042377
valid_loss: 1.319839
validation finished
normal learning rate scheduler step
Epoch-21 lr: 9.154618988827607e-06
Epoch-21 lr: 9.154618988827607e-06
epoch 21 training time: 15.263
---------------
2023-09-25 01:29:47.952689
current #epochs=22, #steps=819
start validation
acc: 0.718310
AUC: 0.899560
Avg Precision: 0.462519
Avg Recall: 1.000000
d_prime: 1.808850
train_loss: 0.047364
valid_loss: 1.319399
validation finished
normal learning rate scheduler step
Epoch-22 lr: 7.1427162209704315e-06
Epoch-22 lr: 7.1427162209704315e-06
epoch 22 training time: 15.249
---------------
2023-09-25 01:30:03.202156
current #epochs=23, #steps=858
start validation
acc: 0.723005
AUC: 0.899614
Avg Precision: 0.462519
Avg Recall: 1.000000
d_prime: 1.809285
train_loss: 0.051459
valid_loss: 1.319327
validation finished
normal learning rate scheduler step
Epoch-23 lr: 5.572967599806994e-06
Epoch-23 lr: 5.572967599806994e-06
epoch 23 training time: 15.154
---------------
2023-09-25 01:30:18.355623
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01426	Per Sample Data Time 0.00816	Per Sample DNN Time 0.00610	Train Loss 0.0674	
start validation
acc: 0.727700
AUC: 0.899626
Avg Precision: 0.462519
Avg Recall: 1.000000
d_prime: 1.809381
train_loss: 0.049123
valid_loss: 1.319342
validation finished
normal learning rate scheduler step
Epoch-24 lr: 4.348201287531888e-06
Epoch-24 lr: 4.348201287531888e-06
epoch 24 training time: 15.344
---------------
2023-09-25 01:30:33.699181
current #epochs=25, #steps=936
start validation
acc: 0.732394
AUC: 0.899477
Avg Precision: 0.462519
Avg Recall: 1.000000
d_prime: 1.808184
train_loss: 0.043244
valid_loss: 1.319320
validation finished
normal learning rate scheduler step
Epoch-25 lr: 3.3926008178387327e-06
Epoch-25 lr: 3.3926008178387327e-06
epoch 25 training time: 15.242
---------------
2023-09-25 01:30:48.941189
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00688	Per Sample Data Time 0.00131	Per Sample DNN Time 0.00558	Train Loss 0.0453	
start validation
acc: 0.732394
AUC: 0.899462
Avg Precision: 0.462519
Avg Recall: 1.000000
d_prime: 1.808064
train_loss: 0.053362
valid_loss: 1.319357
validation finished
normal learning rate scheduler step
Epoch-26 lr: 2.6470118442316085e-06
Epoch-26 lr: 2.6470118442316085e-06
epoch 26 training time: 15.235
---------------
2023-09-25 01:31:04.176047
current #epochs=27, #steps=1014
start validation
acc: 0.732394
AUC: 0.899406
Avg Precision: 0.462519
Avg Recall: 1.000000
d_prime: 1.807608
train_loss: 0.042194
valid_loss: 1.319340
validation finished
normal learning rate scheduler step
Epoch-27 lr: 2.0652803202370398e-06
Epoch-27 lr: 2.0652803202370398e-06
epoch 27 training time: 15.248
---------------
2023-09-25 01:31:19.423869
current #epochs=28, #steps=1053
start validation
acc: 0.732394
AUC: 0.899406
Avg Precision: 0.462519
Avg Recall: 1.000000
d_prime: 1.807608
train_loss: 0.047925
valid_loss: 1.319346
validation finished
normal learning rate scheduler step
Epoch-28 lr: 1.6113954346118887e-06
Epoch-28 lr: 1.6113954346118887e-06
epoch 28 training time: 15.329
---------------
2023-09-25 01:31:34.752876
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00937	Per Sample Data Time 0.00369	Per Sample DNN Time 0.00568	Train Loss 0.0575	
start validation
acc: 0.732394
AUC: 0.899411
Avg Precision: 0.462519
Avg Recall: 1.000000
d_prime: 1.807653
train_loss: 0.048107
valid_loss: 1.319360
validation finished
normal learning rate scheduler step
Epoch-29 lr: 1.2572604412315405e-06
Epoch-29 lr: 1.2572604412315405e-06
epoch 29 training time: 16.172
---------------
2023-09-25 01:31:50.924372
current #epochs=30, #steps=1131
start validation
acc: 0.732394
AUC: 0.899465
Avg Precision: 0.462519
Avg Recall: 1.000000
d_prime: 1.808087
train_loss: 0.049874
valid_loss: 1.319246
validation finished
normal learning rate scheduler step
Epoch-30 lr: 9.809533917827233e-07
Epoch-30 lr: 9.809533917827233e-07
epoch 30 training time: 15.212
---------------
2023-09-25 01:32:06.136430
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00669	Per Sample Data Time 0.00113	Per Sample DNN Time 0.00557	Train Loss 0.0368	
start validation
acc: 0.732394
AUC: 0.899409
Avg Precision: 0.462519
Avg Recall: 1.000000
d_prime: 1.807638
train_loss: 0.036372
valid_loss: 1.319270
validation finished
normal learning rate scheduler step
Epoch-31 lr: 7.653701057415318e-07
Epoch-31 lr: 7.653701057415318e-07
epoch 31 training time: 15.242
---------------
2023-09-25 01:32:21.378413
current #epochs=32, #steps=1209
start validation
acc: 0.732394
AUC: 0.899446
Avg Precision: 0.462519
Avg Recall: 1.000000
d_prime: 1.807929
train_loss: 0.042663
valid_loss: 1.319268
validation finished
normal learning rate scheduler step
Epoch-32 lr: 5.971653736761366e-07
Epoch-32 lr: 5.971653736761366e-07
epoch 32 training time: 15.329
---------------
2023-09-25 01:32:36.707248
current #epochs=33, #steps=1248
start validation
acc: 0.732394
AUC: 0.899481
Avg Precision: 0.462519
Avg Recall: 1.000000
d_prime: 1.808214
train_loss: 0.043868
valid_loss: 1.319263
validation finished
normal learning rate scheduler step
Epoch-33 lr: 4.659268513920599e-07
Epoch-33 lr: 4.659268513920599e-07
epoch 33 training time: 15.322
---------------
2023-09-25 01:32:52.030078
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00808	Per Sample Data Time 0.00239	Per Sample DNN Time 0.00569	Train Loss 0.0257	
start validation
acc: 0.732394
AUC: 0.899481
Avg Precision: 0.462519
Avg Recall: 1.000000
d_prime: 1.808214
train_loss: 0.036089
valid_loss: 1.319260
validation finished
normal learning rate scheduler step
Epoch-34 lr: 3.635305066530078e-07
Epoch-34 lr: 3.635305066530078e-07
epoch 34 training time: 15.383
---------------
2023-09-25 01:33:07.413030
current #epochs=35, #steps=1326
start validation
acc: 0.732394
AUC: 0.899496
Avg Precision: 0.462519
Avg Recall: 1.000000
d_prime: 1.808334
train_loss: 0.051275
valid_loss: 1.319254
validation finished
normal learning rate scheduler step
Epoch-35 lr: 2.8363771882335573e-07
Epoch-35 lr: 2.8363771882335573e-07
epoch 35 training time: 15.181
---------------
2023-09-25 01:33:22.593940
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00661	Per Sample Data Time 0.00104	Per Sample DNN Time 0.00557	Train Loss 0.0413	
start validation
acc: 0.732394
AUC: 0.899531
Avg Precision: 0.462640
Avg Recall: 1.000000
d_prime: 1.808618
train_loss: 0.042105
valid_loss: 1.319261
validation finished
normal learning rate scheduler step
Epoch-36 lr: 2.2130290049111996e-07
Epoch-36 lr: 2.2130290049111996e-07
epoch 36 training time: 15.358
---------------
2023-09-25 01:33:37.951738
current #epochs=37, #steps=1404
start validation
acc: 0.732394
AUC: 0.899517
Avg Precision: 0.462640
Avg Recall: 1.000000
d_prime: 1.808498
train_loss: 0.048002
valid_loss: 1.319266
validation finished
normal learning rate scheduler step
Epoch-37 lr: 1.726673517505027e-07
Epoch-37 lr: 1.726673517505027e-07
epoch 37 training time: 15.337
---------------
2023-09-25 01:33:53.288733
current #epochs=38, #steps=1443
start validation
acc: 0.732394
AUC: 0.899531
Avg Precision: 0.462640
Avg Recall: 1.000000
d_prime: 1.808618
train_loss: 0.044956
valid_loss: 1.319262
validation finished
normal learning rate scheduler step
Epoch-38 lr: 1.3472039586633504e-07
Epoch-38 lr: 1.3472039586633504e-07
epoch 38 training time: 15.162
---------------
2023-09-25 01:34:08.450703
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00743	Per Sample Data Time 0.00178	Per Sample DNN Time 0.00566	Train Loss 0.0250	
start validation
acc: 0.732394
AUC: 0.899496
Avg Precision: 0.462519
Avg Recall: 1.000000
d_prime: 1.808334
train_loss: 0.036827
valid_loss: 1.319255
validation finished
normal learning rate scheduler step
Epoch-39 lr: 1.051130099487912e-07
Epoch-39 lr: 1.051130099487912e-07
epoch 39 training time: 15.167
---------------
2023-09-25 01:34:23.617856
current #epochs=40, #steps=1521
start validation
acc: 0.732394
AUC: 0.899496
Avg Precision: 0.462519
Avg Recall: 1.000000
d_prime: 1.808334
train_loss: 0.038636
valid_loss: 1.319256
validation finished
normal learning rate scheduler step
Epoch-40 lr: 8.20124138549657e-08
Epoch-40 lr: 8.20124138549657e-08
epoch 40 training time: 15.240
---------------
2023-09-25 01:34:38.858075
current #epochs=41, #steps=1560
start validation
acc: 0.732394
AUC: 0.899496
Avg Precision: 0.462519
Avg Recall: 1.000000
d_prime: 1.808334
train_loss: 0.057234
valid_loss: 1.319258
validation finished
normal learning rate scheduler step
Epoch-41 lr: 6.398861596290459e-08
Epoch-41 lr: 6.398861596290459e-08
epoch 41 training time: 15.859
---------------
2023-09-25 01:34:54.717501
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02253	Per Sample Data Time 0.01568	Per Sample DNN Time 0.00685	Train Loss 0.0213	
start validation
acc: 0.732394
AUC: 0.899496
Avg Precision: 0.462519
Avg Recall: 1.000000
d_prime: 1.808334
train_loss: 0.028591
valid_loss: 1.319257
validation finished
normal learning rate scheduler step
Epoch-42 lr: 4.992589268362537e-08
Epoch-42 lr: 4.992589268362537e-08
epoch 42 training time: 15.194
---------------
2023-09-25 01:35:09.911748
current #epochs=43, #steps=1638
start validation
acc: 0.732394
AUC: 0.899496
Avg Precision: 0.462519
Avg Recall: 1.000000
d_prime: 1.808334
train_loss: 0.040565
valid_loss: 1.319258
validation finished
normal learning rate scheduler step
Epoch-43 lr: 3.895372204490063e-08
Epoch-43 lr: 3.895372204490063e-08
epoch 43 training time: 15.281
---------------
2023-09-25 01:35:25.192593
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00704	Per Sample Data Time 0.00147	Per Sample DNN Time 0.00557	Train Loss 0.0341	
start validation
[I 2023-09-25 01:35:40,531] Trial 95 finished with value: 0.462518814671685 and parameters: {'warmup': 'True', 'num_epochs': 44, 'batch_size': 31, 'lr-adaptschedule': 'True', 'lr': 0.0004853670828964862, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7802308571976045}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.732394
AUC: 0.899496
Avg Precision: 0.462519
Avg Recall: 1.000000
d_prime: 1.808334
train_loss: 0.039334
valid_loss: 1.319259
validation finished
normal learning rate scheduler step
Epoch-44 lr: 3.039289594213005e-08
Epoch-44 lr: 3.039289594213005e-08
epoch 44 training time: 15.322
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa63ced0bb0>
The learning rate scheduler starts at 8 epoch with decay rate of 0.722 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-25 01:35:40.572806
current #epochs=1, #steps=0
start validation
acc: 0.727700
AUC: 0.899307
Avg Precision: 0.470433
Avg Recall: 1.000000
d_prime: 1.806814
train_loss: 0.034567
valid_loss: 1.318706
validation finished
normal learning rate scheduler step
Epoch-1 lr: 1.4982931294757106e-05
Epoch-1 lr: 1.4982931294757106e-05
epoch 1 training time: 17.506
---------------
2023-09-25 01:35:58.079331
current #epochs=2, #steps=39
start validation
acc: 0.727700
AUC: 0.899113
Avg Precision: 0.470433
Avg Recall: 1.000000
d_prime: 1.805263
train_loss: 0.034306
valid_loss: 1.319286
validation finished
normal learning rate scheduler step
Epoch-2 lr: 1.4982931294757106e-05
Epoch-2 lr: 1.4982931294757106e-05
epoch 2 training time: 15.221
---------------
2023-09-25 01:36:13.300492
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00720	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00574	Train Loss 0.0336	
start validation
acc: 0.723005
AUC: 0.899256
Avg Precision: 0.470567
Avg Recall: 1.000000
d_prime: 1.806406
train_loss: 0.037425
valid_loss: 1.319435
validation finished
normal learning rate scheduler step
Epoch-3 lr: 1.4982931294757106e-05
Epoch-3 lr: 1.4982931294757106e-05
epoch 3 training time: 15.301
---------------
2023-09-25 01:36:28.600779
current #epochs=4, #steps=117
start validation
acc: 0.723005
AUC: 0.899323
Avg Precision: 0.470567
Avg Recall: 1.000000
d_prime: 1.806948
train_loss: 0.038007
valid_loss: 1.319767
validation finished
normal learning rate scheduler step
Epoch-4 lr: 1.4982931294757106e-05
Epoch-4 lr: 1.4982931294757106e-05
epoch 4 training time: 15.169
---------------
2023-09-25 01:36:43.770276
current #epochs=5, #steps=156
start validation
acc: 0.723005
AUC: 0.899164
Avg Precision: 0.477487
Avg Recall: 1.000000
d_prime: 1.805672
train_loss: 0.034573
valid_loss: 1.319709
validation finished
normal learning rate scheduler step
Epoch-5 lr: 1.4982931294757106e-05
Epoch-5 lr: 1.4982931294757106e-05
epoch 5 training time: 15.158
---------------
2023-09-25 01:36:58.928380
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01143	Per Sample Data Time 0.00530	Per Sample DNN Time 0.00614	Train Loss 0.0208	
start validation
acc: 0.723005
AUC: 0.898838
Avg Precision: 0.475940
Avg Recall: 1.000000
d_prime: 1.803065
train_loss: 0.034915
valid_loss: 1.319961
validation finished
normal learning rate scheduler step
Epoch-6 lr: 1.4982931294757106e-05
Epoch-6 lr: 1.4982931294757106e-05
epoch 6 training time: 15.290
---------------
2023-09-25 01:37:14.219102
current #epochs=7, #steps=234
start validation
acc: 0.723005
AUC: 0.898944
Avg Precision: 0.476061
Avg Recall: 1.000000
d_prime: 1.803912
train_loss: 0.039323
valid_loss: 1.319930
validation finished
normal learning rate scheduler step
Epoch-7 lr: 1.4982931294757106e-05
Epoch-7 lr: 1.4982931294757106e-05
epoch 7 training time: 15.267
---------------
2023-09-25 01:37:29.485373
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00679	Per Sample Data Time 0.00124	Per Sample DNN Time 0.00555	Train Loss 0.0440	
start validation
acc: 0.723005
AUC: 0.899575
Avg Precision: 0.476687
Avg Recall: 1.000000
d_prime: 1.808965
train_loss: 0.055758
valid_loss: 1.319487
validation finished
normal learning rate scheduler step
Epoch-8 lr: 1.0816435019492979e-05
Epoch-8 lr: 1.0816435019492979e-05
epoch 8 training time: 15.252
---------------
2023-09-25 01:37:44.737863
current #epochs=9, #steps=312
start validation
acc: 0.723005
AUC: 0.899815
Avg Precision: 0.477008
Avg Recall: 1.000000
d_prime: 1.810901
train_loss: 0.046206
valid_loss: 1.319271
validation finished
normal learning rate scheduler step
Epoch-9 lr: 1.0816435019492979e-05
Epoch-9 lr: 1.0816435019492979e-05
epoch 9 training time: 16.006
---------------
2023-09-25 01:38:00.744103
current #epochs=10, #steps=351
start validation
acc: 0.723005
AUC: 0.899403
Avg Precision: 0.476371
Avg Recall: 1.000000
d_prime: 1.807591
train_loss: 0.037410
valid_loss: 1.319763
validation finished
normal learning rate scheduler step
Epoch-10 lr: 7.808569913942913e-06
Epoch-10 lr: 7.808569913942913e-06
epoch 10 training time: 15.192
---------------
2023-09-25 01:38:15.935877
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00866	Per Sample Data Time 0.00297	Per Sample DNN Time 0.00569	Train Loss 0.0468	
start validation
acc: 0.723005
AUC: 0.899662
Avg Precision: 0.477008
Avg Recall: 1.000000
d_prime: 1.809670
train_loss: 0.035464
valid_loss: 1.319732
validation finished
normal learning rate scheduler step
Epoch-11 lr: 7.808569913942913e-06
Epoch-11 lr: 7.808569913942913e-06
epoch 11 training time: 15.132
---------------
2023-09-25 01:38:31.068153
current #epochs=12, #steps=429
start validation
acc: 0.723005
AUC: 0.899299
Avg Precision: 0.477079
Avg Recall: 1.000000
d_prime: 1.806750
train_loss: 0.052646
valid_loss: 1.319576
validation finished
normal learning rate scheduler step
Epoch-12 lr: 5.637140517282243e-06
Epoch-12 lr: 5.637140517282243e-06
epoch 12 training time: 15.224
---------------
2023-09-25 01:38:46.291870
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00665	Per Sample Data Time 0.00102	Per Sample DNN Time 0.00562	Train Loss 0.0412	
start validation
acc: 0.727700
AUC: 0.899100
Avg Precision: 0.469369
Avg Recall: 1.000000
d_prime: 1.805162
train_loss: 0.037385
valid_loss: 1.319340
validation finished
normal learning rate scheduler step
Epoch-13 lr: 5.637140517282243e-06
Epoch-13 lr: 5.637140517282243e-06
epoch 13 training time: 16.248
---------------
2023-09-25 01:39:02.539742
current #epochs=14, #steps=507
start validation
acc: 0.727700
AUC: 0.899324
Avg Precision: 0.477211
Avg Recall: 1.000000
d_prime: 1.806955
train_loss: 0.053459
valid_loss: 1.319141
validation finished
normal learning rate scheduler step
Epoch-14 lr: 4.0695484015381305e-06
Epoch-14 lr: 4.0695484015381305e-06
epoch 14 training time: 15.336
---------------
2023-09-25 01:39:17.875436
current #epochs=15, #steps=546
start validation
acc: 0.723005
AUC: 0.899523
Avg Precision: 0.477600
Avg Recall: 1.000000
d_prime: 1.808552
train_loss: 0.040347
valid_loss: 1.319137
validation finished
normal learning rate scheduler step
Epoch-15 lr: 4.0695484015381305e-06
Epoch-15 lr: 4.0695484015381305e-06
epoch 15 training time: 15.266
---------------
2023-09-25 01:39:33.141329
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00767	Per Sample Data Time 0.00199	Per Sample DNN Time 0.00568	Train Loss 0.0425	
start validation
acc: 0.727700
AUC: 0.899811
Avg Precision: 0.477993
Avg Recall: 1.000000
d_prime: 1.810869
train_loss: 0.034601
valid_loss: 1.318907
validation finished
normal learning rate scheduler step
Epoch-16 lr: 2.937876773106587e-06
Epoch-16 lr: 2.937876773106587e-06
epoch 16 training time: 15.115
---------------
2023-09-25 01:39:48.256836
current #epochs=17, #steps=624
start validation
acc: 0.727700
AUC: 0.899581
Avg Precision: 0.477993
Avg Recall: 1.000000
d_prime: 1.809018
train_loss: 0.041082
valid_loss: 1.318882
validation finished
normal learning rate scheduler step
Epoch-17 lr: 2.937876773106587e-06
Epoch-17 lr: 2.937876773106587e-06
epoch 17 training time: 16.593
---------------
2023-09-25 01:40:04.849560
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00653	Per Sample Data Time 0.00095	Per Sample DNN Time 0.00557	Train Loss 0.0316	
start validation
acc: 0.727700
AUC: 0.899577
Avg Precision: 0.478248
Avg Recall: 1.000000
d_prime: 1.808987
train_loss: 0.031065
valid_loss: 1.318833
validation finished
normal learning rate scheduler step
Epoch-18 lr: 2.120903619354164e-06
Epoch-18 lr: 2.120903619354164e-06
epoch 18 training time: 15.329
---------------
2023-09-25 01:40:20.178425
current #epochs=19, #steps=702
start validation
acc: 0.723005
AUC: 0.899428
Avg Precision: 0.478248
Avg Recall: 1.000000
d_prime: 1.807788
train_loss: 0.051596
valid_loss: 1.318904
validation finished
normal learning rate scheduler step
Epoch-19 lr: 2.120903619354164e-06
Epoch-19 lr: 2.120903619354164e-06
epoch 19 training time: 15.269
---------------
2023-09-25 01:40:35.447499
current #epochs=20, #steps=741
start validation
acc: 0.723005
AUC: 0.899455
Avg Precision: 0.478248
Avg Recall: 1.000000
d_prime: 1.808004
train_loss: 0.044983
valid_loss: 1.318843
validation finished
normal learning rate scheduler step
Epoch-20 lr: 1.5311166907225469e-06
Epoch-20 lr: 1.5311166907225469e-06
epoch 20 training time: 15.263
---------------
2023-09-25 01:40:50.711138
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00727	Per Sample Data Time 0.00159	Per Sample DNN Time 0.00568	Train Loss 0.0525	
start validation
acc: 0.723005
AUC: 0.899368
Avg Precision: 0.478248
Avg Recall: 1.000000
d_prime: 1.807308
train_loss: 0.052322
valid_loss: 1.318827
validation finished
normal learning rate scheduler step
Epoch-21 lr: 1.5311166907225469e-06
Epoch-21 lr: 1.5311166907225469e-06
epoch 21 training time: 15.203
---------------
2023-09-25 01:41:05.914270
current #epochs=22, #steps=819
start validation
acc: 0.723005
AUC: 0.899368
Avg Precision: 0.478248
Avg Recall: 1.000000
d_prime: 1.807308
train_loss: 0.036653
valid_loss: 1.318787
validation finished
normal learning rate scheduler step
Epoch-22 lr: 1.1053393936510095e-06
Epoch-22 lr: 1.1053393936510095e-06
epoch 22 training time: 16.859
---------------
2023-09-25 01:41:22.773101
current #epochs=23, #steps=858
start validation
acc: 0.723005
AUC: 0.899419
Avg Precision: 0.478248
Avg Recall: 1.000000
d_prime: 1.807713
train_loss: 0.042983
valid_loss: 1.318805
validation finished
normal learning rate scheduler step
Epoch-23 lr: 1.1053393936510095e-06
Epoch-23 lr: 1.1053393936510095e-06
epoch 23 training time: 15.095
---------------
2023-09-25 01:41:37.868325
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01399	Per Sample Data Time 0.00789	Per Sample DNN Time 0.00610	Train Loss 0.0445	
start validation
acc: 0.723005
AUC: 0.899367
Avg Precision: 0.478248
Avg Recall: 1.000000
d_prime: 1.807295
train_loss: 0.037737
valid_loss: 1.318875
validation finished
normal learning rate scheduler step
Epoch-24 lr: 7.979634619358864e-07
Epoch-24 lr: 7.979634619358864e-07
epoch 24 training time: 15.191
---------------
2023-09-25 01:41:53.059823
current #epochs=25, #steps=936
start validation
acc: 0.723005
AUC: 0.899345
Avg Precision: 0.477993
Avg Recall: 1.000000
d_prime: 1.807124
train_loss: 0.043356
valid_loss: 1.318935
validation finished
normal learning rate scheduler step
Epoch-25 lr: 7.979634619358864e-07
Epoch-25 lr: 7.979634619358864e-07
epoch 25 training time: 15.263
---------------
2023-09-25 01:42:08.322815
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00691	Per Sample Data Time 0.00130	Per Sample DNN Time 0.00561	Train Loss 0.0383	
start validation
acc: 0.723005
AUC: 0.899403
Avg Precision: 0.477993
Avg Recall: 1.000000
d_prime: 1.807586
train_loss: 0.043285
valid_loss: 1.318991
validation finished
normal learning rate scheduler step
Epoch-26 lr: 5.760635061431146e-07
Epoch-26 lr: 5.760635061431146e-07
epoch 26 training time: 15.182
---------------
2023-09-25 01:42:23.505258
current #epochs=27, #steps=1014
start validation
acc: 0.723005
AUC: 0.899461
Avg Precision: 0.477993
Avg Recall: 1.000000
d_prime: 1.808049
train_loss: 0.040660
valid_loss: 1.318996
validation finished
normal learning rate scheduler step
Epoch-27 lr: 5.760635061431146e-07
Epoch-27 lr: 5.760635061431146e-07
epoch 27 training time: 15.225
---------------
2023-09-25 01:42:38.730693
current #epochs=28, #steps=1053
start validation
acc: 0.723005
AUC: 0.899425
Avg Precision: 0.477993
Avg Recall: 1.000000
d_prime: 1.807764
train_loss: 0.046550
valid_loss: 1.319010
validation finished
normal learning rate scheduler step
Epoch-28 lr: 4.158701230565381e-07
Epoch-28 lr: 4.158701230565381e-07
epoch 28 training time: 15.368
---------------
2023-09-25 01:42:54.098784
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00914	Per Sample Data Time 0.00353	Per Sample DNN Time 0.00561	Train Loss 0.0335	
start validation
acc: 0.723005
AUC: 0.899425
Avg Precision: 0.477993
Avg Recall: 1.000000
d_prime: 1.807764
train_loss: 0.037044
valid_loss: 1.319012
validation finished
normal learning rate scheduler step
Epoch-29 lr: 4.158701230565381e-07
Epoch-29 lr: 4.158701230565381e-07
epoch 29 training time: 15.081
---------------
2023-09-25 01:43:09.179503
current #epochs=30, #steps=1131
start validation
acc: 0.723005
AUC: 0.899425
Avg Precision: 0.477993
Avg Recall: 1.000000
d_prime: 1.807764
train_loss: 0.037204
valid_loss: 1.318995
validation finished
normal learning rate scheduler step
Epoch-30 lr: 3.002237729117556e-07
Epoch-30 lr: 3.002237729117556e-07
epoch 30 training time: 15.227
---------------
2023-09-25 01:43:24.405937
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00670	Per Sample Data Time 0.00111	Per Sample DNN Time 0.00559	Train Loss 0.0338	
start validation
acc: 0.723005
AUC: 0.899382
Avg Precision: 0.477993
Avg Recall: 1.000000
d_prime: 1.807421
train_loss: 0.038201
valid_loss: 1.318998
validation finished
normal learning rate scheduler step
Epoch-31 lr: 3.002237729117556e-07
Epoch-31 lr: 3.002237729117556e-07
epoch 31 training time: 15.277
---------------
2023-09-25 01:43:39.683232
current #epochs=32, #steps=1209
start validation
acc: 0.723005
AUC: 0.899405
Avg Precision: 0.477993
Avg Recall: 1.000000
d_prime: 1.807601
train_loss: 0.036166
valid_loss: 1.319005
validation finished
normal learning rate scheduler step
Epoch-32 lr: 2.1673668971193559e-07
Epoch-32 lr: 2.1673668971193559e-07
epoch 32 training time: 15.738
---------------
2023-09-25 01:43:55.421618
current #epochs=33, #steps=1248
start validation
acc: 0.723005
AUC: 0.899405
Avg Precision: 0.477993
Avg Recall: 1.000000
d_prime: 1.807601
train_loss: 0.038299
valid_loss: 1.319004
validation finished
normal learning rate scheduler step
Epoch-33 lr: 2.1673668971193559e-07
Epoch-33 lr: 2.1673668971193559e-07
epoch 33 training time: 15.330
---------------
2023-09-25 01:44:10.751585
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00806	Per Sample Data Time 0.00237	Per Sample DNN Time 0.00569	Train Loss 0.0362	
start validation
acc: 0.723005
AUC: 0.899427
Avg Precision: 0.477993
Avg Recall: 1.000000
d_prime: 1.807781
train_loss: 0.046294
valid_loss: 1.318996
validation finished
normal learning rate scheduler step
Epoch-34 lr: 1.564659327664072e-07
Epoch-34 lr: 1.564659327664072e-07
epoch 34 training time: 15.162
---------------
2023-09-25 01:44:25.913947
current #epochs=35, #steps=1326
start validation
acc: 0.723005
AUC: 0.899427
Avg Precision: 0.477993
Avg Recall: 1.000000
d_prime: 1.807781
train_loss: 0.043007
valid_loss: 1.318984
validation finished
normal learning rate scheduler step
Epoch-35 lr: 1.564659327664072e-07
Epoch-35 lr: 1.564659327664072e-07
epoch 35 training time: 15.072
---------------
2023-09-25 01:44:40.986377
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00655	Per Sample Data Time 0.00098	Per Sample DNN Time 0.00557	Train Loss 0.0426	
start validation
acc: 0.723005
AUC: 0.899427
Avg Precision: 0.477993
Avg Recall: 1.000000
d_prime: 1.807781
train_loss: 0.043130
valid_loss: 1.318990
validation finished
normal learning rate scheduler step
Epoch-36 lr: 1.1295543984269714e-07
Epoch-36 lr: 1.1295543984269714e-07
epoch 36 training time: 15.257
---------------
2023-09-25 01:44:56.243283
current #epochs=37, #steps=1404
start validation
acc: 0.723005
AUC: 0.899427
Avg Precision: 0.477993
Avg Recall: 1.000000
d_prime: 1.807781
train_loss: 0.029161
valid_loss: 1.318991
validation finished
normal learning rate scheduler step
Epoch-37 lr: 1.1295543984269714e-07
Epoch-37 lr: 1.1295543984269714e-07
epoch 37 training time: 15.232
---------------
2023-09-25 01:45:11.475380
current #epochs=38, #steps=1443
start validation
acc: 0.723005
AUC: 0.899427
Avg Precision: 0.477993
Avg Recall: 1.000000
d_prime: 1.807781
train_loss: 0.050285
valid_loss: 1.319003
validation finished
normal learning rate scheduler step
Epoch-38 lr: 8.154446891072048e-08
Epoch-38 lr: 8.154446891072048e-08
epoch 38 training time: 15.286
---------------
2023-09-25 01:45:26.761767
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00753	Per Sample Data Time 0.00184	Per Sample DNN Time 0.00569	Train Loss 0.0504	
start validation
[I 2023-09-25 01:45:42,123] Trial 96 finished with value: 0.47799338323981505 and parameters: {'warmup': 'True', 'num_epochs': 39, 'batch_size': 41, 'lr-adaptschedule': 'True', 'lr': 1.4982931294757106e-05, 'head-lr': 1, 'lr-scheduler-start': 8, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.7219171473660774}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.723005
AUC: 0.899427
Avg Precision: 0.477993
Avg Recall: 1.000000
d_prime: 1.807781
train_loss: 0.053870
valid_loss: 1.319008
validation finished
normal learning rate scheduler step
Epoch-39 lr: 8.154446891072048e-08
Epoch-39 lr: 8.154446891072048e-08
epoch 39 training time: 15.346
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 2 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67ec7d610>
The learning rate scheduler starts at 7 epoch with decay rate of 0.788 every 2 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-25 01:45:42.165036
current #epochs=1, #steps=0
start validation
acc: 0.723005
AUC: 0.900805
Avg Precision: 0.470776
Avg Recall: 1.000000
d_prime: 1.818896
train_loss: 0.049067
valid_loss: 1.324059
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.00017122437364738407
Epoch-1 lr: 0.00034244874729476814
epoch 1 training time: 17.567
---------------
2023-09-25 01:45:59.731980
current #epochs=2, #steps=39
start validation
acc: 0.727700
AUC: 0.900449
Avg Precision: 0.462504
Avg Recall: 1.000000
d_prime: 1.816011
train_loss: 0.051037
valid_loss: 1.323095
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.00017122437364738407
Epoch-2 lr: 0.00034244874729476814
epoch 2 training time: 17.690
---------------
2023-09-25 01:46:17.421842
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00707	Per Sample Data Time 0.00145	Per Sample DNN Time 0.00562	Train Loss 0.0440	
start validation
acc: 0.723005
AUC: 0.900718
Avg Precision: 0.463274
Avg Recall: 1.000000
d_prime: 1.818192
train_loss: 0.048653
valid_loss: 1.322630
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.00017122437364738407
Epoch-3 lr: 0.00034244874729476814
epoch 3 training time: 15.175
---------------
2023-09-25 01:46:32.596899
current #epochs=4, #steps=117
start validation
acc: 0.713615
AUC: 0.896295
Avg Precision: 0.467686
Avg Recall: 1.000000
d_prime: 1.782929
train_loss: 0.052898
valid_loss: 1.329743
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00017122437364738407
Epoch-4 lr: 0.00034244874729476814
epoch 4 training time: 15.355
---------------
2023-09-25 01:46:47.952104
current #epochs=5, #steps=156
start validation
acc: 0.718310
AUC: 0.896783
Avg Precision: 0.456055
Avg Recall: 1.000000
d_prime: 1.786766
train_loss: 0.052046
valid_loss: 1.335840
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.00017122437364738407
Epoch-5 lr: 0.00034244874729476814
epoch 5 training time: 15.255
---------------
2023-09-25 01:47:03.207330
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01118	Per Sample Data Time 0.00533	Per Sample DNN Time 0.00585	Train Loss 0.0479	
start validation
acc: 0.727700
AUC: 0.898252
Avg Precision: 0.449486
Avg Recall: 1.000000
d_prime: 1.798392
train_loss: 0.038107
valid_loss: 1.334971
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.00017122437364738407
Epoch-6 lr: 0.00034244874729476814
epoch 6 training time: 15.259
---------------
2023-09-25 01:47:18.466362
current #epochs=7, #steps=234
start validation
acc: 0.723005
AUC: 0.898406
Avg Precision: 0.450263
Avg Recall: 1.000000
d_prime: 1.799613
train_loss: 0.050427
valid_loss: 1.324365
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.000134900842369454
Epoch-7 lr: 0.000269801684738908
epoch 7 training time: 15.193
---------------
2023-09-25 01:47:33.659810
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00684	Per Sample Data Time 0.00119	Per Sample DNN Time 0.00565	Train Loss 0.0468	
start validation
acc: 0.713615
AUC: 0.900176
Avg Precision: 0.455950
Avg Recall: 1.000000
d_prime: 1.813807
train_loss: 0.047194
valid_loss: 1.329761
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.000134900842369454
Epoch-8 lr: 0.000269801684738908
epoch 8 training time: 15.220
---------------
2023-09-25 01:47:48.879503
current #epochs=9, #steps=312
start validation
acc: 0.713615
AUC: 0.898866
Avg Precision: 0.454944
Avg Recall: 1.000000
d_prime: 1.803289
train_loss: 0.028357
valid_loss: 1.336512
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00010628298345809894
Epoch-9 lr: 0.0002125659669161979
epoch 9 training time: 15.226
---------------
2023-09-25 01:48:04.105325
current #epochs=10, #steps=351
start validation
acc: 0.723005
AUC: 0.898022
Avg Precision: 0.446465
Avg Recall: 1.000000
d_prime: 1.796563
train_loss: 0.029637
valid_loss: 1.336194
validation finished
normal learning rate scheduler step
Epoch-10 lr: 0.00010628298345809894
Epoch-10 lr: 0.0002125659669161979
epoch 10 training time: 15.125
---------------
2023-09-25 01:48:19.230594
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00854	Per Sample Data Time 0.00294	Per Sample DNN Time 0.00560	Train Loss 0.0294	
start validation
acc: 0.727700
AUC: 0.897929
Avg Precision: 0.458272
Avg Recall: 1.000000
d_prime: 1.795821
train_loss: 0.039629
valid_loss: 1.332404
validation finished
normal learning rate scheduler step
Epoch-11 lr: 8.373611590814156e-05
Epoch-11 lr: 0.00016747223181628313
epoch 11 training time: 15.054
---------------
2023-09-25 01:48:34.284194
current #epochs=12, #steps=429
start validation
acc: 0.704225
AUC: 0.899015
Avg Precision: 0.438954
Avg Recall: 1.000000
d_prime: 1.804481
train_loss: 0.038183
valid_loss: 1.335999
validation finished
normal learning rate scheduler step
Epoch-12 lr: 8.373611590814156e-05
Epoch-12 lr: 0.00016747223181628313
epoch 12 training time: 15.280
---------------
2023-09-25 01:48:49.564515
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00666	Per Sample Data Time 0.00107	Per Sample DNN Time 0.00559	Train Loss 0.0619	
start validation
acc: 0.723005
AUC: 0.896165
Avg Precision: 0.441474
Avg Recall: 1.000000
d_prime: 1.781907
train_loss: 0.058451
valid_loss: 1.336382
validation finished
normal learning rate scheduler step
Epoch-13 lr: 6.597233987269494e-05
Epoch-13 lr: 0.00013194467974538988
epoch 13 training time: 15.202
---------------
2023-09-25 01:49:04.767002
current #epochs=14, #steps=507
start validation
acc: 0.718310
AUC: 0.897828
Avg Precision: 0.438012
Avg Recall: 1.000000
d_prime: 1.795025
train_loss: 0.042189
valid_loss: 1.333530
validation finished
normal learning rate scheduler step
Epoch-14 lr: 6.597233987269494e-05
Epoch-14 lr: 0.00013194467974538988
epoch 14 training time: 15.302
---------------
2023-09-25 01:49:20.069425
current #epochs=15, #steps=546
start validation
acc: 0.718310
AUC: 0.898977
Avg Precision: 0.443845
Avg Recall: 1.000000
d_prime: 1.804176
train_loss: 0.039580
valid_loss: 1.331363
validation finished
normal learning rate scheduler step
Epoch-15 lr: 5.197697052312408e-05
Epoch-15 lr: 0.00010395394104624815
epoch 15 training time: 15.264
---------------
2023-09-25 01:49:35.333587
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00765	Per Sample Data Time 0.00200	Per Sample DNN Time 0.00565	Train Loss 0.0368	
start validation
acc: 0.718310
AUC: 0.899286
Avg Precision: 0.434644
Avg Recall: 1.000000
d_prime: 1.806647
train_loss: 0.032574
valid_loss: 1.334723
validation finished
normal learning rate scheduler step
Epoch-16 lr: 5.197697052312408e-05
Epoch-16 lr: 0.00010395394104624815
epoch 16 training time: 15.234
---------------
2023-09-25 01:49:50.567283
current #epochs=17, #steps=624
start validation
acc: 0.723005
AUC: 0.899444
Avg Precision: 0.435275
Avg Recall: 1.000000
d_prime: 1.807913
train_loss: 0.032738
valid_loss: 1.334106
validation finished
normal learning rate scheduler step
Epoch-17 lr: 4.0950578226798154e-05
Epoch-17 lr: 8.190115645359631e-05
epoch 17 training time: 15.078
---------------
2023-09-25 01:50:05.644921
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00651	Per Sample Data Time 0.00096	Per Sample DNN Time 0.00555	Train Loss 0.0435	
start validation
acc: 0.723005
AUC: 0.897786
Avg Precision: 0.434297
Avg Recall: 1.000000
d_prime: 1.794689
train_loss: 0.042991
valid_loss: 1.334329
validation finished
normal learning rate scheduler step
Epoch-18 lr: 4.0950578226798154e-05
Epoch-18 lr: 8.190115645359631e-05
epoch 18 training time: 15.258
---------------
2023-09-25 01:50:20.903396
current #epochs=19, #steps=702
start validation
acc: 0.704225
AUC: 0.896681
Avg Precision: 0.434175
Avg Recall: 1.000000
d_prime: 1.785961
train_loss: 0.044252
valid_loss: 1.337650
validation finished
normal learning rate scheduler step
Epoch-19 lr: 3.2263324319047325e-05
Epoch-19 lr: 6.452664863809465e-05
epoch 19 training time: 15.261
---------------
2023-09-25 01:50:36.164485
current #epochs=20, #steps=741
start validation
acc: 0.718310
AUC: 0.896915
Avg Precision: 0.434270
Avg Recall: 1.000000
d_prime: 1.787803
train_loss: 0.053769
valid_loss: 1.338151
validation finished
normal learning rate scheduler step
Epoch-20 lr: 3.2263324319047325e-05
Epoch-20 lr: 6.452664863809465e-05
epoch 20 training time: 15.305
---------------
2023-09-25 01:50:51.469482
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00732	Per Sample Data Time 0.00165	Per Sample DNN Time 0.00566	Train Loss 0.0362	
start validation
acc: 0.718310
AUC: 0.896835
Avg Precision: 0.434099
Avg Recall: 1.000000
d_prime: 1.787173
train_loss: 0.042058
valid_loss: 1.339052
validation finished
normal learning rate scheduler step
Epoch-21 lr: 2.5418984082497002e-05
Epoch-21 lr: 5.0837968164994004e-05
epoch 21 training time: 15.315
---------------
2023-09-25 01:51:06.784951
current #epochs=22, #steps=819
start validation
acc: 0.708920
AUC: 0.896699
Avg Precision: 0.431185
Avg Recall: 1.000000
d_prime: 1.786103
train_loss: 0.057674
valid_loss: 1.339982
validation finished
normal learning rate scheduler step
Epoch-22 lr: 2.5418984082497002e-05
Epoch-22 lr: 5.0837968164994004e-05
epoch 22 training time: 15.449
---------------
2023-09-25 01:51:22.233708
current #epochs=23, #steps=858
start validation
acc: 0.713615
AUC: 0.896430
Avg Precision: 0.429810
Avg Recall: 1.000000
d_prime: 1.783986
train_loss: 0.038914
valid_loss: 1.339673
validation finished
normal learning rate scheduler step
Epoch-23 lr: 2.002660189002231e-05
Epoch-23 lr: 4.005320378004462e-05
epoch 23 training time: 16.240
---------------
2023-09-25 01:51:38.473963
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01411	Per Sample Data Time 0.00786	Per Sample DNN Time 0.00625	Train Loss 0.0799	
start validation
acc: 0.713615
AUC: 0.896513
Avg Precision: 0.429791
Avg Recall: 1.000000
d_prime: 1.784636
train_loss: 0.039029
valid_loss: 1.339095
validation finished
normal learning rate scheduler step
Epoch-24 lr: 2.002660189002231e-05
Epoch-24 lr: 4.005320378004462e-05
epoch 24 training time: 15.203
---------------
2023-09-25 01:51:53.676726
current #epochs=25, #steps=936
start validation
acc: 0.713615
AUC: 0.896471
Avg Precision: 0.438424
Avg Recall: 1.000000
d_prime: 1.784306
train_loss: 0.048883
valid_loss: 1.338404
validation finished
normal learning rate scheduler step
Epoch-25 lr: 1.5778159424459857e-05
Epoch-25 lr: 3.1556318848919714e-05
epoch 25 training time: 15.312
---------------
2023-09-25 01:52:08.988909
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00692	Per Sample Data Time 0.00134	Per Sample DNN Time 0.00558	Train Loss 0.0468	
start validation
acc: 0.718310
AUC: 0.896712
Avg Precision: 0.442825
Avg Recall: 1.000000
d_prime: 1.786207
train_loss: 0.040494
valid_loss: 1.337910
validation finished
normal learning rate scheduler step
Epoch-26 lr: 1.5778159424459857e-05
Epoch-26 lr: 3.1556318848919714e-05
epoch 26 training time: 15.261
---------------
2023-09-25 01:52:24.249798
current #epochs=27, #steps=1014
start validation
acc: 0.723005
AUC: 0.896827
Avg Precision: 0.444134
Avg Recall: 1.000000
d_prime: 1.787108
train_loss: 0.042092
valid_loss: 1.337459
validation finished
normal learning rate scheduler step
Epoch-27 lr: 1.2430981361231527e-05
Epoch-27 lr: 2.4861962722463054e-05
epoch 27 training time: 15.227
---------------
2023-09-25 01:52:39.476623
current #epochs=28, #steps=1053
start validation
acc: 0.723005
AUC: 0.897022
Avg Precision: 0.444364
Avg Recall: 1.000000
d_prime: 1.788645
train_loss: 0.042743
valid_loss: 1.337503
validation finished
normal learning rate scheduler step
Epoch-28 lr: 1.2430981361231527e-05
Epoch-28 lr: 2.4861962722463054e-05
epoch 28 training time: 15.247
---------------
2023-09-25 01:52:54.724129
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00942	Per Sample Data Time 0.00361	Per Sample DNN Time 0.00581	Train Loss 0.0507	
start validation
acc: 0.723005
AUC: 0.897293
Avg Precision: 0.444257
Avg Recall: 1.000000
d_prime: 1.790787
train_loss: 0.048927
valid_loss: 1.336686
validation finished
normal learning rate scheduler step
Epoch-29 lr: 9.793873508701458e-06
Epoch-29 lr: 1.9587747017402916e-05
epoch 29 training time: 16.219
---------------
2023-09-25 01:53:10.943232
current #epochs=30, #steps=1131
start validation
acc: 0.723005
AUC: 0.897587
Avg Precision: 0.439898
Avg Recall: 1.000000
d_prime: 1.793108
train_loss: 0.028179
valid_loss: 1.336378
validation finished
normal learning rate scheduler step
Epoch-30 lr: 9.793873508701458e-06
Epoch-30 lr: 1.9587747017402916e-05
epoch 30 training time: 15.085
---------------
2023-09-25 01:53:26.028208
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00669	Per Sample Data Time 0.00111	Per Sample DNN Time 0.00557	Train Loss 0.0384	
start validation
acc: 0.727700
AUC: 0.897287
Avg Precision: 0.439898
Avg Recall: 1.000000
d_prime: 1.790737
train_loss: 0.037948
valid_loss: 1.336354
validation finished
normal learning rate scheduler step
Epoch-31 lr: 7.716201602842842e-06
Epoch-31 lr: 1.5432403205685685e-05
epoch 31 training time: 15.305
---------------
2023-09-25 01:53:41.332886
current #epochs=32, #steps=1209
start validation
acc: 0.727700
AUC: 0.897116
Avg Precision: 0.442962
Avg Recall: 1.000000
d_prime: 1.789387
train_loss: 0.036913
valid_loss: 1.336664
validation finished
normal learning rate scheduler step
Epoch-32 lr: 7.716201602842842e-06
Epoch-32 lr: 1.5432403205685685e-05
epoch 32 training time: 15.347
---------------
2023-09-25 01:53:56.679655
current #epochs=33, #steps=1248
start validation
acc: 0.727700
AUC: 0.897350
Avg Precision: 0.443389
Avg Recall: 1.000000
d_prime: 1.791237
train_loss: 0.044974
valid_loss: 1.336773
validation finished
normal learning rate scheduler step
Epoch-33 lr: 6.079286925935463e-06
Epoch-33 lr: 1.2158573851870925e-05
epoch 33 training time: 15.255
---------------
2023-09-25 01:54:11.935000
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00813	Per Sample Data Time 0.00245	Per Sample DNN Time 0.00567	Train Loss 0.0564	
start validation
acc: 0.727700
AUC: 0.897394
Avg Precision: 0.443389
Avg Recall: 1.000000
d_prime: 1.791585
train_loss: 0.044550
valid_loss: 1.336686
validation finished
normal learning rate scheduler step
Epoch-34 lr: 6.079286925935463e-06
Epoch-34 lr: 1.2158573851870925e-05
epoch 34 training time: 15.251
---------------
2023-09-25 01:54:27.186746
current #epochs=35, #steps=1326
start validation
acc: 0.723005
AUC: 0.897387
Avg Precision: 0.439030
Avg Recall: 1.000000
d_prime: 1.791530
train_loss: 0.039173
valid_loss: 1.336436
validation finished
normal learning rate scheduler step
Epoch-35 lr: 4.789627258343495e-06
Epoch-35 lr: 9.57925451668699e-06
epoch 35 training time: 15.191
---------------
2023-09-25 01:54:42.378149
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00653	Per Sample Data Time 0.00100	Per Sample DNN Time 0.00553	Train Loss 0.0322	
start validation
acc: 0.723005
AUC: 0.897348
Avg Precision: 0.439294
Avg Recall: 1.000000
d_prime: 1.791217
train_loss: 0.032582
valid_loss: 1.336345
validation finished
normal learning rate scheduler step
Epoch-36 lr: 4.789627258343495e-06
Epoch-36 lr: 9.57925451668699e-06
epoch 36 training time: 15.203
---------------
2023-09-25 01:54:57.580719
current #epochs=37, #steps=1404
start validation
acc: 0.723005
AUC: 0.897325
Avg Precision: 0.440051
Avg Recall: 1.000000
d_prime: 1.791040
train_loss: 0.045501
valid_loss: 1.336052
validation finished
normal learning rate scheduler step
Epoch-37 lr: 3.7735559372922678e-06
Epoch-37 lr: 7.5471118745845355e-06
epoch 37 training time: 16.068
---------------
2023-09-25 01:55:13.648999
current #epochs=38, #steps=1443
start validation
acc: 0.727700
AUC: 0.897532
Avg Precision: 0.440339
Avg Recall: 1.000000
d_prime: 1.792675
train_loss: 0.041723
valid_loss: 1.335977
validation finished
normal learning rate scheduler step
Epoch-38 lr: 3.7735559372922678e-06
Epoch-38 lr: 7.5471118745845355e-06
epoch 38 training time: 15.336
---------------
2023-09-25 01:55:28.985579
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00746	Per Sample Data Time 0.00179	Per Sample DNN Time 0.00567	Train Loss 0.0310	
start validation
acc: 0.727700
AUC: 0.897525
Avg Precision: 0.444530
Avg Recall: 1.000000
d_prime: 1.792621
train_loss: 0.037233
valid_loss: 1.335999
validation finished
normal learning rate scheduler step
Epoch-39 lr: 2.9730339426869245e-06
Epoch-39 lr: 5.946067885373849e-06
epoch 39 training time: 17.165
---------------
2023-09-25 01:55:46.150537
current #epochs=40, #steps=1521
start validation
acc: 0.727700
AUC: 0.897413
Avg Precision: 0.444698
Avg Recall: 1.000000
d_prime: 1.791732
train_loss: 0.043487
valid_loss: 1.335759
validation finished
normal learning rate scheduler step
Epoch-40 lr: 2.9730339426869245e-06
Epoch-40 lr: 5.946067885373849e-06
epoch 40 training time: 15.176
---------------
2023-09-25 01:56:01.326724
current #epochs=41, #steps=1560
start validation
acc: 0.727700
AUC: 0.897502
Avg Precision: 0.444530
Avg Recall: 1.000000
d_prime: 1.792442
train_loss: 0.037387
valid_loss: 1.335708
validation finished
normal learning rate scheduler step
Epoch-41 lr: 2.3423346496649457e-06
Epoch-41 lr: 4.684669299329891e-06
epoch 41 training time: 15.149
---------------
2023-09-25 01:56:16.475575
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02300	Per Sample Data Time 0.01640	Per Sample DNN Time 0.00660	Train Loss 0.0664	
start validation
acc: 0.727700
AUC: 0.897452
Avg Precision: 0.444530
Avg Recall: 1.000000
d_prime: 1.792043
train_loss: 0.036797
valid_loss: 1.335689
validation finished
normal learning rate scheduler step
Epoch-42 lr: 2.3423346496649457e-06
Epoch-42 lr: 4.684669299329891e-06
epoch 42 training time: 17.803
---------------
2023-09-25 01:56:34.278672
current #epochs=43, #steps=1638
start validation
acc: 0.727700
AUC: 0.897524
Avg Precision: 0.444530
Avg Recall: 1.000000
d_prime: 1.792611
train_loss: 0.041168
valid_loss: 1.335614
validation finished
normal learning rate scheduler step
Epoch-43 lr: 1.845431877599913e-06
Epoch-43 lr: 3.690863755199826e-06
epoch 43 training time: 18.243
---------------
2023-09-25 01:56:52.522004
current #epochs=44, #steps=1677
Epoch: [44][23/39]	Per Sample Total Time 0.00710	Per Sample Data Time 0.00146	Per Sample DNN Time 0.00564	Train Loss 0.0464	
start validation
acc: 0.727700
AUC: 0.897578
Avg Precision: 0.444089
Avg Recall: 1.000000
d_prime: 1.793044
train_loss: 0.042078
valid_loss: 1.335430
validation finished
normal learning rate scheduler step
Epoch-44 lr: 1.845431877599913e-06
Epoch-44 lr: 3.690863755199826e-06
epoch 44 training time: 15.369
---------------
2023-09-25 01:57:07.891033
current #epochs=45, #steps=1716
start validation
acc: 0.727700
AUC: 0.897502
Avg Precision: 0.443221
Avg Recall: 1.000000
d_prime: 1.792442
train_loss: 0.037376
valid_loss: 1.335356
validation finished
normal learning rate scheduler step
Epoch-45 lr: 1.4539420382775322e-06
Epoch-45 lr: 2.9078840765550645e-06
epoch 45 training time: 15.243
---------------
2023-09-25 01:57:23.134075
current #epochs=46, #steps=1755
start validation
acc: 0.727700
AUC: 0.897545
Avg Precision: 0.443221
Avg Recall: 1.000000
d_prime: 1.792776
train_loss: 0.041068
valid_loss: 1.335383
validation finished
normal learning rate scheduler step
Epoch-46 lr: 1.4539420382775322e-06
Epoch-46 lr: 2.9078840765550645e-06
epoch 46 training time: 15.196
---------------
2023-09-25 01:57:38.329626
current #epochs=47, #steps=1794
Epoch: [47][6/39]	Per Sample Total Time 0.01077	Per Sample Data Time 0.00466	Per Sample DNN Time 0.00611	Train Loss 0.0262	
start validation
acc: 0.727700
AUC: 0.897610
Avg Precision: 0.444089
Avg Recall: 1.000000
d_prime: 1.793291
train_loss: 0.035107
valid_loss: 1.335428
validation finished
normal learning rate scheduler step
Epoch-47 lr: 1.145502836669285e-06
Epoch-47 lr: 2.29100567333857e-06
epoch 47 training time: 15.267
---------------
2023-09-25 01:57:53.596945
current #epochs=48, #steps=1833
start validation
[I 2023-09-25 01:58:08,813] Trial 97 finished with value: 0.4439691966478332 and parameters: {'warmup': 'True', 'num_epochs': 48, 'batch_size': 50, 'lr-adaptschedule': 'True', 'lr': 0.00017122437364738407, 'head-lr': 2, 'lr-scheduler-start': 7, 'lr-scheduler-step': 2, 'lr-scheduler-decay': 0.7878600429122666}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.727700
AUC: 0.897446
Avg Precision: 0.443969
Avg Recall: 1.000000
d_prime: 1.791997
train_loss: 0.038709
valid_loss: 1.335436
validation finished
normal learning rate scheduler step
Epoch-48 lr: 1.145502836669285e-06
Epoch-48 lr: 2.29100567333857e-06
epoch 48 training time: 15.202
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa67f48a7c0>
The learning rate scheduler starts at 6 epoch with decay rate of 0.770 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-25 01:58:08.854260
current #epochs=1, #steps=0
start validation
acc: 0.723005
AUC: 0.891901
Avg Precision: 0.451524
Avg Recall: 1.000000
d_prime: 1.748958
train_loss: 0.050750
valid_loss: 1.340949
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0003443533892301702
Epoch-1 lr: 0.0003443533892301702
epoch 1 training time: 17.930
---------------
2023-09-25 01:58:26.784996
current #epochs=2, #steps=39
start validation
acc: 0.713615
AUC: 0.896305
Avg Precision: 0.456092
Avg Recall: 1.000000
d_prime: 1.783005
train_loss: 0.038146
valid_loss: 1.332842
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0003443533892301702
Epoch-2 lr: 0.0003443533892301702
epoch 2 training time: 15.284
---------------
2023-09-25 01:58:42.069283
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00716	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00560	Train Loss 0.0472	
start validation
acc: 0.751174
AUC: 0.908087
Avg Precision: 0.454193
Avg Recall: 1.000000
d_prime: 1.879581
train_loss: 0.046573
valid_loss: 1.315630
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0003443533892301702
Epoch-3 lr: 0.0003443533892301702
epoch 3 training time: 17.807
---------------
2023-09-25 01:58:59.876063
current #epochs=4, #steps=117
start validation
acc: 0.746479
AUC: 0.908160
Avg Precision: 0.464751
Avg Recall: 1.000000
d_prime: 1.880208
train_loss: 0.052404
valid_loss: 1.317966
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0003443533892301702
Epoch-4 lr: 0.0003443533892301702
epoch 4 training time: 16.993
---------------
2023-09-25 01:59:16.868875
current #epochs=5, #steps=156
start validation
acc: 0.727700
AUC: 0.902879
Avg Precision: 0.470980
Avg Recall: 1.000000
d_prime: 1.835836
train_loss: 0.043429
valid_loss: 1.325060
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0003443533892301702
Epoch-5 lr: 0.0003443533892301702
epoch 5 training time: 15.156
---------------
2023-09-25 01:59:32.024754
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01122	Per Sample Data Time 0.00506	Per Sample DNN Time 0.00616	Train Loss 0.0579	
start validation
acc: 0.746479
AUC: 0.905475
Avg Precision: 0.450780
Avg Recall: 1.000000
d_prime: 1.857424
train_loss: 0.042419
valid_loss: 1.317564
validation finished
normal learning rate scheduler step
Epoch-6 lr: 0.0002652743451660196
Epoch-6 lr: 0.0002652743451660196
epoch 6 training time: 15.234
---------------
2023-09-25 01:59:47.258930
current #epochs=7, #steps=234
start validation
acc: 0.760563
AUC: 0.909334
Avg Precision: 0.455806
Avg Recall: 1.000000
d_prime: 1.890332
train_loss: 0.033678
valid_loss: 1.319520
validation finished
normal learning rate scheduler step
Epoch-7 lr: 0.00020435541047114243
Epoch-7 lr: 0.00020435541047114243
epoch 7 training time: 18.010
---------------
2023-09-25 02:00:05.268549
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00685	Per Sample Data Time 0.00122	Per Sample DNN Time 0.00563	Train Loss 0.0448	
start validation
acc: 0.760563
AUC: 0.906001
Avg Precision: 0.473641
Avg Recall: 1.000000
d_prime: 1.861850
train_loss: 0.037286
valid_loss: 1.324621
validation finished
normal learning rate scheduler step
Epoch-8 lr: 0.00015742620630235945
Epoch-8 lr: 0.00015742620630235945
epoch 8 training time: 16.467
---------------
2023-09-25 02:00:21.735083
current #epochs=9, #steps=312
start validation
acc: 0.732394
AUC: 0.896092
Avg Precision: 0.467145
Avg Recall: 1.000000
d_prime: 1.781335
train_loss: 0.043493
valid_loss: 1.337298
validation finished
normal learning rate scheduler step
Epoch-9 lr: 0.00012127406058697288
Epoch-9 lr: 0.00012127406058697288
epoch 9 training time: 15.165
---------------
2023-09-25 02:00:36.900529
current #epochs=10, #steps=351
start validation
acc: 0.723005
AUC: 0.896237
Avg Precision: 0.466018
Avg Recall: 1.000000
d_prime: 1.782468
train_loss: 0.041904
valid_loss: 1.333883
validation finished
normal learning rate scheduler step
Epoch-10 lr: 9.342407542366303e-05
Epoch-10 lr: 9.342407542366303e-05
epoch 10 training time: 15.324
---------------
2023-09-25 02:00:52.224702
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00871	Per Sample Data Time 0.00288	Per Sample DNN Time 0.00583	Train Loss 0.0347	
start validation
acc: 0.741784
AUC: 0.899517
Avg Precision: 0.459543
Avg Recall: 1.000000
d_prime: 1.808504
train_loss: 0.037500
valid_loss: 1.325740
validation finished
normal learning rate scheduler step
Epoch-11 lr: 7.196970091148937e-05
Epoch-11 lr: 7.196970091148937e-05
epoch 11 training time: 15.238
---------------
2023-09-25 02:01:07.462653
current #epochs=12, #steps=429
start validation
acc: 0.760563
AUC: 0.901001
Avg Precision: 0.454353
Avg Recall: 1.000000
d_prime: 1.820485
train_loss: 0.045662
valid_loss: 1.322028
validation finished
normal learning rate scheduler step
Epoch-12 lr: 5.5442216856847836e-05
Epoch-12 lr: 5.5442216856847836e-05
epoch 12 training time: 15.120
---------------
2023-09-25 02:01:22.582784
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00665	Per Sample Data Time 0.00104	Per Sample DNN Time 0.00561	Train Loss 0.0395	
start validation
acc: 0.746479
AUC: 0.900592
Avg Precision: 0.461327
Avg Recall: 1.000000
d_prime: 1.817168
train_loss: 0.039424
valid_loss: 1.322344
validation finished
normal learning rate scheduler step
Epoch-13 lr: 4.2710187357622177e-05
Epoch-13 lr: 4.2710187357622177e-05
epoch 13 training time: 15.305
---------------
2023-09-25 02:01:37.887601
current #epochs=14, #steps=507
start validation
acc: 0.760563
AUC: 0.900108
Avg Precision: 0.460530
Avg Recall: 1.000000
d_prime: 1.813258
train_loss: 0.046485
valid_loss: 1.323462
validation finished
normal learning rate scheduler step
Epoch-14 lr: 3.290200514227601e-05
Epoch-14 lr: 3.290200514227601e-05
epoch 14 training time: 15.268
---------------
2023-09-25 02:01:53.155072
current #epochs=15, #steps=546
start validation
acc: 0.746479
AUC: 0.900407
Avg Precision: 0.467152
Avg Recall: 1.000000
d_prime: 1.815672
train_loss: 0.038122
valid_loss: 1.324752
validation finished
normal learning rate scheduler step
Epoch-15 lr: 2.534622321644214e-05
Epoch-15 lr: 2.534622321644214e-05
epoch 15 training time: 15.105
---------------
2023-09-25 02:02:08.259615
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00755	Per Sample Data Time 0.00194	Per Sample DNN Time 0.00561	Train Loss 0.0232	
start validation
acc: 0.746479
AUC: 0.900469
Avg Precision: 0.467542
Avg Recall: 1.000000
d_prime: 1.816172
train_loss: 0.035958
valid_loss: 1.324179
validation finished
normal learning rate scheduler step
Epoch-16 lr: 1.9525589050262672e-05
Epoch-16 lr: 1.9525589050262672e-05
epoch 16 training time: 15.013
---------------
2023-09-25 02:02:23.272781
current #epochs=17, #steps=624
start validation
acc: 0.746479
AUC: 0.900543
Avg Precision: 0.467322
Avg Recall: 1.000000
d_prime: 1.816776
train_loss: 0.047890
valid_loss: 1.323406
validation finished
normal learning rate scheduler step
Epoch-17 lr: 1.504163458611147e-05
Epoch-17 lr: 1.504163458611147e-05
epoch 17 training time: 15.215
---------------
2023-09-25 02:02:38.487496
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00654	Per Sample Data Time 0.00096	Per Sample DNN Time 0.00558	Train Loss 0.0379	
start validation
acc: 0.751174
AUC: 0.900922
Avg Precision: 0.467457
Avg Recall: 1.000000
d_prime: 1.819839
train_loss: 0.038644
valid_loss: 1.322871
validation finished
normal learning rate scheduler step
Epoch-18 lr: 1.1587397975020942e-05
Epoch-18 lr: 1.1587397975020942e-05
epoch 18 training time: 15.311
---------------
2023-09-25 02:02:53.798904
current #epochs=19, #steps=702
start validation
acc: 0.746479
AUC: 0.900829
Avg Precision: 0.467322
Avg Recall: 1.000000
d_prime: 1.819085
train_loss: 0.039283
valid_loss: 1.323001
validation finished
normal learning rate scheduler step
Epoch-19 lr: 8.926409630738813e-06
Epoch-19 lr: 8.926409630738813e-06
epoch 19 training time: 15.266
---------------
2023-09-25 02:03:09.065246
current #epochs=20, #steps=741
start validation
acc: 0.746479
AUC: 0.900764
Avg Precision: 0.467543
Avg Recall: 1.000000
d_prime: 1.818558
train_loss: 0.031699
valid_loss: 1.323613
validation finished
normal learning rate scheduler step
Epoch-20 lr: 6.876504032010915e-06
Epoch-20 lr: 6.876504032010915e-06
epoch 20 training time: 15.227
---------------
2023-09-25 02:03:24.291539
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00721	Per Sample Data Time 0.00158	Per Sample DNN Time 0.00563	Train Loss 0.0396	
start validation
acc: 0.746479
AUC: 0.900789
Avg Precision: 0.467595
Avg Recall: 1.000000
d_prime: 1.818761
train_loss: 0.040779
valid_loss: 1.323289
validation finished
normal learning rate scheduler step
Epoch-21 lr: 5.297349063998604e-06
Epoch-21 lr: 5.297349063998604e-06
epoch 21 training time: 15.143
---------------
2023-09-25 02:03:39.435047
current #epochs=22, #steps=819
start validation
acc: 0.746479
AUC: 0.901024
Avg Precision: 0.467595
Avg Recall: 1.000000
d_prime: 1.820669
train_loss: 0.042426
valid_loss: 1.323552
validation finished
normal learning rate scheduler step
Epoch-22 lr: 4.080839184448302e-06
Epoch-22 lr: 4.080839184448302e-06
epoch 22 training time: 15.049
---------------
2023-09-25 02:03:54.484335
current #epochs=23, #steps=858
start validation
acc: 0.746479
AUC: 0.900982
Avg Precision: 0.467595
Avg Recall: 1.000000
d_prime: 1.820329
train_loss: 0.043272
valid_loss: 1.323491
validation finished
normal learning rate scheduler step
Epoch-23 lr: 3.143694751494872e-06
Epoch-23 lr: 3.143694751494872e-06
epoch 23 training time: 15.034
---------------
2023-09-25 02:04:09.518374
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01381	Per Sample Data Time 0.00786	Per Sample DNN Time 0.00595	Train Loss 0.0236	
start validation
acc: 0.746479
AUC: 0.900897
Avg Precision: 0.467595
Avg Recall: 1.000000
d_prime: 1.819643
train_loss: 0.030412
valid_loss: 1.323418
validation finished
normal learning rate scheduler step
Epoch-24 lr: 2.4217608790463733e-06
Epoch-24 lr: 2.4217608790463733e-06
epoch 24 training time: 15.276
---------------
2023-09-25 02:04:24.794550
current #epochs=25, #steps=936
start validation
acc: 0.746479
AUC: 0.900767
Avg Precision: 0.467595
Avg Recall: 1.000000
d_prime: 1.818585
train_loss: 0.038589
valid_loss: 1.323423
validation finished
normal learning rate scheduler step
Epoch-25 lr: 1.8656155316894574e-06
Epoch-25 lr: 1.8656155316894574e-06
epoch 25 training time: 15.249
---------------
2023-09-25 02:04:40.043935
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00698	Per Sample Data Time 0.00135	Per Sample DNN Time 0.00564	Train Loss 0.0363	
start validation
acc: 0.746479
AUC: 0.900850
Avg Precision: 0.467595
Avg Recall: 1.000000
d_prime: 1.819262
train_loss: 0.041487
valid_loss: 1.323474
validation finished
normal learning rate scheduler step
Epoch-26 lr: 1.4371861987676817e-06
Epoch-26 lr: 1.4371861987676817e-06
epoch 26 training time: 15.244
---------------
2023-09-25 02:04:55.287981
current #epochs=27, #steps=1014
start validation
acc: 0.746479
AUC: 0.900821
Avg Precision: 0.467595
Avg Recall: 1.000000
d_prime: 1.819020
train_loss: 0.037274
valid_loss: 1.323521
validation finished
normal learning rate scheduler step
Epoch-27 lr: 1.1071435324393053e-06
Epoch-27 lr: 1.1071435324393053e-06
epoch 27 training time: 15.247
---------------
2023-09-25 02:05:10.534925
current #epochs=28, #steps=1053
start validation
acc: 0.746479
AUC: 0.900922
Avg Precision: 0.467595
Avg Recall: 1.000000
d_prime: 1.819844
train_loss: 0.035754
valid_loss: 1.323561
validation finished
normal learning rate scheduler step
Epoch-28 lr: 8.528935237989478e-07
Epoch-28 lr: 8.528935237989478e-07
epoch 28 training time: 15.162
---------------
2023-09-25 02:05:25.696704
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00965	Per Sample Data Time 0.00370	Per Sample DNN Time 0.00595	Train Loss 0.0294	
start validation
acc: 0.746479
AUC: 0.900816
Avg Precision: 0.467595
Avg Recall: 1.000000
d_prime: 1.818985
train_loss: 0.037688
valid_loss: 1.323544
validation finished
normal learning rate scheduler step
Epoch-29 lr: 6.570307657720654e-07
Epoch-29 lr: 6.570307657720654e-07
epoch 29 training time: 15.330
---------------
2023-09-25 02:05:41.026639
current #epochs=30, #steps=1131
start validation
[I 2023-09-25 02:05:56,363] Trial 98 finished with value: 0.4675954278642551 and parameters: {'warmup': 'True', 'num_epochs': 30, 'batch_size': 56, 'lr-adaptschedule': 'False', 'lr': 0.0003443533892301702, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7703549709763619}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.746479
AUC: 0.900827
Avg Precision: 0.467595
Avg Recall: 1.000000
d_prime: 1.819072
train_loss: 0.040198
valid_loss: 1.323544
validation finished
normal learning rate scheduler step
Epoch-30 lr: 5.061469164969162e-07
Epoch-30 lr: 5.061469164969162e-07
epoch 30 training time: 15.321
running on cuda
Total parameter number is : 86.997 million
Total trainable parameter number is : 86.997 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.006 million
Total base parameter number is : 86.991 million
now training with ours, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fa6015c4ca0>
The learning rate scheduler starts at 5 epoch with decay rate of 0.749 every 6 epoches
current #steps=0, #epochs=1
start training...
---------------
2023-09-25 02:05:56.405761
current #epochs=1, #steps=0
start validation
acc: 0.755869
AUC: 0.901768
Avg Precision: 0.471286
Avg Recall: 1.000000
d_prime: 1.826727
train_loss: 0.044237
valid_loss: 1.322226
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.00011637977065218124
Epoch-1 lr: 0.00011637977065218124
epoch 1 training time: 17.644
---------------
2023-09-25 02:06:14.049797
current #epochs=2, #steps=39
start validation
acc: 0.732394
AUC: 0.901203
Avg Precision: 0.477340
Avg Recall: 1.000000
d_prime: 1.822124
train_loss: 0.036815
valid_loss: 1.320821
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.00011637977065218124
Epoch-2 lr: 0.00011637977065218124
epoch 2 training time: 15.207
---------------
2023-09-25 02:06:29.257072
current #epochs=3, #steps=78
Epoch: [3][22/39]	Per Sample Total Time 0.00699	Per Sample Data Time 0.00143	Per Sample DNN Time 0.00555	Train Loss 0.0414	
start validation
acc: 0.741784
AUC: 0.899930
Avg Precision: 0.485715
Avg Recall: 1.000000
d_prime: 1.811823
train_loss: 0.054545
valid_loss: 1.325024
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.00011637977065218124
Epoch-3 lr: 0.00011637977065218124
epoch 3 training time: 15.113
---------------
2023-09-25 02:06:44.370197
current #epochs=4, #steps=117
start validation
acc: 0.737089
AUC: 0.900417
Avg Precision: 0.477853
Avg Recall: 1.000000
d_prime: 1.815750
train_loss: 0.037876
valid_loss: 1.327192
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.00011637977065218124
Epoch-4 lr: 0.00011637977065218124
epoch 4 training time: 15.181
---------------
2023-09-25 02:06:59.551413
current #epochs=5, #steps=156
start validation
acc: 0.732394
AUC: 0.901382
Avg Precision: 0.479660
Avg Recall: 1.000000
d_prime: 1.823578
train_loss: 0.049856
valid_loss: 1.322271
validation finished
normal learning rate scheduler step
Epoch-5 lr: 8.718167389852302e-05
Epoch-5 lr: 8.718167389852302e-05
epoch 5 training time: 15.277
---------------
2023-09-25 02:07:14.828786
current #epochs=6, #steps=195
Epoch: [6][5/39]	Per Sample Total Time 0.01145	Per Sample Data Time 0.00512	Per Sample DNN Time 0.00633	Train Loss 0.0478	
start validation
acc: 0.746479
AUC: 0.900543
Avg Precision: 0.465244
Avg Recall: 1.000000
d_prime: 1.816774
train_loss: 0.037024
valid_loss: 1.323555
validation finished
normal learning rate scheduler step
Epoch-6 lr: 8.718167389852302e-05
Epoch-6 lr: 8.718167389852302e-05
epoch 6 training time: 16.908
---------------
2023-09-25 02:07:31.736700
current #epochs=7, #steps=234
start validation
acc: 0.732394
AUC: 0.899569
Avg Precision: 0.469916
Avg Recall: 1.000000
d_prime: 1.808921
train_loss: 0.051278
valid_loss: 1.321148
validation finished
normal learning rate scheduler step
Epoch-7 lr: 8.718167389852302e-05
Epoch-7 lr: 8.718167389852302e-05
epoch 7 training time: 15.254
---------------
2023-09-25 02:07:46.991027
current #epochs=8, #steps=273
Epoch: [8][27/39]	Per Sample Total Time 0.00684	Per Sample Data Time 0.00125	Per Sample DNN Time 0.00558	Train Loss 0.0561	
start validation
acc: 0.732394
AUC: 0.904125
Avg Precision: 0.482446
Avg Recall: 1.000000
d_prime: 1.846140
train_loss: 0.060294
valid_loss: 1.316936
validation finished
normal learning rate scheduler step
Epoch-8 lr: 8.718167389852302e-05
Epoch-8 lr: 8.718167389852302e-05
epoch 8 training time: 15.125
---------------
2023-09-25 02:08:02.116266
current #epochs=9, #steps=312
start validation
acc: 0.732394
AUC: 0.901497
Avg Precision: 0.466026
Avg Recall: 1.000000
d_prime: 1.824515
train_loss: 0.042573
valid_loss: 1.327845
validation finished
normal learning rate scheduler step
Epoch-9 lr: 8.718167389852302e-05
Epoch-9 lr: 8.718167389852302e-05
epoch 9 training time: 15.351
---------------
2023-09-25 02:08:17.467332
current #epochs=10, #steps=351
start validation
acc: 0.737089
AUC: 0.901647
Avg Precision: 0.464232
Avg Recall: 1.000000
d_prime: 1.825742
train_loss: 0.033946
valid_loss: 1.325790
validation finished
normal learning rate scheduler step
Epoch-10 lr: 8.718167389852302e-05
Epoch-10 lr: 8.718167389852302e-05
epoch 10 training time: 15.215
---------------
2023-09-25 02:08:32.682625
current #epochs=11, #steps=390
Epoch: [11][10/39]	Per Sample Total Time 0.00872	Per Sample Data Time 0.00294	Per Sample DNN Time 0.00578	Train Loss 0.0771	
start validation
acc: 0.741784
AUC: 0.901252
Avg Precision: 0.457640
Avg Recall: 1.000000
d_prime: 1.822519
train_loss: 0.047692
valid_loss: 1.325664
validation finished
normal learning rate scheduler step
Epoch-11 lr: 6.530898128734159e-05
Epoch-11 lr: 6.530898128734159e-05
epoch 11 training time: 15.163
---------------
2023-09-25 02:08:47.846178
current #epochs=12, #steps=429
start validation
acc: 0.737089
AUC: 0.902525
Avg Precision: 0.463369
Avg Recall: 1.000000
d_prime: 1.832923
train_loss: 0.052938
valid_loss: 1.320660
validation finished
normal learning rate scheduler step
Epoch-12 lr: 6.530898128734159e-05
Epoch-12 lr: 6.530898128734159e-05
epoch 12 training time: 15.148
---------------
2023-09-25 02:09:02.993800
current #epochs=13, #steps=468
Epoch: [13][32/39]	Per Sample Total Time 0.00662	Per Sample Data Time 0.00105	Per Sample DNN Time 0.00557	Train Loss 0.0381	
start validation
acc: 0.727700
AUC: 0.899652
Avg Precision: 0.463667
Avg Recall: 1.000000
d_prime: 1.809587
train_loss: 0.040259
valid_loss: 1.318506
validation finished
normal learning rate scheduler step
Epoch-13 lr: 6.530898128734159e-05
Epoch-13 lr: 6.530898128734159e-05
epoch 13 training time: 16.166
---------------
2023-09-25 02:09:19.159809
current #epochs=14, #steps=507
start validation
acc: 0.727700
AUC: 0.900624
Avg Precision: 0.476645
Avg Recall: 1.000000
d_prime: 1.817424
train_loss: 0.045304
valid_loss: 1.320834
validation finished
normal learning rate scheduler step
Epoch-14 lr: 6.530898128734159e-05
Epoch-14 lr: 6.530898128734159e-05
epoch 14 training time: 15.246
---------------
2023-09-25 02:09:34.405689
current #epochs=15, #steps=546
start validation
acc: 0.727700
AUC: 0.901511
Avg Precision: 0.469862
Avg Recall: 1.000000
d_prime: 1.824628
train_loss: 0.047549
valid_loss: 1.324968
validation finished
normal learning rate scheduler step
Epoch-15 lr: 6.530898128734159e-05
Epoch-15 lr: 6.530898128734159e-05
epoch 15 training time: 15.245
---------------
2023-09-25 02:09:49.650189
current #epochs=16, #steps=585
Epoch: [16][15/39]	Per Sample Total Time 0.00779	Per Sample Data Time 0.00197	Per Sample DNN Time 0.00582	Train Loss 0.0323	
start validation
acc: 0.718310
AUC: 0.902018
Avg Precision: 0.476261
Avg Recall: 1.000000
d_prime: 1.828768
train_loss: 0.037830
valid_loss: 1.328153
validation finished
normal learning rate scheduler step
Epoch-16 lr: 6.530898128734159e-05
Epoch-16 lr: 6.530898128734159e-05
epoch 16 training time: 15.328
---------------
2023-09-25 02:10:04.978317
current #epochs=17, #steps=624
start validation
acc: 0.718310
AUC: 0.901494
Avg Precision: 0.475733
Avg Recall: 1.000000
d_prime: 1.824494
train_loss: 0.042027
valid_loss: 1.329296
validation finished
normal learning rate scheduler step
Epoch-17 lr: 4.892384885560901e-05
Epoch-17 lr: 4.892384885560901e-05
epoch 17 training time: 15.829
---------------
2023-09-25 02:10:20.807105
current #epochs=18, #steps=663
Epoch: [18][37/39]	Per Sample Total Time 0.00654	Per Sample Data Time 0.00100	Per Sample DNN Time 0.00554	Train Loss 0.0330	
start validation
acc: 0.708920
AUC: 0.902522
Avg Precision: 0.476061
Avg Recall: 1.000000
d_prime: 1.832902
train_loss: 0.033473
valid_loss: 1.329425
validation finished
normal learning rate scheduler step
Epoch-18 lr: 4.892384885560901e-05
Epoch-18 lr: 4.892384885560901e-05
epoch 18 training time: 15.252
---------------
2023-09-25 02:10:36.059579
current #epochs=19, #steps=702
start validation
acc: 0.727700
AUC: 0.901637
Avg Precision: 0.450244
Avg Recall: 1.000000
d_prime: 1.825658
train_loss: 0.032735
valid_loss: 1.328514
validation finished
normal learning rate scheduler step
Epoch-19 lr: 4.892384885560901e-05
Epoch-19 lr: 4.892384885560901e-05
epoch 19 training time: 15.176
---------------
2023-09-25 02:10:51.235847
current #epochs=20, #steps=741
start validation
acc: 0.718310
AUC: 0.901054
Avg Precision: 0.450452
Avg Recall: 1.000000
d_prime: 1.820916
train_loss: 0.045566
valid_loss: 1.331382
validation finished
normal learning rate scheduler step
Epoch-20 lr: 4.892384885560901e-05
Epoch-20 lr: 4.892384885560901e-05
epoch 20 training time: 15.236
---------------
2023-09-25 02:11:06.471910
current #epochs=21, #steps=780
Epoch: [21][20/39]	Per Sample Total Time 0.00711	Per Sample Data Time 0.00156	Per Sample DNN Time 0.00555	Train Loss 0.0349	
start validation
acc: 0.713615
AUC: 0.899602
Avg Precision: 0.450180
Avg Recall: 1.000000
d_prime: 1.809184
train_loss: 0.038493
valid_loss: 1.331593
validation finished
normal learning rate scheduler step
Epoch-21 lr: 4.892384885560901e-05
Epoch-21 lr: 4.892384885560901e-05
epoch 21 training time: 16.327
---------------
2023-09-25 02:11:22.798758
current #epochs=22, #steps=819
start validation
acc: 0.732394
AUC: 0.899452
Avg Precision: 0.449175
Avg Recall: 1.000000
d_prime: 1.807978
train_loss: 0.043104
valid_loss: 1.329397
validation finished
normal learning rate scheduler step
Epoch-22 lr: 4.892384885560901e-05
Epoch-22 lr: 4.892384885560901e-05
epoch 22 training time: 16.025
---------------
2023-09-25 02:11:38.823570
current #epochs=23, #steps=858
start validation
acc: 0.732394
AUC: 0.900189
Avg Precision: 0.461436
Avg Recall: 1.000000
d_prime: 1.813911
train_loss: 0.041497
valid_loss: 1.328513
validation finished
normal learning rate scheduler step
Epoch-23 lr: 3.664952261796189e-05
Epoch-23 lr: 3.664952261796189e-05
epoch 23 training time: 15.246
---------------
2023-09-25 02:11:54.069797
current #epochs=24, #steps=897
Epoch: [24][3/39]	Per Sample Total Time 0.01409	Per Sample Data Time 0.00764	Per Sample DNN Time 0.00645	Train Loss 0.0774	
start validation
acc: 0.727700
AUC: 0.899386
Avg Precision: 0.460865
Avg Recall: 1.000000
d_prime: 1.807452
train_loss: 0.042003
valid_loss: 1.331297
validation finished
normal learning rate scheduler step
Epoch-24 lr: 3.664952261796189e-05
Epoch-24 lr: 3.664952261796189e-05
epoch 24 training time: 15.152
---------------
2023-09-25 02:12:09.221982
current #epochs=25, #steps=936
start validation
acc: 0.732394
AUC: 0.899866
Avg Precision: 0.461041
Avg Recall: 1.000000
d_prime: 1.811307
train_loss: 0.039298
valid_loss: 1.329664
validation finished
normal learning rate scheduler step
Epoch-25 lr: 3.664952261796189e-05
Epoch-25 lr: 3.664952261796189e-05
epoch 25 training time: 15.212
---------------
2023-09-25 02:12:24.433863
current #epochs=26, #steps=975
Epoch: [26][25/39]	Per Sample Total Time 0.00685	Per Sample Data Time 0.00127	Per Sample DNN Time 0.00558	Train Loss 0.0542	
start validation
acc: 0.741784
AUC: 0.901479
Avg Precision: 0.461540
Avg Recall: 1.000000
d_prime: 1.824371
train_loss: 0.047268
valid_loss: 1.325739
validation finished
normal learning rate scheduler step
Epoch-26 lr: 3.664952261796189e-05
Epoch-26 lr: 3.664952261796189e-05
epoch 26 training time: 15.091
---------------
2023-09-25 02:12:39.525226
current #epochs=27, #steps=1014
start validation
acc: 0.732394
AUC: 0.902358
Avg Precision: 0.456981
Avg Recall: 1.000000
d_prime: 1.831555
train_loss: 0.035309
valid_loss: 1.326313
validation finished
normal learning rate scheduler step
Epoch-27 lr: 3.664952261796189e-05
Epoch-27 lr: 3.664952261796189e-05
epoch 27 training time: 15.226
---------------
2023-09-25 02:12:54.751334
current #epochs=28, #steps=1053
start validation
acc: 0.727700
AUC: 0.902073
Avg Precision: 0.462306
Avg Recall: 1.000000
d_prime: 1.829218
train_loss: 0.034390
valid_loss: 1.327191
validation finished
normal learning rate scheduler step
Epoch-28 lr: 3.664952261796189e-05
Epoch-28 lr: 3.664952261796189e-05
epoch 28 training time: 15.285
---------------
2023-09-25 02:13:10.036833
current #epochs=29, #steps=1092
Epoch: [29][8/39]	Per Sample Total Time 0.00945	Per Sample Data Time 0.00357	Per Sample DNN Time 0.00588	Train Loss 0.0494	
start validation
acc: 0.732394
AUC: 0.901280
Avg Precision: 0.461399
Avg Recall: 1.000000
d_prime: 1.822751
train_loss: 0.040282
valid_loss: 1.329330
validation finished
normal learning rate scheduler step
Epoch-29 lr: 2.7454657381693438e-05
Epoch-29 lr: 2.7454657381693438e-05
epoch 29 training time: 16.422
---------------
2023-09-25 02:13:26.459185
current #epochs=30, #steps=1131
start validation
acc: 0.732394
AUC: 0.901682
Avg Precision: 0.461253
Avg Recall: 1.000000
d_prime: 1.826022
train_loss: 0.038283
valid_loss: 1.329500
validation finished
normal learning rate scheduler step
Epoch-30 lr: 2.7454657381693438e-05
Epoch-30 lr: 2.7454657381693438e-05
epoch 30 training time: 15.264
---------------
2023-09-25 02:13:41.723323
current #epochs=31, #steps=1170
Epoch: [31][30/39]	Per Sample Total Time 0.00677	Per Sample Data Time 0.00115	Per Sample DNN Time 0.00562	Train Loss 0.0298	
start validation
acc: 0.737089
AUC: 0.901454
Avg Precision: 0.454342
Avg Recall: 1.000000
d_prime: 1.824167
train_loss: 0.032255
valid_loss: 1.327539
validation finished
normal learning rate scheduler step
Epoch-31 lr: 2.7454657381693438e-05
Epoch-31 lr: 2.7454657381693438e-05
epoch 31 training time: 15.797
---------------
2023-09-25 02:13:57.520779
current #epochs=32, #steps=1209
start validation
acc: 0.737089
AUC: 0.902016
Avg Precision: 0.467354
Avg Recall: 1.000000
d_prime: 1.828758
train_loss: 0.037929
valid_loss: 1.326565
validation finished
normal learning rate scheduler step
Epoch-32 lr: 2.7454657381693438e-05
Epoch-32 lr: 2.7454657381693438e-05
epoch 32 training time: 16.133
---------------
2023-09-25 02:14:13.653958
current #epochs=33, #steps=1248
start validation
acc: 0.741784
AUC: 0.901516
Avg Precision: 0.460491
Avg Recall: 1.000000
d_prime: 1.824674
train_loss: 0.040210
valid_loss: 1.328548
validation finished
normal learning rate scheduler step
Epoch-33 lr: 2.7454657381693438e-05
Epoch-33 lr: 2.7454657381693438e-05
epoch 33 training time: 15.207
---------------
2023-09-25 02:14:28.860932
current #epochs=34, #steps=1287
Epoch: [34][13/39]	Per Sample Total Time 0.00801	Per Sample Data Time 0.00229	Per Sample DNN Time 0.00572	Train Loss 0.0346	
start validation
acc: 0.746479
AUC: 0.900828
Avg Precision: 0.460635
Avg Recall: 1.000000
d_prime: 1.819077
train_loss: 0.034302
valid_loss: 1.328814
validation finished
normal learning rate scheduler step
Epoch-34 lr: 2.7454657381693438e-05
Epoch-34 lr: 2.7454657381693438e-05
epoch 34 training time: 15.219
---------------
2023-09-25 02:14:44.079863
current #epochs=35, #steps=1326
start validation
acc: 0.746479
AUC: 0.900427
Avg Precision: 0.467429
Avg Recall: 1.000000
d_prime: 1.815837
train_loss: 0.037718
valid_loss: 1.327514
validation finished
normal learning rate scheduler step
Epoch-35 lr: 2.0566658392891536e-05
Epoch-35 lr: 2.0566658392891536e-05
epoch 35 training time: 15.267
---------------
2023-09-25 02:14:59.346379
current #epochs=36, #steps=1365
Epoch: [36][35/39]	Per Sample Total Time 0.00654	Per Sample Data Time 0.00098	Per Sample DNN Time 0.00557	Train Loss 0.0398	
start validation
acc: 0.746479
AUC: 0.900143
Avg Precision: 0.474813
Avg Recall: 1.000000
d_prime: 1.813541
train_loss: 0.037694
valid_loss: 1.327958
validation finished
normal learning rate scheduler step
Epoch-36 lr: 2.0566658392891536e-05
Epoch-36 lr: 2.0566658392891536e-05
epoch 36 training time: 15.116
---------------
2023-09-25 02:15:14.462154
current #epochs=37, #steps=1404
start validation
acc: 0.741784
AUC: 0.900199
Avg Precision: 0.474203
Avg Recall: 1.000000
d_prime: 1.813995
train_loss: 0.041989
valid_loss: 1.329134
validation finished
normal learning rate scheduler step
Epoch-37 lr: 2.0566658392891536e-05
Epoch-37 lr: 2.0566658392891536e-05
epoch 37 training time: 15.186
---------------
2023-09-25 02:15:29.647955
current #epochs=38, #steps=1443
start validation
acc: 0.741784
AUC: 0.899804
Avg Precision: 0.474186
Avg Recall: 1.000000
d_prime: 1.810811
train_loss: 0.029017
valid_loss: 1.329504
validation finished
normal learning rate scheduler step
Epoch-38 lr: 2.0566658392891536e-05
Epoch-38 lr: 2.0566658392891536e-05
epoch 38 training time: 15.230
---------------
2023-09-25 02:15:44.877653
current #epochs=39, #steps=1482
Epoch: [39][18/39]	Per Sample Total Time 0.00747	Per Sample Data Time 0.00178	Per Sample DNN Time 0.00569	Train Loss 0.0423	
start validation
acc: 0.737089
AUC: 0.899722
Avg Precision: 0.474441
Avg Recall: 1.000000
d_prime: 1.810146
train_loss: 0.035277
valid_loss: 1.329387
validation finished
normal learning rate scheduler step
Epoch-39 lr: 2.0566658392891536e-05
Epoch-39 lr: 2.0566658392891536e-05
epoch 39 training time: 15.273
---------------
2023-09-25 02:16:00.150779
current #epochs=40, #steps=1521
start validation
acc: 0.727700
AUC: 0.900007
Avg Precision: 0.474294
Avg Recall: 1.000000
d_prime: 1.812441
train_loss: 0.054536
valid_loss: 1.330929
validation finished
normal learning rate scheduler step
Epoch-40 lr: 2.0566658392891536e-05
Epoch-40 lr: 2.0566658392891536e-05
epoch 40 training time: 15.262
---------------
2023-09-25 02:16:15.412322
current #epochs=41, #steps=1560
start validation
acc: 0.727700
AUC: 0.899697
Avg Precision: 0.474681
Avg Recall: 1.000000
d_prime: 1.809949
train_loss: 0.044355
valid_loss: 1.331291
validation finished
normal learning rate scheduler step
Epoch-41 lr: 1.5406764381330094e-05
Epoch-41 lr: 1.5406764381330094e-05
epoch 41 training time: 15.323
---------------
2023-09-25 02:16:30.735153
current #epochs=42, #steps=1599
Epoch: [42][1/39]	Per Sample Total Time 0.02268	Per Sample Data Time 0.01561	Per Sample DNN Time 0.00707	Train Loss 0.0338	
start validation
acc: 0.727700
AUC: 0.899531
Avg Precision: 0.474441
Avg Recall: 1.000000
d_prime: 1.808615
train_loss: 0.034564
valid_loss: 1.330772
validation finished
normal learning rate scheduler step
Epoch-42 lr: 1.5406764381330094e-05
Epoch-42 lr: 1.5406764381330094e-05
epoch 42 training time: 15.224
---------------
2023-09-25 02:16:45.959134
current #epochs=43, #steps=1638
start validation
[I 2023-09-25 02:17:01,276] Trial 99 finished with value: 0.4743009133070897 and parameters: {'warmup': 'True', 'num_epochs': 43, 'batch_size': 37, 'lr-adaptschedule': 'True', 'lr': 0.00011637977065218124, 'head-lr': 1, 'lr-scheduler-start': 5, 'lr-scheduler-step': 6, 'lr-scheduler-decay': 0.7491136424308551}. Best is trial 41 with value: 0.5035368702035369.
acc: 0.732394
AUC: 0.899584
Avg Precision: 0.474301
Avg Recall: 1.000000
d_prime: 1.809040
train_loss: 0.039163
valid_loss: 1.330045
validation finished
normal learning rate scheduler step
Epoch-43 lr: 1.5406764381330094e-05
Epoch-43 lr: 1.5406764381330094e-05
epoch 43 training time: 15.303
Best hyperparameters: {'warmup': 'True', 'num_epochs': 42, 'batch_size': 50, 'lr-adaptschedule': 'True', 'lr': 8.00479056664981e-05, 'head-lr': 1, 'lr-scheduler-start': 6, 'lr-scheduler-step': 1, 'lr-scheduler-decay': 0.7716652831330821}
